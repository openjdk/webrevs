{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -2876,1 +2876,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (byte) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (byte) VectorMath.minUnsigned(a, b)));\n@@ -2878,1 +2878,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (byte) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (byte) VectorMath.maxUnsigned(a, b)));\n@@ -2891,0 +2891,2 @@\n+    private static final byte UMIN_VALUE = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMAX_VALUE = (byte)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/ByteVector.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/DoubleVector.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/FloatVector.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -2861,1 +2861,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (int) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (int) VectorMath.minUnsigned(a, b)));\n@@ -2863,1 +2863,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (int) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (int) VectorMath.maxUnsigned(a, b)));\n@@ -2876,0 +2876,2 @@\n+    private static final int UMIN_VALUE = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMAX_VALUE = (int)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/IntVector.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -2727,1 +2727,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (long) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (long) VectorMath.minUnsigned(a, b)));\n@@ -2729,1 +2729,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (long) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (long) VectorMath.maxUnsigned(a, b)));\n@@ -2742,0 +2742,2 @@\n+    private static final long UMIN_VALUE = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMAX_VALUE = (long)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/LongVector.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -2877,1 +2877,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (short) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (short) VectorMath.minUnsigned(a, b)));\n@@ -2879,1 +2879,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (short) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (short) VectorMath.maxUnsigned(a, b)));\n@@ -2892,0 +2892,2 @@\n+    private static final short UMIN_VALUE = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMAX_VALUE = (short)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/ShortVector.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -3451,1 +3451,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> ($type$) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> ($type$) VectorMath.minUnsigned(a, b)));\n@@ -3453,1 +3453,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> ($type$) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> ($type$) VectorMath.maxUnsigned(a, b)));\n@@ -3473,0 +3473,2 @@\n+    private static final $type$ UMIN_VALUE = ($type$)0;   \/\/ Minimum unsigned value\n+    private static final $type$ UMAX_VALUE = ($type$)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/X-Vector.java.template","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3425,1 +3436,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3434,1 +3445,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3446,8 +3457,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3456,1 +3460,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3459,1 +3463,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3467,0 +3473,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id & x), x);\n+                Assert.assertEquals((byte) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3468,1 +3497,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3478,1 +3507,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3492,1 +3521,1 @@\n-        byte ra = -1;\n+        byte ra = AND_IDENTITY;\n@@ -3502,1 +3531,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3523,1 +3552,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3538,0 +3567,1 @@\n+            ra = OR_IDENTITY;\n@@ -3540,9 +3570,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3556,0 +3580,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id | x), x);\n+                Assert.assertEquals((byte) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3557,1 +3604,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3567,1 +3614,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3581,1 +3628,1 @@\n-        byte ra = 0;\n+        byte ra = OR_IDENTITY;\n@@ -3591,1 +3638,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3612,1 +3659,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3627,0 +3674,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3629,9 +3677,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3645,0 +3687,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id ^ x), x);\n+                Assert.assertEquals((byte) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3646,1 +3711,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3656,1 +3721,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3670,1 +3735,1 @@\n-        byte ra = 0;\n+        byte ra = XOR_IDENTITY;\n@@ -3680,1 +3745,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3701,1 +3766,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3716,0 +3781,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3718,9 +3784,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3734,0 +3794,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id + x), x);\n+                Assert.assertEquals((byte) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3735,1 +3818,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3745,1 +3828,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3759,1 +3842,1 @@\n-        byte ra = 0;\n+        byte ra = ADD_IDENTITY;\n@@ -3769,1 +3852,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3790,1 +3873,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3802,8 +3885,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3812,1 +3888,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3815,1 +3891,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3823,0 +3901,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id * x), x);\n+                Assert.assertEquals((byte) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3824,1 +3925,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3834,1 +3935,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3848,1 +3949,1 @@\n-        byte ra = 1;\n+        byte ra = MUL_IDENTITY;\n@@ -3858,1 +3959,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3879,1 +3980,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3891,8 +3992,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3901,1 +3995,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3904,1 +3998,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3912,0 +4008,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.min(id, x), x);\n+                Assert.assertEquals((byte) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3913,1 +4032,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3923,1 +4042,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3937,8 +4056,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3947,1 +4059,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3950,1 +4062,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3959,1 +4073,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3968,1 +4082,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3980,8 +4094,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3990,1 +4097,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3993,1 +4100,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4001,0 +4110,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.max(id, x), x);\n+                Assert.assertEquals((byte) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4002,1 +4134,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4012,1 +4144,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4026,8 +4158,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4036,1 +4161,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4039,1 +4164,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4048,1 +4175,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4057,1 +4184,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4069,8 +4196,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4079,1 +4199,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4082,1 +4202,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4090,0 +4212,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4091,1 +4236,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4101,1 +4246,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4115,8 +4260,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4125,1 +4263,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4128,1 +4266,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4137,1 +4277,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4146,1 +4286,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4158,8 +4298,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4168,1 +4301,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4171,1 +4304,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4179,0 +4314,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4180,1 +4338,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4190,1 +4348,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4204,8 +4362,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4214,1 +4365,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4217,1 +4368,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4226,1 +4379,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4235,1 +4388,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4247,8 +4400,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4257,1 +4403,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4260,1 +4406,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4268,0 +4416,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4269,1 +4440,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4450,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4293,8 +4464,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4303,1 +4467,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4306,1 +4470,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte128VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3425,1 +3436,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3434,1 +3445,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3446,8 +3457,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3456,1 +3460,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3459,1 +3463,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3467,0 +3473,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id & x), x);\n+                Assert.assertEquals((byte) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3468,1 +3497,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3478,1 +3507,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3492,1 +3521,1 @@\n-        byte ra = -1;\n+        byte ra = AND_IDENTITY;\n@@ -3502,1 +3531,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3523,1 +3552,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3538,0 +3567,1 @@\n+            ra = OR_IDENTITY;\n@@ -3540,9 +3570,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3556,0 +3580,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id | x), x);\n+                Assert.assertEquals((byte) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3557,1 +3604,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3567,1 +3614,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3581,1 +3628,1 @@\n-        byte ra = 0;\n+        byte ra = OR_IDENTITY;\n@@ -3591,1 +3638,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3612,1 +3659,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3627,0 +3674,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3629,9 +3677,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3645,0 +3687,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id ^ x), x);\n+                Assert.assertEquals((byte) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3646,1 +3711,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3656,1 +3721,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3670,1 +3735,1 @@\n-        byte ra = 0;\n+        byte ra = XOR_IDENTITY;\n@@ -3680,1 +3745,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3701,1 +3766,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3716,0 +3781,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3718,9 +3784,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3734,0 +3794,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id + x), x);\n+                Assert.assertEquals((byte) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3735,1 +3818,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3745,1 +3828,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3759,1 +3842,1 @@\n-        byte ra = 0;\n+        byte ra = ADD_IDENTITY;\n@@ -3769,1 +3852,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3790,1 +3873,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3802,8 +3885,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3812,1 +3888,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3815,1 +3891,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3823,0 +3901,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id * x), x);\n+                Assert.assertEquals((byte) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3824,1 +3925,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3834,1 +3935,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3848,1 +3949,1 @@\n-        byte ra = 1;\n+        byte ra = MUL_IDENTITY;\n@@ -3858,1 +3959,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3879,1 +3980,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3891,8 +3992,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3901,1 +3995,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3904,1 +3998,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3912,0 +4008,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.min(id, x), x);\n+                Assert.assertEquals((byte) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3913,1 +4032,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3923,1 +4042,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3937,8 +4056,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3947,1 +4059,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3950,1 +4062,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3959,1 +4073,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3968,1 +4082,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3980,8 +4094,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3990,1 +4097,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3993,1 +4100,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4001,0 +4110,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.max(id, x), x);\n+                Assert.assertEquals((byte) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4002,1 +4134,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4012,1 +4144,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4026,8 +4158,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4036,1 +4161,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4039,1 +4164,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4048,1 +4175,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4057,1 +4184,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4069,8 +4196,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4079,1 +4199,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4082,1 +4202,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4090,0 +4212,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4091,1 +4236,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4101,1 +4246,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4115,8 +4260,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4125,1 +4263,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4128,1 +4266,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4137,1 +4277,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4146,1 +4286,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4158,8 +4298,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4168,1 +4301,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4171,1 +4304,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4179,0 +4314,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4180,1 +4338,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4190,1 +4348,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4204,8 +4362,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4214,1 +4365,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4217,1 +4368,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4226,1 +4379,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4235,1 +4388,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4247,8 +4400,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4257,1 +4403,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4260,1 +4406,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4268,0 +4416,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4269,1 +4440,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4450,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4293,8 +4464,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4303,1 +4467,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4306,1 +4470,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte256VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3425,1 +3436,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3434,1 +3445,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3446,8 +3457,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3456,1 +3460,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3459,1 +3463,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3467,0 +3473,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id & x), x);\n+                Assert.assertEquals((byte) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3468,1 +3497,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3478,1 +3507,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3492,1 +3521,1 @@\n-        byte ra = -1;\n+        byte ra = AND_IDENTITY;\n@@ -3502,1 +3531,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3523,1 +3552,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3538,0 +3567,1 @@\n+            ra = OR_IDENTITY;\n@@ -3540,9 +3570,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3556,0 +3580,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id | x), x);\n+                Assert.assertEquals((byte) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3557,1 +3604,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3567,1 +3614,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3581,1 +3628,1 @@\n-        byte ra = 0;\n+        byte ra = OR_IDENTITY;\n@@ -3591,1 +3638,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3612,1 +3659,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3627,0 +3674,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3629,9 +3677,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3645,0 +3687,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id ^ x), x);\n+                Assert.assertEquals((byte) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3646,1 +3711,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3656,1 +3721,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3670,1 +3735,1 @@\n-        byte ra = 0;\n+        byte ra = XOR_IDENTITY;\n@@ -3680,1 +3745,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3701,1 +3766,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3716,0 +3781,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3718,9 +3784,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3734,0 +3794,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id + x), x);\n+                Assert.assertEquals((byte) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3735,1 +3818,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3745,1 +3828,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3759,1 +3842,1 @@\n-        byte ra = 0;\n+        byte ra = ADD_IDENTITY;\n@@ -3769,1 +3852,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3790,1 +3873,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3802,8 +3885,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3812,1 +3888,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3815,1 +3891,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3823,0 +3901,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id * x), x);\n+                Assert.assertEquals((byte) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3824,1 +3925,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3834,1 +3935,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3848,1 +3949,1 @@\n-        byte ra = 1;\n+        byte ra = MUL_IDENTITY;\n@@ -3858,1 +3959,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3879,1 +3980,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3891,8 +3992,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3901,1 +3995,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3904,1 +3998,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3912,0 +4008,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.min(id, x), x);\n+                Assert.assertEquals((byte) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3913,1 +4032,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3923,1 +4042,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3937,8 +4056,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3947,1 +4059,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3950,1 +4062,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3959,1 +4073,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3968,1 +4082,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3980,8 +4094,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3990,1 +4097,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3993,1 +4100,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4001,0 +4110,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.max(id, x), x);\n+                Assert.assertEquals((byte) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4002,1 +4134,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4012,1 +4144,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4026,8 +4158,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4036,1 +4161,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4039,1 +4164,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4048,1 +4175,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4057,1 +4184,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4069,8 +4196,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4079,1 +4199,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4082,1 +4202,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4090,0 +4212,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4091,1 +4236,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4101,1 +4246,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4115,8 +4260,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4125,1 +4263,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4128,1 +4266,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4137,1 +4277,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4146,1 +4286,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4158,8 +4298,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4168,1 +4301,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4171,1 +4304,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4179,0 +4314,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4180,1 +4338,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4190,1 +4348,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4204,8 +4362,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4214,1 +4365,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4217,1 +4368,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4226,1 +4379,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4235,1 +4388,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4247,8 +4400,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4257,1 +4403,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4260,1 +4406,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4268,0 +4416,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4269,1 +4440,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4450,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4293,8 +4464,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4303,1 +4467,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4306,1 +4470,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte512VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3425,1 +3436,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3434,1 +3445,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3446,8 +3457,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3456,1 +3460,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3459,1 +3463,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3467,0 +3473,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id & x), x);\n+                Assert.assertEquals((byte) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3468,1 +3497,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3478,1 +3507,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3492,1 +3521,1 @@\n-        byte ra = -1;\n+        byte ra = AND_IDENTITY;\n@@ -3502,1 +3531,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3523,1 +3552,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3538,0 +3567,1 @@\n+            ra = OR_IDENTITY;\n@@ -3540,9 +3570,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3556,0 +3580,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id | x), x);\n+                Assert.assertEquals((byte) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3557,1 +3604,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3567,1 +3614,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3581,1 +3628,1 @@\n-        byte ra = 0;\n+        byte ra = OR_IDENTITY;\n@@ -3591,1 +3638,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3612,1 +3659,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3627,0 +3674,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3629,9 +3677,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3645,0 +3687,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id ^ x), x);\n+                Assert.assertEquals((byte) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3646,1 +3711,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3656,1 +3721,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3670,1 +3735,1 @@\n-        byte ra = 0;\n+        byte ra = XOR_IDENTITY;\n@@ -3680,1 +3745,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3701,1 +3766,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3716,0 +3781,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3718,9 +3784,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3734,0 +3794,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id + x), x);\n+                Assert.assertEquals((byte) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3735,1 +3818,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3745,1 +3828,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3759,1 +3842,1 @@\n-        byte ra = 0;\n+        byte ra = ADD_IDENTITY;\n@@ -3769,1 +3852,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3790,1 +3873,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3802,8 +3885,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3812,1 +3888,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3815,1 +3891,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3823,0 +3901,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id * x), x);\n+                Assert.assertEquals((byte) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3824,1 +3925,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3834,1 +3935,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3848,1 +3949,1 @@\n-        byte ra = 1;\n+        byte ra = MUL_IDENTITY;\n@@ -3858,1 +3959,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3879,1 +3980,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3891,8 +3992,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3901,1 +3995,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3904,1 +3998,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3912,0 +4008,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.min(id, x), x);\n+                Assert.assertEquals((byte) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3913,1 +4032,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3923,1 +4042,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3937,8 +4056,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3947,1 +4059,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3950,1 +4062,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3959,1 +4073,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3968,1 +4082,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3980,8 +4094,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3990,1 +4097,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3993,1 +4100,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4001,0 +4110,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.max(id, x), x);\n+                Assert.assertEquals((byte) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4002,1 +4134,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4012,1 +4144,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4026,8 +4158,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4036,1 +4161,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4039,1 +4164,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4048,1 +4175,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4057,1 +4184,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4069,8 +4196,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4079,1 +4199,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4082,1 +4202,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4090,0 +4212,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4091,1 +4236,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4101,1 +4246,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4115,8 +4260,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4125,1 +4263,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4128,1 +4266,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4137,1 +4277,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4146,1 +4286,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4158,8 +4298,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4168,1 +4301,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4171,1 +4304,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4179,0 +4314,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4180,1 +4338,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4190,1 +4348,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4204,8 +4362,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4214,1 +4365,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4217,1 +4368,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4226,1 +4379,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4235,1 +4388,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4247,8 +4400,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4257,1 +4403,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4260,1 +4406,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4268,0 +4416,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4269,1 +4440,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4450,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4293,8 +4464,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4303,1 +4467,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4306,1 +4470,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte64VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3430,1 +3442,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3439,1 +3451,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3451,8 +3463,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3461,1 +3466,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3464,1 +3469,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3472,0 +3479,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id & x), x);\n+                Assert.assertEquals((byte) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3473,1 +3503,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3483,1 +3513,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3497,1 +3527,1 @@\n-        byte ra = -1;\n+        byte ra = AND_IDENTITY;\n@@ -3507,1 +3537,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3519,1 +3549,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3528,1 +3558,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3543,0 +3573,1 @@\n+            ra = OR_IDENTITY;\n@@ -3545,9 +3576,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3561,0 +3586,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id | x), x);\n+                Assert.assertEquals((byte) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3562,1 +3610,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3572,1 +3620,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3586,1 +3634,1 @@\n-        byte ra = 0;\n+        byte ra = OR_IDENTITY;\n@@ -3596,1 +3644,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3608,1 +3656,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3617,1 +3665,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3632,0 +3680,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3634,9 +3683,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3650,0 +3693,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id ^ x), x);\n+                Assert.assertEquals((byte) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3651,1 +3717,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3661,1 +3727,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3675,1 +3741,1 @@\n-        byte ra = 0;\n+        byte ra = XOR_IDENTITY;\n@@ -3685,1 +3751,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3697,1 +3763,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3706,1 +3772,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3721,0 +3787,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3723,9 +3790,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3739,0 +3800,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id + x), x);\n+                Assert.assertEquals((byte) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3740,1 +3824,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3750,1 +3834,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3764,1 +3848,1 @@\n-        byte ra = 0;\n+        byte ra = ADD_IDENTITY;\n@@ -3774,1 +3858,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3786,1 +3870,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3795,1 +3879,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3807,8 +3891,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3817,1 +3894,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3820,1 +3897,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3828,0 +3907,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) (id * x), x);\n+                Assert.assertEquals((byte) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3829,1 +3931,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3839,1 +3941,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3853,1 +3955,1 @@\n-        byte ra = 1;\n+        byte ra = MUL_IDENTITY;\n@@ -3863,1 +3965,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3875,1 +3977,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3884,1 +3986,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3896,8 +3998,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3906,1 +4001,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3909,1 +4004,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3917,0 +4014,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.min(id, x), x);\n+                Assert.assertEquals((byte) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3918,1 +4038,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3928,1 +4048,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -3942,8 +4062,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3952,1 +4065,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3955,1 +4068,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -3964,1 +4079,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3973,1 +4088,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -3985,8 +4100,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3995,1 +4103,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3998,1 +4106,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4006,0 +4116,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) Math.max(id, x), x);\n+                Assert.assertEquals((byte) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4007,1 +4140,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4017,1 +4150,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4031,8 +4164,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4041,1 +4167,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4044,1 +4170,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4053,1 +4181,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4062,1 +4190,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4074,8 +4202,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4084,1 +4205,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4087,1 +4208,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4095,0 +4218,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4096,1 +4242,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4106,1 +4252,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4120,8 +4266,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4130,1 +4269,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4133,1 +4272,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4142,1 +4283,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4151,1 +4292,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4163,8 +4304,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4173,1 +4307,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4176,1 +4310,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4184,0 +4320,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4185,1 +4344,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4195,1 +4354,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4209,8 +4368,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4219,1 +4371,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4222,1 +4374,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4231,1 +4385,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4240,1 +4394,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4252,8 +4406,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4262,1 +4409,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4265,1 +4412,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4273,0 +4422,23 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        byte x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4274,1 +4446,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4284,1 +4456,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4298,8 +4470,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4308,1 +4473,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4311,1 +4476,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/ByteMaxVectorTests.java","additions":365,"deletions":198,"binary":false,"changes":563,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2296,1 +2302,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2305,1 +2311,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2320,0 +2326,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2322,9 +2329,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2338,0 +2339,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id + x), x);\n+                Assert.assertEquals((double) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2339,1 +2363,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2349,1 +2373,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2363,1 +2387,1 @@\n-        double ra = 0;\n+        double ra = ADD_IDENTITY;\n@@ -2373,1 +2397,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2385,1 +2409,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2394,1 +2418,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2406,8 +2430,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2416,1 +2433,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2419,1 +2436,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2427,0 +2446,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id * x), x);\n+                Assert.assertEquals((double) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2428,1 +2470,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2438,1 +2480,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2452,1 +2494,1 @@\n-        double ra = 1;\n+        double ra = MUL_IDENTITY;\n@@ -2462,1 +2504,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2474,1 +2516,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2483,1 +2525,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2495,8 +2537,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2505,1 +2540,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2508,1 +2543,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2516,0 +2553,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.min(id, x), x);\n+                Assert.assertEquals((double) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2517,1 +2577,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2527,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2541,8 +2601,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2551,1 +2604,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2554,1 +2607,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2563,1 +2618,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2572,1 +2627,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2584,8 +2639,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2594,1 +2642,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2597,1 +2645,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2605,0 +2655,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.max(id, x), x);\n+                Assert.assertEquals((double) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2606,1 +2679,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2616,1 +2689,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2630,8 +2703,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2640,1 +2706,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2643,1 +2709,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2652,1 +2720,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2661,1 +2729,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2673,8 +2741,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2683,1 +2744,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2686,1 +2747,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2694,0 +2757,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2695,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2705,1 +2791,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2719,8 +2805,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2729,1 +2808,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2732,1 +2811,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double128VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2296,1 +2302,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2305,1 +2311,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2320,0 +2326,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2322,9 +2329,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2338,0 +2339,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id + x), x);\n+                Assert.assertEquals((double) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2339,1 +2363,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2349,1 +2373,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2363,1 +2387,1 @@\n-        double ra = 0;\n+        double ra = ADD_IDENTITY;\n@@ -2373,1 +2397,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2385,1 +2409,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2394,1 +2418,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2406,8 +2430,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2416,1 +2433,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2419,1 +2436,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2427,0 +2446,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id * x), x);\n+                Assert.assertEquals((double) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2428,1 +2470,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2438,1 +2480,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2452,1 +2494,1 @@\n-        double ra = 1;\n+        double ra = MUL_IDENTITY;\n@@ -2462,1 +2504,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2474,1 +2516,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2483,1 +2525,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2495,8 +2537,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2505,1 +2540,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2508,1 +2543,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2516,0 +2553,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.min(id, x), x);\n+                Assert.assertEquals((double) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2517,1 +2577,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2527,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2541,8 +2601,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2551,1 +2604,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2554,1 +2607,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2563,1 +2618,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2572,1 +2627,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2584,8 +2639,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2594,1 +2642,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2597,1 +2645,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2605,0 +2655,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.max(id, x), x);\n+                Assert.assertEquals((double) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2606,1 +2679,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2616,1 +2689,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2630,8 +2703,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2640,1 +2706,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2643,1 +2709,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2652,1 +2720,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2661,1 +2729,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2673,8 +2741,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2683,1 +2744,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2686,1 +2747,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2694,0 +2757,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2695,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2705,1 +2791,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2719,8 +2805,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2729,1 +2808,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2732,1 +2811,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double256VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2296,1 +2302,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2305,1 +2311,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2320,0 +2326,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2322,9 +2329,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2338,0 +2339,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id + x), x);\n+                Assert.assertEquals((double) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2339,1 +2363,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2349,1 +2373,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2363,1 +2387,1 @@\n-        double ra = 0;\n+        double ra = ADD_IDENTITY;\n@@ -2373,1 +2397,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2385,1 +2409,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2394,1 +2418,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2406,8 +2430,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2416,1 +2433,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2419,1 +2436,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2427,0 +2446,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id * x), x);\n+                Assert.assertEquals((double) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2428,1 +2470,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2438,1 +2480,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2452,1 +2494,1 @@\n-        double ra = 1;\n+        double ra = MUL_IDENTITY;\n@@ -2462,1 +2504,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2474,1 +2516,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2483,1 +2525,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2495,8 +2537,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2505,1 +2540,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2508,1 +2543,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2516,0 +2553,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.min(id, x), x);\n+                Assert.assertEquals((double) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2517,1 +2577,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2527,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2541,8 +2601,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2551,1 +2604,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2554,1 +2607,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2563,1 +2618,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2572,1 +2627,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2584,8 +2639,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2594,1 +2642,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2597,1 +2645,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2605,0 +2655,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.max(id, x), x);\n+                Assert.assertEquals((double) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2606,1 +2679,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2616,1 +2689,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2630,8 +2703,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2640,1 +2706,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2643,1 +2709,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2652,1 +2720,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2661,1 +2729,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2673,8 +2741,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2683,1 +2744,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2686,1 +2747,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2694,0 +2757,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2695,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2705,1 +2791,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2719,8 +2805,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2729,1 +2808,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2732,1 +2811,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double512VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2296,1 +2302,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2305,1 +2311,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2320,0 +2326,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2322,9 +2329,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2338,0 +2339,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id + x), x);\n+                Assert.assertEquals((double) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2339,1 +2363,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2349,1 +2373,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2363,1 +2387,1 @@\n-        double ra = 0;\n+        double ra = ADD_IDENTITY;\n@@ -2373,1 +2397,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2385,1 +2409,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2394,1 +2418,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2406,8 +2430,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2416,1 +2433,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2419,1 +2436,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2427,0 +2446,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id * x), x);\n+                Assert.assertEquals((double) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2428,1 +2470,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2438,1 +2480,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2452,1 +2494,1 @@\n-        double ra = 1;\n+        double ra = MUL_IDENTITY;\n@@ -2462,1 +2504,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2474,1 +2516,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2483,1 +2525,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2495,8 +2537,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2505,1 +2540,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2508,1 +2543,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2516,0 +2553,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.min(id, x), x);\n+                Assert.assertEquals((double) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2517,1 +2577,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2527,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2541,8 +2601,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2551,1 +2604,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2554,1 +2607,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2563,1 +2618,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2572,1 +2627,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2584,8 +2639,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2594,1 +2642,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2597,1 +2645,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2605,0 +2655,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.max(id, x), x);\n+                Assert.assertEquals((double) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2606,1 +2679,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2616,1 +2689,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2630,8 +2703,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2640,1 +2706,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2643,1 +2709,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2652,1 +2720,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2661,1 +2729,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2673,8 +2741,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2683,1 +2744,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2686,1 +2747,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2694,0 +2757,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2695,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2705,1 +2791,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2719,8 +2805,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2729,1 +2808,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2732,1 +2811,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double64VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,7 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n+\n@@ -2301,1 +2308,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2310,1 +2317,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2325,0 +2332,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2327,9 +2335,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2343,0 +2345,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id + x), x);\n+                Assert.assertEquals((double) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2344,1 +2369,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2354,1 +2379,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2368,1 +2393,1 @@\n-        double ra = 0;\n+        double ra = ADD_IDENTITY;\n@@ -2378,1 +2403,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2390,1 +2415,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2399,1 +2424,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2411,8 +2436,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2421,1 +2439,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2424,1 +2442,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2432,0 +2452,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) (id * x), x);\n+                Assert.assertEquals((double) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2433,1 +2476,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2443,1 +2486,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2457,1 +2500,1 @@\n-        double ra = 1;\n+        double ra = MUL_IDENTITY;\n@@ -2467,1 +2510,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2479,1 +2522,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2488,1 +2531,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2500,8 +2543,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2510,1 +2546,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2513,1 +2549,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2521,0 +2559,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.min(id, x), x);\n+                Assert.assertEquals((double) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2522,1 +2583,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2532,1 +2593,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2546,8 +2607,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2556,1 +2610,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2559,1 +2613,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2568,1 +2624,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2577,1 +2633,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2589,8 +2645,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2599,1 +2648,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2602,1 +2651,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2610,0 +2661,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((double) Math.max(id, x), x);\n+                Assert.assertEquals((double) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2611,1 +2685,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2621,1 +2695,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2635,8 +2709,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2645,1 +2712,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2648,1 +2715,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2657,1 +2726,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2666,1 +2735,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2678,8 +2747,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2688,1 +2750,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2691,1 +2753,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2699,0 +2763,23 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        double x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2700,1 +2787,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2710,1 +2797,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2724,8 +2811,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2734,1 +2814,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2737,1 +2817,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/DoubleMaxVectorTests.java","additions":186,"deletions":104,"binary":false,"changes":290,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2307,1 +2313,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2316,1 +2322,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2331,0 +2337,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2333,9 +2340,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2349,0 +2350,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id + x), x);\n+                Assert.assertEquals((float) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2350,1 +2374,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2360,1 +2384,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2374,1 +2398,1 @@\n-        float ra = 0;\n+        float ra = ADD_IDENTITY;\n@@ -2384,1 +2408,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2396,1 +2420,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2405,1 +2429,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2417,8 +2441,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2427,1 +2444,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2430,1 +2447,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2438,0 +2457,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id * x), x);\n+                Assert.assertEquals((float) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2439,1 +2481,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2449,1 +2491,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2463,1 +2505,1 @@\n-        float ra = 1;\n+        float ra = MUL_IDENTITY;\n@@ -2473,1 +2515,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2485,1 +2527,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2494,1 +2536,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2506,8 +2548,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2516,1 +2551,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2519,1 +2554,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2527,0 +2564,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.min(id, x), x);\n+                Assert.assertEquals((float) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2528,1 +2588,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2538,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2552,8 +2612,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2562,1 +2615,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2565,1 +2618,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2574,1 +2629,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2583,1 +2638,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2595,8 +2650,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2605,1 +2653,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2608,1 +2656,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2616,0 +2666,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.max(id, x), x);\n+                Assert.assertEquals((float) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2617,1 +2690,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2627,1 +2700,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2641,8 +2714,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2651,1 +2717,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2654,1 +2720,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2663,1 +2731,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2672,1 +2740,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2684,8 +2752,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2694,1 +2755,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2697,1 +2758,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2705,0 +2768,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2706,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2716,1 +2802,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2730,8 +2816,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2740,1 +2819,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2743,1 +2822,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float128VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2307,1 +2313,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2316,1 +2322,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2331,0 +2337,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2333,9 +2340,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2349,0 +2350,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id + x), x);\n+                Assert.assertEquals((float) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2350,1 +2374,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2360,1 +2384,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2374,1 +2398,1 @@\n-        float ra = 0;\n+        float ra = ADD_IDENTITY;\n@@ -2384,1 +2408,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2396,1 +2420,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2405,1 +2429,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2417,8 +2441,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2427,1 +2444,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2430,1 +2447,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2438,0 +2457,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id * x), x);\n+                Assert.assertEquals((float) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2439,1 +2481,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2449,1 +2491,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2463,1 +2505,1 @@\n-        float ra = 1;\n+        float ra = MUL_IDENTITY;\n@@ -2473,1 +2515,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2485,1 +2527,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2494,1 +2536,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2506,8 +2548,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2516,1 +2551,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2519,1 +2554,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2527,0 +2564,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.min(id, x), x);\n+                Assert.assertEquals((float) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2528,1 +2588,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2538,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2552,8 +2612,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2562,1 +2615,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2565,1 +2618,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2574,1 +2629,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2583,1 +2638,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2595,8 +2650,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2605,1 +2653,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2608,1 +2656,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2616,0 +2666,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.max(id, x), x);\n+                Assert.assertEquals((float) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2617,1 +2690,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2627,1 +2700,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2641,8 +2714,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2651,1 +2717,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2654,1 +2720,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2663,1 +2731,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2672,1 +2740,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2684,8 +2752,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2694,1 +2755,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2697,1 +2758,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2705,0 +2768,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2706,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2716,1 +2802,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2730,8 +2816,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2740,1 +2819,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2743,1 +2822,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float256VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2307,1 +2313,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2316,1 +2322,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2331,0 +2337,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2333,9 +2340,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2349,0 +2350,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id + x), x);\n+                Assert.assertEquals((float) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2350,1 +2374,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2360,1 +2384,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2374,1 +2398,1 @@\n-        float ra = 0;\n+        float ra = ADD_IDENTITY;\n@@ -2384,1 +2408,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2396,1 +2420,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2405,1 +2429,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2417,8 +2441,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2427,1 +2444,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2430,1 +2447,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2438,0 +2457,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id * x), x);\n+                Assert.assertEquals((float) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2439,1 +2481,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2449,1 +2491,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2463,1 +2505,1 @@\n-        float ra = 1;\n+        float ra = MUL_IDENTITY;\n@@ -2473,1 +2515,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2485,1 +2527,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2494,1 +2536,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2506,8 +2548,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2516,1 +2551,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2519,1 +2554,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2527,0 +2564,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.min(id, x), x);\n+                Assert.assertEquals((float) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2528,1 +2588,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2538,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2552,8 +2612,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2562,1 +2615,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2565,1 +2618,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2574,1 +2629,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2583,1 +2638,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2595,8 +2650,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2605,1 +2653,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2608,1 +2656,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2616,0 +2666,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.max(id, x), x);\n+                Assert.assertEquals((float) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2617,1 +2690,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2627,1 +2700,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2641,8 +2714,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2651,1 +2717,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2654,1 +2720,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2663,1 +2731,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2672,1 +2740,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2684,8 +2752,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2694,1 +2755,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2697,1 +2758,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2705,0 +2768,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2706,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2716,1 +2802,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2730,8 +2816,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2740,1 +2819,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2743,1 +2822,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float512VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2307,1 +2313,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2316,1 +2322,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2331,0 +2337,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2333,9 +2340,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2349,0 +2350,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id + x), x);\n+                Assert.assertEquals((float) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2350,1 +2374,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2360,1 +2384,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2374,1 +2398,1 @@\n-        float ra = 0;\n+        float ra = ADD_IDENTITY;\n@@ -2384,1 +2408,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2396,1 +2420,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2405,1 +2429,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2417,8 +2441,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2427,1 +2444,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2430,1 +2447,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2438,0 +2457,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id * x), x);\n+                Assert.assertEquals((float) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2439,1 +2481,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2449,1 +2491,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2463,1 +2505,1 @@\n-        float ra = 1;\n+        float ra = MUL_IDENTITY;\n@@ -2473,1 +2515,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2485,1 +2527,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2494,1 +2536,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2506,8 +2548,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2516,1 +2551,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2519,1 +2554,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2527,0 +2564,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.min(id, x), x);\n+                Assert.assertEquals((float) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2528,1 +2588,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2538,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2552,8 +2612,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2562,1 +2615,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2565,1 +2618,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2574,1 +2629,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2583,1 +2638,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2595,8 +2650,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2605,1 +2653,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2608,1 +2656,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2616,0 +2666,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.max(id, x), x);\n+                Assert.assertEquals((float) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2617,1 +2690,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2627,1 +2700,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2641,8 +2714,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2651,1 +2717,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2654,1 +2720,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2663,1 +2731,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2672,1 +2740,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2684,8 +2752,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2694,1 +2755,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2697,1 +2758,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2705,0 +2768,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2706,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2716,1 +2802,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2730,8 +2816,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2740,1 +2819,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2743,1 +2822,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float64VectorTests.java","additions":185,"deletions":104,"binary":false,"changes":289,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,7 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n+\n@@ -2312,1 +2319,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2321,1 +2328,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2336,0 +2343,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2338,9 +2346,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2354,0 +2356,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id + x), x);\n+                Assert.assertEquals((float) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2355,1 +2380,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2365,1 +2390,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2379,1 +2404,1 @@\n-        float ra = 0;\n+        float ra = ADD_IDENTITY;\n@@ -2389,1 +2414,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -2401,1 +2426,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2410,1 +2435,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2422,8 +2447,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2432,1 +2450,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2435,1 +2453,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2443,0 +2463,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) (id * x), x);\n+                Assert.assertEquals((float) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2444,1 +2487,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2454,1 +2497,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2468,1 +2511,1 @@\n-        float ra = 1;\n+        float ra = MUL_IDENTITY;\n@@ -2478,1 +2521,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2490,1 +2533,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2499,1 +2542,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2511,8 +2554,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2521,1 +2557,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2524,1 +2560,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2532,0 +2570,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.min(id, x), x);\n+                Assert.assertEquals((float) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2533,1 +2594,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2543,1 +2604,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2557,8 +2618,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2567,1 +2621,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2570,1 +2624,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2579,1 +2635,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2588,1 +2644,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2600,8 +2656,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2610,1 +2659,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2613,1 +2662,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2621,0 +2672,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((float) Math.max(id, x), x);\n+                Assert.assertEquals((float) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2622,1 +2696,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2632,1 +2706,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2646,8 +2720,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2656,1 +2723,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2659,1 +2726,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2668,1 +2737,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2677,1 +2746,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2689,8 +2758,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2699,1 +2761,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2702,1 +2764,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2710,0 +2774,23 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        float x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2711,1 +2798,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2721,1 +2808,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2735,8 +2822,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2745,1 +2825,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2748,1 +2828,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/FloatMaxVectorTests.java","additions":186,"deletions":104,"binary":false,"changes":290,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3469,1 +3480,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3478,1 +3489,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3490,8 +3501,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3500,1 +3504,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3503,1 +3507,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3511,0 +3517,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id & x), x);\n+                Assert.assertEquals((int) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3512,1 +3541,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3522,1 +3551,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3536,1 +3565,1 @@\n-        int ra = -1;\n+        int ra = AND_IDENTITY;\n@@ -3546,1 +3575,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3567,1 +3596,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3582,0 +3611,1 @@\n+            ra = OR_IDENTITY;\n@@ -3584,9 +3614,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3600,0 +3624,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id | x), x);\n+                Assert.assertEquals((int) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3601,1 +3648,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3611,1 +3658,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3625,1 +3672,1 @@\n-        int ra = 0;\n+        int ra = OR_IDENTITY;\n@@ -3635,1 +3682,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3656,1 +3703,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3671,0 +3718,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3673,9 +3721,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3689,0 +3731,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id ^ x), x);\n+                Assert.assertEquals((int) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3690,1 +3755,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3700,1 +3765,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3714,1 +3779,1 @@\n-        int ra = 0;\n+        int ra = XOR_IDENTITY;\n@@ -3724,1 +3789,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3745,1 +3810,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3760,0 +3825,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3762,9 +3828,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3778,0 +3838,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id + x), x);\n+                Assert.assertEquals((int) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3779,1 +3862,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3789,1 +3872,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3803,1 +3886,1 @@\n-        int ra = 0;\n+        int ra = ADD_IDENTITY;\n@@ -3813,1 +3896,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3834,1 +3917,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3846,8 +3929,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -3856,1 +3932,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3859,1 +3935,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3867,0 +3945,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id * x), x);\n+                Assert.assertEquals((int) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3868,1 +3969,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3878,1 +3979,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3892,1 +3993,1 @@\n-        int ra = 1;\n+        int ra = MUL_IDENTITY;\n@@ -3902,1 +4003,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3923,1 +4024,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3935,8 +4036,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -3945,1 +4039,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3948,1 +4042,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -3956,0 +4052,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.min(id, x), x);\n+                Assert.assertEquals((int) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3957,1 +4076,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3967,1 +4086,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3981,8 +4100,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3991,1 +4103,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3994,1 +4106,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4003,1 +4117,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4012,1 +4126,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4024,8 +4138,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4034,1 +4141,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4037,1 +4144,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4045,0 +4154,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.max(id, x), x);\n+                Assert.assertEquals((int) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4046,1 +4178,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4056,1 +4188,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4070,8 +4202,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4080,1 +4205,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4083,1 +4208,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4092,1 +4219,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4101,1 +4228,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4113,8 +4240,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4123,1 +4243,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4126,1 +4246,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4134,0 +4256,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4135,1 +4280,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4145,1 +4290,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4159,8 +4304,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4169,1 +4307,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4172,1 +4310,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4181,1 +4321,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4190,1 +4330,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4202,8 +4342,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4212,1 +4345,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4215,1 +4348,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4223,0 +4358,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4224,1 +4382,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4234,1 +4392,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4248,8 +4406,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4258,1 +4409,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4261,1 +4412,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4270,1 +4423,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4432,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4291,8 +4444,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4301,1 +4447,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4304,1 +4450,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4312,0 +4460,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4313,1 +4484,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4323,1 +4494,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4337,8 +4508,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4347,1 +4511,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4350,1 +4514,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int128VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3469,1 +3480,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3478,1 +3489,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3490,8 +3501,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3500,1 +3504,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3503,1 +3507,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3511,0 +3517,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id & x), x);\n+                Assert.assertEquals((int) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3512,1 +3541,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3522,1 +3551,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3536,1 +3565,1 @@\n-        int ra = -1;\n+        int ra = AND_IDENTITY;\n@@ -3546,1 +3575,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3567,1 +3596,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3582,0 +3611,1 @@\n+            ra = OR_IDENTITY;\n@@ -3584,9 +3614,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3600,0 +3624,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id | x), x);\n+                Assert.assertEquals((int) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3601,1 +3648,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3611,1 +3658,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3625,1 +3672,1 @@\n-        int ra = 0;\n+        int ra = OR_IDENTITY;\n@@ -3635,1 +3682,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3656,1 +3703,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3671,0 +3718,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3673,9 +3721,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3689,0 +3731,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id ^ x), x);\n+                Assert.assertEquals((int) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3690,1 +3755,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3700,1 +3765,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3714,1 +3779,1 @@\n-        int ra = 0;\n+        int ra = XOR_IDENTITY;\n@@ -3724,1 +3789,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3745,1 +3810,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3760,0 +3825,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3762,9 +3828,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3778,0 +3838,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id + x), x);\n+                Assert.assertEquals((int) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3779,1 +3862,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3789,1 +3872,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3803,1 +3886,1 @@\n-        int ra = 0;\n+        int ra = ADD_IDENTITY;\n@@ -3813,1 +3896,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3834,1 +3917,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3846,8 +3929,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -3856,1 +3932,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3859,1 +3935,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3867,0 +3945,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id * x), x);\n+                Assert.assertEquals((int) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3868,1 +3969,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3878,1 +3979,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3892,1 +3993,1 @@\n-        int ra = 1;\n+        int ra = MUL_IDENTITY;\n@@ -3902,1 +4003,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3923,1 +4024,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3935,8 +4036,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -3945,1 +4039,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3948,1 +4042,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -3956,0 +4052,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.min(id, x), x);\n+                Assert.assertEquals((int) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3957,1 +4076,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3967,1 +4086,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3981,8 +4100,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3991,1 +4103,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3994,1 +4106,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4003,1 +4117,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4012,1 +4126,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4024,8 +4138,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4034,1 +4141,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4037,1 +4144,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4045,0 +4154,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.max(id, x), x);\n+                Assert.assertEquals((int) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4046,1 +4178,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4056,1 +4188,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4070,8 +4202,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4080,1 +4205,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4083,1 +4208,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4092,1 +4219,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4101,1 +4228,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4113,8 +4240,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4123,1 +4243,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4126,1 +4246,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4134,0 +4256,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4135,1 +4280,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4145,1 +4290,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4159,8 +4304,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4169,1 +4307,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4172,1 +4310,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4181,1 +4321,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4190,1 +4330,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4202,8 +4342,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4212,1 +4345,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4215,1 +4348,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4223,0 +4358,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4224,1 +4382,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4234,1 +4392,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4248,8 +4406,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4258,1 +4409,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4261,1 +4412,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4270,1 +4423,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4432,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4291,8 +4444,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4301,1 +4447,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4304,1 +4450,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4312,0 +4460,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4313,1 +4484,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4323,1 +4494,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4337,8 +4508,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4347,1 +4511,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4350,1 +4514,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int256VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3469,1 +3480,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3478,1 +3489,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3490,8 +3501,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3500,1 +3504,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3503,1 +3507,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3511,0 +3517,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id & x), x);\n+                Assert.assertEquals((int) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3512,1 +3541,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3522,1 +3551,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3536,1 +3565,1 @@\n-        int ra = -1;\n+        int ra = AND_IDENTITY;\n@@ -3546,1 +3575,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3567,1 +3596,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3582,0 +3611,1 @@\n+            ra = OR_IDENTITY;\n@@ -3584,9 +3614,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3600,0 +3624,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id | x), x);\n+                Assert.assertEquals((int) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3601,1 +3648,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3611,1 +3658,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3625,1 +3672,1 @@\n-        int ra = 0;\n+        int ra = OR_IDENTITY;\n@@ -3635,1 +3682,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3656,1 +3703,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3671,0 +3718,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3673,9 +3721,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3689,0 +3731,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id ^ x), x);\n+                Assert.assertEquals((int) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3690,1 +3755,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3700,1 +3765,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3714,1 +3779,1 @@\n-        int ra = 0;\n+        int ra = XOR_IDENTITY;\n@@ -3724,1 +3789,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3745,1 +3810,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3760,0 +3825,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3762,9 +3828,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3778,0 +3838,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id + x), x);\n+                Assert.assertEquals((int) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3779,1 +3862,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3789,1 +3872,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3803,1 +3886,1 @@\n-        int ra = 0;\n+        int ra = ADD_IDENTITY;\n@@ -3813,1 +3896,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3834,1 +3917,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3846,8 +3929,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -3856,1 +3932,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3859,1 +3935,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3867,0 +3945,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id * x), x);\n+                Assert.assertEquals((int) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3868,1 +3969,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3878,1 +3979,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3892,1 +3993,1 @@\n-        int ra = 1;\n+        int ra = MUL_IDENTITY;\n@@ -3902,1 +4003,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3923,1 +4024,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3935,8 +4036,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -3945,1 +4039,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3948,1 +4042,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -3956,0 +4052,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.min(id, x), x);\n+                Assert.assertEquals((int) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3957,1 +4076,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3967,1 +4086,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3981,8 +4100,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3991,1 +4103,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3994,1 +4106,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4003,1 +4117,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4012,1 +4126,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4024,8 +4138,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4034,1 +4141,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4037,1 +4144,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4045,0 +4154,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.max(id, x), x);\n+                Assert.assertEquals((int) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4046,1 +4178,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4056,1 +4188,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4070,8 +4202,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4080,1 +4205,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4083,1 +4208,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4092,1 +4219,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4101,1 +4228,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4113,8 +4240,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4123,1 +4243,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4126,1 +4246,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4134,0 +4256,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4135,1 +4280,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4145,1 +4290,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4159,8 +4304,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4169,1 +4307,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4172,1 +4310,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4181,1 +4321,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4190,1 +4330,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4202,8 +4342,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4212,1 +4345,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4215,1 +4348,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4223,0 +4358,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4224,1 +4382,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4234,1 +4392,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4248,8 +4406,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4258,1 +4409,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4261,1 +4412,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4270,1 +4423,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4432,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4291,8 +4444,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4301,1 +4447,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4304,1 +4450,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4312,0 +4460,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4313,1 +4484,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4323,1 +4494,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4337,8 +4508,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4347,1 +4511,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4350,1 +4514,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int512VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3469,1 +3480,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3478,1 +3489,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3490,8 +3501,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3500,1 +3504,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3503,1 +3507,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3511,0 +3517,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id & x), x);\n+                Assert.assertEquals((int) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3512,1 +3541,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3522,1 +3551,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3536,1 +3565,1 @@\n-        int ra = -1;\n+        int ra = AND_IDENTITY;\n@@ -3546,1 +3575,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3567,1 +3596,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3582,0 +3611,1 @@\n+            ra = OR_IDENTITY;\n@@ -3584,9 +3614,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3600,0 +3624,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id | x), x);\n+                Assert.assertEquals((int) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3601,1 +3648,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3611,1 +3658,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3625,1 +3672,1 @@\n-        int ra = 0;\n+        int ra = OR_IDENTITY;\n@@ -3635,1 +3682,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3656,1 +3703,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3671,0 +3718,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3673,9 +3721,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3689,0 +3731,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id ^ x), x);\n+                Assert.assertEquals((int) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3690,1 +3755,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3700,1 +3765,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3714,1 +3779,1 @@\n-        int ra = 0;\n+        int ra = XOR_IDENTITY;\n@@ -3724,1 +3789,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3745,1 +3810,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3760,0 +3825,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3762,9 +3828,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3778,0 +3838,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id + x), x);\n+                Assert.assertEquals((int) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3779,1 +3862,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3789,1 +3872,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3803,1 +3886,1 @@\n-        int ra = 0;\n+        int ra = ADD_IDENTITY;\n@@ -3813,1 +3896,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3834,1 +3917,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3846,8 +3929,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -3856,1 +3932,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3859,1 +3935,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3867,0 +3945,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id * x), x);\n+                Assert.assertEquals((int) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3868,1 +3969,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3878,1 +3979,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3892,1 +3993,1 @@\n-        int ra = 1;\n+        int ra = MUL_IDENTITY;\n@@ -3902,1 +4003,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3923,1 +4024,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3935,8 +4036,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -3945,1 +4039,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3948,1 +4042,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -3956,0 +4052,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.min(id, x), x);\n+                Assert.assertEquals((int) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3957,1 +4076,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3967,1 +4086,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3981,8 +4100,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3991,1 +4103,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3994,1 +4106,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4003,1 +4117,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4012,1 +4126,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4024,8 +4138,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4034,1 +4141,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4037,1 +4144,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4045,0 +4154,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.max(id, x), x);\n+                Assert.assertEquals((int) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4046,1 +4178,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4056,1 +4188,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4070,8 +4202,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4080,1 +4205,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4083,1 +4208,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4092,1 +4219,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4101,1 +4228,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4113,8 +4240,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4123,1 +4243,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4126,1 +4246,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4134,0 +4256,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4135,1 +4280,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4145,1 +4290,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4159,8 +4304,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4169,1 +4307,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4172,1 +4310,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4181,1 +4321,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4190,1 +4330,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4202,8 +4342,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4212,1 +4345,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4215,1 +4348,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4223,0 +4358,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4224,1 +4382,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4234,1 +4392,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4248,8 +4406,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4258,1 +4409,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4261,1 +4412,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4270,1 +4423,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4279,1 +4432,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4291,8 +4444,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4301,1 +4447,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4304,1 +4450,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4312,0 +4460,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4313,1 +4484,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4323,1 +4494,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4337,8 +4508,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4347,1 +4511,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4350,1 +4514,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int64VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3474,1 +3486,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3483,1 +3495,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3495,8 +3507,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3505,1 +3510,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3508,1 +3513,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3516,0 +3523,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id & x), x);\n+                Assert.assertEquals((int) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3517,1 +3547,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3527,1 +3557,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3541,1 +3571,1 @@\n-        int ra = -1;\n+        int ra = AND_IDENTITY;\n@@ -3551,1 +3581,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3563,1 +3593,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3572,1 +3602,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3587,0 +3617,1 @@\n+            ra = OR_IDENTITY;\n@@ -3589,9 +3620,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3605,0 +3630,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id | x), x);\n+                Assert.assertEquals((int) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3606,1 +3654,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3616,1 +3664,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3630,1 +3678,1 @@\n-        int ra = 0;\n+        int ra = OR_IDENTITY;\n@@ -3640,1 +3688,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3652,1 +3700,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3661,1 +3709,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3676,0 +3724,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3678,9 +3727,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3694,0 +3737,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id ^ x), x);\n+                Assert.assertEquals((int) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3695,1 +3761,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3705,1 +3771,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3719,1 +3785,1 @@\n-        int ra = 0;\n+        int ra = XOR_IDENTITY;\n@@ -3729,1 +3795,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3741,1 +3807,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3750,1 +3816,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3765,0 +3831,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3767,9 +3834,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3783,0 +3844,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id + x), x);\n+                Assert.assertEquals((int) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3784,1 +3868,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3794,1 +3878,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3808,1 +3892,1 @@\n-        int ra = 0;\n+        int ra = ADD_IDENTITY;\n@@ -3818,1 +3902,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3830,1 +3914,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3839,1 +3923,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3851,8 +3935,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -3861,1 +3938,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3864,1 +3941,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3872,0 +3951,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) (id * x), x);\n+                Assert.assertEquals((int) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3873,1 +3975,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3883,1 +3985,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -3897,1 +3999,1 @@\n-        int ra = 1;\n+        int ra = MUL_IDENTITY;\n@@ -3907,1 +4009,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3919,1 +4021,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3928,1 +4030,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3940,8 +4042,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -3950,1 +4045,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3953,1 +4048,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -3961,0 +4058,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.min(id, x), x);\n+                Assert.assertEquals((int) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3962,1 +4082,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3972,1 +4092,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -3986,8 +4106,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3996,1 +4109,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3999,1 +4112,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4008,1 +4123,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4017,1 +4132,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4029,8 +4144,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4039,1 +4147,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4042,1 +4150,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4050,0 +4160,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) Math.max(id, x), x);\n+                Assert.assertEquals((int) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4051,1 +4184,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4061,1 +4194,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4075,8 +4208,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4085,1 +4211,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4088,1 +4214,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4097,1 +4225,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4106,1 +4234,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4118,8 +4246,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4128,1 +4249,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4131,1 +4252,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4139,0 +4262,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4140,1 +4286,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4150,1 +4296,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4164,8 +4310,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4174,1 +4313,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4177,1 +4316,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4186,1 +4327,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4195,1 +4336,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4207,8 +4348,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4217,1 +4351,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4220,1 +4354,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4228,0 +4364,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4229,1 +4388,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4239,1 +4398,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4253,8 +4412,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4263,1 +4415,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4266,1 +4418,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4275,1 +4429,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4284,1 +4438,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4296,8 +4450,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4306,1 +4453,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4309,1 +4456,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4317,0 +4466,23 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        int x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4318,1 +4490,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4328,1 +4500,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4342,8 +4514,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4352,1 +4517,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4355,1 +4520,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/IntMaxVectorTests.java","additions":365,"deletions":198,"binary":false,"changes":563,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3491,1 +3502,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3500,1 +3511,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3512,8 +3523,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3522,1 +3526,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3525,1 +3529,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3533,0 +3539,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id & x), x);\n+                Assert.assertEquals((long) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3534,1 +3563,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3544,1 +3573,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        long ra = -1;\n+        long ra = AND_IDENTITY;\n@@ -3568,1 +3597,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3580,1 +3609,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3589,1 +3618,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3604,0 +3633,1 @@\n+            ra = OR_IDENTITY;\n@@ -3606,9 +3636,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3622,0 +3646,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id | x), x);\n+                Assert.assertEquals((long) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3623,1 +3670,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3633,1 +3680,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        long ra = 0;\n+        long ra = OR_IDENTITY;\n@@ -3657,1 +3704,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3669,1 +3716,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3678,1 +3725,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3693,0 +3740,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3695,9 +3743,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3711,0 +3753,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id ^ x), x);\n+                Assert.assertEquals((long) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3712,1 +3777,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3722,1 +3787,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        long ra = 0;\n+        long ra = XOR_IDENTITY;\n@@ -3746,1 +3811,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3758,1 +3823,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3767,1 +3832,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3782,0 +3847,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3784,9 +3850,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3800,0 +3860,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id + x), x);\n+                Assert.assertEquals((long) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3801,1 +3884,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3811,1 +3894,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        long ra = 0;\n+        long ra = ADD_IDENTITY;\n@@ -3835,1 +3918,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3847,1 +3930,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3856,1 +3939,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3868,8 +3951,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -3878,1 +3954,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3881,1 +3957,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3889,0 +3967,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id * x), x);\n+                Assert.assertEquals((long) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3890,1 +3991,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3900,1 +4001,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        long ra = 1;\n+        long ra = MUL_IDENTITY;\n@@ -3924,1 +4025,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3936,1 +4037,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3945,1 +4046,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3957,8 +4058,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -3967,1 +4061,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3970,1 +4064,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -3978,0 +4074,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.min(id, x), x);\n+                Assert.assertEquals((long) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3979,1 +4098,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3989,1 +4108,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4003,8 +4122,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4013,1 +4125,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4016,1 +4128,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4025,1 +4139,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4034,1 +4148,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4046,8 +4160,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4056,1 +4163,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4059,1 +4166,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4067,0 +4176,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.max(id, x), x);\n+                Assert.assertEquals((long) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4068,1 +4200,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4078,1 +4210,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4092,8 +4224,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4102,1 +4227,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4105,1 +4230,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4114,1 +4241,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4123,1 +4250,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4135,8 +4262,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4145,1 +4265,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4148,1 +4268,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4156,0 +4278,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4157,1 +4302,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4167,1 +4312,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4181,8 +4326,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4191,1 +4329,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4194,1 +4332,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4203,1 +4343,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4212,1 +4352,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4224,8 +4364,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4234,1 +4367,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4237,1 +4370,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4245,0 +4380,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4246,1 +4404,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4256,1 +4414,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4270,8 +4428,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4280,1 +4431,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4283,1 +4434,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4292,1 +4445,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4301,1 +4454,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4313,8 +4466,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4323,1 +4469,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4326,1 +4472,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4334,0 +4482,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4335,1 +4506,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4345,1 +4516,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4359,8 +4530,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4369,1 +4533,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4372,1 +4536,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long128VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3491,1 +3502,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3500,1 +3511,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3512,8 +3523,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3522,1 +3526,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3525,1 +3529,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3533,0 +3539,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id & x), x);\n+                Assert.assertEquals((long) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3534,1 +3563,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3544,1 +3573,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        long ra = -1;\n+        long ra = AND_IDENTITY;\n@@ -3568,1 +3597,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3580,1 +3609,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3589,1 +3618,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3604,0 +3633,1 @@\n+            ra = OR_IDENTITY;\n@@ -3606,9 +3636,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3622,0 +3646,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id | x), x);\n+                Assert.assertEquals((long) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3623,1 +3670,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3633,1 +3680,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        long ra = 0;\n+        long ra = OR_IDENTITY;\n@@ -3657,1 +3704,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3669,1 +3716,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3678,1 +3725,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3693,0 +3740,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3695,9 +3743,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3711,0 +3753,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id ^ x), x);\n+                Assert.assertEquals((long) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3712,1 +3777,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3722,1 +3787,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        long ra = 0;\n+        long ra = XOR_IDENTITY;\n@@ -3746,1 +3811,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3758,1 +3823,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3767,1 +3832,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3782,0 +3847,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3784,9 +3850,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3800,0 +3860,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id + x), x);\n+                Assert.assertEquals((long) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3801,1 +3884,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3811,1 +3894,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        long ra = 0;\n+        long ra = ADD_IDENTITY;\n@@ -3835,1 +3918,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3847,1 +3930,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3856,1 +3939,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3868,8 +3951,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -3878,1 +3954,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3881,1 +3957,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3889,0 +3967,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id * x), x);\n+                Assert.assertEquals((long) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3890,1 +3991,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3900,1 +4001,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        long ra = 1;\n+        long ra = MUL_IDENTITY;\n@@ -3924,1 +4025,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3936,1 +4037,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3945,1 +4046,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3957,8 +4058,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -3967,1 +4061,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3970,1 +4064,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -3978,0 +4074,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.min(id, x), x);\n+                Assert.assertEquals((long) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3979,1 +4098,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3989,1 +4108,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4003,8 +4122,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4013,1 +4125,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4016,1 +4128,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4025,1 +4139,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4034,1 +4148,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4046,8 +4160,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4056,1 +4163,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4059,1 +4166,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4067,0 +4176,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.max(id, x), x);\n+                Assert.assertEquals((long) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4068,1 +4200,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4078,1 +4210,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4092,8 +4224,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4102,1 +4227,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4105,1 +4230,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4114,1 +4241,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4123,1 +4250,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4135,8 +4262,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4145,1 +4265,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4148,1 +4268,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4156,0 +4278,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4157,1 +4302,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4167,1 +4312,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4181,8 +4326,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4191,1 +4329,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4194,1 +4332,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4203,1 +4343,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4212,1 +4352,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4224,8 +4364,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4234,1 +4367,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4237,1 +4370,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4245,0 +4380,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4246,1 +4404,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4256,1 +4414,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4270,8 +4428,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4280,1 +4431,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4283,1 +4434,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4292,1 +4445,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4301,1 +4454,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4313,8 +4466,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4323,1 +4469,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4326,1 +4472,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4334,0 +4482,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4335,1 +4506,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4345,1 +4516,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4359,8 +4530,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4369,1 +4533,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4372,1 +4536,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long256VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3491,1 +3502,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3500,1 +3511,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3512,8 +3523,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3522,1 +3526,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3525,1 +3529,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3533,0 +3539,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id & x), x);\n+                Assert.assertEquals((long) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3534,1 +3563,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3544,1 +3573,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        long ra = -1;\n+        long ra = AND_IDENTITY;\n@@ -3568,1 +3597,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3580,1 +3609,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3589,1 +3618,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3604,0 +3633,1 @@\n+            ra = OR_IDENTITY;\n@@ -3606,9 +3636,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3622,0 +3646,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id | x), x);\n+                Assert.assertEquals((long) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3623,1 +3670,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3633,1 +3680,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        long ra = 0;\n+        long ra = OR_IDENTITY;\n@@ -3657,1 +3704,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3669,1 +3716,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3678,1 +3725,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3693,0 +3740,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3695,9 +3743,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3711,0 +3753,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id ^ x), x);\n+                Assert.assertEquals((long) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3712,1 +3777,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3722,1 +3787,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        long ra = 0;\n+        long ra = XOR_IDENTITY;\n@@ -3746,1 +3811,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3758,1 +3823,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3767,1 +3832,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3782,0 +3847,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3784,9 +3850,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3800,0 +3860,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id + x), x);\n+                Assert.assertEquals((long) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3801,1 +3884,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3811,1 +3894,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        long ra = 0;\n+        long ra = ADD_IDENTITY;\n@@ -3835,1 +3918,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3847,1 +3930,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3856,1 +3939,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3868,8 +3951,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -3878,1 +3954,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3881,1 +3957,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3889,0 +3967,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id * x), x);\n+                Assert.assertEquals((long) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3890,1 +3991,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3900,1 +4001,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        long ra = 1;\n+        long ra = MUL_IDENTITY;\n@@ -3924,1 +4025,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3936,1 +4037,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3945,1 +4046,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3957,8 +4058,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -3967,1 +4061,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3970,1 +4064,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -3978,0 +4074,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.min(id, x), x);\n+                Assert.assertEquals((long) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3979,1 +4098,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3989,1 +4108,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4003,8 +4122,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4013,1 +4125,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4016,1 +4128,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4025,1 +4139,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4034,1 +4148,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4046,8 +4160,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4056,1 +4163,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4059,1 +4166,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4067,0 +4176,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.max(id, x), x);\n+                Assert.assertEquals((long) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4068,1 +4200,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4078,1 +4210,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4092,8 +4224,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4102,1 +4227,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4105,1 +4230,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4114,1 +4241,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4123,1 +4250,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4135,8 +4262,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4145,1 +4265,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4148,1 +4268,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4156,0 +4278,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4157,1 +4302,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4167,1 +4312,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4181,8 +4326,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4191,1 +4329,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4194,1 +4332,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4203,1 +4343,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4212,1 +4352,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4224,8 +4364,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4234,1 +4367,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4237,1 +4370,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4245,0 +4380,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4246,1 +4404,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4256,1 +4414,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4270,8 +4428,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4280,1 +4431,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4283,1 +4434,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4292,1 +4445,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4301,1 +4454,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4313,8 +4466,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4323,1 +4469,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4326,1 +4472,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4334,0 +4482,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4335,1 +4506,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4345,1 +4516,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4359,8 +4530,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4369,1 +4533,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4372,1 +4536,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long512VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3491,1 +3502,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3500,1 +3511,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3512,8 +3523,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3522,1 +3526,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3525,1 +3529,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3533,0 +3539,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id & x), x);\n+                Assert.assertEquals((long) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3534,1 +3563,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3544,1 +3573,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3558,1 +3587,1 @@\n-        long ra = -1;\n+        long ra = AND_IDENTITY;\n@@ -3568,1 +3597,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3580,1 +3609,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3589,1 +3618,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3604,0 +3633,1 @@\n+            ra = OR_IDENTITY;\n@@ -3606,9 +3636,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3622,0 +3646,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id | x), x);\n+                Assert.assertEquals((long) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3623,1 +3670,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3633,1 +3680,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3647,1 +3694,1 @@\n-        long ra = 0;\n+        long ra = OR_IDENTITY;\n@@ -3657,1 +3704,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3669,1 +3716,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3678,1 +3725,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3693,0 +3740,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3695,9 +3743,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3711,0 +3753,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id ^ x), x);\n+                Assert.assertEquals((long) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3712,1 +3777,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3722,1 +3787,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3736,1 +3801,1 @@\n-        long ra = 0;\n+        long ra = XOR_IDENTITY;\n@@ -3746,1 +3811,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3758,1 +3823,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3767,1 +3832,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3782,0 +3847,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3784,9 +3850,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3800,0 +3860,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id + x), x);\n+                Assert.assertEquals((long) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3801,1 +3884,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3811,1 +3894,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3825,1 +3908,1 @@\n-        long ra = 0;\n+        long ra = ADD_IDENTITY;\n@@ -3835,1 +3918,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3847,1 +3930,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3856,1 +3939,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3868,8 +3951,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -3878,1 +3954,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3881,1 +3957,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3889,0 +3967,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id * x), x);\n+                Assert.assertEquals((long) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3890,1 +3991,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3900,1 +4001,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3914,1 +4015,1 @@\n-        long ra = 1;\n+        long ra = MUL_IDENTITY;\n@@ -3924,1 +4025,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3936,1 +4037,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3945,1 +4046,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3957,8 +4058,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -3967,1 +4061,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3970,1 +4064,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -3978,0 +4074,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.min(id, x), x);\n+                Assert.assertEquals((long) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3979,1 +4098,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3989,1 +4108,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4003,8 +4122,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4013,1 +4125,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4016,1 +4128,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4025,1 +4139,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4034,1 +4148,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4046,8 +4160,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4056,1 +4163,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4059,1 +4166,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4067,0 +4176,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.max(id, x), x);\n+                Assert.assertEquals((long) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4068,1 +4200,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4078,1 +4210,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4092,8 +4224,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4102,1 +4227,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4105,1 +4230,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4114,1 +4241,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4123,1 +4250,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4135,8 +4262,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4145,1 +4265,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4148,1 +4268,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4156,0 +4278,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4157,1 +4302,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4167,1 +4312,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4181,8 +4326,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4191,1 +4329,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4194,1 +4332,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4203,1 +4343,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4212,1 +4352,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4224,8 +4364,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4234,1 +4367,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4237,1 +4370,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4245,0 +4380,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4246,1 +4404,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4256,1 +4414,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4270,8 +4428,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4280,1 +4431,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4283,1 +4434,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4292,1 +4445,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4301,1 +4454,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4313,8 +4466,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4323,1 +4469,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4326,1 +4472,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4334,0 +4482,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4335,1 +4506,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4345,1 +4516,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4359,8 +4530,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4369,1 +4533,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4372,1 +4536,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long64VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3496,1 +3508,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3505,1 +3517,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3517,8 +3529,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3527,1 +3532,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3530,1 +3535,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3538,0 +3545,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id & x), x);\n+                Assert.assertEquals((long) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3539,1 +3569,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3549,1 +3579,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3563,1 +3593,1 @@\n-        long ra = -1;\n+        long ra = AND_IDENTITY;\n@@ -3573,1 +3603,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3585,1 +3615,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3594,1 +3624,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3609,0 +3639,1 @@\n+            ra = OR_IDENTITY;\n@@ -3611,9 +3642,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3627,0 +3652,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id | x), x);\n+                Assert.assertEquals((long) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3628,1 +3676,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3638,1 +3686,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3652,1 +3700,1 @@\n-        long ra = 0;\n+        long ra = OR_IDENTITY;\n@@ -3662,1 +3710,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3674,1 +3722,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3683,1 +3731,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3698,0 +3746,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3700,9 +3749,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3716,0 +3759,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id ^ x), x);\n+                Assert.assertEquals((long) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3717,1 +3783,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3727,1 +3793,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3741,1 +3807,1 @@\n-        long ra = 0;\n+        long ra = XOR_IDENTITY;\n@@ -3751,1 +3817,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3763,1 +3829,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3772,1 +3838,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3787,0 +3853,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3789,9 +3856,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3805,0 +3866,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id + x), x);\n+                Assert.assertEquals((long) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3806,1 +3890,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3816,1 +3900,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3830,1 +3914,1 @@\n-        long ra = 0;\n+        long ra = ADD_IDENTITY;\n@@ -3840,1 +3924,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3852,1 +3936,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3861,1 +3945,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3873,8 +3957,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -3883,1 +3960,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3886,1 +3963,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3894,0 +3973,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) (id * x), x);\n+                Assert.assertEquals((long) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3895,1 +3997,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3905,1 +4007,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -3919,1 +4021,1 @@\n-        long ra = 1;\n+        long ra = MUL_IDENTITY;\n@@ -3929,1 +4031,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3941,1 +4043,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3950,1 +4052,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3962,8 +4064,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -3972,1 +4067,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3975,1 +4070,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -3983,0 +4080,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.min(id, x), x);\n+                Assert.assertEquals((long) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3984,1 +4104,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -3994,1 +4114,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4008,8 +4128,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4018,1 +4131,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4021,1 +4134,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4030,1 +4145,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4039,1 +4154,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4051,8 +4166,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4061,1 +4169,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4064,1 +4172,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4072,0 +4182,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) Math.max(id, x), x);\n+                Assert.assertEquals((long) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4073,1 +4206,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4083,1 +4216,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4097,8 +4230,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4107,1 +4233,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4110,1 +4236,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4119,1 +4247,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4128,1 +4256,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4140,8 +4268,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4150,1 +4271,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4153,1 +4274,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4161,0 +4284,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4162,1 +4308,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4172,1 +4318,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4186,8 +4332,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4196,1 +4335,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4199,1 +4338,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4208,1 +4349,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4217,1 +4358,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4229,8 +4370,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4239,1 +4373,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4242,1 +4376,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4250,0 +4386,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4251,1 +4410,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4261,1 +4420,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4275,8 +4434,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4285,1 +4437,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4288,1 +4440,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4297,1 +4451,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4306,1 +4460,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4318,8 +4472,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4328,1 +4475,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4331,1 +4478,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4339,0 +4488,23 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        long x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4340,1 +4512,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4350,1 +4522,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4364,8 +4536,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4374,1 +4539,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4377,1 +4542,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/LongMaxVectorTests.java","additions":365,"deletions":198,"binary":false,"changes":563,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3416,1 +3427,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3425,1 +3436,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3437,8 +3448,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3447,1 +3451,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3450,1 +3454,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3458,0 +3464,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id & x), x);\n+                Assert.assertEquals((short) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3459,1 +3488,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3469,1 +3498,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3483,1 +3512,1 @@\n-        short ra = -1;\n+        short ra = AND_IDENTITY;\n@@ -3493,1 +3522,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3505,1 +3534,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3529,0 +3558,1 @@\n+            ra = OR_IDENTITY;\n@@ -3531,9 +3561,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3547,0 +3571,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id | x), x);\n+                Assert.assertEquals((short) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3548,1 +3595,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3558,1 +3605,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3572,1 +3619,1 @@\n-        short ra = 0;\n+        short ra = OR_IDENTITY;\n@@ -3582,1 +3629,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3594,1 +3641,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3618,0 +3665,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3620,9 +3668,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3636,0 +3678,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id ^ x), x);\n+                Assert.assertEquals((short) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3637,1 +3702,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3647,1 +3712,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3661,1 +3726,1 @@\n-        short ra = 0;\n+        short ra = XOR_IDENTITY;\n@@ -3671,1 +3736,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3683,1 +3748,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3707,0 +3772,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3709,9 +3775,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3725,0 +3785,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id + x), x);\n+                Assert.assertEquals((short) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3726,1 +3809,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3736,1 +3819,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3750,1 +3833,1 @@\n-        short ra = 0;\n+        short ra = ADD_IDENTITY;\n@@ -3760,1 +3843,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3772,1 +3855,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3793,8 +3876,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3803,1 +3879,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3806,1 +3882,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3814,0 +3892,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id * x), x);\n+                Assert.assertEquals((short) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3815,1 +3916,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3825,1 +3926,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3839,1 +3940,1 @@\n-        short ra = 1;\n+        short ra = MUL_IDENTITY;\n@@ -3849,1 +3950,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3861,1 +3962,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3882,8 +3983,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -3892,1 +3986,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3895,1 +3989,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3903,0 +3999,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.min(id, x), x);\n+                Assert.assertEquals((short) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3904,1 +4023,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3914,1 +4033,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3928,8 +4047,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3938,1 +4050,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3941,1 +4053,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3950,1 +4064,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3959,1 +4073,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3971,8 +4085,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -3981,1 +4088,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3984,1 +4091,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -3992,0 +4101,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.max(id, x), x);\n+                Assert.assertEquals((short) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3993,1 +4125,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4003,1 +4135,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4017,8 +4149,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4027,1 +4152,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4030,1 +4155,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4039,1 +4166,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4048,1 +4175,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4060,8 +4187,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4070,1 +4190,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4073,1 +4193,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4081,0 +4203,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4082,1 +4227,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4092,1 +4237,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4106,8 +4251,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4116,1 +4254,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4119,1 +4257,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4128,1 +4268,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4137,1 +4277,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4149,8 +4289,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4159,1 +4292,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4162,1 +4295,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4170,0 +4305,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4171,1 +4329,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4181,1 +4339,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4195,8 +4353,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4205,1 +4356,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4208,1 +4359,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4217,1 +4370,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4226,1 +4379,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4238,8 +4391,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4248,1 +4394,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4251,1 +4397,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4259,0 +4407,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4260,1 +4431,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4270,1 +4441,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4284,8 +4455,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4294,1 +4458,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4297,1 +4461,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short128VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3416,1 +3427,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3425,1 +3436,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3437,8 +3448,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3447,1 +3451,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3450,1 +3454,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3458,0 +3464,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id & x), x);\n+                Assert.assertEquals((short) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3459,1 +3488,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3469,1 +3498,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3483,1 +3512,1 @@\n-        short ra = -1;\n+        short ra = AND_IDENTITY;\n@@ -3493,1 +3522,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3505,1 +3534,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3529,0 +3558,1 @@\n+            ra = OR_IDENTITY;\n@@ -3531,9 +3561,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3547,0 +3571,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id | x), x);\n+                Assert.assertEquals((short) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3548,1 +3595,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3558,1 +3605,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3572,1 +3619,1 @@\n-        short ra = 0;\n+        short ra = OR_IDENTITY;\n@@ -3582,1 +3629,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3594,1 +3641,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3618,0 +3665,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3620,9 +3668,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3636,0 +3678,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id ^ x), x);\n+                Assert.assertEquals((short) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3637,1 +3702,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3647,1 +3712,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3661,1 +3726,1 @@\n-        short ra = 0;\n+        short ra = XOR_IDENTITY;\n@@ -3671,1 +3736,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3683,1 +3748,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3707,0 +3772,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3709,9 +3775,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3725,0 +3785,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id + x), x);\n+                Assert.assertEquals((short) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3726,1 +3809,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3736,1 +3819,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3750,1 +3833,1 @@\n-        short ra = 0;\n+        short ra = ADD_IDENTITY;\n@@ -3760,1 +3843,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3772,1 +3855,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3793,8 +3876,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3803,1 +3879,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3806,1 +3882,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3814,0 +3892,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id * x), x);\n+                Assert.assertEquals((short) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3815,1 +3916,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3825,1 +3926,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3839,1 +3940,1 @@\n-        short ra = 1;\n+        short ra = MUL_IDENTITY;\n@@ -3849,1 +3950,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3861,1 +3962,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3882,8 +3983,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -3892,1 +3986,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3895,1 +3989,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3903,0 +3999,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.min(id, x), x);\n+                Assert.assertEquals((short) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3904,1 +4023,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3914,1 +4033,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3928,8 +4047,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3938,1 +4050,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3941,1 +4053,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3950,1 +4064,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3959,1 +4073,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3971,8 +4085,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -3981,1 +4088,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3984,1 +4091,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -3992,0 +4101,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.max(id, x), x);\n+                Assert.assertEquals((short) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3993,1 +4125,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4003,1 +4135,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4017,8 +4149,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4027,1 +4152,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4030,1 +4155,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4039,1 +4166,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4048,1 +4175,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4060,8 +4187,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4070,1 +4190,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4073,1 +4193,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4081,0 +4203,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4082,1 +4227,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4092,1 +4237,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4106,8 +4251,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4116,1 +4254,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4119,1 +4257,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4128,1 +4268,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4137,1 +4277,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4149,8 +4289,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4159,1 +4292,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4162,1 +4295,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4170,0 +4305,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4171,1 +4329,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4181,1 +4339,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4195,8 +4353,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4205,1 +4356,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4208,1 +4359,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4217,1 +4370,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4226,1 +4379,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4238,8 +4391,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4248,1 +4394,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4251,1 +4397,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4259,0 +4407,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4260,1 +4431,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4270,1 +4441,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4284,8 +4455,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4294,1 +4458,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4297,1 +4461,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short256VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3416,1 +3427,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3425,1 +3436,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3437,8 +3448,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3447,1 +3451,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3450,1 +3454,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3458,0 +3464,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id & x), x);\n+                Assert.assertEquals((short) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3459,1 +3488,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3469,1 +3498,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3483,1 +3512,1 @@\n-        short ra = -1;\n+        short ra = AND_IDENTITY;\n@@ -3493,1 +3522,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3505,1 +3534,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3529,0 +3558,1 @@\n+            ra = OR_IDENTITY;\n@@ -3531,9 +3561,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3547,0 +3571,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id | x), x);\n+                Assert.assertEquals((short) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3548,1 +3595,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3558,1 +3605,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3572,1 +3619,1 @@\n-        short ra = 0;\n+        short ra = OR_IDENTITY;\n@@ -3582,1 +3629,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3594,1 +3641,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3618,0 +3665,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3620,9 +3668,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3636,0 +3678,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id ^ x), x);\n+                Assert.assertEquals((short) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3637,1 +3702,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3647,1 +3712,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3661,1 +3726,1 @@\n-        short ra = 0;\n+        short ra = XOR_IDENTITY;\n@@ -3671,1 +3736,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3683,1 +3748,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3707,0 +3772,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3709,9 +3775,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3725,0 +3785,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id + x), x);\n+                Assert.assertEquals((short) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3726,1 +3809,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3736,1 +3819,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3750,1 +3833,1 @@\n-        short ra = 0;\n+        short ra = ADD_IDENTITY;\n@@ -3760,1 +3843,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3772,1 +3855,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3793,8 +3876,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3803,1 +3879,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3806,1 +3882,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3814,0 +3892,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id * x), x);\n+                Assert.assertEquals((short) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3815,1 +3916,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3825,1 +3926,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3839,1 +3940,1 @@\n-        short ra = 1;\n+        short ra = MUL_IDENTITY;\n@@ -3849,1 +3950,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3861,1 +3962,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3882,8 +3983,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -3892,1 +3986,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3895,1 +3989,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3903,0 +3999,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.min(id, x), x);\n+                Assert.assertEquals((short) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3904,1 +4023,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3914,1 +4033,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3928,8 +4047,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3938,1 +4050,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3941,1 +4053,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3950,1 +4064,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3959,1 +4073,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3971,8 +4085,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -3981,1 +4088,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3984,1 +4091,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -3992,0 +4101,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.max(id, x), x);\n+                Assert.assertEquals((short) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3993,1 +4125,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4003,1 +4135,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4017,8 +4149,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4027,1 +4152,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4030,1 +4155,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4039,1 +4166,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4048,1 +4175,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4060,8 +4187,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4070,1 +4190,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4073,1 +4193,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4081,0 +4203,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4082,1 +4227,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4092,1 +4237,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4106,8 +4251,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4116,1 +4254,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4119,1 +4257,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4128,1 +4268,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4137,1 +4277,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4149,8 +4289,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4159,1 +4292,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4162,1 +4295,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4170,0 +4305,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4171,1 +4329,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4181,1 +4339,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4195,8 +4353,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4205,1 +4356,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4208,1 +4359,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4217,1 +4370,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4226,1 +4379,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4238,8 +4391,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4248,1 +4394,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4251,1 +4397,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4259,0 +4407,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4260,1 +4431,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4270,1 +4441,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4284,8 +4455,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4294,1 +4458,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4297,1 +4461,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short512VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3416,1 +3427,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3425,1 +3436,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3437,8 +3448,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3447,1 +3451,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3450,1 +3454,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3458,0 +3464,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id & x), x);\n+                Assert.assertEquals((short) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3459,1 +3488,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3469,1 +3498,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3483,1 +3512,1 @@\n-        short ra = -1;\n+        short ra = AND_IDENTITY;\n@@ -3493,1 +3522,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3505,1 +3534,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3514,1 +3543,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3529,0 +3558,1 @@\n+            ra = OR_IDENTITY;\n@@ -3531,9 +3561,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3547,0 +3571,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id | x), x);\n+                Assert.assertEquals((short) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3548,1 +3595,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3558,1 +3605,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3572,1 +3619,1 @@\n-        short ra = 0;\n+        short ra = OR_IDENTITY;\n@@ -3582,1 +3629,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3594,1 +3641,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3603,1 +3650,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3618,0 +3665,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3620,9 +3668,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3636,0 +3678,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id ^ x), x);\n+                Assert.assertEquals((short) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3637,1 +3702,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3647,1 +3712,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3661,1 +3726,1 @@\n-        short ra = 0;\n+        short ra = XOR_IDENTITY;\n@@ -3671,1 +3736,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3683,1 +3748,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3692,1 +3757,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3707,0 +3772,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3709,9 +3775,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3725,0 +3785,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id + x), x);\n+                Assert.assertEquals((short) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3726,1 +3809,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3736,1 +3819,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3750,1 +3833,1 @@\n-        short ra = 0;\n+        short ra = ADD_IDENTITY;\n@@ -3760,1 +3843,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3772,1 +3855,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3781,1 +3864,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3793,8 +3876,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3803,1 +3879,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3806,1 +3882,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3814,0 +3892,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id * x), x);\n+                Assert.assertEquals((short) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3815,1 +3916,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3825,1 +3926,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3839,1 +3940,1 @@\n-        short ra = 1;\n+        short ra = MUL_IDENTITY;\n@@ -3849,1 +3950,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3861,1 +3962,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3870,1 +3971,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3882,8 +3983,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -3892,1 +3986,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3895,1 +3989,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3903,0 +3999,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.min(id, x), x);\n+                Assert.assertEquals((short) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3904,1 +4023,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3914,1 +4033,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3928,8 +4047,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3938,1 +4050,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3941,1 +4053,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3950,1 +4064,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3959,1 +4073,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3971,8 +4085,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -3981,1 +4088,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3984,1 +4091,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -3992,0 +4101,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.max(id, x), x);\n+                Assert.assertEquals((short) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3993,1 +4125,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4003,1 +4135,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4017,8 +4149,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4027,1 +4152,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4030,1 +4155,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4039,1 +4166,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4048,1 +4175,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4060,8 +4187,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4070,1 +4190,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4073,1 +4193,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4081,0 +4203,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4082,1 +4227,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4092,1 +4237,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4106,8 +4251,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4116,1 +4254,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4119,1 +4257,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4128,1 +4268,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4137,1 +4277,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4149,8 +4289,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4159,1 +4292,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4162,1 +4295,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4170,0 +4305,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4171,1 +4329,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4181,1 +4339,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4195,8 +4353,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4205,1 +4356,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4208,1 +4359,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4217,1 +4370,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4226,1 +4379,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4238,8 +4391,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4248,1 +4394,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4251,1 +4397,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4259,0 +4407,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4260,1 +4431,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4270,1 +4441,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4284,8 +4455,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4294,1 +4458,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4297,1 +4461,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short64VectorTests.java","additions":365,"deletions":199,"binary":false,"changes":564,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,12 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3421,1 +3433,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3430,1 +3442,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3442,8 +3454,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3452,1 +3457,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3455,1 +3460,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3463,0 +3470,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id & x), x);\n+                Assert.assertEquals((short) (x & id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3464,1 +3494,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3474,1 +3504,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3488,1 +3518,1 @@\n-        short ra = -1;\n+        short ra = AND_IDENTITY;\n@@ -3498,1 +3528,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3510,1 +3540,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3519,1 +3549,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3534,0 +3564,1 @@\n+            ra = OR_IDENTITY;\n@@ -3536,9 +3567,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3552,0 +3577,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id | x), x);\n+                Assert.assertEquals((short) (x | id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3553,1 +3601,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3563,1 +3611,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3577,1 +3625,1 @@\n-        short ra = 0;\n+        short ra = OR_IDENTITY;\n@@ -3587,1 +3635,1 @@\n-            ra = 0;\n+            ra = OR_IDENTITY;\n@@ -3599,1 +3647,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3608,1 +3656,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3623,0 +3671,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3625,9 +3674,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3641,0 +3684,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id ^ x), x);\n+                Assert.assertEquals((short) (x ^ id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3642,1 +3708,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3652,1 +3718,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3666,1 +3732,1 @@\n-        short ra = 0;\n+        short ra = XOR_IDENTITY;\n@@ -3676,1 +3742,1 @@\n-            ra = 0;\n+            ra = XOR_IDENTITY;\n@@ -3688,1 +3754,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3697,1 +3763,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3712,0 +3778,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3714,9 +3781,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3730,0 +3791,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id + x), x);\n+                Assert.assertEquals((short) (x + id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3731,1 +3815,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3741,1 +3825,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3755,1 +3839,1 @@\n-        short ra = 0;\n+        short ra = ADD_IDENTITY;\n@@ -3765,1 +3849,1 @@\n-            ra = 0;\n+            ra = ADD_IDENTITY;\n@@ -3777,1 +3861,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3786,1 +3870,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3798,8 +3882,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3808,1 +3885,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3811,1 +3888,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -3819,0 +3898,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) (id * x), x);\n+                Assert.assertEquals((short) (x * id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3820,1 +3922,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3830,1 +3932,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3844,1 +3946,1 @@\n-        short ra = 1;\n+        short ra = MUL_IDENTITY;\n@@ -3854,1 +3956,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3866,1 +3968,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3875,1 +3977,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3887,8 +3989,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -3897,1 +3992,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3900,1 +3995,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3908,0 +4005,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.min(id, x), x);\n+                Assert.assertEquals((short) Math.min(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3909,1 +4029,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3919,1 +4039,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -3933,8 +4053,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3943,1 +4056,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -3946,1 +4059,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -3955,1 +4070,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3964,1 +4079,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -3976,8 +4091,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -3986,1 +4094,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -3989,1 +4097,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -3997,0 +4107,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) Math.max(id, x), x);\n+                Assert.assertEquals((short) Math.max(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3998,1 +4131,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4008,1 +4141,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4022,8 +4155,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4032,1 +4158,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4035,1 +4161,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4044,1 +4172,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4053,1 +4181,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4065,8 +4193,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4075,1 +4196,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4078,1 +4199,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4086,0 +4209,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4087,1 +4233,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4097,1 +4243,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4111,8 +4257,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4121,1 +4260,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4124,1 +4263,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4133,1 +4274,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4142,1 +4283,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4154,8 +4295,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4164,1 +4298,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4167,1 +4301,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4175,0 +4311,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x);\n+                Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4176,1 +4335,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4186,1 +4345,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4200,8 +4359,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4210,1 +4362,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4213,1 +4365,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4222,1 +4376,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4231,1 +4385,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4243,8 +4397,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4253,1 +4400,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4256,1 +4403,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4264,0 +4413,23 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        short x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(firstNonZero(id, x), x);\n+                Assert.assertEquals(firstNonZero(x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4265,1 +4437,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4275,1 +4447,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4289,8 +4461,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4299,1 +4464,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4302,1 +4467,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/ShortMaxVectorTests.java","additions":365,"deletions":198,"binary":false,"changes":563,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n-# Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -492,10 +492,10 @@\n-gen_reduction_op \"AND\" \"\\&\" \"BITWISE\" \"-1\"\n-gen_reduction_op \"OR\" \"|\" \"BITWISE\" \"0\"\n-gen_reduction_op \"XOR\" \"^\" \"BITWISE\" \"0\"\n-gen_reduction_op \"ADD\" \"+\" \"\" \"0\"\n-gen_reduction_op \"MUL\" \"*\" \"\" \"1\"\n-gen_reduction_op_func \"MIN\" \"(\\$type\\$) Math.min\" \"\" \"\\$Wideboxtype\\$.\\$MaxValue\\$\"\n-gen_reduction_op_func \"MAX\" \"(\\$type\\$) Math.max\" \"\" \"\\$Wideboxtype\\$.\\$MinValue\\$\"\n-gen_reduction_op_func \"UMIN\" \"(\\$type\\$) VectorMath.minUnsigned\" \"BITWISE\" \"\\$Wideboxtype\\$.\\$MaxValue\\$\"\n-gen_reduction_op_func \"UMAX\" \"(\\$type\\$) VectorMath.maxUnsigned\" \"BITWISE\" \"\\$Wideboxtype\\$.\\$MinValue\\$\"\n-gen_reduction_op_func \"FIRST_NONZERO\" \"firstNonZero\" \"\" \"(\\$type\\$) 0\"\n+gen_reduction_op \"AND\" \"\\&\" \"BITWISE\" \"AND_IDENTITY\"\n+gen_reduction_op \"OR\" \"|\" \"BITWISE\" \"OR_IDENTITY\"\n+gen_reduction_op \"XOR\" \"^\" \"BITWISE\" \"XOR_IDENTITY\"\n+gen_reduction_op \"ADD\" \"+\" \"\" \"ADD_IDENTITY\"\n+gen_reduction_op \"MUL\" \"*\" \"\" \"MUL_IDENTITY\"\n+gen_reduction_op_func \"MIN\" \"(\\$type\\$) Math.min\" \"\" \"MIN_IDENTITY\"\n+gen_reduction_op_func \"MAX\" \"(\\$type\\$) Math.max\" \"\" \"MAX_IDENTITY\"\n+gen_reduction_op_func \"UMIN\" \"(\\$type\\$) VectorMath.minUnsigned\" \"BITWISE\" \"UMIN_IDENTITY\"\n+gen_reduction_op_func \"UMAX\" \"(\\$type\\$) VectorMath.maxUnsigned\" \"BITWISE\" \"UMAX_IDENTITY\"\n+gen_reduction_op_func \"FIRST_NONZERO\" \"firstNonZero\" \"\" \"FIRST_NONZERO_IDENTITY\"\n","filename":"test\/jdk\/jdk\/incubator\/vector\/gen-template.sh","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -5,8 +5,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -18,1 +11,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]], vmask));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-Masked-op-func.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3,8 +3,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]]);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -16,1 +9,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]]));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]]);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-op-func.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3,8 +3,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]]);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -16,1 +9,3 @@\n-                ra [[TEST_OP]]= av.reduceLanes(VectorOperators.[[TEST]]);\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]]);\n+                r[i] = v;\n+                ra [[TEST_OP]]= v;\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-op.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -8,0 +8,23 @@\n+\n+    @Test(dataProvider = \"$type$UnaryOpProvider\")\n+    static void [[TEST]]ReduceIdentityValueTests(IntFunction<$type$[]> fa) {\n+        $type$[] a = fa.apply(SPECIES.length());\n+        $type$ id = [[TEST_INIT]];\n+\n+        Assert.assertEquals([[TEST_OP]](id, id), id,\n+                            \"[[TEST]]([[TEST_INIT]], [[TEST_INIT]]) != [[TEST_INIT]]\");\n+\n+        $type$ x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals([[TEST_OP]](id, x), x);\n+                Assert.assertEquals([[TEST_OP]](x, id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals([[TEST_OP]](id, x), x,\n+                                \"[[TEST]]([[TEST_INIT]], \" + x + \") != \" + x);\n+            Assert.assertEquals([[TEST_OP]](x, id), x,\n+                                \"[[TEST]](\" + x + \", [[TEST_INIT]]) != \" + x);\n+        }\n+    }\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-Reduction-op-func.template","additions":23,"deletions":0,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -12,0 +12,23 @@\n+\n+    @Test(dataProvider = \"$type$UnaryOpProvider\")\n+    static void [[TEST]]ReduceIdentityValueTests(IntFunction<$type$[]> fa) {\n+        $type$[] a = fa.apply(SPECIES.length());\n+        $type$ id = [[TEST_INIT]];\n+\n+        Assert.assertEquals(($type$) (id [[TEST_OP]] id), id,\n+                            \"[[TEST]]([[TEST_INIT]], [[TEST_INIT]]) != [[TEST_INIT]]\");\n+\n+        $type$ x = 0;\n+        try {\n+            for (int i = 0; i < a.length; i++) {\n+                x = a[i];\n+                Assert.assertEquals(($type$) (id [[TEST_OP]] x), x);\n+                Assert.assertEquals(($type$) (x [[TEST_OP]] id), x);\n+            }\n+        } catch (AssertionError e) {\n+            Assert.assertEquals(($type$) (id [[TEST_OP]] x), x,\n+                                \"[[TEST]]([[TEST_INIT]], \" + x + \") != \" + x);\n+            Assert.assertEquals(($type$) (x [[TEST_OP]] id), x,\n+                                \"[[TEST]](\" + x + \", [[TEST_INIT]]) != \" + x);\n+        }\n+    }\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-Reduction-op.template","additions":23,"deletions":0,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -89,1 +89,0 @@\n-\n@@ -91,0 +90,1 @@\n+\n@@ -97,1 +97,0 @@\n-\n@@ -99,0 +98,1 @@\n+\n@@ -101,0 +101,16 @@\n+\n+    \/\/ Identity values for reduction operations\n+    private static final $type$ ADD_IDENTITY = ($type$)0;\n+#if[BITWISE]\n+    private static final $type$ AND_IDENTITY = ($type$)-1;\n+#end[BITWISE]\n+    private static final $type$ FIRST_NONZERO_IDENTITY = ($type$)0;\n+    private static final $type$ MAX_IDENTITY = $Wideboxtype$.$MinValue$;\n+    private static final $type$ MIN_IDENTITY = $Wideboxtype$.$MaxValue$;\n+    private static final $type$ MUL_IDENTITY = ($type$)1;\n+#if[BITWISE]\n+    private static final $type$ OR_IDENTITY = ($type$)0;\n+    private static final $type$ UMAX_IDENTITY = ($type$)0;   \/\/ Minimum unsigned value\n+    private static final $type$ UMIN_IDENTITY = ($type$)-1;  \/\/ Maximum unsigned value\n+    private static final $type$ XOR_IDENTITY = ($type$)0;\n+#end[BITWISE]\n@@ -102,0 +118,1 @@\n+\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-header.template","additions":20,"deletions":3,"binary":false,"changes":23,"status":"modified"}]}