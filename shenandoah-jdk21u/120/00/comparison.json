{"files":[{"patch":"@@ -256,0 +256,19 @@\n+\n+  \/\/ Do additional checks for special objects: their fields can hold metadata as well.\n+  \/\/ We want to check class loading\/unloading did not corrupt them.\n+\n+  if (java_lang_Class::is_instance(obj)) {\n+    Metadata* klass = obj->metadata_field(java_lang_Class::klass_offset());\n+    if (klass != nullptr && !Metaspace::contains(klass)) {\n+      print_failure(_safe_all, obj, interior_loc, nullptr, \"Shenandoah assert_correct failed\",\n+                    \"Instance class mirror should point to Metaspace\",\n+                    file, line);\n+    }\n+\n+    Metadata* array_klass = obj->metadata_field(java_lang_Class::array_klass_offset());\n+    if (array_klass != nullptr && !Metaspace::contains(array_klass)) {\n+      print_failure(_safe_all, obj, interior_loc, nullptr, \"Shenandoah assert_correct failed\",\n+                    \"Array class mirror should point to Metaspace\",\n+                    file, line);\n+    }\n+  }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAsserts.cpp","additions":19,"deletions":0,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -239,0 +239,15 @@\n+    \/\/ Do additional checks for special objects: their fields can hold metadata as well.\n+    \/\/ We want to check class loading\/unloading did not corrupt them.\n+\n+    if (java_lang_Class::is_instance(obj)) {\n+      Metadata* klass = obj->metadata_field(java_lang_Class::klass_offset());\n+      check(ShenandoahAsserts::_safe_oop, obj,\n+            klass == nullptr || Metaspace::contains(klass),\n+            \"Instance class mirror should point to Metaspace\");\n+\n+      Metadata* array_klass = obj->metadata_field(java_lang_Class::array_klass_offset());\n+      check(ShenandoahAsserts::_safe_oop, obj,\n+            array_klass == nullptr || Metaspace::contains(array_klass),\n+            \"Array class mirror should point to Metaspace\");\n+    }\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.cpp","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"}]}