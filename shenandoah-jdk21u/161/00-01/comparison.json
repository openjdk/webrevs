{"files":[{"patch":"@@ -483,8 +483,0 @@\n-  } else {\n-    \/\/ Incremental Update mode, marking\n-    T* array = src;\n-    HeapWord* array_addr = reinterpret_cast<HeapWord*>(array);\n-    ShenandoahHeapRegion* r = _heap->heap_region_containing(array_addr);\n-    if (array_addr < _heap->marking_context()->top_at_mark_start(r)) {\n-      arraycopy_work<T, false, false, true>(array, count);\n-    }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.inline.hpp","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -50,1 +50,5 @@\n-  _gc_state(_heap->gc_state()) {\n+  _gc_state(_heap->gc_state()),\n+  _gc_state_changed(_heap->_gc_state_changed) {\n+  \/\/ Clear state to deactivate barriers. Indicate that state has changed\n+  \/\/ so that verifier threads will use this value, rather than thread local\n+  \/\/ values (which we are _not_ changing here).\n@@ -52,0 +56,1 @@\n+  _heap->_gc_state_changed = true;\n@@ -56,0 +61,1 @@\n+  _heap->_gc_state_changed = _gc_state_changed;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahRootVerifier.cpp","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -36,0 +36,1 @@\n+  const bool _gc_state_changed;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahRootVerifier.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -811,0 +811,4 @@\n+      case _verify_gcstate_updating:\n+        enabled = true;\n+        expected = ShenandoahHeap::HAS_FORWARDED | ShenandoahHeap::UPDATEREFS;\n+        break;\n@@ -1115,1 +1119,1 @@\n-          _verify_gcstate_forwarded    \/\/ evacuation should have produced some forwarded objects\n+          _verify_gcstate_updating     \/\/ evacuation should have produced some forwarded objects\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -172,1 +172,4 @@\n-    _verify_gcstate_forwarded\n+    _verify_gcstate_forwarded,\n+\n+    \/\/ Evacuation is done, some objects are forwarded, updating is in progress\n+    _verify_gcstate_updating\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.hpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"}]}