{"files":[{"patch":"@@ -41,0 +41,1 @@\n+\n@@ -92,4 +93,0 @@\n-     from(\"${libclang_dir}\") {\n-        include(\"libclang.a\")\n-        into(\"$buildDir\/test-libs\")\n-     }\n@@ -270,12 +267,0 @@\n-tasks.register(\"copyLibClangToTestLib\", Copy) {\n-    def srcFile = file(\"${project.buildDir}\/jmod_inputs\/libs\/libclang.a\")\n-    def destDir = file(\"${project.buildDir}\/test-lib\/libs\")\n-    dependsOn(copyLibClang)\n-    from(srcFile) \n-    into(destDir)\n-}\n-\n-\/\/ Make jtreg depend on it\n-tasks.named(\"jtreg\") {\n-    dependsOn(\"copyLibClangToTestLib\")\n-}\n","filename":"build.gradle","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -17,2 +17,0 @@\n-else ifeq ($(PLATFORM_OS), aix)\n-  TAR_SUPPORTS_TRANSFORM := false\n@@ -34,2 +32,0 @@\n-else ifeq ($(PLATFORM_OS), aix)\n-  BUNDLE_PLATFORM := aix-$(PLATFORM_CPU)\n@@ -62,2 +58,0 @@\n-else ifeq ($(PLATFORM_OS), aix)\n-  LIBCLANG_COPY_PATH := \"libclang.a\"\n@@ -79,0 +73,1 @@\n+\n","filename":"make\/Build.gmk","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -71,2 +71,0 @@\n-UNAME_P := $(shell uname -p)\n-UNAME_M := $(shell uname -m)\n@@ -74,1 +72,1 @@\n-# CPU detection\n+UNAME_M := $(shell uname -m)\n@@ -76,2 +74,8 @@\n-    DEVKIT_VS_CPU_VAR_NAME := x86_64\n-    PLATFORM_CPU := x64\n+  DEVKIT_VS_CPU_VAR_NAME := x86_64\n+  PLATFORM_CPU := x64\n+else ifeq ($(UNAME_M),arm64)\n+  DEVKIT_VS_CPU_VAR_NAME := aarch64\n+  PLATFORM_CPU := aarch64\n+else ifeq ($(UNAME_M),aarch64)\n+  DEVKIT_VS_CPU_VAR_NAME := aarch64\n+  PLATFORM_CPU := aarch64\n@@ -79,16 +83,1 @@\n-    ifeq ($(UNAME_M),arm64)\n-        DEVKIT_VS_CPU_VAR_NAME := aarch64\n-        PLATFORM_CPU := aarch64\n-    else\n-        ifeq ($(UNAME_M),aarch64)\n-            DEVKIT_VS_CPU_VAR_NAME := aarch64\n-            PLATFORM_CPU := aarch64\n-        else\n-            ifeq ($(UNAME_P),powerpc)\n-                DEVKIT_VS_CPU_VAR_NAME := ppc64\n-                PLATFORM_CPU := ppc64\n-            else\n-                $(error \"Unknown CPU: $(UNAME_M)\")\n-            endif\n-        endif\n-    endif\n+  $(error \"Unknown CPU: $(UNAME_M)\")\n@@ -97,1 +86,0 @@\n-# OS detection\n@@ -99,2 +87,2 @@\n-    PLATFORM_OS := windows\n-    FIXPATH := bash $(TOPDIR)\/make\/scripts\/fixpath.sh exec\n+  PLATFORM_OS := windows\n+  FIXPATH := bash $(TOPDIR)\/make\/scripts\/fixpath.sh exec\n@@ -102,4 +90,8 @@\n-    FIXPATH :=\n-    UNAME_S := $(shell uname -s)\n-    ifeq ($(UNAME_S),Darwin)\n-        PLATFORM_OS := macosx\n+  FIXPATH :=\n+\n+  UNAME_S := $(shell uname -s)\n+  ifeq ($(UNAME_S), Darwin)\n+    PLATFORM_OS := macosx\n+  else\n+    ifeq ($(UNAME_S), Linux)\n+      PLATFORM_OS := linux\n@@ -107,9 +99,1 @@\n-        ifeq ($(UNAME_S),Linux)\n-            PLATFORM_OS := linux\n-        else\n-            ifeq ($(UNAME_S),AIX)\n-                PLATFORM_OS := aix\n-            else\n-                $(error \"Unknown OS: $(UNAME_S)\")\n-            endif\n-        endif\n+      $(error \"Unknown OS: $(UNAME_S)\")\n@@ -117,0 +101,1 @@\n+  endif\n@@ -118,0 +103,1 @@\n+\n","filename":"make\/Common.gmk","additions":23,"deletions":37,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -89,13 +89,0 @@\n-    ifeq ($(PLATFORM_OS), aix)\n-      SHARED_LIB_SUFFIX := .a\n-      CC_NAME := xlc\n-      LINK_NAME := xlc\n-\n-      # xlc typically requires -q64 for 64-bit builds\n-      CFLAGS += -q64 -bexpall -qhalt=e -qalign=power -sysroot=$(SYSROOT) -m64\n-      LDFLAGS += -q64 -G -Wl,-bnoentry -Wl,-bexpall, -malign-power -m64\n-      CPPFLAGS += -D_AIX\n-\n-      # AIX-specific export file handling can be added here if needed\n-    endif\n-\n","filename":"make\/NativeCompilation.gmk","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -88,1 +88,0 @@\n-        String libName = \"\";\n@@ -90,10 +89,3 @@\n-        List<String> pathsToCheck = new ArrayList<>(Arrays.asList(\n-                System.getProperty(\"java.library.path\").split(File.pathSeparator)\n-        ));\n-        \/\/ 2. Add alternate calculated paths\n-        String currentDir = System.getProperty(\"user.dir\"); \/\/ wherever JVM was launched\n-        pathsToCheck.add(currentDir + \"\/build\/jextract-jdk-test-image\/lib\");\n-        pathsToCheck.add(currentDir + \"\/..\/..\/..\/jextract-jdk-test-image\/lib\"); \/\/ in case running from subdir\n-        \/\/ 3. Try to find the library\n-        for (String path : pathsToCheck) {\n-            File f = new File(path, \"libclang.a\"); \/\/ AIX uses .a, Linux .so\n+            String libName = null;\n+            String javaHome = System.getProperty(\"java.home\");\n+            File f = new File(javaHome + \"\/lib\", \"libclang.a\"); \/\/ AIX uses .a, Linux .so\n@@ -102,1 +94,0 @@\n-                break;\n@@ -104,2 +95,1 @@\n-        }\n-        SYMBOL_LOOKUP = SymbolLookup.libraryLookup(libName + \"(libclang.so.14)\", Arena.global());\n+            SYMBOL_LOOKUP = SymbolLookup.libraryLookup(libName + \"(libclang.so.14)\", Arena.global());\n@@ -107,1 +97,1 @@\n-            libName = osName.startsWith(\"Windows\") ? \"libclang\" : \"clang\";\n+            String libName = osName.startsWith(\"Windows\") ? \"libclang\" : \"clang\";\n","filename":"src\/main\/java\/org\/openjdk\/jextract\/clang\/libclang\/Index_h.java","additions":5,"deletions":15,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -5,0 +5,1 @@\n+\n@@ -18,1 +19,1 @@\n-          COMPILE_FLAGS \"-q64  -qhalt=e\"\n+          COMPILE_FLAGS \"-q64  -qhalt=e -qcpluscmt\"\n@@ -31,1 +32,4 @@\n-    target_link_libraries(${LIB_NAME} m)\n+    find_library(LIBM, m)\n+    if(LIBM)\n+      target_link_libraries(${LIB_NAME} ${LIBM})\n+    endif()\n","filename":"test\/test-support\/CMakeLists.txt","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"}]}