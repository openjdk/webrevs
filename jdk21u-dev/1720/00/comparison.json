{"files":[{"patch":"@@ -579,2 +579,0 @@\n-        boolean started = false;\n-\n@@ -591,1 +589,0 @@\n-                started = true;\n@@ -598,2 +595,2 @@\n-        \/\/ force owner to join if thread started\n-        if (started && Thread.currentThread() == flock.owner() && round > forkRound) {\n+        \/\/ force owner to join if this is the first fork in the round\n+        if (Thread.currentThread() == flock.owner() && round > forkRound) {\n@@ -936,1 +933,2 @@\n-            throw new IllegalStateException(\"Subtask not completed or did not complete successfully\");\n+            throw new IllegalStateException(\n+                    \"Result is unavailable or subtask did not complete successfully\");\n@@ -946,1 +944,2 @@\n-            throw new IllegalStateException(\"Subtask not completed or did not complete with exception\");\n+            throw new IllegalStateException(\n+                    \"Exception is unavailable or subtask did not complete with exception\");\n","filename":"src\/java.base\/share\/classes\/java\/util\/concurrent\/StructuredTaskScope.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -282,0 +282,1 @@\n+            scope.join();\n@@ -676,16 +677,0 @@\n-    \/**\n-     * Test that shutdown prevents new threads from starting.\n-     *\/\n-    @Test\n-    void testShutdownWithFork() throws Exception {\n-        ThreadFactory factory = task -> null;\n-        try (var scope = new StructuredTaskScope<Object>(null, factory)) {\n-            scope.shutdown();\n-            \/\/ should not invoke the ThreadFactory to create thread\n-            Subtask<Void> subtask = scope.fork(() -> null);\n-            assertEquals(Subtask.State.UNAVAILABLE, subtask.state());\n-            assertThrows(IllegalStateException.class, subtask::get);\n-            assertThrows(IllegalStateException.class, subtask::exception);\n-        }\n-    }\n-\n@@ -1380,0 +1365,1 @@\n+            scope.join();\n","filename":"test\/jdk\/java\/util\/concurrent\/StructuredTaskScope\/StructuredTaskScopeTest.java","additions":2,"deletions":16,"binary":false,"changes":18,"status":"modified"}]}