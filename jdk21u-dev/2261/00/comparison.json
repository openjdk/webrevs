{"files":[{"patch":"@@ -415,15 +415,7 @@\n-  } else if ((has_timestamp() && _timestamp != st.st_mtime) ||\n-             _filesize != st.st_size) {\n-    ok = false;\n-    if (PrintSharedArchiveAndExit) {\n-      log_warning(cds)(_timestamp != st.st_mtime ?\n-                                 \"Timestamp mismatch\" :\n-                                 \"File size mismatch\");\n-    } else {\n-      const char* bad_jar_msg = \"A jar file is not the one used while building the shared archive file:\";\n-      log_warning(cds)(\"%s %s\", bad_jar_msg, name);\n-      if (!log_is_enabled(Info, cds)) {\n-        log_warning(cds)(\"%s %s\", bad_jar_msg, name);\n-      }\n-      if (_timestamp != st.st_mtime) {\n-        log_warning(cds)(\"%s timestamp has changed.\", name);\n+  } else {\n+    bool size_differs = _filesize != st.st_size;\n+    bool time_differs = has_timestamp() && _timestamp != st.st_mtime;\n+    if (time_differs || size_differs) {\n+      ok = false;\n+      if (PrintSharedArchiveAndExit) {\n+        log_warning(cds)(time_differs ? \"Timestamp mismatch\" : \"File size mismatch\");\n@@ -431,1 +423,11 @@\n-        log_warning(cds)(\"%s size has changed.\", name);\n+        const char* bad_file_msg = \"This file is not the one used while building the shared archive file:\";\n+        log_warning(cds)(\"%s %s\", bad_file_msg, name);\n+        if (!log_is_enabled(Info, cds)) {\n+          log_warning(cds)(\"%s %s\", bad_file_msg, name);\n+        }\n+        if (time_differs) {\n+          log_warning(cds)(\"%s timestamp has changed.\", name);\n+        }\n+        if (size_differs) {\n+          log_warning(cds)(\"%s size has changed.\", name);\n+        }\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":18,"deletions":16,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -111,1 +111,1 @@\n-    output.shouldMatch(\"A jar file is not the one used while building the shared archive file:.*jar2.jar\")\n+    output.shouldMatch(\"This file is not the one used while building the shared archive file:.*jar2.jar\")\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/WrongClasspath.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -207,1 +207,1 @@\n-                \"A jar file is not the one used while building the shared archive file:\");\n+                \"This file is not the one used while building the shared archive file:\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/MainModuleOnly.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -114,1 +114,1 @@\n-              output.shouldMatch(\"A jar file is not the one used while building the shared archive file:.*GenericTestApp.jar\");\n+              output.shouldMatch(\"This file is not the one used while building the shared archive file:.*GenericTestApp.jar\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/WrongTopClasspath.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -68,1 +68,1 @@\n-    private static final String jarFileError = \"A jar file is not the one used while building the shared archive file:\";\n+    private static final String jarFileError = \"This file is not the one used while building the shared archive file:\";\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/jigsaw\/modulepath\/MainModuleOnly.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}