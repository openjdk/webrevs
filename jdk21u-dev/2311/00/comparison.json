{"files":[{"patch":"@@ -39,0 +39,1 @@\n+import java.util.Optional;\n@@ -80,0 +81,4 @@\n+    public Optional<Path> getExecutable() {\n+        return Optional.ofNullable(executable);\n+    }\n+\n@@ -177,1 +182,1 @@\n-    public class Result {\n+    public record Result(int exitCode, List<String> output, Supplier<String> cmdline) {\n@@ -179,2 +184,2 @@\n-        Result(int exitCode) {\n-            this.exitCode = exitCode;\n+        public Result {\n+            Objects.requireNonNull(cmdline);\n@@ -191,4 +196,0 @@\n-        public String getPrintableCommandLine() {\n-            return Executor.this.getPrintableCommandLine();\n-        }\n-\n@@ -198,1 +199,1 @@\n-                    getPrintableCommandLine(), expectedExitCode));\n+                    cmdline.get(), expectedExitCode));\n@@ -209,3 +210,0 @@\n-\n-        final int exitCode;\n-        private List<String> output;\n@@ -409,2 +407,2 @@\n-        Result reply = new Result(process.waitFor());\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n+        final int exitCode = process.waitFor();\n+        trace(\"Done. Exit code: \" + exitCode);\n@@ -412,0 +410,1 @@\n+        final List<String> output;\n@@ -413,1 +412,3 @@\n-            reply.output = Collections.unmodifiableList(outputLines);\n+            output = Collections.unmodifiableList(outputLines);\n+        } else {\n+            output = null;\n@@ -415,1 +416,1 @@\n-        return reply;\n+        return createResult(exitCode, output);\n@@ -418,1 +419,1 @@\n-    private Result runToolProvider(PrintStream out, PrintStream err) {\n+    private int runToolProvider(PrintStream out, PrintStream err) {\n@@ -420,4 +421,4 @@\n-        Result reply = new Result(toolProvider.run(out, err, args.toArray(\n-                String[]::new)));\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n-        return reply;\n+        final int exitCode = toolProvider.run(out, err, args.toArray(\n+                String[]::new));\n+        trace(\"Done. Exit code: \" + exitCode);\n+        return exitCode;\n@@ -426,0 +427,3 @@\n+    private Result createResult(int exitCode, List<String> output) {\n+        return new Result(exitCode, output, this::getPrintableCommandLine);\n+    }\n@@ -430,1 +434,1 @@\n-                return runToolProvider(System.out, System.err);\n+                return createResult(runToolProvider(System.out, System.err), null);\n@@ -439,1 +443,1 @@\n-            return runToolProvider(nullPrintStream, nullPrintStream);\n+            return createResult(runToolProvider(nullPrintStream, nullPrintStream), null);\n@@ -444,1 +448,1 @@\n-            Result reply = runToolProvider(ps, ps);\n+            final var exitCode = runToolProvider(ps, ps);\n@@ -446,0 +450,1 @@\n+            final List<String> output;\n@@ -451,1 +456,3 @@\n-                        reply.output = List.of(firstLine);\n+                        output = List.of(firstLine);\n+                    } else {\n+                        output = null;\n@@ -454,2 +461,3 @@\n-                    reply.output = bufReader.lines().collect(\n-                            Collectors.toUnmodifiableList());\n+                    output = bufReader.lines().collect(Collectors.toUnmodifiableList());\n+                } else {\n+                    output = null;\n@@ -461,1 +469,1 @@\n-                        lines = reply.output.stream();\n+                        lines = output.stream();\n@@ -468,1 +476,1 @@\n-            return reply;\n+            return createResult(exitCode, output);\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/Executor.java","additions":36,"deletions":28,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -62,1 +62,1 @@\n-public final class JPackageCommand extends CommandArguments<JPackageCommand> {\n+public class JPackageCommand extends CommandArguments<JPackageCommand> {\n@@ -794,1 +794,1 @@\n-        if (result.exitCode == 0) {\n+        if (result.exitCode() == 0) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -69,1 +69,1 @@\n-            if (result.exitCode == 1605) {\n+            if (result.exitCode() == 1605) {\n@@ -78,1 +78,1 @@\n-            if ((result.exitCode == 1618) || (result.exitCode == 1603)) {\n+            if ((result.exitCode() == 1618) || (result.exitCode() == 1603)) {\n@@ -363,1 +363,1 @@\n-        if (status.exitCode == 1) {\n+        if (status.exitCode() == 1) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/WindowsHelper.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}