{"files":[{"patch":"@@ -137,3 +137,13 @@\n-  { assert(frame::interpreter_frame_monitor_size() == BasicObjectLock::size(), \"adjust code below\");\n-    int monitor_offset = BytesPerWord * method()->max_locals() +\n-      (2 * BytesPerWord) * (number_of_locks - 1);\n+  {\n+    assert(frame::interpreter_frame_monitor_size() == BasicObjectLock::size(), \"adjust code below\");\n+\n+    const int locals_space = BytesPerWord * method() -> max_locals();\n+    int monitor_offset = locals_space + (2 * BytesPerWord) * (number_of_locks - 1);\n+    bool large_offset = !Immediate::is_simm20(monitor_offset + BytesPerWord) && number_of_locks > 0;\n+\n+    if (large_offset) {\n+      \/\/ z_lg can only handle displacement upto 20bit signed binary integer\n+      __ z_algfi(OSR_buf, locals_space);\n+      monitor_offset -= locals_space;\n+    }\n+\n@@ -153,0 +163,4 @@\n+\n+    if (large_offset) {\n+      __ z_slgfi(OSR_buf, locals_space);\n+    }\n","filename":"src\/hotspot\/cpu\/s390\/c1_LIRAssembler_s390.cpp","additions":17,"deletions":3,"binary":false,"changes":20,"status":"modified"}]}