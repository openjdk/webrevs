{"files":[{"patch":"@@ -628,2 +628,2 @@\n-    TOOLCHAIN_CFLAGS_JVM=\"-nologo -MD -Zc:preprocessor -Zc:strictStrings -permissive- -MP\"\n-    TOOLCHAIN_CFLAGS_JDK=\"-nologo -MD -Zc:preprocessor -Zc:strictStrings -Zc:wchar_t-\"\n+    TOOLCHAIN_CFLAGS_JVM=\"-nologo -MD -Zc:preprocessor -permissive- -MP\"\n+    TOOLCHAIN_CFLAGS_JDK=\"-nologo -MD -Zc:preprocessor -permissive- -Zc:wchar_t-\"\n","filename":"make\/autoconf\/flags-cflags.m4","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-void D3DGlyphCache_FlushGlyphVertexCache();\n+static void D3DGlyphCache_FlushGlyphVertexCache();\n","filename":"src\/java.desktop\/windows\/native\/libawt\/java2d\/d3d\/D3DGlyphCache.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -209,1 +209,1 @@\n-    SetEraseBackgroundStruct *sebs = (SetEraseBackgroundStruct *)param;\n+    SetEraseBackgroundStruct *sebs = static_cast<SetEraseBackgroundStruct *>(param);\n@@ -214,2 +214,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(canvas, ret);\n+    AwtCanvas *c = NULL;\n+\n+    if (canvas == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"canvas\");\n+        delete sebs;\n+        return;\n+    } else {\n+        c = (AwtCanvas*)JNI_GET_PDATA(canvas);\n+        if (c == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(canvas);\n+            env->DeleteGlobalRef(canvas);\n+            delete sebs;\n+            return;\n+        }\n+    }\n@@ -217,1 +231,0 @@\n-    AwtCanvas *c = (AwtCanvas*)pData;\n@@ -221,1 +234,0 @@\n-ret:\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Canvas.cpp","additions":17,"deletions":5,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -6363,1 +6363,1 @@\n-        SetParentStruct *data = (SetParentStruct*) param;\n+        SetParentStruct *data = static_cast<SetParentStruct*>(param);\n@@ -6370,5 +6370,33 @@\n-        PDATA pData;\n-        JNI_CHECK_PEER_GOTO(self, ret);\n-        awtComponent = (AwtComponent *)pData;\n-        JNI_CHECK_PEER_GOTO(parent, ret);\n-        awtParent = (AwtComponent *)pData;\n+        if (self == NULL) {\n+            env->ExceptionClear();\n+            JNU_ThrowNullPointerException(env, \"self\");\n+            env->DeleteGlobalRef(parent);\n+            delete data;\n+            return;\n+        } else {\n+            awtComponent = (AwtComponent *)JNI_GET_PDATA(self);;\n+            if (awtComponent == NULL) {\n+                THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+                env->DeleteGlobalRef(self);\n+                env->DeleteGlobalRef(parent);\n+                delete data;\n+                return;\n+            }\n+        }\n+\n+        if (parent == NULL) {\n+            env->ExceptionClear();\n+            JNU_ThrowNullPointerException(env, \"parent\");\n+            env->DeleteGlobalRef(self);\n+            delete data;\n+            return;\n+        } else {\n+            awtParent = (AwtComponent *)JNI_GET_PDATA(parent);\n+            if (awtParent == NULL) {\n+                THROW_NULL_PDATA_IF_NOT_DESTROYED(parent);\n+                env->DeleteGlobalRef(self);\n+                env->DeleteGlobalRef(parent);\n+                delete data;\n+                return;\n+            }\n+        }\n@@ -6383,1 +6411,1 @@\n-ret:\n+\n@@ -6542,1 +6570,1 @@\n-    GetInsetsStruct *gis = (GetInsetsStruct *)param;\n+    GetInsetsStruct *gis = static_cast<GetInsetsStruct *>(param);\n@@ -6548,3 +6576,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtComponent *component = (AwtComponent *)pData;\n+    AwtComponent *component = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete gis;\n+        return;\n+    } else {\n+        component = (AwtComponent *)JNI_GET_PDATA(self);\n+        if (component == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete gis;\n+            return;\n+        }\n+    }\n@@ -6554,1 +6595,0 @@\n-  ret:\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Component.cpp","additions":52,"deletions":12,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -42,1 +42,0 @@\n-#include <awt.h>\n@@ -45,0 +44,5 @@\n+\/\/ These files must be included before awt.h, since the latter redefines malloc\n+\/\/ to Do_Not_Use_Malloc, etc, and that will break these files.\n+#include \"awt_ole.h\"\n+#include \"awt_DCHolder.h\"\n+\n@@ -46,0 +50,1 @@\n+#include \"awt.h\"\n@@ -57,3 +62,0 @@\n-#include \"awt_ole.h\"\n-#include \"awt_DCHolder.h\"\n-\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_DnDDS.cpp","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -30,0 +30,3 @@\n+\/\/ awt_ole.h must be included before awt.h, since the latter redefines malloc\n+\/\/ to Do_Not_Use_Malloc, etc, and that will break awt_ole.h.\n+#include \"awt_ole.h\"\n@@ -34,1 +37,0 @@\n-#include \"awt_ole.h\"\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_DnDDT.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1343,1 +1343,1 @@\n-    SetStateStruct *sss = (SetStateStruct *)param;\n+    SetStateStruct *sss = static_cast<SetStateStruct *>(param);\n@@ -1349,3 +1349,15 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    f = (AwtFrame *)pData;\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete sss;\n+        return;\n+    } else {\n+        f = (AwtFrame *)JNI_GET_PDATA(self);\n+        if (f == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete sss;\n+            return;\n+        }\n+    }\n+\n@@ -1408,1 +1420,1 @@\n-ret:\n+\n@@ -1572,1 +1584,1 @@\n-    NotifyModalBlockedStruct *nmbs = (NotifyModalBlockedStruct *)param;\n+    NotifyModalBlockedStruct *nmbs = static_cast<NotifyModalBlockedStruct *>(param);\n@@ -1578,1 +1590,1 @@\n-    PDATA pData;\n+    AwtFrame *f = NULL;\n@@ -1580,2 +1592,20 @@\n-    JNI_CHECK_PEER_GOTO(peer, ret);\n-    AwtFrame *f = (AwtFrame *)pData;\n+    if (peer == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"peer\");\n+        env->DeleteGlobalRef(self);\n+        env->DeleteGlobalRef(blockerPeer);\n+\n+        delete nmbs;\n+        return;\n+    } else {\n+        f = (AwtFrame *)JNI_GET_PDATA(peer);\n+        if (f == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(peer);\n+            env->DeleteGlobalRef(self);\n+            env->DeleteGlobalRef(peer);\n+            env->DeleteGlobalRef(blockerPeer);\n+\n+            delete nmbs;\n+            return;\n+        }\n+    }\n@@ -1585,2 +1615,22 @@\n-    JNI_CHECK_PEER_GOTO(blockerPeer, ret);\n-    AwtDialog *d = (AwtDialog *)pData;\n+    AwtDialog *d = NULL;\n+\n+    if (blockerPeer == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"blockerPeer\");\n+        env->DeleteGlobalRef(self);\n+        env->DeleteGlobalRef(peer);\n+\n+        delete nmbs;\n+        return;\n+    } else {\n+        d = (AwtDialog *)JNI_GET_PDATA(blockerPeer);\n+        if (d == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(blockerPeer);\n+            env->DeleteGlobalRef(self);\n+            env->DeleteGlobalRef(peer);\n+            env->DeleteGlobalRef(blockerPeer);\n+\n+            delete nmbs;\n+            return;\n+        }\n+    }\n@@ -1637,1 +1687,1 @@\n-ret:\n+\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Frame.cpp","additions":62,"deletions":12,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -38,4 +38,4 @@\n-    static jfieldID AwtPrintDialog::controlID;\n-    static jfieldID AwtPrintDialog::parentID;\n-    static jfieldID AwtPrintDialog::pageID;\n-    static jmethodID AwtPrintDialog::setHWndMID;\n+    static jfieldID controlID;\n+    static jfieldID parentID;\n+    static jfieldID pageID;\n+    static jmethodID setHWndMID;\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_PrintDialog.h","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -60,0 +60,2 @@\n+jfieldID AwtPrintDialog::pageID;\n+\n@@ -212,1 +214,0 @@\n-jfieldID AwtPrintDialog::pageID;\n@@ -496,0 +497,12 @@\n+#define CLEANUP_SHOW {                      \\\n+    env->DeleteGlobalRef(peerGlobalRef);    \\\n+    if (target != NULL) {                   \\\n+        env->DeleteLocalRef(target);        \\\n+    }                                       \\\n+    if (parent != NULL) {                   \\\n+        env->DeleteLocalRef(parent);        \\\n+    }                                       \\\n+    env->DeleteLocalRef(page);              \\\n+    env->DeleteLocalRef(self);              \\\n+}\n+\n@@ -524,2 +537,0 @@\n-\n-    jboolean doIt = JNI_FALSE; \/\/ Assume the user will cancel the dialog.\n@@ -575,1 +586,1 @@\n-        (void)::PageSetupDlg(&setup);\n+        static_cast<void>(::PageSetupDlg(&setup));\n@@ -580,2 +591,2 @@\n-            doIt = JNI_FALSE;\n-            goto done;\n+            CLEANUP_SHOW;\n+            return JNI_FALSE;\n@@ -608,2 +619,2 @@\n-        doIt = JNI_FALSE;\n-        goto done;\n+        CLEANUP_SHOW;\n+        return JNI_FALSE;\n@@ -622,2 +633,2 @@\n-            doIt = JNI_FALSE;\n-            goto done;\n+            CLEANUP_SHOW;\n+            return JNI_FALSE;\n@@ -663,3 +674,3 @@\n-         if (env->ExceptionCheck()) {\n-             doIt = JNI_FALSE;\n-             goto done;\n+        if (env->ExceptionCheck()) {\n+            CLEANUP_SHOW;\n+            return JNI_FALSE;\n@@ -673,2 +684,2 @@\n-             doIt = JNI_FALSE;\n-             goto done;\n+            CLEANUP_SHOW;\n+            return JNI_FALSE;\n@@ -678,2 +689,2 @@\n-             doIt = JNI_FALSE;\n-             goto done;\n+            CLEANUP_SHOW;\n+            return JNI_FALSE;\n@@ -687,2 +698,2 @@\n-                        doIt = JNI_FALSE;\n-                        goto done;\n+                        CLEANUP_SHOW;\n+                        return JNI_FALSE;\n@@ -694,1 +705,0 @@\n-        doIt = JNI_TRUE;\n@@ -711,10 +721,1 @@\n-done:\n-    env->DeleteGlobalRef(peerGlobalRef);\n-    if (target != NULL) {\n-        env->DeleteLocalRef(target);\n-    }\n-    if (parent != NULL) {\n-        env->DeleteLocalRef(parent);\n-    }\n-    env->DeleteLocalRef(page);\n-    env->DeleteLocalRef(self);\n+    CLEANUP_SHOW;\n@@ -722,1 +723,1 @@\n-    return doIt;\n+    return JNI_TRUE;\n@@ -884,0 +885,15 @@\n+#define CLEANUP_VALIDATE_PAPER {                                               \\\n+    if (privateDC == TRUE) {                                                   \\\n+        if (printDC != NULL) {                                                 \\\n+            \/* In this case we know that this DC has no GDI objects to free *\/ \\\n+             ::DeleteDC(printDC);                                              \\\n+        }                                                                      \\\n+        if (hDevMode != NULL) {                                                \\\n+            ::GlobalFree(hDevMode);                                            \\\n+        }                                                                      \\\n+        if (hDevNames != NULL) {                                               \\\n+            ::GlobalFree(hDevNames);                                           \\\n+        }                                                                      \\\n+    }                                                                          \\\n+}\n+\n@@ -922,1 +938,6 @@\n-    JNI_CHECK_NULL_GOTO(printDC, \"Invalid printDC\", done);\n+    if (printDC == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"Invalid printDC\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -935,1 +956,4 @@\n-    if (err) goto done;\n+    if (err) {\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -943,1 +967,6 @@\n-    JNI_CHECK_NULL_GOTO(paperClass, \"paper class not found\", done);\n+    if (paperClass == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"paper class not found\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -945,1 +974,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getWidth method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getWidth method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -948,1 +982,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getHeight method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getHeight method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -951,1 +990,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getX method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getX method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -954,1 +998,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getY method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getY method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -957,1 +1006,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getW method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getW method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -960,1 +1014,6 @@\n-    JNI_CHECK_NULL_GOTO(getID, \"no getH method\", done);\n+    if (getID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no getH method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -1053,1 +1112,6 @@\n-    JNI_CHECK_NULL_GOTO(setSizeID, \"no setSize method\", done);\n+    if (setSizeID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no setSize method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -1057,1 +1121,6 @@\n-    JNI_CHECK_NULL_GOTO(setImageableID, \"no setImageable method\", done);\n+    if (setImageableID == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"no setImageable method\");\n+        CLEANUP_VALIDATE_PAPER;\n+        return;\n+    }\n@@ -1062,1 +1131,0 @@\n-done:\n@@ -1064,12 +1132,1 @@\n-    if (privateDC == TRUE) {\n-        if (printDC != NULL) {\n-            \/* In this case we know that this DC has no GDI objects to free *\/\n-             ::DeleteDC(printDC);\n-        }\n-        if (hDevMode != NULL) {\n-            ::GlobalFree(hDevMode);\n-        }\n-        if (hDevNames != NULL) {\n-            ::GlobalFree(hDevNames);\n-        }\n-    }\n+    CLEANUP_VALIDATE_PAPER;\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_PrintJob.cpp","additions":112,"deletions":55,"binary":false,"changes":167,"status":"modified"},{"patch":"@@ -56,0 +56,4 @@\n+jmethodID AwtTextComponent::canAccessClipboardMID;\n+AwtTextComponent::OleCallback AwtTextComponent::sm_oleCallback;\n+WNDPROC AwtTextComponent::sm_pDefWindowProc = NULL;\n+\n@@ -60,2 +64,0 @@\n-jmethodID AwtTextComponent::canAccessClipboardMID;\n-\n@@ -914,2 +916,0 @@\n-AwtTextComponent::OleCallback AwtTextComponent::sm_oleCallback;\n-\n@@ -1043,2 +1043,0 @@\n-WNDPROC AwtTextComponent::sm_pDefWindowProc = NULL;\n-\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_TextComponent.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1022,1 +1022,1 @@\n-        (RepositionSecurityWarningStruct *)param;\n+        static_cast<RepositionSecurityWarningStruct *>(param);\n@@ -1025,3 +1025,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtWindow *window = (AwtWindow *)pData;\n+    AwtWindow *window = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete rsws;\n+        return;\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete rsws;\n+            return;\n+        }\n+    }\n@@ -1031,1 +1044,0 @@\n-  ret:\n@@ -3119,1 +3131,1 @@\n-    ModalDisableStruct *mds = (ModalDisableStruct *)param;\n+    ModalDisableStruct *mds = static_cast<ModalDisableStruct *>(param);\n@@ -3126,4 +3138,3 @@\n-    JNI_CHECK_NULL_GOTO(self, \"peer\", ret);\n-    PDATA pData = JNI_GET_PDATA(self);\n-    if (pData == NULL) {\n-        env->DeleteGlobalRef(self);\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n@@ -3132,0 +3143,7 @@\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            env->DeleteGlobalRef(self);\n+            delete mds;\n+            return;\n+        }\n@@ -3134,1 +3152,0 @@\n-    window = (AwtWindow *)pData;\n@@ -3140,1 +3157,0 @@\n-ret:\n@@ -3150,1 +3166,1 @@\n-    jobject self = (jobject)param;\n+    jobject self = static_cast<jobject>(param);\n@@ -3155,4 +3171,3 @@\n-    JNI_CHECK_NULL_GOTO(self, \"peer\", ret);\n-    PDATA pData = JNI_GET_PDATA(self);\n-    if (pData == NULL) {\n-        env->DeleteGlobalRef(self);\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n@@ -3160,0 +3175,6 @@\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            env->DeleteGlobalRef(self);\n+            return;\n+        }\n@@ -3162,1 +3183,0 @@\n-    window = (AwtWindow *)pData;\n@@ -3168,1 +3188,0 @@\n-  ret:\n@@ -3176,1 +3195,1 @@\n-    OpacityStruct *os = (OpacityStruct *)param;\n+    OpacityStruct *os = static_cast<OpacityStruct *>(param);\n@@ -3180,3 +3199,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtWindow *window = (AwtWindow *)pData;\n+    AwtWindow *window = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete os;\n+        return;\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete os;\n+            return;\n+        }\n+    }\n@@ -3186,1 +3218,0 @@\n-  ret:\n@@ -3195,1 +3226,1 @@\n-    OpaqueStruct *os = (OpaqueStruct *)param;\n+    OpaqueStruct *os = static_cast<OpaqueStruct *>(param);\n@@ -3199,3 +3230,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtWindow *window = (AwtWindow *)pData;\n+    AwtWindow *window = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete os;\n+        return;\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete os;\n+            return;\n+        }\n+    }\n@@ -3205,1 +3249,0 @@\n-  ret:\n@@ -3214,1 +3257,1 @@\n-    UpdateWindowStruct *uws = (UpdateWindowStruct *)param;\n+    UpdateWindowStruct *uws = static_cast<UpdateWindowStruct *>(param);\n@@ -3218,3 +3261,22 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtWindow *window = (AwtWindow *)pData;\n+    AwtWindow *window = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        if (data != NULL) {\n+            env->DeleteGlobalRef(data);\n+        }\n+        delete uws;\n+        return;\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            if (data != NULL) {\n+                env->DeleteGlobalRef(data);\n+            }\n+            delete uws;\n+            return;\n+        }\n+    }\n@@ -3225,1 +3287,0 @@\n-  ret:\n@@ -3242,3 +3303,16 @@\n-    PDATA pData;\n-    JNI_CHECK_PEER_GOTO(self, ret);\n-    AwtWindow *window = (AwtWindow *)pData;\n+    AwtWindow *window = NULL;\n+\n+    if (self == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"self\");\n+        delete data;\n+        return;\n+    } else {\n+        window = (AwtWindow *)JNI_GET_PDATA(self);\n+        if (window == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(self);\n+            env->DeleteGlobalRef(self);\n+            delete data;\n+            return;\n+        }\n+    }\n@@ -3248,1 +3322,0 @@\n-  ret:\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Window.cpp","additions":111,"deletions":38,"binary":false,"changes":149,"status":"modified"},{"patch":"@@ -1044,1 +1044,1 @@\n-        EXCEPTION_CHECK(\"Getting ParentWithRole - call to CallObjectMethod()\", (AccessibleContext)0);\n+        EXCEPTION_CHECK(\"Getting ParentWithRole - call to CallObjectMethod()\", reinterpret_cast<jobject>((AccessibleContext)0));\n@@ -1114,1 +1114,1 @@\n-        EXCEPTION_CHECK(\"Getting ParentWithRoleElseRoot - call to CallObjectMethod()\", (AccessibleContext)0);\n+        EXCEPTION_CHECK(\"Getting ParentWithRoleElseRoot - call to CallObjectMethod()\", reinterpret_cast<jobject>((AccessibleContext)0));\n@@ -1171,1 +1171,1 @@\n-        EXCEPTION_CHECK(\"Getting ActiveDescendent - call to CallObjectMethod()\", (AccessibleContext)0);\n+        EXCEPTION_CHECK(\"Getting ActiveDescendent - call to CallObjectMethod()\", reinterpret_cast<jobject>((AccessibleContext)0));\n@@ -1180,1 +1180,1 @@\n-        return (AccessibleContext)0;\n+        return reinterpret_cast<jobject>((AccessibleContext)0);\n","filename":"src\/jdk.accessibility\/windows\/native\/libjavaaccessbridge\/AccessBridgeJavaEntryPoints.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}