{"files":[{"patch":"@@ -165,1 +165,1 @@\n-            if (rv == CKR_OK) {\n+            if (rv == CKR_OK && interface != NULL) {\n@@ -213,3 +213,0 @@\n-        if (((CK_VERSION *)moduleData->ckFunctionListPtr)->major == 3) {\n-            moduleData->ckFunctionList30Ptr = interface->pFunctionList;\n-        }\n@@ -221,1 +218,2 @@\n-    if (((CK_VERSION *)moduleData->ckFunctionListPtr)->major == 3) {\n+    if (((CK_VERSION *)moduleData->ckFunctionListPtr)->major == 3 &&\n+            interface != NULL) {\n","filename":"src\/jdk.crypto.cryptoki\/unix\/native\/libj2pkcs11\/p11_md.c","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -189,1 +189,1 @@\n-            if (ckAssertReturnValueOK(env, rv) == CK_ASSERT_OK) {\n+            if (rv == CKR_OK && interface != NULL) {\n@@ -237,1 +237,2 @@\n-    if (((CK_VERSION *)moduleData->ckFunctionListPtr)->major == 3) {\n+    if (((CK_VERSION *)moduleData->ckFunctionListPtr)->major == 3 &&\n+            interface != NULL) {\n","filename":"src\/jdk.crypto.cryptoki\/windows\/native\/libj2pkcs11\/p11_md.c","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}