{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,0 @@\n-import java.awt.BorderLayout;\n@@ -42,2 +41,0 @@\n-import javax.swing.JButton;\n-import javax.swing.JFrame;\n@@ -45,1 +42,5 @@\n-import static javax.swing.SwingUtilities.invokeAndWait;\n+import javax.swing.BorderFactory;\n+import javax.swing.Box;\n+import javax.swing.JButton;\n+import javax.swing.JComponent;\n+import javax.swing.JOptionPane;\n@@ -49,7 +50,13 @@\n-    private static PrintLatinCJKTest testInstance = new PrintLatinCJKTest();\n-    private static JFrame frame;\n-    private static final String info = \"\"\"\n-            You need a printer for this test. If you have none, let\n-            the test pass. If there is a printer, press Print, send\n-            the output to the printer, and examine it. It should have\n-            text looking like this : \\u4e00\\u4e01\\u4e02\\u4e03\\u4e04English\n+    private static final String TEXT = \"\\u4e00\\u4e01\\u4e02\\u4e03\\u4e04English\";\n+\n+    private static final String INFO = \"\"\"\n+            Press Print, send the output to the printer and examine it.\n+            The printout should have text looking like this:\n+\n+            \"\"\"\n+            + TEXT + \"\"\"\n+\n+\n+            Press Pass if the text is printed correctly.\n+            If Japanese and English text overlap, press Fail.\n+\n@@ -61,13 +68,8 @@\n-    public static void showFrame() throws InterruptedException, InvocationTargetException {\n-        invokeAndWait( () -> {\n-            frame = new JFrame(\"Test Frame\");\n-            JButton b = new JButton(\"Print\");\n-            b.addActionListener((ae) -> {\n-                try {\n-                    PrinterJob job = PrinterJob.getPrinterJob();\n-                    job.setPrintable(testInstance);\n-                    if (job.printDialog()) {\n-                        job.print();\n-                    }\n-                } catch (PrinterException ex) {\n-                    ex.printStackTrace();\n+    private static JComponent createTestUI() {\n+        JButton b = new JButton(\"Print\");\n+        b.addActionListener((ae) -> {\n+            try {\n+                PrinterJob job = PrinterJob.getPrinterJob();\n+                job.setPrintable(new PrintLatinCJKTest());\n+                if (job.printDialog()) {\n+                    job.print();\n@@ -75,11 +77,7 @@\n-            });\n-            frame.getContentPane().add(b, BorderLayout.SOUTH);\n-            frame.pack();\n-\n-            \/\/ add the test frame to dispose\n-            PassFailJFrame.addTestWindow(frame);\n-\n-            \/\/ Arrange the test instruction frame and test frame side by side\n-            PassFailJFrame.positionTestWindow(frame,\n-                    PassFailJFrame.Position.HORIZONTAL);\n-            frame.setVisible(true);\n+            } catch (PrinterException ex) {\n+                ex.printStackTrace();\n+                String msg = \"PrinterException: \" + ex.getMessage();\n+                JOptionPane.showMessageDialog(b, msg, \"Error occurred\",\n+                                              JOptionPane.ERROR_MESSAGE);\n+                PassFailJFrame.forceFail(msg);\n+            }\n@@ -87,0 +85,7 @@\n+\n+        Box main = Box.createHorizontalBox();\n+        main.setBorder(BorderFactory.createEmptyBorder(8, 8, 8, 8));\n+        main.add(Box.createHorizontalGlue());\n+        main.add(b);\n+        main.add(Box.createHorizontalGlue());\n+        return main;\n@@ -96,2 +101,2 @@\n-        g.setFont(new Font(\"Dialog\", Font.PLAIN, 36));\n-        g.drawString(\"\\u4e00\\u4e01\\u4e02\\u4e03\\u4e04English\", 20, 100);\n+        g.setFont(new Font(Font.DIALOG, Font.PLAIN, 36));\n+        g.drawString(TEXT, 20, 100);\n@@ -102,9 +107,13 @@\n-        PassFailJFrame passFailJFrame = new PassFailJFrame.Builder()\n-                .title(\"Test Instructions Frame\")\n-                .instructions(info)\n-                .testTimeOut(10)\n-                .rows(10)\n-                .columns(45)\n-                .build();\n-        showFrame();\n-        passFailJFrame.awaitAndCheck();\n+        if (PrinterJob.lookupPrintServices().length == 0) {\n+            throw new RuntimeException(\"Printer not configured or available.\");\n+        }\n+\n+        PassFailJFrame.builder()\n+                      .title(\"Print Latin CJK Test\")\n+                      .instructions(INFO)\n+                      .testTimeOut(10)\n+                      .rows(12)\n+                      .columns(30)\n+                      .splitUI(PrintLatinCJKTest::createTestUI)\n+                      .build()\n+                      .awaitAndCheck();\n@@ -113,2 +122,0 @@\n-\n-\n","filename":"test\/jdk\/java\/awt\/print\/PrinterJob\/PrintLatinCJKTest.java","additions":56,"deletions":49,"binary":false,"changes":105,"status":"modified"}]}