{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,3 @@\n- * @run main\/manual=yesno DialogType\n+ * @library \/java\/awt\/regtesthelpers \/test\/lib\n+ * @build PassFailJFrame\n+ * @run main\/manual DialogType\n@@ -32,3 +34,8 @@\n-import java.awt.print.*;\n-import javax.print.attribute.*;\n-import javax.print.attribute.standard.*;\n+import java.awt.print.PrinterJob;\n+\n+import javax.print.attribute.Attribute;\n+import javax.print.attribute.HashPrintRequestAttributeSet;\n+import javax.print.attribute.PrintRequestAttributeSet;\n+import javax.print.attribute.standard.DialogTypeSelection;\n+\n+import jtreg.SkippedException;\n@@ -37,0 +44,9 @@\n+    private static PrinterJob job;\n+\n+    private static final String INSTRUCTIONS = \"\"\"\n+        Two print dialogs are shown in succession.\n+        Click Cancel in the dialogs to close them.\n+\n+        On macOS & on Windows, the first dialog is a native\n+        dialog provided by the OS, the second dialog is\n+        implemented in Swing, the dialogs differ in appearance.\n@@ -38,10 +54,2 @@\n-  static String[] instructions = {\n-     \"This test assumes and requires that you have a printer installed\",\n-     \"It verifies that the dialogs behave properly when using new API\",\n-     \"to optionally select a native dialog where one is present.\",\n-     \"Two dialogs are shown in succession.\",\n-     \"The test passes as long as no exceptions are thrown, *AND*\",\n-     \"if running on Windows only, the first dialog is a native windows\",\n-     \"control which differs in appearance from the second dialog\",\n-     \"\"\n-  };\n+        The test passes as long as no exceptions are thrown.\n+        (If there's an exception, the test will fail automatically.)\n@@ -49,1 +57,3 @@\n-  public static void main(String[] args) {\n+        The test verifies that the dialogs behave properly when using new API\n+        to optionally select a native dialog where one is present.\n+    \"\"\";\n@@ -51,3 +61,12 @@\n-      for (int i=0;i<instructions.length;i++) {\n-         System.out.println(instructions[i]);\n-      }\n+    public static void main(String[] args) throws Exception {\n+        job = PrinterJob.getPrinterJob();\n+        if (job.getPrintService() == null) {\n+            throw new SkippedException(\"Test skipped, printer is unavailable\");\n+        }\n+        PassFailJFrame passFailJFrame = PassFailJFrame.builder()\n+            .instructions(INSTRUCTIONS)\n+            .columns(40)\n+            .build();\n+        testDialogType();\n+        passFailJFrame.awaitAndCheck();\n+    }\n@@ -55,4 +74,4 @@\n-      PrinterJob job = PrinterJob.getPrinterJob();\n-      if (job.getPrintService() == null) {\n-         return;\n-      }\n+    private static void testDialogType() {\n+        setPrintDialogAttributes(DialogTypeSelection.NATIVE);\n+        setPrintDialogAttributes(DialogTypeSelection.COMMON);\n+    }\n@@ -60,14 +79,9 @@\n-      PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();\n-      aset.add(DialogTypeSelection.NATIVE);\n-      job.printDialog(aset);\n-      Attribute[] attrs = aset.toArray();\n-      for (int i=0;i<attrs.length;i++) {\n-          System.out.println(attrs[i]);\n-      }\n-      aset.add(DialogTypeSelection.COMMON);\n-      job.printDialog(aset);\n-      attrs = aset.toArray();\n-      for (int i=0;i<attrs.length;i++) {\n-          System.out.println(attrs[i]);\n-      }\n-   }\n+    private static void setPrintDialogAttributes(DialogTypeSelection selection) {\n+        PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();\n+        aset.add(selection);\n+        job.printDialog(aset);\n+        Attribute[] attrs = aset.toArray();\n+        for (int i = 0; i < attrs.length; i++) {\n+            System.out.println(attrs[i]);\n+        }\n+    }\n","filename":"test\/jdk\/java\/awt\/print\/Dialog\/DialogType.java","additions":51,"deletions":37,"binary":false,"changes":88,"status":"modified"}]}