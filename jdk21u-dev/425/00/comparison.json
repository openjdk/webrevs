{"files":[{"patch":"@@ -126,0 +126,4 @@\n+  _gc_par_phases[CodeRoots]->create_thread_work_items(\"Scanned Nmethods\", CodeRootsScannedNMethods);\n+\n+  _gc_par_phases[OptCodeRoots]->create_thread_work_items(\"Scanned Nmethods\", CodeRootsScannedNMethods);\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1GCPhaseTimes.cpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -137,0 +137,4 @@\n+  enum GCCodeRootsWorkItems {\n+    CodeRootsScannedNMethods\n+  };\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1GCPhaseTimes.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -760,0 +760,19 @@\n+\/\/ Wrapper around a CodeBlobClosure to count the number of code blobs scanned.\n+class G1ScanAndCountCodeBlobClosure : public CodeBlobClosure {\n+  CodeBlobClosure* _cl;\n+  size_t _count;\n+\n+public:\n+  G1ScanAndCountCodeBlobClosure(CodeBlobClosure* cl) : _cl(cl), _count(0) {\n+  }\n+\n+  void do_code_blob(CodeBlob* cb) override {\n+    _cl->do_code_blob(cb);\n+    _count++;\n+  }\n+\n+  size_t count() const {\n+    return _count;\n+  }\n+};\n+\n@@ -771,0 +790,2 @@\n+  size_t _code_roots_scanned;\n+\n@@ -801,0 +822,1 @@\n+    _code_roots_scanned(0),\n@@ -825,0 +847,2 @@\n+      G1ScanAndCountCodeBlobClosure cl(_pss->closures()->weak_codeblobs());\n+\n@@ -826,1 +850,3 @@\n-      r->code_roots_do(_pss->closures()->weak_codeblobs());\n+      r->code_roots_do(&cl);\n+\n+      _code_roots_scanned = cl.count();\n@@ -837,0 +863,2 @@\n+  size_t code_roots_scanned() const { return _code_roots_scanned; }\n+\n@@ -859,0 +887,2 @@\n+  p->record_or_add_thread_work_item(coderoots_phase, worker_id, cl.code_roots_scanned(), G1GCPhaseTimes::CodeRootsScannedNMethods);\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.cpp","additions":31,"deletions":1,"binary":false,"changes":32,"status":"modified"}]}