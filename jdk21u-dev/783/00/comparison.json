{"files":[{"patch":"@@ -60,1 +60,1 @@\n-            ex.printStackTrace();\n+            ex.printStackTrace(System.out);\n@@ -101,1 +101,1 @@\n-        System.err.println(\"\\nStarting \" + testName);\n+        System.out.println(\"\\nStarting \" + testName);\n@@ -114,1 +114,1 @@\n-        System.err.println(testName + \" PASSED\");\n+        System.out.println(testName + \" PASSED\");\n@@ -119,1 +119,1 @@\n-        System.err.println(\"\\nStarting \" + testName);\n+        System.out.println(\"\\nStarting \" + testName);\n@@ -130,1 +130,1 @@\n-            System.err.println(testName + \": res=\" + res);\n+            System.out.println(testName + \": res=\" + res);\n@@ -133,2 +133,2 @@\n-        System.err.println(testName + \": returned a negative code as expected: \" + res);\n-        System.err.println(testName + \" PASSED\");\n+        System.out.println(testName + \": returned a negative code as expected: \" + res);\n+        System.out.println(testName + \" PASSED\");\n@@ -139,1 +139,1 @@\n-        System.err.println(\"\\nStarting \" + testName);\n+        System.out.println(\"\\nStarting \" + testName);\n@@ -146,2 +146,2 @@\n-            System.err.println(testName + \": caught expected IOException\");\n-            System.err.println(testName + \" PASSED\");\n+            System.out.println(testName + \": caught expected IOException\");\n+            System.out.println(testName + \" PASSED\");\n@@ -157,1 +157,1 @@\n-     * and calculate 2 masks (prefix length) - one is matches original local address\n+     * and calculate 2 masks (prefix length) - one matches original local address\n@@ -170,2 +170,10 @@\n-            \/\/ prefix length must be >= 1, so bitToChange must be >= 2\n-            int bitToChange = r.nextInt(bytes.length * 8 - 3) + 2;\n+            \/\/ Prefix length is 1..32 for IPv4, 1..128 for IPv6.\n+            \/\/ bitToChange is zero-based and must be >0 (for 0 \"good\" prefix length would be 0).\n+            \/\/ Corner cases (for 127.0.0.1):\n+            \/\/   bitToChange == 1 => allow address = 0.0.0.0\n+            \/\/     - \"good\" allow mask is \"0.0.0.0\/1\";\n+            \/\/     - \"bad\" allow mask is \"0.0.0.0\/2\";\n+            \/\/   bitToChange == 31 => allow address = 127.0.0.0\n+            \/\/     - \"good\" allow mask is \"127.0.0.0\/31\";\n+            \/\/     - \"bad\" allow mask is \"127.0.0.0\/32\".\n+            int bitToChange = r.nextInt(bytes.length * 8 - 2) + 1;\n@@ -179,2 +187,2 @@\n-            prefixLengthBad = bitToChange;\n-            prefixLengthGood = bitToChange - 1;\n+            prefixLengthGood = bitToChange;\n+            prefixLengthBad = bitToChange + 1;\n@@ -206,1 +214,1 @@\n-        System.err.println(\"localhost address: \" + localAddr);\n+        System.out.println(\"localhost address: \" + localAddr);\n@@ -246,1 +254,1 @@\n-            positiveTest(\"NegativeMaskTest(\" + test.localAddress + \")\",\n+            negativeTest(\"NegativeMaskTest(\" + test.localAddress + \")\",\n@@ -250,1 +258,1 @@\n-        System.err.println(\"\\nTest PASSED\");\n+        System.out.println(\"\\nTest PASSED\");\n","filename":"test\/jdk\/com\/sun\/jdi\/JdwpAllowTest.java","additions":26,"deletions":18,"binary":false,"changes":44,"status":"modified"}]}