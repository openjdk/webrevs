{"files":[{"patch":"@@ -0,0 +1,101 @@\n+\/*\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.Robot;\n+import java.awt.Shape;\n+import javax.swing.JFrame;\n+import javax.swing.JTextPane;\n+import javax.swing.SwingUtilities;\n+import javax.swing.text.View;\n+\n+\/*\n+ * @test\n+ * @bug 4174871\n+ * @key headful\n+ * @summary Tests if CELLSPACING attribute in HTML table is rendered.\n+ *\/\n+\n+public class bug4174871 {\n+    private static JFrame frame;\n+    private static JTextPane pane;\n+    private static volatile boolean passed = false;\n+\n+    public static void main(String[] args) throws Exception {\n+        try {\n+            Robot robot = new Robot();\n+\n+            SwingUtilities.invokeAndWait(bug4174871::createAndShowUI);\n+            robot.waitForIdle();\n+            robot.delay(500);\n+\n+            SwingUtilities.invokeAndWait(bug4174871::testUI);\n+\n+            if (!passed) {\n+                throw new RuntimeException(\"Test failed!!\" +\n+                        \" CELLSPACING attribute in HTML table is NOT rendered\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n+        }\n+    }\n+\n+    public static void createAndShowUI() {\n+        pane = new JTextPane();\n+        pane.setContentType(\"text\/html\");\n+        pane.setText(\"<html>\"\n+                + \"<html><head><table border=1 cellspacing=20>\"\n+                + \"<tr><td width=100>one<\/td><td width=100>two<\/td><td width=100>three<\/td><\/tr>\"\n+                + \"<\/table><\/body><\/html>\");\n+\n+        frame = new JFrame(\"Table CellSpacing Test\");\n+        frame.getContentPane().add(pane);\n+        frame.setSize(600, 200);\n+        frame.setVisible(true);\n+    }\n+\n+    private static void testUI() {\n+        int tableWidth = 0;\n+        Shape r = pane.getBounds();\n+        View v = pane.getUI().getRootView(pane);\n+\n+        while (!(v instanceof javax.swing.text.html.ParagraphView)) {\n+            int n = v.getViewCount();\n+            Shape sh = v.getChildAllocation(n - 1, r);\n+            String viewName = v.getClass().getName();\n+            if (viewName.endsWith(\"TableView\")) {\n+                tableWidth = r.getBounds().width;\n+            }\n+            v = v.getView(n - 1);\n+            if (sh != null) {\n+                r = sh;\n+            }\n+        }\n+        \/\/ tableWidth should be the sum of TD's widths (300)\n+        \/\/ and cellspacings (80)\n+        passed = (tableWidth >= 380);\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/text\/html\/CSS\/bug4174871.java","additions":101,"deletions":0,"binary":false,"changes":101,"status":"added"},{"patch":"@@ -0,0 +1,100 @@\n+\/*\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import javax.swing.JFrame;\n+import javax.swing.JTextPane;\n+import javax.swing.SwingUtilities;\n+import javax.swing.text.View;\n+import java.awt.Robot;\n+import java.awt.Shape;\n+\n+\/*\n+ * @test\n+ * @bug 4174874\n+ * @key headful\n+ * @summary  Tests if borders in HTML table are rendered\n+ *\/\n+\n+public class bug4174874 {\n+    private static JFrame frame;\n+    private static JTextPane pane;\n+    private static volatile boolean passed = false;\n+\n+    public static void main(String[] args) throws Exception {\n+        try {\n+            Robot robot = new Robot();\n+\n+            SwingUtilities.invokeAndWait(bug4174874::createAndShowUI);\n+            robot.waitForIdle();\n+            robot.delay(500);\n+\n+            SwingUtilities.invokeAndWait(bug4174874::testUI);\n+\n+            if (!passed) {\n+                throw new RuntimeException(\"Test failed!!\" +\n+                        \" Borders of HTML table not rendered correctly\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n+        }\n+    }\n+\n+    public static void createAndShowUI() {\n+        pane = new JTextPane();\n+        pane.setContentType(\"text\/html\");\n+        pane.setText(\"<html>\"\n+                + \"<html><head><table border=20>\"\n+                + \"<tr><td width=100>one<\/td><td width=100>two<\/td><td width=100>three<\/td><\/tr>\"\n+                + \"<\/table><\/body><\/html>\");\n+\n+        frame = new JFrame(\"Table Border Test\");\n+        frame.getContentPane().add(pane);\n+        frame.setSize(600, 200);\n+        frame.setVisible(true);\n+    }\n+\n+    private static void testUI() {\n+        Shape r = pane.getBounds();\n+        View v = pane.getUI().getRootView(pane);\n+        int tableWidth = 0;\n+        while (!(v instanceof javax.swing.text.html.ParagraphView)) {\n+            int n = v.getViewCount();\n+            Shape sh = v.getChildAllocation(n - 1,  r);\n+            String viewName = v.getClass().getName();\n+            if (viewName.endsWith(\"TableView\")) {\n+                tableWidth = r.getBounds().width;\n+            }\n+            v = v.getView(n - 1);\n+            if (sh != null) {\n+                r = sh;\n+            }\n+        }\n+        \/\/ tableWidth should be the sum of TD's widths (300)\n+        \/\/ and border width * 2 (40)\n+        passed = tableWidth >= 340;\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/text\/html\/CSS\/bug4174874.java","additions":100,"deletions":0,"binary":false,"changes":100,"status":"added"},{"patch":"@@ -0,0 +1,96 @@\n+\/*\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.Robot;\n+import javax.swing.JEditorPane;\n+import javax.swing.JFrame;\n+import javax.swing.SwingUtilities;\n+import javax.swing.text.AttributeSet;\n+import javax.swing.text.StyleConstants;\n+import javax.swing.text.View;\n+import javax.swing.text.html.HTMLEditorKit;\n+\n+\n+\/*\n+ * @test\n+ * @bug 4284162\n+ * @key headful\n+ * @summary Tests if css text-indent attribute is supported with negative values.\n+ *\/\n+\n+public class bug4284162 {\n+    private static JEditorPane jep;\n+    private static JFrame frame;\n+    private static volatile boolean passed = false;\n+\n+    public static void main(String[] args) throws Exception {\n+        try {\n+            Robot robot = new Robot();\n+\n+            SwingUtilities.invokeAndWait(bug4284162::createAndShowUI);\n+            robot.waitForIdle();\n+            robot.delay(500);\n+\n+            SwingUtilities.invokeAndWait(bug4284162::testUI);\n+\n+            if (!passed) {\n+                throw new RuntimeException(\"Test failed!!\" +\n+                        \" CSS Text-indent attribute doesn't support negative values\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n+        }\n+    }\n+\n+    public static void createAndShowUI() {\n+        String text =\"<html><head><style>body {text-indent: -24.000000pt;}<\/style><\/head>\"\n+                + \"<body><p>paragraph<\/body><\/html>\";\n+\n+        frame = new JFrame(\"CSS Text-Indent Test\");\n+        jep = new JEditorPane();\n+        jep.setEditorKit(new HTMLEditorKit());\n+        jep.setEditable(false);\n+\n+        jep.setText(text);\n+\n+        frame.getContentPane().add(jep);\n+        frame.setSize(200, 200);\n+        frame.setVisible(true);\n+    }\n+\n+    private static void testUI() {\n+        View v = jep.getUI().getRootView(jep);\n+        while (!(v instanceof javax.swing.text.html.ParagraphView)) {\n+            int n = v.getViewCount();\n+            v = v.getView(n - 1);\n+        }\n+\n+        AttributeSet attrs = v.getAttributes();\n+        Object attr = attrs.getAttribute(StyleConstants.FirstLineIndent);\n+        passed = (attr.toString().startsWith(\"-\"));\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/text\/html\/CSS\/bug4284162.java","additions":96,"deletions":0,"binary":false,"changes":96,"status":"added"},{"patch":"@@ -0,0 +1,107 @@\n+\/*\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.Robot;\n+import java.awt.Shape;\n+import javax.swing.JEditorPane;\n+import javax.swing.JFrame;\n+import javax.swing.JTextPane;\n+import javax.swing.SwingUtilities;\n+import javax.swing.text.View;\n+\n+\/*\n+ * @test\n+ * @bug 4764897\n+ * @key headful\n+ * @summary Tests if text and borders in HTML table doesn't run over right edge\n+ *\/\n+\n+public class bug4764897 {\n+    private static JEditorPane pane;\n+    private static JFrame frame;\n+    private static volatile boolean passed = false;\n+\n+    public static void main(String[] args) throws Exception {\n+        try {\n+            Robot robot = new Robot();\n+\n+            SwingUtilities.invokeAndWait(bug4764897::createAndShowUI);\n+            robot.waitForIdle();\n+            robot.delay(500);\n+\n+            SwingUtilities.invokeAndWait(bug4764897::testUI);\n+\n+            if (!passed) {\n+                throw new RuntimeException(\"Test failed!!\" +\n+                        \" Text and Borders of HTML table run over the right edge\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n+        }\n+    }\n+\n+    public static void createAndShowUI() {\n+        pane = new JTextPane();\n+        pane.setContentType(\"text\/html\");\n+        pane.setText(\"<html>\"\n+                + \"<html><head><table border>\"\n+                + \"<tr><td width=20%>one<\/td><td width=20%>&nbsp;<\/td>\"\n+                + \"<td width=20%>ThisIsAnExtraWideWord<\/td><td width=40%>\"\n+                + \"This is text that won't get displayed correctly.<\/td><\/tr>\"\n+                + \"<\/table><\/body><\/html>\");\n+\n+        frame = new JFrame(\"Table Border & Text Test\");\n+        frame.getContentPane().add(pane);\n+        frame.setSize(600, 200);\n+        frame.setVisible(true);\n+    }\n+\n+    private static void testUI() {\n+        Shape r = pane.getBounds();\n+        View v = pane.getUI().getRootView(pane);\n+        int tableWidth = 0;\n+        int cellsWidth = 0;\n+        while (!(v instanceof javax.swing.text.html.ParagraphView)) {\n+            int n = v.getViewCount();\n+            Shape sh = v.getChildAllocation(n - 1, r);\n+            String viewName = v.getClass().getName();\n+            if (viewName.endsWith(\"TableView\")) {\n+                tableWidth = r.getBounds().width;\n+            }\n+\n+            if (viewName.endsWith(\"CellView\")) {\n+                cellsWidth = r.getBounds().x + r.getBounds().width;\n+            }\n+\n+            v = v.getView(n - 1);\n+            if (sh != null) {\n+                r = sh;\n+            }\n+        }\n+        passed = cellsWidth <= tableWidth;\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/text\/html\/CSS\/bug4764897.java","additions":107,"deletions":0,"binary":false,"changes":107,"status":"added"},{"patch":"@@ -0,0 +1,39 @@\n+\/*\n+ * Copyright (c) 1999, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import javax.swing.JLabel;\n+\n+\/*\n+ * @test\n+ * @bug 4209280\n+ * @summary Tests that no exception is thrown on unknown HTML tag\n+ *\/\n+\n+public class bug4209280 {\n+\n+    public static void main(String[] args) throws Exception {\n+        String html = \"<html><bold>Foo<\/bold><\/html>\";\n+        \/\/ The following line should throw no exceptions\n+        new JLabel(html);\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/text\/html\/HTMLDocument\/bug4209280.java","additions":39,"deletions":0,"binary":false,"changes":39,"status":"added"}]}