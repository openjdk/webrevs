{"files":[{"patch":"@@ -0,0 +1,97 @@\n+\/*\n+ * Copyright (c) 1998, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.Button;\n+import java.awt.Frame;\n+import java.awt.EventQueue;\n+import java.awt.Robot;\n+import javax.swing.JScrollPane;\n+import javax.swing.JTextArea;\n+\n+\/*\n+ * @test\n+ * @bug 4103095\n+ * @summary Test for getBounds() after a Frame resize.\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual GetBoundsResizeTest\n+*\/\n+\n+public class GetBoundsResizeTest {\n+    private static final String INSTRUCTIONS = \"\"\"\n+            0. There is a test window with a \"Press\" button,\n+                Its original bounds should be printed in the text area below.\n+            1. Resize the test window using the upper left corner.\n+            2. Press the button to print the result of getBounds() to the text area.\n+            3. Previously, a window could report an incorrect position on the\n+                screen after resizing the window in this way.\n+                If getBounds() prints the appropriate values for the window,\n+                click Pass, otherwise click Fail.\n+            \"\"\";\n+\n+    private static JTextArea textArea;\n+    private static Frame frame;\n+\n+    public static void main(String[] args) throws Exception {\n+        Robot robot = new Robot();\n+\n+        PassFailJFrame passFailJFrame = PassFailJFrame\n+                .builder()\n+                .title(\"GetBoundsResizeTest Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .splitUIBottom(() -> {\n+                    textArea = new JTextArea(\"\", 8, 55);\n+                    textArea.setEditable(false);\n+                    return new JScrollPane(textArea);\n+                })\n+                .testUI(GetBoundsResizeTest::getFrame)\n+                .rows((int) (INSTRUCTIONS.lines().count() + 2))\n+                .columns(40)\n+                .build();\n+\n+        robot.waitForIdle();\n+        robot.delay(500);\n+\n+        EventQueue.invokeAndWait(() ->\n+                logFrameBounds(\"Original Frame.getBounds() = %s\\n\"));\n+\n+        passFailJFrame.awaitAndCheck();\n+    }\n+\n+    private static Frame getFrame() {\n+        frame = new Frame(\"GetBoundsResizeTest\");\n+\n+        Button button = new Button(\"Press\");\n+        button.addActionListener((e) ->\n+                logFrameBounds(\"Current Frame.getBounds() = %s\\n\"));\n+\n+        frame.add(button);\n+        frame.setSize(200, 100);\n+\n+        return frame;\n+    }\n+\n+    private static void logFrameBounds(String format) {\n+        textArea.append(format.formatted(frame.getBounds()));\n+    }\n+}\n","filename":"test\/jdk\/java\/awt\/Frame\/GetBoundsResizeTest.java","additions":97,"deletions":0,"binary":false,"changes":97,"status":"added"},{"patch":"@@ -1,168 +0,0 @@\n-\/*\n- * Copyright (c) 1998, 2014, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/* @test\n-   @bug 4103095\n-   @summary Test for getBounds() after a Frame resize.\n-   @author andrei.dmitriev : area=awt.toplevel\n-   @run main\/manual GetBoundsResizeTest\n-*\/\n-\n-import java.applet.Applet;\n-import java.lang.*;\n-import java.awt.*;\n-import java.awt.event.*;\n-\n-class Globals {\n-  static boolean testPassed=false;\n-  static Thread mainThread=null;\n-}\n-\n-public class GetBoundsResizeTest extends Applet {\n-\n-  public static void main(String args[]) throws Exception {\n-    GetBoundsResizeTest app = new GetBoundsResizeTest();\n-    app.start();\n-    Globals.mainThread = Thread.currentThread();\n-    try {\n-      Thread.sleep(300000);\n-    } catch (InterruptedException e) {\n-      if (!Globals.testPassed)\n-        throw new Exception(\"GetBoundsResizeTest failed.\");\n-    }\n-  }\n-\n-  public void start()\n-  {\n-    String[] message = {\n-      \"Resize the window using the upper left corner.\",\n-      \"Press the button to print the result of getBounds() to the terminal.\",\n-      \"If getBounds() prints the correct values for the window\",\n-      \"then click Pass, else click Fail.\"\n-    };\n-    new TestDialog(new Frame(), \"GetBoundsResizeTest\", message).start();\n-    new GetBoundsResizeTester(\"GetBoundsResizeTester\").start();\n-  }\n-}\n-\n-\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n-\/\/  Test Dialog\n-\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n-\n-class TestDialog extends Dialog\n-    implements ActionListener {\n-\n-  static TextArea output;\n-  Button passButton;\n-  Button failButton;\n-  String name;\n-\n-  public TestDialog(Frame frame, String name, String[] message)\n-  {\n-    super(frame, name + \" Pass\/Fail Dialog\");\n-    this.name = name;\n-    int maxStringLength = 0;\n-    for (int i=0; i<message.length; i++) {\n-      maxStringLength = Math.max(maxStringLength, message[i].length());\n-    }\n-    output = new TextArea(10, maxStringLength);\n-    add(\"North\", output);\n-    for (int i=0; i<message.length; i++){\n-        output.append(message[i] + \"\\n\");\n-    }\n-    Panel buttonPanel = new Panel();\n-    passButton = new Button(\"Pass\");\n-    failButton = new Button(\"Fail\");\n-    passButton.addActionListener(this);\n-    failButton.addActionListener(this);\n-    buttonPanel.add(passButton);\n-    buttonPanel.add(failButton);\n-    add(\"South\", buttonPanel);\n-    pack();\n-  }\n-\n-  public void start()\n-  {\n-    show();\n-  }\n-\n-  public void actionPerformed(ActionEvent event)\n-  {\n-    if ( event.getSource() == passButton ) {\n-      Globals.testPassed = true;\n-      System.err.println(name + \" Passed.\");\n-    }\n-    else if ( event.getSource() == failButton ) {\n-      Globals.testPassed = false;\n-      System.err.println(name + \" Failed.\");\n-    }\n-    this.dispose();\n-    if (Globals.mainThread != null)\n-      Globals.mainThread.interrupt();\n-  }\n-}\n-\n-\n-  \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n-  \/\/  Test Class\n-  \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n-\n-class GetBoundsResizeTester extends Frame {\n-    Button b = new Button(\"Press\");\n-\n-  GetBoundsResizeTester(String name)\n-  {\n-    super(name);\n-    final Frame f = this;\n-    Panel p = new Panel();\n-    f.add(p);\n-    p.setLayout(new BorderLayout());\n-    b.addActionListener(new ActionListener() {\n-      public void actionPerformed(ActionEvent be){\n-        Point cp = b.getLocationOnScreen();\n-        TestDialog.output.append(\"Current Frame.getBounds() = \" + f.getBounds()+\"\\n\");\n-      }\n-    });\n-    p.add(\"Center\", b);\n-    f.pack();\n-  }\n-\n-  public void start ()\n-  {\n-      setVisible(true);\n-      Robot robot;\n-      try {\n-          robot = new Robot();\n-          robot.waitForIdle();\n-      }catch(Exception ignorex) {\n-      }\n-      Point cp = b.getLocationOnScreen();\n-      TestDialog.output.append(\"Original Frame.getBounds() = \" + this.getBounds()+\"\\n\");\n-  }\n-\n-  public static void main(String[] args)\n-  {\n-    new GetBoundsResizeTester(\"GetBoundsResizeTester\").start();\n-  }\n-\n-}\n","filename":"test\/jdk\/java\/awt\/Frame\/GetBoundsResizeTest\/GetBoundsResizeTest.java","additions":0,"deletions":168,"binary":false,"changes":168,"status":"deleted"}]}