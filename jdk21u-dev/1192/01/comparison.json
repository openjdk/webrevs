{"files":[{"patch":"@@ -2675,0 +2675,5 @@\n+\n+            @Override\n+            public boolean allowSecurityManager() {\n+                return System.allowSecurityManager();\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/lang\/System.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -55,0 +55,2 @@\n+\n+import jdk.internal.access.JavaLangAccess;\n@@ -982,5 +984,1 @@\n-            @SuppressWarnings(\"removal\")\n-            SecurityManager sm = System.getSecurityManager();\n-            if (sm == null)\n-                return new ForkJoinWorkerThread(null, pool, true, false);\n-            else if (isCommon)\n+            if (isCommon && JLA.allowSecurityManager())\n@@ -1003,0 +1001,2 @@\n+        private static final JavaLangAccess JLA = SharedSecrets.getJavaLangAccess();\n+\n","filename":"src\/java.base\/share\/classes\/java\/util\/concurrent\/ForkJoinPool.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -582,0 +582,6 @@\n+\n+    \/**\n+     * Is a security manager already set or allowed to be set\n+     * (using -Djava.security.manager=allow)?\n+     *\/\n+    boolean allowSecurityManager();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaLangAccess.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -82,0 +82,3 @@\n+            ClassLoader preexistingContextClassLoader =\n+                    currentThread.getContextClassLoader();\n+\n@@ -98,0 +101,5 @@\n+            else {\n+                currentThread.setContextClassLoader(classLoaderDistinctFromSystemClassLoader);\n+                assertSame(currentThread.getContextClassLoader(), classLoaderDistinctFromSystemClassLoader);\n+                currentThread.setContextClassLoader(preexistingContextClassLoader);\n+            }\n","filename":"test\/jdk\/java\/util\/concurrent\/tck\/ForkJoinPool9Test.java","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"}]}