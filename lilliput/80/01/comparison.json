{"files":[{"patch":"@@ -34,1 +34,1 @@\n-  _base(UseFastLocking && !UseHeavyMonitors ? NEW_C_HEAP_ARRAY(oop, INITIAL_CAPACITY, mtSynchronizer) : NULL),\n+  _base(UseFastLocking && !UseHeavyMonitors ? _initial : NULL),\n@@ -41,1 +41,3 @@\n-    FREE_C_HEAP_ARRAY(oop, _base);\n+    if (_base != _initial) {\n+      FREE_C_HEAP_ARRAY(oop, _base);\n+    }\n@@ -62,3 +64,8 @@\n-  oop* new_stack = NEW_C_HEAP_ARRAY(oop, new_capacity, mtSynchronizer);\n-  for (size_t i = 0; i < index; i++) {\n-    *(new_stack + i) = *(_base + i);\n+  if (_base == _initial) {\n+    oop* new_stack = NEW_C_HEAP_ARRAY(oop, new_capacity, mtSynchronizer);\n+    for (size_t i = 0; i < index; i++) {\n+      *(new_stack + i) = *(_base + i);\n+    }\n+    _base = new_stack;\n+  } else {\n+    _base = REALLOC_C_HEAP_ARRAY(oop, _base, new_capacity, mtSynchronizer);\n@@ -66,2 +73,0 @@\n-  FREE_C_HEAP_ARRAY(oop, _base);\n-  _base = new_stack;\n","filename":"src\/hotspot\/share\/runtime\/lockStack.cpp","additions":12,"deletions":7,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-  static const size_t INITIAL_CAPACITY = 1;\n+  static const size_t INITIAL_CAPACITY = 4;\n@@ -42,0 +42,1 @@\n+  oop _initial[INITIAL_CAPACITY];\n","filename":"src\/hotspot\/share\/runtime\/lockStack.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}