{"files":[{"patch":"@@ -26,0 +26,1 @@\n+import org.junit.jupiter.api.Assertions;\n@@ -30,1 +31,0 @@\n-import org.openjdk.asmtools.ext.CaptureSystemOutput;\n@@ -45,2 +45,0 @@\n-import static org.hamcrest.MatcherAssert.assertThat;\n-import static org.hamcrest.Matchers.*;\n@@ -49,2 +47,0 @@\n-import static org.openjdk.asmtools.ext.CaptureSystemOutput.Kind.BOTH;\n-import static org.openjdk.asmtools.ext.CaptureSystemOutput.Kind.OUTPUT;\n@@ -56,1 +52,2 @@\n-    private List<Error> errors = Collections.synchronizedList(new ArrayList<>());\n+    private final List<Error> errors = Collections.synchronizedList(new ArrayList<>());\n+    private final List<Integer> results = Collections.synchronizedList(new ArrayList<>());\n@@ -101,2 +98,9 @@\n-                assertAll(() -> sequenceCompiler.jasm(jasmFiles),\n-                        () -> sequenceCompiler.jcoder(jcodFiles));\n+                assertAll(() -> {\n+                            var l = sequenceCompiler.jasm(jasmFiles);\n+                            results.add(l.result);\n+                        },\n+                        () -> {\n+                            var l = sequenceCompiler.jcoder(jcodFiles);\n+                            results.add(l.result);\n+                        }\n+                );\n@@ -104,2 +108,9 @@\n-                assertAll(() -> sequenceCompiler.jcoder(jcodFiles),\n-                        () -> sequenceCompiler.jasm(jasmFiles));\n+                assertAll(() -> {\n+                            var l = sequenceCompiler.jcoder(jcodFiles);\n+                            results.add(l.result);\n+                        },\n+                        () -> {\n+                            var l = sequenceCompiler.jasm(jasmFiles);\n+                            results.add(l.result);\n+                        }\n+                );\n@@ -142,2 +153,1 @@\n-    @CaptureSystemOutput(value = BOTH, mute = true)\n-    public void testCompilersWithConcurrency(CaptureSystemOutput.OutputCapture outputCapture) throws InterruptedException {\n+    public void testCompilersWithConcurrency() throws InterruptedException {\n@@ -161,10 +171,10 @@\n-        List<String> list = outputCapture.getLogAsList(OUTPUT);\n-        assertThat(list, allOf(\n-                hasItem(matchesPattern(\"jcoder OK\")),\n-                hasItem(matchesPattern(\"jasm OK\")))\n-        );\n-        assertThat(list, hasSize(6));\n-        \/\/ check ERROR's results\n-        assertEquals(6,\n-                errors.stream().mapToInt(e -> ((MultipleFailuresError) e).getFailures().size()).sum(),\n-                \"Expected 4 missing plus 2 wrong format files.\");\n+        \/\/\"Expected 4 missing plus 2 wrong format files.\");\n+        assertEquals(12, results.size());\n+        Collections.sort(results);\n+        assertEquals(results.get(0), 0);\n+        assertEquals(results.get(5), 0);\n+        assertEquals(results.get(6), 1);\n+        assertEquals(results.get(8), 1);\n+        assertEquals(results.get(9), 2);\n+        assertEquals(results.get(10), 2);\n+        assertEquals(results.get(11), 8);\n","filename":"test\/java\/org\/openjdk\/asmtools\/SequenceCallsTests.java","additions":32,"deletions":22,"binary":false,"changes":54,"status":"modified"}]}