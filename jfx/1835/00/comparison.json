{"files":[{"patch":"@@ -405,1 +405,3 @@\n-    @Override native protected boolean _supportsSystemMenu();\n+    @Override protected boolean _supportsSystemMenu() {\n+        return true;\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/mac\/MacApplication.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1224,12 +1224,0 @@\n-\n-\/*\n- * Class:     com_sun_glass_ui_mac_MacApplication\n- * Method:    _supportsSystemMenu\n- * Signature: ()Z;\n- *\/\n-JNIEXPORT jboolean JNICALL Java_com_sun_glass_ui_mac_MacApplication__1supportsSystemMenu\n-(JNIEnv *env, jobject japplication)\n-{\n-    return !isEmbedded;\n-}\n-\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassApplication.m","additions":0,"deletions":12,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -33,0 +33,1 @@\n+        NSMutableSet  *ownedMenus;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassMenu.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -70,0 +70,1 @@\n+        self->ownedMenus = [[NSMutableSet allocWithZone:NSDefaultMallocZone()] init];\n@@ -300,0 +301,17 @@\n+void updateMenuBar(GlassMenubar *menubar) {\n+    NSUInteger index = [menubar->menu numberOfItems] - 1;\n+\n+    \/\/ remove all menus at the end that are not owned by javafx\n+    while (index > 0) {\n+        NSMenuItem *item = [menubar->menu itemAtIndex:index];\n+\n+        if (![menubar->ownedMenus containsObject:item]) {\n+            [menubar->menu removeItemAtIndex:index--];\n+        } else {\n+            break;\n+        }\n+    }\n+\n+    [[NSApp mainMenu] update];\n+}\n+\n@@ -340,0 +358,2 @@\n+        [menubar->ownedMenus addObject:glassmenu->item];\n+\n@@ -351,1 +371,1 @@\n-        [[NSApp mainMenu] update];\n+        updateMenuBar(menubar);\n@@ -373,0 +393,3 @@\n+\n+        [menubar->ownedMenus removeObject:glassmenu->item];\n+\n@@ -377,1 +400,2 @@\n-        [[NSApp mainMenu] update];\n+\n+        updateMenuBar(menubar);\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassMenu.m","additions":26,"deletions":2,"binary":false,"changes":28,"status":"modified"}]}