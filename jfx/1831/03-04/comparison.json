{"files":[{"patch":"@@ -47,0 +47,1 @@\n+import javafx.event.Event;\n@@ -59,0 +60,1 @@\n+import javafx.stage.WindowEvent;\n@@ -440,1 +442,1 @@\n-                case CLOSE -> stage.close();\n+                case CLOSE -> Event.fireEvent(stage, new WindowEvent(stage, WindowEvent.WINDOW_CLOSE_REQUEST));\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/HeaderButtonOverlay.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -110,1 +110,1 @@\n-            case CLOSE -> stage.close();\n+            case CLOSE -> Event.fireEvent(stage, new WindowEvent(stage, WindowEvent.WINDOW_CLOSE_REQUEST));\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/scene\/layout\/HeaderButtonBehavior.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import com.sun.glass.events.MouseEvent;\n@@ -38,0 +39,1 @@\n+import javafx.stage.WindowEvent;\n@@ -493,0 +495,24 @@\n+    \/**\n+     * Tests that clicking the close button fires the {@link WindowEvent#WINDOW_CLOSE_REQUEST} event.\n+     *\/\n+    @Test\n+    void closeButtonFiresWindowCloseRequestEvent() {\n+        var overlay = new HeaderButtonOverlay(getStylesheet(\"\"\"\n+                .-FX-INTERNAL-header-button-container { -fx-button-placement: right; -fx-button-vertical-alignment: stretch; }\n+                .-FX-INTERNAL-header-button { -fx-pref-width: 20; -fx-pref-height: 10; }\n+            \"\"\"), false, false, false);\n+\n+        var stage = new Stage();\n+        var scene = new Scene(overlay);\n+        stage.setScene(scene);\n+        overlay.resize(200, 100);\n+        overlay.applyCss();\n+        overlay.layout();\n+\n+        var flag = new boolean[1];\n+        stage.setOnCloseRequest(_ -> flag[0] = true);\n+        overlay.handleMouseEvent(MouseEvent.DOWN, MouseEvent.BUTTON_LEFT, 181, 10);\n+        overlay.handleMouseEvent(MouseEvent.UP, MouseEvent.BUTTON_LEFT, 181, 10);\n+        assertTrue(flag[0]);\n+    }\n+\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/com\/sun\/glass\/ui\/HeaderButtonOverlayTest.java","additions":26,"deletions":0,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import javafx.event.Event;\n@@ -31,0 +32,2 @@\n+import javafx.scene.input.MouseButton;\n+import javafx.scene.input.MouseEvent;\n@@ -33,0 +36,1 @@\n+import javafx.scene.layout.Region;\n@@ -35,0 +39,2 @@\n+import javafx.stage.WindowEvent;\n+import org.junit.jupiter.api.Test;\n@@ -95,0 +101,23 @@\n+\n+    \/**\n+     * Tests that clicking the close button fires the {@link WindowEvent#WINDOW_CLOSE_REQUEST} event.\n+     *\/\n+    @Test\n+    void closeButtonFiresWindowCloseRequestEvent() {\n+        var stage = new Stage();\n+        var button = new Region();\n+        button.resize(10, 10);\n+        HeaderBar.setButtonType(button, HeaderButtonType.CLOSE);\n+        stage.setScene(new Scene(button));\n+        stage.show();\n+\n+        boolean[] flag = new boolean[1];\n+        stage.setOnCloseRequest(_ -> flag[0] = true);\n+\n+        Event.fireEvent(button, new MouseEvent(\n+            MouseEvent.MOUSE_RELEASED, 0, 0, 0, 0, MouseButton.PRIMARY, 1,\n+            false, false, false, false, false, false, false, false, false, false, null));\n+\n+        assertTrue(flag[0]);\n+        stage.close();\n+    }\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/com\/sun\/javafx\/scene\/layout\/HeaderButtonBehaviorTest.java","additions":29,"deletions":0,"binary":false,"changes":29,"status":"modified"}]}