{"files":[{"patch":"@@ -29,0 +29,2 @@\n+import javafx.beans.property.ObjectProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n@@ -30,0 +32,2 @@\n+import javafx.collections.FXCollections;\n+import javafx.collections.ObservableList;\n@@ -31,1 +35,0 @@\n-\n@@ -33,1 +36,0 @@\n-\n@@ -237,0 +239,3 @@\n+    protected final ObjectProperty<WindowOverlayMetrics> windowOverlayMetrics =\n+            new SimpleObjectProperty<>(this, \"windowOverlayMetrics\");\n+\n@@ -429,1 +434,1 @@\n-     * @return the overlay metrics, or {@code null} if the window type does not support metrics\n+     * @return the overlay metrics\n@@ -431,2 +436,2 @@\n-    public ObservableValue<WindowOverlayMetrics> windowOverlayMetrics() {\n-        return null;\n+    public ObservableValue<WindowOverlayMetrics> getWindowOverlayMetrics() {\n+        return windowOverlayMetrics;\n@@ -438,1 +443,1 @@\n-     * @return the overlay, or {@code null} if the window type does not provide overlay controls\n+     * @return the overlay, or {@code null} if the window does not provide an overlay\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/Window.java","additions":11,"deletions":6,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -36,2 +36,0 @@\n-import com.sun.glass.ui.WindowOverlayMetrics;\n-import javafx.beans.value.ObservableValue;\n@@ -213,6 +211,0 @@\n-    @Override\n-    public ObservableValue<WindowOverlayMetrics> windowOverlayMetrics() {\n-        var overlay = getWindowOverlay();\n-        return overlay != null ? overlay.metricsProperty() : null;\n-    }\n-\n@@ -232,0 +224,2 @@\n+\n+            windowOverlayMetrics.bind(windowControlsOverlay.metricsProperty());\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/gtk\/GtkWindow.java","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-import com.sun.javafx.binding.ObjectConstant;\n@@ -186,2 +185,0 @@\n-    private ObservableValue<WindowOverlayMetrics> windowOverlayMetrics;\n-\n@@ -189,9 +186,6 @@\n-    public ObservableValue<WindowOverlayMetrics> windowOverlayMetrics() {\n-        if (windowOverlayMetrics == null) {\n-            HorizontalDirection direction = _isRightToLeftLayoutDirection()\n-                ? HorizontalDirection.RIGHT\n-                : HorizontalDirection.LEFT;\n-\n-            windowOverlayMetrics = ObjectConstant.valueOf(\n-                new WindowOverlayMetrics(direction, new Dimension2D(78, 38)));\n-        }\n+    public ObservableValue<WindowOverlayMetrics> getWindowOverlayMetrics() {\n+        HorizontalDirection direction = _isRightToLeftLayoutDirection()\n+            ? HorizontalDirection.RIGHT\n+            : HorizontalDirection.LEFT;\n+\n+        windowOverlayMetrics.set(new WindowOverlayMetrics(direction, new Dimension2D(78, 38)));\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/mac\/MacWindow.java","additions":6,"deletions":12,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import com.sun.glass.ui.WindowOverlayMetrics;\n@@ -36,1 +35,0 @@\n-import javafx.beans.value.ObservableValue;\n@@ -343,6 +341,0 @@\n-    @Override\n-    public ObservableValue<WindowOverlayMetrics> windowOverlayMetrics() {\n-        var overlay = getWindowOverlay();\n-        return overlay != null ? overlay.metricsProperty() : null;\n-    }\n-\n@@ -358,0 +350,1 @@\n+            windowOverlayMetrics.bind(windowControlsOverlay.metricsProperty());\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/win\/WinWindow.java","additions":1,"deletions":8,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import javafx.beans.value.ObservableValue;\n@@ -85,1 +84,1 @@\n-    private Subscription metricsSubscription;\n+    private Subscription subscription;\n@@ -108,3 +107,3 @@\n-            if (metricsSubscription != null) {\n-                metricsSubscription.unsubscribe();\n-                metricsSubscription = null;\n+            if (subscription != null) {\n+                subscription.unsubscribe();\n+                subscription = null;\n@@ -114,6 +113,4 @@\n-            ObservableValue<WindowOverlayMetrics> metrics =\n-                windowStage.getPlatformWindow().windowOverlayMetrics();\n-\n-            if (metrics != null) {\n-                metricsSubscription = metrics.subscribe(this::onMetricsChanged);\n-            }\n+            subscription = windowStage\n+                .getPlatformWindow()\n+                .getWindowOverlayMetrics()\n+                .subscribe(this::onMetricsChanged);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/layout\/HeaderBarBase.java","additions":8,"deletions":11,"binary":false,"changes":19,"status":"modified"}]}