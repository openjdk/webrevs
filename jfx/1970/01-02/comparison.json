{"files":[{"patch":"@@ -62,0 +62,2 @@\n+import com.sun.javafx.gradle.CompileTarget\n+\n@@ -168,10 +170,0 @@\n-\/**\n- * Struct used to contain some information passed to the closure\n- * passed to compileTargets.\n- *\/\n-class CompileTarget {\n-    String name;\n-    String upper;\n-    String capital;\n-}\n-\n@@ -345,2 +337,0 @@\n-ext.MAVEN_GROUP_ID = \"org.openjfx\"\n-\n@@ -814,3 +804,0 @@\n-\/\/ Load Maven Publishing logic.\n-apply from: 'maven-publish.gradle'\n-\n@@ -2122,0 +2109,2 @@\n+    println \"build: base\"\n+\n@@ -2185,1 +2174,0 @@\n-    addMavenPublication(project, [])\n@@ -2783,2 +2771,0 @@\n-    addMavenPublication(project, [ 'base' ])\n-\n@@ -2861,2 +2847,0 @@\n-    addMavenPublication(project, [ 'graphics' ])\n-\n@@ -2931,2 +2915,0 @@\n-    addMavenPublication(project, [ 'controls' ])\n-\n@@ -2990,2 +2972,0 @@\n-    addMavenPublication(project, [ 'controls', 'incubator.input' ])\n-\n@@ -3049,4 +3029,0 @@\n-    if (COMPILE_SWING) {\n-        addMavenPublication(project, [ 'graphics' ])\n-    }\n-\n@@ -3170,1 +3146,0 @@\n-    addMavenPublication(project, [ 'controls' ])\n@@ -3778,1 +3753,0 @@\n-    addMavenPublication(project, [ 'graphics' ])\n@@ -3802,2 +3776,0 @@\n-    addMavenPublication(project, [])\n-\n@@ -4106,2 +4078,0 @@\n-    addMavenPublication(project, [ 'controls', 'media', 'jsobject' ])\n-\n@@ -4365,0 +4335,3 @@\n+\/\/ Apply Maven Publishing (if enabled) right after all projects are defined.\n+apply from: 'maven-publish.gradle'\n+\n@@ -5406,3 +5379,1 @@\n-    \/\/ Maven Publications\n-    def publicationDirName = \"${platformPrefix}publications\"\n-    def publicationDir = \"${rootProject.buildDir}\/${publicationDirName}\"\n+    configureMavenPublication(moduleProjList, t, buildModulesTask)\n@@ -5410,32 +5381,0 @@\n-    moduleProjList.each { project ->\n-        \/\/ Create publications to be uploaded\n-\n-        def moduleName = project.ext.moduleName\n-        def buildDir = project.buildDir\n-\n-        def dstModularJarDir=\"${publicationDir}\"\n-        def srcClassesDir = \"${buildDir}\/${platformPrefix}module-classes\"\n-        def srcLibsDir = \"${buildDir}\/${platformPrefix}module-lib\"\n-\n-        def modularEmptyPublicationJarName = \"${moduleName}.jar\"\n-        def modularEmptyPublicationJarTask = project.task(\"moduleEmptyPublicationJar${t.capital}\", type: Jar) {\n-            destinationDirectory = file(\"${dstModularJarDir}\")\n-            archiveFileName = modularEmptyPublicationJarName\n-            manifest {\n-                attributes(\n-                        'Automatic-Module-Name':\"${moduleName}Empty\"\n-                )\n-            }\n-        }\n-\n-        def modularPublicationJarName = \"${moduleName}-${t.name}.jar\"\n-        def modularPublicationJarTask = project.task(\"modularPublicationJar${t.capital}\", type: Jar, dependsOn: modularEmptyPublicationJarTask) {\n-            destinationDirectory = file(\"${dstModularJarDir}\")\n-            archiveFileName = modularPublicationJarName\n-            from srcLibsDir\n-            from srcClassesDir\n-        }\n-\n-        buildModulesTask.dependsOn(modularPublicationJarTask)\n-\n-    }\n@@ -5591,3 +5530,0 @@\n-        if (project.tasks.getByName(\"modularPublicationJar$t.capital\") != null) {\n-            project.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleClassesTask)\n-        }\n@@ -5663,1 +5599,0 @@\n-        baseProject.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleBaseTask)\n@@ -5738,1 +5673,0 @@\n-        graphicsProject.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleGraphicsTask)\n@@ -5813,1 +5747,0 @@\n-        mediaProject.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleMediaTask)\n@@ -5866,1 +5799,0 @@\n-        webProject.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleWeb)\n@@ -5891,1 +5823,0 @@\n-        graphicsProject.tasks.getByName(\"modularPublicationJar$t.capital\").dependsOn(buildModuleSWT)\n","filename":"build.gradle","additions":8,"deletions":77,"binary":false,"changes":85,"status":"modified"},{"patch":"@@ -0,0 +1,35 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package com.sun.javafx.gradle;\n+\n+\/**\n+ * Struct used to contain some information passed to the closure\n+ * passed to compileTargets.\n+ *\/\n+public class CompileTarget {\n+    public String name;\n+    public String upper;\n+    public String capital;\n+}\n","filename":"buildSrc\/src\/main\/groovy\/com\/sun\/javafx\/gradle\/CompileTarget.java","additions":35,"deletions":0,"binary":false,"changes":35,"status":"added"},{"patch":"@@ -25,0 +25,1 @@\n+import com.sun.javafx.gradle.CompileTarget\n@@ -41,1 +42,4 @@\n-\/\/ Specifies whether to enable the Maven publishing tasks\n+static void fail(String msg) {\n+    throw new GradleException(\"FAIL: \" + msg)\n+}\n+\n@@ -45,0 +49,1 @@\n+ext.MAVEN_GROUP_ID = \"org.openjfx\"\n@@ -49,1 +54,3 @@\n-ext.addMavenPublication = { Project project, List<String> projectDependencies ->\n+registerModules()\n+\n+void registerModules() {\n@@ -54,0 +61,74 @@\n+    Project base = project(\":base\")\n+    Project graphics = project(\":graphics\")\n+    Project controls = project(\":controls\")\n+    Project fxml = project(\":fxml\")\n+    Project media = project(\":media\")\n+\n+    addMavenPublication(base, [])\n+    addMavenPublication(graphics, [ base ])\n+    addMavenPublication(controls, [ graphics ])\n+    addMavenPublication(fxml, [ controls ])\n+    addMavenPublication(media, [ graphics ])\n+\n+    if (ext.COMPILE_SWING) {\n+        addMavenPublication(project(\":swing\"), [ graphics ])\n+    }\n+\n+    Project jsobject = project(\":jsobject\")\n+\n+    addMavenPublication(jsobject, [])\n+    addMavenPublication(project(\":web\"), [ controls, media, jsobject ])\n+\n+    \/\/ Incubator modules\n+    Project incubatorInput = project(\":incubator.input\")\n+\n+    addMavenPublication(incubatorInput, [ controls ])\n+    addMavenPublication(project(\":incubator.richtext\"), [ controls, incubatorInput ])\n+}\n+\n+ext.configureMavenPublication = { List<Project> projects, CompileTarget t, Task dependingTask ->\n+    if (!IS_MAVEN_PUBLISH) {\n+        return\n+    }\n+\n+    def targetProperties = project.ext[t.upper]\n+    def platformPrefix = targetProperties.platformPrefix\n+\n+    \/\/ Maven Publications\n+    def publicationDirName = \"${platformPrefix}publications\"\n+    def publicationDir = \"${rootProject.layout.buildDirectory.get()}\/${publicationDirName}\"\n+\n+    projects.each { Project project ->\n+        def moduleName = project.ext.moduleName\n+        def buildDir = project.layout.buildDirectory.get()\n+\n+        def dstModularJarDir=\"${publicationDir}\"\n+        def srcClassesDir = \"${buildDir}\/${platformPrefix}module-classes\"\n+        def srcLibsDir = \"${buildDir}\/${platformPrefix}module-lib\"\n+\n+        def modularEmptyPublicationJarName = \"${moduleName}.jar\"\n+        def modularEmptyPublicationJarTask = project.tasks.register(\"moduleEmptyPublicationJar${t.capital}\", Jar) {\n+            destinationDirectory = file(\"${dstModularJarDir}\")\n+            archiveFileName = modularEmptyPublicationJarName\n+            manifest {\n+                attributes(\n+                        'Automatic-Module-Name':\"${moduleName}Empty\"\n+                )\n+            }\n+        }\n+\n+        def modularPublicationJarName = \"${moduleName}-${t.name}.jar\"\n+        def modularPublicationJarTask = project.tasks.register(\"modularPublicationJar${t.capital}\", Jar) {\n+            dependsOn modularEmptyPublicationJarTask\n+\n+            destinationDirectory = file(\"${dstModularJarDir}\")\n+            archiveFileName = modularPublicationJarName\n+            from srcLibsDir\n+            from srcClassesDir\n+        }\n+\n+        dependingTask.dependsOn(modularPublicationJarTask)\n+    }\n+}\n+\n+void addMavenPublication(Project project, List<Project> projectDependencies) {\n@@ -57,2 +138,1 @@\n-    projectDependencies.each { projName ->\n-        def dep = project.project(\":$projName\")\n+    projectDependencies.each { dep ->\n@@ -87,1 +167,2 @@\n-                    filter { line -> line.replaceAll(\"@VERSION@\", MAVEN_VERSION)\n+                    filter {\n+                        line -> line.replaceAll(\"@VERSION@\", MAVEN_VERSION)\n@@ -138,2 +219,1 @@\n-                            projectDependencies.each { projName ->\n-                                def dep = project.project(\":$projName\")\n+                            projectDependencies.each { dep ->\n","filename":"maven-publish.gradle","additions":87,"deletions":7,"binary":false,"changes":94,"status":"modified"}]}