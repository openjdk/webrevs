{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import com.sun.javafx.application.PlatformImpl;\n@@ -30,0 +31,1 @@\n+import javafx.application.Platform;\n@@ -61,2 +63,7 @@\n-            Point2D result = fxRequests.getTextLocation(offset.getInsertionIndex());\n-            return new Rectangle((int)result.getX(), (int)result.getY(), 0, 0);\n+            Point2D[] location = { new Point2D(0.0, 0.0) };\n+            if (fxRequests != null) {\n+                PlatformImpl.runAndWait(() -> {\n+                    location[0] = fxRequests.getTextLocation(offset.getInsertionIndex());\n+                });\n+            }\n+            return new Rectangle((int)location[0].getX(), (int)location[0].getY(), 0, 0);\n@@ -67,2 +74,7 @@\n-            int result = fxRequests.getLocationOffset(x, y);\n-            return TextHitInfo.afterOffset(result);\n+            int[] offset = { 0 };\n+            if (fxRequests != null) {\n+                PlatformImpl.runAndWait(() -> {\n+                    offset[0] = fxRequests.getLocationOffset(x, y);\n+                });\n+            }\n+            return TextHitInfo.afterOffset(offset[0]);\n@@ -73,0 +85,1 @@\n+            int[] offset = { 0 };\n@@ -74,1 +87,3 @@\n-                return ((ExtendedInputMethodRequests)fxRequests).getInsertPositionOffset();\n+                PlatformImpl.runAndWait(() -> {\n+                    offset[0] = ((ExtendedInputMethodRequests)fxRequests).getInsertPositionOffset();\n+                });\n@@ -76,1 +91,1 @@\n-            return 0;\n+            return offset[0];\n@@ -81,1 +96,1 @@\n-            String result = null;\n+            String[] comitted = { null };\n@@ -83,1 +98,3 @@\n-                result = ((ExtendedInputMethodRequests)fxRequests).getCommittedText(beginIndex, endIndex);\n+                PlatformImpl.runAndWait(() -> {\n+                    comitted[0] = ((ExtendedInputMethodRequests)fxRequests).getCommittedText(beginIndex, endIndex);\n+                });\n@@ -85,2 +102,2 @@\n-            if (result == null) result = \"\";\n-            return new AttributedString(result).getIterator();\n+            if (comitted[0] == null) comitted[0] = \"\";\n+            return new AttributedString(comitted[0]).getIterator();\n@@ -91,0 +108,1 @@\n+            int[] length = { 0 };\n@@ -92,1 +110,3 @@\n-                return ((ExtendedInputMethodRequests)fxRequests).getCommittedTextLength();\n+                PlatformImpl.runAndWait(() -> {\n+                    length[0] = ((ExtendedInputMethodRequests)fxRequests).getCommittedTextLength();\n+                });\n@@ -94,1 +114,1 @@\n-            return 0;\n+            return length[0];\n@@ -105,3 +125,8 @@\n-            String text = fxRequests.getSelectedText();\n-            if (text == null) text = \"\";\n-            return new AttributedString(text).getIterator();\n+            String[] selected = { null };\n+            if (fxRequests != null) {\n+                PlatformImpl.runAndWait(() -> {\n+                    selected[0] = fxRequests.getSelectedText();\n+                });\n+            }\n+            if (selected[0] == null) selected[0] = \"\";\n+            return new AttributedString(selected[0]).getIterator();\n","filename":"modules\/javafx.swing\/src\/main\/java\/javafx\/embed\/swing\/InputMethodSupport.java","additions":40,"deletions":15,"binary":false,"changes":55,"status":"modified"},{"patch":"@@ -959,1 +959,1 @@\n-            return null;\n+            return new InputMethodSupport.InputMethodRequestsAdapter(null);\n","filename":"modules\/javafx.swing\/src\/main\/java\/javafx\/embed\/swing\/JFXPanel.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}