{"files":[{"patch":"@@ -326,8 +326,0 @@\n-        private static void clearStructuralPseudoClasses(Node node) {\n-            node.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, false);\n-            node.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n-            node.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, false);\n-            node.pseudoClassStateChanged(NTH_EVEN_CHILD_PSEUDO_CLASS, false);\n-            node.pseudoClassStateChanged(NTH_ODD_CHILD_PSEUDO_CLASS, false);\n-        }\n-\n@@ -368,2 +360,0 @@\n-\n-                        clearStructuralPseudoClasses(n);\n@@ -450,33 +440,0 @@\n-            int size = size();\n-\n-            \/\/ Toggle the \"only-child\" \/ \"first-child\" \/ \"last-child\" pseudo-classes.\n-            if (size == 1) {\n-                Node first = getFirst();\n-                first.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, true);\n-                first.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, true);\n-                first.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, true);\n-            } else if (size > 1) {\n-                Node first = getFirst(), last = getLast();\n-                first.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, true);\n-                first.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n-                first.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, false);\n-                last.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, true);\n-\n-                if (firstDirtyChildIndex > 0) {\n-                    \/\/ Clear the \"last-child\" pseudo-class on the last non-modified child.\n-                    Node lastNonModified = get(firstDirtyChildIndex - 1);\n-                    if (last != lastNonModified) {\n-                        lastNonModified.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n-                    }\n-                }\n-            }\n-\n-            \/\/ Toggle the \"nth-child(even)\" and \"nth-child(odd)\" pseudo-classes on all modified children.\n-            if (firstDirtyChildIndex >= 0) {\n-                for (int i = firstDirtyChildIndex; i < size; ++i) {\n-                    Node n = get(i);\n-                    n.pseudoClassStateChanged(NTH_EVEN_CHILD_PSEUDO_CLASS, i % 2 != 0);\n-                    n.pseudoClassStateChanged(NTH_ODD_CHILD_PSEUDO_CLASS, i % 2 == 0);\n-                }\n-            }\n-\n@@ -524,0 +481,3 @@\n+\n+            c.reset();\n+            updateStructuralPseudoClasses(c, firstDirtyChildIndex);\n@@ -526,0 +486,46 @@\n+        private void updateStructuralPseudoClasses(Change<Node> change, int firstDirtyChildIndex) {\n+            while (change.next()) {\n+                if (change.wasRemoved()) {\n+                    for (Node node : change.getRemoved()) {\n+                        node.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, false);\n+                        node.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n+                        node.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, false);\n+                        node.pseudoClassStateChanged(NTH_EVEN_CHILD_PSEUDO_CLASS, false);\n+                        node.pseudoClassStateChanged(NTH_ODD_CHILD_PSEUDO_CLASS, false);\n+                    }\n+                }\n+            }\n+\n+            int size = size();\n+\n+            \/\/ Toggle the \"only-child\" \/ \"first-child\" \/ \"last-child\" pseudo-classes.\n+            if (size == 1) {\n+                Node first = getFirst();\n+                first.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, true);\n+                first.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, true);\n+                first.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, true);\n+            } else if (size > 1) {\n+                Node first = getFirst(), last = getLast();\n+                first.pseudoClassStateChanged(FIRST_CHILD_PSEUDO_CLASS, true);\n+                first.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n+                first.pseudoClassStateChanged(ONLY_CHILD_PSEUDO_CLASS, false);\n+                last.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, true);\n+\n+                if (firstDirtyChildIndex > 0) {\n+                    \/\/ Clear the \"last-child\" pseudo-class on the last non-modified child.\n+                    Node lastNonModified = get(firstDirtyChildIndex - 1);\n+                    if (last != lastNonModified) {\n+                        lastNonModified.pseudoClassStateChanged(LAST_CHILD_PSEUDO_CLASS, false);\n+                    }\n+                }\n+            }\n+\n+            \/\/ Toggle the \"nth-child(even)\" and \"nth-child(odd)\" pseudo-classes on all modified children.\n+            if (firstDirtyChildIndex >= 0) {\n+                for (int i = firstDirtyChildIndex; i < size; ++i) {\n+                    Node n = get(i);\n+                    n.pseudoClassStateChanged(NTH_EVEN_CHILD_PSEUDO_CLASS, i % 2 != 0);\n+                    n.pseudoClassStateChanged(NTH_ODD_CHILD_PSEUDO_CLASS, i % 2 == 0);\n+                }\n+            }\n+        }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/Parent.java","additions":49,"deletions":43,"binary":false,"changes":92,"status":"modified"}]}