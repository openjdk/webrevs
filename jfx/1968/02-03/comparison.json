{"files":[{"patch":"@@ -208,7 +208,0 @@\n-    private static final boolean DEBUG = Boolean.getBoolean(\"jfxpanel.debug\");\n-    private static final String debugPrefix = \"JFXPanel:>> \";\n-\n-    private static void debug_println(String str) {\n-        System.out.println(debugPrefix + \" \" + str);\n-    }\n-\n@@ -284,4 +277,0 @@\n-        if (DEBUG) {\n-            debug_println(\"JFXPanel Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -313,4 +302,0 @@\n-        if (DEBUG) {\n-            debug_println(\"getScene Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -331,4 +316,0 @@\n-        if (DEBUG) {\n-            debug_println(\"setScene Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -382,4 +363,0 @@\n-        if (DEBUG) {\n-            debug_println(\"setOpaque Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -402,4 +379,0 @@\n-        if (DEBUG) {\n-            debug_println(\"isOpaque Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -536,4 +509,1 @@\n-        if (DEBUG) {\n-            debug_println(\"processMouseEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n+        var hStagePeer = stagePeer;\n@@ -547,1 +517,1 @@\n-                if (stagePeer != null) {\n+                if (hStagePeer != null) {\n@@ -549,1 +519,1 @@\n-                    stagePeer.setFocused(true, focusCause);\n+                    hStagePeer.setFocused(true, focusCause);\n@@ -567,4 +537,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processMouseMotionEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -585,4 +551,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processMouseWheelEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -618,4 +580,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processKeyEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -627,6 +585,4 @@\n-        if (DEBUG) {\n-            debug_println(\"sendResizeEventToFX Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n-        if (stagePeer != null) {\n-            stagePeer.setSize(pWidth, pHeight);\n+        var hStagePeer = stagePeer;\n+        var hScenePeer = scenePeer;\n+        if (hStagePeer != null) {\n+            hStagePeer.setSize(pWidth, pHeight);\n@@ -634,2 +590,2 @@\n-        if (scenePeer != null) {\n-            scenePeer.setSize(pWidth, pHeight);\n+        if (hScenePeer != null) {\n+            hScenePeer.setSize(pWidth, pHeight);\n@@ -650,4 +606,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processComponentEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -731,2 +683,2 @@\n-        if (stagePeer == null) {\n-            return;\n+        if (stagePeer != null) {\n+            stagePeer.setLocation(screenX, screenY);\n@@ -734,2 +686,0 @@\n-\n-        stagePeer.setLocation(screenX, screenY);\n@@ -749,4 +699,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processHierarchyBoundsEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -763,4 +709,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processHierarchyEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -776,1 +718,2 @@\n-        if ((stage == null) || (stagePeer == null) || !isFxEnabled()) {\n+        var hStagePeer = stagePeer;\n+        if ((stage == null) || (hStagePeer == null) || !isFxEnabled()) {\n@@ -791,1 +734,1 @@\n-        stagePeer.setFocused(focused, focusCause);\n+        hStagePeer.setFocused(focused, focusCause);\n@@ -804,4 +747,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processFocusEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -843,4 +782,0 @@\n-        if (DEBUG) {\n-            debug_println(\"processInputMethodEvent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -860,5 +795,7 @@\n-        scenePeer.inputMethodEvent(\n-                javafx.scene.input.InputMethodEvent.INPUT_METHOD_TEXT_CHANGED,\n-                InputMethodSupport.inputMethodEventComposed(t, e.getCommittedCharacterCount()),\n-                t.substring(0, e.getCommittedCharacterCount()),\n-                insertionIndex);\n+        if (scenePeer != null) {\n+            scenePeer.inputMethodEvent(\n+                    javafx.scene.input.InputMethodEvent.INPUT_METHOD_TEXT_CHANGED,\n+                    InputMethodSupport.inputMethodEventComposed(t, e.getCommittedCharacterCount()),\n+                    t.substring(0, e.getCommittedCharacterCount()),\n+                    insertionIndex);\n+        }\n@@ -877,5 +814,1 @@\n-    protected synchronized void paintComponent(Graphics g) {\n-        if (DEBUG) {\n-            debug_println(\"paintComponent Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n+    protected void paintComponent(Graphics g) {\n@@ -883,2 +816,1 @@\n-        var hStage = stage;\n-        if (hScenePeer == null || hStage == null) {\n+        if (hScenePeer == null || stage == null) {\n@@ -904,1 +836,1 @@\n-            hStage.setNodeOrientation(rtl ? NodeOrientation.RIGHT_TO_LEFT :\n+            stage.setNodeOrientation(rtl ? NodeOrientation.RIGHT_TO_LEFT :\n@@ -949,4 +881,0 @@\n-        if (DEBUG) {\n-            debug_println(\"getPreferredSize Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -1027,4 +955,0 @@\n-        if (DEBUG) {\n-            debug_println(\"addNotify Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -1041,1 +965,0 @@\n-                sendMoveEventToFX();\n@@ -1044,0 +967,1 @@\n+        sendMoveEventToFX();\n@@ -1048,4 +972,0 @@\n-        if (DEBUG) {\n-            debug_println(\"getInputMethodRequests Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -1065,4 +985,0 @@\n-        if (DEBUG) {\n-            debug_println(\"removeNotify Thread \" + Thread.currentThread().getName() +\n-                          \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-        }\n@@ -1102,4 +1018,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.setEmbeddedStage Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1118,0 +1030,1 @@\n+                sendMoveEventToFX();\n@@ -1119,1 +1032,0 @@\n-            sendMoveEventToFX();\n@@ -1124,4 +1036,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.setEmbeddedScene Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1158,4 +1066,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.requestFocus Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1167,4 +1071,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.traverseFocusOut Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1182,4 +1082,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.setPreferredSize Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1195,4 +1091,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.repaint Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1206,4 +1098,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.setEnabled Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1215,4 +1103,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.setCursor Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1243,4 +1127,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.grabFocus Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n@@ -1263,4 +1143,0 @@\n-            if (DEBUG) {\n-                debug_println(\"HostContainer.ungrabFocus Thread \" + Thread.currentThread().getName() +\n-                              \" isFXUserThread \" + Toolkit.getToolkit().isFxUserThread());\n-            }\n","filename":"modules\/javafx.swing\/src\/main\/java\/javafx\/embed\/swing\/JFXPanel.java","additions":26,"deletions":150,"binary":false,"changes":176,"status":"modified"}]}