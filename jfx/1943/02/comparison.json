{"files":[{"patch":"@@ -46,0 +46,1 @@\n+import javafx.scene.layout.HeaderBar;\n@@ -464,4 +465,4 @@\n-     * Specifies the style for this dialog. This must be done prior to making\n-     * the dialog visible. The style is one of: StageStyle.DECORATED,\n-     * StageStyle.UNDECORATED, StageStyle.TRANSPARENT, StageStyle.UTILITY,\n-     * or StageStyle.UNIFIED.\n+     * Specifies the style for this dialog. This must be done prior to making the dialog visible.\n+     * <p>\n+     * Note that a dialog with the {@link StageStyle#EXTENDED} style should also specify a {@link HeaderBar} with\n+     * the {@link DialogPane#setHeaderBar(HeaderBar)} method, as otherwise the dialog window will not be draggable.\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/Dialog.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,0 +34,2 @@\n+import com.sun.javafx.PreviewFeature;\n+import com.sun.javafx.css.StyleManager;\n@@ -54,0 +56,1 @@\n+import javafx.css.converter.StringConverter;\n@@ -55,0 +58,1 @@\n+import javafx.geometry.HPos;\n@@ -56,0 +60,1 @@\n+import javafx.geometry.VPos;\n@@ -63,0 +68,1 @@\n+import javafx.scene.layout.HeaderBar;\n@@ -67,3 +73,1 @@\n-\n-import com.sun.javafx.css.StyleManager;\n-import javafx.css.converter.StringConverter;\n+import javafx.stage.StageStyle;\n@@ -216,0 +220,2 @@\n+        headerTextPanel.setVisible(false);\n+        headerTextPanel.setManaged(false);\n@@ -221,0 +227,2 @@\n+        contentLabel.setVisible(false);\n+        contentLabel.setManaged(false);\n@@ -433,0 +441,68 @@\n+    \/\/ --- header bar\n+    private ObjectProperty<HeaderBar> headerBar;\n+\n+    \/**\n+     * Specifies the {@link HeaderBar} for the dialog. The {@code HeaderBar} will be placed at the\n+     * top of the dialog window, and extend the entire width of the window. This property will only\n+     * be used if the dialog window is configured with the {@link StageStyle#EXTENDED} style; it has\n+     * no effect for other styles.\n+     *\n+     * @return the {@code headerBar} property\n+     * @defaultValue {@code null}\n+     * @since 26\n+     * @deprecated This is a preview feature which may be changed or removed in a future release.\n+     *\/\n+    @Deprecated(since = \"26\")\n+    public final ObjectProperty<HeaderBar> headerBarProperty() {\n+        if (headerBar == null) {\n+            PreviewFeature.HEADER_BAR.checkEnabled();\n+            headerBar = new SimpleObjectProperty<>(this, \"headerBar\") {\n+                WeakReference<HeaderBar> wref = new WeakReference<>(null);\n+\n+                @Override\n+                protected void invalidated() {\n+                    HeaderBar oldValue = wref.get();\n+                    if (oldValue != null) {\n+                        getChildren().remove(oldValue);\n+                    }\n+\n+                    HeaderBar newValue = get();\n+                    if (newValue != null) {\n+                        getChildren().add(newValue);\n+                    }\n+\n+                    wref = new WeakReference<>(newValue);\n+                }\n+            };\n+        }\n+\n+        return headerBar;\n+    }\n+\n+    \/**\n+     * Gets the value of the {@link #headerBarProperty() headerBar} property.\n+     *\n+     * @return the {@code HeaderBar}\n+     * @since 26\n+     * @deprecated This is a preview feature which may be changed or removed in a future release.\n+     *\/\n+    @Deprecated(since = \"26\")\n+    public final HeaderBar getHeaderBar() {\n+        PreviewFeature.HEADER_BAR.checkEnabled();\n+        return headerBar != null ? headerBar.get() : null;\n+    }\n+\n+    \/**\n+     * Sets the value of the {@link #headerBarProperty() headerBar} property.\n+     *\n+     * @param value the new value\n+     * @since 26\n+     * @deprecated This is a preview feature which may be changed or removed in a future release.\n+     *\/\n+    @Deprecated(since = \"26\")\n+    public final void setHeaderBar(HeaderBar value) {\n+        PreviewFeature.HEADER_BAR.checkEnabled();\n+        if (headerBar != null || value != null) {\n+            headerBarProperty().set(value);\n+        }\n+    }\n@@ -881,0 +957,1 @@\n+        final HeaderBar headerBar = getHeaderBar();\n@@ -886,0 +963,3 @@\n+        final double headerBarPrefHeight = headerBar != null\n+            ? Utils.boundedSize(headerBar.prefHeight(w), headerBar.minHeight(w), headerBar.maxHeight(w))\n+            : 0;\n@@ -897,1 +977,1 @@\n-            expandableContentPrefHeight = h - (headerPrefHeight + contentAndGraphicHeight + buttonBarPrefHeight);\n+            expandableContentPrefHeight = h - (headerBarPrefHeight + headerPrefHeight + contentAndGraphicHeight + buttonBarPrefHeight);\n@@ -901,1 +981,1 @@\n-            contentAreaHeight = h - (headerPrefHeight + expandableContentPrefHeight + buttonBarPrefHeight);\n+            contentAreaHeight = h - (headerBarPrefHeight + headerPrefHeight + expandableContentPrefHeight + buttonBarPrefHeight);\n@@ -905,0 +985,4 @@\n+        if (headerBar != null) {\n+            layoutInArea(headerBar, 0, 0, w, headerBarPrefHeight, 0, HPos.LEFT, VPos.TOP);\n+        }\n+\n@@ -906,1 +990,1 @@\n-        double y = topPadding;\n+        double y = topPadding + headerBarPrefHeight;\n@@ -936,0 +1020,1 @@\n+        double headerBarMinWidth = getHeaderBar() instanceof HeaderBar hb ? hb.minWidth(height) : 0;\n@@ -952,1 +1037,1 @@\n-        return snapSizeX(minWidth);\n+        return snapSizeX(Math.max(minWidth, headerBarMinWidth));\n@@ -959,0 +1044,1 @@\n+        double headerBarMinHeight = getHeaderBar() instanceof HeaderBar hb ? hb.minHeight(width) : 0;\n@@ -979,0 +1065,1 @@\n+                headerBarMinHeight +\n@@ -994,0 +1081,2 @@\n+        double headerBarPrefWidth = getHeaderBar() instanceof HeaderBar hb\n+            ? Utils.boundedSize(hb.prefWidth(height), hb.minWidth(height), hb.maxWidth(height)) : 0;\n@@ -1006,1 +1095,1 @@\n-        return snapSizeX(prefWidth);\n+        return snapSizeX(Math.max(prefWidth, headerBarPrefWidth));\n@@ -1015,0 +1104,2 @@\n+        double headerBarPrefHeight = getHeaderBar() instanceof HeaderBar hb\n+            ? Utils.boundedSize(hb.prefHeight(width), hb.minHeight(width), hb.maxHeight(width)) : 0;\n@@ -1032,0 +1123,1 @@\n+               headerBarPrefHeight +\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/DialogPane.java","additions":101,"deletions":9,"binary":false,"changes":110,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,2 @@\n-import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.*;\n+\n@@ -31,0 +32,1 @@\n+import javafx.geometry.BoundingBox;\n@@ -40,0 +42,1 @@\n+import javafx.scene.layout.HeaderBar;\n@@ -154,0 +157,23 @@\n+\n+    @Test\n+    public void headerBarIsLocatedAtTopOfDialogPane() {\n+        var headerBar = new HeaderBar();\n+        headerBar.setMinHeight(20);\n+        headerBar.setPrefHeight(20);\n+        dialogPane.setHeaderBar(headerBar);\n+        dialogPane.resize(1000, 1000);\n+        dialogPane.applyCss();\n+        dialogPane.layout();\n+\n+        assertEquals(\n+            new BoundingBox(0, 0, 1000, 20),\n+            dialogPane.lookup(\"HeaderBar\").getLayoutBounds());\n+\n+        dialogPane.getChildren().stream()\n+            .filter(Node::isVisible)\n+            .filter(c -> c != headerBar)\n+            .forEach(child ->\n+                assertTrue(child.getLayoutY() >= headerBar.getHeight(), () ->\n+                    child.getClass().getSimpleName() + \" must be located below HeaderBar, layoutY = \" + child.getLayoutBounds())\n+            );\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/DialogPaneTest.java","additions":28,"deletions":2,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -105,0 +105,11 @@\n+    @Test\n+    public void testInitialDialogPaneIsAttachedToScene() {\n+        class TestDialog extends Dialog<ButtonType> {\n+            TestDialog() {\n+                assertNotNull(getDialogPane().getScene());\n+            }\n+        }\n+\n+        assertDoesNotThrow(TestDialog::new);\n+    }\n+\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/DialogTest.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"}]}