{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -169,1 +169,5 @@\n-                commitValue();\n+                try {\n+                    commitValue();\n+                } catch (Exception e) {\n+                    cancelEdit();\n+                }\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/Spinner.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+import javafx.scene.layout.HBox;\n@@ -62,0 +63,1 @@\n+import test.com.sun.javafx.scene.control.infrastructure.StageLoader;\n@@ -1584,0 +1586,33 @@\n+\n+    \/**\n+     * When Spinner looses focus with misformatted text in the editor,\n+     * checks that the value is not changed, and the text is reverted to the value\n+     *\/\n+    @Test\n+    public void testFocusLostWithTypo() {\n+        Button button = new Button();\n+        Spinner<Integer> spinner = new Spinner<>(new IntegerSpinnerValueFactory(0, 10, 0));\n+        spinner.setEditable(true);\n+\n+        StageLoader stageLoader = new StageLoader(new HBox(spinner, button));\n+\n+        \/\/ initial value\n+        spinner.getValueFactory().setValue(1);\n+        int value = spinner.getValue();\n+        assertEquals(1, value);\n+        assertEquals(\"1\", spinner.getEditor().getText());\n+\n+        \/\/ set misformatted text\n+        spinner.requestFocus();\n+        spinner.getEditor().setText(\"2abc\");\n+\n+        \/\/ loosing focus triggers cancelEdit() because the text cannot be parsed\n+        button.requestFocus();\n+\n+        \/\/ check that value remains unchanged, and text is reverted\n+        value = spinner.getValue();\n+        assertEquals(1, value);\n+        assertEquals(\"1\", spinner.getEditor().getText());\n+\n+        stageLoader.dispose();\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/SpinnerTest.java","additions":36,"deletions":1,"binary":false,"changes":37,"status":"modified"}]}