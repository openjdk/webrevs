{"files":[{"patch":"@@ -105,0 +105,13 @@\n+    private int getValidStringIndex(int start, int requestedSteps, int maxEnd) {\n+        int fixedMaxEnd = Math.max(0, maxEnd);\n+        int fixedStart = Math.max(0, Math.min(start, fixedMaxEnd));\n+        if (requestedSteps < 0) {\n+            return fixedMaxEnd;\n+        }\n+        try {\n+            return Math.min(fixedMaxEnd, Math.addExact(fixedStart, requestedSteps));\n+        } catch (ArithmeticException e) {\n+            return fixedMaxEnd;\n+        }\n+    }\n+\n@@ -365,1 +378,1 @@\n-        int endOffset = maxLength != -1 ? Math.min(end, start + maxLength) : end;\n+        int endOffset = getValidStringIndex(start, maxLength, end);\n@@ -381,1 +394,1 @@\n-                start = Math.max(0, Math.min(start + requestedCount, length - 1));\n+                start = getValidStringIndex(start, requestedCount, length - 1);\n@@ -485,1 +498,1 @@\n-                offset = Math.max(0, Math.min(offset + requestedCount, length));\n+                offset = getValidStringIndex(offset, requestedCount, length);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/win\/WinTextRangeProvider.java","additions":16,"deletions":3,"binary":false,"changes":19,"status":"modified"}]}