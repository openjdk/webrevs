{"files":[{"patch":"@@ -101,1 +101,1 @@\n-        start = Math.max(0, Math.min(start, length));\n+        start = getValidStringIndex(start, 0, length);\n@@ -105,0 +105,14 @@\n+    private int getValidStringIndex(int start, int requestedSteps, int maxEnd) {\n+        int fixedMaxEnd = Math.max(0, maxEnd);\n+        if (requestedSteps < 0) {\n+            return fixedMaxEnd;\n+        }\n+        int theEnd;\n+        try {\n+            theEnd = Math.addExact(Math.max(0, start), requestedSteps);\n+        } catch (ArithmeticException e) {\n+            return fixedMaxEnd;\n+        }\n+        return Math.min(theEnd, fixedMaxEnd);\n+    }\n+\n@@ -365,1 +379,1 @@\n-        int endOffset = maxLength != -1 ? Math.min(end, start + maxLength) : end;\n+        int endOffset = getValidStringIndex(start, maxLength, end);\n@@ -381,1 +395,1 @@\n-                start = Math.max(0, Math.min(start + requestedCount, length - 1));\n+                start = getValidStringIndex(start, requestedCount, length - 1);\n@@ -485,1 +499,1 @@\n-                offset = Math.max(0, Math.min(offset + requestedCount, length));\n+                offset = getValidStringIndex(offset, requestedCount, length);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/win\/WinTextRangeProvider.java","additions":18,"deletions":4,"binary":false,"changes":22,"status":"modified"}]}