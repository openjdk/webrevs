{"files":[{"patch":"@@ -101,1 +101,1 @@\n-        start = Math.max(0, Math.min(start, length));\n+        start = getValidStringIndex(start, 0, length);\n@@ -105,0 +105,12 @@\n+    private int getValidStringIndex(int start, int requestedSteps, int maxEnd) {\n+        int fixedMaxEnd = Math.max(0, maxEnd);\n+        if (requestedSteps < 0) {\n+            return fixedMaxEnd;\n+        }\n+        try {\n+            return Math.min(fixedMaxEnd, Math.addExact(Math.max(0, start), requestedSteps));\n+        } catch (ArithmeticException e) {\n+            return fixedMaxEnd;\n+        }\n+    }\n+\n@@ -365,1 +377,1 @@\n-        int endOffset = maxLength != -1 ? Math.min(end, start + maxLength) : end;\n+        int endOffset = getValidStringIndex(start, maxLength, end);\n@@ -381,1 +393,1 @@\n-                start = Math.max(0, Math.min(start + requestedCount, length - 1));\n+                start = getValidStringIndex(start, requestedCount, length - 1);\n@@ -485,1 +497,1 @@\n-                offset = Math.max(0, Math.min(offset + requestedCount, length));\n+                offset = getValidStringIndex(offset, requestedCount, length);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/win\/WinTextRangeProvider.java","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"}]}