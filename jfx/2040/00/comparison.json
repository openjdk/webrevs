{"files":[{"patch":"@@ -60,0 +60,5 @@\n+        labeledImpl.textTruncatedProperty().subscribe(v -> {\n+            LabeledHelper.setTextTruncated(labeled, v);\n+        });\n+\n+\n@@ -101,0 +106,2 @@\n+            \/\/System.out.println(\"Shuttler invalidated\");\n+\n@@ -102,0 +109,1 @@\n+                \/\/System.out.println(\"Text Model\");\n@@ -103,0 +111,2 @@\n+                \/\/System.out.println(\" is truncated: \" + labeled.isTextTruncated());\n+                \/\/LabeledHelper.setTextTruncated(labeledImpl, labeled.isTextTruncated());\n","filename":"modules\/javafx.controls\/src\/main\/java\/com\/sun\/javafx\/scene\/control\/LabeledImpl.java","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,0 +29,2 @@\n+\n+import javafx.scene.Scene;\n@@ -34,0 +36,2 @@\n+import javafx.scene.control.MenuButton;\n+import javafx.scene.control.SplitMenuButton;\n@@ -40,0 +44,2 @@\n+import javafx.scene.control.skin.MenuButtonSkin;\n+import javafx.scene.control.skin.SplitMenuButtonSkin;\n@@ -41,0 +47,3 @@\n+import java.util.function.Supplier;\n+\n+import javafx.stage.Stage;\n@@ -58,4 +67,9 @@\n-        Label control = new Label();\n-        control.setSkin(new LabelSkin(control));\n-        control.setText(TEXT);\n-        test(control);\n+        Supplier<Label> fun = () -> {\n+            Label control = new Label();\n+            control.setSkin(new LabelSkin(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+\n+        testWithSkin(fun.get());\n+        testTextProperty(fun.get());\n@@ -66,4 +80,31 @@\n-        Button control = new Button();\n-        control.setSkin(new ButtonSkin(control));\n-        control.setText(TEXT);\n-        test(control);\n+        Supplier<Labeled> fun = () -> {\n+            Button control = new Button();\n+            control.setSkin(new ButtonSkin(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+        testWithSkin(fun.get());\n+        testTextProperty(fun.get());\n+    }\n+\n+    @Test\n+    public void testTruncatedMenuButton() {\n+        Supplier<Labeled> fun = () -> {\n+            MenuButton control = new MenuButton();\n+            control.setSkin(new MenuButtonSkin(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+        testTextProperty(fun.get());\n+    }\n+\n+\n+    @Test\n+    public void testTruncatedSplitMenuButton() {\n+        Supplier<Labeled> fun = () -> {\n+            SplitMenuButton control = new SplitMenuButton();\n+            control.setSkin(new SplitMenuButtonSkin(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+        testTextProperty(fun.get());\n@@ -74,4 +115,9 @@\n-        TableCell<String, String> control = new TableCell<>();\n-        control.setSkin(new TableCellSkin<>(control));\n-        control.setText(TEXT);\n-        test(control);\n+        Supplier<Labeled> fun = () -> {\n+            TableCell<String, String> control = new TableCell<>();\n+            control.setSkin(new TableCellSkin<>(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+        testWithSkin(fun.get());\n+        testTextProperty(fun.get());\n+\n@@ -82,4 +128,7 @@\n-        TreeTableCell<String, String> control = new TreeTableCell<>();\n-        control.setSkin(new TreeTableCellSkin<>(control));\n-        control.setText(TEXT);\n-        test(control);\n+        Supplier<Labeled> fun = () -> {\n+            TreeTableCell<String, String> control = new TreeTableCell<>();\n+            control.setSkin(new TreeTableCellSkin<>(control));\n+            control.setText(TEXT);\n+            return control;\n+        };\n+        testWithSkin(fun.get());\n@@ -88,1 +137,1 @@\n-    private void test(Labeled control) {\n+    private void testWithSkin(Labeled control) {\n@@ -117,0 +166,24 @@\n+\n+    private void testTextProperty(Labeled control) {\n+        Scene scene = new Scene(control, 100, 100);\n+        Stage s = new Stage();\n+        s.setScene(scene);\n+        s.show();\n+        control.setText(\"A\");\n+        firePulse();\n+        double h = control.prefHeight(-1);\n+\n+        assertFalse(control.isTextTruncated());\n+\n+\n+        control.setText(\"very long text with a lots of characters\");\n+        control.layout();\n+        firePulse();\n+\n+        assertTrue(control.isTextTruncated());\n+\n+        control.setText(\"A\");\n+        control.layout();\n+        firePulse();\n+        assertFalse(control.isTextTruncated());\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/LabeledTruncatedTest.java","additions":90,"deletions":17,"binary":false,"changes":107,"status":"modified"}]}