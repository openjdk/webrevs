{"files":[{"patch":"@@ -621,6 +621,1 @@\n-                            comboBox.setValue(null);\n-                            setSelectedItem(null);\n-\n-                            \/\/Restore the previous selection\n-                            comboBox.setValue(selectedItem);\n-                            setSelectedIndex(i);\n+                            clearAndSelect(i);\n@@ -631,1 +626,0 @@\n-\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/ComboBox.java","additions":1,"deletions":7,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2324,1 +2324,1 @@\n-    public void testSelectionOnItemChange() {\n+    public void testSelectionOnItemChangeUsingSetAllThroughPropertyBinding() {\n@@ -2351,0 +2351,33 @@\n+\n+    \/\/JDK-8279139\n+    @Test\n+    public void testSelectionOnItemChangeUsingSetAllOnButtonPress() {\n+        ObservableList<String> comboBoxItemsList = FXCollections.observableArrayList();\n+\n+        List<String> strings1 = List.of(\"A\", \"B\", \"C\");\n+        List<String> strings2 = List.of(\"D\", \"B\", \"F\");\n+\n+        comboBox = new ComboBox<>();\n+        comboBox.setItems(comboBoxItemsList);\n+        comboBox.setValue(\"B\");\n+\n+        comboBoxItemsList.setAll(strings2);\n+        assertEquals(\"B\", comboBox.getSelectionModel().getSelectedItem());\n+        comboBoxItemsList.setAll(strings1);\n+        assertEquals(\"B\", comboBox.getSelectionModel().getSelectedItem());\n+\n+        Button button = new Button(\"Change content\");\n+        button.setOnAction(e -> {\n+            if (comboBoxItemsList.equals(strings1)) {\n+                comboBoxItemsList.setAll(strings2);\n+            } else {\n+                comboBoxItemsList.setAll(strings1);\n+            }\n+        });\n+\n+        MouseEventFirer mouse = new MouseEventFirer(button);\n+        mouse.fireMousePressAndRelease();\n+        assertEquals(\"B\", comboBox.getSelectionModel().getSelectedItem());\n+        mouse.fireMousePressAndRelease();\n+        assertEquals(\"B\", comboBox.getSelectionModel().getSelectedItem());\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/ComboBoxTest.java","additions":34,"deletions":1,"binary":false,"changes":35,"status":"modified"}]}