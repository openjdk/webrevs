{"files":[{"patch":"@@ -39,5 +39,0 @@\n-import com.sun.scenario.effect.Blend.Mode;\n-import com.sun.scenario.effect.FilterContext;\n-import com.sun.scenario.effect.ImageData;\n-import com.sun.scenario.effect.impl.prism.PrDrawable;\n-import com.sun.scenario.effect.impl.prism.PrEffectHelper;\n@@ -46,2 +41,0 @@\n-\/**\n- *\/\n@@ -49,4 +42,1 @@\n-    \/**\n-     * The blend mode to use with this group.\n-     *\/\n-    private Blend.Mode blendMode = Blend.Mode.SRC_OVER;\n+\n@@ -58,2 +48,2 @@\n-    private List<NGNode> children = new ArrayList<>(1);\n-    private List<NGNode> unmod = Collections.unmodifiableList(children);\n+    private final List<NGNode> children = new ArrayList<>(1);\n+    private final List<NGNode> unmod = Collections.unmodifiableList(children);\n@@ -77,6 +67,0 @@\n-    \/***************************************************************************\n-     *                                                                         *\n-     * Implementation of the PGGroup interface                                 *\n-     *                                                                         *\n-     **************************************************************************\/\n-\n@@ -208,17 +192,0 @@\n-    \/**\n-     * Set by the FX scene graph.\n-     * @param blendMode cannot be null\n-     *\/\n-    public void setBlendMode(Object blendMode) {\n-        \/\/ Verify the arguments\n-        if (blendMode == null) {\n-            throw new IllegalArgumentException(\"Mode must be non-null\");\n-        }\n-        \/\/ If the blend mode has changed, mark this node as dirty and\n-        \/\/ invalidate its cache\n-        if (this.blendMode != blendMode) {\n-            this.blendMode = (Blend.Mode)blendMode;\n-            visualsChanged();\n-        }\n-    }\n-\n@@ -228,3 +195,0 @@\n-        if (orderedChildren == null) {\n-            return;\n-        }\n@@ -239,3 +203,0 @@\n-        if (orderedChildren == null) {\n-            return;\n-        }\n@@ -254,57 +215,4 @@\n-        if (blendMode == Blend.Mode.SRC_OVER ||\n-                orderedChildren.size() < 2) {  \/\/ Blend modes only work \"between\" siblings\n-\n-            \/\/ Guard against case where renderRoot is not part of orderedChildren\n-            for (int i = (startPos == -1 ? 0 : startPos); i < orderedChildren.size(); i++) {\n-                NGNode child;\n-                try {\n-                    child = orderedChildren.get(i);\n-                } catch (Exception e) {\n-                    child = null;\n-                }\n-                \/\/ minimal protection against concurrent update of the list.\n-                if (child != null) {\n-                    child.render(g);\n-                }\n-            }\n-            return;\n-        }\n-\n-        Blend b = new Blend(blendMode, null, null);\n-        FilterContext fctx = getFilterContext(g);\n-\n-        ImageData bot = null;\n-        boolean idValid = true;\n-        do {\n-            \/\/ TODO: probably don't need to wrap the transform here... (JDK-8092196)\n-            BaseTransform transform = g.getTransformNoClone().copy();\n-            if (bot != null) {\n-                bot.unref();\n-                bot = null;\n-            }\n-            Rectangle rclip = PrEffectHelper.getGraphicsClipNoClone(g);\n-            for (int i = startPos; i < orderedChildren.size(); i++) {\n-                NGNode child = orderedChildren.get(i);\n-                ImageData top = NodeEffectInput.\n-                    getImageDataForNode(fctx, child, false, transform, rclip);\n-                if (bot == null) {\n-                    bot = top;\n-                } else {\n-                    ImageData newbot =\n-                        b.filterImageDatas(fctx, transform, rclip, null, bot, top);\n-                    bot.unref();\n-                    top.unref();\n-                    bot = newbot;\n-                }\n-            }\n-            if (bot != null && (idValid = bot.validate(fctx))) {\n-                Rectangle r = bot.getUntransformedBounds();\n-                PrDrawable botimg = (PrDrawable)bot.getUntransformedImage();\n-                g.setTransform(bot.getTransform());\n-                g.drawTexture(botimg.getTextureObject(),\n-                        r.x, r.y, r.width, r.height);\n-            }\n-        } while (bot == null || !idValid);\n-\n-        if (bot != null) {\n-            bot.unref();\n+        \/\/ Guard against case where renderRoot is not part of orderedChildren\n+        for (int i = (startPos == -1 ? 0 : startPos); i < orderedChildren.size(); i++) {\n+            NGNode child = orderedChildren.get(i);\n+            child.render(g);\n@@ -316,4 +224,0 @@\n-        if (blendMode != Mode.SRC_OVER) {\n-            \/\/ All other modes are flattened so there are no overlapping issues\n-            return false;\n-        }\n@@ -321,1 +225,1 @@\n-        int n = (orderedChildren == null ? 0 : orderedChildren.size());\n+        int n = orderedChildren.size();\n@@ -325,1 +229,1 @@\n-        return (n != 0);\n+        return (n > 0);\n@@ -329,1 +233,1 @@\n-        return children == null || children.isEmpty();\n+        return children.isEmpty();\n@@ -408,1 +312,1 @@\n-        \/\/ True if every child _after_ the the found render root is clean\n+        \/\/ True if every child _after_ the found render root is clean\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/sg\/prism\/NGGroup.java","additions":11,"deletions":107,"binary":false,"changes":118,"status":"modified"}]}