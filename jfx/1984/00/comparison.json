{"files":[{"patch":"@@ -2703,2 +2703,2 @@\n-        task compileMSLPassThroughVS(group: \"Build\") {\n-            def PASSTHROUGH_VS_SRC = file(\"src\/main\/native-prism-mtl\/msl\/PassThroughVS.metal\")\n+        task compileMetalShaders(group: \"Build\") {\n+            description = \"Compiles all .metal files in src\/main\/native-prism-mtl\/msl\"\n@@ -2707,71 +2707,11 @@\n-                execOps.exec { spec ->\n-                    commandLine(\"${metalCompiler}\")\n-                    args += [ \"-std=${mslVersion}\" ]\n-                    args += [ \"-c\" ]\n-                    args += [ \"$PASSTHROUGH_VS_SRC\" ]\n-                    args += [ \"-o\" ]\n-                    args += [ \"$buildDir\/msl\/PassThroughVS.air\" ]\n-                }\n-            }\n-        }\n-        nativePrism.dependsOn compileMSLPassThroughVS;\n-\n-        task compileMSLClearRttShaders(group: \"Build\") {\n-            def CLEAR_RTT_VFS_SRC = file(\"src\/main\/native-prism-mtl\/msl\/ClearRttShaders.metal\")\n-            doLast {\n-                mkdir \"$buildDir\/msl\"\n-                execOps.exec { spec ->\n-                    commandLine(\"${metalCompiler}\")\n-                    args += [ \"-std=${mslVersion}\" ]\n-                    args += [ \"-c\" ]\n-                    args += [ \"$CLEAR_RTT_VFS_SRC\" ]\n-                    args += [ \"-o\" ]\n-                    args += [ \"$buildDir\/msl\/ClearRttShaders.air\" ]\n-                }\n-            }\n-        }\n-        nativePrism.dependsOn compileMSLClearRttShaders;\n-\n-        task compileMSLComputeKernels(group: \"Build\") {\n-            def COMPUTE_KERNELS_SRC = file(\"src\/main\/native-prism-mtl\/msl\/ComputeKernels.metal\")\n-            doLast {\n-                mkdir \"$buildDir\/msl\"\n-                execOps.exec { spec ->\n-                    commandLine(\"${metalCompiler}\")\n-                    args += [ \"-std=${mslVersion}\" ]\n-                    args += [ \"-c\" ]\n-                    args += [ \"$COMPUTE_KERNELS_SRC\" ]\n-                    args += [ \"-o\" ]\n-                    args += [ \"$buildDir\/msl\/ComputeKernels.air\" ]\n-                }\n-            }\n-        }\n-        nativePrism.dependsOn compileMSLComputeKernels;\n-\n-        task compileMSLPhongVS(group: \"Build\") {\n-            def PHONG_VS_SRC = file(\"src\/main\/native-prism-mtl\/msl\/PhongVS.metal\")\n-            doLast {\n-                mkdir \"$buildDir\/msl\"\n-                execOps.exec { spec ->\n-                    commandLine(\"${metalCompiler}\")\n-                    args += [ \"-std=${mslVersion}\" ]\n-                    args += [ \"-c\" ]\n-                    args += [ \"$PHONG_VS_SRC\" ]\n-                    args += [ \"-o\" ]\n-                    args += [ \"$buildDir\/msl\/PhongVS.air\" ]\n-                }\n-            }\n-        }\n-        nativePrism.dependsOn compileMSLPhongVS;\n-\n-        task compileMSLPhongPS(group: \"Build\") {\n-            def PHONG_PS_SRC = file(\"src\/main\/native-prism-mtl\/msl\/PhongPS.metal\")\n-            doLast {\n-                mkdir \"$buildDir\/msl\"\n-                execOps.exec { spec ->\n-                    commandLine(\"${metalCompiler}\")\n-                    args += [ \"-std=${mslVersion}\" ]\n-                    args += [ \"-c\" ]\n-                    args += [ \"$PHONG_PS_SRC\" ]\n-                    args += [ \"-o\" ]\n-                    args += [ \"$buildDir\/msl\/PhongPS.air\" ]\n+                def shaderFiles = fileTree(dir: \"src\/main\/native-prism-mtl\/msl\", include: \"**\/*.metal\")\n+                shaderFiles.files.each { file ->\n+                    def outputFile = new File(\"$buildDir\/msl\", file.name.replace(\".metal\", \".air\"))\n+                    execOps.exec { spec ->\n+                        commandLine(\"${metalCompiler}\")\n+                        args += [ \"-std=${mslVersion}\" ]\n+                        args += [ \"-c\" ]\n+                        args += [ \"$file.absolutePath\" ]\n+                        args += [ \"-o\" ]\n+                        args += [ \"$outputFile.absolutePath\" ]\n+                    }\n@@ -2781,1 +2721,1 @@\n-        nativePrism.dependsOn compileMSLPhongPS;\n+        nativePrism.dependsOn compileMetalShaders;\n@@ -2786,5 +2726,1 @@\n-                      compileMSLPassThroughVS,\n-                      compileMSLClearRttShaders,\n-                      compileMSLComputeKernels,\n-                      compileMSLPhongVS,\n-                      compileMSLPhongPS)\n+                      compileMetalShaders)\n","filename":"build.gradle","additions":15,"deletions":79,"binary":false,"changes":94,"status":"modified"}]}