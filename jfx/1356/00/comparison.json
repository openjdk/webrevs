{"files":[{"patch":"@@ -81,0 +81,1 @@\n+    @Override native protected void _finishInputMethodComposition(long ptr);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/mac\/MacView.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -50,0 +50,1 @@\n+- (void)finishInputMethodComposition;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassView.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -715,0 +715,21 @@\n+\n+\/*\n+ * Class:     com_sun_glass_ui_mac_MacView\n+ * Method:    _finishInputMethodComposition\n+ * Signature: (J)V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_sun_glass_ui_mac_MacView__1finishInputMethodComposition\n+(JNIEnv *env, jobject jView, jlong ptr)\n+{\n+    LOG(\"Java_com_sun_glass_ui_mac_MacView__1finishInputMethodComposition\");\n+    if (!ptr) return;\n+\n+    GLASS_ASSERT_MAIN_JAVA_THREAD(env);\n+    GLASS_POOL_ENTER;\n+    {\n+        NSView<GlassView> *view = getGlassView(env, ptr);\n+        [view finishInputMethodComposition];\n+    }\n+    GLASS_POOL_EXIT;\n+    GLASS_CHECK_EXCEPTION(env);\n+}\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassView.m","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -720,0 +720,7 @@\n+- (void)finishInputMethodComposition\n+{\n+    IMLOG(\"finishInputMethodComposition called\");\n+    [self unmarkText];\n+    [self.inputContext discardMarkedText];\n+}\n+\n@@ -724,0 +731,6 @@\n+\/\/ Utility function, not part of protocol\n+- (void)commitString:(NSString*)aString\n+{\n+    [self->_delegate notifyInputMethod:aString attr:4 length:(int)[aString length] cursor:(int)[aString length] selectedRange: NSMakeRange(NSNotFound, 0)];\n+}\n+\n@@ -736,1 +749,1 @@\n-        [self->_delegate notifyInputMethod:aString attr:4 length:(int)[aString length] cursor:(int)[aString length] selectedRange: NSMakeRange(NSNotFound, 0)];\n+        [self commitString: aString];\n@@ -763,3 +776,3 @@\n-    if (self->nsAttrBuffer != nil && self->nsAttrBuffer.length != 0) {\n-        self->nsAttrBuffer = [self->nsAttrBuffer initWithString:@\"\"];\n-        [self->_delegate notifyInputMethod:@\"\" attr:4 length:0 cursor:0 selectedRange: NSMakeRange(NSNotFound, 0)];\n+    if (nsAttrBuffer.length != 0) {\n+        [self commitString: nsAttrBuffer.string];\n+        nsAttrBuffer = [nsAttrBuffer initWithString:@\"\"];\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassView3D.m","additions":17,"deletions":4,"binary":false,"changes":21,"status":"modified"}]}