{"files":[{"patch":"@@ -290,2 +290,1 @@\n-            ViewPainter painter = ((ViewScene)oldScene).getPainter();\n-            QuantumRenderer.getInstance().disposePresentable(painter.presentable);   \/\/ latched on RT\n+            disposeScenePainter((ViewScene) oldScene);\n@@ -295,0 +294,5 @@\n+    private static void disposeScenePainter(ViewScene oldScene) {\n+        ViewPainter painter = oldScene.getPainter();\n+        QuantumRenderer.getInstance().disposePresentable(painter.presentable);   \/\/ latched on RT\n+    }\n+\n@@ -795,1 +799,1 @@\n-            GlassScene oldScene = getViewScene();\n+            ViewScene oldScene = getViewScene();\n@@ -798,0 +802,1 @@\n+                disposeScenePainter(oldScene);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/WindowStage.java","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -193,1 +193,5 @@\n-        if (drawable.getNativeWindow() != pState.getNativeWindow()) {\n+        if (drawable == null || drawable.getNativeWindow() != pState.getNativeWindow()) {\n+            if (drawable != null) {\n+                drawable.dispose();\n+            }\n+\n@@ -307,0 +311,5 @@\n+\n+        if (drawable != null) {\n+            drawable.dispose();\n+            drawable = null;\n+        }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/ES2SwapChain.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -55,0 +55,2 @@\n+\n+    abstract void dispose();\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/GLDrawable.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+    private static native void nDestroyDrawable(long nativeCtxInfo);\n@@ -54,0 +55,4 @@\n+    @Override\n+    void dispose() {\n+        nDestroyDrawable(getNativeDrawableInfo());\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/IOSGLDrawable.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+    private static native void nDestroyDrawable(long nativeCtxInfo);\n@@ -52,0 +53,5 @@\n+\n+    @Override\n+    void dispose() {\n+        nDestroyDrawable(getNativeDrawableInfo());\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/MacGLDrawable.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -70,0 +70,5 @@\n+\n+    @Override\n+    void dispose() {\n+        \/\/empty\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/MonocleGLDrawable.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+    private static native void nDestroyDrawable(long nativeCtxInfo);\n@@ -53,0 +54,5 @@\n+\n+    @Override\n+    void dispose() {\n+        nDestroyDrawable(getNativeDrawableInfo());\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/WinGLDrawable.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+    private static native void nDestroyDrawable(long nativeCtxInfo);\n@@ -52,0 +53,5 @@\n+\n+    @Override\n+    void dispose() {\n+        nDestroyDrawable(getNativeDrawableInfo());\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/es2\/X11GLDrawable.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -43,24 +43,0 @@\n-\n-void deleteDrawableInfo(DrawableInfo *dInfo)\n-{\n-    if (dInfo == NULL) {\n-        return;\n-    }\n-#ifdef WIN32 \/* WIN32 *\/\n-    if ((dInfo->hdc != NULL) && (dInfo->hwnd != NULL)) {\n-        ReleaseDC(dInfo->hwnd, dInfo->hdc);\n-    }\n-#endif\n-#ifdef UNIX\n-    \/\/ This win is pass in from Glass so we most likely don't destroy it\n-    \/*\n-            if (dInfo->display == NULL) {\n-                if (dInfo->win != None) {\n-                    XDestroyWindow(dInfo->display, dInfo->win);\n-                }\n-            }\n-     *\/\n-#endif\n-    \/\/ Initialize structure to all zeros\n-    memset(dInfo, 0, sizeof (DrawableInfo));\n-}\n","filename":"modules\/javafx.graphics\/src\/main\/native-prism-es2\/GLDrawable.c","additions":0,"deletions":24,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -111,0 +111,16 @@\n+\n+\n+\/*\n+ * Class:     com_sun_prism_es2_IOSGLDrawable\n+ * Method:    nDestroyDrawable\n+ * Signature: (J)V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_sun_prism_es2_IOSGLDrawable_nDestroyDrawable\n+(JNIEnv *env, jclass class, jlong nativeDInfo) {\n+    DrawableInfo *dInfo = (DrawableInfo *) jlong_to_ptr(nativeDInfo);\n+    if (dInfo == NULL) {\n+        return;\n+    }\n+\n+    free(dInfo);\n+}\n\\ No newline at end of file\n","filename":"modules\/javafx.graphics\/src\/main\/native-prism-es2\/ios\/IOSGLDrawable.c","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -108,0 +108,15 @@\n+\n+\/*\n+ * Class:     com_sun_prism_es2_MacGLDrawable\n+ * Method:    nDestroyDrawable\n+ * Signature: (J)V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_sun_prism_es2_MacGLDrawable_nDestroyDrawable\n+(JNIEnv *env, jclass class, jlong nativeDInfo) {\n+    DrawableInfo *dInfo = (DrawableInfo *) jlong_to_ptr(nativeDInfo);\n+    if (dInfo == NULL) {\n+        return;\n+    }\n+\n+    free(dInfo);\n+}\n\\ No newline at end of file\n","filename":"modules\/javafx.graphics\/src\/main\/native-prism-es2\/macosx\/MacGLDrawable.c","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -129,0 +129,20 @@\n+\n+\n+\/*\n+ * Class:     com_sun_prism_es2_WinGLDrawable\n+ * Method:    nDestroyDrawable\n+ * Signature: (J)V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_sun_prism_es2_WinGLDrawable_nDestroyDrawable\n+(JNIEnv *env, jclass class, jlong nativeDInfo) {\n+    DrawableInfo *dInfo = (DrawableInfo *) jlong_to_ptr(nativeDInfo);\n+    if (dInfo == NULL) {\n+        return;\n+    }\n+\n+    if ((dInfo->hdc != NULL) && (dInfo->hwnd != NULL)) {\n+        ReleaseDC(dInfo->hwnd, dInfo->hdc);\n+    }\n+\n+    free(dInfo);\n+}\n\\ No newline at end of file\n","filename":"modules\/javafx.graphics\/src\/main\/native-prism-es2\/windows\/WinGLDrawable.c","additions":20,"deletions":0,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -37,1 +37,0 @@\n-extern void deleteDrawableInfo(DrawableInfo *dInfo);\n@@ -51,0 +50,1 @@\n+\n@@ -116,0 +116,15 @@\n+\n+\/*\n+ * Class:     com_sun_prism_es2_X11GLDrawable\n+ * Method:    nDestroyDrawable\n+ * Signature: (J)V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_sun_prism_es2_X11GLDrawable_nDestroyDrawable\n+(JNIEnv *env, jclass class, jlong nativeDInfo) {\n+    DrawableInfo *dInfo = (DrawableInfo *) jlong_to_ptr(nativeDInfo);\n+    if (dInfo == NULL) {\n+        return;\n+    }\n+\n+    free(dInfo);\n+}\n","filename":"modules\/javafx.graphics\/src\/main\/native-prism-es2\/x11\/X11GLDrawable.c","additions":16,"deletions":1,"binary":false,"changes":17,"status":"modified"}]}