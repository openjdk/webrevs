{"files":[{"patch":"@@ -251,1 +251,1 @@\n-        header.getTableHeaderRow().columnDragLock = true;\n+        header.getTableHeaderRow().columnDragLock = !popupTriggeredOnMousePressed;\n@@ -257,1 +257,1 @@\n-        if (me.isPrimaryButtonDown() && header.isColumnReorderingEnabled()) {\n+        if (me.isPrimaryButtonDown() && header.isColumnReorderingEnabled() && !popupTriggeredOnMousePressed) {\n@@ -263,1 +263,1 @@\n-        if (me.isConsumed()) return;\n+        if (me.isConsumed() || popupTriggeredOnMousePressed) return;\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/TableColumnHeader.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import com.sun.javafx.PlatformUtil;\n@@ -40,0 +41,1 @@\n+import javafx.scene.input.KeyCode;\n@@ -41,0 +43,1 @@\n+import javafx.scene.input.MouseEvent;\n@@ -54,0 +57,1 @@\n+import java.util.concurrent.atomic.AtomicInteger;\n@@ -85,0 +89,6 @@\n+        AtomicInteger counter = new AtomicInteger();\n+        header.addEventFilter(MouseEvent.ANY, e -> {\n+            if (e.isPopupTrigger()) {\n+                counter.incrementAndGet();\n+            }\n+        });\n@@ -92,0 +102,1 @@\n+        assertEquals(counter.get(), 1);\n@@ -95,0 +106,23 @@\n+\n+        \/\/ macOS only: Ctrl + Left click also triggers the context menu\n+        if (PlatformUtil.isMac()) {\n+            \n+            Util.runAndWait(() -> {\n+                robot.keyPress(KeyCode.ESCAPE);\n+                robot.keyRelease(KeyCode.ESCAPE);\n+            });\n+            Util.sleep(100);\n+\n+            Util.runAndWait(() -> {\n+                robot.keyPress(KeyCode.CONTROL);\n+                robot.mousePress(MouseButton.PRIMARY);\n+                robot.mouseRelease(MouseButton.PRIMARY);\n+                robot.keyRelease(KeyCode.CONTROL);\n+            });\n+            Util.sleep(1000);\n+\n+            assertEquals(counter.get(), 2);\n+            for (int i = 0; i < 4; i++) {\n+                assertEquals(unsortedList.get(i).getName(), table.getItems().get(i).getName());\n+            }\n+        }\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/tableview\/TableViewContextMenuSortTest.java","additions":34,"deletions":0,"binary":false,"changes":34,"status":"modified"}]}