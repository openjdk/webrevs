{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,1 +32,0 @@\n-import jfx.incubator.scene.control.richtext.model.StyledSegment;\n@@ -40,2 +39,0 @@\n-\n-        public List<StyledSegment> getSegments(RichParagraph p);\n@@ -60,4 +57,0 @@\n-\n-    public static List<StyledSegment> getSegments(RichParagraph p) {\n-        return accessor.getSegments(p);\n-    }\n","filename":"modules\/jfx.incubator.richtext\/src\/main\/java\/com\/sun\/jfx\/incubator\/scene\/control\/richtext\/RichParagraphHelper.java","additions":1,"deletions":8,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -812,2 +812,2 @@\n-            List<StyledSegment> segments = RichParagraphHelper.getSegments(par);\n-            if ((segments == null) || segments.isEmpty()) {\n+            int count = par.getSegmentCount();\n+            if (count == 0) {\n@@ -818,1 +818,2 @@\n-                for (StyledSegment seg : segments) {\n+                for (int i=0; i<count; i++) {\n+                    StyledSegment seg = par.getSegment(i);\n","filename":"modules\/jfx.incubator.richtext\/src\/main\/java\/com\/sun\/jfx\/incubator\/scene\/control\/richtext\/VFlow.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -39,1 +39,0 @@\n-import jfx.incubator.scene.control.richtext.StyleResolver;\n@@ -93,2 +92,7 @@\n-            List<StyledSegment> getSegments() {\n-                return null;\n+            public int getSegmentCount() {\n+                return 0;\n+            }\n+\n+            @Override\n+            public StyledSegment getSegment(int index) {\n+                throw new IndexOutOfBoundsException();\n@@ -115,2 +119,15 @@\n-    \/\/ this method could be made public, as long as the returned list is made immutable\n-    abstract List<StyledSegment> getSegments();\n+    \/**\n+     * Returns the number of segments in the paragraph.\n+     * @return the number of segments\n+     * @since 26\n+     *\/\n+    public abstract int getSegmentCount();\n+\n+    \/**\n+     * Returns the segment at the specified index.\n+     * @param index the segment index\n+     * @return the segment\n+     * @throws IndexOutOfBoundsException if the index is outside of the range {@code 0 ... getSegmentCount()-1} (inclusive)\n+     * @since 26\n+     *\/\n+    public abstract StyledSegment getSegment(int index);\n@@ -132,2 +149,2 @@\n-        List<StyledSegment> segments = getSegments();\n-        if (segments == null) {\n+        int sz = getSegmentCount();\n+        if (sz == 0) {\n@@ -137,1 +154,0 @@\n-            int sz = segments.size();\n@@ -139,1 +155,1 @@\n-                StyledSegment seg = segments.get(i);\n+                StyledSegment seg = getSegment(i);\n@@ -160,5 +176,0 @@\n-            @Override\n-            public List<StyledSegment> getSegments(RichParagraph p) {\n-                return p.getSegments();\n-            }\n-\n@@ -400,1 +411,1 @@\n-            List<StyledSegment> _segments = (segments == null ? null : List.copyOf(segments));\n+            List<StyledSegment> _segments = (segments == null ? List.of() : List.copyOf(segments));\n@@ -409,2 +420,7 @@\n-                List<StyledSegment> getSegments() {\n-                    return _segments;\n+                public int getSegmentCount() {\n+                    return _segments.size();\n+                }\n+\n+                @Override\n+                public StyledSegment getSegment(int index) {\n+                    return _segments.get(index);\n@@ -415,1 +431,1 @@\n-                    if (_segments == null) {\n+                    if (getSegmentCount() == 0) {\n","filename":"modules\/jfx.incubator.richtext\/src\/main\/java\/jfx\/incubator\/scene\/control\/richtext\/model\/RichParagraph.java","additions":34,"deletions":18,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -570,5 +570,0 @@\n-                @Override\n-                final List<StyledSegment> getSegments() {\n-                    return Paragraph.this.getSegments();\n-                }\n-\n@@ -584,0 +579,10 @@\n+\n+                @Override\n+                public int getSegmentCount() {\n+                    return Paragraph.this.getSegments().size();\n+                }\n+\n+                @Override\n+                public StyledSegment getSegment(int index) {\n+                    return Paragraph.this.getSegments().get(index);\n+                }\n","filename":"modules\/jfx.incubator.richtext\/src\/main\/java\/jfx\/incubator\/scene\/control\/richtext\/model\/SimpleViewOnlyStyledModel.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,4 +28,0 @@\n-import java.util.List;\n-import jfx.incubator.scene.control.richtext.model.RichParagraph;\n-import jfx.incubator.scene.control.richtext.model.StyledSegment;\n-\n@@ -33,3 +29,1 @@\n-    public static List<StyledSegment> getSegments(RichParagraph par) {\n-        return par.getSegments();\n-    }\n+    \/\/\n","filename":"modules\/jfx.incubator.richtext\/src\/shims\/java\/jfx\/incubator\/scene\/control\/richtext\/model\/RichTextModelShim.java","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -0,0 +1,96 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package test.jfx.incubator.scene.control.richtext.model;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import javafx.scene.paint.Color;\n+import org.junit.jupiter.api.Test;\n+import jfx.incubator.scene.control.richtext.model.RichParagraph;\n+import jfx.incubator.scene.control.richtext.model.StyleAttributeMap;\n+import jfx.incubator.scene.control.richtext.model.StyledSegment;\n+\n+\/**\n+ * Tests RichParagraph.\n+ *\/\n+public class RichParagraphTest {\n+    private static final StyleAttributeMap BOLD = StyleAttributeMap.builder().setBold(true).build();\n+    private static final StyleAttributeMap ITALIC = StyleAttributeMap.builder().setItalic(true).build();\n+    private static final StyleAttributeMap PAR = StyleAttributeMap.builder().setBackground(Color.GREEN).build();\n+\n+    @Test\n+    public void getPlainText() {\n+        RichParagraph p = p();\n+        assertEquals(\"plainbolditalic\", p.getPlainText());\n+    }\n+\n+    @Test\n+    public void getSegmentCount() {\n+        RichParagraph p = p();\n+        assertEquals(3, p.getSegmentCount());\n+    }\n+\n+    @Test\n+    public void getSegment() {\n+        RichParagraph p = p();\n+        StyledSegment s;\n+        \/\/ 0\n+        s = p.getSegment(0);\n+        assertEquals(\"plain\", s.getText());\n+        assertEquals(StyleAttributeMap.EMPTY, s.getStyleAttributeMap(null));\n+        \/\/ 1\n+        s = p.getSegment(1);\n+        assertEquals(\"bold\", s.getText());\n+        assertEquals(BOLD, s.getStyleAttributeMap(null));\n+        \/\/ 2\n+        s = p.getSegment(2);\n+        assertEquals(\"italic\", s.getText());\n+        assertEquals(ITALIC, s.getStyleAttributeMap(null));\n+        \/\/ 3\n+        assertThrows(IndexOutOfBoundsException.class, () -> {\n+            p.getSegment(3);\n+        });\n+        \/\/ -1\n+        assertThrows(IndexOutOfBoundsException.class, () -> {\n+            p.getSegment(-1);\n+        });\n+    }\n+\n+    @Test\n+    public void getParagraphAttributes() {\n+        RichParagraph p = p();\n+        assertEquals(PAR, p.getParagraphAttributes());\n+    }\n+\n+    private static RichParagraph p() {\n+        return RichParagraph.builder().\n+            addSegment(\"plain\", StyleAttributeMap.EMPTY).\n+            addSegment(\"bold\", BOLD).\n+            addSegment(\"italic\", ITALIC).\n+            setParagraphAttributes(PAR).\n+            build();\n+    }\n+}\n","filename":"modules\/jfx.incubator.richtext\/src\/test\/java\/test\/jfx\/incubator\/scene\/control\/richtext\/model\/RichParagraphTest.java","additions":96,"deletions":0,"binary":false,"changes":96,"status":"added"},{"patch":"@@ -40,1 +40,0 @@\n-import jfx.incubator.scene.control.richtext.model.RichTextModelShim;\n@@ -157,4 +156,1 @@\n-            List<StyledSegment> ss = RichTextModelShim.getSegments(par);\n-            if (ss == null) {\n-                ss = List.of();\n-            }\n+            List<StyledSegment> ss = getSegments(par);\n@@ -202,9 +198,5 @@\n-        List<StyledSegment> ss = RichTextModelShim.getSegments(p);\n-        if(ss == null) {\n-            sb.append(\"null\");\n-        } else {\n-            sb.append(\"\\n\");\n-            for(StyledSegment s: ss) {\n-                sb.append(\"    {text=\\\"\").append(s.getText());\n-                sb.append(\"\\\", a=\").append(s.getStyleAttributeMap(null)).append(\"\\n\");\n-            }\n+        List<StyledSegment> ss = getSegments(p);\n+        sb.append(\"\\n\");\n+        for (StyledSegment s : ss) {\n+            sb.append(\"    {text=\\\"\").append(s.getText());\n+            sb.append(\"\\\", a=\").append(s.getStyleAttributeMap(null)).append(\"\\n\");\n@@ -235,5 +227,7 @@\n-            List<StyledSegment> lsa = RichTextModelShim.getSegments(pa);\n-            List<StyledSegment> lsb = RichTextModelShim.getSegments(pb);\n-            if (!((lsa != null) && (lsb != null))) {\n-                if ((lsa == null) && (lsb == null)) {\n-                    return null;\n+            List<StyledSegment> lsa = getSegments(pa);\n+            List<StyledSegment> lsb = getSegments(pb);\n+            for (int j = 0; j < lsa.size(); j++) {\n+                StyledSegment a = lsa.get(j);\n+                StyledSegment b = lsb.get(j);\n+                if (!eq(a.getText(), b.getText())) {\n+                    return \"segment text[\" + j + \"] at ix=\" + i;\n@@ -241,12 +235,2 @@\n-                return \"segment array mismatch at ix=\" + i;\n-            }\n-            if (lsa != null) {\n-                for (int j = 0; j < lsa.size(); j++) {\n-                    StyledSegment a = lsa.get(j);\n-                    StyledSegment b = lsb.get(j);\n-                    if (!eq(a.getText(), b.getText())) {\n-                        return \"segment text[\" + j + \"] at ix=\" + i;\n-                    }\n-                    if (!eq(a.getStyleAttributeMap(null), b.getStyleAttributeMap(null))) {\n-                        return \"segment attrs[\" + j + \"] at ix=\" + i;\n-                    }\n+                if (!eq(a.getStyleAttributeMap(null), b.getStyleAttributeMap(null))) {\n+                    return \"segment attrs[\" + j + \"] at ix=\" + i;\n@@ -279,0 +263,9 @@\n+    private static List<StyledSegment> getSegments(RichParagraph p) {\n+        int sz = p.getSegmentCount();\n+        ArrayList<StyledSegment> ss = new ArrayList<>(sz);\n+        for (int i = 0; i < sz; i++) {\n+            ss.add(p.getSegment(i));\n+        }\n+        return ss;\n+    }\n+\n","filename":"modules\/jfx.incubator.richtext\/src\/test\/java\/test\/jfx\/incubator\/scene\/control\/richtext\/model\/TestRichTextModel.java","additions":24,"deletions":31,"binary":false,"changes":55,"status":"modified"}]}