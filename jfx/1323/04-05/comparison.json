{"files":[{"patch":"@@ -500,0 +500,1 @@\n+                            break;\n@@ -505,2 +506,4 @@\n-                        if (run.getStart() != curRunStart && run.getTextSpan().getText().equals(text) && x > run.getWidth()) {\n-                            x -= run.getWidth();\n+                        if (run.getStart() != curRunStart) {\n+                            if (run.getTextSpan().getText().equals(text) && x > run.getWidth() && (run.getLevel() & 0x01) != 1) {\n+                                x -= run.getWidth();\n+                            }\n@@ -510,1 +513,1 @@\n-                            if ((x > run.getWidth() && !isMultiRunText) || textWidthPrevLine > 0) {\n+                            if ((x > run.getWidth() && (!isMultiRunText || run.getStart() == curRunStart)) || textWidthPrevLine > 0) {\n@@ -513,1 +516,0 @@\n-                                break;\n@@ -515,6 +517,1 @@\n-                            if (x > run.getWidth()) {\n-                                x -= run.getWidth();\n-                                relIndex += run.getLength();\n-                                continue;\n-                            }\n-                            for (int j = runs.length - 1; j >= 0; j--) {\n+                            for (int j = runs.length - 1; j > i; j--) {\n@@ -524,3 +521,0 @@\n-                                if (runs[j].getStart() == curRunStart) {\n-                                    break;\n-                                }\n@@ -567,6 +561,3 @@\n-                    if ((run.getLevel() & 0x01) != 0) {\n-                        \/* Odd level represents RTL text.\n-                        *  If the RTL text has LTR text embedded,\n-                        *  add the LTR index here to get effective character index *\/\n-                        charIndex += ltrIndex;\n-                    }\n+                    \/*  When RTL text has LTR text embedded,\n+                     *  add the LTR index here to get effective character index *\/\n+                    charIndex += ltrIndex;\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/text\/PrismTextLayout.java","additions":10,"deletions":19,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -1032,1 +1032,1 @@\n-            textRunStart = ((TextRun) runs[0]).getStart();\n+            textRunStart = findFirstRunStart(x, y, runs);\n@@ -1039,0 +1039,10 @@\n+    private int findFirstRunStart(double x, double y, GlyphList[] runs) {\n+        int start = Integer.MAX_VALUE;\n+        for (GlyphList r: runs) {\n+            if (((TextRun) r).getStart() < start) {\n+                start = ((TextRun) r).getStart();\n+            }\n+        }\n+        return start;\n+    }\n+\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/text\/Text.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"}]}