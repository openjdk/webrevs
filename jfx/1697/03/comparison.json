{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,2 +28,6 @@\n-import java.util.*;\n-\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n@@ -35,1 +39,0 @@\n-import javafx.application.Platform;\n@@ -43,0 +46,5 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableBooleanProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.BooleanConverter;\n@@ -46,0 +54,1 @@\n+import javafx.scene.chart.LineChart.SortingPolicy;\n@@ -54,1 +63,0 @@\n-\n@@ -56,6 +64,0 @@\n-import javafx.css.converter.BooleanConverter;\n-import javafx.css.CssMetaData;\n-import javafx.css.Styleable;\n-import javafx.css.StyleableBooleanProperty;\n-import javafx.css.StyleableProperty;\n-import javafx.scene.chart.LineChart.SortingPolicy;\n@@ -544,1 +546,1 @@\n-            symbol.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            symbol.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/AreaChart.java","additions":14,"deletions":12,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,3 +28,7 @@\n-import java.util.*;\n-\n-import javafx.scene.AccessibleRole;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n@@ -38,1 +42,0 @@\n-import javafx.application.Platform;\n@@ -42,0 +45,1 @@\n+import javafx.collections.ListChangeListener;\n@@ -43,0 +47,6 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.PseudoClass;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableDoubleProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.SizeConverter;\n@@ -44,0 +54,1 @@\n+import javafx.scene.AccessibleRole;\n@@ -47,1 +58,0 @@\n-\n@@ -50,10 +60,0 @@\n-import javafx.css.StyleableDoubleProperty;\n-import javafx.css.CssMetaData;\n-import javafx.css.PseudoClass;\n-\n-import javafx.css.converter.SizeConverter;\n-import javafx.collections.ListChangeListener;\n-\n-import javafx.css.Styleable;\n-import javafx.css.StyleableProperty;\n-\n@@ -562,1 +562,1 @@\n-            bar.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            bar.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/BarChart.java","additions":17,"deletions":17,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-\n@@ -34,1 +33,0 @@\n-import javafx.application.Platform;\n@@ -44,1 +42,0 @@\n-\n@@ -273,1 +270,1 @@\n-            bubble.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            bubble.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/BubbleChart.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,3 +31,0 @@\n-\n-import com.sun.javafx.scene.control.skin.Utils;\n-\n@@ -43,0 +40,2 @@\n+import javafx.beans.value.ChangeListener;\n+import javafx.beans.value.ObservableValue;\n@@ -45,0 +44,7 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableBooleanProperty;\n+import javafx.css.StyleableObjectProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.BooleanConverter;\n+import javafx.css.converter.EnumConverter;\n@@ -48,0 +54,1 @@\n+import javafx.scene.Scene;\n@@ -51,1 +58,0 @@\n-\n@@ -55,10 +61,1 @@\n-\n-import javafx.css.StyleableBooleanProperty;\n-import javafx.css.StyleableObjectProperty;\n-import javafx.css.CssMetaData;\n-\n-import javafx.css.converter.BooleanConverter;\n-import javafx.css.converter.EnumConverter;\n-\n-import javafx.css.Styleable;\n-import javafx.css.StyleableProperty;\n+import com.sun.javafx.scene.control.skin.Utils;\n@@ -107,0 +104,2 @@\n+    private SimpleBooleanProperty accessibilityActive;\n+\n@@ -277,1 +276,0 @@\n-        titleLabel.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n@@ -514,1 +512,4 @@\n-}\n+    private void handleAccessibilityActive(boolean on) {\n+        titleLabel.setFocusTraversable(on);\n+        updateSymbolFocusable(on);\n+    }\n@@ -516,0 +517,9 @@\n+    \/**\n+     * Invoked in the FX application thread when accessibility active platform property changes.\n+     * The child classes should override this method to set focus traversable flag on every symbol, as well as\n+     * other elements that need to be focusable.\n+     * @param on whether the accessibility is active\n+     *\/\n+    \/\/ package protected: custom charts must handle accessbility on their own\n+    void updateSymbolFocusable(boolean on) {\n+    }\n@@ -517,0 +527,38 @@\n+    \/**\n+     * When called from JavaFX application thread, returns the value of the property.\n+     * When called from any other thread, returns false and sets up the machinery to\n+     * invoke {@code updateSymbolFocusable()} when needed.\n+     * The chart implementations should use this method to set focus travesable flags on the nodes\n+     * which needs to be focus traversable when accessibility is on.\n+     * @return\n+     *\/\n+    \/\/ package protected: custom charts must handle accessbility on their own\n+    boolean isAccessibilityActive() {\n+        if (Platform.isFxApplicationThread()) {\n+            if (accessibilityActive == null) {\n+                boolean aa = Platform.accessibilityActiveProperty().get();\n+                accessibilityActive = new SimpleBooleanProperty(aa);\n+                accessibilityActive.bind(Platform.accessibilityActiveProperty());\n+                accessibilityActive.addListener((src, prev, on) -> {\n+                    handleAccessibilityActive(on);\n+                });\n+            }\n+            return accessibilityActive.get();\n+        } else {\n+            \/\/ chart and its data are allowed to be constructed in a background thread\n+            ChangeListener<Scene> li = new ChangeListener<>() {\n+                @Override\n+                public void changed(ObservableValue<? extends Scene> src, Scene prev, Scene scene) {\n+                    if (scene != null) {\n+                        if (isAccessibilityActive()) {\n+                            handleAccessibilityActive(true);\n+                        }\n+                        sceneProperty().removeListener(this);\n+                    }\n+                }\n+            };\n+            sceneProperty().addListener(li);\n+        }\n+        return false;\n+    }\n+}\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/Chart.java","additions":65,"deletions":17,"binary":false,"changes":82,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+import java.util.Collections;\n@@ -32,1 +33,1 @@\n-\n+import javafx.animation.Animation;\n@@ -38,2 +39,0 @@\n-import javafx.animation.Animation;\n-import javafx.application.Platform;\n@@ -49,0 +48,5 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableBooleanProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.BooleanConverter;\n@@ -56,1 +60,0 @@\n-\n@@ -59,10 +62,0 @@\n-import javafx.css.StyleableBooleanProperty;\n-import javafx.css.CssMetaData;\n-\n-import javafx.css.converter.BooleanConverter;\n-\n-import java.util.*;\n-\n-import javafx.css.Styleable;\n-import javafx.css.StyleableProperty;\n-\n@@ -533,1 +526,1 @@\n-            symbol.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            symbol.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/LineChart.java","additions":9,"deletions":16,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,0 @@\n-\n-import com.sun.javafx.scene.control.skin.resources.ControlResources;\n@@ -42,1 +40,0 @@\n-import javafx.application.Platform;\n@@ -57,0 +54,7 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableBooleanProperty;\n+import javafx.css.StyleableDoubleProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.BooleanConverter;\n+import javafx.css.converter.SizeConverter;\n@@ -74,1 +78,0 @@\n-\n@@ -78,10 +81,1 @@\n-\n-import javafx.css.StyleableBooleanProperty;\n-import javafx.css.StyleableDoubleProperty;\n-import javafx.css.CssMetaData;\n-\n-import javafx.css.converter.BooleanConverter;\n-import javafx.css.converter.SizeConverter;\n-\n-import javafx.css.Styleable;\n-import javafx.css.StyleableProperty;\n+import com.sun.javafx.scene.control.skin.resources.ControlResources;\n@@ -419,0 +413,1 @@\n+        item.textNode.setFocusTraversable(isAccessibilityActive());\n@@ -1002,1 +997,1 @@\n-        public Data(java.lang.String name, double value) {\n+        public Data(String name, double value) {\n@@ -1008,1 +1003,0 @@\n-            textNode.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n@@ -1131,0 +1125,6 @@\n+    @Override\n+    void updateSymbolFocusable(boolean on) {\n+        for (Data d : getData()) {\n+            d.textNode.setFocusTraversable(on);\n+        }\n+    }\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/PieChart.java","additions":17,"deletions":17,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.util.Iterator;\n@@ -30,1 +31,0 @@\n-import javafx.application.Platform;\n@@ -38,1 +38,0 @@\n-\n@@ -41,2 +40,0 @@\n-import java.util.Iterator;\n-\n@@ -88,1 +85,1 @@\n-            symbol.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            symbol.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/ScatterChart.java","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,5 +28,14 @@\n-\n-import java.util.*;\n-\n-import javafx.animation.*;\n-import javafx.application.Platform;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.NavigableMap;\n+import java.util.TreeMap;\n+import javafx.animation.FadeTransition;\n+import javafx.animation.Interpolator;\n+import javafx.animation.KeyFrame;\n+import javafx.animation.KeyValue;\n+import javafx.animation.Timeline;\n@@ -34,0 +43,1 @@\n+import javafx.beans.property.BooleanProperty;\n@@ -39,0 +49,5 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableBooleanProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.BooleanConverter;\n@@ -43,1 +58,5 @@\n-import javafx.scene.shape.*;\n+import javafx.scene.shape.ClosePath;\n+import javafx.scene.shape.LineTo;\n+import javafx.scene.shape.MoveTo;\n+import javafx.scene.shape.Path;\n+import javafx.scene.shape.StrokeLineJoin;\n@@ -45,1 +64,0 @@\n-\n@@ -47,7 +65,0 @@\n-import javafx.css.converter.BooleanConverter;\n-\n-import javafx.beans.property.BooleanProperty;\n-import javafx.css.CssMetaData;\n-import javafx.css.Styleable;\n-import javafx.css.StyleableBooleanProperty;\n-import javafx.css.StyleableProperty;\n@@ -801,1 +812,1 @@\n-            symbol.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            symbol.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/StackedAreaChart.java","additions":27,"deletions":16,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,4 +29,12 @@\n-import java.util.*;\n-\n-import javafx.animation.*;\n-import javafx.application.Platform;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import javafx.animation.FadeTransition;\n+import javafx.animation.Interpolator;\n+import javafx.animation.KeyFrame;\n+import javafx.animation.KeyValue;\n+import javafx.animation.ParallelTransition;\n+import javafx.animation.Timeline;\n@@ -36,0 +44,1 @@\n+import javafx.collections.ListChangeListener;\n@@ -37,0 +46,6 @@\n+import javafx.css.CssMetaData;\n+import javafx.css.PseudoClass;\n+import javafx.css.Styleable;\n+import javafx.css.StyleableDoubleProperty;\n+import javafx.css.StyleableProperty;\n+import javafx.css.converter.SizeConverter;\n@@ -42,1 +57,0 @@\n-\n@@ -45,10 +59,0 @@\n-import javafx.css.StyleableDoubleProperty;\n-import javafx.css.CssMetaData;\n-import javafx.css.PseudoClass;\n-\n-import javafx.css.converter.SizeConverter;\n-\n-import javafx.collections.ListChangeListener;\n-import javafx.css.Styleable;\n-import javafx.css.StyleableProperty;\n-\n@@ -538,1 +542,1 @@\n-            bar.focusTraversableProperty().bind(Platform.accessibilityActiveProperty());\n+            bar.setFocusTraversable(isAccessibilityActive());\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/StackedBarChart.java","additions":21,"deletions":17,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -1735,0 +1735,11 @@\n+    @Override\n+    void updateSymbolFocusable(boolean on) {\n+        for (Series<X, Y> s : getData()) {\n+            for (Data<X, Y> d : s.getData()) {\n+                Node n = d.getNode();\n+                if (n != null) {\n+                    n.setFocusTraversable(on);\n+                }\n+            }\n+        }\n+    }\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/chart\/XYChart.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -182,1 +182,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -191,1 +190,0 @@\n-            c.getData().setAll(createNumberSeries());\n@@ -193,0 +191,2 @@\n+            c.getData().setAll(createNumberSeries());\n+            c.getData().setAll(createNumberSeries());\n@@ -196,1 +196,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -202,1 +201,3 @@\n-            c.getData().setAll(createCategorySeries());\n+            if (nextBoolean()) {\n+                c.getData().setAll(createCategorySeries());\n+            }\n@@ -205,1 +206,0 @@\n-            c.getData().setAll(createCategorySeries());\n@@ -207,0 +207,2 @@\n+            c.getData().setAll(createCategorySeries());\n+            c.getData().setAll(createCategorySeries());\n@@ -210,1 +212,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -219,1 +220,0 @@\n-            c.getData().setAll(createNumberSeries());\n@@ -221,0 +221,2 @@\n+            c.getData().setAll(createNumberSeries());\n+            c.getData().setAll(createNumberSeries());\n@@ -361,1 +363,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -370,1 +371,0 @@\n-            c.getData().setAll(createNumberSeries());\n@@ -372,0 +372,2 @@\n+            c.getData().setAll(createNumberSeries());\n+            c.getData().setAll(createNumberSeries());\n@@ -437,1 +439,0 @@\n-    @Disabled(\"JDK-8349090\") \/\/ FIX\n@@ -464,1 +465,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -473,1 +473,0 @@\n-            c.getData().setAll(createNumberSeries());\n@@ -475,0 +474,2 @@\n+            c.getData().setAll(createNumberSeries());\n+            c.getData().setAll(createNumberSeries());\n@@ -521,1 +522,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -530,1 +530,0 @@\n-            c.getData().setAll(createNumberSeries());\n@@ -532,0 +531,2 @@\n+            c.getData().setAll(createNumberSeries());\n+            c.getData().setAll(createNumberSeries());\n@@ -535,1 +536,0 @@\n-    @Disabled(\"JDK-8349091\") \/\/ FIX\n@@ -544,0 +544,1 @@\n+            c.getData().setAll(createCategorySeries());\n@@ -763,1 +764,1 @@\n-        c.setAnimated(true);\n+        c.setAnimated(nextBoolean());\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/NodeInitializationStressTest.java","additions":17,"deletions":16,"binary":false,"changes":33,"status":"modified"}]}