{"files":[{"patch":"@@ -802,2 +802,8 @@\n-    [keyCodeForCharMap setObject:mapObject forKey:[event charactersByApplyingModifiers: 0]];\n-    [keyCodeForCharMap setObject:mapObject forKey:[event charactersByApplyingModifiers: NSEventModifierFlagShift]];\n+    NSString* unshifted = GetStringForMacKey(event.keyCode, false);\n+    if (unshifted != nil) {\n+        [keyCodeForCharMap setObject:mapObject forKey:unshifted];\n+    }\n+    NSString* shifted = GetStringForMacKey(event.keyCode, true);\n+    if (shifted != nil) {\n+        [keyCodeForCharMap setObject:mapObject forKey:shifted];\n+    }\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassApplication.m","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -37,0 +37,1 @@\n+NSString* GetStringForMacKey(unsigned short keyCode, bool shifted);\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassKey.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -603,0 +603,21 @@\n+NSString* GetStringForMacKey(unsigned short keyCode, bool shifted)\n+{\n+    \/\/ Restrict to printable characters. UCKeyTranslate can produce\n+    \/\/ odd results with keys like Home, Up Arrow, etc.\n+    if (!macKeyCodeIsLayoutSensitive(keyCode)) return nil;\n+\n+    TISInputSourceRef keyboard = TISCopyCurrentKeyboardLayoutInputSource();\n+    if (keyboard == NULL) return nil;\n+\n+    UInt32 modifiers = (shifted ? shiftKey : 0);\n+    UniChar unicode[8];\n+    UniCharCount length = queryKeyboard(keyboard, keyCode, modifiers, unicode, 8);\n+    CFRelease(keyboard);\n+\n+    if (length == 1) {\n+        return [NSString stringWithCharacters: &unicode[0] length: 1];\n+    }\n+\n+    return nil;\n+}\n+\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassKey.m","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -513,1 +513,0 @@\n-    [GlassApplication registerKeyEvent:theEvent];\n@@ -516,0 +515,1 @@\n+        [GlassApplication registerKeyEvent:theEvent];\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassView3D.m","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}