{"files":[{"patch":"@@ -163,8 +163,0 @@\n-                if (stage != null) {\n-                    if (keyCode == KeyCode.ESCAPE) {\n-                        stage.setInAllowedEventHandler(false);\n-                    } else {\n-                        stage.setInAllowedEventHandler(true);\n-                    }\n-                }\n-\n@@ -192,3 +184,0 @@\n-                if (stage != null) {\n-                    stage.setInAllowedEventHandler(false);\n-                }\n@@ -334,12 +323,0 @@\n-                if (stage != null) {\n-                    switch (type) {\n-                        case MouseEvent.UP:\n-                        case MouseEvent.DOWN:\n-                            stage.setInAllowedEventHandler(true);\n-                            break;\n-                        default:\n-                            stage.setInAllowedEventHandler(false);\n-                            break;\n-                    }\n-                }\n-\n@@ -384,3 +361,0 @@\n-                if (stage != null) {\n-                    stage.setInAllowedEventHandler(false);\n-                }\n@@ -424,3 +398,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -455,3 +426,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -476,3 +444,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -517,3 +482,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -596,3 +558,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -612,3 +571,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -914,3 +870,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -969,3 +922,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -991,3 +941,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1043,3 +990,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1064,3 +1008,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1115,3 +1056,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1135,3 +1073,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1189,3 +1124,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1207,3 +1139,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1222,3 +1151,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1242,3 +1168,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1290,3 +1213,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1307,3 +1227,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1317,3 +1234,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/GlassViewEventHandler.java","additions":0,"deletions":86,"binary":false,"changes":86,"status":"modified"},{"patch":"@@ -71,4 +71,0 @@\n-    \/\/ A flag to indicate whether a call was generated from\n-    \/\/ an allowed input event handler.\n-    private boolean inAllowedEventHandler = false;\n-\n@@ -576,2 +572,0 @@\n-    private boolean fullScreenFromUserEvent = false;\n-\n@@ -593,7 +587,3 @@\n-                \/\/ Check whether app is full screen trusted or flag is set\n-                \/\/ indicating that the fullscreen request came from an input\n-                \/\/ event handler.\n-                \/\/ If not notify the stageListener to reset fullscreen to false.\n-                if (!fullScreenFromUserEvent) {\n-                    exitFullScreen();\n-                    fullscreenChanged(false);\n+                v.enterFullscreen(false, false, false);\n+                if (warning != null && warning.inWarningTransition()) {\n+                    warning.setView(getViewScene());\n@@ -601,5 +591,1 @@\n-                    v.enterFullscreen(false, false, false);\n-                    if (warning != null && warning.inWarningTransition()) {\n-                        warning.setView(getViewScene());\n-                    } else {\n-                        boolean showWarning = true;\n+                    boolean showWarning = true;\n@@ -607,2 +593,2 @@\n-                        KeyCombination key = null;\n-                        String exitMessage = null;\n+                    KeyCombination key = null;\n+                    String exitMessage = null;\n@@ -610,3 +596,3 @@\n-                        if (fxStage != null) {\n-                            \/\/ copy the user set definitions for later use.\n-                            key = fxStage.getFullScreenExitKeyCombination();\n+                    if (fxStage != null) {\n+                        \/\/ copy the user set definitions for later use.\n+                        key = fxStage.getFullScreenExitKeyCombination();\n@@ -614,2 +600,2 @@\n-                            exitMessage = fxStage.getFullScreenExitHint();\n-                        }\n+                        exitMessage = fxStage.getFullScreenExitHint();\n+                    }\n@@ -617,13 +603,13 @@\n-                        savedFullScreenExitKey =\n-                                key == null\n-                                ? defaultFullScreenExitKeycombo\n-                                : key;\n-\n-                        if (\n-                            \/\/ the hint is \"\"\n-                            \"\".equals(exitMessage) ||\n-                            \/\/ if the key is NO_MATCH\n-                            (savedFullScreenExitKey.equals(KeyCombination.NO_MATCH))\n-                                ) {\n-                            showWarning = false;\n-                        }\n+                    savedFullScreenExitKey =\n+                            key == null\n+                            ? defaultFullScreenExitKeycombo\n+                            : key;\n+\n+                    if (\n+                        \/\/ the hint is \"\"\n+                        \"\".equals(exitMessage) ||\n+                        \/\/ if the key is NO_MATCH\n+                        (savedFullScreenExitKey.equals(KeyCombination.NO_MATCH))\n+                            ) {\n+                        showWarning = false;\n+                    }\n@@ -631,8 +617,7 @@\n-                        \/\/ the hint is not set, use the key for the message\n-                        if (showWarning && exitMessage == null) {\n-                            if (key == null) {\n-                                exitMessage = RESOURCES.getString(\"OverlayWarningESC\");\n-                            } else {\n-                                String f = RESOURCES.getString(\"OverlayWarningKey\");\n-                                exitMessage = f.format(f, savedFullScreenExitKey.toString());\n-                            }\n+                    \/\/ the hint is not set, use the key for the message\n+                    if (showWarning && exitMessage == null) {\n+                        if (key == null) {\n+                            exitMessage = RESOURCES.getString(\"OverlayWarningESC\");\n+                        } else {\n+                            String f = RESOURCES.getString(\"OverlayWarningKey\");\n+                            exitMessage = f.format(f, savedFullScreenExitKey.toString());\n@@ -640,0 +625,1 @@\n+                    }\n@@ -641,3 +627,3 @@\n-                        if (showWarning && warning == null) {\n-                            setWarning(new OverlayWarning(getViewScene()));\n-                        }\n+                    if (showWarning && warning == null) {\n+                        setWarning(new OverlayWarning(getViewScene()));\n+                    }\n@@ -645,3 +631,2 @@\n-                        if (showWarning && warning != null) {\n-                            warning.warn(exitMessage);\n-                        }\n+                    if (showWarning && warning != null) {\n+                        warning.warn(exitMessage);\n@@ -657,2 +642,0 @@\n-            \/\/ Reset flag once we are done process fullscreen\n-            fullScreenFromUserEvent = false;\n@@ -680,6 +663,0 @@\n-       \/\/ Set a flag indicating whether this method was called from\n-        \/\/ an allowed input event handler.\n-        if (isInAllowedEventHandler()) {\n-            fullScreenFromUserEvent = true;\n-        }\n-\n@@ -862,8 +839,0 @@\n-    public void setInAllowedEventHandler(boolean inAllowedEventHandler) {\n-        this.inAllowedEventHandler = inAllowedEventHandler;\n-    }\n-\n-    private boolean isInAllowedEventHandler() {\n-        return inAllowedEventHandler;\n-    }\n-\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/WindowStage.java","additions":37,"deletions":68,"binary":false,"changes":105,"status":"modified"},{"patch":"@@ -3077,5 +3077,1 @@\n-                TransferMode tm;\n-                try {\n-                    tm = dndGesture.processTargetDrop(dragEvent);\n-                } finally {\n-                }\n+                TransferMode tm = dndGesture.processTargetDrop(dragEvent);\n@@ -3215,4 +3211,1 @@\n-                        try {\n-                            fireEvent(target, detectedEvent);\n-                        } finally {\n-                        }\n+                        fireEvent(target, detectedEvent);\n@@ -3246,4 +3239,1 @@\n-            try {\n-                fireEvent(target != null ? target : Scene.this, me);\n-            } finally {\n-            }\n+            fireEvent(target != null ? target : Scene.this, me);\n@@ -3507,4 +3497,1 @@\n-                try {\n-                    dndGesture.processDropEnd(dragEvent);\n-                } finally {\n-                }\n+                dndGesture.processDropEnd(dragEvent);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/Scene.java","additions":4,"deletions":17,"binary":false,"changes":21,"status":"modified"}]}