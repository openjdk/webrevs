{"files":[{"patch":"@@ -45,5 +45,0 @@\n-    public static void setDataAccessRestriction(Dragboard dragboard,\n-            boolean restricted) {\n-        dragboardAccessor.setDataAccessRestriction(dragboard, restricted);\n-    }\n-\n@@ -67,1 +62,0 @@\n-        void setDataAccessRestriction(Dragboard dragboard, boolean restricted);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/scene\/input\/DragboardHelper.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -66,5 +66,0 @@\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-    public static void initSecurityDialog(Stage stage, boolean securityDialog) {\n-        stageAccessor.initSecurityDialog(stage, securityDialog);\n-    }\n-\n@@ -94,1 +89,0 @@\n-        public void initSecurityDialog(Stage stage, boolean securityDialog);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/stage\/StageHelper.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -104,1 +104,1 @@\n-    public TKStage createTKStage(Window peerWindow, boolean securityDialog, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n+    public TKStage createTKStage(Window peerWindow, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/DummyToolkit.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -363,1 +363,1 @@\n-    public abstract TKStage createTKStage(Window peerWindow, boolean securityDialog, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl);\n+    public abstract TKStage createTKStage(Window peerWindow, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/Toolkit.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -100,28 +100,0 @@\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-    \/\/ Default fullscreen allows limited keyboard input.\n-    \/\/ It will only receive events from the following keys:\n-    \/\/ DOWN, UP, LEFT, RIGHT, SPACE, TAB, PAGE_UP, PAGE_DOWN,\n-    \/\/ HOME, END, ENTER.\n-    private static boolean allowableFullScreenKeys(int key) {\n-        switch (key) {\n-            case KeyEvent.VK_DOWN:\n-            case KeyEvent.VK_UP:\n-            case KeyEvent.VK_LEFT:\n-            case KeyEvent.VK_RIGHT:\n-            case KeyEvent.VK_SPACE:\n-            case KeyEvent.VK_TAB:\n-            case KeyEvent.VK_PAGE_DOWN:\n-            case KeyEvent.VK_PAGE_UP:\n-            case KeyEvent.VK_HOME:\n-            case KeyEvent.VK_END:\n-            case KeyEvent.VK_ENTER:\n-                return true;\n-        }\n-        return false;\n-    }\n-\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-    private boolean checkFullScreenKeyEvent(int type, int key, char chars[], int modifiers) {\n-        return scene.getWindowStage().isTrustedFullScreen() || allowableFullScreenKeys(key);\n-    }\n-\n@@ -191,8 +163,0 @@\n-                if (stage != null) {\n-                    if (keyCode == KeyCode.ESCAPE) {\n-                        stage.setInAllowedEventHandler(false);\n-                    } else {\n-                        stage.setInAllowedEventHandler(true);\n-                    }\n-                }\n-\n@@ -210,5 +174,0 @@\n-                        if (view.isInFullscreen()) {\n-                            if (!checkFullScreenKeyEvent(type, key, chars, modifiers)) {\n-                                break;\n-                            }\n-                        }\n@@ -225,3 +184,0 @@\n-                if (stage != null) {\n-                    stage.setInAllowedEventHandler(false);\n-                }\n@@ -367,12 +323,0 @@\n-                if (stage != null) {\n-                    switch (type) {\n-                        case MouseEvent.UP:\n-                        case MouseEvent.DOWN:\n-                            stage.setInAllowedEventHandler(true);\n-                            break;\n-                        default:\n-                            stage.setInAllowedEventHandler(false);\n-                            break;\n-                    }\n-                }\n-\n@@ -417,3 +361,0 @@\n-                if (stage != null) {\n-                    stage.setInAllowedEventHandler(false);\n-                }\n@@ -457,3 +398,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -488,3 +426,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -509,3 +444,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -550,3 +482,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -629,3 +558,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -645,3 +571,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -947,3 +870,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1002,3 +922,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1024,3 +941,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1076,3 +990,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1097,3 +1008,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1148,3 +1056,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1168,3 +1073,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1222,3 +1124,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1240,3 +1139,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1255,3 +1151,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1275,3 +1168,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1323,3 +1213,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n@@ -1340,3 +1227,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(true);\n-            }\n@@ -1350,3 +1234,0 @@\n-            if (stage != null) {\n-                stage.setInAllowedEventHandler(false);\n-            }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/GlassViewEventHandler.java","additions":0,"deletions":119,"binary":false,"changes":119,"status":"modified"},{"patch":"@@ -611,1 +611,1 @@\n-    @Override public TKStage createTKStage(Window peerWindow, boolean securityDialog, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n+    @Override public TKStage createTKStage(Window peerWindow, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n@@ -613,1 +613,1 @@\n-        WindowStage stage = new WindowStage(peerWindow, securityDialog, stageStyle, modality, owner);\n+        WindowStage stage = new WindowStage(peerWindow, stageStyle, modality, owner);\n@@ -684,3 +684,1 @@\n-        boolean securityDialog = owner instanceof WindowStage ?\n-                ((WindowStage)owner).isSecurityDialog() : false;\n-        WindowStage stage = new WindowStage(peerWindow, securityDialog, popupStyle, null, owner);\n+        WindowStage stage = new WindowStage(peerWindow, popupStyle, null, owner);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/QuantumToolkit.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -62,1 +62,0 @@\n-    private final boolean securityDialog;\n@@ -72,4 +71,0 @@\n-    \/\/ A flag to indicate whether a call was generated from\n-    \/\/ an allowed input event handler.\n-    private boolean inAllowedEventHandler = false;\n-\n@@ -91,1 +86,1 @@\n-    public WindowStage(javafx.stage.Window peerWindow, boolean securityDialog, final StageStyle stageStyle, Modality modality, TKStage owner) {\n+    public WindowStage(javafx.stage.Window peerWindow, final StageStyle stageStyle, Modality modality, TKStage owner) {\n@@ -95,1 +90,0 @@\n-        this.securityDialog = securityDialog;\n@@ -119,4 +113,0 @@\n-    final boolean isSecurityDialog() {\n-        return securityDialog;\n-    }\n-\n@@ -184,3 +174,0 @@\n-            if (securityDialog) {\n-                platformWindow.setLevel(Window.Level.FLOATING);\n-            }\n@@ -563,3 +550,0 @@\n-        \/\/ The securityDialog flag takes precedence over alwaysOnTop\n-        if (securityDialog) return;\n-\n@@ -583,6 +567,0 @@\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-    \/\/ Return true if this stage is trusted for full screen (it always is)\n-    boolean isTrustedFullScreen() {\n-        return true;\n-    }\n-\n@@ -594,3 +572,0 @@\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete field\n-    private boolean fullScreenFromUserEvent = false;\n-\n@@ -612,8 +587,3 @@\n-                \/\/ Check whether app is full screen trusted or flag is set\n-                \/\/ indicating that the fullscreen request came from an input\n-                \/\/ event handler.\n-                \/\/ If not notify the stageListener to reset fullscreen to false.\n-                final boolean isTrusted = isTrustedFullScreen();\n-                if (!isTrusted && !fullScreenFromUserEvent) {\n-                    exitFullScreen();\n-                    fullscreenChanged(false);\n+                v.enterFullscreen(false, false, false);\n+                if (warning != null && warning.inWarningTransition()) {\n+                    warning.setView(getViewScene());\n@@ -621,5 +591,1 @@\n-                    v.enterFullscreen(false, false, false);\n-                    if (warning != null && warning.inWarningTransition()) {\n-                        warning.setView(getViewScene());\n-                    } else {\n-                        boolean showWarning = true;\n+                    boolean showWarning = true;\n@@ -627,2 +593,2 @@\n-                        KeyCombination key = null;\n-                        String exitMessage = null;\n+                    KeyCombination key = null;\n+                    String exitMessage = null;\n@@ -630,3 +596,3 @@\n-                        if (isTrusted && (fxStage != null)) {\n-                            \/\/ copy the user set definitions for later use.\n-                            key = fxStage.getFullScreenExitKeyCombination();\n+                    if (fxStage != null) {\n+                        \/\/ copy the user set definitions for later use.\n+                        key = fxStage.getFullScreenExitKeyCombination();\n@@ -634,2 +600,2 @@\n-                            exitMessage = fxStage.getFullScreenExitHint();\n-                        }\n+                        exitMessage = fxStage.getFullScreenExitHint();\n+                    }\n@@ -637,13 +603,13 @@\n-                        savedFullScreenExitKey =\n-                                key == null\n-                                ? defaultFullScreenExitKeycombo\n-                                : key;\n-\n-                        if (\n-                            \/\/ the hint is \"\"\n-                            \"\".equals(exitMessage) ||\n-                            \/\/ if the key is NO_MATCH\n-                            (savedFullScreenExitKey.equals(KeyCombination.NO_MATCH))\n-                                ) {\n-                            showWarning = false;\n-                        }\n+                    savedFullScreenExitKey =\n+                            key == null\n+                            ? defaultFullScreenExitKeycombo\n+                            : key;\n+\n+                    if (\n+                        \/\/ the hint is \"\"\n+                        \"\".equals(exitMessage) ||\n+                        \/\/ if the key is NO_MATCH\n+                        (savedFullScreenExitKey.equals(KeyCombination.NO_MATCH))\n+                            ) {\n+                        showWarning = false;\n+                    }\n@@ -651,8 +617,7 @@\n-                        \/\/ the hint is not set, use the key for the message\n-                        if (showWarning && exitMessage == null) {\n-                            if (key == null) {\n-                                exitMessage = RESOURCES.getString(\"OverlayWarningESC\");\n-                            } else {\n-                                String f = RESOURCES.getString(\"OverlayWarningKey\");\n-                                exitMessage = f.format(f, savedFullScreenExitKey.toString());\n-                            }\n+                    \/\/ the hint is not set, use the key for the message\n+                    if (showWarning && exitMessage == null) {\n+                        if (key == null) {\n+                            exitMessage = RESOURCES.getString(\"OverlayWarningESC\");\n+                        } else {\n+                            String f = RESOURCES.getString(\"OverlayWarningKey\");\n+                            exitMessage = f.format(f, savedFullScreenExitKey.toString());\n@@ -660,0 +625,1 @@\n+                    }\n@@ -661,3 +627,3 @@\n-                        if (showWarning && warning == null) {\n-                            setWarning(new OverlayWarning(getViewScene()));\n-                        }\n+                    if (showWarning && warning == null) {\n+                        setWarning(new OverlayWarning(getViewScene()));\n+                    }\n@@ -665,3 +631,2 @@\n-                        if (showWarning && warning != null) {\n-                            warning.warn(exitMessage);\n-                        }\n+                    if (showWarning && warning != null) {\n+                        warning.warn(exitMessage);\n@@ -677,2 +642,0 @@\n-            \/\/ Reset flag once we are done process fullscreen\n-            fullScreenFromUserEvent = false;\n@@ -700,6 +663,0 @@\n-       \/\/ Set a flag indicating whether this method was called from\n-        \/\/ an allowed input event handler.\n-        if (isInAllowedEventHandler()) {\n-            fullScreenFromUserEvent = true;\n-        }\n-\n@@ -882,8 +839,0 @@\n-    public void setInAllowedEventHandler(boolean inAllowedEventHandler) {\n-        this.inAllowedEventHandler = inAllowedEventHandler;\n-    }\n-\n-    private boolean isInAllowedEventHandler() {\n-        return inAllowedEventHandler;\n-    }\n-\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/tk\/quantum\/WindowStage.java","additions":39,"deletions":90,"binary":false,"changes":129,"status":"modified"},{"patch":"@@ -3076,10 +3076,2 @@\n-                \/\/ Data dropped to the app can be accessed without restriction\n-                DragboardHelper.setDataAccessRestriction(dndGesture.dragboard, false);\n-\n-                TransferMode tm;\n-                try {\n-                    tm = dndGesture.processTargetDrop(dragEvent);\n-                } finally {\n-                    DragboardHelper.setDataAccessRestriction(\n-                            dndGesture.dragboard, true);\n-                }\n+\n+                TransferMode tm = dndGesture.processTargetDrop(dragEvent);\n@@ -3219,9 +3211,1 @@\n-                        try {\n-                            fireEvent(target, detectedEvent);\n-                        } finally {\n-                            \/\/ Putting data to dragboard finished, restrict access to them\n-                            if (dragboard != null) {\n-                                DragboardHelper.setDataAccessRestriction(\n-                                        dragboard, true);\n-                            }\n-                        }\n+                        fireEvent(target, detectedEvent);\n@@ -3255,9 +3239,1 @@\n-            try {\n-                fireEvent(target != null ? target : Scene.this, me);\n-            } finally {\n-                \/\/ Putting data to dragboard finished, restrict access to them\n-                if (dragboard != null) {\n-                    DragboardHelper.setDataAccessRestriction(\n-                            dragboard, true);\n-                }\n-            }\n+            fireEvent(target != null ? target : Scene.this, me);\n@@ -3472,3 +3448,0 @@\n-            \/\/ The app can see what it puts to dragboard without restriction\n-            DragboardHelper.setDataAccessRestriction(dragboard, false);\n-\n@@ -3524,8 +3497,1 @@\n-                \/\/ DRAG_DONE event is delivered to gesture source, it can access\n-                \/\/ its own data without restriction\n-                DragboardHelper.setDataAccessRestriction(dndGesture.dragboard, false);\n-                try {\n-                    dndGesture.processDropEnd(dragEvent);\n-                } finally {\n-                    DragboardHelper.setDataAccessRestriction(dndGesture.dragboard, true);\n-                }\n+                dndGesture.processDropEnd(dragEvent);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/Scene.java","additions":5,"deletions":39,"binary":false,"changes":44,"status":"modified"},{"patch":"@@ -155,5 +155,0 @@\n-            \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-            @Override\n-            public void setDataAccessRestriction(Dragboard dragboard, boolean restricted) {\n-            }\n-\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/input\/Dragboard.java","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -192,4 +192,0 @@\n-            @Override public void initSecurityDialog(Stage stage, boolean securityDialog) {\n-                stage.initSecurityDialog(securityDialog);\n-            }\n-\n@@ -283,35 +279,0 @@\n-    \/\/ Flag indicating that this stage is being used to show a security dialog\n-    private boolean securityDialog = false;\n-\n-    \/\/ TODO: JDK-8344111: Consider removing this obsolete method\n-    \/**\n-     * Sets a flag indicating that this stage is used for a security dialog and\n-     * must always be on top. If set, this will cause the window to be always\n-     * on top, regardless of the setting of the alwaysOnTop property.\n-     * NOTE: this flag must be set prior to showing the stage the first time.\n-     *\n-     * @param securityDialog flag indicating that this Stage is being used to\n-     * show a security dialog that should be always-on-top\n-     *\n-     * @throws IllegalStateException if this property is set after the stage\n-     * has ever been made visible.\n-     *\n-     * @defaultValue false\n-     *\/\n-    final void initSecurityDialog(boolean securityDialog) {\n-        if (hasBeenVisible) {\n-            throw new IllegalStateException(\"Cannot set securityDialog once stage has been set visible\");\n-        }\n-\n-        this.securityDialog = securityDialog;\n-    }\n-\n-    \/**\n-     * Returns the state of the securityDialog flag.\n-     *\n-     * @return a flag indicating whether or not this is a security dialog\n-     *\/\n-    final boolean isSecurityDialog() {\n-        return securityDialog;\n-    }\n-\n@@ -1128,2 +1089,2 @@\n-            setPeer(toolkit.createTKStage(this, isSecurityDialog(),\n-                    stageStyle, isPrimary(), getModality(), tkStage, rtl));\n+            setPeer(toolkit.createTKStage(this, stageStyle, isPrimary(),\n+                    getModality(), tkStage, rtl));\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/stage\/Stage.java","additions":2,"deletions":41,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -34,4 +34,0 @@\n-    public static boolean isSecurityDialog(Stage stage) {\n-        return stage.isSecurityDialog();\n-    }\n-\n","filename":"modules\/javafx.graphics\/src\/shims\/java\/javafx\/stage\/StageShim.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -122,1 +122,1 @@\n-    public TKStage createTKStage(Window peerWindow, boolean securityDialog, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n+    public TKStage createTKStage(Window peerWindow, StageStyle stageStyle, boolean primary, Modality modality, TKStage owner, boolean rtl) {\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/com\/sun\/javafx\/pgstub\/StubToolkit.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}