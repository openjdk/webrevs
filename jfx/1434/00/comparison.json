{"files":[{"patch":"@@ -579,1 +579,1 @@\n-            organizeOverflow(length, overflow);\n+            organizeOverflow(length, overflowed);\n@@ -593,1 +593,1 @@\n-        \/\/ Determine which node goes to the toolbar and which goes to the overflow.\n+        ObservableList<Node> nodes = getSkinnable().getItems();\n@@ -595,0 +595,4 @@\n+        \/\/ Determine the index of the first node to be moved to the overflow menu\n+        \/\/ IMPORTANT: As the width\/height of the node may depend on whether the node has been added to the scene,\n+        \/\/ do not move it between the toolbar and the overflow menu here.\n+        int overflowIndex = nodes.size();\n@@ -596,5 +600,2 @@\n-        overflowMenuItems.clear();\n-        box.getChildren().clear();\n-        for (Node node : getSkinnable().getItems()) {\n-            node.getStyleClass().remove(\"menu-item\");\n-            node.getStyleClass().remove(\"custom-menu-item\");\n+        for (int i = 0; i < nodes.size(); i++) {\n+            Node node = nodes.get(i);\n@@ -610,1 +611,16 @@\n-            if (x <= length) {\n+            if (x > length) {\n+                overflowIndex = i;\n+                break;\n+            }\n+        }\n+\n+        \/\/ Determine which node goes to the toolbar and which goes to the overflow.\n+\n+        overflowMenuItems.clear();\n+        box.getChildren().clear();\n+        for (int i = 0; i < nodes.size(); i++) {\n+            Node node = nodes.get(i);\n+            node.getStyleClass().remove(\"menu-item\");\n+            node.getStyleClass().remove(\"custom-menu-item\");\n+\n+            if (i < overflowIndex) {\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/ToolBarSkin.java","additions":24,"deletions":8,"binary":false,"changes":32,"status":"modified"}]}