{"files":[{"patch":"@@ -37,0 +37,2 @@\n+import javafx.beans.value.ChangeListener;\n+import javafx.beans.value.ObservableValue;\n@@ -516,1 +518,5 @@\n-\n+    private final ChangeListener<StringConverter> converterListener = new ChangeListener<StringConverter>() {\n+        @Override public void changed(ObservableValue<? extends StringConverter> observable, StringConverter oldValue, StringConverter newRate) {\n+            setText(valueProperty().getValue());\n+        }\n+    };\n@@ -536,0 +542,1 @@\n+                private SpinnerValueFactory oldFactory;\n@@ -538,0 +545,3 @@\n+                    if(oldFactory != null) {\n+                        oldFactory.converterProperty().removeListener(converterListener);\n+                    }\n@@ -544,4 +554,2 @@\n-                        \/\/ Update the spinner editor when converter is changed.\n-                        newFactory.converterProperty().addListener((o, oldValue, newValue) -> {\n-                            setText(valueProperty().getValue());\n-                        });\n+                        \/\/ Listener to update the spinner editor when converter is changed.\n+                        newFactory.converterProperty().addListener(converterListener);\n@@ -549,0 +557,1 @@\n+                    oldFactory = newFactory;\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/Spinner.java","additions":14,"deletions":5,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -1529,1 +1529,1 @@\n-    @Test public void testSpinnerEditorUpdateOnConverterChange() {\n+    @Test public void testDoubleSpinnerEditorUpdateOnConverterChange() {\n@@ -1533,3 +1533,0 @@\n-        intSpinner = new Spinner<>(0, 100, 50, 1);\n-        intSpinner.setEditable(true);\n-\n@@ -1537,1 +1534,0 @@\n-        assertEquals(\"50\", intSpinner.getEditor().getText());\n@@ -1560,0 +1556,9 @@\n+        assertEquals(\"50%\", dblSpinner.getEditor().getText());\n+    }\n+\n+    @Test public void testIntegerSpinnerEditorUpdateOnConverterChange() {\n+        intSpinner = new Spinner<>(0, 100, 50, 1);\n+        intSpinner.setEditable(true);\n+\n+        assertEquals(\"50\", intSpinner.getEditor().getText());\n+\n@@ -1577,1 +1582,0 @@\n-        assertEquals(\"50%\", dblSpinner.getEditor().getText());\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/SpinnerTest.java","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"}]}