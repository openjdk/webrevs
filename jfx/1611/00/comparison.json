{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -44,2 +44,0 @@\n-import java.security.AccessController;\n-import java.security.PrivilegedAction;\n@@ -261,2 +259,1 @@\n-                @SuppressWarnings(\"removal\")\n-                String autoScale = AccessController.doPrivileged((PrivilegedAction<String>)() -> System.getProperty(\"swt.autoScale\"));\n+                String autoScale = System.getProperty(\"swt.autoScale\");\n@@ -333,15 +330,11 @@\n-        AccessController.doPrivileged((PrivilegedAction<Void>) () -> {\n-            System.setProperty(\"com.sun.javafx.application.type\", \"FXCanvas\");\n-            System.setProperty(\"javafx.embed.isEventThread\", \"true\");\n-            if (swtDPIUtilMethod == null) {\n-                System.setProperty(\"glass.win.uiScale\", \"100%\");\n-                System.setProperty(\"glass.win.renderScale\", \"100%\");\n-            } else {\n-                Integer scale = 100;\n-                try {\n-                    scale = (Integer) swtDPIUtilMethod.invoke(null);\n-                } catch (Exception e) {\n-                    \/\/Fail silently\n-                }\n-                System.setProperty(\"glass.win.uiScale\", scale + \"%\");\n-                System.setProperty(\"glass.win.renderScale\", scale + \"%\");\n+        System.setProperty(\"com.sun.javafx.application.type\", \"FXCanvas\");\n+        System.setProperty(\"javafx.embed.isEventThread\", \"true\");\n+        if (swtDPIUtilMethod == null) {\n+            System.setProperty(\"glass.win.uiScale\", \"100%\");\n+            System.setProperty(\"glass.win.renderScale\", \"100%\");\n+        } else {\n+            Integer scale = 100;\n+            try {\n+                scale = (Integer) swtDPIUtilMethod.invoke(null);\n+            } catch (Exception e) {\n+                \/\/Fail silently\n@@ -349,3 +342,4 @@\n-            System.setProperty(\"javafx.embed.eventProc\", eventProcStr);\n-            return null;\n-        });\n+            System.setProperty(\"glass.win.uiScale\", scale + \"%\");\n+            System.setProperty(\"glass.win.renderScale\", scale + \"%\");\n+        }\n+        System.setProperty(\"javafx.embed.eventProc\", eventProcStr);\n@@ -354,6 +348,3 @@\n-        AccessController.doPrivileged((PrivilegedAction<Void>) () -> {\n-            Platform.startup(() -> {\n-                startupLatch.countDown();\n-            });\n-            return null;\n-        }, null, FXCANVAS_PERMISSION);\n+        Platform.startup(() -> {\n+            startupLatch.countDown();\n+        });\n","filename":"modules\/javafx.swt\/src\/main\/java\/javafx\/embed\/swt\/FXCanvas.java","additions":20,"deletions":29,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,2 +30,0 @@\n-import java.security.AccessController;\n-import java.security.PrivilegedExceptionAction;\n@@ -194,1 +192,0 @@\n-    @SuppressWarnings(\"removal\")\n@@ -197,6 +194,9 @@\n-        return AccessController.doPrivileged(\n-                (PrivilegedExceptionAction<Integer>) () -> {\n-                    Field field = clazz.getDeclaredField(name);\n-                    field.setAccessible(true);\n-                    return field.getInt(clazz);\n-                });\n+        Field field = clazz.getDeclaredField(name);\n+        field.setAccessible(true);\n+        return field.getInt(clazz);\n+    }\n+\n+    private static Method getMethod(Class<?> clazz, String name, Class<?> ... argClasses) throws Exception {\n+        Method method = clazz.getDeclaredMethod(name, argClasses);\n+        method.setAccessible(true);\n+        return method;\n@@ -228,7 +228,1 @@\n-            blitDirect = AccessController.doPrivileged(\n-                    (PrivilegedExceptionAction<Method>) () -> {\n-                        Method method = clazz.\n-                            getDeclaredMethod(\"blit\", argClasses);\n-                        method.setAccessible(true);\n-                        return method;\n-                    });\n+            blitDirect = getMethod(clazz, \"blit\", argClasses);\n@@ -272,7 +266,1 @@\n-            blitPalette = AccessController.doPrivileged(\n-                    (PrivilegedExceptionAction<Method>) () -> {\n-                        Method method = clazz.\n-                            getDeclaredMethod(\"blit\", argClasses);\n-                        method.setAccessible(true);\n-                        return method;\n-                    });\n+            blitPalette = getMethod(clazz, \"blit\", argClasses);\n@@ -298,6 +286,1 @@\n-            getByteOrderMethod = AccessController.doPrivileged(\n-                    (PrivilegedExceptionAction<Method>) () -> {\n-                        Method method = clazz.getDeclaredMethod(\"getByteOrder\");\n-                        method.setAccessible(true);\n-                        return method;\n-                    });\n+            getByteOrderMethod = getMethod(clazz, \"getByteOrder\");\n","filename":"modules\/javafx.swt\/src\/main\/java\/javafx\/embed\/swt\/SWTFXUtils.java","additions":13,"deletions":30,"binary":false,"changes":43,"status":"modified"}]}