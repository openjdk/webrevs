{"files":[{"patch":"@@ -38,0 +38,1 @@\n+import javafx.beans.property.DoubleProperty;\n@@ -44,0 +45,2 @@\n+import javafx.beans.property.SimpleDoubleProperty;\n+import javafx.beans.property.SimpleObjectProperty;\n@@ -66,2 +69,2 @@\n- * can specify draggable content nodes of the {@code HeaderBar} with the {@link #setDragType(Node, HeaderDragType)}\n- * method.\n+ * can specify draggable content nodes of the {@code HeaderBar} with the {@link #dragTypeProperty(Node) dragType}\n+ * property.\n@@ -90,4 +93,4 @@\n- * Applications can specify the preferred height for system-provided header buttons by setting the static\n- * {@link #setPrefButtonHeight(Stage, double)} property on the {@code Stage} associated with the header bar.\n- * This can be used to achieve a more cohesive visual appearance by having the system-provided header buttons\n- * match the height of the client-area header bar.\n+ * Applications can specify the preferred height for system-provided header buttons by setting the\n+ * {@link #prefButtonHeightProperty(Stage) prefButtonHeight} property on the {@code Stage} associated with\n+ * the header bar. This can be used to achieve a more cohesive visual appearance by having the system-provided\n+ * header buttons match the height of the client-area header bar.\n@@ -103,3 +106,4 @@\n- * buttons by setting {@link #setPrefButtonHeight(Stage, double)} to zero and place custom header buttons in\n- * the JavaFX scene graph instead. Any JavaFX control can be used as a custom header button by setting its\n- * semantic type with the {@link #setButtonType(Node, HeaderButtonType)} method.\n+ * buttons by setting the {@link #prefButtonHeightProperty(Stage) prefButtonHeight} property on the {@code Stage}\n+ * associated with the header bar to zero and place custom header buttons in the JavaFX scene graph instead.\n+ * Any JavaFX control can be used as a custom header button by specifying its semantic type with the\n+ * {@link #buttonTypeProperty(Node) buttonType} property.\n@@ -182,2 +186,0 @@\n-    private static final String DRAG_TYPE = \"headerbar-drag-type\";\n-    private static final String BUTTON_TYPE = \"headerbar-button-type\";\n@@ -188,4 +190,1 @@\n-     * Specifies the {@code HeaderDragType} of the child, indicating whether it is a draggable\n-     * part of the {@code HeaderBar}.\n-     * <p>\n-     * Setting the value to {@code null} will remove the flag.\n+     * Sets the value of the {@link #dragTypeProperty(Node) dragType} property for the specified child.\n@@ -197,1 +196,1 @@\n-        Pane.setConstraint(child, DRAG_TYPE, value);\n+        dragTypeProperty(child).set(value);\n@@ -201,1 +200,1 @@\n-     * Returns the {@code HeaderDragType} of the specified child.\n+     * Gets the value of the {@link #dragTypeProperty(Node) dragType} property of the specified child.\n@@ -207,1 +206,41 @@\n-        return (HeaderDragType)Pane.getConstraint(child, DRAG_TYPE);\n+        return dragTypeProperty(child).get();\n+    }\n+\n+    \/**\n+     * Specifies the {@code HeaderDragType} of the child, indicating whether it is a draggable part\n+     * of the {@code HeaderBar}. A value of {@code null} indicates that the drag type is not set.\n+     *\n+     * @param child the child node\n+     * @return the {@code dragType} property\n+     * @defaultValue {@code null}\n+     * @since 26\n+     *\/\n+    @SuppressWarnings(\"unchecked\")\n+    public static ObjectProperty<HeaderDragType> dragTypeProperty(Node child) {\n+        if (child.getProperties().get(HeaderDragType.class) instanceof ObjectProperty<?> property) {\n+            return (ObjectProperty<HeaderDragType>)property;\n+        }\n+\n+        var property = new SimpleObjectProperty<HeaderDragType>(child, \"dragType\");\n+        child.getProperties().put(HeaderDragType.class, property);\n+        return property;\n+    }\n+\n+    \/**\n+     * Sets the value of the {@link #buttonTypeProperty(Node) buttonType} property for the specified child.\n+     *\n+     * @param child the child node\n+     * @param value the {@code HeaderButtonType}, or {@code null}\n+     *\/\n+    public static void setButtonType(Node child, HeaderButtonType value) {\n+        buttonTypeProperty(child).set(value);\n+    }\n+\n+    \/**\n+     * Gets the value of the {@link #buttonTypeProperty(Node) buttonType} property of the specified child.\n+     *\n+     * @param child the child node\n+     * @return the {@code HeaderButtonType}, or {@code null}\n+     *\/\n+    public static HeaderButtonType getButtonType(Node child) {\n+        return buttonTypeProperty(child).get();\n@@ -218,1 +257,3 @@\n-     * @param value the {@code HeaderButtonType}, or {@code null}\n+     * @return the {@code buttonType} property\n+     * @defaultValue {@code null}\n+     * @since 26\n@@ -220,5 +261,4 @@\n-    public static void setButtonType(Node child, HeaderButtonType value) {\n-        Pane.setConstraint(child, BUTTON_TYPE, value);\n-\n-        if (child.getProperties().get(HeaderButtonBehavior.class) instanceof HeaderButtonBehavior behavior) {\n-            behavior.dispose();\n+    @SuppressWarnings(\"unchecked\")\n+    public static ObjectProperty<HeaderButtonType> buttonTypeProperty(Node child) {\n+        if (child.getProperties().get(HeaderButtonType.class) instanceof ObjectProperty<?> property) {\n+            return (ObjectProperty<HeaderButtonType>)property;\n@@ -227,5 +267,19 @@\n-        if (value != null) {\n-            child.getProperties().put(HeaderButtonBehavior.class, new HeaderButtonBehavior(child, value));\n-        } else {\n-            child.getProperties().remove(HeaderButtonBehavior.class);\n-        }\n+        var property = new SimpleObjectProperty<HeaderButtonType>(child, \"buttonType\") {\n+            HeaderButtonBehavior behavior;\n+\n+            @Override\n+            protected void invalidated() {\n+                HeaderButtonType type = get();\n+\n+                if (behavior != null) {\n+                    behavior.dispose();\n+                }\n+\n+                if (type != null) {\n+                    behavior = new HeaderButtonBehavior((Node)getBean(), type);\n+                }\n+            }\n+        };\n+\n+        child.getProperties().put(HeaderButtonType.class, property);\n+        return property;\n@@ -235,1 +289,8 @@\n-     * Returns the {@code HeaderButtonType} of the specified child.\n+     * Sentinel value that can be used for the {@link #prefButtonHeightProperty(Stage) prefButtonHeight}\n+     * property to indicate that the platform should choose the platform-specific default button height.\n+     *\/\n+    public static final double USE_DEFAULT_SIZE = -1;\n+\n+    \/**\n+     * Sets the value of the {@link #prefButtonHeightProperty(Stage) prefButtonHeight} property\n+     * for the specified {@code Stage}.\n@@ -237,2 +298,2 @@\n-     * @param child the child node\n-     * @return the {@code HeaderButtonType}, or {@code null}\n+     * @param stage the {@code Stage}\n+     * @param height the preferred height, or 0 to hide the system-provided header buttons\n@@ -240,2 +301,2 @@\n-    public static HeaderButtonType getButtonType(Node child) {\n-        return (HeaderButtonType)Pane.getConstraint(child, BUTTON_TYPE);\n+    public static void setPrefButtonHeight(Stage stage, double height) {\n+        AttachedProperties.of(stage).prefButtonHeight.set(height);\n@@ -245,2 +306,5 @@\n-     * Sentinel value that can be used for {@link #setPrefButtonHeight(Stage, double)} to indicate that\n-     * the platform should choose the platform-specific default button height.\n+     * Gets the value of the {@link #prefButtonHeightProperty(Stage) prefButtonHeight} property\n+     * of the specified {@code Stage}.\n+     *\n+     * @param stage the {@code Stage}\n+     * @return the preferred height of the system-provided header buttons\n@@ -248,1 +312,3 @@\n-    public static final double USE_DEFAULT_SIZE = -1;\n+    public static double getPrefButtonHeight(Stage stage) {\n+        return AttachedProperties.of(stage).prefButtonHeight.get();\n+    }\n@@ -251,1 +317,1 @@\n-     * Specifies the preferred height of the system-provided header buttons of the specified stage.\n+     * Specifies the preferred height of the system-provided header buttons of the specified {@code Stage}.\n@@ -265,11 +331,3 @@\n-     * @param height the preferred height, or 0 to hide the system-provided header buttons\n-     *\/\n-    public static void setPrefButtonHeight(Stage stage, double height) {\n-        StageHelper.setPrefHeaderButtonHeight(stage, height);\n-    }\n-\n-    \/**\n-     * Returns the preferred height of the system-provided header buttons of the specified stage.\n-     *\n-     * @param stage the {@code Stage}\n-     * @return the preferred height of the system-provided header buttons\n+     * @return the {@code prefButtonHeight} property\n+     * @defaultValue {@code USE_DEFAULT_SIZE}\n+     * @since 26\n@@ -277,2 +335,2 @@\n-    public static double getPrefButtonHeight(Stage stage) {\n-        return StageHelper.getPrefHeaderButtonHeight(stage);\n+    public static DoubleProperty prefButtonHeightProperty(Stage stage) {\n+        return AttachedProperties.of(stage).prefButtonHeight;\n@@ -282,3 +340,3 @@\n-     * Describes the size of the left system-reserved inset, which is an area reserved for the iconify, maximize,\n-     * and close window buttons. If there are no window buttons on the left side of the window, the returned area\n-     * is an empty {@code Dimension2D}.\n+     * Describes the size of the left system-reserved inset of the specified {@code Stage}, which is an area\n+     * reserved for the iconify, maximize, and close window buttons. If there are no window buttons on the left\n+     * side of the window, the returned area is an empty {@code Dimension2D}.\n@@ -288,0 +346,1 @@\n+     * @since 26\n@@ -294,1 +353,2 @@\n-     * Gets the value of the {@link #leftSystemInsetProperty(Stage) leftSystemInset} property.\n+     * Gets the value of the {@link #leftSystemInsetProperty(Stage) leftSystemInset} property\n+     * of the specified {@code Stage}.\n@@ -298,0 +358,1 @@\n+     * @since 26\n@@ -304,3 +365,3 @@\n-     * Describes the size of the right system-reserved inset, which is an area reserved for the iconify, maximize,\n-     * and close window buttons. If there are no window buttons on the right side of the window, the returned area\n-     * is an empty {@code Dimension2D}.\n+     * Describes the size of the right system-reserved inset of the specified {@code Stage}, which is an area\n+     * reserved for the iconify, maximize, and close window buttons. If there are no window buttons on the right\n+     * side of the window, the returned area is an empty {@code Dimension2D}.\n@@ -310,0 +371,1 @@\n+     * @since 26\n@@ -316,1 +378,2 @@\n-     * Gets the value of the {@link #rightSystemInsetProperty(Stage) rightSystemInset} property.\n+     * Gets the value of the {@link #rightSystemInsetProperty(Stage) rightSystemInset} property\n+     * of the specified {@code Stage}.\n@@ -320,0 +383,1 @@\n+     * @since 26\n@@ -326,3 +390,3 @@\n-     * The system-provided minimum recommended height for the {@code HeaderBar}, which usually corresponds\n-     * to the height of the default header buttons. Applications can use this value as a sensible lower limit\n-     * for the height of the {@code HeaderBar}.\n+     * The system-provided minimum recommended height for the {@code HeaderBar} of the specified {@code Stage},\n+     * which usually corresponds to the height of the default header buttons. Applications can use this value\n+     * as a sensible lower limit for the height of the {@code HeaderBar}.\n@@ -335,0 +399,1 @@\n+     * @since 26\n@@ -341,1 +406,2 @@\n-     * Gets the value of the {@link #minSystemHeightProperty(Stage) minSystemHeight} property.\n+     * Gets the value of the {@link #minSystemHeightProperty(Stage) minSystemHeight} property\n+     * of the specified {@code Stage}.\n@@ -345,0 +411,1 @@\n+     * @since 26\n@@ -879,0 +946,1 @@\n+        private final DoubleProperty prefButtonHeight;\n@@ -886,3 +954,10 @@\n-            this.leftSystemInset = new ReadOnlyObjectWrapper<>(stage, \"HeaderBar.leftSystemInset\", EMPTY);\n-            this.rightSystemInset = new ReadOnlyObjectWrapper<>(stage, \"HeaderBar.rightSystemInset\", EMPTY);\n-            this.minSystemHeight = new ReadOnlyDoubleWrapper(stage, \"HeaderBar.minSystemHeight\");\n+            this.leftSystemInset = new ReadOnlyObjectWrapper<>(stage, \"leftSystemInset\", EMPTY);\n+            this.rightSystemInset = new ReadOnlyObjectWrapper<>(stage, \"rightSystemInset\", EMPTY);\n+            this.minSystemHeight = new ReadOnlyDoubleWrapper(stage, \"minSystemHeight\");\n+            this.prefButtonHeight = new SimpleDoubleProperty(\n+                    stage, \"prefButtonHeight\", StageHelper.getPrefHeaderButtonHeight(stage)) {\n+                @Override\n+                protected void invalidated() {\n+                    StageHelper.setPrefHeaderButtonHeight(stage, get());\n+                }\n+            };\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/layout\/HeaderBar.java","additions":141,"deletions":66,"binary":false,"changes":207,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -198,14 +198,0 @@\n- *\n- *\n- * <h2>Layout Orientation<\/h2>\n- * The layout orientation of the scene graph is determined by the {@link javafx.scene.Scene#nodeOrientationProperty() Scene.nodeOrientation}\n- * and {@link javafx.scene.Node#nodeOrientationProperty() Node.nodeOrientation} properties.\n- * It is effectively left-to-right by default, but can be right-to-left depending on the locale of the operating system.\n- * If a layout orientation is set on the scene or on any node of the scene graph, descendants of the scene or node will\n- * inherit the specified orientation.\n- * <p>\n- * For layout containers, the layout orientation determines the visual order of their children. If a layout container\n- * has named areas, the names always retain their default meaning. For example, the {@code left} and {@code right}\n- * areas of {@link javafx.scene.layout.BorderPane BorderPane} or {@link javafx.scene.layout.HeaderBar HeaderBar}\n- * are always left and right in regard to the default layout orientation (left-to-right). If the layout orientation\n- * is right-to-left, the left area will appear to the right, and the right area will appear to the left.\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/layout\/package-info.java","additions":1,"deletions":15,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -100,1 +100,1 @@\n- * <li>{@link StageStyle#EXTENDED} - a decorated stage with a custom {@link HeaderBar}.<\/li>\n+ * <li>{@link StageStyle#EXTENDED} - a decorated stage with a custom {@link HeaderBar} (Preview Feature).<\/li>\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/stage\/Stage.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+import javafx.scene.layout.HeaderButtonType;\n@@ -104,0 +105,32 @@\n+    @Test\n+    void dragType_attachedProperty() {\n+        var child = new Rectangle();\n+        var type = new HeaderDragType[1];\n+        assertNull(HeaderBar.getDragType(child));\n+        HeaderBar.dragTypeProperty(child).subscribe(v -> type[0] = v);\n+        HeaderBar.setDragType(child, HeaderDragType.DRAGGABLE);\n+        assertEquals(HeaderDragType.DRAGGABLE, type[0]);\n+        assertEquals(HeaderDragType.DRAGGABLE, HeaderBar.getDragType(child));\n+    }\n+\n+    @Test\n+    void buttonType_attachedProperty() {\n+        var child = new Rectangle();\n+        var type = new HeaderButtonType[1];\n+        assertNull(HeaderBar.getButtonType(child));\n+        HeaderBar.buttonTypeProperty(child).subscribe(v -> type[0] = v);\n+        HeaderBar.setButtonType(child, HeaderButtonType.MAXIMIZE);\n+        assertEquals(HeaderButtonType.MAXIMIZE, type[0]);\n+        assertEquals(HeaderButtonType.MAXIMIZE, HeaderBar.getButtonType(child));\n+    }\n+\n+    @Test\n+    void prefButtonHeight_attachedProperty() {\n+        var minHeight = new double[1];\n+        assertEquals(HeaderBar.USE_DEFAULT_SIZE, HeaderBar.getPrefButtonHeight(stage));\n+        HeaderBar.prefButtonHeightProperty(stage).subscribe(v -> minHeight[0] = v.doubleValue());\n+        HeaderBar.prefButtonHeightProperty(stage).set(123);\n+        assertEquals(123, minHeight[0]);\n+        assertEquals(123, HeaderBar.getPrefButtonHeight(stage));\n+    }\n+\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/javafx\/scene\/layout\/HeaderBarTest.java","additions":33,"deletions":0,"binary":false,"changes":33,"status":"modified"}]}