{"files":[{"patch":"@@ -813,2 +813,7 @@\n-    static BigDecimal wrapValue(BigDecimal value, BigDecimal min, BigDecimal max, BigDecimal stepSize) {\n-        BigDecimal span = max.subtract(min).add(stepSize);\n+    static BigDecimal wrapValue(BigDecimal currentValue, BigDecimal newValue, BigDecimal min, BigDecimal max) {\n+        if (newValue.compareTo(min) >= 0 && newValue.compareTo(max) <= 0) {\n+            return newValue;\n+        }\n+\n+        BigDecimal span = max.subtract(min);\n+        BigDecimal remainder = newValue.remainder(span);\n@@ -816,2 +821,2 @@\n-        if (value.signum() < 0) {\n-            value = max.add(value.remainder(span)).add(stepSize);\n+        if (remainder.compareTo(BigDecimal.ZERO) == 0) {\n+            return newValue.compareTo(currentValue) >= 0 ? max : min;\n@@ -820,1 +825,1 @@\n-        return min.add(value.subtract(min).remainder(span));\n+        return newValue.compareTo(max) > 0 ? min.add(remainder) : max.add(remainder);\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/Spinner.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -851,1 +851,1 @@\n-                Spinner.wrapValue(newValue, minBigDecimal, maxBigDecimal, amountToStepByBigDecimal).doubleValue() :\n+                Spinner.wrapValue(currentValue, newValue, minBigDecimal, maxBigDecimal).doubleValue() :\n@@ -863,1 +863,1 @@\n-                Spinner.wrapValue(newValue, minBigDecimal, maxBigDecimal, amountToStepByBigDecimal).doubleValue() :\n+                Spinner.wrapValue(currentValue, newValue, minBigDecimal, maxBigDecimal).doubleValue() :\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/SpinnerValueFactory.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -687,1 +687,0 @@\n-        dblValueFactory.increment(1); \/\/ 0.00\n@@ -698,3 +697,3 @@\n-        dblValueFactory.increment(2); \/\/ 0.05 Note: one step is consumed going from 1.0->0.0\n-        dblValueFactory.increment(2); \/\/ 0.15\n-        assertEquals(0.15, dblValueFactory.getValue(), 0);\n+        dblValueFactory.increment(2); \/\/ 0.10\n+        dblValueFactory.increment(2); \/\/ 0.20\n+        assertEquals(0.2, dblValueFactory.getValue(), 0);\n@@ -705,1 +704,1 @@\n-        dblValueFactory.increment(21);\n+        dblValueFactory.increment(20);\n@@ -707,1 +706,1 @@\n-        dblValueFactory.increment(31);\n+        dblValueFactory.increment(30);\n@@ -709,1 +708,1 @@\n-        dblValueFactory.increment(42);\n+        dblValueFactory.increment(40);\n@@ -711,1 +710,1 @@\n-        dblValueFactory.increment(53);\n+        dblValueFactory.increment(50);\n@@ -717,0 +716,2 @@\n+        dblValueFactory.increment(-9);\n+        assertEquals(0.05, dblValueFactory.getValue());\n@@ -718,9 +719,5 @@\n-        assertEquals(0.45, dblValueFactory.getValue());\n-        dblValueFactory.increment(-21);\n-        assertEquals(0.45, dblValueFactory.getValue());\n-        dblValueFactory.increment(-22);\n-        assertEquals(0.4, dblValueFactory.getValue());\n-        dblValueFactory.increment(-42);\n-        assertEquals(0.4, dblValueFactory.getValue());\n-        dblValueFactory.increment(-43);\n-        assertEquals(0.35, dblValueFactory.getValue());\n+        assertEquals(0.0, dblValueFactory.getValue());\n+        dblValueFactory.increment(-1);\n+        assertEquals(0.95, dblValueFactory.getValue());\n+        dblValueFactory.increment(-20);\n+        assertEquals(0.95, dblValueFactory.getValue());\n@@ -736,1 +733,0 @@\n-        dblValueFactory.decrement(1); \/\/ 1.00\n@@ -747,3 +743,3 @@\n-        dblValueFactory.decrement(2); \/\/ 0.95 NOTE: one step is consumed going from 0.0->1.0\n-        dblValueFactory.decrement(2); \/\/ 0.85\n-        assertEquals(0.85, dblValueFactory.getValue());\n+        dblValueFactory.decrement(2); \/\/ 0.90\n+        dblValueFactory.decrement(2); \/\/ 0.80\n+        assertEquals(0.80, dblValueFactory.getValue());\n@@ -754,1 +750,1 @@\n-        dblValueFactory.decrement(21);\n+        dblValueFactory.decrement(20);\n@@ -756,1 +752,1 @@\n-        dblValueFactory.decrement(31);\n+        dblValueFactory.decrement(30);\n@@ -758,1 +754,1 @@\n-        dblValueFactory.decrement(42);\n+        dblValueFactory.decrement(40);\n@@ -760,1 +756,1 @@\n-        dblValueFactory.decrement(53);\n+        dblValueFactory.decrement(50);\n@@ -766,0 +762,2 @@\n+        dblValueFactory.decrement(-9);\n+        assertEquals(0.95, dblValueFactory.getValue());\n@@ -767,9 +765,5 @@\n-        assertEquals(0.55, dblValueFactory.getValue());\n-        dblValueFactory.decrement(-21);\n-        assertEquals(0.55, dblValueFactory.getValue());\n-        dblValueFactory.decrement(-22);\n-        assertEquals(0.6, dblValueFactory.getValue());\n-        dblValueFactory.decrement(-42);\n-        assertEquals(0.6, dblValueFactory.getValue());\n-        dblValueFactory.decrement(-43);\n-        assertEquals(0.65, dblValueFactory.getValue());\n+        assertEquals(1.0, dblValueFactory.getValue());\n+        dblValueFactory.decrement(-1);\n+        assertEquals(0.05, dblValueFactory.getValue());\n+        dblValueFactory.decrement(-20);\n+        assertEquals(0.05, dblValueFactory.getValue());\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/SpinnerTest.java","additions":28,"deletions":34,"binary":false,"changes":62,"status":"modified"}]}