{"files":[{"patch":"@@ -122,0 +122,2 @@\n+    -webkit-appearance:media-mute-button;\n+    appearance:media-mute-button;\n@@ -158,0 +160,2 @@\n+    -webkit-appearance:media-play-button;\n+    appearance:media-play-button;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/Modules\/mediacontrols\/mediaControlsAdwaita.css","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -493,0 +493,77 @@\n+#if PLATFORM(JAVA)\n+    case SliderThumbHorizontalPart:\n+        m_value.valueID = CSSValueSliderthumbHorizontal;\n+        break;\n+    case SliderThumbVerticalPart:\n+        m_value.valueID = CSSValueSliderthumbVertical;\n+        break;\n+    case MediaControlsBackgroundPart:\n+        m_value.valueID = CSSValueMediaControlsBackground;\n+        break;\n+    case MediaControlsDarkBarBackgroundPart:\n+        m_value.valueID = CSSValueMediaControlsDarkBarBackground;\n+        break;\n+    case MediaControlsLightBarBackgroundPart:\n+        m_value.valueID = CSSValueMediaControlsLightBarBackground;\n+        break;\n+    case MediaCurrentTimePart:\n+        m_value.valueID = CSSValueMediaCurrentTimeDisplay;\n+        break;\n+    case MediaEnterFullscreenButtonPart:\n+        m_value.valueID = CSSValueMediaEnterFullscreenButton;\n+        break;\n+    case MediaExitFullscreenButtonPart:\n+        m_value.valueID = CSSValueMediaExitFullscreenButton;\n+        break;\n+    case MediaFullScreenVolumeSliderPart:\n+        m_value.valueID = CSSValueMediaFullscreenVolumeSlider;\n+        break;\n+    case MediaFullScreenVolumeSliderThumbPart:\n+        m_value.valueID = CSSValueMediaFullscreenVolumeSliderThumb;\n+        break;\n+    case MediaMuteButtonPart:\n+        m_value.valueID = CSSValueMediaMuteButton;\n+        break;\n+    case MediaOverlayPlayButtonPart:\n+        m_value.valueID = CSSValueMediaOverlayPlayButton;\n+        break;\n+    case MediaPlayButtonPart:\n+        m_value.valueID = CSSValueMediaPlayButton;\n+        break;\n+    case MediaReturnToRealtimeButtonPart:\n+        m_value.valueID = CSSValueMediaReturnToRealtimeButton;\n+        break;\n+    case MediaRewindButtonPart:\n+        m_value.valueID = CSSValueMediaRewindButton;\n+        break;\n+    case MediaSeekBackButtonPart:\n+        m_value.valueID = CSSValueMediaSeekBackButton;\n+        break;\n+    case MediaSeekForwardButtonPart:\n+        m_value.valueID = CSSValueMediaSeekForwardButton;\n+        break;\n+    case MediaSliderPart:\n+        m_value.valueID = CSSValueMediaSlider;\n+        break;\n+    case MediaSliderThumbPart:\n+        m_value.valueID = CSSValueMediaSliderthumb;\n+        break ;\n+    case MediaTimeRemainingPart:\n+        m_value.valueID = CSSValueMediaTimeRemainingDisplay;\n+        break;\n+    case MediaToggleClosedCaptionsButtonPart:\n+        m_value.valueID = CSSValueMediaToggleClosedCaptionsButton;\n+        break;\n+    case MediaVolumeSliderPart:\n+        m_value.valueID = CSSValueMediaVolumeSlider;\n+        break;\n+    case MediaVolumeSliderContainerPart:\n+        m_value.valueID = CSSValueMediaVolumeSliderContainer;\n+        break;\n+    case MediaVolumeSliderMuteButtonPart:\n+        m_value.valueID = CSSValueMediaVolumeSliderMuteButton;\n+        break;\n+    case MediaVolumeSliderThumbPart:\n+        m_value.valueID = CSSValueMediaVolumeSliderthumb;\n+        break;\n+#endif\n@@ -530,0 +607,1 @@\n+#if !PLATFORM(JAVA)\n@@ -532,0 +610,1 @@\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/css\/CSSPrimitiveValueMappings.h","additions":79,"deletions":0,"binary":false,"changes":79,"status":"modified"},{"patch":"@@ -5222,0 +5222,24 @@\n+                \"media-controls-background\",\n+                \"media-controls-dark-bar-background\",\n+                \"media-controls-fullscreen-background\",\n+                \"media-controls-light-bar-background\",\n+                \"media-current-time-display\",\n+                \"media-enter-fullscreen-button\",\n+                \"media-exit-fullscreen-button\",\n+                \"media-fullscreen-volume-slider\",\n+                \"media-fullscreen-volume-slider-thumb\",\n+                \"media-mute-button\",\n+                \"media-overlay-play-button\",\n+                \"media-play-button\",\n+                \"media-return-to-realtime-button\",\n+                \"media-rewind-button\",\n+                \"media-seek-back-button\",\n+                \"media-seek-forward-button\",\n+                \"media-slider\",\n+                \"media-sliderthumb\",\n+                \"media-time-remaining-display\",\n+                \"media-toggle-closed-captions-button\",\n+                \"media-volume-slider\",\n+                \"media-volume-slider-container\",\n+                \"media-volume-slider-mute-button\",\n+                \"media-volume-sliderthumb\",\n@@ -5228,0 +5252,2 @@\n+                \"sliderthumb-horizontal\",\n+                \"sliderthumb-vertical\",\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/css\/CSSProperties.json","additions":26,"deletions":0,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -852,0 +852,28 @@\n+\/\/ if platform JAVA\n+sliderthumb-horizontal\n+sliderthumb-vertical\n+media-controls-background\n+media-controls-dark-bar-background\n+media-controls-fullscreen-background\n+media-controls-light-bar-background\n+media-current-time-display\n+media-enter-fullscreen-button\n+media-exit-fullscreen-button\n+media-fullscreen-volume-slider\n+media-fullscreen-volume-slider-thumb\n+media-mute-button\n+media-overlay-play-button\n+media-play-button\n+media-return-to-realtime-button\n+media-rewind-button\n+media-seek-back-button\n+media-seek-forward-button\n+media-slider\n+media-sliderthumb\n+media-time-remaining-display\n+media-toggle-closed-captions-button\n+media-volume-slider\n+media-volume-slider-container\n+media-volume-slider-mute-button\n+media-volume-sliderthumb\n+\/\/ end platform JAVA\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/css\/CSSValueKeywords.in","additions":28,"deletions":0,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -873,0 +873,3 @@\n+    \/*This is needed for PLATFORM(JAVA)*\/\n+    -webkit-appearance: slider-horizontal;\n+    appearance: slider-horizontal;\n@@ -896,1 +899,3 @@\n-    appearance: auto;\n+    \/*This is needed for PLATFORM(JAVA)*\/\n+    -webkit-appearance: sliderthumb-horizontal;\n+    appearance: sliderthumb-horizontal;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/css\/html.css","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -150,0 +150,14 @@\n+#if PLATFORM(JAVA)\n+const AtomString& webkitMediaSliderThumb()\n+{\n+    static MainThreadNeverDestroyed<const AtomString> webkitMediaSliderThumb(\"-webkit-media-slider-thumb\"_s);\n+    return webkitMediaSliderThumb;\n+}\n+\n+const AtomString& webkitMediaSliderContainer()\n+{\n+    static MainThreadNeverDestroyed<const AtomString> webkitMediaSliderContainer(\"-webkit-media-slider-container\"_s);\n+    return webkitMediaSliderContainer;\n+}\n+#endif\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/html\/shadow\/ShadowPseudoIds.cpp","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -63,0 +63,4 @@\n+#if PLATFORM(JAVA)\n+const AtomString& webkitMediaSliderThumb();\n+const AtomString& webkitMediaSliderContainer();\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/html\/shadow\/ShadowPseudoIds.h","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -67,0 +67,3 @@\n+#if PLATFORM(JAVA)\n+WTF_MAKE_ISO_ALLOCATED_IMPL(RenderSliderThumb);\n+#endif\n@@ -81,0 +84,30 @@\n+#if PLATFORM(JAVA)\n+RenderSliderThumb::RenderSliderThumb(SliderThumbElement& element, RenderStyle&& style)\n+    : RenderBlockFlow(element, WTFMove(style))\n+{\n+}\n+\n+void RenderSliderThumb::updateAppearance(const RenderStyle* parentStyle)\n+{\n+    if (parentStyle->effectiveAppearance() == SliderVerticalPart)\n+        mutableStyle().setEffectiveAppearance(SliderThumbVerticalPart);\n+    else if (parentStyle->effectiveAppearance() == SliderHorizontalPart)\n+        mutableStyle().setEffectiveAppearance(SliderThumbHorizontalPart);\n+    else if (parentStyle->effectiveAppearance() == MediaSliderPart)\n+        mutableStyle().setEffectiveAppearance(MediaSliderThumbPart);\n+    else if (parentStyle->effectiveAppearance() == MediaVolumeSliderPart)\n+        mutableStyle().setEffectiveAppearance(MediaVolumeSliderThumbPart);\n+    else if (parentStyle->effectiveAppearance() == MediaFullScreenVolumeSliderPart)\n+        mutableStyle().setEffectiveAppearance(MediaFullScreenVolumeSliderThumbPart);\n+    if (style().hasEffectiveAppearance()) {\n+        ASSERT(element());\n+        theme().adjustSliderThumbSize(mutableStyle(), element());\n+    }\n+}\n+\n+bool RenderSliderThumb::isSliderThumb() const\n+{\n+    return true;\n+}\n+#endif\n+\n@@ -197,0 +230,7 @@\n+#if PLATFORM(JAVA)\n+RenderPtr<RenderElement> SliderThumbElement::createElementRenderer(RenderStyle&& style, const RenderTreePosition&)\n+{\n+    return createRenderer<RenderSliderThumb>(*this, WTFMove(style));\n+}\n+#endif\n+\n@@ -557,0 +597,1 @@\n+#if !PLATFORM(JAVA)\n@@ -565,0 +606,13 @@\n+\t}\n+\treturn elementStyle;\t\t\n+#else\n+    case MediaSliderPart:\n+    case MediaSliderThumbPart:\n+    case MediaVolumeSliderPart:\n+    case MediaVolumeSliderThumbPart:\n+    case MediaFullScreenVolumeSliderPart:\n+    case MediaFullScreenVolumeSliderThumbPart:\n+        m_shadowPseudoId = ShadowPseudoIds::webkitMediaSliderThumb();\n+        break;\n+    default:\n+        m_shadowPseudoId = ShadowPseudoIds::webkitSliderThumb();\n@@ -566,0 +620,4 @@\n+#endif\t\n+\n+    return std::nullopt;\n+}\n@@ -567,1 +625,4 @@\n-    return elementStyle;\n+#if PLATFORM(JAVA)\n+const AtomString& SliderThumbElement::shadowPseudoId() const\n+{\n+    return m_shadowPseudoId;\n@@ -569,0 +630,1 @@\n+#endif\n@@ -596,0 +658,30 @@\n+#if PLATFORM(JAVA)\n+std::optional<Style::ElementStyle> SliderContainerElement::resolveCustomStyle(const Style::ResolutionContext&, const RenderStyle* hostStyle)\n+{\n+    \/\/ This doesn't actually compute style. This is just a hack to pick shadow pseudo id when host style is known.\n+\n+    if (!hostStyle)\n+        return std::nullopt;\n+\n+    switch (hostStyle->effectiveAppearance()) {\n+    case MediaSliderPart:\n+    case MediaSliderThumbPart:\n+    case MediaVolumeSliderPart:\n+    case MediaVolumeSliderThumbPart:\n+    case MediaFullScreenVolumeSliderPart:\n+    case MediaFullScreenVolumeSliderThumbPart:\n+        m_shadowPseudoId = ShadowPseudoIds::webkitMediaSliderContainer();\n+        break;\n+    default:\n+        m_shadowPseudoId = ShadowPseudoIds::webkitSliderContainer();\n+    }\n+\n+    return std::nullopt;\n+}\n+\n+const AtomString& SliderContainerElement::shadowPseudoId() const\n+{\n+    return m_shadowPseudoId;\n+}\n+#endif\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/html\/shadow\/SliderThumbElement.cpp","additions":93,"deletions":1,"binary":false,"changes":94,"status":"modified"},{"patch":"@@ -62,0 +62,3 @@\n+#if PLATFORM(JAVA)\n+    RenderPtr<RenderElement> createElementRenderer(RenderStyle&&, const RenderTreePosition&) final;\n+#endif\n@@ -77,0 +80,3 @@\n+#if PLATFORM(JAVA)\n+    const AtomString& shadowPseudoId() const final;\n+#endif\n@@ -107,0 +113,12 @@\n+#if PLATFORM(JAVA)\n+class RenderSliderThumb final : public RenderBlockFlow {\n+    WTF_MAKE_ISO_ALLOCATED(RenderSliderThumb);\n+public:\n+    RenderSliderThumb(SliderThumbElement&, RenderStyle&&);\n+    void updateAppearance(const RenderStyle* parentStyle);\n+\n+private:\n+    bool isSliderThumb() const final;\n+};\n+#endif\n+\n@@ -117,0 +135,4 @@\n+#if PLATFORM(JAVA)\n+    std::optional<Style::ElementStyle> resolveCustomStyle(const Style::ResolutionContext&, const RenderStyle*) final;\n+    const AtomString& shadowPseudoId() const final;\n+#endif\n@@ -118,0 +140,3 @@\n+#if PLATFORM(JAVA)\n+    AtomString m_shadowPseudoId;\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/html\/shadow\/SliderThumbElement.h","additions":25,"deletions":0,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -51,0 +51,28 @@\n+#if PLATFORM(JAVA)\n+    SliderThumbHorizontalPart,\n+    SliderThumbVerticalPart,\n+    MediaControlsBackgroundPart,\n+    MediaControlsDarkBarBackgroundPart,\n+    MediaControlsFullscreenBackground,\n+    MediaControlsLightBarBackgroundPart,\n+    MediaCurrentTimePart,\n+    MediaEnterFullscreenButtonPart,\n+    MediaExitFullscreenButtonPart,\n+    MediaFullScreenVolumeSliderPart,\n+    MediaFullScreenVolumeSliderThumbPart,\n+    MediaMuteButtonPart,\n+    MediaOverlayPlayButtonPart,\n+    MediaPlayButtonPart,\n+    MediaReturnToRealtimeButtonPart,\n+    MediaRewindButtonPart,\n+    MediaSeekBackButtonPart,\n+    MediaSeekForwardButtonPart,\n+    MediaSliderPart,\n+    MediaSliderThumbPart,\n+    MediaTimeRemainingPart,\n+    MediaToggleClosedCaptionsButtonPart,\n+    MediaVolumeSliderPart,\n+    MediaVolumeSliderContainerPart,\n+    MediaVolumeSliderMuteButtonPart,\n+    MediaVolumeSliderThumbPart,\n+#endif\n@@ -77,0 +105,1 @@\n+#if !PLATFORM(JAVA)\n@@ -79,0 +108,1 @@\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/platform\/ThemeTypes.h","additions":30,"deletions":0,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -398,0 +398,19 @@\n+#if ENABLE(VIDEO)\n+    else if (part == MediaSliderThumbPart) {\n+        static int timeWidth = 0;\n+        static int timeHeight;\n+        if (timeWidth == 0) {\n+            getSliderThumbSize(JNI_EXPAND_MEDIA(SLIDER_TYPE_TIME), &timeWidth, &timeHeight);\n+        }\n+        style.setWidth(Length(timeWidth, LengthType::Fixed));\n+        style.setHeight(Length(timeHeight, LengthType::Fixed));\n+    } else if (part == MediaVolumeSliderThumbPart) {\n+        static int volumeWidth = 0;\n+        static int volumeHeight;\n+        if (volumeWidth == 0) {\n+            getSliderThumbSize(JNI_EXPAND_MEDIA(SLIDER_TYPE_VOLUME), &volumeWidth, &volumeHeight);\n+        }\n+        style.setWidth(Length(volumeWidth, LengthType::Fixed));\n+        style.setHeight(Length(volumeHeight, LengthType::Fixed));\n+    }\n+#endif\n@@ -514,0 +533,33 @@\n+bool RenderThemeJava::paintMediaSliderTrack(const RenderObject& renderObject, const PaintInfo& paintInfo, const IntRect& r)\n+{\n+    auto mediaElement = parentMediaElement(renderObject.node());\n+    if (mediaElement == nullptr)\n+        return false;\n+\n+    Ref<TimeRanges> timeRanges = mediaElement->buffered();\n+\n+    paintInfo.context().platformContext()->rq().freeSpace(4\n+        + 4                 \/\/ number of timeRange pairs\n+        + timeRanges->length() * 4 *2   \/\/ timeRange pairs\n+        + 4 + 4             \/\/ duration and currentTime\n+        + 4 + 4 + 4 + 4     \/\/ x, y, w, h\n+        )\n+    << (jint)com_sun_webkit_graphics_GraphicsDecoder_RENDERMEDIA_TIMETRACK\n+    << (jint)timeRanges->length();\n+\n+    \/\/utatodo: need [double] support\n+    for (unsigned i = 0; i < timeRanges->length(); i++) {\n+        paintInfo.context().platformContext()->rq()\n+        << (jfloat)timeRanges->start(i).releaseReturnValue() << (jfloat)timeRanges->end(i).releaseReturnValue();\n+    }\n+\n+    paintInfo.context().platformContext()->rq()\n+    << (jfloat)mediaElement->duration()\n+    << (jfloat)mediaElement->currentTime()\n+    << (jint)r.x() <<  (jint)r.y() << (jint)r.width() << (jint)r.height();\n+    return true;\n+}\n+bool RenderThemeJava::paintMediaSliderThumb(const RenderObject& renderObject, const PaintInfo& paintInfo, const IntRect& r)\n+{\n+    return paintMediaControl(JNI_EXPAND_MEDIA(TIME_SLIDER_THUMB), renderObject, paintInfo, r);\n+}\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/platform\/java\/RenderThemeJava.cpp","additions":52,"deletions":0,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -85,0 +85,2 @@\n+    bool paintMediaSliderTrack(const RenderObject&, const PaintInfo&, const IntRect&) override;\n+    bool paintMediaSliderThumb(const RenderObject&, const PaintInfo&, const IntRect&) override;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/platform\/java\/RenderThemeJava.h","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -241,0 +241,3 @@\n+#if PLATFORM(JAVA)\n+    virtual bool isSliderThumb() const { return false; }\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/rendering\/RenderObject.h","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -94,0 +94,14 @@\n+#if PLATFORM(JAVA)\n+void RenderSlider::layout()\n+{\n+    StackStats::LayoutCheckPoint layoutCheckPoint;\n+\n+    \/\/ FIXME: Find a way to cascade appearance. http:\/\/webkit.org\/b\/62535\n+    RenderBox* thumbBox = element().sliderThumbElement()->renderBox();\n+    if (thumbBox && thumbBox->isSliderThumb())\n+        static_cast<RenderSliderThumb*>(thumbBox)->updateAppearance(&style());\n+\n+    RenderFlexibleBox::layout();\n+}\n+#endif\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/rendering\/RenderSlider.cpp","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -51,0 +51,3 @@\n+#if PLATFORM(JAVA)\n+    void layout() override;\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/rendering\/RenderSlider.h","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -298,0 +298,3 @@\n+#if PLATFORM(JAVA)\n+    case MediaSliderPart:\n+#endif\n@@ -527,0 +530,6 @@\n+#if PLATFORM(JAVA)\n+    case MediaSliderPart:\n+        return paintMediaSliderTrack(box, paintInfo, integralSnappedRect);\n+    case MediaSliderThumbPart:\n+        return paintMediaSliderThumb(box, paintInfo, integralSnappedRect);\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/rendering\/RenderTheme.cpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -371,0 +371,5 @@\n+#if PLATFORM(JAVA)\n+    virtual bool paintMediaSliderTrack(const RenderObject&, const PaintInfo&, const IntRect&) { return true; }\n+    virtual bool paintMediaSliderThumb(const RenderObject&, const PaintInfo&, const IntRect&) { return true; }\n+#endif\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/rendering\/RenderTheme.h","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -40,1 +40,0 @@\n-import org.junit.Ignore;\n@@ -92,1 +91,0 @@\n-    @Ignore(\"JDK-8300954\")\n","filename":"modules\/javafx.web\/src\/test\/java\/test\/javafx\/scene\/web\/FormControlsTest.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}