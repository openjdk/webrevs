{"files":[{"patch":"@@ -32,0 +32,1 @@\n+#include <malloc.h>\n@@ -630,3 +631,0 @@\n-#define MAX_BUFFER (FILENAME_MAX+1)\n-    const wchar_t wname[MAX_BUFFER];\n-    const char data[MAX_BUFFER];\n@@ -637,2 +635,0 @@\n-    DWORD dwNameSize;\n-    DWORD dwDataValueSize;\n@@ -653,3 +649,1 @@\n-    if (ret != ERROR_SUCCESS ||\n-        dwMaxValueNameLen >= MAX_BUFFER ||\n-        dwMaxValueDataLen >= MAX_BUFFER) {\n+    if (ret != ERROR_SUCCESS) {\n@@ -659,0 +653,3 @@\n+    dwMaxValueNameLen++; \/* Account for NULL-terminator *\/\n+    wchar_t *wname = (wchar_t*)malloc(dwMaxValueNameLen * sizeof(wchar_t));\n+    wchar_t *data = (wchar_t*)malloc(dwMaxValueDataLen);\n@@ -660,3 +657,3 @@\n-        dwNameSize = MAX_BUFFER;\n-        dwDataValueSize = MAX_BUFFER;\n-        ret = RegEnumValueW(hkeyFonts, nval, (LPWSTR)wname, &dwNameSize,\n+        DWORD dwNameSize = dwMaxValueNameLen;\n+        DWORD dwDataValueSize = dwMaxValueDataLen;\n+        ret = RegEnumValueW(hkeyFonts, nval, wname, &dwNameSize,\n@@ -672,1 +669,1 @@\n-        if (!RegistryToBaseTTNameW((LPWSTR)wname) ) {\n+        if (!RegistryToBaseTTNameW(wname) ) {\n@@ -677,1 +674,1 @@\n-            LPWSTR dot = wcsrchr((LPWSTR)data, L'.');\n+            LPWSTR dot = wcsrchr(data, L'.');\n@@ -683,1 +680,1 @@\n-        registerFontW(fmi, fontToFileMap, (LPWSTR)wname, (LPWSTR)data);\n+        registerFontW(fmi, fontToFileMap, wname, data);\n@@ -686,0 +683,2 @@\n+    free(wname);\n+    free(data);\n","filename":"modules\/javafx.graphics\/src\/main\/native-font\/fontpath.c","additions":13,"deletions":14,"binary":false,"changes":27,"status":"modified"}]}