{"files":[{"patch":"@@ -85,0 +85,1 @@\n+\/\/ Iconified not considered here\n@@ -995,1 +996,2 @@\n-    notify_view_resize();\n+    \/\/notify_view_resize();\n+\n@@ -998,1 +1000,3 @@\n-    notify_view_move();\n+    if (frame_type == TITLED) {\n+        notify_view_move();\n+    }\n@@ -1049,5 +1053,3 @@\n-    GdkWindowState state = gdk_window_get_state(gdk_window);\n-\n-    notify_window_resize((state & GDK_WINDOW_STATE_MAXIMIZED)\n-                                ? com_sun_glass_events_WindowEvent_MAXIMIZE\n-                                : com_sun_glass_events_WindowEvent_RESIZE);\n+    notify_window_resize(is_maximized()\n+                            ? com_sun_glass_events_WindowEvent_MAXIMIZE\n+                            : com_sun_glass_events_WindowEvent_RESIZE);\n@@ -1071,7 +1073,1 @@\n-    GdkWindowState state = gdk_window_get_state(gdk_window);\n-\n-    if (state & GDK_WINDOW_STATE_ICONIFIED) {\n-        return;\n-    }\n-\n-    if (!event->send_event) {\n+    if (mapped && !event->send_event) {\n@@ -1081,3 +1077,12 @@\n-    int root_x, root_y, origin_x, origin_y;\n-    gdk_window_get_root_origin(gdk_window, &root_x, &root_y);\n-    gdk_window_get_origin(gdk_window, &origin_x, &origin_y);\n+    int x, y;\n+    bool view_moved = false;\n+\n+    if (frame_type == TITLED) {\n+        \/\/ view_x and view_y represent the position of the content relative to the left corner of the window,\n+        \/\/ taking into account window decorations (such as title bars and borders) applied by the window manager\n+        \/\/ and might vary by window state.\n+        int root_x, root_y;\n+        gdk_window_get_root_origin(gdk_window, &root_x, &root_y);\n+\n+        int view_x = event->x - root_x;\n+        int view_y = event->y - root_y;\n@@ -1085,6 +1090,12 @@\n-    \/\/ view_x and view_y represent the position of the content relative to the left corner of the window,\n-    \/\/ taking into account window decorations (such as title bars and borders) applied by the window manager\n-    \/\/ and might vary by window state.\n-    geometry.view_x = origin_x - root_x;\n-    geometry.view_y = origin_y - root_y;\n-    LOG(\"view x, y: %d, %d\\n\", geometry.view_x, geometry.view_y);\n+        x = root_x;\n+        y = root_y;\n+\n+        view_moved = view_x != geometry.view_x || view_y != geometry.view_y;\n+        geometry.view_x = view_x;\n+        geometry.view_y = view_y;\n+    } else {\n+        x = event->x;\n+        y = event->y;\n+    }\n+\n+    bool moved = (x != geometry.x) || (y != geometry.y);\n@@ -1104,0 +1115,1 @@\n+\n@@ -1105,2 +1117,2 @@\n-        geometry.x = root_x;\n-        geometry.y = root_y;\n+        geometry.x = x;\n+        geometry.y = y;\n@@ -1111,1 +1123,0 @@\n-    }\n@@ -1113,4 +1124,2 @@\n-    notify_window_resize((state & GDK_WINDOW_STATE_MAXIMIZED)\n-                            ? com_sun_glass_events_WindowEvent_MAXIMIZE\n-                            : com_sun_glass_events_WindowEvent_RESIZE);\n-    notify_view_resize();\n+        notify_window_move();\n+        notify_current_sizes();\n@@ -1118,2 +1127,4 @@\n-    notify_window_move();\n-    notify_view_move();\n+        if (view_moved) {\n+            notify_view_move();\n+        }\n+    }\n@@ -1190,0 +1201,4 @@\n+bool WindowContext::is_iconified() {\n+    return gdk_window_get_state(gdk_window) & GDK_WINDOW_STATE_ICONIFIED;\n+}\n+\n@@ -1244,2 +1259,3 @@\n-    \/\/ Ignore when maximized \/ fullscreen\n-    if (!is_floating()) {\n+    \/\/ Ignore when maximized \/ fullscreen (not floating)\n+    \/\/ Report back to java to correct the values\n+    if (mapped && !is_floating()) {\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.cpp","additions":50,"deletions":34,"binary":false,"changes":84,"status":"modified"},{"patch":"@@ -71,1 +71,1 @@\n-    x(), y(), view_x(), view_y(),\n+    x(-1), y(-1), view_x(0), view_y(0),\n@@ -73,1 +73,2 @@\n-    extents(), frame_extents_received(false),\n+    extents{0, 0, 0, 0},\n+    frame_extents_received(false),\n@@ -202,0 +203,1 @@\n+    bool is_iconified();\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.h","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}