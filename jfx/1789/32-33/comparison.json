{"files":[{"patch":"@@ -35,3 +35,1 @@\n-inline WindowContext* jlong_to_window_ctx(jlong ptr) {\n-    return reinterpret_cast<WindowContext*>(static_cast<intptr_t>(ptr));\n-}\n+#define JLONG_TO_WINDOW_CTX(ptr) ((WindowContext*)JLONG_TO_PTR(ptr))\n@@ -90,1 +88,1 @@\n-    WindowContext* parent = jlong_to_window_ctx(owner);\n+    WindowContext* parent = JLONG_TO_WINDOW_CTX(owner);\n@@ -97,1 +95,1 @@\n-        ? new WindowContextExtended(obj, parent, screen, frameType, type, wmFunctions)\n+        ? new WindowContextExtended(obj, parent, screen, wmFunctions)\n@@ -114,1 +112,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -129,1 +127,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -143,1 +141,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -158,1 +156,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -174,1 +172,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -189,1 +187,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -204,1 +202,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -219,1 +217,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -236,1 +234,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -252,1 +250,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -267,1 +265,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -282,1 +280,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -297,1 +295,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -316,1 +314,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -331,1 +329,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -346,1 +344,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -362,1 +360,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -377,1 +375,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -394,1 +392,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -411,1 +409,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -428,1 +426,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -450,1 +448,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -465,1 +463,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -480,1 +478,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -495,2 +493,2 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptrDialog);\n-    WindowContext* parent_ctx = jlong_to_window_ctx(ptrWindow);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptrDialog);\n+    WindowContext* parent_ctx = JLONG_TO_WINDOW_CTX(ptrWindow);\n@@ -511,1 +509,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -526,1 +524,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -541,1 +539,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -558,1 +556,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -573,1 +571,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n@@ -583,1 +581,1 @@\n-    WindowContext* ctx = jlong_to_window_ctx(ptr);\n+    WindowContext* ctx = JLONG_TO_WINDOW_CTX(ptr);\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/GlassWindow.cpp","additions":35,"deletions":37,"binary":false,"changes":72,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+char const * const GDK_WINDOW_DATA_EDGE = \"glass_window_edge\";\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_general.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -139,0 +139,1 @@\n+    extern char const * const GDK_WINDOW_DATA_EDGE;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_general.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -85,3 +85,3 @@\n-static gboolean is_window_floating(GdkWindowState state) {\n-    return !(state & GDK_WINDOW_STATE_MAXIMIZED)\n-        && !(state & GDK_WINDOW_STATE_FULLSCREEN);\n+static bool is_state_floating(GdkWindowState state) {\n+    return (state & GDK_WINDOW_STATE_MAXIMIZED) == 0\n+            && (state & GDK_WINDOW_STATE_FULLSCREEN) == 0;\n@@ -822,1 +822,1 @@\n-            if (!is_window_floating(gdk_window_get_state(gdk_window))) {\n+            if (!is_floating()) {\n@@ -1140,2 +1140,1 @@\n-    if (!is_window_floating(gdk_window_get_state(gdk_window))\n-        || !is_window_floating((GdkWindowState) initial_state_mask)) {\n+    if (!is_floating() || !is_state_floating((GdkWindowState) initial_state_mask)) {\n@@ -1186,0 +1185,12 @@\n+bool WindowContext::is_maximized() {\n+    return gdk_window_get_state(gdk_window) & GDK_WINDOW_STATE_MAXIMIZED;\n+}\n+\n+bool WindowContext::is_fullscreen() {\n+    return gdk_window_get_state(gdk_window) & GDK_WINDOW_STATE_FULLSCREEN;\n+}\n+\n+bool WindowContext::is_floating() {\n+    return is_state_floating(gdk_window_get_state(gdk_window));\n+}\n+\n@@ -1236,2 +1247,0 @@\n-    GdkWindowState state = gdk_window_get_state(gdk_window);\n-\n@@ -1239,1 +1248,1 @@\n-    if (!is_window_floating(state)) {\n+    if (!is_floating()) {\n@@ -1563,0 +1572,8 @@\n+\n+WindowContextExtended::WindowContextExtended(jobject jwin,\n+                                             WindowContext* owner,\n+                                             long screen,\n+                                             GdkWMFunction wmf)\n+                           : WindowContext(jwin, owner, screen, EXTENDED, NORMAL, wmf) {\n+}\n+\n@@ -1572,3 +1589,1 @@\n-    GdkWindowState state = gdk_window_get_state(get_gdk_window());\n-    bool is_maximized = (state & GDK_WINDOW_STATE_MAXIMIZED);\n-    if (is_maximized || get_frame_type() != EXTENDED || get_jwindow() == nullptr) {\n+    if (is_fullscreen() || get_frame_type() != EXTENDED || get_jwindow() == nullptr) {\n@@ -1586,1 +1601,1 @@\n-            set_maximized(!is_maximized);\n+            set_maximized(!is_maximized());\n@@ -1595,1 +1610,1 @@\n-        bool shouldStartResizeDrag = is_resizable() && !is_maximized && get_window_edge(event->x, event->y, &edge);\n+        bool shouldStartResizeDrag = is_resizable() && !is_maximized() && get_window_edge(event->x, event->y, &edge);\n@@ -1643,4 +1658,4 @@\n-    if (get_frame_type() != EXTENDED\n-        || !is_window_floating(gdk_window_get_state(get_gdk_window()))\n-        || !is_resizable()\n-        || !get_window_edge(event->x, event->y, &edge)) {\n+    if (!is_floating()\n+            || get_frame_type() != EXTENDED\n+            || !is_resizable()\n+            || !get_window_edge(event->x, event->y, &edge)) {\n@@ -1690,0 +1705,1 @@\n+    gint width, height;\n@@ -1692,0 +1708,2 @@\n+    width = geometry.width.view;\n+    height = geometry.height.view;\n@@ -1695,1 +1713,1 @@\n-        else if (y >= geometry.height.view - 2 * RESIZE_BORDER_WIDTH) edge = GDK_WINDOW_EDGE_SOUTH_WEST;\n+        else if (y >= height - 2 * RESIZE_BORDER_WIDTH) edge = GDK_WINDOW_EDGE_SOUTH_WEST;\n@@ -1697,1 +1715,1 @@\n-    } else if (x >= geometry.width.view - RESIZE_BORDER_WIDTH) {\n+    } else if (x >= width - RESIZE_BORDER_WIDTH) {\n@@ -1699,1 +1717,1 @@\n-        else if (y >= geometry.height.view - 2 * RESIZE_BORDER_WIDTH) edge = GDK_WINDOW_EDGE_SOUTH_EAST;\n+        else if (y >= height - 2 * RESIZE_BORDER_WIDTH) edge = GDK_WINDOW_EDGE_SOUTH_EAST;\n@@ -1703,1 +1721,1 @@\n-    } else if (y >= geometry.height.view - RESIZE_BORDER_WIDTH) {\n+    } else if (y >= height - RESIZE_BORDER_WIDTH) {\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.cpp","additions":40,"deletions":22,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -104,0 +104,1 @@\n+class WindowContextExtended;\n@@ -202,0 +203,3 @@\n+    bool is_maximized();\n+    bool is_fullscreen();\n+    bool is_floating();\n@@ -204,1 +208,0 @@\n-    bool grab_mouse_drag_focus();\n@@ -206,1 +209,0 @@\n-    void ungrab_mouse_drag_focus();\n@@ -254,1 +256,0 @@\n-    void update_initial_state();\n@@ -285,1 +286,0 @@\n-};\n@@ -287,1 +287,4 @@\n-class WindowContextExtended;\n+    void update_initial_state();\n+    bool grab_mouse_drag_focus();\n+    void ungrab_mouse_drag_focus();\n+};\n@@ -291,0 +294,1 @@\n+    WindowContextExtended() = delete;\n@@ -294,7 +298,1 @@\n-                          WindowFrameType frameType,\n-                          WindowType windowType,\n-                          GdkWMFunction wmf)\n-        : WindowContext(jwin, owner, screen, frameType, windowType, wmf)\n-    {\n-        LOG(\"WindowContextExtended\\n\")\n-    }\n+                          GdkWMFunction wmf);\n@@ -302,1 +300,0 @@\n-public:\n@@ -305,1 +302,3 @@\n-    bool get_window_edge(int x, int y, GdkWindowEdge*);\n+\n+private:\n+    bool get_window_edge(int, int, GdkWindowEdge*);\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.h","additions":13,"deletions":14,"binary":false,"changes":27,"status":"modified"}]}