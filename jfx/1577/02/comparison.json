{"files":[{"patch":"@@ -732,0 +732,18 @@\n+ext.IS_TEST_SDK = false\n+if (hasProperty(\"TEST_SDK_PATH\")) {\n+    if (!IS_TEST_ONLY) {\n+        fail(\"TEST_ONLY must be set to true when using an external TEST_SDK_PATH for running tests: include -PTEST_ONLY=true\")\n+    }\n+    def sdkShimsPath = file(\"${TEST_SDK_PATH}\")\n+    def sdkPath = file(\"${TEST_SDK_PATH}\/sdk\")\n+    def shimsPath = file(\"${TEST_SDK_PATH}\/shims\")\n+    if (!sdkShimsPath.exists() || !sdkShimsPath.isDirectory() ||\n+             !sdkPath.exists() || !sdkPath.isDirectory() ||\n+           !shimsPath.exists() || !shimsPath.isDirectory()) {\n+        fail(\"The provided TEST_SDK_PATH=${TEST_SDK_PATH} is invalid\")\n+    }\n+    ext.IS_TEST_SDK = true\n+} else {\n+    defineProperty(\"TEST_SDK_PATH\", \"${rootProject.buildDir}\")\n+}\n+\n@@ -985,1 +1003,1 @@\n-        def standaloneSdkDir = \"${rootProject.buildDir}\/${standaloneSdkDirName}\"\n+        def standaloneSdkDir = \"${TEST_SDK_PATH}\/${standaloneSdkDirName}\"\n@@ -1022,1 +1040,1 @@\n-                    dir = file(\"${rootProject.buildDir}\/shims\/${moduleName}\")\n+                    dir = file(\"${TEST_SDK_PATH}\/shims\/${moduleName}\")\n@@ -1024,1 +1042,1 @@\n-                    dir = file(\"${rootProject.buildDir}\/sdk\/lib\/${moduleName}.jar\")\n+                    dir = file(\"${TEST_SDK_PATH}\/sdk\/lib\/${moduleName}.jar\")\n@@ -1986,0 +2004,3 @@\n+task createRunArgFiles {\n+    \/\/ an empty task we can add to as needed\n+}\n@@ -2286,0 +2307,7 @@\n+\n+    test {\n+        if (IS_TEST_SDK) {\n+            logger.info \"Skipping VersionInfoTest when TEST_SDK_PATH is set.\"\n+            exclude(\"test\/com\/sun\/javafx\/runtime\/VersionInfoTest*\");\n+        }\n+    }\n@@ -2697,1 +2725,1 @@\n-        def cssDir = file(\"$buildDir\/classes\/java\/main\/${moduleName}\/javafx\")\n+        def cssDir = file(\"${TEST_SDK_PATH}\/shims\/${moduleName}\/javafx\")\n@@ -2786,1 +2814,1 @@\n-        def cssDir = file(\"$buildDir\/classes\/java\/main\/${moduleName}\/javafx\")\n+        def cssDir = file(\"${TEST_SDK_PATH}\/shims\/${moduleName}\/javafx\")\n@@ -2937,0 +2965,4 @@\n+    compileTestJava {\n+        if (IS_TEST_SDK) enabled = false\n+    }\n+\n@@ -4494,1 +4526,1 @@\n-                    !task.name.equals(\"validateSourceSets\")) {\n+                    !task.name.equals(\"validateSourceSets\") && !task.name.contains(\"buildRunArgs\")) {\n@@ -5058,1 +5090,1 @@\n-    def standaloneSdkDir = \"${rootProject.buildDir}\/${standaloneSdkDirName}\"\n+    def standaloneSdkDir = \"${TEST_SDK_PATH}\/${standaloneSdkDirName}\"\n@@ -5216,0 +5248,1 @@\n+    createRunArgFiles.dependsOn(buildRunArgsTask)\n@@ -5653,0 +5686,28 @@\n+    def buildSdkDir = \"${rootProject.buildDir}\/sdk\"\n+    def buildShimsDir = \"${rootProject.buildDir}\/shims\"\n+    def sdkShimZipTask = project.task(\"sdkShimsZip$t.capital\", type: Zip, group: \"Build\",\n+            dependsOn: [shims] ) {\n+\n+        def sdkShimsBundle = \"${platformPrefix}javafx-sdk-shims.zip\"\n+\n+        doFirst() {\n+            file(\"${rootProject.buildDir}\/${sdkShimsBundle}\").delete()\n+        }\n+\n+        if (IS_WINDOWS && IS_USE_CYGWIN) {\n+            dirPermissions { unix(0755) }\n+            filePermissions { unix(0755) }\n+        }\n+\n+        archiveFileName = sdkShimsBundle\n+        destinationDirectory = file(\"${rootProject.buildDir}\")\n+        includeEmptyDirs = false\n+        from (\"${buildSdkDir}\") {\n+            into \"sdk\"\n+        }\n+        from (\"${buildShimsDir}\") {\n+            into \"shims\"\n+        }\n+    }\n+    jdkZip.dependsOn(sdkShimZipTask)\n+\n@@ -5727,1 +5788,1 @@\n-                           dir = new File(rootProject.buildDir, \"shims\/${project.ext.moduleName}\")\n+                           dir = new File(TEST_SDK_PATH, \"shims\/${project.ext.moduleName}\")\n@@ -5729,1 +5790,1 @@\n-                           dir = new File(rootProject.buildDir, \"sdk\/lib\/${project.ext.moduleName}.jar\")\n+                           dir = new File(TEST_SDK_PATH, \"sdk\/lib\/${project.ext.moduleName}.jar\")\n@@ -5740,1 +5801,1 @@\n-                        dir = new File(rootProject.buildDir, \"sdk\/lib\/${project.ext.moduleName}.jar\")\n+                        dir = new File(TEST_SDK_PATH, \"sdk\/lib\/${project.ext.moduleName}.jar\")\n","filename":"build.gradle","additions":71,"deletions":10,"binary":false,"changes":81,"status":"modified"}]}