{"files":[{"patch":"@@ -31,1 +31,0 @@\n-import hat.Range;\n@@ -83,5 +82,23 @@\n-        private void setGlobalMesh(Range ndRange) {\n-            kernelBufferContext.gsx(ndRange.getX());\n-            kernelBufferContext.gsy(ndRange.getY());\n-            kernelBufferContext.gsz(ndRange.getZ());\n-            kernelBufferContext.dimensions(ndRange.getDims());\n+        private void setGlobalMesh(NDRange.Global global) {\n+            kernelBufferContext.gsy(1);\n+            kernelBufferContext.gsz(1);\n+            switch (global) {\n+                case NDRange.Global1D global1D -> {\n+                    kernelBufferContext.gsx(global1D.x());\n+                    kernelBufferContext.dimensions(global1D.dimension());\n+                }\n+                case NDRange.Global2D global2D -> {\n+                    kernelBufferContext.gsx(global2D.x());\n+                    kernelBufferContext.gsy(global2D.y());\n+                    kernelBufferContext.dimensions(global2D.dimension());\n+                }\n+                case NDRange.Global3D global3D -> {\n+                    kernelBufferContext.gsx(global3D.x());\n+                    kernelBufferContext.gsy(global3D.y());\n+                    kernelBufferContext.gsz(global3D.z());\n+                    kernelBufferContext.dimensions(global3D.dimension());\n+                }\n+                case null, default -> {\n+                    throw new IllegalArgumentException(\"Unknown global range \" + global.getClass());\n+                }\n+            }\n@@ -90,4 +107,23 @@\n-        private void setLocalMesh(Range NDRange) {\n-            kernelBufferContext.lsx(NDRange.getX());\n-            kernelBufferContext.lsy(NDRange.getY());\n-            kernelBufferContext.lsz(NDRange.getZ());\n+        private void setLocalMesh(NDRange.Local local) {\n+            kernelBufferContext.lsy(1);\n+            kernelBufferContext.lsz(1);\n+            switch (local) {\n+                case NDRange.Local1D local1D -> {\n+                    kernelBufferContext.lsx(local1D.x());\n+                    kernelBufferContext.dimensions(local1D.dimension());\n+                }\n+                case NDRange.Local2D local2D -> {\n+                    kernelBufferContext.lsx(local2D.x());\n+                    kernelBufferContext.lsy(local2D.y());\n+                    kernelBufferContext.dimensions(local2D.dimension());\n+                }\n+                case NDRange.Local3D local3D -> {\n+                    kernelBufferContext.lsx(local3D.x());\n+                    kernelBufferContext.lsy(local3D.y());\n+                    kernelBufferContext.lsz(local3D.z());\n+                    kernelBufferContext.dimensions(local3D.dimension());\n+                }\n+                case null, default -> {\n+                    throw new IllegalArgumentException(\"Unknown global range \" + local.getClass());\n+                }\n+            }\n@@ -103,1 +139,4 @@\n-            NDRange ndRange = kernelContext.getNdRange();\n+            NDRange ndRange = kernelContext.getNDRange();\n+            if (!(ndRange instanceof NDRange.Range range)) {\n+                throw new IllegalArgumentException(\"NDRange must be of type NDRange.Range\");\n+            }\n@@ -105,3 +144,2 @@\n-            Range globalMesh = ndRange.getGlobal();\n-            Range localMesh = ndRange.getLocal();\n-            setGlobalMesh(globalMesh);\n+            NDRange.Global global = range.global();\n+            setGlobalMesh(global);\n@@ -109,1 +147,1 @@\n-                setLocalMesh(localMesh);\n+                setLocalMesh(range.local());\n","filename":"hat\/backends\/ffi\/shared\/src\/main\/java\/hat\/backend\/ffi\/C99FFIBackend.java","additions":53,"deletions":15,"binary":false,"changes":68,"status":"modified"},{"patch":"@@ -1,53 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Global1D(int x) implements Range {\n-\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Global1D: \" + getX() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Global1D.java","additions":0,"deletions":53,"binary":false,"changes":53,"status":"deleted"},{"patch":"@@ -1,53 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Global2D(int x, int y) implements Range {\n-\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return y;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 2;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Global2D: \" + getX() + \",\" + getY() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Global2D.java","additions":0,"deletions":53,"binary":false,"changes":53,"status":"deleted"},{"patch":"@@ -1,52 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Global3D(int x, int y, int z) implements Range {\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return y;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return z;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 3;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Global3D: \" + getX() + \",\" + getY() + \".\" + getZ() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Global3D.java","additions":0,"deletions":52,"binary":false,"changes":52,"status":"deleted"},{"patch":"@@ -73,4 +73,21 @@\n-        this.gsx = ndRange.getGlobal().getX();\n-        this.gsy = ndRange.getGlobal().getY();\n-        this.gsz = ndRange.getGlobal().getZ();\n-        this.dimensions = ndRange.getGlobal().getDims();\n+        switch (ndRange) {\n+            case NDRange.NDRange1D ndRange1D -> {\n+                this.gsx = ndRange1D.global().x();\n+                this.gsy = 1;\n+                this.gsz = 1;\n+            }\n+            case NDRange.NDRange2D ndRange2D -> {\n+                this.gsx = ndRange2D.global().x();\n+                this.gsy = ndRange2D.global().y();\n+                this.gsz = 1;\n+            }\n+            case NDRange.NDRange3D ndRange3D -> {\n+                this.gsx = ndRange3D.global().x();\n+                this.gsy = ndRange3D.global().y();\n+                this.gsz = ndRange3D.global().z();\n+            }\n+            case null, default -> {\n+                throw new IllegalArgumentException(\"Unknown NDRange type: \"  + ndRange.getClass());\n+            }\n+        }\n+        this.dimensions = ndRange.dimension();\n@@ -120,1 +137,1 @@\n-    public NDRange getNdRange() {\n+    public NDRange getNDRange() {\n@@ -124,0 +141,6 @@\n+    private boolean isLocalDefined(NDRange.Local local) {\n+        return local != NDRange.EMPTY_LOCAL_1D\n+                && local != NDRange.EMPTY_LOCAL_2D\n+                && local != NDRange.EMPTY_LOCAL_3D;\n+    }\n+\n@@ -125,1 +148,8 @@\n-        return this.ndRange.getLocal() != null;\n+        switch (ndRange) {\n+            case NDRange.Range range -> {\n+                return (isLocalDefined(range.local()));\n+            }\n+            case null, default -> {\n+                throw new IllegalArgumentException(\"Unknown NDRange type: \"  + ndRange.getClass());\n+            }\n+        }\n","filename":"hat\/core\/src\/main\/java\/hat\/KernelContext.java","additions":36,"deletions":6,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -1,53 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Local1D(int x) implements Range {\n-\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Local1D: \" + getX() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Local1D.java","additions":0,"deletions":53,"binary":false,"changes":53,"status":"deleted"},{"patch":"@@ -1,53 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Local2D(int x, int y) implements Range {\n-\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return y;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return 1;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 2;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Local2D: \" + getX() + \",\" + getY() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Local2D.java","additions":0,"deletions":53,"binary":false,"changes":53,"status":"deleted"},{"patch":"@@ -1,52 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-public record Local3D(int x, int y, int z) implements Range {\n-    @Override\n-    public int getX() {\n-        return x;\n-    }\n-\n-    @Override\n-    public int getY() {\n-        return y;\n-    }\n-\n-    @Override\n-    public int getZ() {\n-        return z;\n-    }\n-\n-    @Override\n-    public int getDims() {\n-        return 3;\n-    }\n-\n-    @Override\n-    public String toString() {\n-        return \"<Local3D: \" + getX() + \",\" + getY() + \".\" + getZ() + \">\";\n-    }\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Local3D.java","additions":0,"deletions":52,"binary":false,"changes":52,"status":"deleted"},{"patch":"@@ -28,5 +28,6 @@\n- * A compute range holds the number of threads to run on an accelerator.\n- * A compute range has two main properties:\n- * - The global number of threads: this means the total number of threads to run per dimension.\n- * This is specified by instancing a new object of type {@link Range}.\n- * - A local group size: this is specified by instancing an object of type {@link Range}.\n+ * An NDRange specifies the number of threads to deploy on an hardware accelerator.\n+ * An NDRange has two main properties:\n+ * <ul>\n+ * <li>The global number of threads: this means the total number of threads to run per dimension.\n+ * This is specified by instancing a new object of type {@link Global}.<\/li>\n+ * <li>A local group size: this is specified by instancing an object of type {@link Local}.<\/li>\n@@ -35,0 +36,1 @@\n+ * <\/ul>\n@@ -36,17 +38,20 @@\n-public class NDRange {\n-\n-    \/**\n-     * Total number of threads to run in 1D.\n-     * @param global {@link Global1D}\n-     *\/\n-    public static NDRange of(Global1D global) {\n-        return new NDRange(global);\n-    }\n-\n-    \/**\n-     * Total number of threads to run in 1D for global and local mesh.\n-     * @param global {@link Global1D}\n-     * @param local {@link Local1D}\n-     *\/\n-    public static NDRange of(Global1D global, Local1D local) {\n-        return new NDRange(global, local);\n+public interface NDRange {\n+\n+    int dimension();\n+    interface _1D extends NDRange {\n+        @Override\n+        default int dimension() {\n+            return 1;\n+        }\n+    }\n+    interface _2D extends NDRange {\n+        @Override\n+        default int dimension() {\n+            return 2;\n+        }\n+    }\n+    interface _3D extends NDRange {\n+        @Override\n+        default int dimension() {\n+            return 3;\n+        }\n@@ -55,7 +60,2 @@\n-    \/**\n-     * Defines a compute range for a 2D mesh. The parameter specifies the\n-     * global mesh (total number of threads to run).\n-     * @param global {@link Global2D}\n-     *\/\n-    public static NDRange of(Global2D global) {\n-        return new NDRange(global);\n+    interface _1DX extends _1D {\n+        int x();\n@@ -64,8 +64,3 @@\n-    \/**\n-     * Defines a compute range for a 2D mesh. The parameters specify the\n-     * global mesh (total number of threads to run) and the local mesh.\n-     * @param global {@link Global2D}\n-     * @param local {@link Local2D}\n-     *\/\n-    public static NDRange of(Global2D global, Local2D local) {\n-        return new NDRange(global, local);\n+    interface _2DXY extends _2D {\n+        int x();\n+        int y();\n@@ -74,7 +69,4 @@\n-    \/**\n-     * Defines a compute range for a 3D mesh. The parameter specifies the\n-     * global mesh (total number of threads to run).\n-     * @param global {@link Global3D}\n-     *\/\n-    public static NDRange of(Global3D global) {\n-        return new NDRange(global);\n+    interface _3DXZ extends _3D {\n+        int x();\n+        int y();\n+        int z();\n@@ -83,8 +75,16 @@\n-    \/**\n-     * Defines a compute range for a 3D mesh. The parameters specify the\n-     * global mesh (total number of threads to run) and the local mesh.\n-     * @param global {@link Global3D}\n-     * @param local {@link Local3D}\n-     *\/\n-    public static NDRange of(Global3D global, Local3D local) {\n-        return new NDRange(global, local);\n+    interface Global {}\n+\n+    record Global1D(int x) implements _1DX, Global{\n+        public static Global1D of(int x) {\n+            return new Global1D(x);\n+        }\n+    }\n+    record Global2D(int x, int y) implements _2DXY, Global {\n+        public static Global2D of(int x, int y) {\n+            return new Global2D(x, y);\n+        }\n+    }\n+    record Global3D(int x, int y, int z) implements _3DXZ, Global {\n+        public static Global3D of(int x, int y, int z) {\n+            return new Global3D(x, y, z);\n+        }\n@@ -93,5 +93,1 @@\n-    \/**\n-     * Factory method to run a single thread on a target accelerator. Although for some accelerators this could be\n-     * beneficial (e.g., FPGAs), in general, use only for debugging purposes.\n-     *\/\n-    public static final NDRange SINGLE_THREADED = new NDRange(new Global1D(1));\n+    interface Local{}\n@@ -99,7 +95,14 @@\n-    \/**\n-     * Obtain the total number of threads per dimension. The number of threads\n-     * per dimension is stored in a {@link Range}\n-     * @return {@link Range}\n-     *\/\n-    public Range getGlobal() {\n-        return global;\n+    record Local1D(int x) implements _1DX, Local {\n+        public static Local of(int x) {\n+            return new Local1D(x);\n+        }\n+    }\n+    record Local2D(int x, int y) implements _2DXY, Local {\n+        public static Local of(int x, int y) {\n+            return new Local2D(x, y);\n+        }\n+    }\n+    record Local3D(int x, int y, int z) implements _3DXZ, Local {\n+        public static Local of(int x, int y, int z) {\n+            return new Local3D(x, y, z);\n+        }\n@@ -108,7 +111,3 @@\n-    \/**\n-     * Obtain the local group size per dimension. The group size per dimension is stored\n-     * in a {@link Range}.\n-     * @return {@link Range}\n-     *\/\n-    public Range getLocal() {\n-        return local;\n+    interface Range extends NDRange {\n+        Global global();\n+        Local local();\n@@ -117,2 +116,8 @@\n-    public boolean isSpecificRange() {\n-        return false;\n+    record NDRange1D(Global1D global, Local1D local) implements Range, _1D { }\n+\n+    record NDRange2D(Global2D global, Local2D local) implements Range, _2D { }\n+\n+    record NDRange3D(Global3D global, Local3D local) implements Range, _3D { }\n+\n+    static NDRange1D of(int x) {\n+        return new NDRange1D(new Global1D(x), NDRange.EMPTY_LOCAL_1D);\n@@ -121,7 +126,2 @@\n-    \/**\n-     * Utility method to create a 1D program with only global thread size.\n-     * @param numThreadsGlobal\n-     * @return {@link NDRange}\n-     *\/\n-    public static NDRange of(int numThreadsGlobal) {\n-        return new NDRange(new Global1D(numThreadsGlobal));\n+    static NDRange1D of(Global1D global) {\n+        return new NDRange1D(global, NDRange.EMPTY_LOCAL_1D);\n@@ -130,7 +130,2 @@\n-    \/**\n-     * Utility method to create a 1D program with global and local thread sizes.\n-     * @param numThreadsGlobal\n-     * @return {@link NDRange}\n-     *\/\n-    public static NDRange of(int numThreadsGlobal, int numThreadLocal) {\n-        return new NDRange(new Global1D(numThreadsGlobal), new Local1D(numThreadLocal));\n+    static NDRange1D of(Global1D global, Local1D local) {\n+        return new NDRange1D(global, local);\n@@ -139,2 +134,0 @@\n-    private final Range global;\n-    private final Range local;\n@@ -142,3 +135,2 @@\n-    private NDRange(Global1D global) {\n-        this.global = global;\n-        this.local = null;\n+    static NDRange2D of(Global2D global) {\n+        return new NDRange2D(global, NDRange.EMPTY_LOCAL_2D);\n@@ -147,3 +139,2 @@\n-    private NDRange(Global1D global, Local1D local) {\n-        this.global = global;\n-        this.local = local;\n+    static NDRange2D of(Global2D global, Local2D local) {\n+        return new NDRange2D(global, local);\n@@ -152,4 +143,0 @@\n-    private NDRange(Global2D global) {\n-        this.global = global;\n-        this.local = null;\n-    }\n@@ -157,3 +144,2 @@\n-    private NDRange(Global2D global, Local2D local) {\n-        this.global = global;\n-        this.local = local;\n+    static NDRange3D of(Global3D global) {\n+        return new NDRange3D(global, NDRange.EMPTY_LOCAL_3D);\n@@ -162,3 +148,2 @@\n-    private NDRange(Global3D global) {\n-        this.global = global;\n-        this.local = null;\n+    static NDRange3D of(Global3D global, Local3D local) {\n+        return new NDRange3D(global, local);\n@@ -167,4 +152,4 @@\n-    private NDRange(Global3D global, Local3D local) {\n-        this.global = global;\n-        this.local = local;\n-    }\n+    Local1D EMPTY_LOCAL_1D = new Local1D(0);\n+    Local2D EMPTY_LOCAL_2D = new Local2D(0, 0);\n+    Local3D EMPTY_LOCAL_3D = new Local3D(0, 0, 0);\n+\n","filename":"hat\/core\/src\/main\/java\/hat\/NDRange.java","additions":94,"deletions":109,"binary":false,"changes":203,"status":"modified"},{"patch":"@@ -1,58 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat;\n-\n-\/**\n- * Interface that specifies the number of threads per dimension.\n- * The Thread Mesh can be used to store the global number of threads,\n- * local group sizes and offsets.\n- *\/\n-public interface Range {\n-\n-    \/**\n-     * Obtain the number of threads in the first dimension of the thread-mesh.\n-     * @return\n-     *\/\n-    int getX();\n-\n-    \/**\n-     * Obtain the number of threads in the second dimension of the thread-mesh.\n-     * @return\n-     *\/\n-    int getY();\n-\n-    \/**\n-     * Obtain the number of threads in the third dimension of the thread-mesh.\n-     * @return\n-     *\/\n-    int getZ();\n-\n-    \/**\n-     * Return the mesh dimension. It could be 1, 2 or 3.\n-     * @return int value\n-     *\/\n-    int getDims();\n-\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/Range.java","additions":0,"deletions":58,"binary":false,"changes":58,"status":"deleted"},{"patch":"@@ -31,1 +31,0 @@\n-import hat.Global1D;\n@@ -33,1 +32,0 @@\n-import hat.Local1D;\n@@ -88,1 +86,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(16));\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/LocalArray.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -32,1 +31,0 @@\n-import hat.Local1D;\n@@ -68,1 +66,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(BLOCK_SIZE));\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/LocalIds.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -32,1 +31,0 @@\n-import hat.Local1D;\n@@ -138,1 +136,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(16));\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/Reduction.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-import hat.Global1D;\n-import hat.Global2D;\n@@ -33,2 +31,0 @@\n-import hat.Local1D;\n-import hat.Local2D;\n@@ -509,1 +505,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(globalSize), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(globalSize), new NDRange.Local1D(16));\n@@ -519,1 +515,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size), new NDRange.Local1D(16));\n@@ -527,1 +523,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -535,1 +531,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -543,1 +539,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -551,1 +547,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(256, 256), new Local2D(16, 16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(256, 256), new NDRange.Local2D(16, 16));\n@@ -559,1 +555,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(256, 256), new Local2D(16, 16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(256, 256), new NDRange.Local2D(16, 16));\n","filename":"hat\/examples\/matmul\/src\/main\/java\/matmul\/Main.java","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-        cc.dispatchKernel(NDRange.of(s32Array.length()),\n+        cc.dispatchKernel(NDRange.of(NDRange.Global1D.of(s32Array.length())),\n","filename":"hat\/examples\/squares\/src\/main\/java\/squares\/Main.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import hat.Global1D;\n@@ -334,1 +333,1 @@\n-                    .forEachInRange(accelerator.range(NDRange.of(new Global1D(scaleTable.multiScaleAccumulativeRange()))), kc -> {\n+                    .forEachInRange(accelerator.range(NDRange.of(new NDRange.Global1D(scaleTable.multiScaleAccumulativeRange()))), kc -> {\n","filename":"hat\/examples\/violajones\/src\/main\/java\/violajones\/attic\/ViolaJones.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -62,1 +61,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(array.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(array.length()));\n@@ -79,1 +78,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(arrayA.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(arrayA.length()));\n@@ -97,1 +96,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(arrayA.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(arrayA.length()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestArrays.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -58,1 +57,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(arrayA.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(arrayA.length()));\n@@ -108,1 +107,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(arrayA.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(arrayA.length()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestConstants.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -120,1 +119,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(NDRange.Global1D.of(a.length()));\n@@ -126,1 +125,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(a.length()));\n@@ -132,1 +131,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(a.length()));\n@@ -138,1 +137,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(a.length()));\n@@ -144,1 +143,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(a.length()));\n@@ -150,1 +149,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(a.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(a.length()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestF16Type.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -32,1 +31,0 @@\n-import hat.Local1D;\n@@ -77,1 +75,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(16));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestLocal.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -69,1 +68,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(s32Array2D.width() & s32Array2D.height()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(s32Array2D.width() & s32Array2D.height()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestMandel.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-import hat.Global1D;\n-import hat.Global2D;\n@@ -33,2 +31,0 @@\n-import hat.Local1D;\n-import hat.Local2D;\n@@ -198,1 +194,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(globalSize), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(globalSize), new NDRange.Local1D(16));\n@@ -208,1 +204,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size));\n@@ -216,1 +212,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -224,1 +220,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -232,1 +228,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -240,1 +236,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(globalSize, globalSize), new Local2D(BLOCK_SIZE, BLOCK_SIZE));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(globalSize, globalSize), new NDRange.Local2D(BLOCK_SIZE, BLOCK_SIZE));\n@@ -743,1 +739,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(256, 256), new Local2D(16, 16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(256, 256), new NDRange.Local2D(16, 16));\n@@ -751,1 +747,1 @@\n-        NDRange ndRange = NDRange.of(new Global2D(256, 256), new Local2D(16, 16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global2D(256, 256), new NDRange.Local2D(16, 16));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestMatMul.java","additions":8,"deletions":12,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -109,1 +108,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(universe.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(universe.length()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestNbody.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -74,1 +73,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(data.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(data.length()));\n@@ -80,1 +79,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(data.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(data.length()));\n@@ -86,1 +85,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(data.length()));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(data.length()));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestParenthesis.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -76,1 +75,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestPrivate.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -32,1 +31,0 @@\n-import hat.Local1D;\n@@ -130,1 +128,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(16));\n@@ -137,1 +135,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(32), new Local1D(16));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(32), new NDRange.Local1D(16));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestReductions.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.Global1D;\n@@ -32,1 +31,0 @@\n-import hat.Local1D;\n@@ -269,1 +267,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4), new Local1D(128));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4), new NDRange.Local1D(128));\n@@ -276,1 +274,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -283,1 +281,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -290,1 +288,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -297,1 +295,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -304,1 +302,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -312,1 +310,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -319,1 +317,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -326,1 +324,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -333,1 +331,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -340,1 +338,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -347,1 +345,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -354,1 +352,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n@@ -361,1 +359,1 @@\n-        NDRange ndRange = NDRange.of(new Global1D(size\/4));\n+        NDRange ndRange = NDRange.of(new NDRange.Global1D(size\/4));\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestVectorTypes.java","additions":14,"deletions":16,"binary":false,"changes":30,"status":"modified"}]}