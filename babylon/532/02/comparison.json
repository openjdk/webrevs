{"files":[{"patch":"@@ -739,0 +739,3 @@\n+            if (targetType.hasTag(TypeTag.VOID)) {\n+                return sourceValue;\n+            }\n@@ -1033,0 +1036,4 @@\n+                    } else if (isQuoted && top.localToOp.containsKey(sym)) {\n+                        \/\/ if we are scanning a quotable lambda\n+                        \/\/ and the field being loaded is registered as constant capture, load the associated VarOp result\n+                        result = loadVar(sym);\n@@ -1481,0 +1488,1 @@\n+            Type lambdaReturnType = tree.getDescriptorType(types).getReturnType();\n@@ -1482,2 +1490,2 @@\n-                Value exprVal = toValue(((JCExpression) tree.body), tree.getDescriptorType(types).getReturnType());\n-                if (!tree.body.type.hasTag(TypeTag.VOID)) {\n+                Value exprVal = toValue(((JCExpression) tree.body), lambdaReturnType);\n+                if (!lambdaReturnType.hasTag(TypeTag.VOID)) {\n@@ -1491,1 +1499,1 @@\n-                    bodyTarget = tree.getDescriptorType(types).getReturnType();\n+                    bodyTarget = lambdaReturnType;\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/internal\/ReflectMethods.java","additions":11,"deletions":3,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -254,0 +254,15 @@\n+\n+    static final int Z = 42;\n+    @IR(\"\"\"\n+            func @\"f\" (%0 : Var<java.type:\"int\">)java.type:\"void\" -> {\n+                %1 : java.type:\"QuotableSubtypeTest$QuotableRunnable\" = lambda ()java.type:\"void\" -> {\n+                    %2 : java.type:\"int\" = var.load %0;\n+                    %3 : Var<java.type:\"int\"> = var %2 @\"x\";\n+                    return;\n+                };\n+                return;\n+            };\n+            \"\"\")\n+    static QuotableRunnable QUOTED_CAPTURE_FINAL_STATIC_FIELD = () -> {\n+        int x = Z;\n+    };\n","filename":"test\/langtools\/tools\/javac\/reflect\/QuotableSubtypeTest.java","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"}]}