{"files":[{"patch":"@@ -128,0 +128,1 @@\n+\n@@ -129,7 +130,5 @@\n-        static public void compute(final ComputeContext computeContext, Viewer viewer, Control control, CellGrid cellGrid) {\n-            long start = System.currentTimeMillis();\n-            int generation = 0;\n-            while (true) {\n-                computeContext.dispatchKernel(\n-                        cellGrid.width() * cellGrid.height(),\n-                        kc -> Compute.life(kc, control, cellGrid)\n+        static public void compute(final ComputeContext cc, Viewer viewer, Control ctrl, CellGrid grid) {\n+            while (viewer.isVisible()) {\n+                cc.dispatchKernel(\n+                        grid.width() * grid.height(),\n+                        kc -> Compute.life(kc, ctrl, grid)\n@@ -137,5 +136,4 @@\n-                int to = control.from();control.from(control.to());control.to(to); \/\/swap from\/to\n-                viewer.setGeneration(generation++, System.currentTimeMillis() - start);\n-             \/\/   if (generation % 50 == 0) {\n-                    viewer.update(cellGrid, to);\n-              \/\/  }\n+                int to = ctrl.from(); ctrl.from(ctrl.to()); ctrl.to(to); \/\/swap from\/to\n+                if (viewer.isReadyForUpdate()) {\n+                    viewer.update(grid, to);\n+                }\n","filename":"hat\/examples\/life\/src\/main\/java\/life\/Main.java","additions":10,"deletions":12,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -160,5 +160,1 @@\n-    void setGeneration(int generation, float ms){\n-        this.generation.setText(String.format(\"%8d\",generation));\n-        this.generationsPerSecond.setText(String.format(\"%5.2f\",(generation*1000)\/ms));\n-        mainPanel.repaint();\n-    }\n+\n@@ -178,1 +174,1 @@\n-        this.setGeneration(0,0);\n+\n@@ -199,0 +195,17 @@\n+     long start=0L;\n+    int generationCounter=0;\n+    public boolean isVisible(){\n+        return true;\n+    }\n+    public boolean isReadyForUpdate(){\n+        if (start==0L) {\n+            start = System.currentTimeMillis();\n+        }else {\n+            this.generation.setText(String.format(\"%8d\", ++generationCounter));\n+            this.generationsPerSecond.setText(\n+                    String.format(\"%5.2f\", (generationCounter * 1000f) \/ (System.currentTimeMillis() - start))\n+            );\n+            mainPanel.repaint();\n+        }\n+        return true;\n+    }\n","filename":"hat\/examples\/life\/src\/main\/java\/life\/Viewer.java","additions":19,"deletions":6,"binary":false,"changes":25,"status":"modified"}]}