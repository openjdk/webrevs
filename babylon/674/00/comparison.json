{"files":[{"patch":"@@ -29,1 +29,1 @@\n-public interface F16 extends Buffer.Struct {\n+public interface F16 {\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F16.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import jdk.incubator.code.dialect.java.ClassType;\n@@ -33,1 +34,8 @@\n-    F16 array(long index);\n+    F16Impl array(long index);\n+\n+    interface F16Impl extends Buffer, F16 {\n+        String NAME = \"F16Impl\";\n+\n+        short value();\n+        void value(short value);\n+    }\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F16Array.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import hat.buffer.F16;\n@@ -53,0 +54,2 @@\n+import static hat.buffer.F16Array.F16Impl;\n+\n@@ -86,1 +89,4 @@\n-        }else if (javaType instanceof ClassType classType && classType.toClassName().equals(\"hat.KernelContext\")){\n+        } else if (javaType instanceof ClassType classType && classType.toClassName().equals(F16.class.getCanonicalName())) {\n+            \/\/ Check for special types (e.g., FP16)\n+            globalPtrPrefix().suffix_t(F16Impl.NAME).asterisk();\n+        } else if (javaType instanceof ClassType classType && classType.toClassName().equals(\"hat.KernelContext\")) {\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/C99HATKernelBuilder.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import hat.buffer.F16Array;\n@@ -343,1 +344,1 @@\n-        return ifaceType.iface.getName().equals(F16.class.getName());\n+        return (ifaceType.iface.getName().equals(F16.class.getName()) || ifaceType.iface.getName().equals(F16Array.F16Impl.class.getName()));\n@@ -438,1 +439,2 @@\n-        if (OpTk.isIfaceBufferMethod(buildContext.lookup, invokeOp)) {\n+        if (OpTk.isIfaceBufferMethod(buildContext.lookup, invokeOp)\n+                || invokeOp.invokeDescriptor().refType().toString().equals(F16.class.getCanonicalName())) {\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/HATCodeBuilderWithContext.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import hat.buffer.F16;\n@@ -241,1 +242,2 @@\n-        return isAssignable(lookup, javaRefType(invokeOp), MappableIface.class);\n+        return (isAssignable(lookup, javaRefType(invokeOp), MappableIface.class) ||\n+                invokeOp.invokeDescriptor().refType().toString().equals(F16.class.getCanonicalName()));\n","filename":"hat\/core\/src\/main\/java\/hat\/optools\/OpTk.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -75,1 +75,2 @@\n-            Arrays.stream(klass.getInterfaces()).forEach(interfaceClass -> inspectNewLevel(interfaceClass, interfaceSet));\n+            Arrays.stream(klass.getInterfaces())\n+                    .forEach(interfaceClass -> inspectNewLevel(interfaceClass, interfaceSet));\n@@ -81,2 +82,2 @@\n-    default void inspectNewLevel(Class<?> interaceClass, Set<Class<?>> interfaceSet) {\n-        if (interfaceSet.add(interaceClass)) {\n+    default void inspectNewLevel(Class<?> interfaceClass, Set<Class<?>> interfaceSet) {\n+        if (interfaceClass != null && interfaceSet.add(interfaceClass)) {\n@@ -84,1 +85,2 @@\n-            Arrays.stream(interaceClass.getInterfaces()).forEach(superInterface -> inspectNewLevel(superInterface, interfaceSet));\n+            Arrays.stream(interfaceClass.getInterfaces())\n+                    .forEach(superInterface -> inspectNewLevel(superInterface, interfaceSet));\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATDialect.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import hat.buffer.F16Array;\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATDialectifyFP16Phase.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import hat.NDRange;\n@@ -75,1 +76,1 @@\n-        Set<Class<?>> interfaces = Set.of();\n+        Set<Class<?>> interfaces;\n@@ -80,0 +81,1 @@\n+            return false;\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATDialectifyVectorSelectPhase.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import hat.buffer.F16;\n@@ -72,0 +73,4 @@\n+                    if (!isMappableType) {\n+                        \/\/ Special types?\n+                        isMappableType = OpTk.isAssignable(MethodHandles.lookup(), javaType, F16.class);\n+                    }\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATFinalDetectionPhase.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -39,1 +39,0 @@\n-import hat.test.engine.HATAssertionError;\n@@ -42,1 +41,0 @@\n-import hat.test.engine.HATTestException;\n@@ -46,1 +44,0 @@\n-import java.lang.reflect.InvocationTargetException;\n@@ -52,14 +49,0 @@\n-\/\/    @Kernel(\"\"\"\n-\/\/            HAT_KERNEL void copy01(\n-\/\/                HAT_GLOBAL_MEM KernelContext_t* kernelContext,\n-\/\/                HAT_GLOBAL_MEM F16Array_t* a,\n-\/\/                HAT_GLOBAL_MEM F16Array_t* b\n-\/\/            ){\n-\/\/                if(HAT_GIX<HAT_GSX){\n-\/\/                    HAT_GLOBAL_MEM F16_t* ha = &a->array[(long)HAT_GIX];\n-\/\/                    HAT_GLOBAL_MEM F16_t* hb = &b->array[(long)HAT_GIX];\n-\/\/                    (&b->array[(long)HAT_GIX])->value=ha->value;\n-\/\/                }\n-\/\/                return;\n-\/\/            }\n-\/\/            \"\"\")\n@@ -69,2 +52,0 @@\n-            F16 hb = b.array(kernelContext.gix);\n-            \/\/ The following expression does not work\n@@ -72,1 +53,0 @@\n-            \/\/hb.value(ha.value());\n@@ -165,1 +145,1 @@\n-    private interface MyLocalArray extends Buffer {\n+    interface MyLocalArray extends Buffer {\n@@ -168,0 +148,1 @@\n+\n@@ -174,0 +155,1 @@\n+\n@@ -188,0 +170,1 @@\n+            kernelContext.barrier();\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestF16Type.java","additions":4,"deletions":21,"binary":false,"changes":25,"status":"modified"}]}