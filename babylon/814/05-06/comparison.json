{"files":[{"patch":"@@ -54,0 +54,1 @@\n+                    \/\/ remove the \"array\" field from the fields\n","filename":"hat\/core\/src\/main\/java\/hat\/dialect\/HATPtrOp.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -49,1 +49,0 @@\n-\n@@ -62,1 +61,1 @@\n-                        if (invoke.namedIgnoreCase(\"add\",\"sub\",\"mull\",\"div\")) {\n+                        if (invoke.namedIgnoreCase(\"add\",\"sub\",\"mul\",\"div\")) {\n@@ -67,2 +66,1 @@\n-                                    invoke.varOpFromFirstUseOrThrow().varName(),\n-                                   \/\/ varNameFromInvokeFirstUseOrThrow(invoke),\n+                                    invoke.varOpFromFirstUseOrThrow().varName(), \/\/ varNameFromInvokeFirstUseOrThrow(invoke)\n@@ -117,2 +115,1 @@\n-                                                blockBuilder.context().getValueOrDefault(replaced.get(r), replaced.get(r)))\n-                                             \/\/   getValue(blockBuilder, replaced.get(r)))\n+                                                blockBuilder.context().getValue(replaced.get(r))) \/\/ getValue(blockBuilder, replaced.get(r)))\n@@ -133,1 +130,1 @@\n-                                Op vop = opFromFirstOperandOrThrow(buffer.op());\/\/resultFromFirstOperandOrNull(buffer.op())).op();\n+                                Op vop = opFromFirstOperandOrThrow(buffer.op()); \/\/ resultFromFirstOperandOrNull(buffer.op())).op();\n@@ -136,1 +133,1 @@\n-                                    case VarLikeOp varLikeOp -> varLikeOp.varName();\/\/   HATMemoryVarOp.HATLocalVarOp &&  HATMemoryVarOp.HATPrivateVarOp\n+                                    case VarLikeOp varLikeOp -> varLikeOp.varName(); \/\/ HATMemoryVarOp.HATLocalVarOp &&  HATMemoryVarOp.HATPrivateVarOp\n@@ -211,1 +208,1 @@\n-                        HATPhaseUtils.isBufferArray(arrayLengthOp) && OpHelper.resultFromFirstOperandOrThrow(arrayLengthOp) instanceof Op.Result ->{\n+                        HATPhaseUtils.isBufferArray(arrayLengthOp) && OpHelper.resultFromFirstOperandOrThrow(arrayLengthOp) != null ->{\n@@ -233,9 +230,0 @@\n-    public static String hatPtrName(Op op) {\n-        return switch (op) {\n-            case CoreOp.VarOp varOp -> varOp.varName();\n-            case HATMemoryVarOp.HATLocalVarOp hatLocalVarOp -> hatLocalVarOp.varName();\n-            case HATMemoryVarOp.HATPrivateVarOp hatPrivateVarOp -> hatPrivateVarOp.varName();\n-            case null, default -> \"\";\n-        };\n-    }\n-\n@@ -274,1 +262,2 @@\n-            return new ArrayAccessInfo(buffer, indices);\n+            String bufferName = hatPtrName(resultFromFirstOperandOrNull(buffer.op()).op());\n+            return new ArrayAccessInfo(buffer, bufferName, indices);\n@@ -278,1 +267,8 @@\n-\n+    public static String hatPtrName(Op op) {\n+        return switch (op) {\n+            case CoreOp.VarOp varOp -> varOp.varName();\n+            case HATMemoryVarOp.HATLocalVarOp hatLocalVarOp -> hatLocalVarOp.varName();\n+            case HATMemoryVarOp.HATPrivateVarOp hatPrivateVarOp -> hatPrivateVarOp.varName();\n+            case null, default -> \"\";\n+        };\n+    }\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATArrayViewPhase.java","additions":16,"deletions":20,"binary":false,"changes":36,"status":"modified"}]}