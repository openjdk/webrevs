{"files":[{"patch":"@@ -49,2 +49,0 @@\n-\n-    default BF16Impl[] arrayview() {return null;}\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/BF16Array.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -594,2 +594,2 @@\n-    public final T ptrAccess(ScopedCodeBuilderContext builderContext, HATPtrOp hatPtrOp) {\n-        identifier(hatPtrName(hatPtrOp));\n+    private T ptrAccess(ScopedCodeBuilderContext builderContext, HATPtrOp hatPtrOp) {\n+        identifier(hatPtrOp.name());\n@@ -614,1 +614,1 @@\n-                        asterisk().identifier(hatPtrName(hatPtrOp));\n+                        asterisk().identifier(hatPtrOp.name());\n@@ -626,10 +626,0 @@\n-    public final String hatPtrName(HATPtrOp hatPtrOp) {\n-        Op op = ((Op.Result) ((Op.Result) (hatPtrOp.operands().getFirst())).op().operands().getFirst()).op();\n-        return switch (op) {\n-            case CoreOp.VarOp varOp -> varOp.varName();\n-            case HATMemoryVarOp.HATLocalVarOp hatLocalVarOp -> hatLocalVarOp.varName();\n-            case HATMemoryVarOp.HATPrivateVarOp hatPrivateVarOp -> hatPrivateVarOp.varName();\n-            case null, default -> \"\";\n-        };\n-    }\n-\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/C99HATKernelBuilder.java","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+    private final String name;\n@@ -53,3 +54,1 @@\n-                    retValue = retValue.isEmpty()\n-                            ?retValue\n-                            :retValue.subList(0, retValue.size() - 1); \/\/ is this intended to drop the last one?\n+                    if (!retValue.isEmpty()) retValue = retValue.subList(0, retValue.size() - 1); \/\/ is this intended to drop the last one?\n@@ -63,1 +62,1 @@\n-    public HATPtrOp(TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n+    public HATPtrOp(String name, TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n@@ -68,0 +67,1 @@\n+        this.name = name;\n@@ -75,0 +75,1 @@\n+        this.name = op.name;\n@@ -86,0 +87,4 @@\n+    public String name() {\n+        return name;\n+    }\n+\n@@ -95,2 +100,2 @@\n-        public HATPtrStoreOp(TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n-            super(resultType, bufferClass, operands);\n+        public HATPtrStoreOp(String name, TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n+            super(name, resultType, bufferClass, operands);\n@@ -119,2 +124,2 @@\n-        public HATPtrLoadOp(TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n-            super(resultType, bufferClass, operands);\n+        public HATPtrLoadOp(String name, TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n+            super(name, resultType, bufferClass, operands);\n@@ -142,2 +147,2 @@\n-        public HATPtrLengthOp(TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n-            super(resultType, bufferClass, operands);\n+        public HATPtrLengthOp(String name, TypeElement resultType, Class<?> bufferClass, List<Value> operands) {\n+            super(name, resultType, bufferClass, operands);\n","filename":"hat\/core\/src\/main\/java\/hat\/dialect\/HATPtrOp.java","additions":15,"deletions":10,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -150,0 +150,1 @@\n+                                        arrayAccessInfo.bufferName(),\n@@ -188,0 +189,1 @@\n+                                        arrayAccessInfo.bufferName(),\n@@ -205,0 +207,1 @@\n+                                    arrayAccessInfo.bufferName(),\n@@ -226,1 +229,10 @@\n-    record ArrayAccessInfo(Op.Result buffer, List<Op.Result> indices) {\n+    public static String hatPtrName(Op op) {\n+        return switch (op) {\n+            case CoreOp.VarOp varOp -> varOp.varName();\n+            case HATMemoryVarOp.HATLocalVarOp hatLocalVarOp -> hatLocalVarOp.varName();\n+            case HATMemoryVarOp.HATPrivateVarOp hatPrivateVarOp -> hatPrivateVarOp.varName();\n+            case null, default -> \"\";\n+        };\n+    }\n+\n+    record ArrayAccessInfo(Op.Result buffer, String bufferName, List<Op.Result> indices) {\n@@ -258,1 +270,2 @@\n-            return new ArrayAccessInfo(buffer, indices);\n+            String bufferName = hatPtrName(((Op.Result) firstOperand(buffer.op())).op());\n+            return new ArrayAccessInfo(buffer, bufferName, indices);\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATArrayViewPhase.java","additions":15,"deletions":2,"binary":false,"changes":17,"status":"modified"}]}