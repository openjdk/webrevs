{"files":[{"patch":"@@ -59,0 +59,1 @@\n+import jdk.incubator.code.dialect.core.CoreOp;\n@@ -91,0 +92,24 @@\n+    \/**\n+     * Skip constant conditional branch transformation.\n+     * This is a custom optimization focused on redundant conditional branches,\n+     * particularly in lowered pattern matching for switch statements.\n+     * It skips intermediate conditional branch with constant boolean argument and re-targets\n+     * directly to the true or false branch, based on the argument's constant value.\n+     *\/\n+    private static CodeTransformer SKIP_CBRANCH_TRANSFORM = (block, op) -> {\n+        if (op instanceof BranchOp bo\n+                && bo.branch().arguments().size() == 1\n+                && bo.branch().arguments().getFirst() instanceof Op.Result or\n+                && or.type().equals(JavaType.BOOLEAN)\n+                && or.op() instanceof ConstantOp cop\n+                && bo.branch().targetBlock().ops().size() == 1\n+                && bo.branch().targetBlock().terminatingOp() instanceof ConditionalBranchOp cbo\n+                && ((Boolean)cop.value() ? cbo.trueBranch() : cbo.falseBranch()) instanceof Block.Reference br\n+                && br.arguments().isEmpty()) {\n+            block.op(CoreOp.branch(block.context().getSuccessorOrCreate(br)));\n+        } else {\n+            block.op(op);\n+        }\n+        return block;\n+    };\n+\n@@ -175,1 +200,2 @@\n-                O lowered = (O)e.getValue().transform(CodeContext.create(), lowering);\n+                O lowered = (O)e.getValue().transform(CodeContext.create(), lowering)\n+                                           .transform(CodeContext.create(), SKIP_CBRANCH_TRANSFORM);\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/bytecode\/BytecodeGenerator.java","additions":27,"deletions":1,"binary":false,"changes":28,"status":"modified"}]}