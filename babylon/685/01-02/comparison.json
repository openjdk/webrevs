{"files":[{"patch":"@@ -29,0 +29,1 @@\n+import jdk.incubator.code.CodeReflection;\n@@ -31,1 +32,0 @@\n-import jdk.incubator.code.Quotable;\n@@ -83,1 +83,2 @@\n-    public interface IfBody<T> extends Quotable {\n+    @CodeReflection\n+    public interface IfBody<T> {\n@@ -92,1 +93,3 @@\n-    public interface LoopBody<T> extends Quotable {\n+\n+    @CodeReflection\n+    public interface LoopBody<T> {\n","filename":"cr-examples\/onnx\/src\/main\/java\/oracle\/code\/onnx\/ExplicitOnnxOperators.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -441,1 +441,2 @@\n-    public interface OnnxFunction<T> extends Supplier<T>, Quotable {\n+    @CodeReflection\n+    public interface OnnxFunction<T> extends Supplier<T> {\n","filename":"cr-examples\/onnx\/src\/main\/java\/oracle\/code\/onnx\/OnnxRuntime.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -39,0 +39,1 @@\n+import jdk.incubator.code.CodeReflection;\n@@ -40,1 +41,0 @@\n-import jdk.incubator.code.Quotable;\n@@ -167,1 +167,2 @@\n-    public interface QuotableComputeContextConsumer extends Quotable, Consumer<ComputeContext> {\n+    @CodeReflection\n+    public interface QuotableComputeContextConsumer extends Consumer<ComputeContext> {\n","filename":"hat\/core\/src\/main\/java\/hat\/Accelerator.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+import jdk.incubator.code.CodeReflection;\n@@ -36,1 +37,0 @@\n-import jdk.incubator.code.Quotable;\n@@ -176,1 +176,2 @@\n-    public interface QuotableKernelContextConsumer extends Quotable, Consumer<KernelContext> { }\n+    @CodeReflection\n+    public interface QuotableKernelContextConsumer extends Consumer<KernelContext> { }\n","filename":"hat\/core\/src\/main\/java\/hat\/ComputeContext.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import jdk.incubator.code.CodeReflection;\n@@ -29,1 +30,0 @@\n-import jdk.incubator.code.Quotable;\n@@ -49,1 +49,2 @@\n-        interface QuotableIntUnaryOperator extends IntUnaryOperator, Quotable {\n+        @CodeReflection\n+        interface QuotableIntUnaryOperator extends IntUnaryOperator {\n@@ -52,1 +53,2 @@\n-        interface QuotableFunction<T, R> extends Function<T, R>, Quotable {\n+        @CodeReflection\n+        interface QuotableFunction<T, R> extends Function<T, R> {\n@@ -55,1 +57,2 @@\n-        interface QuotableBiFunction<T, U, R> extends BiFunction<T, U, R>, Quotable {\n+        @CodeReflection\n+        interface QuotableBiFunction<T, U, R> extends BiFunction<T, U, R> {\n@@ -135,1 +138,1 @@\n-        static void isMethodRef(Quotable q) {\n+        static void isMethodRef(Object q) {\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/TestQuoted.java","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import jdk.incubator.code.CodeReflection;\n@@ -28,1 +29,0 @@\n-import jdk.incubator.code.Quotable;\n@@ -34,1 +34,2 @@\n-        public interface QuotableComputeConsumer extends Quotable, Consumer<ComputeClosureProxy> {\n+        @CodeReflection\n+        public interface QuotableComputeConsumer extends Consumer<ComputeClosureProxy> {\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/spirv\/Bad.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -274,1 +274,1 @@\n-     * must be a {@code Quotable} object, inspectable using code reflection. *\/\n+     * must be inspectable using code reflection. *\/\n@@ -448,3 +448,0 @@\n-     * <p>When FLAG_QUOTABLE is set in {@code flags}, the function objects\n-     * will implement {@code Quotable}.\n-     *\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/LambdaMetafactory.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -5415,15 +5415,0 @@\n-\n-    \/\/ code reflection\n-\n-    \/\/ The predicates below do not use a predefined symbol in Symtab.\n-    \/\/ This is deliberate, as we cannot initialize symbols in modules\n-    \/\/ other than java.base at startup.\n-\n-    public boolean isQuotable(Type type) {\n-        Symbol s = type.tsym;\n-        return s != null &&\n-                s.kind == TYP &&\n-                s.name.equals(names.quotable) &&\n-                s.packge().fullname.equals(names.jdk_incubator_code) &&\n-                s.packge().modle.name.equals(names.jdk_incubator_code);\n-    }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/code\/Types.java","additions":0,"deletions":15,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -41,2 +41,2 @@\n-     * <li>lambdas or method references whose target type is {@code Quoted}; and\n-     * <li>lambdas or method references whose target is an intersection type that contains {@code Quotable}.\n+     * <li>lambdas or method references whose target type is a functional interface annotated with {@code CodeReflection}; and\n+     * <li>lambdas or method references whose target is a cast that contains the {@code CodeReflection} annotation.\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/CodeReflectionTransformer.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -855,1 +855,0 @@\n-                        !types.isQuotable(t) &&\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/LambdaToMethod.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -233,1 +233,0 @@\n-    public final Name quotable;\n@@ -425,1 +424,0 @@\n-        quotable = fromString(\"Quotable\");\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/util\/Names.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -48,1 +48,0 @@\n-    public final Type quotableType;\n@@ -60,1 +59,0 @@\n-        quotableType = syms.enterClass(jdk_incubator_code, \"jdk.incubator.code.Quotable\");\n@@ -69,1 +67,0 @@\n-        syms.synthesizeEmptyInterfaceIfMissing(quotableType);\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/internal\/CodeReflectionSymbols.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1375,3 +1375,1 @@\n-            \/\/ a lambda targeted to Quoted is always going to have its model wrapped in QuotedOp, regardless of whether\n-            \/\/ we are producing the model of the method that contain it or we are producing the model of the lambda itself\n-            \/\/ on the other hand, a lambda targeted to a subtype of Quotable is going to have its model wrapped in QuotedOp\n+            \/\/ a quotable lambda is going to have its model wrapped in QuotedOp\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/internal\/ReflectMethods.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}