{"files":[{"patch":"@@ -316,3 +316,1 @@\n-        oparen();\n-        generateReduceFloatType(reducedFloatType);\n-        cparen().obrace().oparen();\n+        paren( _-> generateReduceFloatType(reducedFloatType)).obrace().oparen();\n@@ -321,1 +319,1 @@\n-            generateReducedFloatConversionToFloat(reducedFloatType);\n+            generateReducedFloatConversionToFloat(reducedFloatType).oparen();\n@@ -340,1 +338,1 @@\n-            generateReducedFloatConversionToFloat(reducedFloatType);\n+            generateReducedFloatConversionToFloat(reducedFloatType).oparen();\n@@ -354,0 +352,1 @@\n+            \/\/ close the pending parenthesis\n@@ -361,1 +360,1 @@\n-    private void buildReducedFloatType(ReducedFloatType reducedFloatType) {\n+    private CudaHATKernelBuilder buildReducedFloatType(ReducedFloatType reducedFloatType) {\n@@ -367,0 +366,1 @@\n+        return self();\n@@ -369,1 +369,1 @@\n-    private void generateReduceFloatType(ReducedFloatType reducedFloatType) {\n+    private CudaHATKernelBuilder generateReduceFloatType(ReducedFloatType reducedFloatType) {\n@@ -375,0 +375,1 @@\n+        return self();\n@@ -377,1 +378,1 @@\n-    private void generateReducedFloatConversionToFloat(ReducedFloatType reducedFloatType) {\n+    private CudaHATKernelBuilder generateReducedFloatConversionToFloat(ReducedFloatType reducedFloatType) {\n@@ -379,2 +380,2 @@\n-            case ReducedFloatType.HalfFloat _ ->  half2float().oparen();\n-            case ReducedFloatType.BFloat16 _ ->  __bfloat162float().oparen();\n+            case ReducedFloatType.HalfFloat _ ->  half2float();\n+            case ReducedFloatType.BFloat16 _ ->  __bfloat162float();\n@@ -383,0 +384,1 @@\n+        return self();\n","filename":"hat\/backends\/ffi\/cuda\/src\/main\/java\/hat\/backend\/ffi\/CudaHATKernelBuilder.java","additions":12,"deletions":10,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -97,1 +97,1 @@\n-                .typedefStructOrUnion(true, KernelContext.class.getSimpleName(), _ -> {\n+                .typedefStructOrUnion(true, KernelContext.class, _ -> {\n@@ -112,1 +112,1 @@\n-    T typedefStructOrUnion(boolean isStruct, String name, Consumer<T> consumer) {\n+    T typedefStructOrUnion(boolean isStruct, Class<?> klass, Consumer<T> consumer) {\n@@ -117,1 +117,1 @@\n-                .either(isStruct, _ -> suffix_s(name), _ -> suffix_u(name))\n+                .either(isStruct, _ -> suffix_s(klass), _ -> suffix_u(klass))\n@@ -119,1 +119,1 @@\n-                .suffix_t(name).semicolon().nl();\n+                .suffix_t(klass).semicolon().nl();\n@@ -128,1 +128,1 @@\n-            globalPtrPrefix().suffix_t(F16Impl.class.getSimpleName()).asterisk();\n+            globalPtrPrefix().suffix_t(F16Impl.class).asterisk();\n@@ -130,3 +130,1 @@\n-            \/\/ Check for special types (e.g., FP16)\n-            \/\/ TODO: We need to update this with a custom op, so we avoid direct use of Impls\n-            globalPtrPrefix().suffix_t(KernelContext.class.getSimpleName()).asterisk();\n+            globalPtrPrefix().suffix_t(KernelContext.class).asterisk();\n@@ -136,1 +134,1 @@\n-            globalPtrPrefix().suffix_t(BF16Array.BF16Impl.class.getSimpleName()).asterisk();\n+            globalPtrPrefix().suffix_t(BF16Array.BF16Impl.class).asterisk();\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/C99HATKernelBuilder.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -84,0 +84,12 @@\n+    public T suffix_t(Class<?> klass) {\n+        return identifier(klass.getSimpleName()).identifier(\"_t\");\n+    }\n+\n+    public T suffix_u(Class<?> klass) {\n+        return identifier(klass.getSimpleName()).identifier(\"_u\");\n+    }\n+\n+    public T suffix_s(Class<?> klass) {\n+        return identifier(klass.getSimpleName()).identifier(\"_s\");\n+    }\n+\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/HATCodeBuilder.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -399,1 +399,1 @@\n-                            suffix_t(ifaceField.ifaceType.iface.getSimpleName());\n+                            suffix_t(ifaceField.ifaceType.iface);\n@@ -435,1 +435,1 @@\n-                }).suffix_t(ifaceType.iface.getSimpleName()).semicolon().nl().nl();\n+                }).suffix_t(ifaceType.iface).semicolon().nl().nl();\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/HATCodeBuilderWithContext.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}