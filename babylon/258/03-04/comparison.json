{"files":[{"patch":"@@ -395,1 +395,1 @@\n-                case ArrayLoadInstruction _ -> {\n+                case ArrayLoadInstruction ali -> {\n@@ -397,1 +397,14 @@\n-                    stack.push(op(CoreOp.arrayLoadOp(stack.pop(), index)));\n+                    Value array = stack.pop();\n+                    if (array.type() instanceof UnresolvedType ut) {\n+                        ut.resolveTo(switch (ali.typeKind()) {\n+                            case BYTE -> JavaType.BYTE_ARRAY;\n+                            case CHAR -> JavaType.CHAR_ARRAY;\n+                            case DOUBLE -> JavaType.DOUBLE_ARRAY;\n+                            case FLOAT -> JavaType.FLOAT_ARRAY;\n+                            case INT -> JavaType.INT_ARRAY;\n+                            case LONG -> JavaType.LONG_ARRAY;\n+                            case SHORT -> JavaType.SHORT_ARRAY;\n+                            default -> null;\n+                        });\n+                    }\n+                    stack.push(op(CoreOp.arrayLoadOp(array, index)));\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/code\/bytecode\/BytecodeLift.java","additions":15,"deletions":2,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -94,1 +94,1 @@\n-            return new Comp(this);\n+            return resolved == null ? new Comp(this) : resolved.componentType();\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/code\/bytecode\/UnresolvedType.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -61,1 +61,1 @@\n-    private static final int ROUNDS = 1;\n+    private static final int ROUNDS = 3;\n@@ -101,2 +101,2 @@\n-        \/\/ Roundtrip is >99% stable, no exceptions, no verification errors\n-        Assert.assertTrue(stable > 54000 && unstable < 100, String.format(\"stable: %d unstable: %d\", stable, unstable));\n+        \/\/ Roundtrip is 100% stable after 3 rounds, no exceptions, no verification errors\n+        Assert.assertTrue(stable > 54500 && unstable == 0, String.format(\"stable: %d unstable: %d\", stable, unstable));\n","filename":"test\/jdk\/java\/lang\/reflect\/code\/bytecode\/TestSmallCorpus.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}