{"files":[{"patch":"@@ -32,2 +32,0 @@\n-import hat.annotations.Kernel;\n-import hat.annotations.Preformatted;\n@@ -767,1 +765,1 @@\n-    private static void runSequential(F16Array matrixA, F16Array matrixB, F32Array matrixC, final int size) {\n+    private static void runSequential(F16Array matrixA, F16Array matrixB, F16Array matrixC, final int size) {\n@@ -770,1 +768,1 @@\n-                float sum = 0;\n+                F16 sum = F16.of(0.0f);\n@@ -772,3 +770,3 @@\n-                    float a = F16.f16ToFloat(matrixA.array((long) i * size + k));\n-                    float b = F16.f16ToFloat(matrixB.array((long) k * size + j));\n-                    sum += a * b;\n+                    F16 a = matrixA.array((long) i * size + k);\n+                    F16 b = matrixB.array((long) k * size + j);\n+                    sum = F16.add(sum, F16.mul(a, b));\n@@ -776,1 +774,1 @@\n-                matrixC.array((long) i * size + j, sum);\n+                matrixC.array((long) i * size + j).value(sum.value());\n@@ -865,2 +863,2 @@\n-                    matrixAHalf.array(j).value(F16.floatToF16(r.nextFloat(1)).value());\n-                    matrixBHalf.array(j).value(F16.floatToF16(r.nextFloat(1)).value());\n+                    matrixAHalf.array(j).value(F16.floatToF16(r.nextFloat()).value());\n+                    matrixBHalf.array(j).value(F16.floatToF16(r.nextFloat()).value());\n@@ -883,1 +881,7 @@\n-        var resultSeq = F32Array.create(accelerator, size * size);\n+        F32Array resultSeq = null;\n+        F16Array resultSeqHalf = null;\n+        if (configuration == Configuration._2DREGISTER_TILING_FP16) {\n+            resultSeqHalf = F16Array.create(accelerator, size * size);\n+        } else {\n+            resultSeq = F32Array.create(accelerator, size * size);\n+        }\n@@ -889,1 +893,1 @@\n-            runSequential(matrixAHalf, matrixAHalf, resultSeq, size);\n+            runSequential(matrixAHalf, matrixBHalf, resultSeqHalf, size);\n@@ -926,1 +930,6 @@\n-                        float expectedValue = resultSeq.array(i * size + j);\n+                        float expectedValue;\n+                        if (configuration == Configuration._2DREGISTER_TILING_FP16) {\n+                            expectedValue = F16.f16ToFloat(resultSeqHalf.array(i * size + j));\n+                        } else {\n+                            expectedValue = resultSeq.array(i * size + j);\n+                        }\n","filename":"hat\/examples\/matmul\/src\/main\/java\/matmul\/Main.java","additions":22,"deletions":13,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -975,1 +975,0 @@\n-\n@@ -987,2 +986,2 @@\n-        for (int j = 0; j < size; j++) {\n-            for (int i = 0; i < size; i++) {\n+        for (int i = 0; i < size; i++) {\n+            for (int j = 0; j < size; j++) {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestMatMul.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"}]}