{"files":[{"patch":"@@ -34,2 +34,0 @@\n-import optkl.OpHelper;\n-import optkl.util.CallSite;\n","filename":"hat\/backends\/ffi\/shared\/src\/main\/java\/hat\/backend\/ffi\/C99FFIBackend.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -79,1 +79,1 @@\n-public class Accelerator implements CommonCarrier,  BufferTracker {\n+public class Accelerator implements ArenaAndLookupCarrier,  BufferTracker {\n","filename":"hat\/core\/src\/main\/java\/hat\/Accelerator.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,0 +29,2 @@\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n+import optkl.util.carriers.ArenaCarrier;\n@@ -30,1 +32,0 @@\n-import optkl.ifacemapper.BufferAllocator;\n@@ -72,1 +73,1 @@\n-public class ComputeContext implements LookupCarrier,BufferAllocator, BufferTracker {\n+public class ComputeContext implements ArenaAndLookupCarrier, BufferTracker {\n","filename":"hat\/core\/src\/main\/java\/hat\/ComputeContext.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -40,1 +40,0 @@\n-import optkl.ifacemapper.BufferAllocator;\n@@ -43,0 +42,2 @@\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n+import optkl.util.carriers.ArenaCarrier;\n@@ -55,1 +56,1 @@\n-public  abstract class Backend implements BufferAllocator, LookupCarrier {\n+public  abstract class Backend implements ArenaAndLookupCarrier {\n","filename":"hat\/core\/src\/main\/java\/hat\/backend\/Backend.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -229,1 +230,1 @@\n-    static ArgArray create(CommonCarrier cc, KernelCallGraph kernelCallGraph, Object... args) {\n+    static ArgArray create(ArenaAndLookupCarrier cc, KernelCallGraph kernelCallGraph, Object... args) {\n@@ -253,1 +254,1 @@\n-        ArgArray argArray = schema.allocate(cc,args.length,schemaStr.length() + 1);\n+        ArgArray argArray = BoundSchema.of(cc ,schema,args.length,schemaStr.length()+1).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/ArgArray.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -46,2 +47,2 @@\n-    static BF16Array create(CommonCarrier cc, int length){\n-        return schema.allocate(cc, length);\n+    static BF16Array create(ArenaAndLookupCarrier cc, int length){\n+        return BoundSchema.of(cc ,schema, length).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/BF16Array.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -47,1 +48,1 @@\n-        return schema.allocate(accelerator, length);\n+        return BoundSchema.of(accelerator,schema, length).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F16Array.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -34,1 +35,0 @@\n-import java.util.stream.IntStream;\n@@ -55,2 +55,2 @@\n-    static F32Array create(CommonCarrier cc, int length) {\n-        return schema.allocate(cc, length);\n+    static F32Array create(ArenaAndLookupCarrier cc, int length) {\n+        return BoundSchema.of(cc ,schema, length).allocate();\n@@ -64,1 +64,1 @@\n-    static F32Array createFrom(CommonCarrier cc, float[] arr) {\n+    static F32Array createFrom(ArenaAndLookupCarrier cc, float[] arr) {\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F32Array.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -52,2 +53,2 @@\n-    static F32Array2D create(CommonCarrier cc, int width, int height){\n-        return schema.allocate(cc, width,height);\n+    static F32Array2D create(ArenaAndLookupCarrier cc, int width, int height){\n+        return BoundSchema.of(cc ,schema, width,height).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F32Array2D.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -29,2 +29,2 @@\n-import jdk.incubator.code.Reflect;\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -53,2 +53,2 @@\n-    static F32ArrayPadded create(CommonCarrier cc, int length){\n-        return schema.allocate(cc, length);\n+    static F32ArrayPadded create(ArenaAndLookupCarrier cc, int length){\n+        return BoundSchema.of(cc ,schema, length).allocate();\n@@ -62,1 +62,1 @@\n-    static F32ArrayPadded createFrom(CommonCarrier cc, float[] arr){\n+    static F32ArrayPadded createFrom(ArenaAndLookupCarrier cc, float[] arr){\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/F32ArrayPadded.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -109,2 +110,2 @@\n-    static KernelBufferContext createDefault(CommonCarrier cc) {\n-        KernelBufferContext kernelBufferContext = schema.allocate(cc);\n+    static KernelBufferContext createDefault(ArenaAndLookupCarrier cc) {\n+        KernelBufferContext kernelBufferContext = BoundSchema.of(cc ,schema).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/KernelBufferContext.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -42,2 +43,2 @@\n-    static S08x3RGBImage create(CommonCarrier cc, int width, int height){\n-        return schema.allocate(cc,width,height);\n+    static S08x3RGBImage create(ArenaAndLookupCarrier cc, int width, int height){\n+        return BoundSchema.of(cc ,schema,width,height).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/S08x3RGBImage.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -47,2 +48,2 @@\n-    @Reflect static S32Array create(CommonCarrier cc, int length){\n-        return schema.allocate(cc, length);\n+    @Reflect static S32Array create(ArenaAndLookupCarrier cc, int length){\n+        return BoundSchema.of(cc ,schema, length).allocate();\n@@ -56,1 +57,1 @@\n-    @Reflect static S32Array create(CommonCarrier cc, int length, Function<Integer,Integer> filler){\n+    @Reflect static S32Array create(ArenaAndLookupCarrier cc, int length, Function<Integer,Integer> filler){\n@@ -59,1 +60,1 @@\n-    static S32Array createFrom(CommonCarrier cc, int[] arr){\n+    static S32Array createFrom(ArenaAndLookupCarrier cc, int[] arr){\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/S32Array.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -27,1 +27,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -56,2 +57,2 @@\n-    static S32Array2D create(CommonCarrier cc, int width, int height){\n-        return schema.allocate(cc, width,height);\n+    static S32Array2D create(ArenaAndLookupCarrier cc, int width, int height){\n+        return BoundSchema.of(cc ,schema, width,height).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/S32Array2D.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -39,2 +40,2 @@\n-    static S32RGBAImage create(CommonCarrier cc, int width, int height){\n-        return schema.allocate(cc,width,height);\n+    static S32RGBAImage create(ArenaAndLookupCarrier cc, int width, int height){\n+        return BoundSchema.of(cc ,schema,width,height).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/S32RGBAImage.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.ifacemapper.BoundSchema;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -41,2 +42,2 @@\n-    static U16GreyImage create(CommonCarrier cc, int width, int height){\n-        return schema.allocate(cc,width,height);\n+    static U16GreyImage create(ArenaAndLookupCarrier cc, int width, int height){\n+        return BoundSchema.of(cc ,schema,width,height).allocate();\n","filename":"hat\/core\/src\/main\/java\/hat\/buffer\/U16GreyImage.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import hat.device.DeviceType;\n@@ -41,1 +40,1 @@\n-import hat.types.HAType;\n+import optkl.IfaceValue;\n@@ -360,1 +359,1 @@\n-        if (javaType instanceof ClassType classType && OpHelper.isAssignable(scopedCodeBuilderContext().lookup(), javaType, MappableIface.class)) {\n+        if (javaType instanceof ClassType classType && OpHelper.isAssignable(scopedCodeBuilderContext().lookup(), javaType, IfaceValue.class)) {\n@@ -738,1 +737,1 @@\n-        if ( invoke.refIs(MappableIface.class, HAType.class, DeviceType.class)) { \/\/ we need a common type\n+        if ( invoke.refIs(IfaceValue.class \/*MappableIface.class, HAType.class, DeviceType.class*\/)) { \/\/ we need a common type\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/C99HATKernelBuilder.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import jdk.incubator.code.dialect.core.CoreOp;\n@@ -43,1 +42,1 @@\n-public class DeviceSchema<T extends DeviceType> {\n+public class DeviceSchema<T extends NonMappableIface> {\n@@ -63,1 +62,1 @@\n-    public static <T extends DeviceType> DeviceSchema<T> of(Class<T> klass, Consumer<DeviceSchema<T>> schemaBuilder) {\n+    public static <T extends NonMappableIface> DeviceSchema<T> of(Class<T> klass, Consumer<DeviceSchema<T>> schemaBuilder) {\n","filename":"hat\/core\/src\/main\/java\/hat\/device\/DeviceSchema.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,1 +27,3 @@\n-public interface DeviceType {\n+import optkl.IfaceValue;\n+\n+public interface NonMappableIface extends IfaceValue {\n","filename":"hat\/core\/src\/main\/java\/hat\/device\/NonMappableIface.java","additions":3,"deletions":1,"binary":false,"changes":4,"previous_filename":"hat\/core\/src\/main\/java\/hat\/device\/DeviceType.java","status":"renamed"},{"patch":"@@ -28,1 +28,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -51,1 +51,1 @@\n-                        && invoke.refIs(MappableIface.class,DeviceType.class))) {\n+                        && invoke.refIs(MappableIface.class, NonMappableIface.class))) {\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATArrayViewPhase.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -31,1 +31,1 @@\n-import hat.types.HAType;\n+\/\/import hat.types.HAType;\n@@ -38,0 +38,1 @@\n+import optkl.IfaceValue;\n@@ -40,1 +41,0 @@\n-import optkl.ifacemapper.MappableIface;\n@@ -112,1 +112,1 @@\n-            return invoke.refIs( DeviceType.class, MappableIface.class, HAType.class)\n+            return invoke.refIs( IfaceValue.class \/*DeviceType.class, MappableIface.class, HAType.class*\/)\n@@ -138,1 +138,1 @@\n-            return invoke.refIs( DeviceType.class, MappableIface.class, HAType.class) && invoke.named(INTRINSIC_NAME);\n+            return invoke.refIs(IfaceValue.class \/* DeviceType.class, MappableIface.class, HAType.class*\/) && invoke.named(INTRINSIC_NAME);\n@@ -162,1 +162,1 @@\n-            return invoke.refIs( DeviceType.class, MappableIface.class, HAType.class) && invoke.named(INTRINSIC_NAME);\n+            return invoke.refIs( IfaceValue.class\/*DeviceType.class, MappableIface.class, HAType.class*\/) && invoke.named(INTRINSIC_NAME);\n@@ -171,1 +171,1 @@\n-                    .filter(invoke->invoke.refIs(DeviceType.class) && invoke.returnsClassType() && !invoke.named(reservedMethods))\n+                    .filter(invoke->invoke.refIs(NonMappableIface.class) && invoke.returnsClassType() && !invoke.named(reservedMethods))\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATMemoryPhase.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -27,4 +27,1 @@\n-public interface BF16 extends HAType {\n-\n-    short value();\n-    void value(short value);\n+public interface BF16 extends _F16{\n","filename":"hat\/core\/src\/main\/java\/hat\/types\/BF16.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,2 @@\n+import optkl.IfaceValue;\n+\n@@ -29,3 +31,1 @@\n-public interface F16 extends HAType {\n-    short value();\n-    void value(short value);\n+public interface F16 extends _F16 {\n","filename":"hat\/core\/src\/main\/java\/hat\/types\/F16.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1,28 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package hat.types;\n-\n-public interface HAType {\n-}\n","filename":"hat\/core\/src\/main\/java\/hat\/types\/HAType.java","additions":0,"deletions":28,"binary":false,"changes":28,"status":"deleted"},{"patch":"@@ -0,0 +1,35 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package hat.types;\n+\n+import optkl.IfaceValue;\n+\n+\/**\n+ * Common interface for F16 implementations\n+ *\/\n+public interface _F16 extends IfaceValue {\n+    short value();\n+    void value(short value);\n+}\n","filename":"hat\/core\/src\/main\/java\/hat\/types\/_F16.java","additions":35,"deletions":0,"binary":false,"changes":35,"status":"added"},{"patch":"@@ -34,0 +34,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -65,1 +66,1 @@\n-            return schema.allocate(accelerator, 1);\n+            return BoundSchema.of(accelerator ,schema, 1).allocate();\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/LocalArray.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -116,1 +116,1 @@\n-            return schema.allocate(accelerator,100,10);\n+            return BoundSchema.of(accelerator ,schema,100,10).allocate();\n@@ -143,3 +143,1 @@\n-\n-        var boundSchema = new BoundSchema<>(MeshData.schema, 100, 10);\n-        var meshDataNew = boundSchema.allocate(accelerator.lookup(),accelerator);\n+        var meshDataNew = BoundSchema.of(accelerator ,MeshData.schema,100,100).allocate();\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/Mesh.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -37,1 +37,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -41,1 +41,0 @@\n-import optkl.ifacemapper.Buffer;\n@@ -45,1 +44,0 @@\n-import optkl.ifacemapper.Schema;\n@@ -51,1 +49,0 @@\n-import java.util.Map;\n@@ -63,1 +60,1 @@\n-    private interface SharedS32x256Array extends DeviceType {\n+    private interface SharedS32x256Array extends NonMappableIface {\n@@ -71,1 +68,1 @@\n-           return null;\/\/ return schema.allocate(accelerator); \/\/ Why would we get here?\n+           return null;\/\/ return BoundSchema.of(accelerator ,schema).allocate(); \/\/ Why would we get here?\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/PrefixSum.java","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -33,0 +33,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -62,1 +63,1 @@\n-            return schema.allocate(accelerator, 1);\n+            return BoundSchema.of(accelerator ,schema, 1).allocate();\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/Reduction.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-import optkl.util.carriers.CommonCarrier;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -48,2 +48,2 @@\n-        static S32Arr2D create(CommonCarrier cc, int width, int height) {\n-            return schema.allocate(cc, width, height);\n+        static S32Arr2D create(ArenaAndLookupCarrier cc, int width, int height) {\n+            return BoundSchema.of(cc ,schema, width, height).allocate();\n","filename":"hat\/examples\/experiments\/src\/main\/java\/experiments\/S32Array2DNewSchemaTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -35,0 +35,1 @@\n+import optkl.IfaceValue;\n@@ -273,1 +274,1 @@\n-    private interface SharedFloatArray extends DeviceType {\n+    private interface SharedFloatArray extends NonMappableIface {\n@@ -292,1 +293,1 @@\n-    private interface PrivateFloatArray extends DeviceType {\n+    private interface PrivateFloatArray extends NonMappableIface {\n","filename":"hat\/examples\/flashattention\/src\/main\/java\/flashattention\/Main.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -60,1 +61,1 @@\n-        Box box = schema.allocate(accelerator);\n+        Box box = BoundSchema.of(accelerator ,schema).allocate();\n","filename":"hat\/examples\/heal\/src\/main\/java\/heal\/Box.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -53,1 +54,1 @@\n-        return  schema.allocate(accelerator,selection.pointList.size());\n+        return  BoundSchema.of(accelerator ,schema,selection.pointList.size()).allocate();\n","filename":"hat\/examples\/heal\/src\/main\/java\/heal\/XYRGBList.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -74,1 +75,1 @@\n-            return schema.allocate(accelerator, width, height);\n+            return BoundSchema.of(accelerator ,schema, width, height).allocate();\n@@ -111,1 +112,1 @@\n-            var instance = schema.allocate(accelerator);\n+            var instance = BoundSchema.of(accelerator ,schema).allocate();\n","filename":"hat\/examples\/life\/src\/main\/java\/life\/Main.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -120,1 +120,1 @@\n-    private interface MyLocalArrayFixedSize extends DeviceType {\n+    private interface MyLocalArrayFixedSize extends NonMappableIface {\n@@ -184,1 +184,1 @@\n-    private interface SharedMemory extends DeviceType {\n+    private interface SharedMemory extends NonMappableIface {\n@@ -201,1 +201,1 @@\n-    private interface PrivateArray extends DeviceType {\n+    private interface PrivateArray extends NonMappableIface {\n@@ -218,1 +218,1 @@\n-    private interface FlatPrivate extends DeviceType {\n+    private interface FlatPrivate extends NonMappableIface {\n@@ -477,1 +477,1 @@\n-    private interface SharedMemoryHalf extends DeviceType {\n+    private interface SharedMemoryHalf extends NonMappableIface {\n@@ -493,1 +493,1 @@\n-    private interface PrivateArrayHalf extends DeviceType {\n+    private interface PrivateArrayHalf extends NonMappableIface {\n@@ -509,1 +509,1 @@\n-    private interface FlatPrivateHalf extends DeviceType {\n+    private interface FlatPrivateHalf extends NonMappableIface {\n","filename":"hat\/examples\/matmul\/src\/main\/java\/matmul\/Main.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -92,1 +93,1 @@\n-        return schema.allocate(accelerator, length);\n+        return BoundSchema.of(accelerator ,schema, length).allocate();\n","filename":"hat\/examples\/nbody\/src\/main\/java\/nbody\/Universe.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -164,1 +165,1 @@\n-        var instance  = schema.allocate(accelerator,\n+        var instance  = BoundSchema.of(accelerator ,schema,\n@@ -168,1 +169,1 @@\n-        );\n+        ).allocate();\n","filename":"hat\/examples\/violajones\/src\/main\/java\/violajones\/ifaces\/Cascade.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -68,1 +69,1 @@\n-        return schema.allocate(accelerator,length);\n+        return BoundSchema.of(accelerator ,schema,length).allocate();\n","filename":"hat\/examples\/violajones\/src\/main\/java\/violajones\/ifaces\/ResultTable.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -177,1 +178,1 @@\n-        return schema.allocate(accelerator,length);\n+        return BoundSchema.of(accelerator ,schema,length).allocate();\n","filename":"hat\/examples\/violajones\/src\/main\/java\/violajones\/ifaces\/ScaleTable.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+      <module fileurl=\"file:\/\/$PROJECT_DIR$\/example_flashattention.iml\" filepath=\"$PROJECT_DIR$\/example_flashattention.iml\" \/>\n","filename":"hat\/intellij\/.idea\/modules.xml","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -0,0 +1,14 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<module type=\"JAVA_MODULE\" version=\"4\">\n+  <component name=\"NewModuleRootManager\" inherit-compiler-output=\"true\">\n+    <exclude-output \/>\n+    <content url=\"file:\/\/$MODULE_DIR$\/..\/examples\/flashattention\">\n+      <sourceFolder url=\"file:\/\/$MODULE_DIR$\/..\/examples\/flashattention\/src\/main\/java\" isTestSource=\"false\" \/>\n+      <sourceFolder url=\"file:\/\/$MODULE_DIR$\/..\/examples\/flashattention\/src\/main\/resources\" type=\"java-resource\" \/>\n+    <\/content>\n+    <orderEntry type=\"inheritedJdk\" \/>\n+    <orderEntry type=\"sourceFolder\" forTests=\"false\" \/>\n+    <orderEntry type=\"module\" module-name=\"core\" \/>\n+    <orderEntry type=\"module\" module-name=\"optkl\" \/>\n+  <\/component>\n+<\/module>\n","filename":"hat\/intellij\/example_flashattention.iml","additions":14,"deletions":0,"binary":false,"changes":14,"status":"added"},{"patch":"@@ -0,0 +1,35 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package optkl;\n+\n+\n+public interface IfaceValue {\n+\n+    interface Union extends IfaceValue {\n+    }\n+\n+    interface Struct extends IfaceValue {\n+    }\n+}\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/IfaceValue.java","additions":35,"deletions":0,"binary":false,"changes":35,"status":"added"},{"patch":"@@ -28,0 +28,3 @@\n+import optkl.ifacemapper.accessor.AccessorInfo;\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n+\n@@ -30,0 +33,1 @@\n+import java.lang.foreign.MemorySegment;\n@@ -31,1 +35,0 @@\n-import java.lang.invoke.MethodHandles;\n@@ -39,0 +42,1 @@\n+    final private ArenaAndLookupCarrier arenaAndLookupCarrier;\n@@ -106,1 +110,2 @@\n-    public BoundSchema(Schema<T> schema, int... arrayLengths) {\n+    public BoundSchema(ArenaAndLookupCarrier arenaAndLookupCarrier, Schema<T> schema, int... arrayLengths) {\n+        this.arenaAndLookupCarrier = arenaAndLookupCarrier;\n@@ -118,3 +123,3 @@\n-    public T allocate(MethodHandles.Lookup lookup, BufferAllocator bufferAllocator) {\n-        return bufferAllocator.allocates(SegmentMapper.of(bufferAllocator.arena(),lookup, schema.iface, groupLayout, this), this);\n-    }\n+\n+\n+\n@@ -257,0 +262,36 @@\n+\n+    static public <T extends Buffer> BoundSchema<T> of (ArenaAndLookupCarrier arenaAndLookupCarrier, Schema<T> schema, int... boundLengths){\n+        return new BoundSchema<>(arenaAndLookupCarrier,schema, boundLengths);\n+    }\n+\n+\n+      public T allocate() {\n+        var segmentMapper = SegmentMapper.of(arenaAndLookupCarrier.arena(), arenaAndLookupCarrier.lookup(), schema.iface, groupLayout, this);\n+        T instance =  segmentMapper.allocate(this);\n+        MemorySegment memorySegment = MappableIface.getMemorySegment(instance);\n+        int[] count = new int[]{0};\n+\n+\n+        boundArrayFields().forEach(boundArrayFieldLayout -> {\n+            boundArrayFieldLayout.dimFields.forEach(dimLayout -> {\n+                long dimOffset = dimLayout.offset();\n+                int dim = arrayLengths[count[0]++];\n+                if (dimLayout.field instanceof Schema.FieldNode.ArrayLen arrayLen) {\n+                    if (arrayLen.key.accessorType.equals(AccessorInfo.AccessorType.GETTER_AND_SETTER)) {\n+                        throw new IllegalStateException(\"You have a bound array dim field \" + dimLayout.field.name + \" controlling size of \" + boundArrayFieldLayout.field.name + \"[] which has a setter \");\n+                    }\n+                    if (arrayLen.type == Long.TYPE) {\n+                        memorySegment.set(ValueLayout.JAVA_LONG, dimOffset, dim);\n+                    } else if (arrayLen.type == Integer.TYPE) {\n+                        memorySegment.set(ValueLayout.JAVA_INT, dimOffset, dim);\n+                    } else {\n+                        throw new IllegalArgumentException(\"Unsupported array length type: \" + arrayLen.type);\n+                    }\n+                }\n+            });\n+        });\n+\n+\n+        return instance;\n+    }\n+\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/ifacemapper\/BoundSchema.java","additions":46,"deletions":5,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -1,33 +0,0 @@\n-\/*\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package optkl.ifacemapper;\n-\n-import optkl.util.carriers.ArenaCarrier;\n-\n-public interface BufferAllocator extends ArenaCarrier {\n-    default  <T extends MappableIface> T allocates(SegmentMapper<T> segmentMapper, BoundSchema<T> boundSchema) {\n-            return segmentMapper.allocate(boundSchema);\n-    }\n-}\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/ifacemapper\/BufferAllocator.java","additions":0,"deletions":33,"binary":false,"changes":33,"status":"deleted"},{"patch":"@@ -27,0 +27,2 @@\n+import optkl.IfaceValue;\n+\n@@ -40,1 +42,1 @@\n-public interface MappableIface  {\n+public interface MappableIface extends IfaceValue {\n@@ -51,6 +53,0 @@\n-    interface Union extends MappableIface {\n-    }\n-\n-    interface Struct extends MappableIface {\n-    }\n-\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/ifacemapper\/MappableIface.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import optkl.util.carriers.CommonCarrier;\n@@ -37,1 +36,0 @@\n-import java.lang.foreign.ValueLayout;\n@@ -72,30 +70,0 @@\n-    public T allocate(CommonCarrier commonCarrier, int... boundLengths) {\n-        BoundSchema<?> boundSchema = new BoundSchema<>(this, boundLengths);\n-        T instance = (T) boundSchema.allocate(commonCarrier.lookup(), commonCarrier);\n-        MemorySegment memorySegment = MappableIface.getMemorySegment(instance);\n-        int[] count = new int[]{0};\n-\n-\n-        boundSchema.boundArrayFields().forEach(boundArrayFieldLayout -> {\n-            boundArrayFieldLayout.dimFields.forEach(dimLayout -> {\n-                long dimOffset = dimLayout.offset();\n-                int dim = boundLengths[count[0]++];\n-                if (dimLayout.field instanceof FieldNode.ArrayLen arrayLen) {\n-                    if (arrayLen.key.accessorType.equals(AccessorInfo.AccessorType.GETTER_AND_SETTER)) {\n-                        throw new IllegalStateException(\"You have a bound array dim field \" + dimLayout.field.name + \" controlling size of \" + boundArrayFieldLayout.field.name + \"[] which has a setter \");\n-                    }\n-                    if (arrayLen.type == Long.TYPE) {\n-                        memorySegment.set(ValueLayout.JAVA_LONG, dimOffset, dim);\n-                    } else if (arrayLen.type == Integer.TYPE) {\n-                        memorySegment.set(ValueLayout.JAVA_INT, dimOffset, dim);\n-                    } else {\n-                        throw new IllegalArgumentException(\"Unsupported array length type: \" + arrayLen.type);\n-                    }\n-                }\n-            });\n-        });\n-\n-\n-        return instance;\n-    }\n-\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/ifacemapper\/Schema.java","additions":0,"deletions":32,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import optkl.util.carriers.ArenaAndLookupCarrier;\n@@ -307,1 +308,1 @@\n-public interface SegmentMapper<T>  extends ArenaCarrier, LookupCarrier {\n+public interface SegmentMapper<T>  extends ArenaAndLookupCarrier {\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/ifacemapper\/SegmentMapper.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-import java.lang.foreign.Arena;\n@@ -29,2 +28,1 @@\n-public interface ArenaCarrier {\n-    Arena arena();\n+public interface ArenaAndLookupCarrier extends ArenaCarrier,LookupCarrier {\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/util\/carriers\/ArenaAndLookupCarrier.java","additions":1,"deletions":3,"binary":false,"changes":4,"previous_filename":"hat\/optkl\/src\/main\/java\/optkl\/util\/carriers\/ArenaCarrier.java","status":"copied"},{"patch":"@@ -1,30 +0,0 @@\n-\/*\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package optkl.util.carriers;\n-\n-import optkl.ifacemapper.BufferAllocator;\n-\n-public interface CommonCarrier extends BufferAllocator, LookupCarrier {\n-}\n","filename":"hat\/optkl\/src\/main\/java\/optkl\/util\/carriers\/CommonCarrier.java","additions":0,"deletions":30,"binary":false,"changes":30,"status":"deleted"},{"patch":"@@ -34,1 +34,2 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n+import optkl.ifacemapper.BoundSchema;\n@@ -183,1 +184,1 @@\n-            return schema.allocate(accelerator, width, height);\n+            return BoundSchema.of(accelerator ,schema, width, height).allocate();\n@@ -213,1 +214,1 @@\n-            var instance = schema.allocate(accelerator);\n+            var instance = BoundSchema.of(accelerator ,schema).allocate();\n@@ -589,1 +590,1 @@\n-    private interface SharedMemory extends DeviceType {\n+    private interface SharedMemory extends NonMappableIface {\n@@ -606,1 +607,1 @@\n-    public interface PrivateArray extends DeviceType {\n+    public interface PrivateArray extends NonMappableIface {\n@@ -670,1 +671,1 @@\n-    public interface SharedDeviceType extends DeviceType {\n+    public interface SharedNonMappableIface extends NonMappableIface {\n@@ -673,1 +674,1 @@\n-        DeviceSchema<SharedDeviceType> schema = DeviceSchema.of(SharedDeviceType.class,\n+        DeviceSchema<SharedNonMappableIface> schema = DeviceSchema.of(SharedNonMappableIface.class,\n@@ -675,1 +676,1 @@\n-        static SharedDeviceType create(Accelerator accelerator) {\n+        static SharedNonMappableIface create(Accelerator accelerator) {\n@@ -678,1 +679,1 @@\n-        static SharedDeviceType createLocal() {\n+        static SharedNonMappableIface createLocal() {\n@@ -687,1 +688,1 @@\n-    public interface PrivateDeviceType extends DeviceType {\n+    public interface PrivateNonMappableIface extends NonMappableIface {\n@@ -690,1 +691,1 @@\n-        DeviceSchema<PrivateDeviceType> schema = DeviceSchema.of(PrivateDeviceType.class,\n+        DeviceSchema<PrivateNonMappableIface> schema = DeviceSchema.of(PrivateNonMappableIface.class,\n@@ -692,1 +693,1 @@\n-        static PrivateDeviceType create(Accelerator accelerator) {\n+        static PrivateNonMappableIface create(Accelerator accelerator) {\n@@ -695,1 +696,1 @@\n-        static PrivateDeviceType createPrivate() {\n+        static PrivateNonMappableIface createPrivate() {\n@@ -706,1 +707,1 @@\n-        SharedDeviceType shared = SharedDeviceType.createLocal();\n+        SharedNonMappableIface shared = SharedNonMappableIface.createLocal();\n@@ -708,1 +709,1 @@\n-            PrivateDeviceType priv = PrivateDeviceType.createPrivate();\n+            PrivateNonMappableIface priv = PrivateNonMappableIface.createPrivate();\n@@ -744,1 +745,1 @@\n-        SharedDeviceType shared = SharedDeviceType.createLocal();\n+        SharedNonMappableIface shared = SharedNonMappableIface.createLocal();\n@@ -746,1 +747,1 @@\n-            PrivateDeviceType priv = PrivateDeviceType.createPrivate();\n+            PrivateNonMappableIface priv = PrivateNonMappableIface.createPrivate();\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestArrayView.java","additions":18,"deletions":17,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -146,1 +146,1 @@\n-    public interface LocalArray extends DeviceType {\n+    public interface LocalArray extends NonMappableIface {\n@@ -209,1 +209,1 @@\n-    public interface PrivateArray extends DeviceType {\n+    public interface PrivateArray extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestBFloat16Type.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -35,2 +35,0 @@\n-import java.lang.invoke.MethodHandles;\n-\n@@ -38,1 +36,1 @@\n- * Test to check the Intermediate Representation (IR) of {@link DeviceType} interfaces\n+ * Test to check the Intermediate Representation (IR) of {@link NonMappableIface} interfaces\n@@ -40,1 +38,1 @@\n- * <p>A {@link DeviceType} interface is a special type in HAT that enables developers\n+ * <p>A {@link NonMappableIface} interface is a special type in HAT that enables developers\n@@ -53,1 +51,1 @@\n-    public interface MyDeviceArray extends DeviceType {\n+    public interface MyDeviceArray extends NonMappableIface {\n@@ -73,1 +71,1 @@\n-     * Note that {@link F16} type is provided by hat, and it can be used within {@link DeviceType}.\n+     * Note that {@link F16} type is provided by hat, and it can be used within {@link NonMappableIface}.\n@@ -86,1 +84,1 @@\n-     * interfaces. The main interface inherits from {@link DeviceType} and it\n+     * interfaces. The main interface inherits from {@link NonMappableIface} and it\n@@ -90,1 +88,1 @@\n-    public interface MyNDRAnge extends DeviceType {\n+    public interface MyNDRAnge extends NonMappableIface {\n@@ -121,1 +119,1 @@\n-     * A multidimensional array structure demonstrating nested {@link DeviceType} interfaces.\n+     * A multidimensional array structure demonstrating nested {@link NonMappableIface} interfaces.\n@@ -131,1 +129,1 @@\n-    public interface MultiDim extends DeviceType {\n+    public interface MultiDim extends NonMappableIface {\n@@ -171,1 +169,1 @@\n-    public interface MultiDimFix extends DeviceType {\n+    public interface MultiDimFix extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestDeviceType.java","additions":10,"deletions":12,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -147,1 +147,1 @@\n-    public interface DeviceLocalArray extends DeviceType {\n+    public interface DeviceLocalArray extends NonMappableIface {\n@@ -213,1 +213,1 @@\n-    interface DevicePrivateArray extends DeviceType {\n+    interface DevicePrivateArray extends NonMappableIface {\n@@ -245,1 +245,1 @@\n-    interface DevicePrivateArray2 extends DeviceType {\n+    interface DevicePrivateArray2 extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestF16Type.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -158,1 +158,1 @@\n-    private interface SharedArray extends DeviceType {\n+    private interface SharedArray extends NonMappableIface {\n@@ -190,1 +190,1 @@\n-    private interface PrivateMemory extends DeviceType {\n+    private interface PrivateMemory extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestFloat2.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -44,1 +44,1 @@\n-    private interface MySharedArray extends DeviceType {\n+    private interface MySharedArray extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestLocal.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -100,1 +100,1 @@\n-    private interface MyLocalArrayFixedSize extends DeviceType {\n+    private interface MyLocalArrayFixedSize extends NonMappableIface {\n@@ -509,1 +509,1 @@\n-    private interface SharedMemory extends DeviceType {\n+    private interface SharedMemory extends NonMappableIface {\n@@ -524,1 +524,1 @@\n-    private interface PrivateArray extends DeviceType {\n+    private interface PrivateArray extends NonMappableIface {\n@@ -537,1 +537,1 @@\n-    private interface FlatPrivate extends DeviceType {\n+    private interface FlatPrivate extends NonMappableIface {\n@@ -837,1 +837,1 @@\n-    private interface SharedMemoryHalf extends DeviceType {\n+    private interface SharedMemoryHalf extends NonMappableIface {\n@@ -853,1 +853,1 @@\n-    private interface PrivateArrayHalf extends DeviceType {\n+    private interface PrivateArrayHalf extends NonMappableIface {\n@@ -869,1 +869,1 @@\n-    private interface FlatPrivateHalf extends DeviceType {\n+    private interface FlatPrivateHalf extends NonMappableIface {\n@@ -975,1 +975,1 @@\n-    private interface SharedMemoryBfloat16 extends DeviceType {\n+    private interface SharedMemoryBfloat16 extends NonMappableIface {\n@@ -991,1 +991,1 @@\n-    private interface PrivateArrayBfloat16 extends DeviceType {\n+    private interface PrivateArrayBfloat16 extends NonMappableIface {\n@@ -1007,1 +1007,1 @@\n-    private interface FlatPrivateBfloat16 extends DeviceType {\n+    private interface FlatPrivateBfloat16 extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestMatMul.java","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -75,1 +76,1 @@\n-            return schema.allocate(accelerator, length);\n+            return BoundSchema.of(accelerator ,schema, length).allocate();\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestNbody.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -46,1 +46,1 @@\n-    private interface PrivateArray extends DeviceType {\n+    private interface PrivateArray extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestPrivate.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -44,1 +44,1 @@\n-    private interface MySharedArray extends DeviceType {\n+    private interface MySharedArray extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestReductions.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -221,1 +221,1 @@\n-    private interface SharedMemory extends DeviceType {\n+    private interface SharedMemory extends NonMappableIface {\n@@ -253,1 +253,1 @@\n-    private interface PrivateMemory extends DeviceType {\n+    private interface PrivateMemory extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestVectorArrayView.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-import hat.device.DeviceType;\n+import hat.device.NonMappableIface;\n@@ -162,1 +162,1 @@\n-    private interface SharedMemory extends DeviceType {\n+    private interface SharedMemory extends NonMappableIface {\n@@ -194,1 +194,1 @@\n-    private interface PrivateMemory extends DeviceType {\n+    private interface PrivateMemory extends NonMappableIface {\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestVectorTypes.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import optkl.ifacemapper.BoundSchema;\n@@ -54,1 +55,1 @@\n-            return schema.allocate(accelerator, width, height);\n+            return BoundSchema.of(accelerator ,schema, width, height).allocate();\n","filename":"hat\/tests\/src\/main\/java\/hat\/test\/TestWriteOnly.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}