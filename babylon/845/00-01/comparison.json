{"files":[{"patch":"@@ -172,1 +172,1 @@\n-            BitSet quotable = new BitSet();\n+            BitSet reflectableLambda = new BitSet();\n@@ -176,1 +176,1 @@\n-                generateMethod(lookup, clName, e.getKey(), lowered, clb, ops, lambdaSink, quotable);\n+                generateMethod(lookup, clName, e.getKey(), lowered, clb, ops, lambdaSink, reflectableLambda);\n@@ -180,1 +180,1 @@\n-                if (quotable.get(i)) {\n+                if (reflectableLambda.get(i)) {\n@@ -190,1 +190,1 @@\n-                generateMethod(lookup, clName, \"lambda$\" + i, lop, clb, ops, lambdaSink, quotable);\n+                generateMethod(lookup, clName, \"lambda$\" + i, lop, clb, ops, lambdaSink, reflectableLambda);\n@@ -205,1 +205,1 @@\n-                                                                     BitSet quotable) {\n+                                                                     BitSet reflectableLambda) {\n@@ -213,1 +213,1 @@\n-                                          iop.body().blocks(), cob, functionTable, lambdaSink, quotable).generate()));\n+                                          iop.body().blocks(), cob, functionTable, lambdaSink, reflectableLambda).generate()));\n@@ -232,1 +232,1 @@\n-    private final BitSet quotable;\n+    private final BitSet reflectableLambda;\n@@ -245,1 +245,1 @@\n-                              BitSet quotable) {\n+                              BitSet reflectableLambda) {\n@@ -260,1 +260,1 @@\n-        this.quotable = quotable;\n+        this.reflectableLambda = reflectableLambda;\n@@ -946,1 +946,1 @@\n-                                quotable.set(lambdaSink.size());\n+                                reflectableLambda.set(lambdaSink.size());\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/bytecode\/BytecodeGenerator.java","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -191,1 +191,1 @@\n-            public Builder quotable() {\n+            public Builder reflectable() {\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/dialect\/java\/JavaOp.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -495,1 +495,1 @@\n-            \/\/ If a quotable lambda proxy again to add method Quoted quoted()\n+            \/\/ If a reflectable lambda proxy again to add method Quoted quoted()\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/interpreter\/Interpreter.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-import java.lang.invoke.LambdaMetafactory;\n@@ -475,1 +474,1 @@\n-                        \/\/ if ReflectableLambdaMetafactory is used, the lambda is quotable\n+                        \/\/ if ReflectableLambdaMetafactory is used, the lambda is reflectable\n@@ -477,1 +476,1 @@\n-                            lambda = lambda.quotable();\n+                            lambda = lambda.reflectable();\n","filename":"test\/jdk\/java\/lang\/reflect\/code\/bytecode\/lift\/BytecodeLift.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-import static jdk.incubator.code.dialect.java.JavaOp.continue_;\n@@ -57,5 +56,3 @@\n-            StreamOp(Object quotedLambda) {\n-                if (!(Op.ofLambda(quotedLambda).get().op() instanceof JavaOp.LambdaOp lambdaOp)) {\n-                    throw new IllegalArgumentException(\"Quotable operation is not lambda operation\");\n-                }\n-                if (!(Op.ofLambda(quotedLambda).get().capturedValues().isEmpty())) {\n+            StreamOp(Object reflectableLambda) {\n+                Quoted<JavaOp.LambdaOp> quotedLambda = Op.ofLambda(reflectableLambda).orElseThrow();\n+                if (!(quotedLambda.capturedValues().isEmpty())) {\n@@ -64,1 +61,1 @@\n-                this.lambdaOp = lambdaOp;\n+                this.lambdaOp = quotedLambda.op();\n@@ -73,2 +70,2 @@\n-            public MapStreamOp(Object quotedLambda) {\n-                super(quotedLambda);\n+            public MapStreamOp(Object reflectableLambda) {\n+                super(reflectableLambda);\n@@ -79,2 +76,2 @@\n-            public FlatMapStreamOp(Object quotedLambda) {\n-                super(quotedLambda);\n+            public FlatMapStreamOp(Object reflectableLambda) {\n+                super(reflectableLambda);\n@@ -85,2 +82,2 @@\n-            public FilterStreamOp(Object quotedLambda) {\n-                super(quotedLambda);\n+            public FilterStreamOp(Object reflectableLambda) {\n+                super(reflectableLambda);\n@@ -183,5 +180,3 @@\n-        public FuncOp forEach(Consumer<T> quotableConsumer) {\n-            if (!(Op.ofLambda(quotableConsumer).get().op() instanceof JavaOp.LambdaOp consumer)) {\n-                throw new IllegalArgumentException(\"Quotable consumer is not lambda operation\");\n-            }\n-            if (!(Op.ofLambda(quotableConsumer).get().capturedValues().isEmpty())) {\n+        public FuncOp forEach(Consumer<T> reflectableConsumer) {\n+            Quoted<JavaOp.LambdaOp> quotedConsumer = Op.ofLambda(reflectableConsumer).orElseThrow();\n+            if (!(quotedConsumer.capturedValues().isEmpty())) {\n@@ -190,0 +185,1 @@\n+            JavaOp.LambdaOp consumer = quotedConsumer.op();\n@@ -210,5 +206,3 @@\n-        public <C> FuncOp collect(Supplier<C> quotableSupplier, BiConsumer<C, T> quotableAccumulator) {\n-            if (!(Op.ofLambda(quotableSupplier).get().op() instanceof JavaOp.LambdaOp supplier)) {\n-                throw new IllegalArgumentException(\"Quotable supplier is not lambda operation\");\n-            }\n-            if (!(Op.ofLambda(quotableSupplier).get().capturedValues().isEmpty())) {\n+        public <C> FuncOp collect(Supplier<C> reflectableSupplier, BiConsumer<C, T> reflectableAccumulator) {\n+            Quoted<JavaOp.LambdaOp> quotedSupplier = Op.ofLambda(reflectableSupplier).orElseThrow();\n+            if (!(quotedSupplier.capturedValues().isEmpty())) {\n@@ -217,4 +211,3 @@\n-            if (!(Op.ofLambda(quotableAccumulator).get().op() instanceof JavaOp.LambdaOp accumulator)) {\n-                throw new IllegalArgumentException(\"Quotable accumulator is not lambda operation\");\n-            }\n-            if (!(Op.ofLambda(quotableAccumulator).get().capturedValues().isEmpty())) {\n+            JavaOp.LambdaOp supplier = quotedSupplier.op();\n+            Quoted<JavaOp.LambdaOp> quotedAccumulator = Op.ofLambda(reflectableAccumulator).orElseThrow();\n+            if (!(quotedAccumulator.capturedValues().isEmpty())) {\n@@ -223,0 +216,1 @@\n+            JavaOp.LambdaOp accumulator = quotedAccumulator.op();\n","filename":"test\/jdk\/java\/lang\/reflect\/code\/stream\/StreamFuser.java","additions":21,"deletions":27,"binary":false,"changes":48,"status":"modified"}]}