{"files":[{"patch":"@@ -197,2 +197,2 @@\n-        return (ifaceType.iface.getName().equals(F16.class.getName())\n-                || ifaceType.iface.getName().equals(F16Array.F16Impl.class.getName()));\n+        return ifaceType.iface.isAssignableFrom(F16.class)\n+                || ifaceType.iface.isAssignableFrom(F16Array.F16Impl.class);\n@@ -202,2 +202,2 @@\n-        return (ifaceType.iface.getName().equals(BF16.class.getName())\n-                || ifaceType.iface.getName().equals(BF16Array.BF16Impl.class.getName()));\n+         return ifaceType.iface.isAssignableFrom(BF16.class)\n+               || ifaceType.iface.isAssignableFrom(BF16Array.BF16Impl.class);\n","filename":"hat\/core\/src\/main\/java\/hat\/codebuilders\/C99HATKernelBuilder.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import optkl.OpHelper;\n@@ -56,9 +57,7 @@\n-    static public ReducedFloatType categorizeReducedFloat(JavaOp.InvokeOp invokeOp) {\n-        String invokeClassName = invokeOp.invokeDescriptor().refType().toString();\n-        invokeClassName = invokeClassName.replace(\"$\", \".\");\n-        if (invokeClassName.equals(F16.class.getName())) { \/\/ lets not compare strings here\n-            return ReducedFloatType.HalfFloat.of();\n-        } else if (invokeClassName.equals(BF16.class.getName())) { \/\/ lets not compare strings here\n-            return ReducedFloatType.BFloat16.of();\n-        }\n-        return null;\n+     static public ReducedFloatType categorizeReducedFloat(Invoke invoke) {\n+         if (invoke.refIs(F16.class)){\n+             return ReducedFloatType.HalfFloat.of();\n+         }else if (invoke.refIs(BF16.class)){\n+             return ReducedFloatType.BFloat16.of();\n+         }\n+         return null;\n@@ -154,1 +153,1 @@\n-                        ReducedFloatType category = categorizeReducedFloat(invoke.op());\n+                        ReducedFloatType category = categorizeReducedFloat(invoke);\n@@ -207,1 +206,1 @@\n-                                ReducedFloatType reducedFloatType = categorizeReducedFloat(invoke.op());\n+                                ReducedFloatType reducedFloatType = categorizeReducedFloat(invoke);\n@@ -232,1 +231,1 @@\n-                .ifPresent(invoke -> reducedFloatsType.put(invoke.op(), categorizeReducedFloat(invoke.op())));\n+                .ifPresent(invoke -> reducedFloatsType.put(invoke.op(), categorizeReducedFloat(invoke)));\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATFP16Phase.java","additions":11,"deletions":12,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -82,1 +82,1 @@\n-                    && iop.invokeDescriptor().name().toLowerCase().contains(\"arrayview\")){\n+                    && iop.invokeDescriptor().name().toLowerCase().contains(\"arrayview\")){ \/\/ We need to find a better way\n@@ -122,1 +122,1 @@\n-        return iop.invokeDescriptor().name().toLowerCase().contains(\"arrayview\");\n+        return iop.invokeDescriptor().name().toLowerCase().contains(\"arrayview\"); \/\/ we need a better way\n@@ -127,3 +127,3 @@\n-        return iop.invokeDescriptor().name().toLowerCase().contains(\"local\") ||\n-                iop.invokeDescriptor().name().toLowerCase().contains(\"shared\") ||\n-                iop.invokeDescriptor().name().toLowerCase().contains(\"private\");\n+        return iop.invokeDescriptor().name().toLowerCase().contains(\"local\") || \/\/ we need a better way\n+                iop.invokeDescriptor().name().toLowerCase().contains(\"shared\") || \/\/ also\n+                iop.invokeDescriptor().name().toLowerCase().contains(\"private\"); \/\/ also\n@@ -219,6 +219,1 @@\n-        String invokeClassName = invoke.refType().toString();\n-        invokeClassName = invokeClassName.replace(\"$\", \".\"); \/\/ lets not compare strings here\n-        boolean is16BitFloatOperation = invokeClassName.startsWith(F16.class.getCanonicalName()) || invokeClassName.startsWith(BF16.class.getCanonicalName());\n-        \/\/ No need because F16 element is not a Buffer type at the moment\n-        \/\/ && OpTk.isIfaceBufferMethod(accelerator.lookup, invokeOp)\n-        return is16BitFloatOperation && invoke.named(methodName);\/\/ lets not compare strings here\n+        return invoke.refIs(F16.class,BF16.class) && invoke.named(methodName);\n","filename":"hat\/core\/src\/main\/java\/hat\/phases\/HATPhaseUtils.java","additions":6,"deletions":11,"binary":false,"changes":17,"status":"modified"}]}