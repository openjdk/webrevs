{"files":[{"patch":"@@ -33,2 +33,1 @@\n-    public interface Match {\n-        boolean matched();\n+    public interface Result {\n@@ -37,1 +36,1 @@\n-    public interface OK extends Match {\n+    public interface Match extends Result {\n@@ -40,1 +39,1 @@\n-        default  String string(int idx) {\n+        default  String stringOf(int idx) {\n@@ -44,2 +43,2 @@\n-        default float asFloat(int idx) {\n-            return Float.parseFloat(string(idx));\n+        default float floatOf(int idx) {\n+            return Float.parseFloat(stringOf(idx));\n@@ -48,2 +47,2 @@\n-        default  int asInt(int idx) {\n-            return Integer.parseInt(string(idx));\n+        default  int intOf(int idx) {\n+            return Integer.parseInt(stringOf(idx));\n@@ -51,1 +50,1 @@\n-        default  int[] asInts(int from, int count) {\n+        default  int[] intArrayOf(int from, int count) {\n@@ -54,1 +53,1 @@\n-                ints[i]= Integer.parseInt(string(from + i));\n+                ints[i]= Integer.parseInt(stringOf(from + i));\n@@ -58,1 +57,1 @@\n-        default  float[] asFloats(int from, int count) {\n+        default  float[] floatArrayOf(int from, int count) {\n@@ -61,1 +60,1 @@\n-                floats[i]=Float.parseFloat(string(from + i));\n+                floats[i]=Float.parseFloat(stringOf(from + i));\n@@ -65,6 +64,2 @@\n-    }\n-\n-\n-    public record DefaultOk(Regex regex, Matcher matcher, boolean matched) implements OK {\n-        public static OK of(Regex regex, Matcher matcher) {\n-            return new DefaultOk(regex, matcher, true);\n+        default int count(){\n+            return matcher().groupCount();\n@@ -74,3 +69,3 @@\n-    record FAIL(boolean matched) implements Match {\n-        public static FAIL of() {\n-            return new FAIL(false);\n+    interface FAIL extends Result {\n+        static FAIL of() {\n+            return new FAIL(){};\n@@ -84,1 +79,1 @@\n-    public static Match any(String line, Regex... regexes) {\n+    public static Result any(String line, Regex... regexes) {\n@@ -86,2 +81,2 @@\n-            if (r.is(line) instanceof OK ok) {\n-                return ok;\n+            if (r.is(line) instanceof Match match) {\n+                return match;\n@@ -92,1 +87,1 @@\n-    public Match is(String s, Predicate<Matcher> matcherPredicate, BiFunction<Regex,Matcher,OK> factory) {\n+    public Result is(String s, Predicate<Matcher> matcherPredicate, BiFunction<Regex,Matcher, Match> factory) {\n@@ -99,1 +94,1 @@\n-    public Match is(String s, BiFunction<Regex,Matcher,OK> factory) {\n+    public Result is(String s, BiFunction<Regex,Matcher, Match> factory) {\n@@ -102,2 +97,3 @@\n-    public Match is(String s, Predicate<Matcher> matcherPredicate) {\n-        return is(s, matcherPredicate,(r,m)->new DefaultOk(r,m, true));\n+    public Result is(String s, Predicate<Matcher> matcherPredicate) {\n+        record DefaultMatch(Regex regex, Matcher matcher) implements Match { }\n+        return is(s, matcherPredicate, DefaultMatch::new);\n@@ -105,1 +101,1 @@\n-    public Match is(String s) {\n+    public Result is(String s) {\n@@ -109,1 +105,1 @@\n-        return is(s, matcherPredicate).matched();\n+        return is(s, matcherPredicate) instanceof Match;\n@@ -112,1 +108,1 @@\n-        return is(s).matched();\n+        return is(s) instanceof Match;\n@@ -115,3 +111,1 @@\n-        if(!is(s).matched()){\n-            throw new RuntimeException(\"failed expected match\");\n-        }else{\n+        if(is(s) instanceof Match) {\n@@ -120,0 +114,1 @@\n+        throw new RuntimeException(\"failed expected match\");\n","filename":"hat\/core\/src\/main\/java\/hat\/util\/Regex.java","additions":29,"deletions":34,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -154,1 +154,1 @@\n-    record F32x3(Regex regex, Matcher matcher, boolean matched) implements Regex.OK {\n+    record F32x3(Regex regex, Matcher matcher, boolean matched) implements Regex.Match {\n@@ -156,1 +156,1 @@\n-            var s = string(idx);\n+            var s = stringOf(idx);\n@@ -166,1 +166,1 @@\n-    record S32xN(Regex regex, Matcher matcher, boolean matched) implements Regex.OK {\n+    record S32xN(Regex regex, Matcher matcher, boolean matched) implements Regex.Match {\n@@ -195,1 +195,1 @@\n-                            mesh.get().hex(s32xN.asInts(6, 6), 0xff7f00);\n+                            mesh.get().hex(s32xN.intArrayOf(6, 6), 0xff7f00);\n@@ -198,1 +198,1 @@\n-                            mesh.get().pent(s32xN.asInts(6, 5), 0x7fff00);\n+                            mesh.get().pent(s32xN.intArrayOf(6, 5), 0x7fff00);\n@@ -201,1 +201,1 @@\n-                            mesh.get().quad(s32xN.asInts(6, 4), 0x00ff7f);\n+                            mesh.get().quad(s32xN.intArrayOf(6, 4), 0x00ff7f);\n@@ -205,1 +205,1 @@\n-                            mesh.get().tri(s32xN.asInts(6, 3), 0x007fff);\n+                            mesh.get().tri(s32xN.intArrayOf(6, 3), 0x007fff);\n@@ -216,1 +216,1 @@\n-                        case State _ when Regex.any(line, State.remRegex, State.emptyRegex, State.colonRegex).matched() -> {\n+                        case State _ when Regex.any(line, State.remRegex, State.emptyRegex, State.colonRegex) instanceof Regex.Match -> {\n","filename":"hat\/examples\/view\/src\/main\/java\/view\/EliteMeshParser.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+import hat.util.Regex;\n@@ -69,2 +70,0 @@\n-import java.util.regex.Matcher;\n-import java.util.regex.Pattern;\n@@ -76,2 +75,2 @@\n-    public static final Pattern RectRegex = Pattern.compile(FloatPointRegex + \",\" + FloatPointRegex);\n-    public static final Pattern PointRegex = Pattern.compile(FloatPointRegex);\n+    public static final Regex RectRegex = Regex.of(FloatPointRegex,  \",\",FloatPointRegex);\n+    public static final Regex PointRegex = Regex.of(FloatPointRegex);\n@@ -555,3 +554,2 @@\n-        this.bounds = RectRegex.matcher(bb) instanceof Matcher m && m.matches() && m.groupCount() == 4\n-                ? new Rectangle2D.Float(Float.parseFloat(m.group(1)), Float.parseFloat(m.group(2)),\n-                Float.parseFloat(m.group(3)), Float.parseFloat(m.group(4)))\n+        this.bounds = RectRegex.is(bb) instanceof Regex.Match m && m.count() == 4\n+                ? new Rectangle2D.Float(m.floatOf(1), m.floatOf(2),m.floatOf(3), m.floatOf(4))\n@@ -567,2 +565,2 @@\n-                    .map(s -> (PointRegex.matcher(s) instanceof Matcher m && m.matches() && m.groupCount() == 2)\n-                            ? new Point2D.Float(Float.parseFloat(m.group(1)), bounds.height - Float.parseFloat(m.group(2)))\n+                    .map(s -> (PointRegex.is(s) instanceof Regex.Match m && m.count() == 2)\n+                            ? new Point2D.Float(m.floatOf(1), bounds.height - m.floatOf(2))\n@@ -577,2 +575,2 @@\n-                    .map(s -> (PointRegex.matcher(s) instanceof Matcher m && m.matches() && m.groupCount() == 2)\n-                            ? new Point2D.Float(Float.parseFloat(m.group(1)), bounds.height - Float.parseFloat(m.group(2)))\n+                    .map(s -> (PointRegex.is(s) instanceof Regex.Match m && m.count() == 2)\n+                            ? new Point2D.Float(m.floatOf(1), bounds.height - m.floatOf(2))\n@@ -584,6 +582,4 @@\n-                    if (RectRegex.matcher(s) instanceof Matcher m && m.matches() && m.groupCount() == 4) {\n-                        var x1 = Float.parseFloat(m.group(1));\n-                        var y1 = bounds.height - Float.parseFloat(m.group(4));\n-                        var x2 = Float.parseFloat(m.group(3));\n-                        var y2 = bounds.height - Float.parseFloat(m.group(2));\n-                        return new Rectangle2D.Float(x1, y1, x2 - x1, y2 - y1);\n+                    if (RectRegex.is(s) instanceof Regex.Match m &&  m.count() == 4) {\n+                        var y1 = bounds.height - m.floatOf(4);\n+                        var y2 = bounds.height - m.floatOf(2);\n+                        return new Rectangle2D.Float(m.floatOf(1), y1, m.floatOf(3) - m.floatOf(1), y2 - y1);\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/jdot\/ui\/JDot.java","additions":13,"deletions":17,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import hat.util.Regex;\n@@ -51,2 +52,0 @@\n-import java.util.regex.Matcher;\n-import java.util.regex.Pattern;\n@@ -79,1 +78,1 @@\n-        static Pattern locPattern = Pattern.compile(\"\\\"([0-9]+):([0-9]+)[^\\\"]*\\\"\");\n+        static Regex locPattern = Regex.of(\"\\\"([0-9]+):([0-9]+)[^\\\"]*\\\"\");\n@@ -85,3 +84,3 @@\n-            if (locPattern.matcher(r.asString()) instanceof Matcher m && m.matches() && m.groupCount() > 1) {\n-                line = Integer.parseInt(m.group(1));\n-                col = Integer.parseInt(m.group(2));\n+            if (locPattern.is(r.asString()) instanceof Regex.Match m && m.count() > 1) {\n+                line = m.intOf(1);\n+                col = m.intOf(2);\n@@ -105,1 +104,1 @@\n-        static Pattern locFilePattern = Pattern.compile(\"\\\"([0-9]+):([0-9]+):file:([^\\\"]*)\\\"\");\n+        static Regex locFilePattern = Regex.of(\"\\\"([0-9]+):([0-9]+):file:([^\\\"]*)\\\"\");\n@@ -109,5 +108,2 @@\n-            return locFilePattern.matcher(fileLocString) instanceof Matcher m\n-                    && m.matches()\n-                    && m.groupCount() > 2\n-                    && m.group(3) instanceof String filename\n-                    && Path.of(filename) instanceof Path javaSource\n+            return locFilePattern.is(fileLocString) instanceof Regex.Match m && m.count() > 2\n+                    && m.stringOf(3) instanceof String filename && Path.of(filename) instanceof Path javaSource\n@@ -147,1 +143,1 @@\n-        static final public Pattern regex = Pattern.compile(\"block_([0-9]+)\");\n+        static final public Regex regex = Regex.of(\"block_([0-9]+)\");\n@@ -153,2 +149,2 @@\n-            if (regex.matcher(t2.asString()) instanceof Matcher m && m.matches() && m.groupCount() == 1) {\n-                id = Integer.parseInt(m.group(1));\n+            if (regex.is(t2.asString()) instanceof Regex.Match m && m.count() == 1) {\n+                id = m.intOf(1);\n@@ -188,1 +184,1 @@\n-        public static final Pattern regex = Pattern.compile(\n+        public static final Regex regex = Regex.of(\n@@ -198,1 +194,1 @@\n-        public static final Pattern regex = Pattern.compile(\"java\\\\.(if|while)\");\n+        public static final Regex regex = Regex.of(\"java\\\\.(if|while)\");\n@@ -233,1 +229,1 @@\n-        Pattern reservedWords = Pattern.compile(\"(func|Var)\");\n+       Regex reservedWords = Regex.of(\"(func|Var)\");\n@@ -347,2 +343,2 @@\n-                    && sl.matcher(BabylonFileLocationAttribute.locFilePattern) instanceof Matcher m\n-                    && Path.of(m.group(3)) instanceof Path javaSource && Files.exists(javaSource)\n+                    && BabylonFileLocationAttribute.locFilePattern.is(sl.asString()) instanceof Regex.Match m\n+                    && Path.of(m.stringOf(3)) instanceof Path javaSource && Files.exists(javaSource)\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/textmodel\/BabylonTextModel.java","additions":16,"deletions":20,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -36,2 +36,1 @@\n-\n-import java.util.regex.Pattern;\n+import hat.util.Regex;\n@@ -43,1 +42,1 @@\n-        public static final Pattern regex = Pattern.compile(\"static|abstract|public|private|protected|final\");\n+        public static final Regex regex = Regex.of(\"static|abstract|public|private|protected|final\");\n@@ -49,1 +48,2 @@\n-       public static final Pattern regex = Pattern.compile(\n+\n+        public static final Regex regex = Regex.of(\n@@ -51,1 +51,1 @@\n-       );\n+        );\n@@ -73,1 +73,1 @@\n-         Pattern javaTypes = Pattern.compile(\"void|int|float|double|boolean|char|short|long|class|record|interface|String\");\n+         Regex javaTypes = Regex.of(\"void|int|float|double|boolean|char|short|long|class|record|interface|String\");\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/textmodel\/JavaTextModel.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -27,0 +27,3 @@\n+\n+import hat.util.Regex;\n+\n@@ -28,1 +31,0 @@\n-import java.util.regex.Pattern;\n@@ -34,1 +36,1 @@\n-public static final Pattern regex = Pattern.compile(\"[A-Za-z][A-Za-z0-9_]*\");\n+public static final Regex regex = Regex.of(\"[A-Za-z][A-Za-z0-9_]*\");\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/textmodel\/tokens\/DottedName.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,0 +27,2 @@\n+import hat.util.Regex;\n+\n@@ -28,1 +30,0 @@\n-import java.util.regex.Pattern;\n@@ -32,1 +33,1 @@\n-    public static final Pattern regex = Pattern.compile(\"[0-9][0-9]*\");\n+    public static final Regex regex = Regex.of(\"[0-9][0-9]*\");\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/textmodel\/tokens\/IntConst.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,2 @@\n+import hat.util.Regex;\n+\n@@ -29,2 +31,0 @@\n-import java.util.regex.Matcher;\n-import java.util.regex.Pattern;\n@@ -46,4 +46,4 @@\n-    default Matcher matcher(Pattern regex) {\n-        Matcher matcher = regex.matcher(asString());\n-        if (matcher.matches()) {\n-            return matcher;\n+    default Regex.Match matcher(Regex regex) {\n+        Regex.Result matcher = regex.is(asString());\n+        if (matcher instanceof Regex.Match) {\n+            return (Regex.Match) matcher;\n@@ -55,1 +55,2 @@\n-    default boolean matches(Pattern regex) {\n+\n+    default boolean matches(Regex regex) {\n","filename":"hat\/tools\/src\/main\/java\/hat\/tools\/textmodel\/tokens\/Leaf.java","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"}]}