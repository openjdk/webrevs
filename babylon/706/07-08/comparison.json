{"files":[{"patch":"@@ -1004,0 +1004,1 @@\n+                    Label defTarget = null;\n@@ -1005,4 +1006,12 @@\n-                        int val = op.labels().get(i);\n-                        cases.add(SwitchCase.of(val, getLabel(op.successors().get(i))));\n-                        if (val < lo) lo = val;\n-                        if (val > hi) hi = val;\n+                        Integer val = op.labels().get(i);\n+                        Label target = getLabel(op.successors().get(i));\n+                        if (val == null) { \/\/ default target has null label value\n+                            defTarget = target;\n+                        } else {\n+                            cases.add(SwitchCase.of(val, target));\n+                            if (val < lo) lo = val;\n+                            if (val > hi) hi = val;\n+                        }\n+                    }\n+                    if (defTarget == null) {\n+                        throw new IllegalArgumentException(\"Missing default target\");\n@@ -1010,1 +1019,0 @@\n-                    Label defTarget = getLabel(op.successors().getLast());\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/bytecode\/BytecodeGenerator.java","additions":13,"deletions":5,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- * and the same number of successors + 1 (the default).\n+ * and the same number of successors.\n@@ -43,1 +43,2 @@\n- * If none of the labels is matching, the last \"default\" successor is selected.\n+ * If none of the labels is matching, the default successor is selected.\n+ * Default is a successor with corresponds null label value.\n@@ -53,1 +54,1 @@\n-        assert targets.size() == labels.size() + 1; \/\/ last is the default target\n+        assert targets.size() == labels.size();\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/bytecode\/impl\/ConstantLabelSwitchOp.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -223,2 +223,2 @@\n-            \/\/ getLabels returns an empty list, for case default\n-            targets.addAll(Collections.nCopies(Math.max(ls.size(), 1), swOp.bodies().get(i + 1).entryBlock()));\n+            \/\/ getLabels returns list with null, for case default\n+            targets.addAll(Collections.nCopies(ls.size(), swOp.bodies().get(i + 1).entryBlock()));\n@@ -244,1 +244,3 @@\n-        } else if (!(opr.op() instanceof CoreOp.ConstantOp)){ \/\/ not default label\n+        } else if (opr.op() instanceof CoreOp.ConstantOp){ \/\/ default label\n+            labels.add(null);\n+        } else {\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/bytecode\/impl\/LoweringTransform.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}