{"files":[{"patch":"@@ -501,0 +501,2 @@\n+     * @throws UnsupportedOperationException If The Java version used at compile time to generate and store the code model\n+     *                                       is not the same as the Java version used at runtime to load the code model.\n@@ -537,0 +539,2 @@\n+     * @throws UnsupportedOperationException If The Java version used at compile time to generate and store the code model\n+     *                                       is not the same as the Java version used at runtime to load the code model.\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/Op.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -5264,2 +5264,2 @@\n-                                  TypeElement returnType, MethodRef invokeDescriptor, List<Value> args) {\n-        return new InvokeOp(invokeKind, isVarArgs, returnType, invokeDescriptor, args);\n+                                  TypeElement returnType, MethodRef invokeDescriptor, Value... args) {\n+        return new InvokeOp(invokeKind, isVarArgs, returnType, invokeDescriptor, List.of(args));\n@@ -5281,2 +5281,2 @@\n-                                  TypeElement returnType, MethodRef invokeDescriptor, Value... args) {\n-        return new InvokeOp(invokeKind, isVarArgs, returnType, invokeDescriptor, List.of(args));\n+                                  TypeElement returnType, MethodRef invokeDescriptor, List<Value> args) {\n+        return new InvokeOp(invokeKind, isVarArgs, returnType, invokeDescriptor, args);\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/dialect\/java\/JavaOp.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -429,2 +429,3 @@\n-        \/\/ check java version\n-        var expectedVersion = builder.op(constant(INT, Runtime.version().feature()));\n+        \/\/ check if java version at compile time matches the java version at runtime\n+        var compiletimeVersion = Runtime.version().feature();\n+        \/\/ runtimeVersion = Runtime.version().feature()\n@@ -432,1 +433,1 @@\n-        var actualVersion = builder.op(invoke(MethodRef.method(Runtime.Version.class, \"feature\", int.class), version));\n+        var runtimeVersion = builder.op(invoke(MethodRef.method(Runtime.Version.class, \"feature\", int.class), version));\n@@ -434,1 +435,1 @@\n-            var p = c.op(neq(actualVersion, expectedVersion));\n+            var p = c.op(neq(runtimeVersion, builder.op(constant(INT, compiletimeVersion))));\n@@ -437,5 +438,5 @@\n-            var errMessage = t.op(invoke(\n-                    InvokeOp.InvokeKind.STATIC, true,\n-                    J_L_STRING, STRING_FORMAT,\n-                    t.op(constant(J_L_STRING, \"Code model was compiled with java version %d, but the actual version is %d\")),\n-                    box(J_L_INTEGER, expectedVersion), box(J_L_INTEGER, actualVersion)\n+            var s = \"The Java version used at compile time to generate and store the code model, Java \" + compiletimeVersion +\n+                    \", is not the same as the Java version used at runtime to load the code model, Java \";\n+            var errMessage = t.op(concat(\n+                    t.op(constant(J_L_STRING, s)),\n+                    runtimeVersion\n@@ -444,1 +445,1 @@\n-                    t.op(new_(MethodRef.constructor(IllegalStateException.class, String.class), errMessage))\n+                    t.op(new_(MethodRef.constructor(UnsupportedOperationException.class, String.class), errMessage))\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/internal\/OpBuilder.java","additions":11,"deletions":10,"binary":false,"changes":21,"status":"modified"}]}