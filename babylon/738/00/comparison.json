{"files":[{"patch":"@@ -5268,0 +5268,17 @@\n+    \/**\n+     * Creates an invoke operation modelling an invocation to a method.\n+     *\n+     * @param invokeKind       the invoke kind\n+     * @param isVarArgs        true if an invocation to a variable argument method\n+     * @param returnType       the return type\n+     * @param invokeDescriptor the invoke descriptor\n+     * @param args             the invoke arguments\n+     * @return the invoke operation\n+     * @throws IllegalArgumentException if there is a mismatch between the argument count\n+     *                                  and the invoke descriptors parameter count.\n+     *\/\n+    public static InvokeOp invoke(InvokeOp.InvokeKind invokeKind, boolean isVarArgs,\n+                                  TypeElement returnType, MethodRef invokeDescriptor, Value... args) {\n+        return new InvokeOp(invokeKind, isVarArgs, returnType, invokeDescriptor, List.of(args));\n+    }\n+\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/dialect\/java\/JavaOp.java","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -179,0 +179,4 @@\n+    static final MethodRef STRING_FORMAT = MethodRef.method(String.class, \"format\", String.class, String.class,\n+            Object[].class);\n+\n+\n@@ -425,0 +429,19 @@\n+        \/\/ check java version\n+        var expectedVersion = builder.op(constant(INT, Runtime.version().feature()));\n+        var version = builder.op(invoke(MethodRef.method(Runtime.class, \"version\", Runtime.Version.class)));\n+        var actualVersion = builder.op(invoke(MethodRef.method(Runtime.Version.class, \"feature\", int.class), version));\n+        IfOp ifop = if_(builder.parentBody()).if_(c -> {\n+            var p = c.op(neq(actualVersion, expectedVersion));\n+            c.op(core_yield(p));\n+        }).then(t -> {\n+            var errMessage = t.op(invoke(\n+                    InvokeOp.InvokeKind.STATIC, true,\n+                    J_L_STRING, STRING_FORMAT,\n+                    t.op(constant(J_L_STRING, \"Code model was compiled with java version %d, but the actual version is %d\")),\n+                    box(J_L_INTEGER, expectedVersion), box(J_L_INTEGER, actualVersion)\n+            ));\n+            t.op(throw_(\n+                    t.op(new_(MethodRef.constructor(IllegalStateException.class, String.class), errMessage))\n+            ));\n+        }).else_();\n+        builder.op(ifop);\n","filename":"src\/jdk.incubator.code\/share\/classes\/jdk\/incubator\/code\/internal\/OpBuilder.java","additions":23,"deletions":0,"binary":false,"changes":23,"status":"modified"}]}