{"files":[{"patch":"@@ -146,0 +146,1 @@\n+  _append = append;\n@@ -148,1 +149,1 @@\n-    init_file_stream(file_name, use_multiple_files, append);\n+    init_file_stream(file_name, use_multiple_files);\n@@ -153,1 +154,1 @@\n-  if (!append) {\n+  if (!_append) {\n@@ -160,1 +161,3 @@\n-  tail(TOP_ELEMENT);\n+  if (!_append) {\n+    tail(TOP_ELEMENT);\n+  }\n@@ -863,1 +866,1 @@\n-void IdealGraphPrinter::init_file_stream(const char* file_name, bool use_multiple_files, bool append) {\n+void IdealGraphPrinter::init_file_stream(const char* file_name, bool use_multiple_files) {\n@@ -866,1 +869,1 @@\n-    assert(!append, \"append should only be used for debugging with a single file\");\n+    assert(!_append, \"append should only be used for debugging with a single file\");\n@@ -878,1 +881,1 @@\n-    _output = new (mtCompiler) fileStream(file_name, append ? \"a\" : \"w\");\n+    _output = new (mtCompiler) fileStream(file_name, _append ? \"a\" : \"w\");\n@@ -881,1 +884,1 @@\n-    assert(!append, \"append should only be used for debugging with a single file\");\n+    assert(!_append, \"append should only be used for debugging with a single file\");\n@@ -912,3 +915,10 @@\n-    end_method();\n-    _current_method = nullptr;\n-    begin_method();\n+    if (_append) {\n+      \/\/ Do not call `end_method` if we are appending, just update `_current_method`,\n+      \/\/ because `begin_method` is not called in the constructor in append mode.\n+      _current_method = current_method;\n+    } else {\n+      \/\/ End the old method and begin a new one.\n+      \/\/ Don't worry about `_current_method`, `end_method` will clear it.\n+      end_method();\n+      begin_method();\n+    }\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":20,"deletions":10,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -99,0 +99,1 @@\n+  bool _append;\n@@ -121,1 +122,1 @@\n-  void init_file_stream(const char* file_name, bool use_multiple_files, bool append);\n+  void init_file_stream(const char* file_name, bool use_multiple_files);\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}