{"files":[{"patch":"@@ -120,1 +120,1 @@\n-    common_abi* sender_abi = (common_abi*) fp;\n+    volatile common_abi* sender_abi = (common_abi*) fp; \/\/ May get updated concurrently by deoptimization!\n@@ -122,1 +122,1 @@\n-    address   sender_pc = (address) sender_abi->lr;;\n+    address   sender_pc = (address) sender_abi->lr;\n@@ -137,0 +137,9 @@\n+    intptr_t* unextended_sender_sp = is_interpreted_frame() ? interpreter_frame_sender_sp() : sender_sp;\n+\n+    \/\/ If the sender is a deoptimized nmethod we need to check if the original pc is valid.\n+    nmethod* sender_nm = sender_blob->as_nmethod_or_null();\n+    if (sender_nm != nullptr && sender_nm->is_deopt_pc(sender_pc)) {\n+      address orig_pc = *(address*)((address)unextended_sender_sp + sender_nm->orig_pc_offset());\n+      if (!sender_nm->insts_contains_inclusive(orig_pc)) return false;\n+    }\n+\n@@ -139,1 +148,1 @@\n-    frame sender(sender_sp, sender_pc, nullptr \/* unextended_sp *\/, nullptr \/* fp *\/, sender_blob);\n+    frame sender(sender_sp, sender_pc, unextended_sender_sp, nullptr \/* fp *\/, sender_blob);\n","filename":"src\/hotspot\/cpu\/ppc\/frame_ppc.cpp","additions":12,"deletions":3,"binary":false,"changes":15,"status":"modified"}]}