{"files":[{"patch":"@@ -318,0 +318,1 @@\n+  \/\/ ...and clear or zap just allocated TLAB, if needed.\n@@ -319,1 +320,0 @@\n-    \/\/ ..and clear it.\n@@ -321,3 +321,1 @@\n-  } else {\n-    \/\/ ...and zap just allocated object.\n-#ifdef ASSERT\n+  } else if (ZapTLAB) {\n@@ -329,1 +327,0 @@\n-#endif \/\/ ASSERT\n","filename":"src\/hotspot\/share\/gc\/shared\/memAllocator.cpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -42,8 +42,2 @@\n-    \/\/ successful thread-local allocation\n-#ifdef ASSERT\n-    \/\/ Skip mangling the space corresponding to the object header to\n-    \/\/ ensure that the returned space is not considered parsable by\n-    \/\/ any concurrent GC thread.\n-    size_t hdr_size = oopDesc::header_size();\n-    Copy::fill_to_words(obj + hdr_size, size - hdr_size, badHeapWordVal);\n-#endif \/\/ ASSERT\n+    \/\/ Successful thread-local allocation.\n+\n","filename":"src\/hotspot\/share\/gc\/shared\/threadLocalAllocBuffer.inline.hpp","additions":3,"deletions":9,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -821,0 +821,1 @@\n+  \/\/ ...and clear or zap just allocated TLAB, if needed.\n@@ -822,1 +823,0 @@\n-    \/\/ ..and clear it.\n@@ -824,3 +824,1 @@\n-  } else {\n-    \/\/ ...and zap just allocated object.\n-#ifdef ASSERT\n+  } else if (ZapTLAB) {\n@@ -832,1 +830,0 @@\n-#endif \/\/ ASSERT\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -1994,5 +1994,3 @@\n-              \/\/ Initialize object field block:\n-              \/\/   - if TLAB is pre-zeroed, we can skip this path\n-              \/\/   - in debug mode, ThreadLocalAllocBuffer::allocate mangles\n-              \/\/     this area, and we still need to initialize it\n-              if (DEBUG_ONLY(true ||) !ZeroTLAB) {\n+              \/\/ Initialize object field block.\n+              if (!ZeroTLAB) {\n+                \/\/ The TLAB was not pre-zeroed, we need to clear the memory here.\n","filename":"src\/hotspot\/share\/interpreter\/zero\/bytecodeInterpreter.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -490,0 +490,3 @@\n+  develop(bool, ZapTLAB, trueInDebug,                                       \\\n+          \"Zap allocated TLABs\")                                            \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}