{"files":[{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2020 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -185,2 +185,0 @@\n-static jlong    initial_time_count = 0;\n-static int      clock_tics_per_sec = 100;\n@@ -939,15 +937,0 @@\n-\/\/ Time since start-up in seconds to a fine granularity.\n-double os::elapsedTime() {\n-  return ((double)os::elapsed_counter()) \/ os::elapsed_frequency(); \/\/ nanosecond resolution\n-}\n-\n-jlong os::elapsed_counter() {\n-  return javaTimeNanos() - initial_time_count;\n-}\n-\n-jlong os::elapsed_frequency() {\n-  return NANOSECS_PER_SEC; \/\/ nanosecond resolution\n-}\n-\n-bool os::supports_vtime() { return true; }\n-\n@@ -1020,35 +1003,0 @@\n-\/\/ Return the real, user, and system times in seconds from an\n-\/\/ arbitrary fixed point in the past.\n-bool os::getTimesSecs(double* process_real_time,\n-                      double* process_user_time,\n-                      double* process_system_time) {\n-  struct tms ticks;\n-  clock_t real_ticks = times(&ticks);\n-\n-  if (real_ticks == (clock_t) (-1)) {\n-    return false;\n-  } else {\n-    double ticks_per_second = (double) clock_tics_per_sec;\n-    *process_user_time = ((double) ticks.tms_utime) \/ ticks_per_second;\n-    *process_system_time = ((double) ticks.tms_stime) \/ ticks_per_second;\n-    *process_real_time = ((double) real_ticks) \/ ticks_per_second;\n-\n-    return true;\n-  }\n-}\n-\n-char * os::local_time_string(char *buf, size_t buflen) {\n-  struct tm t;\n-  time_t long_time;\n-  time(&long_time);\n-  localtime_r(&long_time, &t);\n-  jio_snprintf(buf, buflen, \"%d-%02d-%02d %02d:%02d:%02d\",\n-               t.tm_year + 1900, t.tm_mon + 1, t.tm_mday,\n-               t.tm_hour, t.tm_min, t.tm_sec);\n-  return buf;\n-}\n-\n-struct tm* os::localtime_pd(const time_t* clock, struct tm* res) {\n-  return localtime_r(clock, res);\n-}\n-\n@@ -2420,2 +2368,0 @@\n-  clock_tics_per_sec = sysconf(_SC_CLK_TCK);\n-\n@@ -2425,2 +2371,0 @@\n-  initial_time_count = javaTimeNanos();\n-\n","filename":"src\/hotspot\/os\/aix\/os_aix.cpp","additions":1,"deletions":57,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -126,4 +126,0 @@\n-static jlong initial_time_count=0;\n-\n-static int clock_tics_per_sec = 100;\n-\n@@ -761,16 +757,0 @@\n-\n-\/\/ Time since start-up in seconds to a fine granularity.\n-double os::elapsedTime() {\n-  return ((double)os::elapsed_counter()) \/ os::elapsed_frequency();\n-}\n-\n-jlong os::elapsed_counter() {\n-  return javaTimeNanos() - initial_time_count;\n-}\n-\n-jlong os::elapsed_frequency() {\n-  return NANOSECS_PER_SEC; \/\/ nanosecond resolution\n-}\n-\n-bool os::supports_vtime() { return true; }\n-\n@@ -826,1 +806,0 @@\n-\n@@ -829,36 +808,0 @@\n-\/\/ Return the real, user, and system times in seconds from an\n-\/\/ arbitrary fixed point in the past.\n-bool os::getTimesSecs(double* process_real_time,\n-                      double* process_user_time,\n-                      double* process_system_time) {\n-  struct tms ticks;\n-  clock_t real_ticks = times(&ticks);\n-\n-  if (real_ticks == (clock_t) (-1)) {\n-    return false;\n-  } else {\n-    double ticks_per_second = (double) clock_tics_per_sec;\n-    *process_user_time = ((double) ticks.tms_utime) \/ ticks_per_second;\n-    *process_system_time = ((double) ticks.tms_stime) \/ ticks_per_second;\n-    *process_real_time = ((double) real_ticks) \/ ticks_per_second;\n-\n-    return true;\n-  }\n-}\n-\n-\n-char * os::local_time_string(char *buf, size_t buflen) {\n-  struct tm t;\n-  time_t long_time;\n-  time(&long_time);\n-  localtime_r(&long_time, &t);\n-  jio_snprintf(buf, buflen, \"%d-%02d-%02d %02d:%02d:%02d\",\n-               t.tm_year + 1900, t.tm_mon + 1, t.tm_mday,\n-               t.tm_hour, t.tm_min, t.tm_sec);\n-  return buf;\n-}\n-\n-struct tm* os::localtime_pd(const time_t* clock, struct tm*  res) {\n-  return localtime_r(clock, res);\n-}\n-\n@@ -2034,2 +1977,0 @@\n-  clock_tics_per_sec = CLK_TCK;\n-\n@@ -2048,1 +1989,0 @@\n-  initial_time_count = javaTimeNanos();\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":0,"deletions":60,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -176,2 +176,0 @@\n-static jlong initial_time_count=0;\n-\n@@ -1339,16 +1337,0 @@\n-\n-\/\/ Time since start-up in seconds to a fine granularity.\n-double os::elapsedTime() {\n-  return ((double)os::elapsed_counter()) \/ os::elapsed_frequency(); \/\/ nanosecond resolution\n-}\n-\n-jlong os::elapsed_counter() {\n-  return javaTimeNanos() - initial_time_count;\n-}\n-\n-jlong os::elapsed_frequency() {\n-  return NANOSECS_PER_SEC; \/\/ nanosecond resolution\n-}\n-\n-bool os::supports_vtime() { return true; }\n-\n@@ -1392,36 +1374,0 @@\n-\/\/ Return the real, user, and system times in seconds from an\n-\/\/ arbitrary fixed point in the past.\n-bool os::getTimesSecs(double* process_real_time,\n-                      double* process_user_time,\n-                      double* process_system_time) {\n-  struct tms ticks;\n-  clock_t real_ticks = times(&ticks);\n-\n-  if (real_ticks == (clock_t) (-1)) {\n-    return false;\n-  } else {\n-    double ticks_per_second = (double) clock_tics_per_sec;\n-    *process_user_time = ((double) ticks.tms_utime) \/ ticks_per_second;\n-    *process_system_time = ((double) ticks.tms_stime) \/ ticks_per_second;\n-    *process_real_time = ((double) real_ticks) \/ ticks_per_second;\n-\n-    return true;\n-  }\n-}\n-\n-\n-char * os::local_time_string(char *buf, size_t buflen) {\n-  struct tm t;\n-  time_t long_time;\n-  time(&long_time);\n-  localtime_r(&long_time, &t);\n-  jio_snprintf(buf, buflen, \"%d-%02d-%02d %02d:%02d:%02d\",\n-               t.tm_year + 1900, t.tm_mon + 1, t.tm_mday,\n-               t.tm_hour, t.tm_min, t.tm_sec);\n-  return buf;\n-}\n-\n-struct tm* os::localtime_pd(const time_t* clock, struct tm*  res) {\n-  return localtime_r(clock, res);\n-}\n-\n@@ -4508,2 +4454,0 @@\n-\n-  initial_time_count = javaTimeNanos();\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":0,"deletions":56,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -65,0 +65,2 @@\n+#include <sys\/time.h>\n+#include <sys\/times.h>\n@@ -92,0 +94,4 @@\n+static jlong initial_time_count = 0;\n+\n+static int clock_tics_per_sec = 100;\n+\n@@ -1313,1 +1319,5 @@\n-\n+#if defined(_ALLBSD_SOURCE)\n+  clock_tics_per_sec = CLK_TCK;\n+#else\n+  clock_tics_per_sec = sysconf(_SC_CLK_TCK);\n+#endif\n@@ -1345,0 +1355,2 @@\n+\n+  initial_time_count = javaTimeNanos();\n@@ -1512,1 +1524,0 @@\n-\n@@ -1515,0 +1526,51 @@\n+\/\/ Time since start-up in seconds to a fine granularity.\n+double os::elapsedTime() {\n+  return ((double)os::elapsed_counter()) \/ os::elapsed_frequency(); \/\/ nanosecond resolution\n+}\n+\n+jlong os::elapsed_counter() {\n+  return os::javaTimeNanos() - initial_time_count;\n+}\n+\n+jlong os::elapsed_frequency() {\n+  return NANOSECS_PER_SEC; \/\/ nanosecond resolution\n+}\n+\n+bool os::supports_vtime() { return true; }\n+\n+\/\/ Return the real, user, and system times in seconds from an\n+\/\/ arbitrary fixed point in the past.\n+bool os::getTimesSecs(double* process_real_time,\n+                      double* process_user_time,\n+                      double* process_system_time) {\n+  struct tms ticks;\n+  clock_t real_ticks = times(&ticks);\n+\n+  if (real_ticks == (clock_t) (-1)) {\n+    return false;\n+  } else {\n+    double ticks_per_second = (double) clock_tics_per_sec;\n+    *process_user_time = ((double) ticks.tms_utime) \/ ticks_per_second;\n+    *process_system_time = ((double) ticks.tms_stime) \/ ticks_per_second;\n+    *process_real_time = ((double) real_ticks) \/ ticks_per_second;\n+\n+    return true;\n+  }\n+}\n+\n+char * os::local_time_string(char *buf, size_t buflen) {\n+  struct tm t;\n+  time_t long_time;\n+  time(&long_time);\n+  localtime_r(&long_time, &t);\n+  jio_snprintf(buf, buflen, \"%d-%02d-%02d %02d:%02d:%02d\",\n+               t.tm_year + 1900, t.tm_mon + 1, t.tm_mday,\n+               t.tm_hour, t.tm_min, t.tm_sec);\n+  return buf;\n+}\n+\n+struct tm* os::localtime_pd(const time_t* clock, struct tm*  res) {\n+  return localtime_r(clock, res);\n+}\n+\n+\n","filename":"src\/hotspot\/os\/posix\/os_posix.cpp","additions":64,"deletions":2,"binary":false,"changes":66,"status":"modified"}]}