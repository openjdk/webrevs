{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,1 +35,3 @@\n- * @run main TestUnloadClassError\n+ * @build jdk.test.whitebox.WhiteBox\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller jdk.test.whitebox.WhiteBox\n+ * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI TestUnloadClassError\n","filename":"test\/hotspot\/jtreg\/runtime\/BadObjectClass\/TestUnloadClassError.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -37,2 +37,4 @@\n- *\n- * @run main\/othervm -Xlog:class+unload=trace TestNestHostErrorWithClassUnload\n+\n+ * @build jdk.test.whitebox.WhiteBox\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller jdk.test.whitebox.WhiteBox\n+ * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI -Xlog:class+unload=trace TestNestHostErrorWithClassUnload\n","filename":"test\/hotspot\/jtreg\/runtime\/Nestmates\/membership\/TestNestHostErrorWithClassUnload.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,2 @@\n+ * @build jdk.test.whitebox.WhiteBox\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller jdk.test.whitebox.WhiteBox\n@@ -71,0 +73,3 @@\n+        String classPath = System.getProperty(\"test.class.path\", \".\");\n+\n+        \/\/ Sub-process does not get all the properties automatically, so the test class path needs to be passed explicitly\n@@ -73,2 +78,2 @@\n-        Collections.addAll(argsList, \"-Xmn8m\", \"-Dtest.class.path=\" + System.getProperty(\"test.class.path\", \".\"),\n-                            \"-XX:+ClassUnloading\", ClassUnloadTestMain.class.getName());\n+        Collections.addAll(argsList, \"-Xmn8m\", \"-Xbootclasspath\/a:.\", \"-XX:+UnlockDiagnosticVMOptions\",\n+                           \"-XX:+WhiteBoxAPI\", \"-XX:+ClassUnloading\", \"-Dtest.class.path=\" + classPath, ClassUnloadTestMain.class.getName());\n@@ -87,1 +92,1 @@\n-        checkFor(output, \"[class,unload]\", \"unloading class\");\n+        checkFor(output, \"[class,unload]\", \"unloading class test.Empty\");\n","filename":"test\/hotspot\/jtreg\/runtime\/logging\/ClassLoadUnloadTest.java","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,2 @@\n+ * @build jdk.test.whitebox.WhiteBox\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller jdk.test.whitebox.WhiteBox\n@@ -63,1 +65,3 @@\n-        Collections.addAll(argsList, \"-Dtest.classes=\" + System.getProperty(\"test.classes\",\".\"));\n+        Collections.addAll(argsList, \"-Xbootclasspath\/a:.\");\n+        Collections.addAll(argsList, \"-XX:+UnlockDiagnosticVMOptions\");\n+        Collections.addAll(argsList, \"-XX:+WhiteBoxAPI\");\n","filename":"test\/hotspot\/jtreg\/runtime\/logging\/LoaderConstraintsTest.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * To use ClassUnloadCommon from a sub-process, see hotspot\/test\/runtime\/logging\/ClassLoadUnloadTest.java\n+ * To use ClassUnloadCommon from a sub-process, see test\/hotspot\/jtreg\/runtime\/logging\/ClassLoadUnloadTest.java\n@@ -32,0 +32,1 @@\n+import jdk.test.whitebox.WhiteBox;\n@@ -65,2 +66,2 @@\n-        allocateMemory(16 * 1024); \/\/ force young collection\n-        System.gc();\n+        WhiteBox wb = WhiteBox.getWhiteBox();\n+        wb.fullGC();  \/\/ will do class unloading\n","filename":"test\/lib\/jdk\/test\/lib\/classloader\/ClassUnloadCommon.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}