{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -147,0 +147,10 @@\n+    if (rv == CKR_BUFFER_TOO_SMALL) {\n+        bufP = (CK_BYTE_PTR) malloc(ckSignatureLength);\n+        if (bufP == NULL) {\n+            throwOutOfMemoryError(env, 0);\n+            goto cleanup;\n+        }\n+        rv = (*ckpFunctions->C_Sign)(ckSessionHandle, ckpData, ckDataLength,\n+            bufP, &ckSignatureLength);\n+    }\n+\n@@ -152,0 +162,1 @@\n+cleanup:\n","filename":"src\/jdk.crypto.cryptoki\/share\/native\/libj2pkcs11\/p11_sign.c","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"}]}