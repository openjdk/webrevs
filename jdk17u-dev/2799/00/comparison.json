{"files":[{"patch":"@@ -436,1 +436,1 @@\n-                handleResponse();\n+                handleResponse(hframe);\n@@ -466,1 +466,1 @@\n-    protected void handleResponse() throws IOException {\n+    protected void handleResponse(HeaderFrame hf) throws IOException {\n@@ -474,1 +474,1 @@\n-            if (responseCode < 100 || responseCode > 199)\n+            if (responseCode < 100 || responseCode > 199) {\n@@ -476,0 +476,12 @@\n+            } else if (hf.getFlag(HeaderFrame.END_STREAM)) {\n+                \/\/ see RFC 9113 section 8.1:\n+                \/\/ A HEADERS frame with the END_STREAM flag set that carries an\n+                \/\/ informational status code is malformed\n+                String msg = (\"Stream %s PROTOCOL_ERROR: \" +\n+                        \"HEADERS frame with status %s has END_STREAM flag set\")\n+                        .formatted(streamid, responseCode);\n+                if (debug.on()) {\n+                    debug.log(msg);\n+                }\n+                cancelImpl(new IOException(msg), ResetFrame.PROTOCOL_ERROR);\n+            }\n@@ -517,1 +529,1 @@\n-            if (response == null && subscriber == null) {\n+            if ((response == null || !finalResponseCodeReceived) && subscriber == null) {\n@@ -887,0 +899,4 @@\n+                if (debug.on()) {\n+                    debug.log(\"RequestSubscriber: requestBodyCf is done: \" +\n+                            \"cancelling subscription\");\n+                }\n@@ -1416,1 +1432,1 @@\n-        protected void handleResponse() {\n+        protected void handleResponse(HeaderFrame hf) {\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -134,0 +134,3 @@\n+        \/\/ Do not set Content-Length for 100, and do not set END_STREAM\n+        if (rCode == 100) responseLength = 0;\n+\n","filename":"test\/jdk\/java\/net\/httpclient\/lib\/jdk\/httpclient\/test\/lib\/http2\/Http2TestExchangeImpl.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}