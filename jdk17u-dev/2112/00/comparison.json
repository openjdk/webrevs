{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -158,1 +158,4 @@\n-          goto cleanup;\n+        if (directIn == 0) {\n+          (*env)->ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);\n+        }\n+        return 0;\n@@ -169,4 +172,1 @@\n-    ckAssertReturnValueOK(env, rv);\n-\n-cleanup:\n-    if (directIn == 0 && inBufP != NULL) {\n+    if (directIn == 0) {\n@@ -175,1 +175,1 @@\n-    if (directOut == 0 && outBufP != NULL) {\n+    if (directOut == 0) {\n@@ -178,0 +178,1 @@\n+    ckAssertReturnValueOK(env, rv);\n@@ -224,1 +225,4 @@\n-          goto cleanup;\n+        if (directIn == 0) {\n+          (*env)->ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);\n+        }\n+        return 0;\n@@ -235,4 +239,1 @@\n-    ckAssertReturnValueOK(env, rv);\n-\n-cleanup:\n-    if (directIn == 0 && inBufP != NULL) {\n+    if (directIn == 0) {\n@@ -241,1 +242,1 @@\n-    if (directOut == 0 && outBufP != NULL) {\n+    if (directOut == 0) {\n@@ -244,0 +245,1 @@\n+    ckAssertReturnValueOK(env, rv);\n@@ -394,1 +396,4 @@\n-          goto cleanup;\n+        if (directIn == 0) {\n+          (*env)->ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);\n+        }\n+        return 0;\n@@ -404,4 +409,1 @@\n-    ckAssertReturnValueOK(env, rv);\n-\n-cleanup:\n-    if (directIn == 0 && inBufP != NULL) {\n+    if (directIn == 0) {\n@@ -410,1 +412,1 @@\n-    if (directOut == 0 && outBufP != NULL) {\n+    if (directOut == 0) {\n@@ -413,0 +415,1 @@\n+    ckAssertReturnValueOK(env, rv);\n@@ -459,1 +462,4 @@\n-          goto cleanup;\n+        if (directIn == 0) {\n+          (*env)->ReleasePrimitiveArrayCritical(env, jIn, inBufP, JNI_ABORT);\n+        }\n+        return 0;\n@@ -468,1 +474,0 @@\n-    ckAssertReturnValueOK(env, rv);\n@@ -470,2 +475,1 @@\n-cleanup:\n-    if (directIn == 0 && inBufP != NULL) {\n+    if (directIn == 0) {\n@@ -474,1 +478,1 @@\n-    if (directOut == 0 && outBufP != NULL) {\n+    if (directOut == 0) {\n@@ -477,0 +481,1 @@\n+    ckAssertReturnValueOK(env, rv);\n","filename":"src\/jdk.crypto.cryptoki\/share\/native\/libj2pkcs11\/p11_crypt.c","additions":29,"deletions":24,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8080462 8229243\n+ * @bug 8080462 8229243 8307185\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestGCMKeyAndIvCheck.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}