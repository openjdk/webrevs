{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -119,0 +119,1 @@\n+import java.util.Hashtable;\n@@ -361,0 +362,5 @@\n+                    } else {\n+                        final XAtom XA_NET_WORKAREA = XAtom.get(\"_NET_WORKAREA\");\n+                        final boolean rootWindowWorkareaResized = (ev.get_type() == XConstants.PropertyNotify\n+                                && ev.get_xproperty().get_atom() == XA_NET_WORKAREA.getAtom());\n+                        if (rootWindowWorkareaResized) resetScreenInsetsCache();\n@@ -851,2 +857,1 @@\n-    @Override\n-    public Insets getScreenInsets(final GraphicsConfiguration gc) {\n+    private Insets getScreenInsetsImpl(final GraphicsConfiguration gc) {\n@@ -880,0 +885,24 @@\n+    private void resetScreenInsetsCache() {\n+        final GraphicsDevice[] devices = ((X11GraphicsEnvironment)GraphicsEnvironment.\n+                getLocalGraphicsEnvironment()).getScreenDevices();\n+        for (var gd : devices) {\n+            ((X11GraphicsDevice)gd).resetInsets();\n+        }\n+    }\n+\n+    @Override\n+    public Insets getScreenInsets(final GraphicsConfiguration gc) {\n+        final X11GraphicsDevice device = (X11GraphicsDevice) gc.getDevice();\n+        Insets insets = device.getInsets();\n+        if (insets == null) {\n+            synchronized (device) {\n+                insets = device.getInsets();\n+                if (insets == null) {\n+                    insets = getScreenInsetsImpl(gc);\n+                    device.setInsets(insets);\n+                }\n+            }\n+        }\n+        return (Insets) insets.clone();\n+    }\n+\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/XToolkit.java","additions":32,"deletions":3,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import java.awt.Insets;\n@@ -40,0 +41,1 @@\n+import java.util.Objects;\n@@ -69,0 +71,2 @@\n+    private volatile Rectangle bounds;\n+    private volatile Insets insets;\n@@ -75,0 +79,1 @@\n+        this.bounds = getBoundsImpl();\n@@ -121,1 +126,1 @@\n-    public Rectangle getBounds() {\n+    private Rectangle getBoundsImpl() {\n@@ -132,0 +137,17 @@\n+    public Rectangle getBounds() {\n+        return bounds.getBounds();\n+    }\n+\n+    public Insets getInsets() {\n+        return insets;\n+    }\n+\n+    public void setInsets(Insets newInsets) {\n+        Objects.requireNonNull(newInsets);\n+        insets = newInsets;\n+    }\n+\n+    public void resetInsets() {\n+        insets = null;\n+    }\n+\n@@ -513,0 +535,2 @@\n+        bounds = getBoundsImpl();\n+        insets = null;\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11GraphicsDevice.java","additions":26,"deletions":2,"binary":false,"changes":28,"status":"modified"}]}