{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+ * @requires (os.family == \"mac\")\n@@ -30,2 +31,0 @@\n- * @library \/test\/lib\n- * @build jdk.test.lib.Platform\n@@ -37,0 +36,1 @@\n+import java.awt.Color;\n@@ -58,2 +58,0 @@\n-import jdk.test.lib.Platform;\n-\n@@ -63,0 +61,1 @@\n+    static int colorTolerance = 5;\n@@ -64,2 +63,2 @@\n-    public static void main(String[] args) {\n-        if (!Platform.isOSX()) {\n+    public static void main(String[] args) throws Exception {\n+        if (!System.getProperty(\"os.name\").toLowerCase().contains(\"os x\")) {\n@@ -70,9 +69,5 @@\n-        try {\n-            SwingUtilities.invokeAndWait(new Runnable() {\n-                public void run() {\n-                    test = new CustomComboBoxFocusTest();\n-                }\n-            });\n-        } catch (InterruptedException | InvocationTargetException e ) {\n-            throw new RuntimeException(\"Test failed.\", e);\n-        }\n+        SwingUtilities.invokeAndWait(new Runnable() {\n+            public void run() {\n+                test = new CustomComboBoxFocusTest();\n+            }\n+        });\n@@ -80,1 +75,1 @@\n-        SwingUtilities.invokeLater(test.init);\n+        SwingUtilities.invokeAndWait(test.init);\n@@ -133,1 +128,17 @@\n-                if (a.getRGB(x, y) != b.getRGB(x, y)) {\n+                Color refRGB = new Color(a.getRGB(x,y));\n+                Color customRGB = new Color(b.getRGB(x,y));\n+\n+                int red1 = refRGB.getRed();\n+                int blue1 = refRGB.getBlue();\n+                int green1 = refRGB.getGreen();\n+\n+                int red2 = customRGB.getRed();\n+                int blue2 = customRGB.getBlue();\n+                int green2 = customRGB.getGreen();\n+\n+                if ((Math.abs(red1 - red2) > colorTolerance) ||\n+                    (Math.abs(green1 - green2) > colorTolerance) ||\n+                    (Math.abs(blue1 - blue2) > colorTolerance)) {\n+                    System.out.println(\"x \" + x + \" y \" + y +\n+                                       \" refRGB \" + refRGB +\n+                                       \" customRGB \" + customRGB);\n@@ -225,0 +236,1 @@\n+            f.setLocationRelativeTo(null);\n","filename":"test\/jdk\/javax\/swing\/plaf\/aqua\/CustomComboBoxFocusTest.java","additions":30,"deletions":18,"binary":false,"changes":48,"status":"modified"}]}