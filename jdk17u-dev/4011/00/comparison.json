{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,11 +25,1 @@\n-import org.openjdk.jmh.annotations.Benchmark;\n-import org.openjdk.jmh.annotations.BenchmarkMode;\n-import org.openjdk.jmh.annotations.Fork;\n-import org.openjdk.jmh.annotations.Measurement;\n-import org.openjdk.jmh.annotations.Mode;\n-import org.openjdk.jmh.annotations.OutputTimeUnit;\n-import org.openjdk.jmh.annotations.Param;\n-import org.openjdk.jmh.annotations.Scope;\n-import org.openjdk.jmh.annotations.Setup;\n-import org.openjdk.jmh.annotations.State;\n-import org.openjdk.jmh.annotations.Warmup;\n+import org.openjdk.jmh.annotations.*;\n@@ -43,2 +33,2 @@\n-@Fork(value = 3)\n-@Warmup(iterations = 5, time = 2)\n+@Fork(value = 2)\n+@Warmup(iterations = 5, time = 3)\n@@ -49,1 +39,3 @@\n-    @Param({\"US-ASCII\", \"ISO-8859-1\", \"UTF-8\", \"MS932\", \"ISO-8859-6\", \"ISO-2022-KR\"})\n+    \/\/ Reduced by default to only UTF-8, previous coverage:\n+    \/\/ @Param({\"US-ASCII\", \"ISO-8859-1\", \"UTF-8\", \"MS932\", \"ISO-8859-6\", \"ISO-2022-KR\"})\n+    @Param({\"UTF-8\"})\n@@ -54,0 +46,1 @@\n+    private byte[] longAsciiString;\n@@ -55,1 +48,1 @@\n-    private byte[] longUtf16String;\n+    private byte[] longUtf16EndString;\n@@ -57,1 +50,5 @@\n-    private byte[] longLatin1String;\n+    private byte[] longUtf16OnlyString;\n+    private byte[] latin1String;\n+    private byte[] longLatin1EndString;\n+    private byte[] longLatin1StartString;\n+    private byte[] longLatin1OnlyString;\n@@ -59,6 +56,1 @@\n-    @Setup\n-    public void setup() {\n-        charset = Charset.forName(charsetName);\n-        asciiString = \"ascii string\".getBytes(charset);\n-        utf16String = \"UTF-\\uFF11\\uFF16 string\".getBytes(charset);\n-        longUtf16String = \"\"\"\n+    private static final String LOREM = \"\"\"\n@@ -73,49 +65,17 @@\n-             Suspendisse potenti.\n-\n-             Phasellus vel nisi iaculis, accumsan quam sed, bibendum eros. Sed venenatis\n-             nulla tortor, et eleifend urna sodales id. Nullam tempus ac metus sit amet\n-             sollicitudin. Nam sed ex diam. Praesent vitae eros et neque condimentum\n-             consectetur eget non tortor. Praesent bibendum vel felis nec dignissim.\n-             Maecenas a enim diam. Suspendisse quis ligula at nisi accumsan lacinia id\n-             hendrerit sapien. \\uFF11Donec aliquam mattis lectus eu ultrices. Duis eu nisl\\uFF11\n-             euismod, blandit mauris vel, \\uFF11placerat urna. Etiam malesuada enim purus,\n-             tristique mollis odio blandit quis.\\uFF11 Vivamus posuere. \\uFF11\n-             \\uFF11\n-            \"\"\".getBytes(charset);\n-        longUtf16StartString = \"\"\"\n-             \\uFF11\n-             Lorem ipsum dolor sit amet, \\uFF11consectetur adipiscing elit. Aliquam ac sem eu\n-             urna egestas \\uFF11placerat. Etiam finibus ipsum nulla, non mattis dolor cursus a.\n-             Nulla \\uFF11nec nisl consectetur, lacinia neque id, accumsan ante. Curabitur et\n-             sapien in \\uFF11magna porta ultricies. \\uFF11Sed vel pellentesque nibh. Pellentesque dictum\n-             dignissim diam eu ultricies. Class aptent taciti sociosqu ad litora torquent\n-             per conubia nostra, per inceptos himenaeos. Suspendisse erat diam, fringilla\n-             sed massa sed, posuere viverra orci. Suspendisse tempor libero non gravida\n-             efficitur. Vivamus lacinia risus non orci viverra, at consectetur odio laoreet.\n-             Suspendisse potenti.\n-\n-             Phasellus vel nisi iaculis, accumsan quam sed, bibendum eros. Sed venenatis\n-             nulla tortor, et eleifend urna sodales id. Nullam tempus ac metus sit amet\n-             sollicitudin. Nam sed ex diam. Praesent vitae eros et neque condimentum\n-             consectetur eget non tortor. Praesent bibendum vel felis nec dignissim.\n-             Maecenas a enim diam. Suspendisse quis ligula at nisi accumsan lacinia id\n-             hendrerit sapien. Donec aliquam mattis lectus eu ultrices. Duis eu nisl\n-             euismod, blandit mauris vel, placerat urna. Etiam malesuada enim purus,\n-             tristique mollis odio blandit quis. Vivamus posuere.\n-            \"\"\".getBytes(charset);\n-\n-        longLatin1String = \"\"\"\n-             a\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             b\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             c\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             d\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             e\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             f\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             g\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             h\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             i\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             j\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\n-             k\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\\u00F6\n-             l\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\\u00F6\n-             m\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00F6\\u00B6\\u00F6\\u00F6\n-            \"\"\".getBytes(charset);\n+             Suspendisse potenti.\"\"\";\n+    private static final String UTF16_STRING = \"\\uFF11\".repeat(31);\n+    private static final String LATIN1_STRING = \"\\u00B6\".repeat(31);\n+\n+    @Setup\n+    public void setup() {\n+        charset = Charset.forName(charsetName);\n+        asciiString = LOREM.substring(0, 32).getBytes(charset);\n+        longAsciiString = LOREM.repeat(200).getBytes(charset);\n+        utf16String = \"UTF-\\uFF11\\uFF16 string\".getBytes(charset);\n+        longUtf16EndString = LOREM.repeat(4).concat(UTF16_STRING).getBytes(charset);\n+        longUtf16StartString = UTF16_STRING.concat(LOREM.repeat(4)).getBytes(charset);\n+        longUtf16OnlyString = UTF16_STRING.repeat(10).getBytes(charset);\n+        latin1String = LATIN1_STRING.getBytes(charset);\n+        longLatin1EndString = LOREM.repeat(4).concat(LATIN1_STRING).getBytes(charset);\n+        longLatin1StartString = LATIN1_STRING.concat(LOREM.repeat(4)).getBytes(charset);\n+        longLatin1OnlyString = LATIN1_STRING.repeat(10).getBytes(charset);\n@@ -125,2 +85,6 @@\n-    public String decodeAsciiCharsetName() throws Exception {\n-        return new String(asciiString, charsetName);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeAsciiShort(Blackhole bh) throws Exception {\n+        bh.consume(new String(asciiString, charset));\n+        bh.consume(new String(longAsciiString, 0, 15, charset));\n+        bh.consume(new String(asciiString, 0, 3, charset));\n+        bh.consume(new String(longAsciiString, 512, 512 + 7, charset));\n@@ -130,2 +94,4 @@\n-    public String decodeAscii() throws Exception {\n-        return new String(asciiString, charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeAsciiLong(Blackhole bh) throws Exception {\n+        bh.consume(new String(longAsciiString, charset));\n+        bh.consume(new String(longAsciiString, 0, 1024 + 31, charset));\n@@ -135,2 +101,6 @@\n-    public String decodeLatin1Long() throws Exception {\n-        return new String(longLatin1String, charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeLatin1Short(Blackhole bh) throws Exception {\n+        bh.consume(new String(latin1String, charset));\n+        bh.consume(new String(latin1String, 0, 15, charset));\n+        bh.consume(new String(latin1String, 0, 3, charset));\n+        bh.consume(new String(longLatin1OnlyString, 512, 512 + 7, charset));\n@@ -140,2 +110,3 @@\n-    public String decodeUTF16Short() throws Exception {\n-        return new String(utf16String, charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public String decodeLatin1LongStart() throws Exception {\n+        return new String(longLatin1StartString, charset);\n@@ -145,0 +116,31 @@\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public String decodeLatin1LongEnd() throws Exception {\n+        return new String(longLatin1EndString, charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public String decodeLatin1LongOnly() throws Exception {\n+        return new String(longLatin1OnlyString, charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeLatin1Mixed(Blackhole bh) throws Exception {\n+        bh.consume(new String(longLatin1EndString, charset));\n+        bh.consume(new String(longLatin1StartString, charset));\n+        bh.consume(new String(latin1String, charset));\n+        bh.consume(new String(longLatin1OnlyString, charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeUTF16Short(Blackhole bh) throws Exception {\n+        bh.consume(new String(utf16String, charset));\n+        bh.consume(new String(utf16String, 0, 15, charset));\n+        bh.consume(new String(utf16String, 0, 3, charset));\n+        bh.consume(new String(utf16String, 0, 7, charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n@@ -146,1 +148,1 @@\n-        return new String(longUtf16String, charset);\n+        return new String(longUtf16EndString, charset);\n@@ -150,0 +152,1 @@\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n@@ -155,1 +158,20 @@\n-    public void decodeUTF16LongMixed(Blackhole bh) throws Exception {\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public String decodeUTF16LongOnly() throws Exception {\n+        return new String(longUtf16OnlyString, charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeUTF16Mixed(Blackhole bh) throws Exception {\n+        bh.consume(new String(longUtf16StartString, charset));\n+        bh.consume(new String(longUtf16EndString, charset));\n+        bh.consume(new String(utf16String, charset));\n+        bh.consume(new String(longUtf16OnlyString, charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeAllMixed(Blackhole bh) throws Exception {\n+        bh.consume(new String(utf16String, charset));\n+        bh.consume(new String(longUtf16EndString, charset));\n+        bh.consume(new String(utf16String, 0, 15, charset));\n@@ -157,1 +179,26 @@\n-        bh.consume(new String(longUtf16String, charset));\n+        bh.consume(new String(asciiString, 0, 3, charset));\n+        bh.consume(new String(longUtf16OnlyString, charset));\n+        bh.consume(new String(latin1String, charset));\n+        bh.consume(new String(longLatin1EndString, charset));\n+        bh.consume(new String(longLatin1StartString, charset));\n+        bh.consume(new String(latin1String, 0, 7, charset));\n+        bh.consume(new String(longLatin1OnlyString, charset));\n+        bh.consume(new String(asciiString, charset));\n+        bh.consume(new String(longAsciiString, charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void decodeShortMixed(Blackhole bh) throws Exception {\n+        bh.consume(new String(utf16String, 0, 15, charset));\n+        bh.consume(new String(latin1String, 0, 15, charset));\n+        bh.consume(new String(asciiString, charset));\n+        bh.consume(new String(utf16String, charset));\n+        bh.consume(new String(latin1String, 0, 3, charset));\n+        bh.consume(new String(asciiString, 0, 3, charset));\n+        bh.consume(new String(utf16String, 0, 7, charset));\n+        bh.consume(new String(latin1String, charset));\n+        bh.consume(new String(asciiString, 0, 7, charset));\n+        bh.consume(new String(utf16String, 0, 3, charset));\n+        bh.consume(new String(latin1String, 0, 7, charset));\n+        bh.consume(new String(asciiString, 0, 15, charset));\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/lang\/StringDecode.java","additions":130,"deletions":83,"binary":false,"changes":213,"status":"modified"},{"patch":"@@ -33,2 +33,2 @@\n-@Fork(value = 3)\n-@Warmup(iterations = 5, time = 2)\n+@Fork(value = 2)\n+@Warmup(iterations = 5, time = 3)\n@@ -39,1 +39,3 @@\n-    @Param({\"US-ASCII\", \"ISO-8859-1\", \"UTF-8\", \"MS932\", \"ISO-8859-6\"})\n+    \/\/ Reduced by default to only UTF-8, previous coverage:\n+    \/\/ @Param({\"US-ASCII\", \"ISO-8859-1\", \"UTF-8\", \"MS932\", \"ISO-8859-6\", \"ISO-2022-KR\"})\n+    @Param({\"UTF-8\"})\n@@ -41,0 +43,1 @@\n+\n@@ -43,0 +46,5 @@\n+    private String asciiString3;\n+    private String asciiString7;\n+    private String asciiString15;\n+    private String longAsciiString;\n+    private String longAsciiString1055;\n@@ -44,1 +52,4 @@\n-    private String longUtf16String;\n+    private String utf16String3;\n+    private String utf16String7;\n+    private String utf16String15;\n+    private String longUtf16EndString;\n@@ -46,0 +57,21 @@\n+    private String longUtf16OnlyString;\n+    private String latin1String;\n+    private String latin1String3;\n+    private String latin1String7;\n+    private String latin1String15;\n+    private String longLatin1EndString;\n+    private String longLatin1StartString;\n+    private String longLatin1OnlyString;\n+\n+    private static final String LOREM = \"\"\"\n+             Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam ac sem eu\n+             urna egestas placerat. Etiam finibus ipsum nulla, non mattis dolor cursus a.\n+             Nulla nec nisl consectetur, lacinia neque id, accumsan ante. Curabitur et\n+             sapien in magna porta ultricies. Sed vel pellentesque nibh. Pellentesque dictum\n+             dignissim diam eu ultricies. Class aptent taciti sociosqu ad litora torquent\n+             per conubia nostra, per inceptos himenaeos. Suspendisse erat diam, fringilla\n+             sed massa sed, posuere viverra orci. Suspendisse tempor libero non gravida\n+             efficitur. Vivamus lacinia risus non orci viverra, at consectetur odio laoreet.\n+             Suspendisse potenti.\"\"\";\n+    private static final String UTF16_STRING = \"\\uFF11\".repeat(31);\n+    private static final String LATIN1_STRING = \"\\u00B6\".repeat(31);\n@@ -50,44 +82,20 @@\n-        asciiString = \"ascii string\";\n-        utf16String = \"UTF-\\uFF11\\uFF16 string\";\n-        longUtf16String = \"\"\"\n-                 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam ac sem eu\n-                 urna egestas placerat. Etiam finibus ipsum nulla, non mattis dolor cursus a.\n-                 Nulla nec nisl consectetur, lacinia neque id, accumsan ante. Curabitur et\n-                 sapien in magna porta ultricies. Sed vel pellentesque nibh. Pellentesque dictum\n-                 dignissim diam eu ultricies. Class aptent taciti sociosqu ad litora torquent\n-                 per conubia nostra, per inceptos himenaeos. Suspendisse erat diam, fringilla\n-                 sed massa sed, posuere viverra orci. Suspendisse tempor libero non gravida\n-                 efficitur. Vivamus lacinia risus non orci viverra, at consectetur odio laoreet.\n-                 Suspendisse potenti.\n-\n-                 Phasellus vel nisi iaculis, accumsan quam sed, bibendum eros. Sed venenatis\n-                 nulla tortor, et eleifend urna sodales id. Nullam tempus ac metus sit amet\n-                 sollicitudin. Nam sed ex diam. Praesent vitae eros et neque condimentum\n-                 consectetur eget non tortor. Praesent bibendum vel felis nec dignissim.\n-                 Maecenas a enim diam. Suspendisse quis ligula at nisi accumsan lacinia id\n-                 hendrerit sapien. Donec aliquam mattis lectus eu ultrices. Duis eu nisl\n-                 euismod, blandit mauris vel, placerat urna. Etiam malesuada enim purus,\n-                 tristique mollis odio blandit quis. Vivamus posuere.\n-                 \\uFF11\n-                \"\"\";\n-        longUtf16StartString = \"\"\"\n-                 \\uFF11\n-                 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam ac sem eu\n-                 urna egestas placerat. Etiam finibus ipsum nulla, non mattis dolor cursus a.\n-                 Nulla nec nisl consectetur, lacinia neque id, accumsan ante. Curabitur et\n-                 sapien in magna porta ultricies. Sed vel pellentesque nibh. Pellentesque dictum\n-                 dignissim diam eu ultricies. Class aptent taciti sociosqu ad litora torquent\n-                 per conubia nostra, per inceptos himenaeos. Suspendisse erat diam, fringilla\n-                 sed massa sed, posuere viverra orci. Suspendisse tempor libero non gravida\n-                 efficitur. Vivamus lacinia risus non orci viverra, at consectetur odio laoreet.\n-                 Suspendisse potenti.\n-\n-                 Phasellus vel nisi iaculis, accumsan quam sed, bibendum eros. Sed venenatis\n-                 nulla tortor, et eleifend urna sodales id. Nullam tempus ac metus sit amet\n-                 sollicitudin. Nam sed ex diam. Praesent vitae eros et neque condimentum\n-                 consectetur eget non tortor. Praesent bibendum vel felis nec dignissim.\n-                 Maecenas a enim diam. Suspendisse quis ligula at nisi accumsan lacinia id\n-                 hendrerit sapien. Donec aliquam mattis lectus eu ultrices. Duis eu nisl\n-                 euismod, blandit mauris vel, placerat urna. Etiam malesuada enim purus,\n-                 tristique mollis odio blandit quis. Vivamus posuere.\n-                \"\"\";\n+        asciiString = LOREM.substring(0, 32);\n+        asciiString3 = LOREM.substring(0, 3);\n+        asciiString7 = LOREM.substring(0, 7);\n+        asciiString15 = LOREM.substring(0, 15);\n+        longAsciiString = LOREM.repeat(200);\n+        longAsciiString1055 = longAsciiString.substring(0, 1055);\n+        utf16String = UTF16_STRING;\n+        utf16String3 = UTF16_STRING.substring(0, 3);\n+        utf16String7 = UTF16_STRING.substring(0, 7);\n+        utf16String15 = UTF16_STRING.substring(0, 15);\n+        longUtf16EndString = LOREM.repeat(4).concat(UTF16_STRING);\n+        longUtf16StartString = UTF16_STRING.concat(LOREM.repeat(4));\n+        longUtf16OnlyString = UTF16_STRING.repeat(10);\n+        latin1String = LATIN1_STRING;\n+        latin1String3 = LATIN1_STRING.substring(0, 3);\n+        latin1String7 = LATIN1_STRING.substring(0, 7);\n+        latin1String15 = LATIN1_STRING.substring(0, 15);\n+        longLatin1EndString = LOREM.repeat(4).concat(LATIN1_STRING);\n+        longLatin1StartString = LATIN1_STRING.concat(LOREM.repeat(4));\n+        longLatin1OnlyString = LATIN1_STRING.repeat(10);\n@@ -97,2 +105,6 @@\n-    public byte[] encodeAsciiCharsetName() throws Exception {\n-        return asciiString.getBytes(charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeAsciiShort(Blackhole bh) throws Exception {\n+        bh.consume(asciiString.getBytes(charset));\n+        bh.consume(asciiString3.getBytes(charset));\n+        bh.consume(asciiString15.getBytes(charset));\n+        bh.consume(asciiString7.getBytes(charset));\n@@ -102,2 +114,4 @@\n-    public byte[] encodeAscii() throws Exception {\n-        return asciiString.getBytes(charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeAsciiLong(Blackhole bh) throws Exception {\n+        bh.consume(longAsciiString.getBytes(charset));\n+        bh.consume(longAsciiString1055.getBytes(charset));\n@@ -107,2 +121,2 @@\n-    public void encodeMix(Blackhole bh) throws Exception {\n-        bh.consume(asciiString.getBytes(charset));\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeUTF16Short(Blackhole bh) throws Exception {\n@@ -110,0 +124,3 @@\n+        bh.consume(utf16String3.getBytes(charset));\n+        bh.consume(utf16String15.getBytes(charset));\n+        bh.consume(utf16String7.getBytes(charset));\n@@ -113,0 +130,1 @@\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n@@ -114,1 +132,1 @@\n-        return longUtf16String.getBytes(charset);\n+        return longUtf16EndString.getBytes(charset);\n@@ -118,0 +136,1 @@\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n@@ -123,2 +142,83 @@\n-    public byte[] encodeUTF16() throws Exception {\n-        return utf16String.getBytes(charset);\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public byte[] encodeUTF16LongOnly() throws Exception {\n+        return longUtf16OnlyString.getBytes(charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeUTF16Mixed(Blackhole bh) throws Exception {\n+        bh.consume(utf16String.getBytes(charset));\n+        bh.consume(longUtf16StartString.getBytes(charset));\n+        bh.consume(longUtf16EndString.getBytes(charset));\n+        bh.consume(longUtf16OnlyString.getBytes(charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeLatin1Short(Blackhole bh) throws Exception {\n+        bh.consume(latin1String.getBytes(charset));\n+        bh.consume(latin1String3.getBytes(charset));\n+        bh.consume(latin1String15.getBytes(charset));\n+        bh.consume(latin1String7.getBytes(charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public byte[] encodeLatin1LongOnly() throws Exception {\n+        return longLatin1OnlyString.getBytes(charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public byte[] encodeLatin1LongStart() throws Exception {\n+        return longLatin1StartString.getBytes(charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public byte[] encodeLatin1LongEnd() throws Exception {\n+        return longLatin1EndString.getBytes(charset);\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeLatin1Mixed(Blackhole bh) throws Exception {\n+        bh.consume(longLatin1EndString.getBytes(charset));\n+        bh.consume(longLatin1StartString.getBytes(charset));\n+        bh.consume(longLatin1OnlyString.getBytes(charset));\n+        bh.consume(latin1String.getBytes(charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeAllMixed(Blackhole bh) throws Exception {\n+        bh.consume(utf16String.getBytes(charset));\n+        bh.consume(longUtf16StartString.getBytes(charset));\n+        bh.consume(asciiString7.getBytes(charset));\n+        bh.consume(longUtf16EndString.getBytes(charset));\n+        bh.consume(latin1String3.getBytes(charset));\n+        bh.consume(longUtf16OnlyString.getBytes(charset));\n+        bh.consume(longLatin1EndString.getBytes(charset));\n+        bh.consume(longLatin1StartString.getBytes(charset));\n+        bh.consume(utf16String15.getBytes(charset));\n+        bh.consume(longLatin1OnlyString.getBytes(charset));\n+        bh.consume(latin1String.getBytes(charset));\n+        bh.consume(asciiString.getBytes(charset));\n+        bh.consume(longAsciiString.getBytes(charset));\n+    }\n+\n+    @Benchmark\n+    @CompilerControl(CompilerControl.Mode.DONT_INLINE)\n+    public void encodeShortMixed(Blackhole bh) throws Exception {\n+        bh.consume(utf16String3.getBytes(charset));\n+        bh.consume(latin1String7.getBytes(charset));\n+        bh.consume(asciiString15.getBytes(charset));\n+        bh.consume(utf16String.getBytes(charset));\n+        bh.consume(latin1String3.getBytes(charset));\n+        bh.consume(asciiString7.getBytes(charset));\n+        bh.consume(utf16String15.getBytes(charset));\n+        bh.consume(latin1String.getBytes(charset));\n+        bh.consume(asciiString3.getBytes(charset));\n+        bh.consume(utf16String7.getBytes(charset));\n+        bh.consume(latin1String15.getBytes(charset));\n+        bh.consume(asciiString.getBytes(charset));\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/lang\/StringEncode.java","additions":157,"deletions":57,"binary":false,"changes":214,"status":"modified"}]}