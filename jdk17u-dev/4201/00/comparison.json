{"files":[{"patch":"@@ -2039,22 +2039,7 @@\n-    \/* if primary display *\/\n-    if (screenNum == 0) {\n-        RECT rRW;\n-        if (::SystemParametersInfo(SPI_GETWORKAREA,0,(void *) &rRW,0) == TRUE) {\n-            rect->top = rRW.top;\n-            rect->left = rRW.left;\n-            rect->bottom = ::GetSystemMetrics(SM_CYSCREEN) - rRW.bottom;\n-            rect->right = ::GetSystemMetrics(SM_CXSCREEN) - rRW.right;\n-            return TRUE;\n-        }\n-    }\n-    \/* if additional display *\/\n-    else {\n-        MONITORINFO *miInfo;\n-        miInfo = AwtWin32GraphicsDevice::GetMonitorInfo(screenNum);\n-        if (miInfo) {\n-            rect->top = miInfo->rcWork.top    - miInfo->rcMonitor.top;\n-            rect->left = miInfo->rcWork.left   - miInfo->rcMonitor.left;\n-            rect->bottom = miInfo->rcMonitor.bottom - miInfo->rcWork.bottom;\n-            rect->right = miInfo->rcMonitor.right - miInfo->rcWork.right;\n-            return TRUE;\n-        }\n+    MONITORINFO *miInfo = AwtWin32GraphicsDevice::GetMonitorInfo(screenNum);\n+    if (miInfo) {\n+        rect->top = miInfo->rcWork.top - miInfo->rcMonitor.top;\n+        rect->left = miInfo->rcWork.left - miInfo->rcMonitor.left;\n+        rect->bottom = miInfo->rcMonitor.bottom - miInfo->rcWork.bottom;\n+        rect->right = miInfo->rcMonitor.right - miInfo->rcWork.right;\n+        return TRUE;\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Toolkit.cpp","additions":7,"deletions":22,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,4 +27,3 @@\n-  @bug 8020443\n-  @summary Frame is not created on the specified GraphicsDevice with two\n-monitors\n-  @author Oleg Pekhovskiy\n+  @bug 8020443 6899304\n+  @summary Test to check if the frame is created on the specified GraphicsDevice\n+  and if getScreenInsets()returns the correct values across multiple monitors.\n@@ -32,1 +31,1 @@\n-  @build jdk.test.lib.Platform\n+  @build jdk.test.lib.Platform jtreg.SkippedException\n@@ -45,0 +44,1 @@\n+import jtreg.SkippedException;\n@@ -48,0 +48,2 @@\n+    \/\/ Allow a margin tolerance of 1 pixel due to scaling\n+    private static final int MARGIN_TOLERANCE = 1;\n@@ -50,6 +52,0 @@\n-        if (!Platform.isLinux()) {\n-            System.out.println(\"This test is for Linux only...\" +\n-                               \"skipping!\");\n-            return;\n-        }\n-\n@@ -59,2 +55,1 @@\n-            System.out.println(\"It's a multi-screen test... skipping!\");\n-            return;\n+            throw new SkippedException(\"It's a multi-screen test... skipping!\");\n@@ -68,0 +63,3 @@\n+            System.out.println(\"Screen #\" + screen);\n+            System.out.println(\"Screen Bounds: \" + bounds);\n+            System.out.println(\"Insets: \" + insets);\n@@ -73,1 +71,11 @@\n-            frame.setUndecorated(true);\n+\n+            \/*\n+             * On Windows, undecorated maximized frames are placed over the taskbar.\n+             * Use a decorated frame instead.\n+             *\/\n+            if (Platform.isWindows()) {\n+                frame.setUndecorated(false);\n+            } else {\n+                frame.setUndecorated(true);\n+            }\n+\n@@ -81,0 +89,2 @@\n+            System.out.println(\"Frame bounds: \" + frameBounds);\n+\n@@ -82,0 +92,16 @@\n+\n+            \/*\n+             * On Windows, the top-left corner of an undecorated maximized frame\n+             * may have negative coordinates (x, y).\n+             * Adjust the frame bounds accordingly.\n+             *\/\n+            if (frameBounds.x < bounds.x) {\n+                frameBounds.width -= (bounds.x - frameBounds.x) * 2;\n+                frameBounds.x = bounds.x;\n+            }\n+            if (frameBounds.y < bounds.y) {\n+                frameBounds.height -= (bounds.y - frameBounds.y) * 2;\n+                frameBounds.y = bounds.y;\n+            }\n+            System.out.println(\"Adjusted Frame bounds: \" + frameBounds);\n+\n@@ -84,2 +110,2 @@\n-                || bounds.width - insets.right - insets.left != frameBounds.width\n-                || bounds.height - insets.bottom - insets.top != frameBounds.height) {\n+                || Math.abs((bounds.width - insets.right - insets.left) - frameBounds.width) > MARGIN_TOLERANCE\n+                || Math.abs((bounds.height - insets.bottom - insets.top) - frameBounds.height) > MARGIN_TOLERANCE) {\n","filename":"test\/jdk\/java\/awt\/Multiscreen\/MultiScreenInsetsTest\/MultiScreenInsetsTest.java","additions":43,"deletions":17,"binary":false,"changes":60,"status":"modified"}]}