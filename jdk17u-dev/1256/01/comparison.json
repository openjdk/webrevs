{"files":[{"patch":"@@ -330,1 +330,1 @@\n-             * 768 bits ephemeral DH private keys were used to be used in\n+             * 768 bit ephemeral DH private keys used to be used in\n@@ -332,1 +332,1 @@\n-             * bits modulus values. We still adhere to this behavior in legacy\n+             * bit modulus values. We still adhere to this behavior in legacy\n@@ -336,4 +336,5 @@\n-             * Old JDK (JDK 7 and previous) releases don't support DH keys\n-             * bigger than 1024 bits. We have to consider the compatibility\n-             * requirement. 1024 bits DH key is always used for non-exportable\n-             * cipher suites in default mode (system property\n+             * Only very old JDK releases don't support DH keys bigger than\n+             * 1024 bits (JDK 1.5 and 6u\/7u releases prior to adding support\n+             * for DH keys > 1024 bits - see JDK-8062834). A 2048 bit\n+             * DH key is always used for non-exportable cipher suites in\n+             * default mode (when the system property\n@@ -342,10 +343,0 @@\n-             * However, if applications want more stronger strength, setting\n-             * system property \"jdk.tls.ephemeralDHKeySize\" to \"matched\"\n-             * is a workaround to use ephemeral DH key which size matches the\n-             * corresponding authentication key. For example, if the public key\n-             * size of an authentication certificate is 2048 bits, then the\n-             * ephemeral DH key size should be 2048 bits accordingly unless\n-             * the cipher suite is exportable.  This key sizing scheme keeps\n-             * the cryptographic strength consistent between authentication\n-             * keys and key-exchange keys.\n-             *\n@@ -354,1 +345,1 @@\n-             * can be approached by setting system property\n+             * can be done by setting the system property\n@@ -358,2 +349,2 @@\n-             * Note that the minimum acceptable key size is 1024 bits except\n-             * exportable cipher suites or legacy mode.\n+             * Note that the minimum acceptable key size is 2048 bits except\n+             * for exportable cipher suites or legacy mode.\n@@ -365,1 +356,1 @@\n-             * reserved and 512 bits DH key is always used for exportable\n+             * preserved and a 512 bit DH key is always used for exportable\n@@ -368,1 +359,1 @@\n-            int keySize = exportable ? 512 : 1024;           \/\/ default mode\n+            int keySize = exportable ? 512 : 2048;           \/\/ default mode\n@@ -394,1 +385,1 @@\n-                    } \/\/ Otherwise, anonymous cipher suites, 1024-bit is used.\n+                    } \/\/ Otherwise, anonymous cipher suites, 2048-bit is used.\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/DHKeyExchange.java","additions":13,"deletions":22,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,1 @@\n- * @bug 6956398\n+ * @bug 6956398 8301700\n@@ -57,1 +57,1 @@\n- *      DHEKeySizing TLS_DHE_RSA_WITH_AES_128_CBC_SHA  false 1387 139\n+ *      DHEKeySizing TLS_DHE_RSA_WITH_AES_128_CBC_SHA  false 1643 267\n@@ -73,1 +73,1 @@\n- *      DHEKeySizing SSL_DH_anon_WITH_RC4_128_MD5  false 361 139\n+ *      DHEKeySizing SSL_DH_anon_WITH_RC4_128_MD5  false 617 267\n@@ -81,1 +81,1 @@\n- *      DHEKeySizing SSL_DH_anon_WITH_RC4_128_MD5  false 361 139\n+ *      DHEKeySizing SSL_DH_anon_WITH_RC4_128_MD5  false 617 267\n@@ -109,1 +109,1 @@\n- * Fomr above structures, it is clear that if the DH key size increasing 128\n+ * From the above structures, it is clear that if the DH key size increases 128\n@@ -120,1 +120,1 @@\n- *  2048-bit  |          1643 bytes  |          267 bytes |        361 bytes\n+ *  2048-bit  |          1643 bytes  |          267 bytes |        617 bytes\n","filename":"test\/jdk\/sun\/security\/ssl\/DHKeyExchange\/DHEKeySizing.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}