{"files":[{"patch":"@@ -644,2 +644,0 @@\n-sun\/security\/provider\/KeyStore\/DKSTest.sh                       8180266 windows-all\n-\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,4 @@\n- * see .\/DKSTest.sh\n+ * @test\n+ * @bug 8007755\n+ * @library \/test\/lib\n+ * @summary Support the logical grouping of keystores\n@@ -30,0 +33,1 @@\n+import java.nio.file.Paths;\n@@ -35,0 +39,2 @@\n+import jdk.test.lib.process.ProcessTools;\n+import jdk.test.lib.process.OutputAnalyzer;\n@@ -41,3 +47,5 @@\n-    private static final String USER_DIR = System.getProperty(\"user.dir\");\n-    private static final String CERT = TEST_SRC + \"\/..\/..\/pkcs12\/trusted.pem\";\n-    private static final String CONFIG = \"file:\/\/\" + TEST_SRC + \"\/domains.cfg\";\n+    private static final String USER_DIR = System.getProperty(\"user.dir\", \".\");\n+    private static final String CERT = Paths.get(\n+            TEST_SRC, \"..\", \"..\", \"pkcs12\", \"trusted.pem\").toAbsolutePath().toString();\n+    private static final String CONFIG = Paths.get(\n+            TEST_SRC, \"domains.cfg\").toUri().toString();\n@@ -73,0 +81,12 @@\n+        if (args.length == 0) {\n+            \/\/ Environment variable and system properties referred in domains.cfg used by this Test.\n+            ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(List.of(\n+                    \"-Dtest.src=\" + TEST_SRC , \"-Duser.dir=\" + USER_DIR, \"DKSTest\", \"run\"));\n+            pb.environment().putAll(System.getenv());\n+            pb.environment().put(\"KEYSTORE_PWD\", \"test12\");\n+            pb.environment().put(\"TRUSTSTORE_PWD\", \"changeit\");\n+            OutputAnalyzer output = ProcessTools.executeProcess(pb);\n+            output.shouldHaveExitValue(0);\n+            output.outputTo(System.out);\n+            return;\n+        }\n","filename":"test\/jdk\/sun\/security\/provider\/KeyStore\/DKSTest.java","additions":25,"deletions":5,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -1,76 +0,0 @@\n-#! \/bin\/sh\n-\n-#\n-# Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n-# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-#\n-# This code is free software; you can redistribute it and\/or modify it\n-# under the terms of the GNU General Public License version 2 only, as\n-# published by the Free Software Foundation.\n-#\n-# This code is distributed in the hope that it will be useful, but WITHOUT\n-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-# version 2 for more details (a copy is included in the LICENSE file that\n-# accompanied this code).\n-#\n-# You should have received a copy of the GNU General Public License version\n-# 2 along with this work; if not, write to the Free Software Foundation,\n-# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-#\n-# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n-# or visit www.oracle.com if you need additional information or have any\n-# questions.\n-#\n-\n-# @test\n-# @bug 8007755\n-# @summary Support the logical grouping of keystores\n-\n-# set a few environment variables so that the shell-script can run stand-alone\n-# in the source directory\n-if [ \"${TESTSRC}\" = \"\" ] ; then\n-   TESTSRC=\".\"\n-fi\n-\n-if [ \"${TESTCLASSES}\" = \"\" ] ; then\n-   TESTCLASSES=\".\"\n-fi\n-\n-if [ \"${TESTJAVA}\" = \"\" ] ; then\n-   echo \"TESTJAVA not set.  Test cannot execute.\"\n-   echo \"FAILED!!!\"\n-   exit 1\n-fi\n-\n-if [ \"${COMPILEJAVA}\" = \"\" ]; then\n-    COMPILEJAVA=\"${TESTJAVA}\"\n-fi\n-\n-# set platform-dependent variables\n-OS=`uname -s`\n-case \"$OS\" in\n-  Linux | Darwin | AIX)\n-    PS=\":\"\n-    FS=\"\/\"\n-    ;;\n-  CYGWIN* )\n-    PS=\";\"\n-    FS=\"\/\"\n-    ;;\n-  Windows* )\n-    PS=\";\"\n-    FS=\"\\\\\"\n-    ;;\n-  * )\n-    echo \"Unrecognized system!\"\n-    exit 1;\n-    ;;\n-esac\n-\n-${COMPILEJAVA}${FS}bin${FS}javac -d .  ${TESTSRC}${FS}DKSTest.java\n-\n-KEYSTORE_PWD=test12 TRUSTSTORE_PWD=changeit \\\n-  ${TESTJAVA}${FS}bin${FS}java ${TESTVMOPTS} -Dtest.src=${TESTSRC} DKSTest\n-\n-exit $status\n","filename":"test\/jdk\/sun\/security\/provider\/KeyStore\/DKSTest.sh","additions":0,"deletions":76,"binary":false,"changes":76,"status":"deleted"}]}