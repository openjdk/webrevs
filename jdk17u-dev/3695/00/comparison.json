{"files":[{"patch":"@@ -269,1 +269,1 @@\n-    private void registerResponseSubscriber(Http1ResponseBodySubscriber<T> subscriber) {\n+    private boolean registerResponseSubscriber(Http1ResponseBodySubscriber<T> subscriber) {\n@@ -279,0 +279,1 @@\n+            return false;\n@@ -280,1 +281,1 @@\n-            client.registerSubscriber(subscriber);\n+            return client.registerSubscriber(subscriber);\n@@ -284,2 +285,2 @@\n-    private void unregisterResponseSubscriber(Http1ResponseBodySubscriber<T> subscriber) {\n-        client.unregisterSubscriber(subscriber);\n+    private boolean unregisterResponseSubscriber(Http1ResponseBodySubscriber<T> subscriber) {\n+        return client.unregisterSubscriber(subscriber);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Exchange.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -545,1 +545,8 @@\n-    public void registerSubscriber(HttpBodySubscriberWrapper<?> subscriber) {\n+    \/**\n+     * Adds the given subscriber to the subscribers list, or call\n+     * its {@linkplain HttpBodySubscriberWrapper#onError onError}\n+     * method if the client is shutting down.\n+     * @param subscriber the subscriber\n+     * @return true if the subscriber was added to the list.\n+     *\/\n+    public boolean registerSubscriber(HttpBodySubscriberWrapper<?> subscriber) {\n@@ -555,1 +562,1 @@\n-                    return;\n+                    return true;\n@@ -560,0 +567,1 @@\n+        return false;\n@@ -562,1 +570,6 @@\n-    public void unregisterSubscriber(HttpBodySubscriberWrapper<?> subscriber) {\n+    \/**\n+     * Remove the given subscriber from the subscribers list.\n+     * @param subscriber the subscriber\n+     * @return true if the subscriber was found and removed from the list.\n+     *\/\n+    public boolean unregisterSubscriber(HttpBodySubscriberWrapper<?> subscriber) {\n@@ -568,0 +581,1 @@\n+            return true;\n@@ -569,0 +583,1 @@\n+        return false;\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/HttpClientImpl.java","additions":18,"deletions":3,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -543,1 +543,1 @@\n-            if (debug.on()) debug.log(\"onSubscribed called\");\n+            if (debug.on()) debug.log(\"onSubscribe called\");\n@@ -557,2 +557,2 @@\n-                            \/\/ should contain at least 2\n-                            assert buffers.remainingCapacity() > 1\n+                            \/\/ should contain at least 2, unless closed or failed.\n+                            assert buffers.remainingCapacity() > 1 || failed != null\n@@ -560,1 +560,3 @@\n-                                    + \" closed: \" + closed + \" failed: \" + failed;\n+                                    + \", closed: \" + closed + \", terminated: \"\n+                                    + buffers.contains(LAST_LIST)\n+                                    + \", failed: \" + failed;\n@@ -576,1 +578,1 @@\n-                    debug.log(\"onSubscribed failed\", t);\n+                    debug.log(\"onSubscribe failed\", t);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/ResponseSubscribers.java","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -355,2 +355,2 @@\n-    private void registerResponseSubscriber(Http2StreamResponseSubscriber<?> subscriber) {\n-        client().registerSubscriber(subscriber);\n+    private boolean registerResponseSubscriber(Http2StreamResponseSubscriber<?> subscriber) {\n+        return client().registerSubscriber(subscriber);\n@@ -359,2 +359,2 @@\n-    private void unregisterResponseSubscriber(Http2StreamResponseSubscriber<?> subscriber) {\n-        client().unregisterSubscriber(subscriber);\n+    private boolean unregisterResponseSubscriber(Http2StreamResponseSubscriber<?> subscriber) {\n+        return client().unregisterSubscriber(subscriber);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -277,15 +277,0 @@\n-    \/**\n-     * Called right before the userSubscriber::onSubscribe is called.\n-     * @apiNote\n-     * This method may be used by subclasses to perform cleanup\n-     * related actions after a subscription has been successfully\n-     * accepted.\n-     * This method is called while holding a subscription\n-     * lock.\n-     * @implSpec\n-     * This method calls {@link #tryRegister()}\n-     *\/\n-    protected void onSubscribed() {\n-        tryRegister();\n-    }\n-\n@@ -384,0 +369,1 @@\n+            tryRegister();\n@@ -385,1 +371,0 @@\n-                onSubscribed();\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/common\/HttpBodySubscriberWrapper.java","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8277969\n+ * @bug 8277969 8299338\n","filename":"test\/jdk\/java\/net\/httpclient\/AsyncExecutorShutdown.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}