{"files":[{"patch":"@@ -264,1 +264,0 @@\n-                char[] tokenLabel = token.tokenInfo.label;\n@@ -266,2 +265,1 @@\n-                reqBlockUpdates = ((tokenLabel[0] == 'N' && tokenLabel[1] == 'S'\n-                        && tokenLabel[2] == 'S') ? true : false);\n+                reqBlockUpdates = P11Util.isNSS(token);\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Cipher.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -142,3 +142,1 @@\n-        char[] tokenLabel = this.token.tokenInfo.label;\n-        isNSS = (tokenLabel[0] == 'N' && tokenLabel[1] == 'S'\n-                && tokenLabel[2] == 'S');\n+        isNSS = P11Util.isNSS(this.token);\n@@ -398,2 +396,3 @@\n-        boolean keySensitive = (attrs[0].getBoolean() ||\n-                attrs[1].getBoolean() || !attrs[2].getBoolean());\n+        boolean keySensitive =\n+                (attrs[0].getBoolean() && P11Util.isNSS(session.token)) ||\n+                attrs[1].getBoolean() || !attrs[2].getBoolean();\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Key.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -47,0 +47,9 @@\n+    static boolean isNSS(Token token) {\n+        char[] tokenLabel = token.tokenInfo.label;\n+        if (tokenLabel != null && tokenLabel.length >= 3) {\n+            return (tokenLabel[0] == 'N' && tokenLabel[1] == 'S'\n+                    && tokenLabel[2] == 'S');\n+        }\n+        return false;\n+    }\n+\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Util.java","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"}]}