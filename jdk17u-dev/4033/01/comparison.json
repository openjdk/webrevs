{"files":[{"patch":"@@ -39,0 +39,1 @@\n+import java.util.Optional;\n@@ -40,0 +41,1 @@\n+import java.util.function.Supplier;\n@@ -79,0 +81,4 @@\n+    public Optional<Path> getExecutable() {\n+        return Optional.ofNullable(executable);\n+    }\n+\n@@ -176,1 +182,1 @@\n-    public class Result {\n+    public record Result(int exitCode, List<String> output, Supplier<String> cmdline) {\n@@ -178,2 +184,2 @@\n-        Result(int exitCode) {\n-            this.exitCode = exitCode;\n+        public Result {\n+            Objects.requireNonNull(cmdline);\n@@ -190,4 +196,0 @@\n-        public String getPrintableCommandLine() {\n-            return Executor.this.getPrintableCommandLine();\n-        }\n-\n@@ -197,1 +199,1 @@\n-                    getPrintableCommandLine(), expectedExitCode));\n+                    cmdline.get(), expectedExitCode));\n@@ -208,3 +210,0 @@\n-\n-        final int exitCode;\n-        private List<String> output;\n@@ -370,2 +369,2 @@\n-        Result reply = new Result(process.waitFor());\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n+        final int exitCode = process.waitFor();\n+        trace(\"Done. Exit code: \" + exitCode);\n@@ -373,0 +372,1 @@\n+        final List<String> output;\n@@ -374,1 +374,3 @@\n-            reply.output = Collections.unmodifiableList(outputLines);\n+            output = Collections.unmodifiableList(outputLines);\n+        } else {\n+            output = null;\n@@ -376,1 +378,1 @@\n-        return reply;\n+        return createResult(exitCode, output);\n@@ -379,1 +381,1 @@\n-    private Result runToolProvider(PrintStream out, PrintStream err) {\n+    private int runToolProvider(PrintStream out, PrintStream err) {\n@@ -381,4 +383,4 @@\n-        Result reply = new Result(toolProvider.run(out, err, args.toArray(\n-                String[]::new)));\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n-        return reply;\n+        final int exitCode = toolProvider.run(out, err, args.toArray(\n+                String[]::new));\n+        trace(\"Done. Exit code: \" + exitCode);\n+        return exitCode;\n@@ -387,0 +389,3 @@\n+    private Result createResult(int exitCode, List<String> output) {\n+        return new Result(exitCode, output, this::getPrintableCommandLine);\n+    }\n@@ -391,1 +396,1 @@\n-                return runToolProvider(System.out, System.err);\n+                return createResult(runToolProvider(System.out, System.err), null);\n@@ -400,1 +405,1 @@\n-            return runToolProvider(nullPrintStream, nullPrintStream);\n+            return createResult(runToolProvider(nullPrintStream, nullPrintStream), null);\n@@ -405,1 +410,1 @@\n-            Result reply = runToolProvider(ps, ps);\n+            final var exitCode = runToolProvider(ps, ps);\n@@ -407,0 +412,1 @@\n+            final List<String> output;\n@@ -412,1 +418,3 @@\n-                        reply.output = List.of(firstLine);\n+                        output = List.of(firstLine);\n+                    } else {\n+                        output = null;\n@@ -415,2 +423,3 @@\n-                    reply.output = bufReader.lines().collect(\n-                            Collectors.toUnmodifiableList());\n+                    output = bufReader.lines().collect(Collectors.toUnmodifiableList());\n+                } else {\n+                    output = null;\n@@ -422,1 +431,1 @@\n-                        lines = reply.output.stream();\n+                        lines = output.stream();\n@@ -429,1 +438,1 @@\n-            return reply;\n+            return createResult(exitCode, output);\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/Executor.java","additions":37,"deletions":28,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-public final class JPackageCommand extends CommandArguments<JPackageCommand> {\n+public class JPackageCommand extends CommandArguments<JPackageCommand> {\n@@ -736,1 +736,1 @@\n-        if (result.exitCode == 0) {\n+        if (result.exitCode() == 0) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -85,1 +85,1 @@\n-            if (result.exitCode == 1605) {\n+            if (result.exitCode() == 1605) {\n@@ -94,1 +94,1 @@\n-            if ((result.exitCode == 1618) || (result.exitCode == 1603)) {\n+            if ((result.exitCode() == 1618) || (result.exitCode() == 1603)) {\n@@ -356,1 +356,1 @@\n-        if (status.exitCode == 1) {\n+        if (status.exitCode() == 1) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/WindowsHelper.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}