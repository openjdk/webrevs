{"files":[{"patch":"@@ -128,4 +128,0 @@\n-\/\/ Linux on x86 and sparc are different.  On x86 ptrace(PTRACE_GETREGS, ...)\n-\/\/ uses pointer from 4th argument and ignores 3rd argument.  On sparc it uses\n-\/\/ pointer from 3rd argument and ignores 4th argument\n-#define ptrace_getregs(request, pid, addr, data) ptrace(request, pid, data, addr)\n@@ -141,2 +137,11 @@\n-#ifdef PTRACE_GETREGS_REQ\n- if (ptrace_getregs(PTRACE_GETREGS_REQ, pid, user, NULL) < 0) {\n+#if defined(PTRACE_GETREGSET)\n+  struct iovec iov;\n+  iov.iov_base = user;\n+  iov.iov_len = sizeof(*user);\n+  if (ptrace(PTRACE_GETREGSET, pid, NT_PRSTATUS, (void*) &iov) < 0) {\n+    print_debug(\"ptrace(PTRACE_GETREGSET, ...) failed for lwp %d\\n\", pid);\n+    return false;\n+  }\n+  return true;\n+#elif defined(PTRACE_GETREGS_REQ)\n+ if (ptrace(PTRACE_GETREGS_REQ, pid, NULL, user) < 0) {\n@@ -148,9 +153,0 @@\n-#elif defined(PTRACE_GETREGSET)\n- struct iovec iov;\n- iov.iov_base = user;\n- iov.iov_len = sizeof(*user);\n- if (ptrace(PTRACE_GETREGSET, pid, NT_PRSTATUS, (void*) &iov) < 0) {\n-   print_debug(\"ptrace(PTRACE_GETREGSET, ...) failed for lwp %d\\n\", pid);\n-   return false;\n- }\n- return true;\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/ps_proc.c","additions":11,"deletions":15,"binary":false,"changes":26,"status":"modified"}]}