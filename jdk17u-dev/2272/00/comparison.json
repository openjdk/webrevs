{"files":[{"patch":"@@ -1296,1 +1296,1 @@\n-     * The SSLContext implementation for customized TLS protocols\n+     * The SSLContext implementation for customized DTLS protocols\n@@ -1354,2 +1354,0 @@\n-                if (!client)\n-                    return Arrays.asList(candidates);\n@@ -1360,1 +1358,1 @@\n-                candidates = customized.toArray(candidates);\n+                candidates = refactored.toArray(candidates);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLContextImpl.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -739,2 +739,2 @@\n-jdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, \\\n-    DH keySize < 1024, EC keySize < 224, 3DES_EDE_CBC, anon, NULL\n+jdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, DTLSv1.0, RC4, DES, \\\n+    MD5withRSA, DH keySize < 1024, EC keySize < 224, 3DES_EDE_CBC, anon, NULL\n","filename":"src\/java.base\/share\/conf\/security\/java.security","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,2 +31,3 @@\n- * @bug 8202343\n- * @summary Check that SSLv3, TLSv1 and TLSv1.1 are disabled by default\n+ * @bug 8202343 8256660\n+ * @summary Check that SSLv3, TLSv1, TLSv1.1, and DTLSv1.0 are disabled\n+ *          by default\n@@ -41,1 +42,1 @@\n-    private final static String[] protocols = {\n+    private static final String[] tlsProtocols = {\n@@ -45,1 +46,5 @@\n-    private final static List<String> disabledProtocols = List.<String>of(\n+    private static final String[] dtlsProtocols = {\n+        \"DTLS\", \"DTLSv1.0\", \"DTLSv1.2\"\n+    };\n+\n+    private static final List<String> disabledTlsProtocols = List.<String>of(\n@@ -49,0 +54,4 @@\n+    private static final List<String> disabledDtlsProtocols = List.<String>of(\n+        \"DTLSv1.0\"\n+    );\n+\n@@ -50,7 +59,5 @@\n-        for (String protocol : protocols) {\n-            System.out.println(\"\/\/\");\n-            System.out.println(\"\/\/ \" + \"Testing for SSLContext of \" +\n-                    (protocol.isEmpty() ? \"<default>\" : protocol));\n-            System.out.println(\"\/\/\");\n-            checkForProtocols(protocol);\n-            System.out.println();\n+        for (String tlsProtocol : tlsProtocols) {\n+            testProtocol(tlsProtocol, disabledTlsProtocols);\n+        }\n+        for (String dtlsProtocol : dtlsProtocols) {\n+            testProtocol(dtlsProtocol, disabledDtlsProtocols);\n@@ -60,1 +67,12 @@\n-    public static void checkForProtocols(String protocol) throws Exception {\n+    private static void testProtocol(String protocol,\n+            List<String> disabledProtocols) throws Exception {\n+        System.out.println(\"\/\/\");\n+        System.out.println(\"\/\/ \" + \"Testing for SSLContext of \" +\n+                (protocol.isEmpty() ? \"<default>\" : protocol));\n+        System.out.println(\"\/\/\");\n+        checkForProtocols(protocol, disabledProtocols);\n+        System.out.println();\n+    }\n+\n+    private static void checkForProtocols(String protocol,\n+            List<String> disabledProtocols) throws Exception {\n@@ -71,1 +89,1 @@\n-        checkProtocols(parameters.getProtocols(),\n+        checkProtocols(parameters.getProtocols(), disabledProtocols,\n@@ -74,1 +92,0 @@\n-\n@@ -77,1 +94,1 @@\n-        checkProtocols(parameters.getProtocols(),\n+        checkProtocols(parameters.getProtocols(), disabledProtocols,\n@@ -82,1 +99,1 @@\n-        checkProtocols(engine.getSupportedProtocols(),\n+        checkProtocols(engine.getSupportedProtocols(), disabledProtocols,\n@@ -86,1 +103,1 @@\n-        checkProtocols(engine.getEnabledProtocols(),\n+        checkProtocols(engine.getEnabledProtocols(), disabledProtocols,\n@@ -89,0 +106,4 @@\n+        if (protocol.startsWith(\"DTLS\")) {\n+            return;\n+        }\n+\n@@ -92,1 +113,1 @@\n-            checkProtocols(socket.getSupportedProtocols(),\n+            checkProtocols(socket.getSupportedProtocols(), disabledProtocols,\n@@ -96,1 +117,1 @@\n-            checkProtocols(socket.getEnabledProtocols(),\n+            checkProtocols(socket.getEnabledProtocols(), disabledProtocols,\n@@ -105,1 +126,2 @@\n-                \"Supported cipher suites in SSLServerSocket\", false);\n+                disabledProtocols, \"Supported cipher suites in SSLServerSocket\",\n+                false);\n@@ -109,1 +131,2 @@\n-                \"Enabled protocols in SSLServerSocket\", true);\n+                disabledProtocols, \"Enabled protocols in SSLServerSocket\",\n+                true);\n@@ -114,1 +137,2 @@\n-            String title, boolean disabled) throws Exception {\n+            List<String> disabledProtocols, String title, boolean disabled)\n+            throws Exception {\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLContextImpl\/SSLContextDefault.java","additions":47,"deletions":23,"binary":false,"changes":70,"status":"modified"}]}