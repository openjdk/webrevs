{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n- * @author Alexander Potochkin\n@@ -35,1 +34,6 @@\n-import javax.swing.*;\n+import javax.swing.JFrame;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuBar;\n+import javax.swing.JMenuItem;\n+import javax.swing.SwingUtilities;\n+import javax.swing.UIManager;\n@@ -37,1 +41,2 @@\n-import java.awt.*;\n+import java.awt.Point;\n+import java.awt.Robot;\n@@ -51,1 +56,1 @@\n-            if(systemLAF.endsWith(\"MotifLookAndFeel\")){\n+            if (systemLAF.endsWith(\"MotifLookAndFeel\")) {\n@@ -57,1 +62,2 @@\n-            robot.setAutoDelay(10);\n+            robot.setAutoWaitForIdle(true);\n+            robot.setAutoDelay(100);\n@@ -59,1 +65,1 @@\n-            SwingUtilities.invokeAndWait(new Runnable() {\n+            SwingUtilities.invokeAndWait(() -> createAndShowUI());\n@@ -61,4 +67,0 @@\n-                public void run() {\n-                    createAndShowUI();\n-                }\n-            });\n@@ -66,0 +68,1 @@\n+            robot.delay(1000);\n@@ -68,4 +71,5 @@\n-            Point point = Util.getCenterPoint(menu);\n-            robot.mouseMove(point.x, point.y);\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            Point menuLocation = Util.getCenterPoint(menu);\n+            System.out.println(\"Menu Location \" + menuLocation);\n+            robot.mouseMove(menuLocation.x, menuLocation.y);\n+            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -73,0 +77,1 @@\n+            robot.delay(250);\n@@ -74,4 +79,5 @@\n-            point = Util.getCenterPoint(menuItem);\n-            robot.mouseMove(point.x, point.y);\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            Point itemLocation = Util.getCenterPoint(menuItem);\n+            System.out.println(\"MenuItem Location \" + itemLocation);\n+            robot.mouseMove(itemLocation.x, itemLocation.y);\n+            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -79,0 +85,1 @@\n+            robot.delay(250);\n@@ -84,24 +91,0 @@\n-            \/\/ test mouse drag\n-            point = Util.getCenterPoint(menu);\n-            robot.mouseMove(point.x, point.y);\n-            Point menuLocation = Util.invokeOnEDT(new Callable<Point>() {\n-\n-                @Override\n-                public Point call() throws Exception {\n-                    return menu.getLocationOnScreen();\n-                }\n-            });\n-\n-            Point itemLocation = Util.invokeOnEDT(new Callable<Point>() {\n-\n-                @Override\n-                public Point call() throws Exception {\n-                    return menuItem.getLocationOnScreen();\n-                }\n-            });\n-\n-            int x0 = menuLocation.x + 10;\n-            int y0 = menuLocation.y + 10;\n-            int x1 = itemLocation.x + 10;\n-            int y1 = itemLocation.y + 10;\n-\n@@ -109,2 +92,3 @@\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            robot.mouseMove(menuLocation.x, menuLocation.y);\n+            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -112,0 +96,1 @@\n+            robot.delay(250);\n@@ -113,3 +98,6 @@\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            Util.glide(robot, x0, y0, x1, y1);\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            \/\/ test mouse drag\n+            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.delay(250);\n+            Util.glide(robot, menuLocation.x, menuLocation.y,\n+                              itemLocation.x, itemLocation.y);\n+            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -122,1 +110,5 @@\n-            if (frame != null) SwingUtilities.invokeAndWait(() -> frame.dispose());\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n@@ -154,1 +146,0 @@\n-\n@@ -157,0 +148,1 @@\n+\n","filename":"test\/jdk\/javax\/swing\/JMenuItem\/4654927\/bug4654927.java","additions":42,"deletions":50,"binary":false,"changes":92,"status":"modified"}]}