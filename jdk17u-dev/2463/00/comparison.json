{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,4 +27,2 @@\n- * @bug 8291226 8291638\n- * @modules java.base\/sun.net:+open\n- *          java.base\/sun.net.www.http:+open\n- *          java.base\/sun.net.www:+open\n+ * @bug 8291226 8291638 8330523\n+ * @modules java.base\/sun.net.www.http:+open\n@@ -32,160 +30,16 @@\n- * @run main\/othervm KeepAliveTest 0\n- * @run main\/othervm KeepAliveTest 1\n- * @run main\/othervm KeepAliveTest 2\n- * @run main\/othervm KeepAliveTest 3\n- * @run main\/othervm KeepAliveTest 4\n- * @run main\/othervm KeepAliveTest 5\n- * @run main\/othervm KeepAliveTest 6\n- * @run main\/othervm KeepAliveTest 7\n- * @run main\/othervm KeepAliveTest 8\n- * @run main\/othervm KeepAliveTest 9\n- * @run main\/othervm KeepAliveTest 10\n- * @run main\/othervm KeepAliveTest 11\n- * @run main\/othervm KeepAliveTest 12\n- * @run main\/othervm KeepAliveTest 13\n- * @run main\/othervm KeepAliveTest 14\n- * @run main\/othervm KeepAliveTest 15\n- * @run main\/othervm KeepAliveTest 16\n- * @run main\/othervm KeepAliveTest 17\n- * @run main\/othervm KeepAliveTest 18\n- * @run main\/othervm KeepAliveTest 19\n- * @run main\/othervm KeepAliveTest 20\n- * @run main\/othervm KeepAliveTest 21\n- * @run main\/othervm KeepAliveTest 22\n- * @run main\/othervm KeepAliveTest 23\n- * @run main\/othervm KeepAliveTest 24\n- * @run main\/othervm KeepAliveTest 25\n- * @run main\/othervm KeepAliveTest 26\n- * @run main\/othervm KeepAliveTest 27\n- * @run main\/othervm KeepAliveTest 28\n- * @run main\/othervm KeepAliveTest 29\n- * @run main\/othervm KeepAliveTest 30\n- * @run main\/othervm KeepAliveTest 31\n- * @run main\/othervm KeepAliveTest 32\n- * @run main\/othervm KeepAliveTest 33\n- * @run main\/othervm KeepAliveTest 34\n- * @run main\/othervm KeepAliveTest 35\n- * @run main\/othervm KeepAliveTest 36\n- * @run main\/othervm KeepAliveTest 37\n- * @run main\/othervm KeepAliveTest 38\n- * @run main\/othervm KeepAliveTest 39\n- * @run main\/othervm KeepAliveTest 40\n- * @run main\/othervm KeepAliveTest 41\n- * @run main\/othervm KeepAliveTest 42\n- * @run main\/othervm KeepAliveTest 43\n- * @run main\/othervm KeepAliveTest 44\n- * @run main\/othervm KeepAliveTest 45\n- * @run main\/othervm KeepAliveTest 46\n- * @run main\/othervm KeepAliveTest 47\n- * @run main\/othervm KeepAliveTest 48\n- * @run main\/othervm KeepAliveTest 49\n- * @run main\/othervm KeepAliveTest 50\n- * @run main\/othervm KeepAliveTest 51\n- * @run main\/othervm KeepAliveTest 52\n- * @run main\/othervm KeepAliveTest 53\n- * @run main\/othervm KeepAliveTest 54\n- * @run main\/othervm KeepAliveTest 55\n- * @run main\/othervm KeepAliveTest 56\n- * @run main\/othervm KeepAliveTest 57\n- * @run main\/othervm KeepAliveTest 58\n- * @run main\/othervm KeepAliveTest 59\n- * @run main\/othervm KeepAliveTest 60\n- * @run main\/othervm KeepAliveTest 61\n- * @run main\/othervm KeepAliveTest 62\n- * @run main\/othervm KeepAliveTest 63\n- * @run main\/othervm KeepAliveTest 64\n- * @run main\/othervm KeepAliveTest 65\n- * @run main\/othervm KeepAliveTest 66\n- * @run main\/othervm KeepAliveTest 67\n- * @run main\/othervm KeepAliveTest 68\n- * @run main\/othervm KeepAliveTest 69\n- * @run main\/othervm KeepAliveTest 70\n- * @run main\/othervm KeepAliveTest 71\n- * @run main\/othervm KeepAliveTest 72\n- * @run main\/othervm KeepAliveTest 73\n- * @run main\/othervm KeepAliveTest 74\n- * @run main\/othervm KeepAliveTest 75\n- * @run main\/othervm KeepAliveTest 76\n- * @run main\/othervm KeepAliveTest 77\n- * @run main\/othervm KeepAliveTest 78\n- * @run main\/othervm KeepAliveTest 79\n- * @run main\/othervm KeepAliveTest 80\n- * @run main\/othervm KeepAliveTest 81\n- * @run main\/othervm KeepAliveTest 82\n- * @run main\/othervm KeepAliveTest 83\n- * @run main\/othervm KeepAliveTest 84\n- * @run main\/othervm KeepAliveTest 85\n- * @run main\/othervm KeepAliveTest 86\n- * @run main\/othervm KeepAliveTest 87\n- * @run main\/othervm KeepAliveTest 88\n- * @run main\/othervm KeepAliveTest 89\n- * @run main\/othervm KeepAliveTest 90\n- * @run main\/othervm KeepAliveTest 91\n- * @run main\/othervm KeepAliveTest 92\n- * @run main\/othervm KeepAliveTest 93\n- * @run main\/othervm KeepAliveTest 94\n- * @run main\/othervm KeepAliveTest 95\n- * @run main\/othervm KeepAliveTest 96\n- * @run main\/othervm KeepAliveTest 97\n- * @run main\/othervm KeepAliveTest 98\n- * @run main\/othervm KeepAliveTest 99\n- * @run main\/othervm KeepAliveTest 100\n- * @run main\/othervm KeepAliveTest 101\n- * @run main\/othervm KeepAliveTest 102\n- * @run main\/othervm KeepAliveTest 103\n- * @run main\/othervm KeepAliveTest 104\n- * @run main\/othervm KeepAliveTest 105\n- * @run main\/othervm KeepAliveTest 106\n- * @run main\/othervm KeepAliveTest 107\n- * @run main\/othervm KeepAliveTest 108\n- * @run main\/othervm KeepAliveTest 109\n- * @run main\/othervm KeepAliveTest 110\n- * @run main\/othervm KeepAliveTest 111\n- * @run main\/othervm KeepAliveTest 112\n- * @run main\/othervm KeepAliveTest 113\n- * @run main\/othervm KeepAliveTest 114\n- * @run main\/othervm KeepAliveTest 115\n- * @run main\/othervm KeepAliveTest 116\n- * @run main\/othervm KeepAliveTest 117\n- * @run main\/othervm KeepAliveTest 118\n- * @run main\/othervm KeepAliveTest 119\n- * @run main\/othervm KeepAliveTest 120\n- * @run main\/othervm KeepAliveTest 121\n- * @run main\/othervm KeepAliveTest 122\n- * @run main\/othervm KeepAliveTest 123\n- * @run main\/othervm KeepAliveTest 124\n- * @run main\/othervm KeepAliveTest 125\n- * @run main\/othervm KeepAliveTest 126\n- * @run main\/othervm KeepAliveTest 127\n- * @run main\/othervm KeepAliveTest 128\n- * @run main\/othervm KeepAliveTest 129\n- * @run main\/othervm KeepAliveTest 130\n- * @run main\/othervm KeepAliveTest 131\n- * @run main\/othervm KeepAliveTest 132\n- * @run main\/othervm KeepAliveTest 133\n- * @run main\/othervm KeepAliveTest 134\n- * @run main\/othervm KeepAliveTest 135\n- * @run main\/othervm KeepAliveTest 136\n- * @run main\/othervm KeepAliveTest 137\n- * @run main\/othervm KeepAliveTest 138\n- * @run main\/othervm KeepAliveTest 139\n- * @run main\/othervm KeepAliveTest 140\n- * @run main\/othervm KeepAliveTest 141\n- * @run main\/othervm KeepAliveTest 142\n- * @run main\/othervm KeepAliveTest 143\n- * @run main\/othervm KeepAliveTest 144\n- * @run main\/othervm KeepAliveTest 145\n- * @run main\/othervm KeepAliveTest 146\n- * @run main\/othervm KeepAliveTest 147\n- * @run main\/othervm KeepAliveTest 148\n- * @run main\/othervm KeepAliveTest 149\n- * @run main\/othervm KeepAliveTest 150\n- * @run main\/othervm KeepAliveTest 151\n- * @run main\/othervm KeepAliveTest 152\n- * @run main\/othervm KeepAliveTest 153\n- * @run main\/othervm KeepAliveTest 154\n- * @run main\/othervm KeepAliveTest 155\n- * @run main\/othervm KeepAliveTest 156\n- * @run main\/othervm KeepAliveTest 157\n- * @run main\/othervm KeepAliveTest 158\n- * @run main\/othervm KeepAliveTest 159\n+ * @run main\/othervm KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=100 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.proxy=200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=100 -Dhttp.keepAlive.time.proxy=200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=-100 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.proxy=-200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=-100 -Dhttp.keepAlive.time.proxy=-200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=0 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.proxy=0 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=0 -Dhttp.keepAlive.time.proxy=0 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=0 -Dhttp.keepAlive.time.proxy=-200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=-100 -Dhttp.keepAlive.time.proxy=0 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=100 -Dhttp.keepAlive.time.proxy=0 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=0 -Dhttp.keepAlive.time.proxy=200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=100 -Dhttp.keepAlive.time.proxy=-200 KeepAliveTest\n+ * @run main\/othervm -Dhttp.keepAlive.time.server=-100 -Dhttp.keepAlive.time.proxy=200 KeepAliveTest\n@@ -193,3 +47,0 @@\n-\n-import java.nio.charset.StandardCharsets;\n-import java.io.InputStream;\n@@ -198,0 +49,1 @@\n+import java.io.InputStream;\n@@ -209,0 +61,1 @@\n+import java.nio.charset.StandardCharsets;\n@@ -211,1 +64,1 @@\n-import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.Phaser;\n@@ -215,0 +68,3 @@\n+\n+import jdk.test.lib.net.URIBuilder;\n+\n@@ -218,1 +74,0 @@\n-import jdk.test.lib.net.URIBuilder;\n@@ -221,5 +76,1 @@\n-    private static final Logger logger = Logger.getLogger(\"sun.net.www.protocol.http.HttpURLConnection\");\n-    private static final String NOT_CACHED = \"NotCached\";\n-    private static final String CLIENT_SEPARATOR = \";\";\n-    private static final String NEW_LINE = \"\\r\\n\";\n-    private volatile int SERVER_PORT = 0;\n+\n@@ -227,3 +78,1 @@\n-     * isProxySet is shared variable between server thread and client thread(main) and it should be set and reset to false for each and\n-     * every scenario.\n-     * isProxySet variable should be set by server thread before proceeding to client thread(main).\n+     * This test covers a matrix of 10 server scenarios and 16 client scenarios.\n@@ -231,1 +80,4 @@\n-    private volatile boolean isProxySet = false;\n+    private static final Logger logger = Logger.getLogger(\"sun.net.www.protocol.http.HttpURLConnection\");\n+\n+    private static final String NEW_LINE = \"\\r\\n\";\n+\n@@ -238,639 +90,1 @@\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_NEGATIVE = \"http.keepAlive.time.server=-100\";\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_NEGATIVE = \"http.keepAlive.time.proxy=-200\";\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_ZERO = \"http.keepAlive.time.server=0\";\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_ZERO = \"http.keepAlive.time.proxy=0\";\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_POSITIVE = \"http.keepAlive.time.server=100\";\n-    private static final String CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_POSITIVE = \"http.keepAlive.time.proxy=200\";\n-    private static final String CONNECTION_KEEP_ALIVE_WITH_TIMEOUT = CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE\n-        + KEEP_ALIVE_TIMEOUT;\n-   \/*\n-    * Following Constants represents Client Side Properties and is used as reference in below table as\n-    * CLIENT_INPUT_CONSTANT_NAMES\n-    *\/\n-    private static final String SERVER_100_NEGATIVE = CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_NEGATIVE;\n-    private static final String PROXY_200_NEGATIVE = CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_NEGATIVE;\n-    private static final String SERVER_ZERO = CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_ZERO;\n-    private static final String PROXY_ZERO = CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_ZERO;\n-    private static final String SERVER_100 = CLIENT_HTTP_KEEP_ALIVE_TIME_SERVER_POSITIVE;\n-    private static final String PROXY_200 = CLIENT_HTTP_KEEP_ALIVE_TIME_PROXY_POSITIVE;\n-\n-   \/*\n-    * CONSTANTS A,B,C,D,E,NI,F,G,H,I represents ServerScenarios and is used as reference in below table\n-    * as SERVER_RESPONSE_CONSTANT_NAME\n-    *\/\n-    private static final String A = CONNECTION_KEEP_ALIVE_ONLY;\n-    private static final String B = CONNECTION_KEEP_ALIVE_WITH_TIMEOUT;\n-    private static final String C = PROXY_CONNECTION_KEEP_ALIVE_ONLY;\n-    private static final String D = PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + CONNECTION_KEEP_ALIVE_ONLY;\n-    private static final String E = C + NEW_LINE + KEEP_ALIVE_PROXY_TIMEOUT;\n-    private static final String NI = \"NO_INPUT\";\n-    private static final String F = A + NEW_LINE + KEEP_ALIVE_TIMEOUT_NEG;\n-    private static final String G = A + NEW_LINE + KEEP_ALIVE_TIMEOUT_ZERO;\n-    private static final String H = C + NEW_LINE + KEEP_ALIVE_TIMEOUT_NEG;\n-    private static final String I = C + NEW_LINE + KEEP_ALIVE_TIMEOUT_ZERO;\n-\n-   \/*\n-    * There are 160 scenarios run by this program.\n-    * For every scenario there is mapping between serverScenarios[int],clientScenarios[int] and expectedOutput[int]\n-    *\n-    * serverScenarios[0] clientScenarios[0] expectedOutput[0]\n-    * serverScenarios[1] clientScenarios[1] expectedOutput[1]\n-    * serverScenarios[2] clientScenarios[2] expectedOutput[2]\n-    *\n-    * ...\n-    *\n-    * serverScenarios[159] cientScenarios[159] expectedOutput[159]\n-    *\n-    * whereas serverScenarios[int] is retrieved using getServerScenario(int)\n-    * whereas clientScenarios[int] is retrieved using clientScenario[getClientScenarioNumber[int]]\n-    * and\n-    * expectedOutput[int] is retrieved using expectedOuput[int] directly.\n-    *\n-    *\/\n-\n-   \/* Here is the complete table of server_response, client system properties input and expected cached timeout at client side *\/\n-   \/* ScNo  |  SERVER RESPONSE (SERVER_RESPONSE_CONSTANT_NAME)| CLIENT SYSTEM PROPERTIES INPUT (CLIENT_INPUT_CONSTANT_NAMES) | EXPECTED CACHED TIMEOUT AT CLIENT SIDE\n-    *****************************************************************************************************************************************\n-    *    0  |  Connection: keep-alive (A)                     | No Input Provided (NI)                       | Default Timeout set to 5\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    1  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=100 (SERVER_100)| Client Timeout set to 100\n-    *--------------------------------------------------------------------------------------------------------------------------\n-    *    2  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.proxy=200 (PROXY_200)  | Default Timeout set to 5\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    3  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=100 &&          |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=200              | Timeout set to 100\n-    *       |                                                 | (SERVER_100 && PROXY_200)                    |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    4  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=-100            | Default Timeout set to 5\n-    *       |                                                 | (SERVER_100_NEGATIVE)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    5  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.proxy=-200             | Default Timeout set to 5\n-    *       |                                                 | (PROXY_200_NEGATIVE)                         |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    6  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=-100 &&         |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=-200             | Default Timeout set to 5\n-    *       |                                                 | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)  |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    7  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=0               | Connection Closed Immediately\n-    *       |                                                 | (SERVER_ZERO)                                |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    8  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.proxy=0                | Default Timeout set to 5\n-    *       |                                                 | (PROXY_ZERO)                                 |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *    9  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=0 &&            |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=0                | Connection Closed Immediately\n-    *       |                                                 | (SERVER_ZERO && PROXY_ZERO)                  |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   10  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=0 &&            |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=-200             | Connection Closed Immediately\n-    *       |                                                 | (SERVER_ZERO && PROXY_200_NEGATIVE)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   11  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=-100 &&         |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=0                | Default Timeout set to 5\n-    *       |                                                 | (SERVER_100_NEGATIVE && PROXY_ZERO)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   12  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=100 &&          |\n-    *       |                                                 |  -Dhttp.keepAlive.time.proxy=0               | Timeout set to 100\n-    *       |                                                 | (SERVER_100 && PROXY_ZERO)                   |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   13  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=0 &&            |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=200              | Connection Closed Immediately\n-    *       |                                                 | (SERVER_ZERO && PROXY_200)                   |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   14  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=100 &&          |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=-200             | Timeout set to 100\n-    *       |                                                 | (SERVER_100 && PROXY_200_NEGATIVE)           |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   15  |  Connection: keep-alive (A)                     | -Dhttp.keepAlive.time.server=-100 &&         |\n-    *       |                                                 | -Dhttp.keepAlive.time.proxy=200              | Default Timeout set to 5\n-    *       |                                                 | (SERVER_100_NEGATIVE && PROXY_200)           |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   16  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | No Input Provided (NI)                   | Timeout set to 20\n-    *------------------------------------------------------------------------------------------------------------------------\n-    *   17  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=100         | Timeout set to 20\n-    *       |                                                     | (SERVER_100)                             |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   18  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.proxy=200          | Timeout set to 20\n-    *       |                                                     | (PROXY_200)                              |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   19  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=100 &&      |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=200          | Timeout set to 20\n-    *       |                                                     | (SERVER_100 && PROXY_200)                |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   20  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=-100        | Timeout set to 20\n-    *       |                                                     | (SERVER_100_NEGATIVE)                    |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   21  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.proxy=-200         | Timeout set to 20\n-    *       |                                                     | (PROXY_200_NEGATIVE)                     |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   22  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=-100 &&       |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=-200           | Timeout set to 20\n-    *       |                                                     | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   23  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=0      | Timeout set to 20\n-    *       |                                                     | (SERVER_ZERO)                       |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   24  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 20\n-    *       |                                                     | (PROXY_ZERO)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   25  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 20\n-    *       |                                                     | (SERVER_ZERO && PROXY_ZERO)         |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   26  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=-200    | Timeout set to 20\n-    *       |                                                     | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   27  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 20\n-    *       |                                                     | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   28  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 20\n-    *       |                                                     | (SERVER_100 && PROXY_ZERO)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   29  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 20\n-    *       |                                                     | (SERVER_ZERO && PROXY_200)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   30  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=-200    | Timeout set to 20\n-    *       |                                                     | (SERVER_100 && PROXY_200_NEGATIVE)  |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   31  |Connection: keep-alive\\r\\nKeep-alive: timeout=20 (B) |-Dhttp.keepAlive.time.server=-100 && |\n-    *       |                                                     |-Dhttp.keepAlive.time.proxy=200      | Timeout set to 20\n-    *       |                                                     | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   32  |Proxy-Connection: keep-alive (C)                     | No Input Provided (NI)              | Default timeout set to 60\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   33  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=100    | Default timeout set to 60\n-    *       |                                                     | (SERVER_100)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   34  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                     | (PROXY_200)                         |\n-    *--------------------------------------------------------------------------------------------------------------------------\n-    *   35  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                     | (SERVER_100 && PROXY_200)           |\n-    *--------------------------------------------------------------------------------------------------------------------------\n-    *   36  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=-100   | Default timeout set to 60\n-    *       |                                                     | (SERVER_100_NEGATIVE)               |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   37  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.proxy=-200    | Default timeout set to 60\n-    *       |                                                     | (PROXY_200_NEGATIVE)                |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   38  |Proxy-Connection: keep-alive (C)                     |-Dhttp.keepAlive.time.server=-100 &&       |\n-    *       |                                                     |-Dhttp.keepAlive.time.proxy=-200           | Default timeout set to 60\n-    *       |                                                     |(SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   39  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=0      | Default timeout set to 60\n-    *       |                                                     | (SERVER_ZERO)                       |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   40  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                     | (PROXY_ZERO)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   41  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                     | (SERVER_ZERO && PROXY_ZERO)         |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   42  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=-200    | Default timeout set to 60\n-    *       |                                                     | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *   43  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                     | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *   44  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                     | (SERVER_100 && PROXY_ZERO)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   45  |Proxy-Connection: keep-alive (C)                     | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                     | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                     | (SERVER_ZERO && PROXY_200)          |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   46  |Proxy-Connection: keep-alive (C)                     |-Dhttp.keepAlive.time.server=100 &&  |\n-    *       |                                                     |-Dhttp.keepAlive.time.proxy=-200     | Default timeout set to 60\n-    *       |                                                     | (SERVER_100 && PROXY_200_NEGATIVE)  |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   47  |Proxy-Connection: keep-alive (C)                     |-Dhttp.keepAlive.time.server=-100 && |\n-    *       |                                                     |-Dhttp.keepAlive.time.proxy=200      | Timeout set to 200\n-    *       |                                                     | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   48  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | No Input Provided (NI)              | Default timeout set to 60\n-    *-----------------------------------------------------------------------------------------------------------------------------\n-    *   49  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=100    | Default timeout set to 60\n-    *       |                                                         | (SERVER_100)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------\n-    *   50  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                         | (PROXY_200)                         |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   51  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                         | (SERVER_100 && PROXY_200)           |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   52  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=-100   | Default timeout set to 60\n-    *       |                                                         | (SERVER_100_NEGATIVE)               |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   53  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.proxy=-200    | Default timeout set to 60\n-    *       |                                                         | (PROXY_200_NEGATIVE)                |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   54  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=-100&&        |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200           | Default timeout set to 60\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   55  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=0      | Default timeout set to 60\n-    *       |                                                         | (SERVER_ZERO)                       |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   56  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (PROXY_ZERO)                        |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   57  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)         |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   58  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | Default timeout set to 60\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   59  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   60  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)          |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   61  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)          |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   62  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | default timeout set to 60\n-    *       |                                                         | (SERVER_100 && PROXY_200_NEGATIVE)  |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   63  |Connection:keep-alive\\r\\nProxy-connection:keep-alive (D) | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 200\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   64  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| No Input Provided (NI)              | Timeout set to 120\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   65  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=100    | Timeout set to 120\n-    *       |                                                         | (SERVER_100)                        |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   66  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.proxy=200     | Timeout set to 120\n-    *       |                                                         | (PROXY_200)                         |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   67  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 120\n-    *       |                                                         | (SERVER_100 && PROXY_200)           |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   68  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=-100   | Timeout set to 120\n-    *       |                                                         | (SERVER_100_NEGATIVE)               |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   69  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.proxy=-200    | Timeout set to 120\n-    *       |                                                         | (PROXY_200_NEGATIVE)                |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   70  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=-100 &&       |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200           | Timeout set to 120\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   71  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=0      | Timeout set to 120\n-    *       |                                                         | (SERVER_ZERO)                       |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   72  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.proxy=0       | Timeout set to 120\n-    *       |                                                         | (PROXY_ZERO)                        |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   73  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 120\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)         |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   74  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | Timeout set to 120\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   75  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 120\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   76  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 120\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   77  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 120\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   78  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=100 &&         |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200            | Timeout set to 120\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE) |\n-    *-------------------------------------------------------------------------------------------------------------------------------\n-    *   79  |Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120 (E)| -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | Timeout set to 120\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *-----------------------------------------------------------------------------------------------------------------------------\n-    *   80  |No Input (NI)                                            | No Input Provided (NI)              | default timeout set to 5\n-    *-----------------------------------------------------------------------------------------------------------------------------\n-    *   81  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=100    | Timeout set to 100\n-    *       |                                                         | (SERVER_100)                        |\n-    *-----------------------------------------------------------------------------------------------------------------------------\n-    *   82  |No Input (NI)                                            | -Dhttp.keepAlive.time.proxy=200     | default timeout set to 5\n-    *       |                                                         | (PROXY_200)                         |\n-    *-----------------------------------------------------------------------------------------------------------------------------\n-    *   83  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | client timeot set to 100\n-    *       |                                                         | (SERVER_100 && PROXY_200)           |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   84  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=-100   | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE)               |\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   85  |No Input (NI)                                            | -Dhttp.keepAlive.time.proxy=-200    | default timeout set to 5\n-    *       |                                                         | (PROXY_200_NEGATIVE)                |\n-    *----------------------------------------------------------------------------------------------------------------------------\n-    *   86  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=-100 &&       |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200           | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *------------------------------------------------------------------------------------------------------------------------------\n-    *   87  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=0      | close connection immediately\n-    *       |                                                         | (SERVER_ZERO)                       |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *   88  |No Input (NI)                                            | -Dhttp.keepAlive.time.proxy=0       | default timeout set to 5\n-    *       |                                                         | (PROXY_ZERO)                        |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *   89  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)         |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *   90  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   91  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   92  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | Timeout set to 100\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)          |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   93  |No Input (NI)                                            | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)          |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   94  |No Input (NI)                                            |-Dhttp.keepAlive.time.server=100 &&  |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200     | Timeout set to 100\n-    *       |                                                         | (SERVER_100 && PROXY_200_NEGATIVE)  |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   95  |No Input (NI)                                            |-Dhttp.keepAlive.time.server=-100 && |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=200      | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   96  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    | No Input Provided (NI)              | default timeout set to 5\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   97  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=100     | Timeout set to 100\n-    *       |                                                         | (SERVER_100)                        |\n-    *--------------------------------------------------------------------------------------------------------------------------------\n-    *   98  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.proxy=200      | default timeout set to 5\n-    *       |                                                         | (PROXY_200)                         |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *   99  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=100 &&  |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=200      | Timeout set to 100\n-    *       |                                                         |(SERVER_100 && PROXY_200)            |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  100  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=-100    | default timeout set to 5\n-    *       |                                                         |(SERVER_100_NEGATIVE)                |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  101  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.proxy=-200     | default timeout set to 5\n-    *       |                                                         |(PROXY_200_NEGATIVE)                 |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  102  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=-100 &&        |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200            | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  103  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=0       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO)                       |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  104  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.proxy=0        | default timeout set to 5\n-    *       |                                                         | (PROXY_ZERO)                        |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  105  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=0 &&    |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)         |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  106  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=0 &&    |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200     | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO_NEGATIVE)|\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  107  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=-100 && |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=0        | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  108  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=100 &&  |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=0        | Timeout set to 100\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  109  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=0 &&    |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=200      | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  110  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=100 &&  |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200     | Timeout set to 100\n-    *       |                                                         |(SERVER_100 && PROXY_200_NEGATIVE)   |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  111  |Connection: keep-alive\\r\\nKeep-alive: timeout=-20 (F)    |-Dhttp.keepAlive.time.server=-100 && |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=200      | default timeout set to 5\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  112  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | No Input Provided (NI)              | close connection immediately\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  113  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=100    | close connection immediately\n-    *       |                                                         | (SERVER_100)                        |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  114  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.proxy=200     | close connection immediately\n-    *       |                                                         | (PROXY_200)                         |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  115  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_200)           |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  116  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=-100   | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE)               |\n-    *------------------------------------------------------------------------------------------------------------------------------------\n-    *  117  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.proxy=-200    | close connection immediately\n-    *       |                                                         | (PROXY_200_NEGATIVE)                |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  118  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      |-Dhttp.keepAlive.time.server=-100 &&         |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200             | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE) |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  119  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=0      | close connection immediately\n-    *       |                                                         | (SERVER_ZERO)                       |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  120  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (PROXY_ZERO)                        |\n-    *------------------------------------------------------------------------------------------------------------------------------------\n-    *  121  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)         |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  122  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE) |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  123  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO) |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  124  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0       | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  125  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=0 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)          |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  126  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=100 && |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200    | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_200_NEGATIVE)  |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  127  |Connection: keep-alive\\r\\nKeep-alive: timeout=0 (G)      | -Dhttp.keepAlive.time.server=-100 &&|\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200     | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)  |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  128  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| No Input Provided (NI)                | default timeout set to 60\n-    ---------------------------------------------------------------------------------------------------------------------------------------\n-    *  129  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=100      | default timeout set to 60\n-    *       |                                                         | (SERVER_100)                          |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  130  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.proxy=200       | Timeout set to 200\n-    *       |                                                         | (PROXY_200)                           |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  131  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=100 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200       | Timeout set to 200\n-    *       |                                                         | (SERVER_100 && PROXY_200)             |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  132  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=-100     | default timeout set to 60\n-    *       |                                                         | (SERVER_100_NEGATIVE)                 |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  133  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.proxy=-200      | default timeout set to 60\n-    *       |                                                         | (PROXY_200_NEGATIVE)                  |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  134  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)|-Dhttp.keepAlive.time.server=-100 &&        |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200            | default timeout set to 60\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE)|\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *  135  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=0        | default timeout set to 60\n-    *       |                                                         | (SERVER_ZERO)                         |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  136  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (PROXY_ZERO)                          |\n-    *----------------------------------------------------------------------------------------------------------------------------------\n-    *  137  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)           |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  138  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200      | default timeout set to 60\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE)   |\n-    *---------------------------------------------------------------------------------------------------------------------------------------\n-    *  139  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=-100 &&  |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO)   |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  140  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=100 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)            |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  141  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)| -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200       | Timeout set to 20\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)            |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  142  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)|-Dhttp.keepAlive.time.server=100 &&    |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=-200       | default timeout set to 60\n-    *       |                                                         | (SERVER_100 && PROXY_200_NEGATIVE)    |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  143  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=-20 (H)|-Dhttp.keepAlive.time.server=-100 &&   |\n-    *       |                                                         |-Dhttp.keepAlive.time.proxy=200        | Timeout set to 200\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)    |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  144  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | No Input Provided (NI)                | close connection immediately\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  145  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=100      | close connection immediately\n-    *       |                                                         | (SERVER_100)                          |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  146  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.proxy=200       | close connection immediately\n-    *       |                                                         | (PROXY_200)                           |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  147  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=100 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200       | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_200)             |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  148  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=-100     | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE)                 |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  149  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.proxy=-200      | close connection immediately\n-    *       |                                                         | (PROXY_200_NEGATIVE)                  |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  150  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=-100 &&        |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200            | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200_NEGATIVE) |\n-    *------------------------------------------------------------------------------------------------------------------------------------\n-    *  151  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=0        | close connection immediately\n-    *       |                                                         | (SERVER_ZERO)                         |\n-    *-----------------------------------------------------------------------------------------------------------------------------------\n-    *  152  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (PROXY_ZERO)                          |\n-    *---------------------------------------------------------------------------------------------------------------------------------\n-    *  153  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_ZERO)           |\n-    *------------------------------------------------------------------------------------------------------------------------------------\n-    *  154  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200      | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200_NEGATIVE)   |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  155  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=-100 &&  |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_ZERO)   |\n-    *-------------------------------------------------------------------------------------------------------------------------------------\n-    *  156  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=100 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=0         | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_ZERO)            |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  157  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=0 &&     |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200       | close connection immediately\n-    *       |                                                         | (SERVER_ZERO && PROXY_200)            |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  158  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=100 &&   |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=-200      | close connection immediately\n-    *       |                                                         | (SERVER_100 && PROXY_200_NEGATIVE)    |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *  159  |Proxy-Connection:keep-alive\\r\\nKeep-alive:timeout=0 (I)  | -Dhttp.keepAlive.time.server=-100 &&  |\n-    *       |                                                         | -Dhttp.keepAlive.time.proxy=200       | close connection immediately\n-    *       |                                                         | (SERVER_100_NEGATIVE && PROXY_200)    |\n-    *--------------------------------------------------------------------------------------------------------------------------------------\n-    *\/\n-\n-   \/* private static final String[] serverScenarios = {\n-        A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A,\n-        B, B, B, B, B, B, B, B, B, B,B, B, B, B, B, B,\n-        C, C, C, C, C, C, C, C, C, C, C, C, C, C, C, C,\n-        D, D, D, D, D, D, D, D, D, D, D, D, D, D, D, D,\n-        E, E, E, E, E, E, E, E, E, E, E, E, E, E, E, E,\n-        NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI, NI,\n-        F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F,\n-        G, G, G, G, G, G, G, G, G, G, G, G, G, G, G, G,\n-        H, H, H, H, H, H, H, H, H, H, H, H, H, H, H, H,\n-        I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I\n-    }; *\/\n-    \/*\n-     * following are client scenarios which are repeated.\n-     *\/\n-    private static final String[] a = {\n-        NI, SERVER_100,     PROXY_200, SERVER_100 + CLIENT_SEPARATOR + PROXY_200,    SERVER_100_NEGATIVE,\n-        PROXY_200_NEGATIVE, SERVER_100_NEGATIVE + CLIENT_SEPARATOR + PROXY_200_NEGATIVE,\n-        SERVER_ZERO,         PROXY_ZERO, SERVER_ZERO + CLIENT_SEPARATOR + PROXY_ZERO,\n-        SERVER_ZERO + CLIENT_SEPARATOR + PROXY_200_NEGATIVE, SERVER_100_NEGATIVE + CLIENT_SEPARATOR + PROXY_ZERO,\n-        SERVER_100 + CLIENT_SEPARATOR + PROXY_ZERO, SERVER_ZERO + CLIENT_SEPARATOR + PROXY_200,\n-        SERVER_100 + CLIENT_SEPARATOR + PROXY_200_NEGATIVE, SERVER_100_NEGATIVE + CLIENT_SEPARATOR + PROXY_200\n-    };\n+    private static final String CONNECTION_KEEP_ALIVE_WITH_TIMEOUT = CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_TIMEOUT;\n@@ -878,15 +92,11 @@\n-   \/* private String[] clientScenarios = {\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15],\n-    }; *\/\n-\n-    private static final String[] clientScenarios = {\n-        a[0] , a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]\n+    private static final String[] serverHeaders = {\n+        null,\n+        CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE,\n+        CONNECTION_KEEP_ALIVE_WITH_TIMEOUT + NEW_LINE,\n+        PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE,\n+        PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE,\n+        PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_PROXY_TIMEOUT + NEW_LINE,\n+        CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_TIMEOUT_NEG + NEW_LINE,\n+        CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_TIMEOUT_ZERO + NEW_LINE,\n+        PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_TIMEOUT_NEG + NEW_LINE,\n+        PROXY_CONNECTION_KEEP_ALIVE_ONLY + NEW_LINE + KEEP_ALIVE_TIMEOUT_ZERO + NEW_LINE\n@@ -895,32 +105,1 @@\n-    private static final int[] expectedValues = {\n-        5,  100,    5, 100,  5,  5,  5,  0,  5,   0,   0,   5,  100,    0,   100,    5,\n-        20,   20 ,  20,  20, 20, 20, 20, 20, 20,  20 , 20,  20,   20,   20,    20,   20,\n-        60,   60,  200, 200, 60, 60, 60, 60,  0,   0,  60,   0,    0,  200,    60,  200,\n-        60,   60,  200, 200, 60, 60, 60, 60,  0,   0,  60,   0,    0,  200,    60,  200,\n-        120, 120,  120, 120,120,120,120,120,120, 120, 120, 120,  120,  120,   120,  120,\n-        5,  100,    5, 100,  5,  5,  5,  0,  5,   0,   0,   5,  100,    0,   100,    5,\n-        5,  100,    5, 100,  5,  5,  5,  0,  5,   0,   0,   5,  100,    0,   100,    5,\n-        0,    0,    0,   0,  0,  0,  0,  0,  0,   0,   0,   0,    0,    0,     0,    0,\n-        60,  60,  200, 200, 60, 60, 60, 60,  0,   0,  60,   0,    0,  200,    60,  200,\n-        0,    0,    0,   0,  0,  0,  0,  0,  0,   0,   0,   0,    0,    0,     0,    0,\n-    };\n-\n-    private final CountDownLatch countDownLatch = new CountDownLatch(1);\n-\n-    private final CountDownLatch serverCountDownLatch = new CountDownLatch(1);\n-\n-    \/*\n-     * setting of client properties -Dhttp.keepAlive.time.server and -Dhttp.keepAlive.time.proxy is handled through this method.\n-     * There are 16 client scenarios in total starting with scenarioNumber 0(zero) and ending with 15.\n-     * Server Scenarios are grouped into batch of 16 scenarios.\n-     * There are 10 batches in total and each batch contains 16 scenarios so 10 * 16 = 160 scenarios in total.\n-     * 16 Client Scenarios are used repeatedly for every server scenario batch.\n-     * for serverscenario[0],serverscenario[16],serverscenario[32] ... serverscenario[144] is mapped to clientscenario[0]\n-     * for serverscenario[1],serverscenario[17],serverscenario[33] ... serverscenario[145] is mapped to clientscenario[1]\n-     * for serverscenario[2],serverscenario[18],serverscenario[34] ... serverscenario[146] is mapped to clientscenario[2]\n-     * ...\n-     * for serverscenario[15],serverscenario[31],serverscenario[47] ... serverscenario[159] is mapped to clientscenario[15]\n-     *\/\n-    private int getClientScenarioNumber(int scenarioNumber) {\n-        return scenarioNumber % 16 ;\n-    }\n+    private static KeepAliveCache keepAliveCache;\n@@ -928,89 +107,1 @@\n-    \/*\n-     * Returns SERVER_RESPONSE as String based on integer inputParameter scenarioNumber.\n-     * Server Scenarios are grouped into batch of 16 scenarios starting with scenarioNumber 0 (zero)\n-     * so there are 10 batches in total and each batch contains 16 scenarios so 10 * 16 = 160 scenarios in total.\n-     * For each batch of 16 scenarios, there will be common SERVER_RESPONSE for all 16 scenarios in batch.\n-     * for scenario numbers from 0 to 15 server  response is: Connection:keep-alive\n-     * for scenario numbers from 16 to 31 server response is: SERVER_RESPONSE=Connection: keep-alive\\r\\nKeep-alive: timeout=20\n-     * for scenario numbers from 32 to 47 server response is: SERVER_RESPONSE=Proxy-Connection: keep-alive\n-     * for scenario numbers from 48 to 63 server response is: SERVER_RESPONSE=Connection:keep-alive\\r\\nProxy-connection:keep-alive\n-     * for scenario numbers from 64 to 79 server response is: SERVER_RESPONSE=Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120\n-     * for scenario numbers from 80 to 95 server response is: SERVER_RESPONSE=No Input\n-     * for scenario numbers from 96 to 111 server response is: SERVER_RESPONSE=Connection: keep-alive\\r\\nKeep-alive: timeout=-20\n-     * for scenario numbers from 112 to 127 server resonse is: Connection: keep-alive\\r\\nKeep-alive: timeout=0\n-     * for scenario numbers from 128 to 143 server response is: Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=-20\n-     * for scenario numbers from 144 to 159 server response is: Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=0\n-     *\/\n-    private String getServerScenario(int scenarioNumber) {\n-        \/*\n-         *  ServerResponse for scenarios from 0 to 15\n-         *  SERVER_RESPONSE:Connection:keep-alive\n-         *\/\n-        if(scenarioNumber >= 0 && scenarioNumber <= 15) {\n-            return A;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 16 to 31\n-         * SERVER_RESPONSE=Connection: keep-alive\\r\\nKeep-alive: timeout=20\n-         *\/\n-        else if (scenarioNumber >= 16 && scenarioNumber <= 31){\n-            return B;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 32 to 47\n-         * SERVER_RESPONSE=Proxy-Connection: keep-alive\n-         *\/\n-        else if (scenarioNumber >= 32 && scenarioNumber <= 47){\n-            return C;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 48 to 63\n-         * SERVER_RESPONSE=Connection:keep-alive\\r\\nProxy-connection:keep-alive\n-         *\/\n-        else if (scenarioNumber >= 48 && scenarioNumber <= 63){\n-            return D;\n-        \/*\n-         * ServerResponse for scenarios from 64 to 79\n-         * SERVER_RESPONSE=Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=120\n-         *\/\n-        } else if (scenarioNumber >= 64 && scenarioNumber <= 79){\n-            return E;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 80 to 95\n-         * SERVER_RESPONSE=No Input\n-         *\/\n-        else if (scenarioNumber >= 80 && scenarioNumber <= 95){\n-            return NI;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 96 to 111\n-         * SERVER_RESPONSE=Connection: keep-alive\\r\\nKeep-alive: timeout=-20\n-         *\/\n-        else if (scenarioNumber >= 96 && scenarioNumber <= 111){\n-            return F;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 112 to 127\n-         * SERVER_RESPONSE=Connection: keep-alive\\r\\nKeep-alive: timeout=0\n-         *\/\n-        else if (scenarioNumber >= 112 && scenarioNumber <= 127){\n-            return G;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 128 to 143\n-         * SERVER_RESPONSE=Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=-20\n-         *\/\n-        else if (scenarioNumber >= 128 && scenarioNumber <= 143){\n-            return H;\n-        }\n-        \/*\n-         * ServerResponse for scenarios from 144 to 159\n-         * SERVER_RESPONSE=Proxy-connection:keep-alive\\r\\nKeep-alive:timeout=0\n-         *\/\n-        else if (scenarioNumber >= 144 && scenarioNumber <= 159){\n-            return I;\n-        }\n-        \/*Invalid Case*\/\n-        return null;\n-    }\n+    private static Constructor<?> keepAliveKeyClassconstructor;\n@@ -1018,12 +109,3 @@\n-    private void startScenario(int scenarioNumber) throws Exception {\n-        System.out.println(\"serverScenarios[\" + scenarioNumber + \"]=\" + getServerScenario(scenarioNumber));\n-        System.out.println(\"clientScenarios[\" + scenarioNumber + \"]=\" + clientScenarios[getClientScenarioNumber(scenarioNumber)]);\n-        if(expectedValues[scenarioNumber] == 0) {\n-            System.out.println(\"ExpectedOutput=\" + NOT_CACHED);\n-        } else {\n-            System.out.println(\"ExpectedOutput=\" + expectedValues[scenarioNumber]);\n-        }\n-        System.out.println();\n-        startServer(scenarioNumber);\n-        runClient(scenarioNumber);\n-    }\n+    \/\/ variables set by server thread\n+    private volatile int serverPort;\n+    private volatile boolean isProxySet;\n@@ -1031,13 +113,1 @@\n-    private void startServer(int scenarioNumber) {\n-        Thread server = new Thread(new Runnable() {\n-            @Override\n-            public void run() {\n-                try {\n-                   executeServer(scenarioNumber);\n-                } catch (IOException e) {\n-                   e.printStackTrace();\n-                }\n-            }\n-        }, \"SERVER\");\n-        server.start();\n-    }\n+    private static final Phaser serverGate = new Phaser(2);\n@@ -1061,12 +131,5 @@\n-    private void executeServer(int scenarioNumber) throws IOException {\n-        String serverScenarioContent = null;\n-        if (!getServerScenario(scenarioNumber).equalsIgnoreCase(NI)) {\n-            serverScenarioContent = getServerScenario(scenarioNumber) + NEW_LINE;\n-            \/*\n-             * isProxySet should be set before Server is moved to Listen State.\n-             *\/\n-            if (serverScenarioContent.contains(\"Proxy\")) {\n-                isProxySet = true;\n-            } else {\n-                isProxySet = false;\n-            }\n+    private void executeServer(int scenarioNumber) {\n+        String scenarioHeaders = serverHeaders[scenarioNumber];\n+        if (scenarioHeaders != null) {\n+            \/\/ isProxySet should be set before Server is moved to Listen State.\n+            isProxySet = scenarioHeaders.contains(\"Proxy\");\n@@ -1074,45 +137,26 @@\n-        ServerSocket serverSocket = null;\n-        Socket socket = null;\n-        OutputStreamWriter out = null;\n-        InetAddress loopback = InetAddress.getLoopbackAddress();\n-        try {\n-            serverSocket = new ServerSocket();\n-            serverSocket.bind(new InetSocketAddress(loopback, 0));\n-            SERVER_PORT = serverSocket.getLocalPort();\n-            \/\/serverReady = true;\n-            this.serverCountDownLatch.countDown();\n-            System.out\n-                .println(\"SERVER_PORT= \" + SERVER_PORT +\" isProxySet=\" + isProxySet);\n-            \/*\n-             * Server will be waiting for clients to connect.\n-             *\/\n-            socket = serverSocket.accept();\n-            readAll(socket);\n-            out = new OutputStreamWriter(socket.getOutputStream());\n-            String BODY = \"SERVER REPLY: Hello world\";\n-            String CLEN = \"Content-Length: \" + BODY.length() + NEW_LINE;\n-            \/* send the header *\/\n-            out.write(\"HTTP\/1.1 200 OK\\r\\n\");\n-            out.write(\"Content-Type: text\/plain; charset=iso-8859-1\\r\\n\");\n-            \/*\n-             * append each scenario content from array.\n-             *\/\n-            if(serverScenarioContent != null) {\n-                out.write(serverScenarioContent);\n-            }\n-            out.write(CLEN);\n-            out.write(NEW_LINE);\n-            out.write(BODY);\n-            out.flush();\n-        } catch (IOException e) {\n-            e.printStackTrace();\n-        } finally {\n-            if (out != null) {\n-                out.flush();\n-                out.close();\n-            }\n-            if (socket != null) {\n-                socket.close();\n-            }\n-            if (serverSocket != null) {\n-                serverSocket.close();\n+        try (ServerSocket serverSocket = new ServerSocket()) {\n+            serverSocket.bind(new InetSocketAddress(InetAddress.getLoopbackAddress(), 0));\n+            serverPort = serverSocket.getLocalPort();\n+            serverGate.arrive();\n+\n+            \/\/ Server will be waiting for clients to connect.\n+            try (Socket socket = serverSocket.accept()) {\n+                readAll(socket);\n+                try (OutputStreamWriter out = new OutputStreamWriter(socket.getOutputStream())) {\n+                    String BODY = \"SERVER REPLY: Hello world\";\n+                    String CLEN = \"Content-Length: \" + BODY.length() + NEW_LINE;\n+\n+                    \/\/ send common headers\n+                    out.write(\"HTTP\/1.1 200 OK\\r\\n\");\n+                    out.write(\"Content-Type: text\/plain; charset=iso-8859-1\\r\\n\");\n+\n+                    \/\/ set scenario headers\n+                    if (scenarioHeaders != null) {\n+                        out.write(scenarioHeaders);\n+                    }\n+\n+                    \/\/ send content\n+                    out.write(CLEN);\n+                    out.write(NEW_LINE);\n+                    out.write(BODY);\n+                }\n@@ -1120,0 +164,2 @@\n+        } catch (IOException ioe) {\n+            throw new RuntimeException(\"IOException in server thread\", ioe);\n@@ -1123,10 +169,6 @@\n-    private void runClient(int scenarioNumber) throws Exception {\n-        try {\n-            connectToServerURL(scenarioNumber);\n-        } finally {\n-            System.out.println(\"client count down latch:\" + scenarioNumber);\n-            this.countDownLatch.countDown();\n-            System.out.println();\n-            System.out.println();\n-        }\n-    }\n+    private void fetchInfo(int expectedValue, HttpURLConnection httpUrlConnection) throws Exception {\n+        Object expectedKeepAliveKey = keepAliveKeyClassconstructor.newInstance(httpUrlConnection.getURL(), null);\n+        Object clientVectorObjectInMap = keepAliveCache.get(expectedKeepAliveKey);\n+        System.out.println(\"ClientVector for KeepAliveKey:\" + clientVectorObjectInMap);\n+        HttpClient httpClientCached = keepAliveCache.get(httpUrlConnection.getURL(), null);\n+        System.out.println(\"HttpClient in Cache:\" + httpClientCached);\n@@ -1134,22 +176,20 @@\n-    private void connectToServerURL(int scenarioNumber) throws Exception {\n-        \/\/    System.setProperty(\"java.net.useSystemProxies\", \"false\");\n-        \/\/    System.setProperty(\"http.nonProxyHosts\", \"\");\n-        \/\/    System.setProperty(\"http.proxyHost\", \"localhost\");\n-        \/\/    System.setProperty(\"http.proxyPort\", String.valueOf(SERVER_PORT));\n-        System.out.println(\"Following are Existing System Properties if set any\");\n-        System.out.println(\"http.keepAlive.time.server:\" + System.getProperty(\"http.keepAlive.time.server\"));\n-        System.out.println(\"http.keepAlive.time.proxy:\" + System.getProperty(\"http.keepAlive.time.proxy\"));\n-        System.setProperty(\"java.net.useSystemProxies\", \"false\");\n-        System.out.println(\"http.proxyPort:\"+System.getProperty(\"http.proxyPort\"));\n-        System.out.println(\"http.proxyHost:\"+System.getProperty(\"http.proxyHost\"));\n-        System.clearProperty(\"http.keepAlive.time.server\");\n-        System.clearProperty(\"http.keepAlive.time.proxy\");\n-        \/\/ fetch clientScenearios for each scenarioNumber from array and set it to\n-        \/\/ System property.\n-        if (!clientScenarios[getClientScenarioNumber(scenarioNumber)].equalsIgnoreCase(NI)) {\n-            System.out.println(\"Client Input Parsing\");\n-            for (String clientScenarioString : clientScenarios[getClientScenarioNumber(scenarioNumber)].split(CLIENT_SEPARATOR)) {\n-                System.out.println(clientScenarioString);\n-                String key = clientScenarioString.split(\"=\")[0];\n-                String value = clientScenarioString.split(\"=\")[1];\n-                System.setProperty(key, value);\n+        if (httpClientCached != null) {\n+            System.out.println(\"KeepingAlive:\" + httpClientCached.isKeepingAlive());\n+            System.out.println(\"UsingProxy:\" + httpClientCached.getUsingProxy());\n+            System.out.println(\"ProxiedHost:\" + httpClientCached.getProxyHostUsed());\n+            System.out.println(\"ProxiedPort:\" + httpClientCached.getProxyPortUsed());\n+            Class<?> clientVectorClass = Class.forName(\"sun.net.www.http.KeepAliveCache$ClientVector\");\n+            Field napField = clientVectorClass.getDeclaredField(\"nap\");\n+            napField.setAccessible(true);\n+            int napValue = (int) napField.get(clientVectorObjectInMap);\n+            int actualValue = napValue \/ 1000;\n+            if (expectedValue == actualValue) {\n+                System.out.printf(\"Cache time:%d\\n\", actualValue);\n+            } else {\n+                throw new RuntimeException(\"Sleep time of \" + actualValue + \" not expected (\" + expectedValue + \")\");\n+            }\n+        } else {\n+            if (expectedValue == 0) {\n+                System.out.println(\"Connection not cached.\");\n+            } else {\n+                throw new RuntimeException(\"Connection was not cached although expected with sleep time of:\" + expectedValue);\n@@ -1158,0 +198,3 @@\n+    }\n+\n+    private void connectToServerURL(int expectedValue) throws Exception {\n@@ -1159,4 +202,3 @@\n-        this.serverCountDownLatch.await();\n-        System.out.println(\"client started\");\n-        URL url = URIBuilder.newBuilder().scheme(\"http\").loopback().port(SERVER_PORT).toURL();\n-        System.out.println(\"connecting from client to SERVER URL:\" + url);\n+        serverGate.arriveAndAwaitAdvance();\n+        URL url = URIBuilder.newBuilder().scheme(\"http\").loopback().port(serverPort).toURL();\n+        System.out.println(\"connecting to server URL: \" + url + \", isProxySet: \" + isProxySet);\n@@ -1164,3 +206,2 @@\n-        \/*\n-         * isProxySet is set to true when Expected Server Response contains Proxy-Connection header.\n-         *\/\n+\n+        \/\/ isProxySet is set to true when Expected Server Response contains Proxy-Connection header.\n@@ -1168,2 +209,2 @@\n-            httpUrlConnection = (sun.net.www.protocol.http.HttpURLConnection) url\n-                .openConnection(new Proxy(Type.HTTP, new InetSocketAddress(\"localhost\", SERVER_PORT)));\n+            httpUrlConnection = (HttpURLConnection) url\n+                .openConnection(new Proxy(Type.HTTP, new InetSocketAddress(\"localhost\", serverPort)));\n@@ -1171,1 +212,1 @@\n-            httpUrlConnection = (sun.net.www.protocol.http.HttpURLConnection) url.openConnection();\n+            httpUrlConnection = (HttpURLConnection) url.openConnection();\n@@ -1173,4 +214,3 @@\n-        InputStreamReader inputStreamReader = new InputStreamReader(httpUrlConnection.getInputStream());\n-        BufferedReader bufferedReader = null;\n-        try {\n-            bufferedReader = new BufferedReader(inputStreamReader);\n+\n+        try (InputStreamReader inputStreamReader = new InputStreamReader(httpUrlConnection.getInputStream());\n+             BufferedReader bufferedReader = new BufferedReader(inputStreamReader)) {\n@@ -1178,2 +218,2 @@\n-                String eachLine = bufferedReader.readLine();\n-                if (eachLine == null) {\n+                String line = bufferedReader.readLine();\n+                if (line == null) {\n@@ -1182,5 +222,1 @@\n-                System.out.println(eachLine);\n-            }\n-        } finally {\n-            if (bufferedReader != null) {\n-                bufferedReader.close();\n+                System.out.println(line);\n@@ -1189,4 +225,0 @@\n-        \/\/    System.out.println(\"ResponseCode:\" + httpUrlConnection.getResponseCode());\n-        \/\/    System.out.println(\"ResponseMessage:\" + httpUrlConnection.getResponseMessage());\n-        \/\/    System.out.println(\"Content:\" + httpUrlConnection.getContent());\n-        \/\/    Thread.sleep(2000);\n@@ -1196,1 +228,1 @@\n-        fetchInfo(scenarioNumber, httpUrlConnection);\n+        fetchInfo(expectedValue, httpUrlConnection);\n@@ -1199,46 +231,17 @@\n-    private void fetchInfo(int scenarioNumber, sun.net.www.protocol.http.HttpURLConnection httpUrlConnection)\n-        throws Exception {\n-       Field field = Class.forName(\"sun.net.www.protocol.http.HttpURLConnection\").getDeclaredField(\"http\");\n-       field.setAccessible(true);\n-       HttpClient httpClient = (HttpClient) field.get(httpUrlConnection);\n-       \/\/    System.out.println(\"httpclient=\" + httpClient);\n-       Field keepAliveField = Class.forName(\"sun.net.www.http.HttpClient\").getDeclaredField(\"kac\");\n-       keepAliveField.setAccessible(true);\n-       KeepAliveCache keepAliveCache = (KeepAliveCache) keepAliveField.get(httpClient);\n-       System.out.println(\"keepAliveCache\" + keepAliveCache);\n-       System.out.println(\"SERVER URL:\" + httpUrlConnection.getURL());\n-       \/*\n-        * create KeepAliveKey(URL,Object) object and compare created KeepAliveKey and\n-        * existing using equals() method: KeepAliveKey.equals()\n-        *\/\n-       Class keepAliveKeyClass = Class.forName(\"sun.net.www.http.KeepAliveKey\");\n-       \/\/    System.out.println(\"keepAliveKeyClass=\" + keepAliveKeyClass);\n-       Constructor keepAliveKeyClassconstructor = keepAliveKeyClass.getDeclaredConstructors()[0];\n-       keepAliveKeyClassconstructor.setAccessible(true);\n-       Object expectedKeepAliveKey = keepAliveKeyClassconstructor.newInstance(httpUrlConnection.getURL(), null);\n-       System.out.println(\"ExpectedKeepAliveKey=\" + expectedKeepAliveKey);\n-       Object clientVectorObjectInMap = keepAliveCache.get(expectedKeepAliveKey);\n-       System.out.println(\"ClientVector=\" + clientVectorObjectInMap);\n-       HttpClient httpClientCached = keepAliveCache.get(httpUrlConnection.getURL(), null);\n-       System.out.println(\"HttpClient in Cache:\" + httpClientCached);\n-       if(httpClientCached != null) {\n-            System.out.println(\"KeepingAlive:\" + httpClientCached.isKeepingAlive());\n-            System.out.println(\"UsingProxy:\" + httpClientCached.getUsingProxy());\n-            System.out.println(\"ProxiedHost:\" + httpClientCached.getProxyHostUsed());\n-            System.out.println(\"ProxiedPort:\" + httpClientCached.getProxyPortUsed());\n-            System.out.println(\"ProxyPortUsingSystemProperty:\" + System.getProperty(\"http.proxyPort\"));\n-            System.out.println(\"ProxyHostUsingSystemProperty:\" + System.getProperty(\"http.proxyHost\"));\n-            System.out.println(\"http.keepAlive.time.server=\" + System.getProperty(\"http.keepAlive.time.server\"));\n-            System.out.println(\"http.keepAlive.time.proxy=\" + System.getProperty(\"http.keepAlive.time.proxy\"));\n-            Class clientVectorClass = Class.forName(\"sun.net.www.http.ClientVector\");\n-            \/\/      System.out.println(\"clientVectorClass=\" + clientVectorClass);\n-            Field napField = clientVectorClass.getDeclaredField(\"nap\");\n-            napField.setAccessible(true);\n-            int napValue = (int) napField.get(clientVectorObjectInMap);\n-            int actualValue = napValue \/ 1000;\n-            \/\/      System.out.println(\"nap=\" + napValue \/ 1000);\n-            System.out.printf(\"ExpectedOutput:%d ActualOutput:%d \", expectedValues[scenarioNumber], actualValue);\n-            System.out.println();\n-            if (expectedValues[scenarioNumber] != actualValue) {\n-                throw new RuntimeException(\n-                            \"ExpectedOutput:\" + expectedValues[scenarioNumber] + \" ActualOutput: \" + actualValue);\n+    private int getExpectedCachingValue(int serverScenario) {\n+        if (serverScenario == 2) {\n+            \/\/ Connection: keep-alive && Keep-alive: timeout=20\n+            \/\/\n+            \/\/ server side keep-alive timeout is what counts here\n+            return 20;\n+        } else if (serverScenario == 3 || serverScenario == 4 || serverScenario == 8) {\n+            \/\/ Proxy-Connection: keep-alive\n+            \/\/ Connection:keep-alive && Proxy-connection:keep-alive\n+            \/\/ Proxy-Connection:keep-alive && Keep-alive:timeout=-20\n+            \/\/\n+            \/\/ Proxy-connection:keep-alive is set, timeout could be invalid -> value of http.keepAlive.time.proxy or default of 60\n+            int httpKeepAliveTimeProxy;\n+            try {\n+                httpKeepAliveTimeProxy = Integer.valueOf(System.getProperty(\"http.keepAlive.time.proxy\"));\n+            } catch (NumberFormatException e) {\n+                httpKeepAliveTimeProxy = -1;\n@@ -1246,0 +249,12 @@\n+            return httpKeepAliveTimeProxy < 0 ? 60 : httpKeepAliveTimeProxy;\n+        } else if (serverScenario == 5) {\n+            \/\/ Proxy-connection:keep-alive && Keep-alive:timeout=120\n+            \/\/\n+            \/\/ server side keep-alive timeout is what counts here\n+            return 120;\n+        } else if (serverScenario == 7 || serverScenario == 9) {\n+            \/\/ Connection: keep-alive && Keep-alive: timeout=0\n+            \/\/ Proxy-Connection:keep-alive && Keep-alive:timeout=0\n+            \/\/\n+            \/\/ no caching\n+            return 0;\n@@ -1247,6 +262,10 @@\n-            \/\/executed when value is not cached.\n-            String expected = expectedValues[scenarioNumber] == 0 ? NOT_CACHED\n-                    : String.valueOf(expectedValues[scenarioNumber]);\n-            System.out.println(\"ExpectedOutput:\" + expected + \" ActualOutput:\" + NOT_CACHED);\n-            if (!expected.equalsIgnoreCase(NOT_CACHED)) {\n-                    throw new RuntimeException(\"ExpectedOutput:\" + expected + \" ActualOutput:\" + NOT_CACHED);\n+            \/\/ No server parameters\n+            \/\/ Connection: keep-alive\n+            \/\/ Connection: keep-alive && Keep-alive: timeout=-20\n+            \/\/\n+            \/\/ Nothing or Connection:keep-alive is set, timeout could be invalid -> value of http.keepAlive.time.server or default of 5\n+            int httpKeepAliveTimeServer;\n+            try {\n+                httpKeepAliveTimeServer = Integer.valueOf(System.getProperty(\"http.keepAlive.time.server\"));\n+            } catch (NumberFormatException e) {\n+                httpKeepAliveTimeServer = -1;\n@@ -1254,1 +273,2 @@\n-       }\n+            return httpKeepAliveTimeServer < 0 ? 5 : httpKeepAliveTimeServer;\n+        }\n@@ -1257,3 +277,7 @@\n-    public static void main(String[] args) throws Exception {\n-        if (args.length != 1) {\n-            throw new IllegalArgumentException(\"Usage:java KeepAliveTest.java <scenarioNumber>\");\n+    private void runScenario(int scenarioNumber) throws Exception {\n+        int expectedValue = getExpectedCachingValue(scenarioNumber);\n+        System.out.println(\"Expecting Cache Time of \" + expectedValue + \" for server headers:\");\n+        if (serverHeaders[scenarioNumber] == null) {\n+            System.out.println();\n+        } else {\n+            System.out.print(serverHeaders[scenarioNumber]);\n@@ -1261,0 +285,18 @@\n+        Thread server = Thread.ofPlatform().start(() -> executeServer(scenarioNumber));\n+        connectToServerURL(expectedValue);\n+        server.join();\n+        System.out.println();\n+    }\n+\n+    private static void initialize() throws Exception {\n+        System.clearProperty(\"http.proxyPort\");\n+        System.clearProperty(\"http.proxyHost\");\n+        System.setProperty(\"java.net.useSystemProxies\", \"false\");\n+\n+        Field keepAliveField = sun.net.www.http.HttpClient.class.getDeclaredField(\"kac\");\n+        keepAliveField.setAccessible(true);\n+        keepAliveCache = (KeepAliveCache) keepAliveField.get(null);\n+        System.out.println(\"KeepAliveCache: \" + keepAliveCache);\n+        keepAliveKeyClassconstructor = Class.forName(\"sun.net.www.http.KeepAliveKey\").getDeclaredConstructors()[0];\n+        keepAliveKeyClassconstructor.setAccessible(true);\n+\n@@ -1265,3 +307,26 @@\n-        KeepAliveTest keepAliveTest = new KeepAliveTest();\n-        if (args.length != 0) {\n-            keepAliveTest.startScenario(Integer.valueOf(args[0]));\n+\n+        System.out.println(\"Client properties: http.keepAlive.time.server=\" + System.getProperty(\"http.keepAlive.time.server\") +\n+                \", http.keepAlive.time.proxy=\" + System.getProperty(\"http.keepAlive.time.proxy\"));\n+    }\n+\n+    public static void main(String[] args) throws Exception {\n+        if (args.length > 1) {\n+            throw new IllegalArgumentException(\"Usage:java KeepAliveTest.java <scenarioNumber>\");\n+        } else if (args.length == 1) {\n+            \/\/ an individual test scenario\n+            try {\n+                int scenarioNumber = Integer.valueOf(args[0]);\n+                if (scenarioNumber < 0 || scenarioNumber > 9) {\n+                    throw new IllegalArgumentException(\"Scenario \" + scenarioNumber + \" does not exist\");\n+                }\n+                initialize();\n+                new KeepAliveTest().runScenario(scenarioNumber);\n+            } catch (NumberFormatException e) {\n+                throw new IllegalArgumentException(\"Scenario must be a number, got \" + args[0]);\n+            }\n+        } else {\n+            \/\/ all server scenarios\n+            initialize();\n+            for (int i = 0; i < 10; i++) {\n+                new KeepAliveTest().runScenario(i);\n+            }\n@@ -1269,2 +334,0 @@\n-        \/\/ make main thread wait until server and client is completed.\n-        keepAliveTest.countDownLatch.await();\n","filename":"test\/jdk\/sun\/net\/www\/http\/HttpClient\/KeepAliveTest.java","additions":218,"deletions":1155,"binary":false,"changes":1373,"status":"modified"}]}