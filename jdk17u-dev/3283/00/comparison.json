{"files":[{"patch":"@@ -671,10 +671,2 @@\n-        InputStream iis = new InflaterInputStream(bais);\n-        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n-\n-        int c;\n-        try {\n-            while ((c = iis.read()) != -1) {\n-                baos.write(c);\n-            }\n-        } finally {\n-            iis.close();\n+        try (InputStream iis = new InflaterInputStream(bais)) {\n+            return iis.readAllBytes();\n@@ -682,1 +674,0 @@\n-        return baos.toByteArray();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/imageio\/plugins\/png\/PNGImageReader.java","additions":2,"deletions":11,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -586,3 +586,0 @@\n-                    Reader reader = new InputStreamReader(url.openStream(),\n-                                                          ISO_8859_1);\n-                    char[] buf = new char[1024];\n@@ -590,3 +587,8 @@\n-                    int n;\n-                    while ((n = reader.read(buf)) >= 0) {\n-                        sb.append(buf, 0, n);\n+                    try (InputStream in = url.openStream();\n+                         Reader reader = new InputStreamReader(in, ISO_8859_1))\n+                    {\n+                        char[] buf = new char[1024];\n+                        int n;\n+                        while ((n = reader.read(buf)) >= 0) {\n+                            sb.append(buf, 0, n);\n+                        }\n@@ -594,1 +596,0 @@\n-                    reader.close();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/java\/swing\/plaf\/gtk\/Metacity.java","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -51,2 +51,1 @@\n-        try {\n-            AudioInputStream ais = AudioSystem.getAudioInputStream(url);\n+        try (AudioInputStream ais = AudioSystem.getAudioInputStream(url)) {\n@@ -54,1 +53,0 @@\n-            ais.close();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/AudioFileSoundbankReader.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -194,2 +194,1 @@\n-        InputStream is = url.openStream();\n-        try {\n+        try (InputStream is = url.openStream()) {\n@@ -197,2 +196,0 @@\n-        } finally {\n-            is.close();\n@@ -205,2 +202,1 @@\n-        InputStream is = new FileInputStream(file);\n-        try {\n+        try (InputStream is = new FileInputStream(file)) {\n@@ -208,2 +204,0 @@\n-        } finally {\n-            is.close();\n@@ -878,1 +872,3 @@\n-        writeSoundbank(new RIFFWriter(name, \"DLS \"));\n+        try (RIFFWriter writer = new RIFFWriter(name, \"DLS \")) {\n+            writeSoundbank(writer);\n+        }\n@@ -882,1 +878,3 @@\n-        writeSoundbank(new RIFFWriter(file, \"DLS \"));\n+        try (RIFFWriter writer = new RIFFWriter(file, \"DLS \")) {\n+            writeSoundbank(writer);\n+        }\n@@ -886,1 +884,3 @@\n-        writeSoundbank(new RIFFWriter(out, \"DLS \"));\n+        try (RIFFWriter writer = new RIFFWriter(out, \"DLS \")) {\n+            writeSoundbank(writer);\n+        }\n@@ -926,2 +926,0 @@\n-\n-        writer.close();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/DLSSoundbank.java","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -66,2 +66,1 @@\n-            InputStream stream = url.openStream();\n-            try {\n+            try (InputStream stream = url.openStream()) {\n@@ -76,2 +75,0 @@\n-            } finally {\n-                stream.close();\n@@ -98,2 +95,1 @@\n-        try\n-        {\n+        try (stream) {\n@@ -117,4 +113,0 @@\n-        finally\n-        {\n-            stream.close();\n-        }\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/JARSoundbankReader.java","additions":2,"deletions":10,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -318,5 +318,7 @@\n-        DataInputStream is = new DataInputStream(getInputStream());\n-        buffer = new byte[(int) capacity()];\n-        offset = 0;\n-        is.readFully(buffer);\n-        is.close();\n+        try (InputStream is = getInputStream();\n+             DataInputStream dis = new DataInputStream(is))\n+        {\n+            buffer = new byte[(int) capacity()];\n+            offset = 0;\n+            dis.readFully(buffer);\n+        }\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/ModelByteBuffer.java","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -185,1 +185,0 @@\n-            InputStream is = buffer.getInputStream();\n@@ -187,1 +186,1 @@\n-            try {\n+            try (InputStream is = buffer.getInputStream()) {\n@@ -192,5 +191,0 @@\n-            try {\n-                is.close();\n-            } catch (IOException e) {\n-                \/\/e.printStackTrace();\n-            }\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/ModelByteBufferWavetable.java","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -95,3 +95,1 @@\n-\n-        InputStream is = url.openStream();\n-        try {\n+        try (InputStream is = url.openStream()) {\n@@ -99,2 +97,0 @@\n-        } finally {\n-            is.close();\n@@ -107,2 +103,1 @@\n-        InputStream is = new FileInputStream(file);\n-        try {\n+        try (InputStream is = new FileInputStream(file)) {\n@@ -110,2 +105,0 @@\n-        } finally {\n-            is.close();\n@@ -520,1 +513,3 @@\n-        writeSoundbank(new RIFFWriter(name, \"sfbk\"));\n+        try (RIFFWriter writer = new RIFFWriter(name, \"sfbk\")) {\n+            writeSoundbank(writer);\n+        }\n@@ -524,1 +519,3 @@\n-        writeSoundbank(new RIFFWriter(file, \"sfbk\"));\n+        try (RIFFWriter writer = new RIFFWriter(file, \"sfbk\")) {\n+            writeSoundbank(writer);\n+        }\n@@ -528,1 +525,3 @@\n-        writeSoundbank(new RIFFWriter(out, \"sfbk\"));\n+        try (RIFFWriter writer = new RIFFWriter(out, \"sfbk\")) {\n+            writeSoundbank(writer);\n+        }\n@@ -535,1 +534,0 @@\n-        writer.close();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/SF2Soundbank.java","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -758,1 +758,1 @@\n-                    try {\n+                    try (is) {\n@@ -760,2 +760,0 @@\n-                    } finally {\n-                        is.close();\n@@ -805,1 +803,1 @@\n-                    try {\n+                    try (out) {\n@@ -807,1 +805,0 @@\n-                        out.close();\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/SoftSynthesizer.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -149,7 +149,5 @@\n-        InputStream urlStream = url.openStream(); \/\/ throws IOException\n-        BufferedInputStream bis = new BufferedInputStream( urlStream, bisBufferSize );\n-        MidiFileFormat fileFormat = null;\n-        try {\n-            fileFormat = getMidiFileFormat( bis ); \/\/ throws InvalidMidiDataException\n-        } finally {\n-            bis.close();\n+        try (InputStream urlStream = url.openStream(); \/\/ throws IOException\n+             BufferedInputStream bis = new BufferedInputStream(urlStream, bisBufferSize))\n+        {\n+            MidiFileFormat fileFormat = getMidiFileFormat(bis); \/\/ throws InvalidMidiDataException\n+            return fileFormat;\n@@ -157,1 +155,0 @@\n-        return fileFormat;\n@@ -162,13 +159,10 @@\n-        FileInputStream fis = new FileInputStream(file); \/\/ throws IOException\n-        BufferedInputStream bis = new BufferedInputStream(fis, bisBufferSize);\n-\n-        \/\/ $$fb 2002-04-17: part of fix for 4635286: MidiSystem.getMidiFileFormat() returns format having invalid length\n-        long length = file.length();\n-        if (length > Integer.MAX_VALUE) {\n-            length = MidiFileFormat.UNKNOWN_LENGTH;\n-        }\n-        MidiFileFormat fileFormat = null;\n-        try {\n-            fileFormat = getMidiFileFormatFromStream(bis, (int) length, null);\n-        } finally {\n-            bis.close();\n+        try (FileInputStream fis = new FileInputStream(file); \/\/ throws IOException\n+             BufferedInputStream bis = new BufferedInputStream(fis, bisBufferSize))\n+        {\n+            \/\/ $$fb 2002-04-17: part of fix for 4635286: MidiSystem.getMidiFileFormat() returns format having invalid length\n+            long length = file.length();\n+            if (length > Integer.MAX_VALUE) {\n+                length = MidiFileFormat.UNKNOWN_LENGTH;\n+            }\n+            MidiFileFormat fileFormat = getMidiFileFormatFromStream(bis, (int) length, null);\n+            return fileFormat;\n@@ -176,1 +170,0 @@\n-        return fileFormat;\n@@ -207,7 +200,5 @@\n-        InputStream is = url.openStream();  \/\/ throws IOException\n-        is = new BufferedInputStream(is, bisBufferSize);\n-        Sequence seq = null;\n-        try {\n-            seq = getSequence(is);\n-        } finally {\n-            is.close();\n+        try (InputStream is = url.openStream(); \/\/ throws IOException\n+             BufferedInputStream bis = new BufferedInputStream(is, bisBufferSize))\n+        {\n+            Sequence seq = getSequence(bis);\n+            return seq;\n@@ -215,1 +206,0 @@\n-        return seq;\n@@ -220,7 +210,5 @@\n-        InputStream is = new FileInputStream(file); \/\/ throws IOException\n-        is = new BufferedInputStream(is, bisBufferSize);\n-        Sequence seq = null;\n-        try {\n-            seq = getSequence(is);\n-        } finally {\n-            is.close();\n+        try (InputStream is = new FileInputStream(file); \/\/ throws IOException\n+             BufferedInputStream bis = new BufferedInputStream(is, bisBufferSize))\n+        {\n+            Sequence seq = getSequence(bis);\n+            return seq;\n@@ -228,1 +216,0 @@\n-        return seq;\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/StandardMidiFileReader.java","additions":26,"deletions":39,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -132,4 +132,4 @@\n-        FileOutputStream fos = new FileOutputStream(out); \/\/ throws IOException\n-        int bytesWritten = write( in, type, fos );\n-        fos.close();\n-        return bytesWritten;\n+        try (FileOutputStream fos = new FileOutputStream(out)) { \/\/ throws IOException\n+            int bytesWritten = write(in, type, fos);\n+            return bytesWritten;\n+        }\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/StandardMidiFileWriter.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1134,1 +1134,1 @@\n-                try {\n+                try (outStream) { \/* don't close the input stream *\/\n@@ -1155,3 +1155,0 @@\n-                    \/* don't close the input stream *\/\n-                } finally {\n-                    outStream.close();\n","filename":"src\/java.desktop\/share\/classes\/java\/awt\/Font.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -416,6 +416,4 @@\n-                    FileInputStream in =\n-                        new FileInputStream(propsFile);\n-\n-                    \/\/ Inputstream has been buffered in Properties class\n-                    properties.load(in);\n-                    in.close();\n+                    try (FileInputStream in = new FileInputStream(propsFile)) {\n+                        \/\/ Inputstream has been buffered in Properties class\n+                        properties.load(in);\n+                    }\n@@ -434,6 +432,4 @@\n-                        FileInputStream in =\n-                            new FileInputStream(propsFile);\n-\n-                        \/\/ Inputstream has been buffered in Properties class\n-                        properties.load(in);\n-                        in.close();\n+                        try (FileInputStream in = new FileInputStream(propsFile)) {\n+                            \/\/ Inputstream has been buffered in Properties class\n+                            properties.load(in);\n+                        }\n","filename":"src\/java.desktop\/share\/classes\/java\/awt\/Toolkit.java","additions":8,"deletions":12,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -204,1 +204,1 @@\n-            try {\n+            try (ins) {\n@@ -214,1 +214,0 @@\n-                ins.close();\n@@ -218,3 +217,0 @@\n-            } catch (ClassNotFoundException ex) {\n-                ins.close();\n-                throw ex;\n","filename":"src\/java.desktop\/share\/classes\/java\/beans\/Beans.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-import java.util.NoSuchElementException;\n-import java.util.Set;\n@@ -1405,1 +1403,1 @@\n-        InputStream istream = null;\n+        InputStream istream;\n@@ -1421,1 +1419,1 @@\n-        try {\n+        try (istream) {\n@@ -1426,2 +1424,0 @@\n-        } finally {\n-            istream.close();\n@@ -1469,1 +1465,1 @@\n-        try {\n+        try (stream) {\n@@ -1475,1 +1471,0 @@\n-            stream.close();\n@@ -1557,1 +1552,1 @@\n-        try {\n+        try (stream) {\n@@ -1559,2 +1554,0 @@\n-        } finally {\n-            stream.close();\n@@ -1597,1 +1590,1 @@\n-        try {\n+        try (stream) {\n@@ -1599,2 +1592,0 @@\n-        } finally {\n-            stream.close();\n","filename":"src\/java.desktop\/share\/classes\/javax\/imageio\/ImageIO.java","additions":5,"deletions":14,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+import java.io.OutputStream;\n@@ -857,10 +858,6 @@\n-        DataOutputStream os = null;\n-        try {\n-            conn.setRequestProperty(\"Content-Type\",\n-                    \"application\/x-www-form-urlencoded\");\n-            os = new DataOutputStream(conn.getOutputStream());\n-            os.writeBytes((String) postData);\n-        } finally {\n-            if (os != null) {\n-                os.close();\n-            }\n+        conn.setRequestProperty(\"Content-Type\",\n+                \"application\/x-www-form-urlencoded\");\n+        try (OutputStream os = conn.getOutputStream();\n+             DataOutputStream dos = new DataOutputStream(os))\n+        {\n+            dos.writeBytes((String)postData);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/JEditorPane.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -60,1 +60,0 @@\n-import java.lang.reflect.Method;\n@@ -1304,3 +1303,3 @@\n-                            FileInputStream ins = new FileInputStream(file);\n-                            props.load(ins);\n-                            ins.close();\n+                            try (FileInputStream ins = new FileInputStream(file)) {\n+                                props.load(ins);\n+                            }\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/UIManager.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -459,4 +459,4 @@\n-            try {\n-                InputStream is = HTMLEditorKit.getResourceAsStream(DEFAULT_CSS);\n-                Reader r = new BufferedReader(\n-                        new InputStreamReader(is, ISO_8859_1));\n+            try (InputStream is = HTMLEditorKit.getResourceAsStream(DEFAULT_CSS);\n+                 InputStreamReader isr = new InputStreamReader(is, ISO_8859_1);\n+                 Reader r = new BufferedReader(isr))\n+            {\n@@ -464,1 +464,0 @@\n-                r.close();\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/text\/html\/HTMLEditorKit.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -517,5 +517,4 @@\n-        try {\n-            InputStream is;\n-\n-            is = url.openStream();\n-            Reader r = new BufferedReader(new InputStreamReader(is));\n+        try (InputStream is = url.openStream();\n+             InputStreamReader isr = new InputStreamReader(is);\n+             Reader r = new BufferedReader(isr))\n+        {\n@@ -524,2 +523,0 @@\n-            r.close();\n-            is.close();\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/text\/html\/StyleSheet.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -176,3 +176,3 @@\n-            FileInputStream     fin = new FileInputStream(propFile);\n-            props.load(fin);\n-            fin.close();\n+            try (FileInputStream fin = new FileInputStream(propFile)) {\n+                props.load(fin);\n+            }\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/DebugSettings.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-import sun.font.FontManagerFactory;\n@@ -207,2 +206,1 @@\n-            try {\n-                FileInputStream in = new FileInputStream(f.getPath());\n+            try (FileInputStream in = new FileInputStream(f.getPath())) {\n@@ -214,1 +212,0 @@\n-                in.close();\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/FontConfiguration.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -396,2 +396,0 @@\n-                InputStream in =\n-                    new BufferedInputStream(new FileInputStream(f.getPath()));\n@@ -399,2 +397,5 @@\n-                props.load(in);\n-                in.close();\n+                try (FileInputStream is = new FileInputStream(f.getPath());\n+                     BufferedInputStream bis = new BufferedInputStream(is))\n+                {\n+                    props.load(bis);\n+                }\n","filename":"src\/java.desktop\/share\/classes\/sun\/print\/PSPrinterJob.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -323,1 +323,3 @@\n-                    props.load(new FileInputStream(f));\n+                    try (FileInputStream fis = new FileInputStream(f)) {\n+                        props.load(fis);\n+                    }\n@@ -420,4 +422,3 @@\n-            FileOutputStream fos = new FileOutputStream(tempFile);\n-            props.store(fos,\n-                      \"JDK Font Configuration Generated File: *Do Not Edit*\");\n-            fos.close();\n+            try (FileOutputStream fos = new FileOutputStream(tempFile)) {\n+                props.store(fos, \"JDK Font Configuration Generated File: *Do Not Edit*\");\n+            }\n","filename":"src\/java.desktop\/unix\/classes\/sun\/font\/FcFontConfiguration.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-import sun.font.FontUtilities;\n-import sun.font.SunFontManager;\n@@ -112,1 +110,3 @@\n-                    props.load(new FileInputStream(f));\n+                    try (FileInputStream fis = new FileInputStream(f)) {\n+                        props.load(fis);\n+                    }\n","filename":"src\/java.desktop\/unix\/classes\/sun\/font\/MFontConfiguration.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}