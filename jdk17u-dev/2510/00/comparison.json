{"files":[{"patch":"@@ -311,0 +311,1 @@\n+  \/\/ ...and clear or zap just allocated TLAB, if needed.\n@@ -312,1 +313,0 @@\n-    \/\/ ..and clear it.\n@@ -314,3 +314,1 @@\n-  } else {\n-    \/\/ ...and zap just allocated object.\n-#ifdef ASSERT\n+  } else if (ZapTLAB) {\n@@ -322,1 +320,0 @@\n-#endif \/\/ ASSERT\n","filename":"src\/hotspot\/share\/gc\/shared\/memAllocator.cpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -42,8 +42,2 @@\n-    \/\/ successful thread-local allocation\n-#ifdef ASSERT\n-    \/\/ Skip mangling the space corresponding to the object header to\n-    \/\/ ensure that the returned space is not considered parsable by\n-    \/\/ any concurrent GC thread.\n-    size_t hdr_size = oopDesc::header_size();\n-    Copy::fill_to_words(obj + hdr_size, size - hdr_size, badHeapWordVal);\n-#endif \/\/ ASSERT\n+    \/\/ Successful thread-local allocation.\n+\n","filename":"src\/hotspot\/share\/gc\/shared\/threadLocalAllocBuffer.inline.hpp","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -781,0 +781,1 @@\n+  \/\/ ...and clear or zap just allocated TLAB, if needed.\n@@ -782,1 +783,0 @@\n-    \/\/ ..and clear it.\n@@ -784,3 +784,1 @@\n-  } else {\n-    \/\/ ...and zap just allocated object.\n-#ifdef ASSERT\n+  } else if (ZapTLAB) {\n@@ -792,1 +790,0 @@\n-#endif \/\/ ASSERT\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1945,5 +1945,3 @@\n-              \/\/ Initialize object field block:\n-              \/\/   - if TLAB is pre-zeroed, we can skip this path\n-              \/\/   - in debug mode, ThreadLocalAllocBuffer::allocate mangles\n-              \/\/     this area, and we still need to initialize it\n-              if (DEBUG_ONLY(true ||) !ZeroTLAB) {\n+              \/\/ Initialize object field block.\n+              if (!ZeroTLAB) {\n+                \/\/ The TLAB was not pre-zeroed, we need to clear the memory here.\n","filename":"src\/hotspot\/share\/interpreter\/zero\/bytecodeInterpreter.cpp","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -480,0 +480,3 @@\n+  develop(bool, ZapTLAB, trueInDebug,                                       \\\n+          \"Zap allocated TLABs\")                                            \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}