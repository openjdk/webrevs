{"files":[{"patch":"@@ -851,1 +851,1 @@\n-\n+java\/awt\/Focus\/MinimizeNonfocusableWindowTest.java 8024487 windows-all\n","filename":"test\/jdk\/ProblemList.txt","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -0,0 +1,76 @@\n+\/*\n+ * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 6399659\n+ * @summary   When minimizing non-focusable window focus shouldn't jump out of the focused window.\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual MinimizeNonfocusableWindowTest\n+*\/\n+\n+import java.awt.Frame;\n+import java.awt.Window;\n+import java.util.List;\n+\n+public class MinimizeNonfocusableWindowTest {\n+\n+    private static final String INSTRUCTIONS = \"\"\"\n+\n+             You should see three frames: Frame-1, Frame-2 and Unfocusable.\n+\n+             1. Click Frame-1 to make it focused window, then click Frame-2.\n+                Minimize Unfocusable frame with the mouse. If Frame-2 is still\n+                the focused window continue testing, otherwise press FAIL.\n+\n+             2. Restore Unfocusable frame to normal state. Try to resize by dragging\n+                its edge with left mouse button. It should be resizable. If not press\n+                FAIL. Try the same with right mouse button. It shouldn't resize.\n+                If it does, press FAIL, otherwise press PASS.\"\"\";\n+\n+    public static void main(String[] args) throws Exception {\n+        PassFailJFrame.builder()\n+                .title(\"MinimizeNonfocusableWindowTest Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .rows((int) INSTRUCTIONS.lines().count() + 1)\n+                .columns(40)\n+                .testUI(MinimizeNonfocusableWindowTest::createTestUI)\n+                .build()\n+                .awaitAndCheck();\n+    }\n+\n+    private static List<Window> createTestUI() {\n+        Frame frame1 = new Frame(\"Frame-1\");\n+        Frame frame2 = new Frame(\"Frame-2\");\n+        Frame frame3 = new Frame(\"Unfocusable\");\n+        frame1.setBounds(100, 0, 200, 100);\n+        frame2.setBounds(100, 150, 200, 100);\n+        frame3.setBounds(100, 300, 200, 100);\n+\n+        frame3.setFocusableWindowState(false);\n+\n+        return List.of(frame1, frame2, frame3);\n+    }\n+}\n+\n","filename":"test\/jdk\/java\/awt\/Focus\/MinimizeNonfocusableWindowTest.java","additions":76,"deletions":0,"binary":false,"changes":76,"status":"added"},{"patch":"@@ -0,0 +1,98 @@\n+\/*\n+ * Copyright (c) 1999, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 4257071 4228379\n+ * @summary Ensures that focus lost is delivered to a lightweight component\n+            in a disposed window\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual WindowDisposeFocusTest\n+*\/\n+\n+import java.awt.Window;\n+import java.awt.event.WindowAdapter;\n+import java.awt.event.WindowEvent;\n+import javax.swing.JButton;\n+import javax.swing.JDialog;\n+import javax.swing.JFrame;\n+import javax.swing.JPanel;\n+\n+public class WindowDisposeFocusTest {\n+\n+    private static final String INSTRUCTIONS = \"\"\"\n+         Click on \"Second\"\n+         Click on close box\n+         When dialog pops up, \"Second\" should no longer have focus.\"\"\";\n+\n+    public static void main(String[] args) throws Exception {\n+        PassFailJFrame.builder()\n+                .title(\"WindowDisposeFocusTest Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .rows((int) INSTRUCTIONS.lines().count() + 2)\n+                .columns(35)\n+                .testUI(WindowDisposeFocusTest::createTestUI)\n+                .build()\n+                .awaitAndCheck();\n+    }\n+\n+    private static Window createTestUI() {\n+        return JFCFocusBug2.test(new String[]{});\n+    }\n+}\n+\n+class JFCFocusBug2 extends JPanel {\n+\n+    static public Window test(String[] args) {\n+        final JFrame frame = new JFrame(\"WindowDisposeFrame\");\n+        frame.setSize(100, 100);\n+        frame.setVisible(true);\n+\n+        final JFCFocusBug2 bug = new JFCFocusBug2();\n+        final JDialog dialog = new JDialog(frame, false);\n+        dialog.addWindowListener(new WindowAdapter() {\n+            public void windowClosing(WindowEvent e) {\n+                dialog.dispose();\n+                JDialog dialog2 = new JDialog(frame, false);\n+                dialog2.setContentPane(bug);\n+                dialog2.pack();\n+                dialog2.setVisible(true);\n+            }\n+        });\n+        dialog.setContentPane(bug);\n+        dialog.pack();\n+        dialog.setVisible(true);\n+        return frame;\n+    }\n+\n+    public JFCFocusBug2() {\n+        _first = new JButton(\"First\");\n+        _second = new JButton(\"Second\");\n+        add(_first);\n+        add(_second);\n+    }\n+\n+    private JButton _first;\n+    private JButton _second;\n+}\n","filename":"test\/jdk\/java\/awt\/Focus\/WindowDisposeFocusTest.java","additions":98,"deletions":0,"binary":false,"changes":98,"status":"added"},{"patch":"@@ -0,0 +1,91 @@\n+\/*\n+ * Copyright (c) 2006, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 6435715\n+ * @summary JButton stops receiving the focusGained event and eventually focus is lost altogether\n+ * @modules java.desktop\/sun.awt\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual bug6435715\n+ *\/\n+\n+import java.awt.event.FocusAdapter;\n+import java.awt.event.FocusEvent;\n+import javax.swing.JButton;\n+import javax.swing.JFrame;\n+import javax.swing.JPanel;\n+\n+public class bug6435715 {\n+\n+    private static final String INSTRUCTIONS = \"\"\"\n+            1. after test started you will see frame with three buttons. Notice that focus is on Button2.\n+            2. Click on Button 3. Focus goes to Button3.\n+            3. Click on Button1 and quickly switch to another window. Via either alt\/tab or\n+            clicking another window with the mouse.\n+            4. After a few seconds, come back to the frame. Notice that focus is around Button2\n+            5. Click at Button3. If focus remains at Button2 test failed, if focus is on Button3 - test passed.\"\"\";\n+\n+    public static void main(String[] args) throws Exception {\n+        PassFailJFrame.builder()\n+                .title(\"bug6435715 Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .rows((int) INSTRUCTIONS.lines().count() + 5)\n+                .columns(35)\n+                .testUI(bug6435715::createTestUI)\n+                .build()\n+                .awaitAndCheck();\n+    }\n+\n+    private static JFrame createTestUI() {\n+        JFrame fr = new JFrame(\"FocusIssue\");\n+        sun.awt.SunToolkit.setLWRequestStatus(fr, true);\n+\n+        JPanel panel = new JPanel();\n+        final JButton b1 = new JButton(\"Button 1\");\n+        final JButton b2 = new JButton(\"Button 2\");\n+        final JButton b3 = new JButton(\"Button 3\");\n+\n+        panel.add(b1);\n+        panel.add(b2);\n+        panel.add(b3);\n+\n+        b1.addFocusListener(new FocusAdapter() {\n+            public void focusGained(FocusEvent event) {\n+                synchronized (this) {\n+                    try {\n+                        wait(1000);\n+                    } catch (Exception ex) {\n+                        ex.printStackTrace();\n+                    }\n+                    b2.requestFocus();\n+                }\n+            }\n+        });\n+        fr.getContentPane().add(panel);\n+        fr.pack();\n+        return fr;\n+    }\n+\n+}\n","filename":"test\/jdk\/java\/awt\/Focus\/bug6435715.java","additions":91,"deletions":0,"binary":false,"changes":91,"status":"added"}]}