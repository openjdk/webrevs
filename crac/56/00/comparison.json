{"files":[{"patch":"@@ -151,4 +151,2 @@\n-    char cppath[PATH_MAX];\n-    cppath[0] = '\\0';\n-    FILE *cppathfile = fopen(cppathpath, \"r\");\n-    if (!cppathfile) {\n+    int fd = open(cppathpath, O_RDONLY);\n+    if (fd < 0) {\n@@ -159,3 +157,12 @@\n-    if (!fgets(cppath, sizeof(cppath), cppathfile)) {\n-        fprintf(stderr, \"fgets error\\n\");\n-        return 1;\n+    char cppath[PATH_MAX];\n+    int cppathlen = 0;\n+    int r;\n+    while ((r = read(fd, cppath + cppathlen, sizeof(cppath) - cppathlen - 1)) != 0) {\n+        if (r < 0 && errno == EINTR) {\n+            continue;\n+        }\n+        if (r < 0) {\n+            perror(\"read cppath\");\n+            return 1;\n+        }\n+        cppathlen += r;\n@@ -163,1 +170,3 @@\n-    fclose(cppathfile);\n+    cppath[cppathlen] = '\\0';\n+\n+    close(fd);\n","filename":"src\/java.base\/unix\/native\/criuengine\/criuengine.c","additions":17,"deletions":8,"binary":false,"changes":25,"status":"modified"}]}