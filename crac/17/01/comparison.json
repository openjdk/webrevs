{"files":[{"patch":"@@ -804,2 +804,6 @@\n-        public Source getSource() {\n-            return zsrc;\n+        public void beforeCheckpoint() {\n+            if (zsrc != null) {\n+                synchronized (zsrc) {\n+                    zsrc.beforeCheckpoint();\n+                }\n+            }\n@@ -1088,11 +1092,1 @@\n-        RandomAccessFile f = res.getSource().getFile();\n-        synchronized (f) {\n-            FileDescriptor fd = null;\n-            try {\n-                fd = f.getFD();\n-            } catch (IOException e) {\n-            }\n-            if (fd != null) {\n-                Core.registerPersistent(fd);\n-            }\n-        }\n+        res.beforeCheckpoint();\n@@ -1799,2 +1793,11 @@\n-        public RandomAccessFile getFile() {\n-            return zfile;\n+        public void beforeCheckpoint() {\n+            synchronized (zfile) {\n+                FileDescriptor fd = null;\n+                try {\n+                    fd = zfile.getFD();\n+                } catch (IOException e) {\n+                }\n+                if (fd != null) {\n+                    Core.registerPersistent(fd);\n+                }\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipFile.java","additions":18,"deletions":15,"binary":false,"changes":33,"status":"modified"}]}