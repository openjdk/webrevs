{"files":[{"patch":"@@ -2264,0 +2264,5 @@\n+  if (CRaCEngineOptions && strcmp(CRaCEngineOptions, \"help\") == 0) {\n+    crac::print_engine_info_and_exit(); \/\/ Does not return on success\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -123,0 +123,3 @@\n+            test(\"criuengine\", \"help,keep_running=true\", 1,\n+                    \"unknown configure option: help\",\n+                    \"CRaC engine failed to configure: 'help' = ''\");\n@@ -156,0 +159,11 @@\n+\n+        if (Platform.isLinux()) {\n+            test(\"criuengine\",\n+                    Arrays.asList(\"help\", \"args=-v4\"),\n+                    1,\n+                    Arrays.asList(\n+                        \"unknown configure option: help\",\n+                        \"CRaC engine failed to configure: 'help' = ''\"\n+                    ),\n+                    Collections.emptyList());\n+        }\n@@ -160,7 +174,3 @@\n-        ProcessBuilder pb = ProcessTools.createTestJavaProcessBuilder(\n-                \"-XX:CRaCEngineOptions=help\");\n-        OutputAnalyzer out = new OutputAnalyzer(pb.start());\n-        out.shouldHaveExitValue(0);\n-        out.stdoutShouldContain(\"Configuration options:\");\n-        out.stderrShouldBeEmpty();\n-        out.shouldNotContain(\"CRaC engine option:\");\n+        testHelp();\n+        testHelp(\"-XX:CRaCCheckpointTo=cr\");\n+        testHelp(\"-XX:CRaCRestoreFrom=cr\");\n@@ -203,0 +213,13 @@\n+\n+    private static void testHelp(String... opts) throws Exception {\n+        List<String> optsList = new ArrayList(Arrays.asList(opts));\n+        optsList.add(\"-XX:CRaCEngineOptions=help\");\n+        optsList.add(\"-Xlog:crac=debug\");\n+        \/\/ Limited to not get non-restore-settable flags with CRaCRestoreFrom\n+        ProcessBuilder pb = ProcessTools.createLimitedTestJavaProcessBuilder(optsList);\n+        OutputAnalyzer out = new OutputAnalyzer(pb.start());\n+        out.shouldHaveExitValue(0);\n+        out.stdoutShouldContain(\"Configuration options:\");\n+        out.stderrShouldBeEmpty();\n+        out.shouldNotContain(\"CRaC engine option:\");\n+    }\n","filename":"test\/jdk\/jdk\/crac\/CracEngineOptionsTest.java","additions":30,"deletions":7,"binary":false,"changes":37,"status":"modified"}]}