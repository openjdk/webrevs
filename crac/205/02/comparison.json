{"files":[{"patch":"@@ -123,0 +123,4 @@\n+\n+  \/\/ Default log level for 'crac' is Info\n+  precond(!log_is_enabled(Info, crac)); \/\/ If this fails, the below can be removed\n+  LogTagSetMapping<LOG_TAGS(crac)>::tagset().set_output_level(StdoutLog, LogLevel::Info);\n","filename":"src\/hotspot\/share\/logging\/logConfiguration.cpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -380,3 +380,0 @@\n-  \/\/ Automatically configure log level for 'crac' to Info\n-  LogTagSetMapping<LOG_TAGS(crac)>::tagset().set_output_level(LogConfiguration::StdoutLog, LogLevelType::Info);\n-\n","filename":"src\/hotspot\/share\/runtime\/crac.cpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -0,0 +1,85 @@\n+\/*\n+ * Copyright (c) 2025, Azul Systems, Inc. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import jdk.crac.Core;\n+import jdk.test.lib.crac.CracBuilder;\n+import jdk.test.lib.crac.CracEngine;\n+import jdk.test.lib.crac.CracTest;\n+import jdk.test.lib.crac.CracTestArg;\n+\n+\/**\n+ * @test\n+ * @bug 8350569\n+ * @summary Checks that log set 'crac' can be manipulated via VM options.\n+ * @library \/test\/lib\n+ * @build CracLogTest\n+ * @run driver jdk.test.lib.crac.CracTest not-set\n+ * @run driver jdk.test.lib.crac.CracTest off\n+ * @run driver jdk.test.lib.crac.CracTest error\n+ * @run driver jdk.test.lib.crac.CracTest info\n+ * @run driver jdk.test.lib.crac.CracTest trace\n+ *\/\n+public class CracLogTest implements CracTest {\n+    private static final String CHECKPOINT_LOG_LEVEL = \"info\";\n+    private static final String CHECKPOINT_LOG_MSG = \"Checkpoint ...\";\n+\n+    @CracTestArg(0)\n+    String logLevelStr;\n+\n+    @Override\n+    public void test() throws Exception {\n+        var builder = new CracBuilder()\n+                .engine(CracEngine.SIMULATE)\n+                .captureOutput(true);\n+        if (!logLevelStr.equals(\"not-set\")) {\n+            builder = builder.vmOption(\"-Xlog:crac=\" + logLevelStr);\n+        }\n+        final var out = builder.startCheckpoint().waitForSuccess().outputAnalyzer();\n+\n+        final var checkpointLogLevel = logLevelStrToInt(CHECKPOINT_LOG_LEVEL);\n+        final var selectedLogLevel = logLevelStrToInt(logLevelStr);\n+        if (checkpointLogLevel <= selectedLogLevel) {\n+            out.shouldContain(CHECKPOINT_LOG_MSG);\n+        } else {\n+            out.shouldNotContain(CHECKPOINT_LOG_MSG);\n+        }\n+    }\n+\n+    @Override\n+    public void exec() throws Exception {\n+        Core.checkpointRestore();\n+    }\n+\n+    private static int logLevelStrToInt(String str) {\n+        return switch (str) {\n+            case \"not-set\" -> logLevelStrToInt(CHECKPOINT_LOG_LEVEL);\n+            case \"off\" -> 0;\n+            case \"error\" -> 1;\n+            case \"warning\" -> 2;\n+            case \"info\" -> 3;\n+            case \"debug\" -> 4;\n+            case \"trace\" -> 5;\n+            default -> throw new IllegalArgumentException(\"Not a log level: \" + str);\n+        };\n+    }\n+}\n","filename":"test\/jdk\/jdk\/crac\/CracLogTest.java","additions":85,"deletions":0,"binary":false,"changes":85,"status":"added"}]}