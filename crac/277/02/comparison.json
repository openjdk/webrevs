{"files":[{"patch":"@@ -956,0 +956,1 @@\n+static bool from_reexec;\n@@ -962,1 +963,1 @@\n-  if (env && (strcmp(env, env_val) == 0 || (!INCLUDE_CPU_FEATURE_ACTIVE && getenv(REEXEC_NAME)))) {\n+  if (env && (strcmp(env, env_val) == 0 || (!INCLUDE_CPU_FEATURE_ACTIVE && from_reexec))) {\n@@ -1002,1 +1003,1 @@\n-  if (getenv(REEXEC_NAME)) {\n+  if (from_reexec) {\n@@ -1008,1 +1009,0 @@\n-#undef REEXEC_NAME\n@@ -1069,0 +1069,2 @@\n+  from_reexec = getenv(REEXEC_NAME) != nullptr;\n+\n@@ -1162,1 +1164,1 @@\n-  static const size_t tunables_size_max = 17;\n+  static const size_t tunables_size_max = sizeof(\"AVX_Fast_Unaligned_Load\") - 1;\n@@ -1196,1 +1198,4 @@\n-#define EXCESSIVE(tunables) shouldnotuse_set(PASTE_TOKENS(CPU_, tunables), STR(tunables), FEATURE_ACTIVE(tunables))\n+#define EXCESSIVE2(tunables, feature_active) shouldnotuse_set(PASTE_TOKENS(CPU_, tunables), STR(tunables), feature_active)\n+#define EXCESSIVE(tunables) EXCESSIVE2(tunables, FEATURE_ACTIVE(tunables))\n+\/\/ There is no CPU_FEATURE_ACTIVE() available for this symbol.\n+#define EXCESSIVE_GLIBC_PREFERRED(tunables) EXCESSIVE2(tunables, !from_reexec)\n@@ -1227,0 +1232,1 @@\n+  EXCESSIVE_GLIBC_PREFERRED(AVX_Fast_Unaligned_Load);\n@@ -1298,0 +1304,1 @@\n+#undef REEXEC_NAME\n@@ -3652,0 +3659,11 @@\n+  \/\/ sysdeps\/x86\/cpu-features.c\n+  if (vm_features.supports_feature(CPU_OSXSAVE)) {\n+    if (xem_xcr0_eax.bits.sse != 0 &&\n+        xem_xcr0_eax.bits.ymm != 0) {\n+      if (vm_features.supports_feature(CPU_AVX)) {\n+        if (vm_features.supports_feature(CPU_AVX2)) {\n+          vm_features.set_feature(CPU_AVX_Fast_Unaligned_Load);\n+        }\n+      }\n+    }\n+  }\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":23,"deletions":5,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -473,1 +473,2 @@\n-    decl(XSAVEC,            \"xsavec\",            74)\n+    decl(XSAVEC,            \"xsavec\",            74) \\\n+    decl(AVX_Fast_Unaligned_Load, \"AVX_Fast_Unaligned_Load\", 75)\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -300,1 +300,2 @@\n-        XSAVEC\n+        XSAVEC,\n+        AVX_Fast_Unaligned_Load\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk\/vm\/ci\/amd64\/AMD64.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}