{"files":[{"patch":"@@ -33,1 +33,1 @@\n-javafiles=\"{bin\/{java,jcmd},lib\/{jvm.cfg,lib{crexec,java,jimage,jli,jsvml,net,nio,attach,zip}.so,modules,tzdb.dat,server\/{classes.jsa,libjvm.so},criuengine,criu,libwarp.so},conf\/security\/java.security}\"\n+javafiles=\"{bin\/{java,jcmd},lib\/{jvm.cfg,lib{crexec,java,jimage,jli,jsvml,net,nio,attach,zip}.so,modules,tzdb.dat,server\/{classes.jsa,libjvm.so},criuengine,criu},conf\/security\/java.security}\"\n@@ -36,1 +36,1 @@\n-# FIXME: warp+criu need an update for new kernels:\n+# FIXME: criu need an update for new kernels:\n@@ -188,1 +188,1 @@\n-    bin\/java $warp -XX:CRaCCheckpointTo=cr -XX:+ShowCPUFeatures $checkpoint_args CPUFeatures&p=\\$!;sleep $[3*$timeoutmultiply];bin\/jcmd CPUFeatures JDK.checkpoint; \\\n+    bin\/java -XX:CRaCCheckpointTo=cr -XX:+ShowCPUFeatures $checkpoint_args CPUFeatures&p=\\$!;sleep $[3*$timeoutmultiply];bin\/jcmd CPUFeatures JDK.checkpoint; \\\n@@ -193,1 +193,1 @@\n-  restore=\"$(runssh \"$javasetup;bin\/java $warp -XX:CRaCRestoreFrom=cr $restore_args&p=\\$!;(sleep $[6*$timeoutmultiply];kill \\$p)&wait \\$p;echo RC=\\$?\" 2>&1|tee \/proc\/self\/fd\/2)\"\n+  restore=\"$(runssh \"$javasetup;bin\/java -XX:CRaCRestoreFrom=cr $restore_args&p=\\$!;(sleep $[6*$timeoutmultiply];kill \\$p)&wait \\$p;echo RC=\\$?\" 2>&1|tee \/proc\/self\/fd\/2)\"\n@@ -197,1 +197,1 @@\n-function checkpoint_restore_one {\n+function checkpoint_restore {\n@@ -212,11 +212,0 @@\n-# FIXME: Make both snapshots first and both restores second to better reuse the VMs.\n-function checkpoint_restore {\n-  checkpoint_restore=\"criu: $*\"\n-  warp=\"\"\n-  checkpoint_restore_one \"$@\"\n-  if ! echo \"$*\"|grep -q \"x86: FPU xsave area present, but host cpu doesn't support it\";then\n-    checkpoint_restore=\"warp: $*\"\n-    warp=\"-XX:CRaCEngine=warp\"\n-    checkpoint_restore_one \"$@\"\n-  fi\n-}\n@@ -238,1 +227,1 @@\n-  echo \": $checkpoint_restore\"\n+  echo \": criu: \"\n","filename":"test\/jdk\/jdk\/crac\/CPUFeatures\/CPUFeatures.sh","additions":6,"deletions":17,"binary":false,"changes":23,"status":"modified"}]}