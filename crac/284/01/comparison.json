{"files":[{"patch":"@@ -51,4 +51,0 @@\n-  enum mark_t {\n-    M_CANT_RESTORE = 1 << 0,\n-  };\n-\n@@ -60,3 +56,0 @@\n-    unsigned mark;\n-\n-    int flags;\n@@ -71,6 +64,0 @@\n-  void assert_mark(int i) {\n-    assert(_inited, \"\");\n-    assert(i < _fdinfos.length(), \"\");\n-    assert(_fdinfos.at(i).state != CLOSED, \"\");\n-  }\n-\n@@ -122,20 +109,0 @@\n-\/* taken from criu, that took this from kernel *\/\n-#define NFS_PREF \".nfs\"\n-#define NFS_PREF_LEN ((unsigned)sizeof(NFS_PREF) - 1)\n-#define NFS_FILEID_LEN ((unsigned)sizeof(uint64_t) << 1)\n-#define NFS_COUNTER_LEN ((unsigned)sizeof(unsigned int) << 1)\n-#define NFS_LEN (NFS_PREF_LEN + NFS_FILEID_LEN + NFS_COUNTER_LEN)\n-static bool nfs_silly_rename(char* path) {\n-  char *sep = strrchr(path, '\/');\n-  char *base = sep ? sep + 1 : path;\n-  if (strncmp(base, NFS_PREF, NFS_PREF_LEN)) {\n-    return false;\n-  }\n-  for (unsigned i = NFS_PREF_LEN; i < NFS_LEN; ++i) {\n-    if (!isxdigit(base[i])) {\n-      return false;\n-    }\n-  }\n-  return true;\n-}\n-\n@@ -214,1 +181,0 @@\n-    info.mark = 0;\n@@ -228,11 +194,0 @@\n-\n-    if (info->state == ROOT) {\n-      char fdpath[PATH_MAX];\n-      int r = readfdlink(info->fd, fdpath, sizeof(fdpath));\n-      guarantee(-1 != r, \"can't stat fd\");\n-      if (info->stat.st_nlink == 0 ||\n-          strstr(fdpath, \"(deleted)\") ||\n-          nfs_silly_rename(fdpath)) {\n-        info->mark |= FdsInfo::M_CANT_RESTORE;\n-      }\n-    }\n","filename":"src\/hotspot\/os\/linux\/crac_linux.cpp","additions":0,"deletions":45,"binary":false,"changes":45,"status":"modified"}]}