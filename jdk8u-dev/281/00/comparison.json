{"files":[{"patch":"@@ -278,0 +278,1 @@\n+        Java_sun_awt_X11_XInputMethod_moveCandidateWindow;\n","filename":"jdk\/make\/mapfiles\/libawt_xawt\/mapfile-vers","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.awt.AWTEvent;\n@@ -31,0 +32,2 @@\n+import java.awt.Dimension;\n+import java.awt.Point;\n@@ -32,0 +35,3 @@\n+import java.awt.event.KeyEvent;\n+import java.awt.event.MouseEvent;\n+import java.awt.font.TextHitInfo;\n@@ -46,0 +52,2 @@\n+    private InputMethodContext inputContext;\n+\n@@ -50,0 +58,1 @@\n+    @Override\n@@ -51,0 +60,1 @@\n+        this.inputContext = context;\n@@ -59,0 +69,3 @@\n+\n+        \/\/After window moved, this would called.\n+        positionCandidateWindow();\n@@ -144,0 +157,57 @@\n+    @Override\n+    public void dispatchEvent(AWTEvent e) {\n+        switch (e.getID()) {\n+            case KeyEvent.KEY_PRESSED:\n+            case KeyEvent.KEY_RELEASED:\n+            case MouseEvent.MOUSE_CLICKED:\n+                positionCandidateWindow();\n+                break;\n+\n+            default:\n+                break;\n+        }\n+    }\n+\n+    private void positionCandidateWindow() {\n+        if (this.inputContext == null) {\n+            return;\n+        }\n+\n+        Component client = getClientComponent();\n+\n+        if (client == null || !client.isShowing()) {\n+            return;\n+        }\n+\n+        int x = 0;\n+        int y = 0;\n+\n+        \/\/ Get this textcomponent coordinate from root window.\n+        Component temp = client;\n+        while (temp != null) {\n+             Component parent = temp.getParent();\n+             if (parent == null) {\n+                 break;\n+             }\n+\n+             x += temp.getX();\n+             y += temp.getY();\n+             temp = parent;\n+        }\n+\n+        if (haveActiveClient()) {\n+            Rectangle rc = inputContext.getTextLocation(TextHitInfo.leading(0));\n+            x += rc.x;\n+            y += rc.y + rc.height;\n+\n+            Point p = client.getLocationOnScreen();\n+            x -= p.x;\n+            y -= p.y;\n+        } else {\n+            Dimension size = client.getSize();\n+            y += size.height;\n+        }\n+\n+        moveCandidateWindow(x, y);\n+    }\n+\n@@ -152,0 +222,1 @@\n+    private native void moveCandidateWindow(int x, int y);\n","filename":"jdk\/src\/solaris\/classes\/sun\/awt\/X11\/XInputMethod.java","additions":71,"deletions":0,"binary":false,"changes":71,"status":"modified"},{"patch":"@@ -1654,0 +1654,27 @@\n+\n+JNIEXPORT void JNICALL Java_sun_awt_X11_XInputMethod_moveCandidateWindow\n+ (JNIEnv *env, jobject this, jint x, jint y)\n+{\n+    X11InputMethodData *pX11IMData;\n+    XVaNestedList preedit_attr;\n+    XPoint nspot;\n+\n+    nspot.x = x;\n+    nspot.y = y;\n+\n+    AWT_LOCK();\n+\n+    pX11IMData = getX11InputMethodData(env, this);\n+\n+    if ((pX11IMData == NULL) || (pX11IMData->current_ic == NULL)) {\n+        AWT_UNLOCK();\n+        return;\n+    }\n+\n+    preedit_attr = XVaCreateNestedList(0, XNSpotLocation, &nspot, NULL);\n+    XSetICValues(pX11IMData->current_ic, XNPreeditAttributes, preedit_attr, NULL);\n+\n+    XFree(preedit_attr);\n+\n+    AWT_UNLOCK();\n+}\n","filename":"jdk\/src\/solaris\/native\/sun\/awt\/awt_InputMethod.c","additions":27,"deletions":0,"binary":false,"changes":27,"status":"modified"}]}