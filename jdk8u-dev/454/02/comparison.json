{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2011, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+import java.util.OptionalInt;\n@@ -247,0 +248,13 @@\n+\n+    public OptionalInt findInt(String k) {\n+        try {\n+            String s = findValue(k);\n+            if (s == null) {\n+                return OptionalInt.empty();\n+            }\n+            return OptionalInt.of(Integer.parseInt(s));\n+        } catch (Throwable t) {\n+            return OptionalInt.empty();\n+        }\n+    }\n+\n","filename":"jdk\/src\/share\/classes\/sun\/net\/www\/HeaderParser.java","additions":15,"deletions":1,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import java.util.OptionalInt;\n@@ -122,0 +123,1 @@\n+     * -2: the server provided \"Connection: keep-alive\" and timeout=0\n@@ -822,4 +824,2 @@\n-                        keepAliveTimeout = p.findInt(\"timeout\", -1);\n-                        if (keepAliveTimeout < -1) {\n-                            \/\/ if the server specified a negative (invalid) value\n-                            \/\/ then we set to -1, which is equivalent to no value\n+                        OptionalInt timeout = p.findInt(\"timeout\");\n+                        if (!timeout.isPresent()) {\n@@ -827,0 +827,10 @@\n+                        } else {\n+                            keepAliveTimeout = timeout.getAsInt();\n+                            if (keepAliveTimeout < 0) {\n+                                \/\/ if the server specified a negative (invalid) value\n+                                \/\/ then we set to -1, which is equivalent to no value\n+                                keepAliveTimeout = -1;\n+                            } else if (keepAliveTimeout == 0) {\n+                                \/\/ handled specially to mean close connection immediately\n+                                keepAliveTimeout = -2;\n+                            }\n","filename":"jdk\/src\/share\/classes\/sun\/net\/www\/http\/HttpClient.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -170,0 +170,2 @@\n+                } else if (keepAliveTimeout == -2) {\n+                    keepAliveTimeout = 0;\n","filename":"jdk\/src\/share\/classes\/sun\/net\/www\/http\/KeepAliveCache.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @bug 8291226 8291638\n@@ -1018,6 +1019,0 @@\n-        \/\/test scenarios are skipped because of JDK-8291638\n-        if((scenarioNumber >= 112 && scenarioNumber <= 127) || (scenarioNumber >= 144 && scenarioNumber <= 159)) {\n-            System.out.println(\"Scenario Skipped:\"+scenarioNumber);\n-            this.countDownLatch.countDown();\n-            return;\n-        }\n","filename":"jdk\/test\/sun\/net\/www\/http\/HttpClient\/KeepAliveTest.java","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"}]}