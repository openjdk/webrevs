{"files":[{"patch":"@@ -598,2 +598,3 @@\n-  int args_read = sscanf(s, JULONG_FORMAT, &n);\n-  if (args_read != 1) {\n+\n+  \/\/ First char must be a digit. Don't allow negative numbers or leading spaces.\n+  if (!isdigit(*s)) {\n@@ -602,2 +603,6 @@\n-  while (*s != '\\0' && isdigit(*s)) {\n-    s++;\n+\n+  char* remainder;\n+  errno = 0;\n+  n = strtoull(s, &remainder, 10);\n+  if (errno != 0) {\n+    return false;\n@@ -605,2 +610,3 @@\n-  \/\/ 4705540: illegal if more characters are found after the first non-digit\n-  if (strlen(s) > 1) {\n+\n+  \/\/ Fail if no number was read at all or if the remainder contains more than a single non-digit character.\n+  if (remainder == s || strlen(remainder) > 1) {\n@@ -609,1 +615,2 @@\n-  switch (*s) {\n+\n+  switch (*remainder) {\n","filename":"hotspot\/src\/share\/vm\/runtime\/arguments.cpp","additions":14,"deletions":7,"binary":false,"changes":21,"status":"modified"}]}