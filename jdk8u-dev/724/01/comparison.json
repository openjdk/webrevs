{"files":[{"patch":"@@ -2295,0 +2295,13 @@\n+static void print_container_helper(outputStream* st, jlong j, const char* metrics) {\n+  st->print(\"%s: \", metrics);\n+  if (j > 0) {\n+    if (j >= 1024) {\n+      st->print_cr(UINT64_FORMAT \" k\", uint64_t(j) \/ 1024);\n+    } else {\n+      st->print_cr(UINT64_FORMAT, uint64_t(j));\n+    }\n+  } else {\n+    st->print_cr(\"%s\", j == OSCONTAINER_ERROR ? \"not supported\" : \"unlimited\");\n+  }\n+}\n+\n@@ -2303,1 +2316,1 @@\n-  st->print(\"container_type: %s\\n\", p_ct != NULL ? p_ct : \"failed\");\n+  st->print(\"container_type: %s\\n\", p_ct != NULL ? p_ct : \"not supported\");\n@@ -2306,1 +2319,1 @@\n-  st->print(\"cpu_cpuset_cpus: %s\\n\", p != NULL ? p : \"failed\");\n+  st->print(\"cpu_cpuset_cpus: %s\\n\", p != NULL ? p : \"not supported\");\n@@ -2310,1 +2323,1 @@\n-  st->print(\"cpu_memory_nodes: %s\\n\", p != NULL ? p : \"failed\");\n+  st->print(\"cpu_memory_nodes: %s\\n\", p != NULL ? p : \"not supported\");\n@@ -2314,0 +2327,1 @@\n+  st->print(\"active_processor_count: \");\n@@ -2315,1 +2329,1 @@\n-    st->print(\"active_processor_count: %d\\n\", i);\n+    st->print(\"%d\\n\", i);\n@@ -2317,1 +2331,1 @@\n-    st->print(\"active_processor_count: failed\\n\");\n+    st->print(\"not supported\\n\");\n@@ -2321,1 +2335,6 @@\n-  st->print(\"cpu_quota: %d\\n\", i);\n+  st->print(\"cpu_quota: \");\n+  if (i > 0) {\n+    st->print(\"%d\\n\", i);\n+  } else {\n+    st->print(\"%s\\n\", i == OSCONTAINER_ERROR ? \"not supported\" : \"no quota\");\n+  }\n@@ -2324,1 +2343,6 @@\n-  st->print(\"cpu_period: %d\\n\", i);\n+  st->print(\"cpu_period: \");\n+  if (i > 0) {\n+    st->print(\"%d\\n\", i);\n+  } else {\n+    st->print(\"%s\\n\", i == OSCONTAINER_ERROR ? \"not supported\" : \"no period\");\n+  }\n@@ -2327,13 +2351,6 @@\n-  st->print(\"cpu_shares: %d\\n\", i);\n-\n-  jlong j = OSContainer::memory_limit_in_bytes();\n-  st->print(\"memory_limit_in_bytes: \" JLONG_FORMAT \"\\n\", j);\n-\n-  j = OSContainer::memory_and_swap_limit_in_bytes();\n-  st->print(\"memory_and_swap_limit_in_bytes: \" JLONG_FORMAT \"\\n\", j);\n-\n-  j = OSContainer::memory_soft_limit_in_bytes();\n-  st->print(\"memory_soft_limit_in_bytes: \" JLONG_FORMAT \"\\n\", j);\n-\n-  j = OSContainer::OSContainer::memory_usage_in_bytes();\n-  st->print(\"memory_usage_in_bytes: \" JLONG_FORMAT \"\\n\", j);\n+  st->print(\"cpu_shares: \");\n+  if (i > 0) {\n+    st->print(\"%d\\n\", i);\n+  } else {\n+    st->print(\"%s\\n\", i == OSCONTAINER_ERROR ? \"not supported\" : \"no shares\");\n+  }\n@@ -2341,2 +2358,5 @@\n-  j = OSContainer::OSContainer::memory_max_usage_in_bytes();\n-  st->print(\"memory_max_usage_in_bytes: \" JLONG_FORMAT \"\\n\", j);\n+  print_container_helper(st, OSContainer::memory_limit_in_bytes(), \"memory_limit_in_bytes\");\n+  print_container_helper(st, OSContainer::memory_and_swap_limit_in_bytes(), \"memory_and_swap_limit_in_bytes\");\n+  print_container_helper(st, OSContainer::memory_soft_limit_in_bytes(), \"memory_soft_limit_in_bytes\");\n+  print_container_helper(st, OSContainer::memory_usage_in_bytes(), \"memory_usage_in_bytes\");\n+  print_container_helper(st, OSContainer::memory_max_usage_in_bytes(), \"memory_max_usage_in_bytes\");\n","filename":"hotspot\/src\/os\/linux\/vm\/os_linux.cpp","additions":42,"deletions":22,"binary":false,"changes":64,"status":"modified"}]}