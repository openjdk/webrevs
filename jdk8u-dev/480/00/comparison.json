{"files":[{"patch":"@@ -0,0 +1,49 @@\n+#\n+#    source: 34B003AF.RPMAP130\n+#    c->b only entries\n+#\n+815C\t2015\n+8160\tFF5E\n+8161\t2225\n+817C\tFF0D\n+88A0\t555E\n+898B\t7130\n+89A8\t9DD7\n+8A9A\t5699\n+8BA0\t4FE0\n+8BEB\t8EC0\n+8C71\t7E6B\n+8C74\t8346\n+8CB2\t9E7C\n+8D8D\t9EB4\n+8DF2\t6805\n+8EC6\t5C62\n+8F4A\t7E61\n+8FD3\t8523\n+8FDD\t91AC\n+90E4\t87EC\n+917E\t6414\n+9189\t7626\n+91CB\t9A52\n+925C\t7C1E\n+92CD\t6451\n+9355\t5861\n+935E\t985A\n+9398\t79B1\n+93C0\t7006\n+9458\t56CA\n+948D\t525D\n+94AC\t6F51\n+94AE\t91B1\n+966A\t9830\n+96CB\t9EB5\n+9789\t840A\n+9858\t881F\n+9BA0\t5C5B\n+9DB7\t6522\n+9E94\t688E\n+E379\t7E48\n+E445\t8141\n+E8F6\t9839\n+FA55\tFFE4\n+FA59\tF86F\n","filename":"jdk\/make\/data\/charsetmapping\/IBM943.c2b","additions":49,"deletions":0,"binary":false,"changes":49,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,2 +25,4 @@\n-   @bug 6371437 6371422 6371416 6371619 5058184 6371431 6639450 6569191 6577466\n-   @summary Check if the problems reported in above bugs have been fixed\n+ * @bug 6371437 6371422 6371416 6371619 5058184 6371431 6639450 6569191 6577466\n+ *      8212794 8220281 8235834\n+ * @summary Check if the problems reported in above bugs have been fixed\n+ * @modules jdk.charsets\n@@ -175,0 +177,205 @@\n+    private static void bug8213618 () throws Exception {\n+        String cs = \"x-IBM970\";\n+        byte[] ba = new byte[]{(byte)0xA2,(byte)0xC1};\n+        String s = \"\\u25C9\";\n+        if (!(new String(ba, cs)).equals(s))\n+            throw new Exception(\"Cp970 failed\");\n+        if (!Arrays.equals(ba, s.getBytes(cs)))\n+            throw new Exception(\"Cp970 failed\");\n+        ba = new byte[]{0x3f,0x3f,0x3f};\n+        if (!Arrays.equals(ba, \"\\u6950\\u84f1\\ucf7f\".getBytes(cs)))\n+            throw new Exception(\"Cp970 failed\");\n+    }\n+\n+    private static void bug8202329() throws Exception {\n+        String original = \"\\\\\\u007E\\u00A5\\u203E\"; \/\/ [backslash][tilde][yen][overscore]\n+        byte[] expectedBytes; \/\/ bytes after conversion\n+        String expectedStringfromBytes; \/\/ String constructed from bytes\n+\n+        Charset charset; \/\/ charset used for conversion\n+\n+        ByteBuffer bb; \/\/ Buffer that holds encoded bytes\n+        byte[]  ba; \/\/ byte array that holds encoded bytes\n+\n+        CharBuffer cb; \/\/ Buffer that holds decoded chars\n+\n+\n+        \/\/ Test IBM943, where \\ and ~ are encoded to unmappable i.e., 0x3f\n+        \/\/ and [yen] and [overscore] are encoded to 0x5c and 0x7e\n+        charset = Charset.forName(\"IBM943\");\n+        expectedBytes = new byte[] {0x3f, 0x3f, 0x5c, 0x7e};\n+        expectedStringfromBytes = \"??\\u00A5\\u203E\";\n+        bb = charset.encode(original);\n+        ba = new byte[bb.remaining()];\n+        bb.get(ba, 0, ba.length);\n+        if(!Arrays.equals(ba, expectedBytes)) {\n+            throw new Exception(\"IBM943 failed to encode\");\n+        }\n+        cb = charset.decode(ByteBuffer.wrap(expectedBytes));\n+        if(!cb.toString().equals(expectedStringfromBytes)) {\n+            throw new Exception(\"IBM943 failed to decode\");\n+        }\n+\n+\n+        \/\/ Test IBM943C, where \\ and ~ are encoded to 0x5c and 0x7e\n+        \/\/ and [yen] and [overscore] are encoded to 0x5c and 0x7e\n+        charset = Charset.forName(\"IBM943C\");\n+        expectedBytes = new byte[] {0x5c, 0x7e, 0x5c, 0x7e};\n+        expectedStringfromBytes = \"\\\\~\\\\~\";\n+        bb = charset.encode(original);\n+        ba = new byte[bb.remaining()];\n+        bb.get(ba, 0, ba.length);\n+        if(!Arrays.equals(ba, expectedBytes)) {\n+            throw new Exception(\"IBM943C failed to encode\");\n+        }\n+        cb = charset.decode(ByteBuffer.wrap(expectedBytes));\n+        if(!cb.toString().equals(expectedStringfromBytes)) {\n+            throw new Exception(\"IBM943C failed to decode\");\n+        }\n+    }\n+\n+    private static void bug8212794 () throws Exception {\n+        Charset cs = Charset.forName(\"x-IBM964\");\n+        byte[] ba = new byte[] {(byte)0x5c, (byte)0x90, (byte)0xa1, (byte)0xa1};\n+        char[] ca = new char[] {'\\\\', '\\u0090', '\\u3000'};\n+        ByteBuffer bb = ByteBuffer.wrap(ba);\n+        CharBuffer cb = cs.decode(bb);\n+        if(!Arrays.equals(ca, Arrays.copyOf(cb.array(), cb.limit()))) {\n+            throw new Exception(\"IBM964 failed to decode\");\n+        }\n+        cb = CharBuffer.wrap(ca);\n+        bb = cs.encode(cb);\n+        if(!Arrays.equals(ba, Arrays.copyOf(bb.array(), bb.limit()))) {\n+            throw new Exception(\"IBM964 failed to encode\");\n+        }\n+    }\n+\n+    private static void bug8220281 () throws Exception {\n+        if (System.getProperty(\"os.name\").contains(\"AIX\")) {\n+            \/* Following AIX codesets are used for Java default charset. *\/\n+            \/* They should be in sun.nio.cs package on AIX platform.     *\/\n+            String[] codesets = new String[] {\n+                \"IBM-950\", \"BIG5-HKSCS\", \"GB18030\", \"IBM-1046\",\n+                \"IBM-1124\", \"IBM-1129\", \"IBM-1252\", \"IBM-856\",\n+                \"IBM-858\", \"IBM-921\", \"IBM-922\", \"IBM-932\", \"IBM-943C\",\n+                \"IBM-eucCN\", \"IBM-eucJP\", \"IBM-eucKR\", \"IBM-eucTW\",\n+                \"ISO8859-1\", \"ISO8859-15\", \"ISO8859-2\", \"ISO8859-4\",\n+                \"ISO8859-5\", \"ISO8859-6\", \"ISO8859-7\", \"ISO8859-8\",\n+                \"ISO8859-9\", \"TIS-620\", \"UTF-8\", };\n+            String[] charsets = new String[] {\n+                \"x-IBM950\", \"Big5-HKSCS\", \"GB18030\", \"x-IBM1046\",\n+                \"x-IBM1124\", \"x-IBM1129\", \"windows-1252\", \"x-IBM856\",\n+                \"IBM00858\", \"x-IBM921\", \"x-IBM922\", \"x-IBM942C\",\n+                \"x-IBM943C\", \"x-IBM1383\", \"x-IBM29626C\", \"x-IBM970\",\n+                \"x-IBM964\", \"ISO-8859-1\", \"ISO-8859-15\", \"ISO-8859-2\",\n+                \"ISO-8859-4\", \"ISO-8859-5\", \"ISO-8859-6\", \"ISO-8859-7\",\n+                \"ISO-8859-8\", \"ISO-8859-9\", \"TIS-620\", \"UTF-8\", };\n+            for(int i = 0; i < codesets.length; i++) {\n+                Charset cs0 = Charset.forName(codesets[i]);\n+                if (!\"sun.nio.cs\".equals(cs0.getClass().getPackage().getName())) {\n+                    throw new Exception(cs0.getClass().getCanonicalName()+\" faild\");\n+                }\n+                Charset cs1 = Charset.forName(charsets[i]);\n+                if (!cs0.equals(cs1)) {\n+                    throw new Exception(codesets[i]+\"(\"+cs0.name()+\") failed\");\n+                }\n+            }\n+        }\n+        for(Charset cs : Charset.availableCharsets().values()) {\n+            String csName = cs.name().toLowerCase(Locale.ROOT);\n+            String suffix = null;\n+            HashSet<String> aliases = new HashSet<String>();\n+            for(String s : cs.aliases()) {\n+                aliases.add(s.toLowerCase(Locale.ROOT));\n+            }\n+            aliases.add(csName);\n+            if (csName.startsWith(\"x-ibm-\")) {\n+                suffix = csName.replaceAll(\"x-ibm-0*\", \"\");\n+            } else if (csName.startsWith(\"x-ibm\")) {\n+                suffix = csName.replaceAll(\"x-ibm0*\", \"\");\n+            } else if (csName.startsWith(\"ibm-\")) {\n+                suffix = csName.replaceAll(\"ibm-0*\", \"\");\n+            } else if (csName.startsWith(\"ibm\")) {\n+                suffix = csName.replaceAll(\"ibm0*\", \"\");\n+            }\n+            if (\"ibm-thai\".equals(csName)) {\n+                suffix = \"838\";\n+            }\n+            if (null != suffix) {\n+                while (suffix.length() < 3) {\n+                    suffix = \"0\"+suffix;\n+                }\n+                if (!aliases.contains(\"cp\"+suffix)) {\n+                    throw new Exception(cs.name()+\"\\t\"+\"cp\"+suffix);\n+                }\n+                if (!aliases.contains(\"ibm\"+suffix)) {\n+                    throw new Exception(cs.name()+\"\\t\"+\"ibm\"+suffix);\n+                }\n+                if (!aliases.contains(\"ibm-\"+suffix)) {\n+                    throw new Exception(cs.name()+\"\\t\"+\"ibm-\"+suffix);\n+                }\n+                if (!aliases.contains(suffix)) {\n+                    throw new Exception(cs.name()+\"\\t\"+suffix);\n+                }\n+            }\n+        }\n+    }\n+\n+    \/\/ Following test data is for 8235834\n+    private static final byte[] byteIBM943c2b = new byte[] {\n+        (byte)0x81, (byte)0x5C, (byte)0x81, (byte)0x60,\n+        (byte)0x81, (byte)0x61, (byte)0x81, (byte)0x7C,\n+        (byte)0x88, (byte)0xA0, (byte)0x89, (byte)0x8B,\n+        (byte)0x89, (byte)0xA8, (byte)0x8A, (byte)0x9A,\n+        (byte)0x8B, (byte)0xA0, (byte)0x8B, (byte)0xEB,\n+        (byte)0x8C, (byte)0x71, (byte)0x8C, (byte)0x74,\n+        (byte)0x8C, (byte)0xB2, (byte)0x8D, (byte)0x8D,\n+        (byte)0x8D, (byte)0xF2, (byte)0x8E, (byte)0xC6,\n+        (byte)0x8F, (byte)0x4A, (byte)0x8F, (byte)0xD3,\n+        (byte)0x8F, (byte)0xDD, (byte)0x90, (byte)0xE4,\n+        (byte)0x91, (byte)0x7E, (byte)0x91, (byte)0x89,\n+        (byte)0x91, (byte)0xCB, (byte)0x92, (byte)0x5C,\n+        (byte)0x92, (byte)0xCD, (byte)0x93, (byte)0x55,\n+        (byte)0x93, (byte)0x5E, (byte)0x93, (byte)0x98,\n+        (byte)0x93, (byte)0xC0, (byte)0x94, (byte)0x58,\n+        (byte)0x94, (byte)0x8D, (byte)0x94, (byte)0xAC,\n+        (byte)0x94, (byte)0xAE, (byte)0x96, (byte)0x6A,\n+        (byte)0x96, (byte)0xCB, (byte)0x97, (byte)0x89,\n+        (byte)0x98, (byte)0x58, (byte)0x9B, (byte)0xA0,\n+        (byte)0x9D, (byte)0xB7, (byte)0x9E, (byte)0x94,\n+        (byte)0xE3, (byte)0x79, (byte)0xE4, (byte)0x45,\n+        (byte)0xE8, (byte)0xF6, (byte)0xFA, (byte)0x55,\n+        (byte)0xFA, (byte)0x59,\n+    };\n+\n+    private static final String strIBM943c2b1 =\n+        \"\\u2015\\uFF5E\\u2225\\uFF0D\\u555E\\u7130\\u9DD7\\u5699\" +\n+        \"\\u4FE0\\u8EC0\\u7E6B\\u8346\\u9E7C\\u9EB4\\u6805\\u5C62\" +\n+        \"\\u7E61\\u8523\\u91AC\\u87EC\\u6414\\u7626\\u9A52\\u7C1E\" +\n+        \"\\u6451\\u5861\\u985A\\u79B1\\u7006\\u56CA\\u525D\\u6F51\" +\n+        \"\\u91B1\\u9830\\u9EB5\\u840A\\u881F\\u5C5B\\u6522\\u688E\" +\n+        \"\\u7E48\\u8141\\u9839\\uFFE4\\uF86F\";\n+\n+    private static final String strIBM943c2b2 =\n+        \"\\u2014\\u301C\\u2016\\u2212\\u5516\\u7114\\u9D0E\\u565B\" +\n+        \"\\u4FA0\\u8EAF\\u7E4B\\u834A\\u9E78\\u9EB9\\u67F5\\u5C61\" +\n+        \"\\u7E4D\\u848B\\u91A4\\u8749\\u63BB\\u75E9\\u9A28\\u7BAA\" +\n+        \"\\u63B4\\u586B\\u985B\\u7977\\u6D9C\\u56A2\\u5265\\u6E8C\" +\n+        \"\\u9197\\u982C\\u9EBA\\u83B1\\u874B\\u5C4F\\u6505\\u688D\" +\n+        \"\\u7E66\\u80FC\\u983D\\u00A6\\u2116\";\n+\n+    private static void bug8235834 () throws Exception {\n+        \/\/ 8235834 affects IBM-943 and IBM-943C encoder.\n+        \/\/ The decoded results of the corresponding characters of IBM-943\n+        \/\/ and IBM-943C is the same.\n+        for (String csName : new String[] {\"x-IBM943\", \"x-IBM943C\"}) {\n+            Charset cs = Charset.forName(csName);\n+            if (!Arrays.equals(byteIBM943c2b, strIBM943c2b1.getBytes(cs))) {\n+                throw new Exception(csName+\" failed to encode\");\n+            }\n+            if (!strIBM943c2b2.equals(new String(byteIBM943c2b, cs))) {\n+                throw new Exception(csName+\" failed to round-trip conversion\");\n+            }\n+        }\n+    }\n+\n@@ -185,0 +392,5 @@\n+        bug8202329();\n+        bug8212794();\n+        bug8213618();\n+        bug8220281();\n+        bug8235834();\n","filename":"jdk\/test\/sun\/nio\/cs\/TestIBMBugs.java","additions":215,"deletions":3,"binary":false,"changes":218,"status":"modified"}]}