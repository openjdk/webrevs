{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,2 +36,0 @@\n-import java.security.AccessController;\n-import java.security.PrivilegedAction;\n@@ -66,0 +64,13 @@\n+                InputStream JREdata = Currency.class.getModule().getResourceAsStream(\"java\/util\/currency.data\");\n+                DataInputStream dis = new DataInputStream(JREdata);\n+                int magic = dis.readInt();\n+                if (magic != 0x43757244) {\n+                    throw new RuntimeException(\"The magic number in the JRE's currency data is incorrect.  Expected: 0x43757244, Got: 0x\"+magic);\n+                }\n+                int fileVerNumber = dis.readInt();\n+                int dataVerNumber = dis.readInt();\n+                if (Integer.parseInt(fileVersion) != fileVerNumber ||\n+                        Integer.parseInt(dataVersion) != dataVerNumber) {\n+                    throw new RuntimeException(\"Test data and JRE's currency data are inconsistent.  test: (file: \"+fileVersion+\" data: \"+dataVersion+\"), JRE: (file: \"+fileVerNumber+\" data: \"+dataVerNumber+\")\");\n+                }\n+                System.out.println(\"test: (file: \"+fileVersion+\" data: \"+dataVersion+\"), JRE: (file: \"+fileVerNumber+\" data: \"+dataVerNumber+\")\");\n@@ -67,1 +78,2 @@\n-                throw new RuntimeException(ioe);\n+                throw new RuntimeException(\n+                        \"CheckDataVersion was not set up properly: \" + ioe);\n@@ -69,24 +81,0 @@\n-\n-            AccessController.doPrivileged(new PrivilegedAction<Object>() {\n-                public Object run() {\n-                    try {\n-                        InputStream in = Currency.class.getModule().getResourceAsStream(\"java\/util\/currency.data\");\n-                        String sep = File.separator;\n-                        DataInputStream dis = new DataInputStream(in);\n-                        int magic = dis.readInt();\n-                        if (magic != 0x43757244) {\n-                            throw new RuntimeException(\"The magic number in the JRE's currency data is incorrect.  Expected: 0x43757244, Got: 0x\"+magic);\n-                        }\n-                        int fileVerNumber = dis.readInt();\n-                        int dataVerNumber = dis.readInt();\n-                        if (Integer.parseInt(fileVersion) != fileVerNumber ||\n-                            Integer.parseInt(dataVersion) != dataVerNumber) {\n-                            throw new RuntimeException(\"Test data and JRE's currency data are inconsistent.  test: (file: \"+fileVersion+\" data: \"+dataVersion+\"), JRE: (file: \"+fileVerNumber+\" data: \"+dataVerNumber+\")\");\n-                        }\n-System.out.println(\"test: (file: \"+fileVersion+\" data: \"+dataVersion+\"), JRE: (file: \"+fileVerNumber+\" data: \"+dataVerNumber+\")\");\n-                    } catch (IOException ioe) {\n-                        throw new RuntimeException(ioe);\n-                    }\n-                    return null;\n-                }\n-            });\n","filename":"test\/jdk\/java\/util\/Currency\/CheckDataVersion.java","additions":16,"deletions":28,"binary":false,"changes":44,"status":"modified"}]}