{"files":[{"patch":"@@ -1464,1 +1464,2 @@\n-                                        Register tmp4, BasicType eltype)\n+                                        Register tmp4, Register tmp5, Register tmp6,\n+                                        BasicType eltype)\n@@ -1466,3 +1467,1 @@\n-  const Register tmp5 = t0;\n-  const Register tmp6 = t1;\n-  assert_different_registers(ary, cnt, result, tmp1, tmp2, tmp3, tmp4, tmp5, tmp6);\n+  assert_different_registers(ary, cnt, result, tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, t0, t1);\n@@ -1484,4 +1483,4 @@\n-  const Register pow31_3_4 = tmp1;\n-  const Register pow31_3   = tmp2;\n-  const Register pow31_2   = tmp3;\n-  const Register chunks    = tmp4;\n+  const Register pow31_4 = tmp1;\n+  const Register pow31_3 = tmp2;\n+  const Register pow31_2 = tmp3;\n+  const Register chunks  = tmp4;\n@@ -1496,1 +1495,1 @@\n-  mv(pow31_2, 961); \/\/ [31^^2]\n+  addiw(pow31_2, zr, 961); \/\/ [31^^2]\n@@ -1515,3 +1514,3 @@\n-  ld(pow31_3_4, ExternalAddress(StubRoutines::riscv::arrays_hashcode_powers_of_31()\n-                                + 0 * sizeof(jint))); \/\/ [31^^3:31^^4]\n-  srli(pow31_3, pow31_3_4, 32);\n+  ld(pow31_4, ExternalAddress(StubRoutines::riscv::arrays_hashcode_powers_of_31()\n+                              + 0 * sizeof(jint))); \/\/ [31^^3:31^^4]\n+  srli(pow31_3, pow31_4, 32);\n@@ -1520,7 +1519,3 @@\n-  mulw(result, result, pow31_3_4); \/\/ 31^^4 * h\n-  DO_ELEMENT_LOAD(tmp5, 0);\n-  mulw(tmp5, tmp5, pow31_3);       \/\/ 31^^3 * ary[i+0]\n-  addw(result, result, tmp5);\n-  DO_ELEMENT_LOAD(tmp5, 1);\n-  mulw(tmp5, tmp5, pow31_2);       \/\/ 31^^2 * ary[i+1]\n-  addw(result, result, tmp5);\n+  mulw(result, result, pow31_4); \/\/ 31^^4 * h\n+  DO_ELEMENT_LOAD(t0,   0);\n+  DO_ELEMENT_LOAD(t1,   1);\n@@ -1528,2 +1523,10 @@\n-  slli(tmp6, tmp5, 5);             \/\/ optimize 31^^1 * ary[i+2]\n-  subw(tmp5, tmp6, tmp5);          \/\/ with ary[i+2]<<5 - ary[i+2]\n+  DO_ELEMENT_LOAD(tmp6, 3);\n+\n+  mulw(t0, t0, pow31_3);         \/\/ 31^^3 * ary[i+0]\n+  addw(result, result, t0);\n+\n+  mulw(t1, t1, pow31_2);         \/\/ 31^^2 * ary[i+1]\n+  addw(result, result, t1);\n+\n+  slli(t0, tmp5, 5);             \/\/ optimize 31^^1 * ary[i+2]\n+  subw(tmp5, t0, tmp5);          \/\/ with ary[i+2]<<5 - ary[i+2]\n@@ -1531,3 +1534,3 @@\n-  DO_ELEMENT_LOAD(tmp5, 3);\n-  addw(result, result, tmp5);      \/\/ 31^^4 * h + 31^^3 * ary[i+0] + 31^^2 * ary[i+1]\n-                                   \/\/           + 31^^1 * ary[i+2] + 31^^0 * ary[i+3]\n+\n+  addw(result, result, tmp6);    \/\/ 31^^4 * h + 31^^3 * ary[i+0] + 31^^2 * ary[i+1]\n+                                 \/\/           + 31^^1 * ary[i+2] + 31^^0 * ary[i+3]\n@@ -1543,4 +1546,4 @@\n-  DO_ELEMENT_LOAD(tmp5, 0)\n-  slli(tmp6, result, 5);           \/\/ optimize 31 * result\n-  subw(result, tmp6, result);      \/\/ with result<<5 - result\n-  addw(result, result, tmp5);\n+  DO_ELEMENT_LOAD(t0, 0)\n+  slli(t1, result, 5);           \/\/ optimize 31 * result\n+  subw(result, t1, result);      \/\/ with result<<5 - result\n+  addw(result, result, t0);\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.cpp","additions":31,"deletions":28,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -83,1 +83,3 @@\n-                       Register tmp3, Register tmp4, BasicType eltype);\n+                       Register tmp3, Register tmp4,\n+                       Register tmp5, Register tmp6,\n+                       BasicType eltype);\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.hpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -10308,1 +10308,2 @@\n-                         iRegLNoSp tmp3, iRegLNoSp tmp4, rFlagsReg cr)\n+                         iRegLNoSp tmp3, iRegLNoSp tmp4,\n+                         iRegLNoSp tmp5, iRegLNoSp tmp6, rFlagsReg cr)\n@@ -10311,1 +10312,1 @@\n-  effect(TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4,\n+  effect(TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6,\n@@ -10317,1 +10318,2 @@\n-                       $tmp1$$Register, $tmp2$$Register, $tmp3$$Register, $tmp4$$Register,\n+                       $tmp1$$Register, $tmp2$$Register, $tmp3$$Register,\n+                       $tmp4$$Register, $tmp5$$Register, $tmp6$$Register,\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}