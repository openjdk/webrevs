{"files":[{"patch":"@@ -1495,2 +1495,1 @@\n-  addiw(pow31_2, zr, 961); \/\/ [31^^2]\n-\n+  addiw(pow31_2, zr, 961);       \/\/ [31^^2]\n@@ -1502,12 +1501,1 @@\n-  andi(cnt, cnt, stride-1); \/\/ don't forget about tail!\n-\n-#define DO_ELEMENT_LOAD(reg, idx) \\\n-  switch (eltype) { \\\n-  case T_BOOLEAN: lbu(reg, Address(ary, idx * elsize)); break; \\\n-  case T_CHAR:    lhu(reg, Address(ary, idx * elsize)); break; \\\n-  case T_BYTE:     lb(reg, Address(ary, idx * elsize)); break; \\\n-  case T_SHORT:    lh(reg, Address(ary, idx * elsize)); break; \\\n-  case T_INT:      lw(reg, Address(ary, idx * elsize)); break; \\\n-  default:                               ShouldNotReachHere(); \\\n-  } \\\n-\n+  andi(cnt, cnt, stride-1);      \/\/ don't forget about tail!\n@@ -1520,5 +1508,4 @@\n-  DO_ELEMENT_LOAD(t0,   0);\n-  DO_ELEMENT_LOAD(t1,   1);\n-  DO_ELEMENT_LOAD(tmp5, 2);\n-  DO_ELEMENT_LOAD(tmp6, 3);\n-\n+  arrays_hashcode_elload(t0,   Address(ary, 0 * elsize), eltype);\n+  arrays_hashcode_elload(t1,   Address(ary, 1 * elsize), eltype);\n+  arrays_hashcode_elload(tmp5, Address(ary, 2 * elsize), eltype);\n+  arrays_hashcode_elload(tmp6, Address(ary, 3 * elsize), eltype);\n@@ -1527,1 +1514,0 @@\n-\n@@ -1530,1 +1516,0 @@\n-\n@@ -1534,1 +1519,0 @@\n-\n@@ -1546,1 +1530,1 @@\n-  DO_ELEMENT_LOAD(t0, 0)\n+  arrays_hashcode_elload(t0, Address(ary), eltype);\n@@ -1553,2 +1537,0 @@\n-#undef DO_ELEMENT_LOAD\n-\n@@ -1572,0 +1554,13 @@\n+void C2_MacroAssembler::arrays_hashcode_elload(Register dst, Address src, BasicType eltype) {\n+  switch (eltype) {\n+  \/\/ T_BOOLEAN used as surrogate for unsigned byte\n+  case T_BOOLEAN: lbu(dst, src);   break;\n+  case T_BYTE:     lb(dst, src);   break;\n+  case T_SHORT:    lh(dst, src);   break;\n+  case T_CHAR:    lhu(dst, src);   break;\n+  case T_INT:      lw(dst, src);   break;\n+  default:\n+    ShouldNotReachHere();\n+  }\n+}\n+\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.cpp","additions":20,"deletions":25,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -88,0 +88,1 @@\n+  void arrays_hashcode_elload(Register dst, Address src, BasicType eltype);\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}