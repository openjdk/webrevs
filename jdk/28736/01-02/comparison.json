{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,0 +34,2 @@\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n@@ -46,2 +48,38 @@\n-        String regex = \"Average bucket size     :     ([0-9]+\\\\.[0-9]+).*\";\n-        String s = output.firstMatch(regex, 1);\n+        \/* [1] There may be other table stats that precede the symbol tabble.\n+               Skip all thse until we find this:\n+\n+           [0.677s][info][aot,hashtables] Shared symbol table stats -------- base: 0x0000000800000000\n+           [0.677s][info][aot,hashtables] Number of entries       :     46244\n+           [0.677s][info][aot,hashtables] Total bytes used        :    393792\n+           [0.677s][info][aot,hashtables] Average bytes per entry :     8.516\n+           [0.677s][info][aot,hashtables] Average bucket size     :     7.734\n+           [0.677s][info][aot,hashtables] Variance of bucket size :     7.513\n+           [0.677s][info][aot,hashtables] Std. dev. of bucket size:     2.741\n+           [0.677s][info][aot,hashtables] Maximum bucket size     :        20\n+           [0.677s][info][aot,hashtables] Empty buckets           :         2\n+           [0.677s][info][aot,hashtables] Value_Only buckets      :        24\n+           [0.677s][info][aot,hashtables] Other buckets           :      5953\n+           ....\n+        *\/\n+        Pattern pattern0 = Pattern.compile(\"Shared symbol table stats.*\", Pattern.DOTALL);\n+        Matcher matcher0 = pattern0.matcher(output.getStdout());\n+        String stat = null;\n+        if (matcher0.find()) {\n+            stat = matcher0.group(0);\n+        }\n+        if (stat == null) {\n+            throw new Exception(\"FAILED: pattern \\\"\" + pattern0 + \"\\\" not found\");\n+        }\n+\n+        \/* (2) The first \"Average bucket size\" line in the remaining output is for the\n+               shared symbol table *\/\n+        Pattern pattern = Pattern.compile(\"Average bucket size *: *([0-9]+\\\\.[0-9]+).*\", Pattern.MULTILINE);\n+        Matcher matcher = pattern.matcher(stat);\n+        String s = null;\n+        if (matcher.find()) {\n+            s = matcher.group(1);\n+        }\n+        if (s == null) {\n+            throw new Exception(\"FAILED: pattern \\\"\" + pattern + \"\\\" not found\");\n+        }\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/SharedSymbolTableBucketSize.java","additions":41,"deletions":3,"binary":false,"changes":44,"status":"modified"}]}