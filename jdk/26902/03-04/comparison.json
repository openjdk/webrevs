{"files":[{"patch":"@@ -37,0 +37,89 @@\n+\/\/ Support for printing properties\n+class PrintProperties\n+{\n+private:\n+  IdealGraphPrinter* _printer;\n+\n+public:\n+  PrintProperties(IdealGraphPrinter* printer) : _printer(printer) {}\n+  void print_node_properties(Node* node, Compile* C);\n+  void print_lrg_properties(const LRG &lrg, const char* buffer);\n+  void print_property(int flag, const char* name);\n+  void print_property(int flag, const char* name, const char* val);\n+  void print_property(int flag, const char* name, int val);\n+};\n+\n+void PrintProperties::print_node_properties(Node* node, Compile* C) {\n+  const jushort flags = node->flags();\n+  print_property((flags & Node::Flag_is_Copy), \"is_copy\");\n+  print_property((flags & Node::Flag_rematerialize), \"rematerialize\");\n+  print_property((flags & Node::Flag_needs_anti_dependence_check), \"needs_anti_dependence_check\");\n+  print_property((flags & Node::Flag_is_macro), \"is_macro\");\n+  print_property((flags & Node::Flag_is_Con), \"is_con\");\n+  print_property((flags & Node::Flag_is_cisc_alternate), \"is_cisc_alternate\");\n+  print_property((flags & Node::Flag_is_dead_loop_safe), \"is_dead_loop_safe\");\n+  print_property((flags & Node::Flag_may_be_short_branch), \"may_be_short_branch\");\n+  print_property((flags & Node::Flag_has_call), \"has_call\");\n+  print_property((flags & Node::Flag_has_swapped_edges), \"has_swapped_edges\");\n+  if (C->matcher() != nullptr) {\n+    print_property(C->matcher()->is_shared(node),\"is_shared\");\n+    print_property(!(C->matcher()->is_shared(node)), \"is_shared\", IdealGraphPrinter::FALSE_VALUE);\n+    print_property(C->matcher()->is_dontcare(node), \"is_dontcare\");\n+    print_property(!(C->matcher()->is_dontcare(node)),\"is_dontcare\", IdealGraphPrinter::FALSE_VALUE);\n+    Node* old = C->matcher()->find_old_node(node);\n+    if (old != nullptr) {\n+      print_property(true, \"old_node_idx\", C->matcher()->find_old_node(node)->_idx);\n+    }\n+  }\n+}\n+\n+void PrintProperties::print_lrg_properties(const LRG &lrg, const char *buffer) {\n+  print_property(true, \"mask\", buffer);\n+  print_property(true, \"mask_size\", lrg.mask_size());\n+  if (lrg._degree_valid) {\n+    print_property(lrg._degree_valid, \"degree\", lrg.degree());\n+  }\n+  print_property(true, \"num_regs\", lrg.num_regs());\n+  print_property(true, \"reg_pressure\", lrg.reg_pressure());\n+  print_property(true, \"cost\", lrg._cost);\n+  print_property(true, \"area\", lrg._area);\n+  print_property(true, \"score\", lrg.score());\n+  print_property((lrg._risk_bias != 0), \"risk_bias\", lrg._risk_bias);\n+  print_property((lrg._copy_bias != 0), \"copy_bias\", lrg._copy_bias);\n+  print_property(lrg.is_singledef(), \"is_singledef\");\n+  print_property(lrg.is_multidef(), \"is_multidef\");\n+  print_property(lrg._is_oop, \"is_oop\");\n+  print_property(lrg._is_float, \"is_float\");\n+  print_property(lrg._is_vector, \"is_vector\");\n+  print_property(lrg._is_predicate, \"is_predicate\");\n+  print_property(lrg._is_scalable, \"is_scalable\");\n+  print_property(lrg._was_spilled1, \"was_spilled1\");\n+  print_property(lrg._was_spilled2, \"was_spilled2\");\n+  print_property(lrg._direct_conflict, \"direct_conflict\");\n+  print_property(lrg._fat_proj, \"fat_proj\");\n+  print_property(lrg._was_lo, \"_was_lo\");\n+  print_property(lrg._has_copy, \"has_copy\");\n+  print_property(lrg._at_risk, \"at_risk\");\n+  print_property(lrg._must_spill, \"must_spill\");\n+  print_property(lrg._is_bound, \"is_bound\");\n+  print_property((lrg._msize_valid && lrg._degree_valid && lrg.lo_degree()), \"trivial\");\n+}\n+\n+void PrintProperties::print_property(int flag, const char* name) {\n+  if (flag != 0) {\n+    _printer->print_prop(name, IdealGraphPrinter::TRUE_VALUE);\n+  }\n+}\n+\n+void PrintProperties::print_property(int flag, const char* name, const char* val) {\n+  if (flag != 0) {\n+    _printer->print_prop(name, val);\n+  }\n+}\n+\n+void PrintProperties::print_property(int flag, const char* name, int val) {\n+  if (flag != 0) {\n+    _printer->print_prop(name, val);\n+  }\n+}\n+\n@@ -1139,72 +1228,0 @@\n-void PrintProperties::print_node_properties(Node* node, Compile* C) {\n-  const jushort flags = node->flags();\n-  print_property((flags & Node::Flag_is_Copy), \"is_copy\");\n-  print_property((flags & Node::Flag_rematerialize), \"rematerialize\");\n-  print_property((flags & Node::Flag_needs_anti_dependence_check), \"needs_anti_dependence_check\");\n-  print_property((flags & Node::Flag_is_macro), \"is_macro\");\n-  print_property((flags & Node::Flag_is_Con), \"is_con\");\n-  print_property((flags & Node::Flag_is_cisc_alternate), \"is_cisc_alternate\");\n-  print_property((flags & Node::Flag_is_dead_loop_safe), \"is_dead_loop_safe\");\n-  print_property((flags & Node::Flag_may_be_short_branch), \"may_be_short_branch\");\n-  print_property((flags & Node::Flag_has_call), \"has_call\");\n-  print_property((flags & Node::Flag_has_swapped_edges), \"has_swapped_edges\");\n-  if (C->matcher() != nullptr) {\n-    print_property(C->matcher()->is_shared(node),\"is_shared\");\n-    print_property(!(C->matcher()->is_shared(node)), \"is_shared\", IdealGraphPrinter::FALSE_VALUE);\n-    print_property(C->matcher()->is_dontcare(node), \"is_dontcare\");\n-    print_property(!(C->matcher()->is_dontcare(node)),\"is_dontcare\", IdealGraphPrinter::FALSE_VALUE);\n-    Node* old = C->matcher()->find_old_node(node);\n-    if (old != nullptr) {\n-      print_property(true, \"old_node_idx\", C->matcher()->find_old_node(node)->_idx);\n-    }\n-  }\n-}\n-\n-void PrintProperties::print_lrg_properties(const LRG &lrg, const char *buffer) {\n-  print_property(true, \"mask\", buffer);\n-  print_property(true, \"mask_size\", lrg.mask_size());\n-  print_property(lrg._degree_valid, \"degree\", lrg.degree());\n-  print_property(true, \"num_regs\", lrg.num_regs());\n-  print_property(true, \"reg_pressure\", lrg.reg_pressure());\n-  print_property(true, \"cost\", lrg._cost);\n-  print_property(true, \"area\", lrg._area);\n-  print_property(true, \"score\", lrg.score());\n-  print_property((lrg._risk_bias != 0), \"risk_bias\", lrg._risk_bias);\n-  print_property((lrg._copy_bias != 0), \"copy_bias\", lrg._copy_bias);\n-  print_property(lrg.is_singledef(), \"is_singledef\");\n-  print_property(lrg.is_multidef(), \"is_multidef\");\n-  print_property(lrg._is_oop, \"is_oop\");\n-  print_property(lrg._is_float, \"is_float\");\n-  print_property(lrg._is_vector, \"is_vector\");\n-  print_property(lrg._is_predicate, \"is_predicate\");\n-  print_property(lrg._is_scalable, \"is_scalable\");\n-  print_property(lrg._was_spilled1, \"was_spilled1\");\n-  print_property(lrg._was_spilled2, \"was_spilled2\");\n-  print_property(lrg._direct_conflict, \"direct_conflict\");\n-  print_property(lrg._fat_proj, \"fat_proj\");\n-  print_property(lrg._was_lo, \"_was_lo\");\n-  print_property(lrg._has_copy, \"has_copy\");\n-  print_property(lrg._at_risk, \"at_risk\");\n-  print_property(lrg._must_spill, \"must_spill\");\n-  print_property(lrg._is_bound, \"is_bound\");\n-  print_property((lrg._msize_valid && lrg._degree_valid && lrg.lo_degree()), \"trivial\");\n-}\n-\n-void PrintProperties::print_property(int flag, const char* name) {\n-  if (flag != 0) {\n-    _printer->print_prop(name, IdealGraphPrinter::TRUE_VALUE);\n-  }\n-}\n-\n-void PrintProperties::print_property(int flag, const char* name, const char* val) {\n-  if (flag != 0) {\n-    _printer->print_prop(name, val);\n-  }\n-}\n-\n-void PrintProperties::print_property(int flag, const char* name, int val) {\n-  if (flag != 0) {\n-    _printer->print_prop(name, val);\n-  }\n-}\n-\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":89,"deletions":72,"binary":false,"changes":161,"status":"modified"},{"patch":"@@ -46,1 +46,0 @@\n-class PrintProperties;\n@@ -175,14 +174,0 @@\n-class PrintProperties\n-{\n-private:\n-  IdealGraphPrinter* _printer;\n-\n-public:\n-  PrintProperties(IdealGraphPrinter* printer) : _printer(printer) {}\n-  void print_node_properties(Node* node, Compile* C);\n-  void print_lrg_properties(const LRG &lrg, const char* buffer);\n-  void print_property(int flag, const char* name);\n-  void print_property(int flag, const char* name, const char* val);\n-  void print_property(int flag, const char* name, int val);\n-};\n-\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.hpp","additions":0,"deletions":15,"binary":false,"changes":15,"status":"modified"}]}