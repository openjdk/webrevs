{"files":[{"patch":"@@ -353,0 +353,1 @@\n+    SETBCR_OPCODE = (31u << OPCODE_SHIFT | 416u << 1),\n@@ -1783,0 +1784,2 @@\n+  inline void setbcr( Register d, int biint);\n+  inline void setbcr( Register d, ConditionRegister cr, Condition cc);\n","filename":"src\/hotspot\/cpu\/ppc\/assembler_ppc.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -422,0 +422,5 @@\n+inline void Assembler::setbcr(Register d, int biint)\n+                                                   { emit_int32(SETBCR_OPCODE | rt(d) | bi(biint)); }\n+inline void Assembler::setbcr(Register d, ConditionRegister cr, Condition cc) {\n+   setbcr(d, bi0(cr, cc));\n+ }\n","filename":"src\/hotspot\/cpu\/ppc\/assembler_ppc.inline.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"asm\/assembler.inline.hpp\"\n@@ -345,0 +346,21 @@\n+\/\/ Branch-free implementation to convert !0 to false\n+\/\/ Set register dst to true if dst is non zero using temp for calculations on Power Version<10.\n+\/\/ Set register dst to true if dst is non zero for Power 10 and above machines.\n+void MacroAssembler::normalize_bool(Register dst, Register temp, bool use_64bit) {\n+\n+  if (VM_Version::has_brw()) {\n+    if(use_64bit)\n+      cmpdi(CCR0, dst, 0);\n+    else\n+      cmpwi(CCR0, dst, 0);\n+    setbcr(dst, CCR0, Assembler::zero);\n+  }\n+  else {\n+    neg(temp, dst);\n+    orr(temp, dst, temp);\n+    if(use_64bit)\n+      srdi(dst, temp, 63);\n+    else\n+      srwi(dst, temp, 31);\n+    }\n+}\n@@ -2386,3 +2408,1 @@\n-  neg(R0, result);\n-  orr(result, result, R0);\n-  srdi(result, result, 63);\n+  normalize_bool(result, R0, true);\n","filename":"src\/hotspot\/cpu\/ppc\/macroAssembler_ppc.cpp","additions":23,"deletions":3,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -297,0 +297,2 @@\n+  \/\/ Branch-free implementation to convert !0 to false.\n+  void normalize_bool(Register dst, Register src, bool use_64bit);\n","filename":"src\/hotspot\/cpu\/ppc\/macroAssembler_ppc.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2475,5 +2475,1 @@\n-      Label skip_modify;\n-      __ cmpwi(CCR0, R3_RET, 0);\n-      __ beq(CCR0, skip_modify);\n-      __ li(R3_RET, 1);\n-      __ bind(skip_modify);\n+      __ normalize_bool(R3_RET, R0, false);\n","filename":"src\/hotspot\/cpu\/ppc\/sharedRuntime_ppc.cpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -375,3 +375,1 @@\n-    __ neg(R0, R3_RET);\n-    __ orr(R0, R3_RET, R0);\n-    __ srwi(R3_RET, R0, 31);\n+    __ normalize_bool(R3_RET, R0, false);\n","filename":"src\/hotspot\/cpu\/ppc\/templateInterpreterGenerator_ppc.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}