{"files":[{"patch":"@@ -33,0 +33,2 @@\n+import java.awt.AWTException;\n+import java.awt.Point;\n@@ -50,1 +52,3 @@\n-    private static String lafName;\n+    private static String lafName, cb1Str, cb2Str;\n+    private static Point cb1Point, cb2Point;\n+    private static int cb1Width, cb1Height, cb2Width, cb2Height;\n@@ -55,2 +59,1 @@\n-    public static void main(String[] args) throws InterruptedException, InvocationTargetException {\n-        try {\n+    public static void main(String[] args) throws InterruptedException, InvocationTargetException, AWTException {\n@@ -62,23 +65,15 @@\n-                lafName = laf.getName().equals(\"CDE\/Motif\") ? \"Motif\" : laf.getName();\n-                SwingUtilities.invokeAndWait(() -> {\n-                    setLookAndFeel(laf);\n-                    panel = new JPanel();\n-                    String[] comboStrings = {\"One\", \"Two\", \"Three\"};\n-                    cb1 = new JComboBox(comboStrings);\n-                    cb1.setEditable(true);\n-                    cb1.setBorder(BorderFactory.createTitledBorder(\n-                            \"Editable JComboBox\"));\n-\n-                    cb2 = new JComboBox(comboStrings);\n-                    cb2.setEditable(true);\n-\n-                    panel.add(cb1);\n-                    panel.add(cb2);\n-\n-                    frame = new JFrame();\n-                    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n-                    frame.add(panel);\n-                    frame.pack();\n-                    frame.setLocationRelativeTo(null);\n-                    frame.setVisible(true);\n-                });\n+            lafName = laf.getName();\n+            SwingUtilities.invokeAndWait(() -> {\n+                setLookAndFeel(laf);\n+                panel = new JPanel();\n+                String[] comboStrings = {\"One\", \"Two\", \"Three\"};\n+                cb1 = new JComboBox(comboStrings);\n+                cb1.setEditable(true);\n+                cb1.setBorder(BorderFactory.createTitledBorder(\n+                        \"Editable JComboBox\"));\n+\n+                cb2 = new JComboBox(comboStrings);\n+                cb2.setEditable(true);\n+\n+                panel.add(cb1);\n+                panel.add(cb2);\n@@ -91,2 +86,24 @@\n-                runTestOnComboBox(cb1);\n-                runTestOnComboBox(cb2);\n+                frame = new JFrame();\n+                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n+                frame.add(panel);\n+                frame.pack();\n+                frame.setLocationRelativeTo(null);\n+                frame.setVisible(true);\n+\n+                cb1Point = cb1.getLocationOnScreen();\n+                cb1Width = cb1.getWidth();\n+                cb1Height = cb1.getHeight();\n+                cb2Point = cb2.getLocationOnScreen();\n+                cb2Width = cb2.getWidth();\n+                cb2Height = cb2.getHeight();\n+            });\n+\n+            runTestOnComboBox(cb1Point, cb1Width, cb1Height);\n+            runTestOnComboBox(cb2Point, cb2Width, cb2Height);\n+\n+            SwingUtilities.invokeAndWait(() -> {\n+                cb1Str = cb1.getSelectedItem().toString();\n+                cb2Str = cb2.getSelectedItem().toString();\n+            });\n+\n+            checkSelection(cb1Str, cb2Str);\n@@ -94,5 +111,0 @@\n-                checkSelection(cb1, cb2);\n-            }\n-        } catch (Exception e) {\n-            e.printStackTrace();\n-        } finally {\n@@ -114,4 +126,2 @@\n-    private static void runTestOnComboBox(JComboBox cb) {\n-        robot.mouseMove(cb.getLocationOnScreen().x + cb.getWidth()\n-                - BUTTON_OFFSET, cb.getLocationOnScreen().y\n-                + POPUP_OFFSET);\n+    private static void runTestOnComboBox(Point p, int width, int height) {\n+        robot.mouseMove(p.x + width - BUTTON_OFFSET, p.y + POPUP_OFFSET);\n@@ -120,4 +130,2 @@\n-        robot.mouseMove(cb.getLocationOnScreen().x\n-                        + (cb.getWidth() \/ 2) - BUTTON_OFFSET,\n-                cb.getLocationOnScreen().y + cb.getHeight()\n-                        + POPUP_OFFSET);\n+        robot.mouseMove(p.x + (width \/ 2) - BUTTON_OFFSET,\n+                p.y + height + POPUP_OFFSET);\n@@ -128,4 +136,2 @@\n-    private static void checkSelection(JComboBox c1, JComboBox c2)\n-            throws InterruptedException, InvocationTargetException {\n-        if (c1.getSelectedItem().toString().equals(\"One\")\n-                && c2.getSelectedItem().toString().equals(\"One\")) {\n+    private static void checkSelection(String s1, String s2) {\n+        if (s1.equals(\"One\") && s2.equals(\"One\")) {\n@@ -133,1 +139,0 @@\n-            SwingUtilities.invokeAndWait(() -> frame.dispose());\n@@ -135,1 +140,0 @@\n-            SwingUtilities.invokeAndWait(() -> frame.dispose());\n@@ -139,1 +143,1 @@\n-}\n\\ No newline at end of file\n+}\n","filename":"test\/jdk\/javax\/swing\/JComboBox\/EditableComboBoxPopupPos.java","additions":52,"deletions":48,"binary":false,"changes":100,"status":"modified"}]}