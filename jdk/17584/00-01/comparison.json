{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -1257,0 +1257,18 @@\n+        Set<Long> brokenMechanisms = Set.of();\n+        if (P11Util.isNSS(token)) {\n+            CK_VERSION nssVersion = slotInfo.hardwareVersion;\n+            if (nssVersion.major < 3 ||\n+                    nssVersion.major == 3 && nssVersion.minor < 65) {\n+                \/\/ RSA-PSS is broken in NSS prior to 3.65\n+                brokenMechanisms = Set.of(CKM_RSA_PKCS_PSS,\n+                        CKM_SHA1_RSA_PKCS_PSS,\n+                        CKM_SHA224_RSA_PKCS_PSS,\n+                        CKM_SHA256_RSA_PKCS_PSS,\n+                        CKM_SHA384_RSA_PKCS_PSS,\n+                        CKM_SHA512_RSA_PKCS_PSS,\n+                        CKM_SHA3_224_RSA_PKCS_PSS,\n+                        CKM_SHA3_256_RSA_PKCS_PSS,\n+                        CKM_SHA3_384_RSA_PKCS_PSS,\n+                        CKM_SHA3_512_RSA_PKCS_PSS);\n+            }\n+        }\n@@ -1291,0 +1309,7 @@\n+            if (brokenMechanisms.contains(longMech)) {\n+                if (showInfo) {\n+                    System.out.println(\"DISABLED due to broken provider\");\n+                }\n+                continue;\n+            }\n+\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/SunPKCS11.java","additions":26,"deletions":1,"binary":false,"changes":27,"status":"modified"}]}