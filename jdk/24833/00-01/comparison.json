{"files":[{"patch":"@@ -33,0 +33,1 @@\n+import java.lang.reflect.InvocationTargetException;\n@@ -34,1 +35,0 @@\n-import java.util.concurrent.TimeUnit;\n@@ -62,1 +62,1 @@\n-        PassFailJFrame pfj = PassFailJFrame.builder()\n+        PassFailJFrame.builder()\n@@ -65,1 +65,1 @@\n-                .columns(40)\n+                .columns(35)\n@@ -67,21 +67,2 @@\n-                .build();\n-\n-        if (startLatch.await(2, TimeUnit.MINUTES)) {\n-            for (int i = 0; i < 10; i++) {\n-                int count = i;\n-                SwingUtilities.invokeAndWait(() -> monitor.setProgress(count));\n-                Thread.sleep(2000);\n-                SwingUtilities.invokeAndWait(() -> cancelled = monitor.isCanceled());\n-                if (cancelled) {\n-                    break;\n-                }\n-            }\n-\n-            if (cancelled) {\n-                PassFailJFrame.forcePass();\n-            } else {\n-                PassFailJFrame.forceFail(\"Test Failed! JProgress Monitor was not cancelled\");\n-            }\n-        }\n-\n-        pfj.awaitAndCheck();\n+                .build()\n+                .awaitAndCheck();\n@@ -90,1 +71,1 @@\n-     private static JPanel createTestUI() {\n+    private static JPanel createTestUI() {\n@@ -96,1 +77,22 @@\n-            startLatch.countDown();\n+\n+            new Thread(() -> {\n+                for (int i = 0; i < 10; i++) {\n+                    int count = i;\n+                    try {\n+                        SwingUtilities.invokeAndWait(() -> monitor.setProgress(count));\n+                        Thread.sleep(2000);\n+                        SwingUtilities.invokeAndWait(() -> cancelled = monitor.isCanceled());\n+                    } catch (InterruptedException | InvocationTargetException ex) {\n+                        throw new RuntimeException(ex);\n+                    }\n+                    if (cancelled) {\n+                        break;\n+                    }\n+                }\n+\n+                if (cancelled) {\n+                    PassFailJFrame.forcePass();\n+                } else {\n+                    PassFailJFrame.forceFail(\"Test Failed! JProgress Monitor was not cancelled\");\n+                }\n+            }).start();\n@@ -100,1 +102,1 @@\n-     }\n+    }\n","filename":"test\/jdk\/javax\/swing\/ProgressMonitor\/bug4401480.java","additions":29,"deletions":27,"binary":false,"changes":56,"status":"modified"}]}