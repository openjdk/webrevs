{"files":[{"patch":"@@ -36,10 +36,1 @@\n-\n-\/\/ distinguish old xlc and xlclang++, where\n-\/\/ <ibmdemangle.h> is suggested but not found in GA release (might come with a fix)\n-#if defined(__clang__)\n-#define DISABLE_DEMANGLE\n-\/\/ #include <ibmdemangle.h>\n-#else\n-#include <demangle.h>\n-#endif\n-\n+#include <cxxabi.h>\n@@ -247,2 +238,1 @@\n-      \/\/ If it is a C++ name, try and demangle it using the Demangle interface (see demangle.h).\n-#ifndef DISABLE_DEMANGLE\n+      \/\/ If it is a C++ name, try and demangle it using the __cxa_demangle interface(see demangle.h).\n@@ -250,7 +240,6 @@\n-        char* rest;\n-        Name* const name = Demangle(p_name, rest);\n-        if (name) {\n-          const char* const demangled_name = name->Text();\n-          if (demangled_name) {\n-            strncpy(p_name, demangled_name, namelen-1);\n-            p_name[namelen-1] = '\\0';\n+        int status;\n+        char *demangled_name = abi::__cxa_demangle(p_name, nullptr, nullptr, &status);\n+        if ((demangled_name != nullptr) && (status == 0)) {\n+          strncpy(p_name, demangled_name, namelen-1);\n+          p_name[namelen-1] = '\\0';\n+          ALLOW_C_FUNCTION(::free, ::free(demangled_name));\n@@ -258,1 +247,0 @@\n-          delete name;\n@@ -260,2 +248,0 @@\n-      }\n-#endif\n","filename":"src\/hotspot\/os\/aix\/porting_aix.cpp","additions":8,"deletions":22,"binary":false,"changes":30,"status":"modified"}]}