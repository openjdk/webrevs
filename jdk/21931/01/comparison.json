{"files":[{"patch":"@@ -318,31 +318,0 @@\n-size_t ArchiveBuilder::estimate_archive_size() {\n-  \/\/ size of the symbol table and two dictionaries, plus the RunTimeClassInfo's\n-  size_t symbol_table_est = SymbolTable::estimate_size_for_archive();\n-  size_t dictionary_est = SystemDictionaryShared::estimate_size_for_archive();\n-  _estimated_hashtable_bytes = symbol_table_est + dictionary_est;\n-\n-  if (CDSConfig::is_dumping_aot_linked_classes()) {\n-    \/\/ This is difficult to estimate when dumping the dynamic archive, as the\n-    \/\/ AOTLinkedClassTable may need to contain classes in the static archive as well.\n-    \/\/\n-    \/\/ Just give a generous estimate for now. We will remove estimate_archive_size()\n-    \/\/ in JDK-8340416\n-    _estimated_hashtable_bytes += 20 * 1024 * 1024;\n-  }\n-\n-  size_t total = 0;\n-\n-  total += _estimated_metaspaceobj_bytes;\n-  total += _estimated_hashtable_bytes;\n-\n-  \/\/ allow fragmentation at the end of each dump region\n-  total += _total_dump_regions * MetaspaceShared::core_region_alignment();\n-\n-  log_info(cds)(\"_estimated_hashtable_bytes = \" SIZE_FORMAT \" + \" SIZE_FORMAT \" = \" SIZE_FORMAT,\n-                symbol_table_est, dictionary_est, _estimated_hashtable_bytes);\n-  log_info(cds)(\"_estimated_metaspaceobj_bytes = \" SIZE_FORMAT, _estimated_metaspaceobj_bytes);\n-  log_info(cds)(\"total estimate bytes = \" SIZE_FORMAT, total);\n-\n-  return align_up(total, MetaspaceShared::core_region_alignment());\n-}\n-\n@@ -350,1 +319,1 @@\n-  size_t buffer_size = estimate_archive_size();\n+  size_t buffer_size = LP64_ONLY(CompressedClassSpaceSize) NOT_LP64(256 * M);\n","filename":"src\/hotspot\/share\/cds\/archiveBuilder.cpp","additions":1,"deletions":32,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -282,2 +282,0 @@\n-  size_t estimate_archive_size();\n-\n","filename":"src\/hotspot\/share\/cds\/archiveBuilder.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}