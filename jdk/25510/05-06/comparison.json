{"files":[{"patch":"@@ -87,1 +87,1 @@\n-                .run(PackageTest.Action.CREATE_AND_UNPACK);\n+                .run();\n@@ -91,0 +91,1 @@\n+        Path scriptOutputFile = TKit.workDir().resolve(name).toAbsolutePath();\n@@ -92,1 +93,1 @@\n-                                        String.format(\"echo \\\"%s\\\"\", name),\n+                                        String.format(\"touch \\\"%s\\\"\", scriptOutputFile.toString()),\n@@ -110,1 +111,1 @@\n-    private static void validateScript(boolean exists, Path scriptPath) {\n+    private static void validateScriptUnpacked(boolean exists, Path scriptPath) {\n@@ -113,4 +114,2 @@\n-            String output = Executor.of(scriptPath.toString())\n-                    .executeAndGetFirstLineOfOutput();\n-            TKit.assertNotEquals(scriptPath.getFileName(), output,\n-                    \"Check script output\");\n+            TKit.assertTrue(Files.isExecutable(scriptPath), String.format\n+                    (\"Check [%s] is executable\", scriptPath));\n@@ -122,0 +121,9 @@\n+    private static void validateScriptInstalled(boolean exists, String name) {\n+        Path scriptOutputFile = TKit.workDir().resolve(name).toAbsolutePath();\n+        if (exists) {\n+            TKit.assertFileExists(scriptOutputFile);\n+        } else {\n+            TKit.assertPathExists(scriptOutputFile, false);\n+        }\n+    }\n+\n@@ -123,3 +131,2 @@\n-        if (cmd.isPackageUnpacked()) {\n-            final var preinstall = isScriptExistsInResourceDir(cmd, \"preinstall\");\n-            final var postinstall = isScriptExistsInResourceDir(cmd, \"postinstall\");\n+        final var preinstall = isScriptExistsInResourceDir(cmd, \"preinstall\");\n+        final var postinstall = isScriptExistsInResourceDir(cmd, \"postinstall\");\n@@ -127,0 +134,1 @@\n+        if (cmd.isPackageUnpacked()) {\n@@ -139,2 +147,2 @@\n-                    validateScript(preinstall, preinstallPath);\n-                    validateScript(postinstall, postinstallPath);\n+                    validateScriptUnpacked(preinstall, preinstallPath);\n+                    validateScriptUnpacked(postinstall, postinstallPath);\n@@ -145,0 +153,3 @@\n+        } else {\n+            validateScriptInstalled(preinstall, \"preinstall\");\n+            validateScriptInstalled(postinstall, \"postinstall\");\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/PkgScriptsTest.java","additions":23,"deletions":12,"binary":false,"changes":35,"status":"modified"}]}