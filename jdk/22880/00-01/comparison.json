{"files":[{"patch":"@@ -849,1 +849,4 @@\n-  stop(\"Invalid CastII\");\n+  movl(rax, dst);\n+  movl(rcx, type->_lo);\n+  movl(rdx, type->_hi);\n+  hlt(); \/\/ hlt so we have the stack trace\n@@ -871,1 +874,4 @@\n-  stop(\"Invalid CastLL\");\n+  movq(rax, dst);\n+  mov64(rcx, type->_lo);\n+  mov64(rdx, type->_hi);\n+  hlt(); \/\/ hlt so we have the stack trace\n","filename":"src\/hotspot\/cpu\/x86\/c2_MacroAssembler_x86.cpp","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -6994,1 +6994,1 @@\n-  predicate(!VerifyConstraintCasts);\n+  predicate(VerifyConstraintCasts == 0);\n@@ -7006,1 +7006,1 @@\n-  predicate(VerifyConstraintCasts);\n+  predicate(VerifyConstraintCasts > 0);\n@@ -7019,1 +7019,1 @@\n-  predicate(!VerifyConstraintCasts);\n+  predicate(VerifyConstraintCasts == 0);\n@@ -7031,1 +7031,1 @@\n-  predicate(VerifyConstraintCasts);\n+  predicate(VerifyConstraintCasts > 0);\n","filename":"src\/hotspot\/cpu\/x86\/x86_64.ad","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -663,3 +663,9 @@\n-  develop(bool, VerifyConstraintCasts, false,                               \\\n-          \"perform runtime check to verify the value of a \"                 \\\n-          \"ConstraintCast lies inside its type\")                            \\\n+  develop(uint, VerifyConstraintCasts, 0,                                   \\\n+          \"Perform runtime checks to verify the value of a \"                \\\n+          \"ConstraintCast lies inside its type\"                             \\\n+          \"0=does not perform any verification, \"                           \\\n+          \"1=perform verification on ConstraintCastNodes that are present \" \\\n+          \"during code emission, \"                                          \\\n+          \"2=Do not do widening of ConstraintCastNodes so that we can \"     \\\n+          \"have more verification coverage\")                                \\\n+          range(0, 2)                                                       \\\n","filename":"src\/hotspot\/share\/opto\/c2_globals.hpp","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -529,1 +529,1 @@\n-  if (VerifyConstraintCasts) {\n+  if (VerifyConstraintCasts > 1) {\n","filename":"src\/hotspot\/share\/opto\/castnode.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,18 @@\n+\n+\/*\n+ * @test\n+ * @bug 8346836\n+ * @requires vm.debug == true & vm.flavor == \"server\"\n+ * @summary Run with -Xcomp to test -XX:VerifyConstraintCasts=1 in debug builds.\n+ *\n+ * @run main\/othervm\/timeout=300 -Xbatch -Xcomp -XX:VerifyConstraintCasts=1 compiler.c2.TestVerifyIterativeGVN\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8346836\n+ * @requires vm.debug == true & vm.flavor == \"server\"\n+ * @summary Run with -Xcomp to test -XX:VerifyConstraintCasts=2 in debug builds.\n+ *\n+ * @run main\/othervm\/timeout=300 -Xbatch -Xcomp -XX:VerifyConstraintCasts=2 compiler.c2.TestVerifyIterativeGVN\n+ *\/\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/TestVerifyIterativeGVN.java","additions":19,"deletions":1,"binary":false,"changes":20,"status":"modified"}]}