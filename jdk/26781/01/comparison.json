{"files":[{"patch":"@@ -879,0 +879,5 @@\n+                    \/\/ If the file exists, remove it from all entries in entriesInSF\n+                    for (var signed : entriesInSF.values()) {\n+                        signed.remove(name);\n+                    }\n+\n@@ -893,3 +898,0 @@\n-                        for (var signed : entriesInSF.values()) {\n-                            signed.remove(name);\n-                        }\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/security\/tools\/jarsigner\/Main.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8309841\n+ * @bug 8309841 8365559\n@@ -43,0 +43,2 @@\n+    private static final String WEAK_UNSIGNED\n+            = \"The jar will be treated as unsigned, because it is signed with a weak algorithm that is now disabled\";\n@@ -45,0 +47,5 @@\n+        t8309841();\n+        t8365559();\n+    }\n+\n+    static void t8309841() throws Exception {\n@@ -92,0 +99,8 @@\n+    }\n+\n+    static void t8365559() throws Exception {\n+        JarUtils.createJarFile(\n+                Path.of(\"c.jar\"),\n+                Path.of(\".\"),\n+                Files.writeString(Path.of(\"c\"), \"c\"));\n+        SecurityTools.keytool(\"-genkeypair -storepass changeit -keystore ks -alias w -dname CN=w -keyalg ec\");\n@@ -93,0 +108,12 @@\n+        \/\/ Sign the JAR using an already disabled signature algorithm SHA1withECDSA.\n+        \/\/ The file can still be signed but verification will treat it as unsigned.\n+        SecurityTools.jarsigner(\"-storepass changeit -keystore ks c.jar w -sigalg SHA1withECDSA\")\n+                        .shouldContain(\"the -sigalg option is considered a security risk and is disabled.\");\n+\n+        SecurityTools.jarsigner(\"-verify c.jar\")\n+                .shouldContain(WEAK_UNSIGNED)\n+                .shouldNotContain(NONEXISTENT_ENTRIES_FOUND);\n+        SecurityTools.jarsigner(\"-verify -verbose c.jar\")\n+                .shouldContain(WEAK_UNSIGNED)\n+                .shouldNotContain(NONEXISTENT_ENTRIES_FOUND)\n+                .shouldNotContain(\"Warning: nonexistent signed entries:\");\n","filename":"test\/jdk\/sun\/security\/tools\/jarsigner\/RemovedFiles.java","additions":29,"deletions":2,"binary":false,"changes":31,"status":"modified"}]}