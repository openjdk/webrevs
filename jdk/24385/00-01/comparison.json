{"files":[{"patch":"@@ -3068,0 +3068,4 @@\n+  if (ext_cpuid1_ecx.bits.lzcnt != 0)\n+    result |= CPU_LZCNT;\n+  if (ext_cpuid1_ecx.bits.prefetchw != 0)\n+    result |= CPU_3DNOW_PREFETCH;\n@@ -3086,0 +3090,2 @@\n+  if (sef_cpuid7_ebx.bits.clwb != 0)\n+    result |= CPU_CLWB;\n@@ -3091,1 +3097,1 @@\n-  \/\/ AMD|Hygon features.\n+  \/\/ AMD|Hygon additional features.\n@@ -3093,2 +3099,2 @@\n-    if ((ext_cpuid1_edx.bits.tdnow != 0) ||\n-        (ext_cpuid1_ecx.bits.prefetchw != 0))\n+    \/\/ PREFETCHW was checked above, check TDNOW here.\n+    if ((ext_cpuid1_edx.bits.tdnow != 0))\n@@ -3096,2 +3102,0 @@\n-    if (ext_cpuid1_ecx.bits.lzcnt != 0)\n-      result |= CPU_LZCNT;\n@@ -3100,2 +3104,0 @@\n-    if (sef_cpuid7_ebx.bits.clwb != 0)\n-      result |= CPU_CLWB;\n@@ -3104,1 +3106,1 @@\n-  \/\/ Intel features.\n+  \/\/ Intel additional features.\n@@ -3106,9 +3108,0 @@\n-    if (ext_cpuid1_ecx.bits.lzcnt != 0) {\n-      result |= CPU_LZCNT;\n-    }\n-    if (ext_cpuid1_ecx.bits.prefetchw != 0) {\n-      result |= CPU_3DNOW_PREFETCH;\n-    }\n-    if (sef_cpuid7_ebx.bits.clwb != 0) {\n-      result |= CPU_CLWB;\n-    }\n@@ -3117,1 +3110,0 @@\n-\n@@ -3122,1 +3114,1 @@\n-  \/\/ ZX features.\n+  \/\/ ZX additional features.\n@@ -3124,6 +3116,3 @@\n-    if (ext_cpuid1_ecx.bits.lzcnt != 0) {\n-      result |= CPU_LZCNT;\n-    }\n-    if (ext_cpuid1_ecx.bits.prefetchw != 0) {\n-      result |= CPU_3DNOW_PREFETCH;\n-    }\n+    \/\/ We do not know if these are supported by ZX,\n+    \/\/ so we cannot trust common CPUID bit for it.\n+    result &= ~CPU_CLWB;\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":14,"deletions":25,"binary":false,"changes":39,"status":"modified"}]}