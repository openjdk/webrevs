{"files":[{"patch":"@@ -432,1 +432,1 @@\n-\/\/ shared memory region for the given user name and vmid.\n+\/\/ shared memory region for the given user name and vmid\n@@ -434,1 +434,1 @@\n-\/\/ the caller is expected to free the allocated memory.\n+\/\/ the caller is expected to free the allocated memory\n@@ -599,9 +599,3 @@\n-    if (result == OS_ERR) {\n-      FREE_C_HEAP_ARRAY(char, filename);\n-      FREE_C_HEAP_ARRAY(char, usrdir_name);\n-      os::closedir(subdirp);\n-      continue;\n-    }\n-    \/\/ skip over files that are not regular files.\n-    if (!S_ISREG(statbuf.st_mode)) {\n-      FREE_C_HEAP_ARRAY(char, filename);\n+    FREE_C_HEAP_ARRAY(char, filename);\n+    \/\/ skip over files that are not regular files\n+    if (result == OS_ERR || !S_ISREG(statbuf.st_mode)) {\n@@ -612,1 +606,0 @@\n-    FREE_C_HEAP_ARRAY(char, filename);\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":5,"deletions":12,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -266,1 +266,1 @@\n-\/\/ shared memory region for the given user name and vmid.\n+\/\/ shared memory region for the given user name and vmid\n@@ -268,1 +268,1 @@\n-\/\/ the caller is expected to free the allocated memory.\n+\/\/ the caller is expected to free the allocated memory\n@@ -377,9 +377,4 @@\n-    if (::stat(filename, &statbuf) == OS_ERR) {\n-      FREE_C_HEAP_ARRAY(char, filename);\n-      FREE_C_HEAP_ARRAY(char, usrdir_name);\n-      os::closedir(subdirp);\n-      continue;\n-    }\n-    \/\/ skip over files that are not regular files.\n-    if ((statbuf.st_mode & S_IFMT) != S_IFREG) {\n-      FREE_C_HEAP_ARRAY(char, filename);\n+    const int stat_result = ::stat(filename, &statbuf);\n+    FREE_C_HEAP_ARRAY(char, filename);\n+    \/\/ skip over files that are not regular files\n+    if (stat_result == OS_ERR || (statbuf.st_mode & S_IFMT) != S_IFREG) {\n@@ -390,1 +385,0 @@\n-\n@@ -415,1 +409,0 @@\n-    FREE_C_HEAP_ARRAY(char, filename);\n","filename":"src\/hotspot\/os\/windows\/perfMemory_windows.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"}]}