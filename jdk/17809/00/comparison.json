{"files":[{"patch":"@@ -37,1 +37,0 @@\n-import javax.lang.model.element.ModuleElement;\n@@ -46,1 +45,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.Text;\n@@ -425,2 +423,7 @@\n-            ModuleElement mdle = utils.elementUtils.getModuleOf(typeElement);\n-            subnavLinks.add(getModuleLink(mdle, Text.of(mdle.getQualifiedName())));\n+            subnavLinks.add(getBreadcrumbLink(utils.elementUtils.getModuleOf(typeElement), false));\n+        }\n+        \/\/ We may generate a class-use page for an otherwise undocumented page in the condition below.\n+        boolean isUndocumented = options.noDeprecated() && utils.isDeprecated(typeElement);\n+        subnavLinks.add(getBreadcrumbLink(utils.containingPackage(typeElement), isUndocumented));\n+        if (!isUndocumented) {\n+            subnavLinks.add(getBreadcrumbLink(typeElement, true));\n@@ -428,6 +431,0 @@\n-        PackageElement pkg = utils.containingPackage(typeElement);\n-        subnavLinks.add(getPackageLink(pkg, getLocalizedPackageName(pkg)));\n-        subnavLinks.add(getLink(\n-                new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.PLAIN, typeElement)\n-                        .style(HtmlStyle.currentSelection)\n-                        .skipPreview(true)));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ClassUseWriter.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-import javax.lang.model.element.ModuleElement;\n@@ -457,2 +456,1 @@\n-            ModuleElement mdle = configuration.docEnv.getElementUtils().getModuleOf(typeElement);\n-            subnavLinks.add(getModuleLink(mdle, Text.of(mdle.getQualifiedName())));\n+            subnavLinks.add(getBreadcrumbLink(utils.elementUtils.getModuleOf(typeElement), false));\n@@ -460,5 +458,2 @@\n-        PackageElement pkg = utils.containingPackage(typeElement);\n-        subnavLinks.add(getPackageLink(pkg, getLocalizedPackageName(pkg)));\n-        subnavLinks.add(getLink(new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.PLAIN, typeElement)\n-                        .style(HtmlStyle.currentSelection)\n-                        .skipPreview(true)));\n+        subnavLinks.add(getBreadcrumbLink(utils.containingPackage(typeElement), false));\n+        subnavLinks.add(getBreadcrumbLink(typeElement, true));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ClassWriter.java","additions":3,"deletions":8,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.HtmlStyle;\n@@ -35,1 +34,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.Text;\n@@ -223,4 +221,1 @@\n-                var mdle = utils.elementUtils.getModuleOf(element);\n-                subnavLinks.add(links.createLink(pathToRoot.resolve(docPaths.moduleSummary(mdle)),\n-                        Text.of(mdle.getQualifiedName()),\n-                        pkg.isUnnamed() ? HtmlStyle.currentSelection : null, \"\"));\n+                subnavLinks.add(getBreadcrumbLink(utils.elementUtils.getModuleOf(element), pkg.isUnnamed()));\n@@ -229,2 +224,1 @@\n-                subnavLinks.add(links.createLink(pathString(pkg, DocPaths.PACKAGE_SUMMARY),\n-                        getLocalizedPackageName(pkg), HtmlStyle.currentSelection, \"\"));\n+                subnavLinks.add(getBreadcrumbLink(pkg, true));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/DocFilesHandler.java","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import java.util.LinkedHashMap;\n@@ -87,1 +86,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.HtmlAttr;\n@@ -93,1 +91,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.ListBuilder;\n@@ -637,0 +634,23 @@\n+    \/**\n+     * {@return a content element containing a breadcrumb navigtation link for {@code elem}}\n+     * Only module, package and type elements can appear in breadcrumb navigation.\n+     *\n+     * @param elem the element\n+     * @param selected whether to use the style for current page element\n+     *\/\n+    protected Content getBreadcrumbLink(Element elem, boolean selected) {\n+        HtmlTree link = switch (elem) {\n+            case ModuleElement mdle -> links.createLink(pathToRoot.resolve(docPaths.moduleSummary(mdle)),\n+                    Text.of(mdle.getQualifiedName()));\n+            case PackageElement pkg -> links.createLink(pathString(pkg, DocPaths.PACKAGE_SUMMARY),\n+                    getLocalizedPackageName(pkg));\n+            case TypeElement type -> links.createLink(pathString(type, docPaths.forName(type)),\n+                    utils.getSimpleName(type));\n+            default -> throw new IllegalArgumentException(Objects.toString(elem));\n+        };\n+        if (selected) {\n+            link.setStyle(HtmlStyle.currentSelection);\n+        }\n+        return link;\n+    }\n+\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/HtmlDocletWriter.java","additions":23,"deletions":3,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -280,4 +280,1 @@\n-                .setSubNavLinks(List.of(\n-                    links.createLink(pathToRoot.resolve(docPaths.moduleSummary(mdle)),\n-                            Text.of(mdle.getQualifiedName()),\n-                            HtmlStyle.currentSelection, \"\")));\n+                .setSubNavLinks(List.of(getBreadcrumbLink(mdle, true)));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ModuleWriter.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -223,2 +223,1 @@\n-            var mdle = utils.elementUtils.getModuleOf(packageElement);\n-            subnavLinks.add(getModuleLink(mdle, Text.of(mdle.getQualifiedName())));\n+            subnavLinks.add(getBreadcrumbLink(utils.elementUtils.getModuleOf(packageElement), false));\n@@ -226,2 +225,1 @@\n-        subnavLinks.add(links.createLink(pathString(packageElement, DocPaths.PACKAGE_SUMMARY),\n-                getLocalizedPackageName(packageElement), HtmlStyle.currentSelection, \"\"));\n+        subnavLinks.add(getBreadcrumbLink(packageElement, true));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/PackageUseWriter.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -275,3 +275,1 @@\n-            ModuleElement mdle = configuration.docEnv.getElementUtils().getModuleOf(packageElement);\n-            subnavLinks.add(links.createLink(pathToRoot.resolve(docPaths.moduleSummary(mdle)),\n-                    Text.of(mdle.getQualifiedName())));\n+            subnavLinks.add(getBreadcrumbLink(utils.elementUtils.getModuleOf(packageElement), false));\n@@ -279,2 +277,1 @@\n-        subnavLinks.add(links.createLink(pathString(packageElement, DocPaths.PACKAGE_SUMMARY),\n-                getLocalizedPackageName(packageElement), HtmlStyle.currentSelection, \"\"));\n+        subnavLinks.add(getBreadcrumbLink(packageElement, true));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/PackageWriter.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -175,1 +175,1 @@\n-                    <li><a href=\"C.html\" class=\"current-selection\" title=\"class in p\">C<\/a><\/li>\n+                    <li><a href=\"C.html\" class=\"current-selection\">C<\/a><\/li>\n@@ -185,1 +185,1 @@\n-                    <li><a href=\"C.html\" class=\"current-selection\" title=\"class in p\">C<\/a><\/li>\n+                    <li><a href=\"C.html\" class=\"current-selection\">C<\/a><\/li>\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testModules\/TestModulePackages.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -415,1 +415,1 @@\n-                    <li><a href=\"C.html\" class=\"current-selection\" title=\"class in Unnamed Package\">C<\/a><\/li>\n+                    <li><a href=\"C.html\" class=\"current-selection\">C<\/a><\/li>\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testNavigation\/TestNavigation.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug      8250768 8261976 8277300 8282452 8287597\n+ * @bug      8250768 8261976 8277300 8282452 8287597 8325325\n@@ -80,1 +80,1 @@\n-                    \"\"\"\n+                \"\"\"\n@@ -88,0 +88,1 @@\n+                    <li id=\"contents-package\"><a href=\"#package\">Packages<\/a><\/li>\n@@ -93,1 +94,17 @@\n-                    \"\"\"\n+                \"\"\"\n+                    <div id=\"package\">\n+                    <div class=\"table-tabs\" role=\"tablist\" aria-orientation=\"horizontal\">\n+                    <div class=\"caption\"><span>Packages<\/span><\/div>\n+                    <\/div>\n+                    <div id=\"package.tabpanel\" role=\"tabpanel\" aria-labelledby=\"package-tab0\">\n+                    <div class=\"summary-table three-column-summary\">\n+                    <div class=\"table-header col-first sort-asc\" onclick=\"sortTable(this, 0, 3)\">Package<\/div>\n+                    <div class=\"table-header col-second\" onclick=\"sortTable(this, 1, 3)\">Preview Feature<\/div>\n+                    <div class=\"table-header col-last\">Description<\/div>\n+                    <div class=\"col-summary-item-name even-row-color package package-tab1\"><a href=\"java.base\/preview\/package-summary.html\">preview<\/a><sup><a href=\"java.base\/preview\/package-summary.html#preview-preview\">PREVIEW<\/a><\/sup><\/div>\n+                    <div class=\"col-second even-row-color package package-tab1\">Test Feature<\/div>\n+                    <div class=\"col-last even-row-color package package-tab1\">\n+                    <div class=\"block\">Preview package.<\/div>\n+                    <\/div>\n+                    \"\"\",\n+                \"\"\"\n@@ -108,1 +125,1 @@\n-                    \"\"\"\n+                \"\"\"\n@@ -124,0 +141,18 @@\n+\n+        \/\/ 8325325: Breadcrumb navigation links should not contain PREVIEW link\n+        checkOutput(\"java.base\/preview\/package-summary.html\", true,\n+                \"\"\"\n+                    <ol class=\"sub-nav-list\">\n+                    <li><a href=\"..\/module-summary.html\">java.base<\/a><\/li>\n+                    &nbsp;&gt;&nbsp;\n+                    <li><a href=\"package-summary.html\" class=\"current-selection\">preview<\/a><\/li>\n+                    <\/ol>\"\"\");\n+        checkOutput(\"java.base\/preview\/Core.html\", true,\n+                \"\"\"\n+                    <ol class=\"sub-nav-list\">\n+                    <li><a href=\"..\/module-summary.html\">java.base<\/a><\/li>\n+                    &nbsp;&gt;&nbsp;\n+                    <li><a href=\"package-summary.html\">preview<\/a><\/li>\n+                    &nbsp;&gt;&nbsp;\n+                    <li><a href=\"Core.html\" class=\"current-selection\">Core<\/a><\/li>\n+                    <\/ol>\"\"\");\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testPreview\/TestPreview.java","additions":40,"deletions":5,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -23,0 +23,5 @@\n+\n+\/**\n+ * Preview package.\n+ *\/\n+@PreviewFeature(feature=Feature.TEST)\n@@ -27,4 +32,0 @@\n-\n-@PreviewFeature(feature=Feature.TEST)\n-public class Core {\n-}\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testPreview\/api\/preview\/package-info.java","additions":6,"deletions":5,"binary":false,"changes":11,"previous_filename":"test\/langtools\/jdk\/javadoc\/doclet\/testPreview\/api\/preview\/Core.java","status":"copied"}]}