{"files":[{"patch":"@@ -121,1 +121,1 @@\n-            if (archivedCache == null || archivedCache.length != size) {\n+            if (archivedCache == null) {\n@@ -128,0 +128,2 @@\n+            } else if (archivedCache.length != size) {\n+                throw new IllegalStateException(\"CDS archive is broken: ByteCache mismatch\");\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Byte.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -8988,1 +8988,1 @@\n-            if (archivedCache == null || archivedCache.length != size) {\n+            if (archivedCache == null) {\n@@ -8994,0 +8994,2 @@\n+            } else if (archivedCache.length != size) {\n+                throw new IllegalStateException(\"CDS archive is broken: CharacterCache mismatch\");\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Character.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -964,1 +964,10 @@\n-                for(int i = 0; i < c.length; i++) {\n+                \/\/ Use all cached values from the archive to avoid breaking\n+                \/\/ identity rules with objects loaded from the archive.\n+                int archivedHigh = (archivedCache == null) ? 0 : archivedCache.length;\n+                for (int i = 0; i < archivedHigh; i++) {\n+                    c[i] = archivedCache[i];\n+                    assert j == archivedCache[i];\n+                    j++;\n+                }\n+                \/\/ Fill the rest of the cache.\n+                for (int i = archivedHigh; i < size; i++) {\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Integer.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -966,1 +966,1 @@\n-            if (archivedCache == null || archivedCache.length != size) {\n+            if (archivedCache == null) {\n@@ -973,0 +973,2 @@\n+            } else if (archivedCache.length != size) {\n+                throw new IllegalStateException(\"CDS archive is broken: LongCache mismatch\");\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Long.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -248,1 +248,1 @@\n-            if (archivedCache == null || archivedCache.length != size) {\n+            if (archivedCache == null) {\n@@ -255,0 +255,2 @@\n+            } else if (archivedCache.length != size) {\n+                throw new IllegalStateException(\"CDS archive is broken: ShortCache mismatch\");\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Short.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}