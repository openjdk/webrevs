{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=0\n@@ -31,1 +31,1 @@\n- * @run main\/othervm -Dcom.sun.security.crl.readtimeout=1\n+ * @run main\/othervm -Djava.security.debug=certpath -Dcom.sun.security.crl.readtimeout=1\n@@ -33,1 +33,10 @@\n- * @run main\/othervm -Dcom.sun.security.crl.readtimeout=1s\n+ *\/\n+\n+\/*\n+ * @test id=1\n+ * @bug 8191808 8179502\n+ * @summary check that CRL download is interrupted if it takes too long\n+ * @modules java.base\/sun.security.x509\n+ *          java.base\/sun.security.util\n+ * @library \/test\/lib\n+ * @run main\/othervm -Djava.security.debug=certpath -Dcom.sun.security.crl.readtimeout=1s\n@@ -35,1 +44,10 @@\n- * @run main\/othervm -Dcom.sun.security.crl.readtimeout=4\n+ *\/\n+\n+\/*\n+ * @test id=2\n+ * @bug 8191808 8179502\n+ * @summary check that CRL download is interrupted if it takes too long\n+ * @modules java.base\/sun.security.x509\n+ *          java.base\/sun.security.util\n+ * @library \/test\/lib\n+ * @run main\/othervm -Djava.security.debug=certpath -Dcom.sun.security.crl.readtimeout=200\n@@ -37,1 +55,10 @@\n- * @run main\/othervm -Dcom.sun.security.crl.readtimeout=1500ms\n+ *\/\n+\n+\/*\n+ * @test id=3\n+ * @bug 8191808 8179502\n+ * @summary check that CRL download is interrupted if it takes too long\n+ * @modules java.base\/sun.security.x509\n+ *          java.base\/sun.security.util\n+ * @library \/test\/lib\n+ * @run main\/othervm -Djava.security.debug=certpath -Dcom.sun.security.crl.readtimeout=1500ms\n@@ -39,2 +66,0 @@\n- * @run main\/othervm -Dcom.sun.security.crl.readtimeout=4500ms\n- *      CRLReadTimeout 1000 true\n@@ -43,1 +68,15 @@\n-import java.io.*;\n+\/*\n+ * @test id=4\n+ * @bug 8191808 8179502\n+ * @summary check that CRL download is interrupted if it takes too long\n+ * @modules java.base\/sun.security.x509\n+ *          java.base\/sun.security.util\n+ * @library \/test\/lib\n+ * @run main\/othervm -Djava.security.debug=certpath -Dcom.sun.security.crl.readtimeout=4500ms\n+ *      CRLReadTimeout 100 true\n+ *\/\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.OutputStream;\n@@ -45,0 +84,1 @@\n+import java.net.InetAddress;\n@@ -50,1 +90,10 @@\n-import java.security.cert.*;\n+import java.security.cert.CRLException;\n+import java.security.cert.CertPath;\n+import java.security.cert.CertPathValidator;\n+import java.security.cert.CertPathValidatorException;\n+import java.security.cert.CertificateFactory;\n+import java.security.cert.PKIXParameters;\n+import java.security.cert.PKIXRevocationChecker;\n+import java.security.cert.TrustAnchor;\n+import java.security.cert.X509CRL;\n+import java.security.cert.X509Certificate;\n@@ -57,1 +106,3 @@\n-import static java.security.cert.PKIXRevocationChecker.Option.*;\n+import static java.security.cert.PKIXRevocationChecker.Option.NO_FALLBACK;\n+import static java.security.cert.PKIXRevocationChecker.Option.PREFER_CRLS;\n+import static java.security.cert.PKIXRevocationChecker.Option.SOFT_FAIL;\n@@ -63,1 +114,6 @@\n-import sun.security.x509.*;\n+import sun.security.x509.AuthorityKeyIdentifierExtension;\n+import sun.security.x509.CRLExtensions;\n+import sun.security.x509.CRLNumberExtension;\n+import sun.security.x509.KeyIdentifier;\n+import sun.security.x509.X500Name;\n+import sun.security.x509.X509CRLImpl;\n@@ -120,1 +176,1 @@\n-            if (softExc.size() > 0) {\n+            if (!softExc.isEmpty()) {\n@@ -122,1 +178,2 @@\n-                        softExc.size() + \" soft fail exceptions\");\n+                                           softExc.size() +\n+                                           \" soft fail exceptions\");\n@@ -185,1 +242,1 @@\n-            server.bind(new InetSocketAddress(0), 0);\n+            server.bind(new InetSocketAddress(InetAddress.getLoopbackAddress(), 0), 0);\n","filename":"test\/jdk\/sun\/security\/x509\/URICertStore\/CRLReadTimeout.java","additions":72,"deletions":15,"binary":false,"changes":87,"status":"modified"}]}