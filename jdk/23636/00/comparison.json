{"files":[{"patch":"@@ -39,0 +39,1 @@\n+import java.util.Optional;\n@@ -79,0 +80,4 @@\n+    public Optional<Path> getExecutable() {\n+        return Optional.ofNullable(executable);\n+    }\n+\n@@ -176,1 +181,1 @@\n-    public class Result {\n+    public record Result(int exitCode, List<String> output, Supplier<String> cmdline) {\n@@ -178,2 +183,2 @@\n-        Result(int exitCode) {\n-            this.exitCode = exitCode;\n+        public Result {\n+            Objects.requireNonNull(cmdline);\n@@ -190,4 +195,0 @@\n-        public String getPrintableCommandLine() {\n-            return Executor.this.getPrintableCommandLine();\n-        }\n-\n@@ -197,1 +198,1 @@\n-                    getPrintableCommandLine(), expectedExitCode));\n+                    cmdline.get(), expectedExitCode));\n@@ -208,3 +209,0 @@\n-\n-        final int exitCode;\n-        private List<String> output;\n@@ -411,2 +409,2 @@\n-        Result reply = new Result(process.waitFor());\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n+        final int exitCode = process.waitFor();\n+        trace(\"Done. Exit code: \" + exitCode);\n@@ -414,0 +412,1 @@\n+        final List<String> output;\n@@ -415,1 +414,3 @@\n-            reply.output = Collections.unmodifiableList(outputLines);\n+            output = Collections.unmodifiableList(outputLines);\n+        } else {\n+            output = null;\n@@ -417,1 +418,1 @@\n-        return reply;\n+        return createResult(exitCode, output);\n@@ -420,1 +421,1 @@\n-    private Result runToolProvider(PrintStream out, PrintStream err) {\n+    private int runToolProvider(PrintStream out, PrintStream err) {\n@@ -422,4 +423,4 @@\n-        Result reply = new Result(toolProvider.run(out, err, args.toArray(\n-                String[]::new)));\n-        trace(\"Done. Exit code: \" + reply.exitCode);\n-        return reply;\n+        final int exitCode = toolProvider.run(out, err, args.toArray(\n+                String[]::new));\n+        trace(\"Done. Exit code: \" + exitCode);\n+        return exitCode;\n@@ -428,0 +429,3 @@\n+    private Result createResult(int exitCode, List<String> output) {\n+        return new Result(exitCode, output, this::getPrintableCommandLine);\n+    }\n@@ -432,1 +436,1 @@\n-                return runToolProvider(System.out, System.err);\n+                return createResult(runToolProvider(System.out, System.err), null);\n@@ -441,1 +445,1 @@\n-            return runToolProvider(nullPrintStream, nullPrintStream);\n+            return createResult(runToolProvider(nullPrintStream, nullPrintStream), null);\n@@ -446,1 +450,1 @@\n-            Result reply = runToolProvider(ps, ps);\n+            final var exitCode = runToolProvider(ps, ps);\n@@ -448,0 +452,1 @@\n+            final List<String> output;\n@@ -453,1 +458,3 @@\n-                        reply.output = List.of(firstLine);\n+                        output = List.of(firstLine);\n+                    } else {\n+                        output = null;\n@@ -456,2 +463,3 @@\n-                    reply.output = bufReader.lines().collect(\n-                            Collectors.toUnmodifiableList());\n+                    output = bufReader.lines().collect(Collectors.toUnmodifiableList());\n+                } else {\n+                    output = null;\n@@ -463,1 +471,1 @@\n-                        lines = reply.output.stream();\n+                        lines = output.stream();\n@@ -470,1 +478,1 @@\n-            return reply;\n+            return createResult(exitCode, output);\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/Executor.java","additions":36,"deletions":28,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-public final class JPackageCommand extends CommandArguments<JPackageCommand> {\n+public class JPackageCommand extends CommandArguments<JPackageCommand> {\n@@ -802,1 +802,1 @@\n-        if (result.exitCode == 0) {\n+        if (result.exitCode() == 0) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -75,1 +75,1 @@\n-            if (result.exitCode == 1605) {\n+            if (result.exitCode() == 1605) {\n@@ -84,1 +84,1 @@\n-            if ((result.exitCode == 1618) || (result.exitCode == 1603)) {\n+            if ((result.exitCode() == 1618) || (result.exitCode() == 1603)) {\n@@ -526,1 +526,1 @@\n-        if (status.exitCode == 1) {\n+        if (status.exitCode() == 1) {\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/WindowsHelper.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}