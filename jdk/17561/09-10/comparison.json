{"files":[{"patch":"@@ -561,1 +561,1 @@\n-  if (alloc_capacity(r) < PLAB::min_size() * HeapWordSize) {\n+  if ((!ShenandoahPackEvacTightly && result == nullptr) || (alloc_capacity(r) < PLAB::min_size() * HeapWordSize)) {\n@@ -568,3 +568,3 @@\n-    \/\/ if the remaining capacity is less than PLAB::min_size().  Note that TLAB requests will generally downsize\n-    \/\/ to absorb all memory available within the region even if the remaining memory is less than the desired size.\n-\n+    \/\/ if the remaining capacity is less than PLAB::min_size() or if !ShenandoahPackEvacTightly.  Note that TLAB\n+    \/\/ requests will generally downsize to absorb all memory available within the region even if the remaining\n+    \/\/ memory is less than the desired size.\n@@ -851,0 +851,2 @@\n+  size_t region_size_bytes = ShenandoahHeapRegion::region_size_bytes();\n+\n@@ -859,0 +861,5 @@\n+    if (!ShenandoahPackEvacTightly && (ac != region_size_bytes)) {\n+      \/\/ Only use fully empty regions for Collector reserve if !ShenandoahPackEvacTightly\n+      continue;\n+    }\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.cpp","additions":11,"deletions":4,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -165,0 +165,8 @@\n+  product(bool, ShenandoahPackEvacTightly, false, EXPERIMENTAL,             \\\n+          \"When rebuilding the free set, allow the collector reserve \"      \\\n+          \"to include regions that are not entirely empty and do not \"      \\\n+          \"automatically retire regions within which an attempted \"         \\\n+          \"allocation has failed.  Setting this to true has been observed \" \\\n+          \"to increase concurrent evacuation times by up to 50% on certain \"\\\n+          \"workloads.\")                                                     \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoah_globals.hpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"}]}