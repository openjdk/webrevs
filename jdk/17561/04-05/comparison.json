{"files":[{"patch":"@@ -98,2 +98,2 @@\n-    _capacity_of[partition_id] = 0;\n-    _used_by[partition_id] = 0;\n+    _capacity[partition_id] = 0;\n+    _used[partition_id] = 0;\n@@ -108,2 +108,2 @@\n-  _used_by[which_partition] += bytes;\n-  assert (_used_by[which_partition] <= _capacity_of[which_partition],\n+  _used[which_partition] += bytes;\n+  assert (_used[which_partition] <= _capacity[which_partition],\n@@ -111,1 +111,1 @@\n-          _used_by[which_partition], _capacity_of[which_partition], bytes);\n+          _used[which_partition], _capacity[which_partition], bytes);\n@@ -181,2 +181,2 @@\n-  _capacity_of[which_partition] += _region_size_bytes;\n-  _used_by[which_partition] += _region_size_bytes - available;\n+  _capacity[which_partition] += _region_size_bytes;\n+  _used[which_partition] += _region_size_bytes - available;\n@@ -210,2 +210,2 @@\n-  _capacity_of[orig_partition] -= _region_size_bytes;\n-  _used_by[orig_partition] -= used;\n+  _capacity[orig_partition] -= _region_size_bytes;\n+  _used[orig_partition] -= used;\n@@ -214,2 +214,2 @@\n-  _capacity_of[new_partition] += _region_size_bytes;;\n-  _used_by[new_partition] += used;\n+  _capacity[new_partition] += _region_size_bytes;;\n+  _used[new_partition] += used;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.cpp","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -67,3 +67,8 @@\n-  \/\/ _capacity_of and _used_by are denoted in bytes\n-  size_t _capacity_of[NumPartitions];\n-  size_t _used_by[NumPartitions];\n+  \/\/ For each partition p, _capacity[p] represents the total amount of memory within the partition at the time\n+  \/\/ of the most recent rebuild, _used[p] represents the total amount of memory that has been consumed within this\n+  \/\/ partition (either already consumed as of the rebuild, or consumed since the rebuild).  _capacity[p] and _used[p]\n+  \/\/ are denoted in bytes.  Note that some regions that had been assigned to a particular partition at rebuild time\n+  \/\/ may have been retired following the rebuild.  The tallies for these regions are still reflected in _capacity[p]\n+  \/\/ and _used[p], even though the region may have been removed from the free set.\n+  size_t _capacity[NumPartitions];\n+  size_t _used[NumPartitions];\n@@ -93,2 +98,2 @@\n-  \/\/ Returns the ShenandoahFreeSetPartitionId affiliation of region idx, or NotFree if this region is not currently free.  This does\n-  \/\/ not enforce that free_set membership implies allocation capacity.\n+  \/\/ Returns the ShenandoahFreeSetPartitionId affiliation of region idx, NotFree if this region is not currently free.\n+  \/\/ This does not enforce that free_set membership implies allocation capacity.\n@@ -121,1 +126,1 @@\n-    return _capacity_of[which_partition];\n+    return _capacity[which_partition];\n@@ -126,1 +131,1 @@\n-    return _used_by[which_partition];\n+    return _used[which_partition];\n@@ -131,1 +136,1 @@\n-    _capacity_of[which_partition] = value;\n+    _capacity[which_partition] = value;\n@@ -136,1 +141,1 @@\n-    _used_by[which_partition] = value;\n+    _used[which_partition] = value;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.hpp","additions":14,"deletions":9,"binary":false,"changes":23,"status":"modified"}]}