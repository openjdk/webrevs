{"files":[{"patch":"@@ -35,0 +35,11 @@\n+    public enum Version {\n+        DRAFT, FINAL\n+    }\n+\n+    \/\/ This implementation works in FIPS 204 final. If for some reason\n+    \/\/ (for example, interop with an old version, or running an old test),\n+    \/\/ set the version to an older one. The following VM option is required:\n+    \/\/\n+    \/\/ --add-exports java.base\/sun.security.provider=ALL-UNNAMED\n+    public static Version version = Version.FINAL;\n+\n@@ -131,0 +142,7 @@\n+            if (version == Version.FINAL) {\n+                \/\/ FIPS 204 Algorithm 2 ML-DSA.Sign prepend {0, len(ctx)}\n+                \/\/ to message before passing it to Sign_internal.\n+                var m = new byte[msg.length + 2];\n+                System.arraycopy(msg, 0, m, 2, msg.length); \/\/ len(ctx) = 0\n+                msg = m;\n+            }\n@@ -139,0 +157,7 @@\n+            if (version == Version.FINAL) {\n+                \/\/ FIPS 204 Algorithm 3 ML-DSA.Verify prepend {0, len(ctx)}\n+                \/\/ to message before passing it to Verify_internal.\n+                var m = new byte[msg.length + 2];\n+                System.arraycopy(msg, 0, m, 2, msg.length); \/\/ len(ctx) = 0\n+                msg = m;\n+            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/ML_DSA_Provider.java","additions":25,"deletions":0,"binary":false,"changes":25,"status":"modified"}]}