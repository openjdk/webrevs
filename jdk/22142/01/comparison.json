{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,0 +57,1 @@\n+        winEnglishOutput = false;\n@@ -93,0 +94,9 @@\n+    public Executor setWinRunWithEnglishOutput(boolean value) {\n+        if (!TKit.isWindows()) {\n+            throw new UnsupportedOperationException(\n+                    \"setWinRunWithEnglishOutput is only valid on Windows platform\");\n+        }\n+        winEnglishOutput = value;\n+        return this;\n+    }\n+\n@@ -210,0 +220,5 @@\n+        if (toolProvider != null && winEnglishOutput) {\n+            throw new IllegalArgumentException(\n+                    \"Can't change locale when using tool provider\");\n+        }\n+\n@@ -327,0 +342,8 @@\n+    private List<String> prefixCommandLineArgs() {\n+        if (winEnglishOutput) {\n+            return List.of(\"cmd.exe\", \"\/c\", \"chcp\", \"437\", \">nul\", \"2>&1\", \"&&\");\n+        } else {\n+            return List.of();\n+        }\n+    }\n+\n@@ -329,0 +352,1 @@\n+        command.addAll(prefixCommandLineArgs());\n@@ -460,2 +484,4 @@\n-        return String.format(format, printCommandLine(exec, args),\n-                args.size() + 1);\n+        var cmdline = Stream.of(prefixCommandLineArgs(), List.of(exec), args).flatMap(\n+                List::stream).toList();\n+\n+        return String.format(format, printCommandLine(cmdline), cmdline.size() + 1);\n@@ -464,1 +490,1 @@\n-    private static String printCommandLine(String executable, List<String> args) {\n+    private static String printCommandLine(List<String> cmdline) {\n@@ -466,1 +492,1 @@\n-        \/\/ to be executed manally\n+        \/\/ to be executed manually\n@@ -468,1 +494,1 @@\n-        return Stream.concat(Stream.of(executable), args.stream()).map(\n+        return cmdline.stream().map(\n@@ -482,0 +508,1 @@\n+    private boolean winEnglishOutput;\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/Executor.java","additions":33,"deletions":6,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -254,1 +254,1 @@\n-        \/\/ Get the list of PIDs and PPIDs of app launcher processes.\n+        \/\/ Get the list of PIDs and PPIDs of app launcher processes. Run setWinRunWithEnglishOutput(true) for JDK-8344275.\n@@ -259,3 +259,2 @@\n-                \")\", \"get\", \"ProcessID,ParentProcessID\").dumpOutput(true).\n-                saveOutput().executeAndGetOutput();\n-\n+                \")\", \"get\", \"ProcessID,ParentProcessID\").dumpOutput(true).saveOutput().\n+                setWinRunWithEnglishOutput(true).executeAndGetOutput();\n@@ -263,1 +262,1 @@\n-            return new long[0];\n+                return new long[0];\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/WindowsHelper.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"}]}