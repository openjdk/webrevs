{"files":[{"patch":"@@ -74,1 +74,1 @@\n-        for (Class<?> c : List.of(int.class, long.class)) {\n+        for (Class<?> c : new Class<?>[]{int.class, long.class}) {\n@@ -85,1 +85,1 @@\n-    \/\/   stateName can be anything non-null but should be in {\"GetLastError\" | \"WSAGetLastError\"} | \"errno\")}\n+    \/\/   stateName can be anything non-null but should be in {\"GetLastError\" | \"WSAGetLastError\" | \"errno\"}\n@@ -94,1 +94,2 @@\n-            final Class<?> returnType = target.type().returnType();\n+            final MethodType type = target.type();\n+            final Class<?> returnType = type.returnType();\n@@ -99,1 +100,1 @@\n-            if (target.type().parameterCount() == 0 || target.type().parameterType(0) != MemorySegment.class) {\n+            if (type.parameterCount() == 0 || type.parameterType(0) != MemorySegment.class) {\n@@ -361,0 +362,1 @@\n+    \/\/ This is intentionally an old switch to improve on startup time.\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/CaptureStateUtil.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -87,2 +87,2 @@\n-                                           String name,\n-                                           MethodType type) {\n+                                          String name,\n+                                          MethodType type) {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/invoke\/MhUtil.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -54,1 +54,1 @@\n-    private static final long SMALL_ALLOC_SIZE = 8;\n+    private static final long SMALL_ALLOC_SIZE = JAVA_LONG.byteSize();\n@@ -270,0 +270,8 @@\n+    @Test\n+    void noInit() {\n+        BufferStack stack = newBufferStack();\n+        try (var arena = stack.pushFrame(SMALL_ALLOC_SIZE, 1)) {\n+            assertDoesNotThrow(() -> arena.allocateFrom(JAVA_INT, 1));\n+        }\n+    }\n+\n","filename":"test\/jdk\/java\/foreign\/TestBufferStack.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"}]}