{"files":[{"patch":"@@ -523,1 +523,1 @@\n-  \/\/ Hook region into slow_path, in stead of the multiversion_slow_proj.\n+  \/\/ Hook region into slow_path, instead of the multiversion_slow_proj.\n","filename":"src\/hotspot\/share\/opto\/loopUnswitch.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -893,0 +893,3 @@\n+  \/\/\n+  \/\/ Exception: dead CFG nodes may instead have a ctrl\/idom forwarding\n+  \/\/            installed. See: install_ctrl_and_idom_forwarding\n@@ -959,1 +962,1 @@\n-  \/\/ Returns true if \"n\" is a data node, false if it's a control node.\n+  \/\/ Returns true if \"n\" is a data node, false if it's a CFG node.\n@@ -963,1 +966,1 @@\n-  \/\/ or have otherwise modified their ctrl state by \"install_lazy_ctrl_and_idom_forwarding\".\n+  \/\/ or have otherwise modified their ctrl state by \"install_ctrl_and_idom_forwarding\".\n@@ -1087,1 +1090,1 @@\n-    \/\/ See: install_lazy_ctrl_and_idom_forwarding\n+    \/\/ See: install_ctrl_and_idom_forwarding\n@@ -1111,1 +1114,1 @@\n-    \/\/ See: install_lazy_ctrl_and_idom_forwarding.\n+    \/\/ See: install_ctrl_and_idom_forwarding.\n@@ -1123,1 +1126,1 @@\n-      \/\/ forwarding installed, using \"install_lazy_ctrl_and_idom_forwarding\".\n+      \/\/ forwarding installed, using \"install_ctrl_and_idom_forwarding\".\n@@ -1154,1 +1157,1 @@\n-  \/\/   may be dead but has a ctrl forwarding to the new and live\n+  \/\/   may be dead but has an idom forwarding to the new and live\n@@ -1157,1 +1160,4 @@\n-  \/\/ Using \"install_lazy_ctrl_and_idom_forwarding\" allows us to only edit\n+  \/\/   Note: while the \"idom\" information is stored in the \"_idom\"\n+  \/\/   side-table, the idom forwarding piggy-packs on the ctrl\n+  \/\/   forwarding on \"_loop_or_ctrl\".\n+  \/\/ Using \"install_ctrl_and_idom_forwarding\" allows us to only edit\n@@ -1160,2 +1166,3 @@\n-  \/\/ clean up the forwarding links when we query \"get_ctrl\" or \"idom\".\n-  void install_lazy_ctrl_and_idom_forwarding(Node* old_node, Node* new_node) {\n+  \/\/ clean up the forwarding links when we query \"get_ctrl\" or \"idom\"\n+  \/\/ for these nodes the next time.\n+  void install_ctrl_and_idom_forwarding(Node* old_node, Node* new_node) {\n@@ -1178,1 +1185,1 @@\n-    install_lazy_ctrl_and_idom_forwarding(old_node, new_node);\n+    install_ctrl_and_idom_forwarding(old_node, new_node);\n@@ -1253,3 +1260,3 @@\n-  Node* idom_no_update(uint didx) const {\n-    assert(didx < _idom_size, \"oob\");\n-    Node* n = _idom[didx];\n+  Node* idom_no_update(uint node_idx) const {\n+    assert(node_idx < _idom_size, \"oob\");\n+    Node* n = _idom[node_idx];\n@@ -1260,1 +1267,1 @@\n-      \/\/ forwarding installed, using \"install_lazy_ctrl_and_idom_forwarding\".\n+      \/\/ forwarding installed, using \"install_ctrl_and_idom_forwarding\".\n@@ -1262,1 +1269,4 @@\n-      \/\/ ctrl\/idom node, in possibly multiple ctrl\/idom forwarding steps.\n+      \/\/ idom node, in possibly multiple idom forwarding steps.\n+      \/\/ Note that we piggy-back on \"_loop_or_ctrl\" to do the forwarding,\n+      \/\/ since we forward both \"get_ctrl\" and \"idom\" from the dead to the\n+      \/\/ new live ctrl\/idom nodes.\n@@ -1274,2 +1284,2 @@\n-  Node* idom(uint didx) const {\n-    Node* n = idom_no_update(didx);\n+  Node* idom(uint node_idx) const {\n+    Node* n = idom_no_update(node_idx);\n@@ -1278,3 +1288,3 @@\n-    \/\/ there was a ctrl forwarding via dead ctrl nodes, this shortens the path.\n-    \/\/ See: install_lazy_ctrl_and_idom_forwarding\n-    _idom[didx] = n;\n+    \/\/ there was an idom forwarding via dead idom nodes, this shortens the path.\n+    \/\/ See: install_ctrl_and_idom_forwarding\n+    _idom[node_idx] = n;\n","filename":"src\/hotspot\/share\/opto\/loopnode.hpp","additions":30,"deletions":20,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -673,1 +673,1 @@\n-  \/\/ Break the self-cycle. Required for install_lazy_ctrl_and_idom_forwarding to work on region.\n+  \/\/ Break the self-cycle. Required for install_ctrl_and_idom_forwarding to work on region.\n@@ -675,1 +675,1 @@\n-  install_lazy_ctrl_and_idom_forwarding(region, region_dom); \/\/ idom must be updated before handle_use\n+  install_ctrl_and_idom_forwarding(region, region_dom); \/\/ idom must be updated before handle_use\n","filename":"src\/hotspot\/share\/opto\/split_if.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}