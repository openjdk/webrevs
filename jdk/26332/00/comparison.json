{"files":[{"patch":"@@ -40,0 +40,2 @@\n+import sun.java2d.Disposer;\n+import sun.java2d.DisposerRecord;\n@@ -85,1 +87,1 @@\n-    private native void deregisterDisplayReconfiguration(long context);\n+    private static native void deregisterDisplayReconfiguration(long context);\n@@ -96,0 +98,1 @@\n+    private Object disposerReferent = new Object();\n@@ -117,0 +120,1 @@\n+        Disposer.addRecord(disposerReferent, new CGEDisposerRecord(displayReconfigContext));\n@@ -142,7 +146,15 @@\n-    @Override\n-    @SuppressWarnings(\"removal\")\n-    protected void finalize() throws Throwable {\n-        try {\n-            super.finalize();\n-        } finally {\n-            deregisterDisplayReconfiguration(displayReconfigContext);\n+    private static class CGEDisposerRecord implements DisposerRecord {\n+        private long displayReconfigContext;\n+\n+        CGEDisposerRecord(long ptr) {\n+            displayReconfigContext = ptr;\n+        }\n+\n+        public synchronized void dispose() {\n+            if (displayReconfigContext != 0L) {\n+                try {\n+                    deregisterDisplayReconfiguration(displayReconfigContext);\n+                } catch (Throwable t) {\n+                    \/\/ Runs on disposer thread, can't allow an exception to escape.\n+                }\n+            }\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/awt\/CGraphicsEnvironment.java","additions":20,"deletions":8,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -165,1 +165,1 @@\n-(JNIEnv *env, jobject this, jlong p)\n+(JNIEnv *env, jclass clazz, jlong p)\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/CGraphicsEnv.m","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}