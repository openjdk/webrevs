{"files":[{"patch":"@@ -99,3 +99,3 @@\n-     * @param loader ClassLoader to find the bytes for the class.\n-     * @param oldString old class name.\n-     * @param newString new class name to replace with old class name.\n+     * @param byteBuffer buffer of old class bytes.\n+     * @param oldClassName old class name.\n+     * @param newClassName new class name to replace with old class name.\n@@ -103,4 +103,2 @@\n-\n-    public static byte[] replaceAllStrings(ClassLoader loader, String oldString, String newString) throws Exception {\n-        byte[] buf = getBytecodes(loader, oldString);\n-        assertTrue(oldString.length() == newString.length(), \"must have same length\");\n+    public static byte[] replaceAllStrings(byte[] byteBuffer, String oldClassName, String newClassName) throws Exception {\n+        assertTrue(oldClassName.length() == newClassName.length(), \"must have same length\");\n@@ -108,2 +106,2 @@\n-        while ((index = getStringIndex(oldString, buf, index + 1)) != 0) {\n-            replaceString(buf, newString, index);\n+        while ((index = getStringIndex(oldClassName, byteBuffer, index + 1)) != 0) {\n+            replaceString(byteBuffer, newClassName, index);\n@@ -111,1 +109,14 @@\n-        return buf;\n+        return byteBuffer;\n+    }\n+\n+    \/*\n+     * Replace class name in bytecodes to the class we're trying to redefine, so that both\n+     * old and new classes can be compiled with jtreg for the test.\n+     *\n+     * @param loader ClassLoader to find the bytes for the class.\n+     * @param oldClassName old class name.\n+     * @param newClassName new class name to replace with old class name.\n+     *\/\n+    public static byte[] replaceAllStrings(ClassLoader loader, String oldClassName, String newClassName) throws Exception {\n+        byte[] buf = getBytecodes(loader, oldClassName);\n+        return replaceAllStrings(buf, oldClassName, newClassName);\n","filename":"test\/lib\/RedefineClassHelper.java","additions":21,"deletions":10,"binary":false,"changes":31,"status":"modified"}]}