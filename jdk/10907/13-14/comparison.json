{"files":[{"patch":"@@ -34,1 +34,1 @@\n-  _base(UseFastLocking && !UseHeavyMonitors ? NEW_C_HEAP_ARRAY(oop, INITIAL_CAPACITY, mtSynchronizer) : NULL),\n+  _base(UseFastLocking && !UseHeavyMonitors ? _initial : NULL),\n@@ -41,1 +41,3 @@\n-    FREE_C_HEAP_ARRAY(oop, _base);\n+    if (_base != _initial) {\n+      FREE_C_HEAP_ARRAY(oop, _base);\n+    }\n@@ -62,1 +64,9 @@\n-  _base = REALLOC_C_HEAP_ARRAY(oop, _base, new_capacity, mtSynchronizer);\n+  if (_base == _initial) {\n+    oop* new_stack = NEW_C_HEAP_ARRAY(oop, new_capacity, mtSynchronizer);\n+    for (size_t i = 0; i < index; i++) {\n+      *(new_stack + i) = *(_base + i);\n+    }\n+    _base = new_stack;\n+  } else {\n+    _base = REALLOC_C_HEAP_ARRAY(oop, _base, new_capacity, mtSynchronizer);\n+  }\n","filename":"src\/hotspot\/share\/runtime\/lockStack.cpp","additions":13,"deletions":3,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-  static const size_t INITIAL_CAPACITY = 1;\n+  static const size_t INITIAL_CAPACITY = 4;\n@@ -42,0 +42,1 @@\n+  oop _initial[INITIAL_CAPACITY];\n","filename":"src\/hotspot\/share\/runtime\/lockStack.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}