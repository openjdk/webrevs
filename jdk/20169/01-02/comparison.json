{"files":[{"patch":"@@ -46,0 +46,6 @@\n+#define CHECK_EXCEPTION_FATAL(env, message) \\\n+    if ((*env)->ExceptionCheck(env)) { \\\n+        (*env)->ExceptionClear(env); \\\n+        (*env)->FatalError(env, message); \\\n+    }\n+\n@@ -64,7 +70,1 @@\n-        if (graphicsEnvClass == NULL) {\n-            \/\/ Not finding the class is not necessarily an error.\n-            if ((*env)->ExceptionCheck(env)) {\n-                (*env)->ExceptionClear(env);\n-            }\n-            return JNI_TRUE;\n-        }\n+        CHECK_EXCEPTION_FATAL(env, \"java\/awt\/GraphicsEnvironment class not found\");\n@@ -73,7 +73,1 @@\n-        if (headlessFn == NULL) {\n-            \/\/ If we can't find the method, we assume headless mode.\n-            if ((*env)->ExceptionCheck(env)) {\n-                (*env)->ExceptionClear(env);\n-            }\n-            return JNI_TRUE;\n-        }\n+        CHECK_EXCEPTION_FATAL(env, \"isHeadless method not found\");\n@@ -82,1 +76,1 @@\n-        \/\/ If an exception occurred, we assume headless mode.\n+        \/\/ If an exception occurred, we assume headless mode and carry on.\n@@ -91,6 +85,0 @@\n-#define CHECK_EXCEPTION_FATAL(env, message) \\\n-    if ((*env)->ExceptionCheck(env)) { \\\n-        (*env)->ExceptionClear(env); \\\n-        (*env)->FatalError(env, message); \\\n-    }\n-\n","filename":"src\/java.desktop\/unix\/native\/libawt\/awt\/awt_LoadLibrary.c","additions":9,"deletions":21,"binary":false,"changes":30,"status":"modified"}]}