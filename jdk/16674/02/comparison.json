{"files":[{"patch":"@@ -26,1 +26,1 @@\n- * @bug 6972078\n+ * @bug 6972078 8319938\n@@ -54,2 +54,4 @@\n-    private static File[] testDir;\n-    private static File[] tempFile;\n+    private static File testDir;\n+    private static File testFile;\n+    private static File[] SubDirs;\n+    private static File[] subFiles;\n@@ -61,20 +63,4 @@\n-\n-        try {\n-            \/\/ create test directory\n-            String tmpDir = System.getProperty(\"user.home\");\n-            testDir = new File[1];\n-            testDir[0] = new File(tmpDir, \"testDir\");\n-            if (!testDir[0].exists())\n-                testDir[0].mkdir();\n-            testDir[0].deleteOnExit();\n-\n-            \/\/ create temporary files inside testDir\n-            tempFile = new File[5];\n-            for (int i = 0; i < 5; ++i) {\n-                tempFile[i] = File.createTempFile(\"temp\", \".txt\",\n-                        new File(testDir[0].getAbsolutePath()));\n-                tempFile[i].deleteOnExit();\n-            }\n-        } catch (Exception e) {\n-            e.printStackTrace();\n-        }\n+        createFoldersOnlyDir();\n+        createFilesOnlyDir();\n+        populateDirs();\n+        populateFiles();\n@@ -82,1 +68,1 @@\n-                        UIManager.getInstalledLookAndFeels()) {\n+                UIManager.getInstalledLookAndFeels()) {\n@@ -92,0 +78,36 @@\n+    private static void createFoldersOnlyDir() {\n+        String tmpDir = System.getProperty(\"java.io.tmpdir\");\n+        testDir = new File(tmpDir, \"testDir\");\n+        if (!testDir.exists()) {\n+            testDir.mkdir();\n+        }\n+        testDir.deleteOnExit();\n+    }\n+\n+    private static void populateDirs() {\n+        SubDirs = new File[10];\n+        for (int i = 0; i < 10; ++i) {\n+            SubDirs[i] = new File(testDir, \"subDir_\" + (i+1));\n+            SubDirs[i].mkdir();\n+            SubDirs[i].deleteOnExit();\n+        }\n+    }\n+\n+    private static void createFilesOnlyDir() {\n+        String tmpDir = System.getProperty(\"java.io.tmpdir\");\n+        testFile = new File(tmpDir, \"testFile\");\n+        if (!testFile.exists()) {\n+            testFile.mkdir();\n+        }\n+        testFile.deleteOnExit();\n+    }\n+\n+    private static void populateFiles() throws Exception {\n+        subFiles = new File[10];\n+        for (int i = 0; i < 10; ++i) {\n+            subFiles[i] = File.createTempFile(\"subFiles_\" + (i+1),\n+                    \".txt\", new File(testFile.getAbsolutePath()));\n+            subFiles[i].deleteOnExit();\n+        }\n+    }\n+\n@@ -98,1 +120,1 @@\n-                fileChooser.setCurrentDirectory(testDir[0]);\n+                fileChooser.setCurrentDirectory(testFile);\n@@ -120,0 +142,1 @@\n+                fileChooser.setCurrentDirectory(testDir);\n@@ -140,0 +163,1 @@\n+                fileChooser.setCurrentDirectory(testDir);\n@@ -157,1 +181,1 @@\n-        fileChooser = new JFileChooser(\"user.home\");\n+        fileChooser = new JFileChooser(testDir);\n@@ -211,0 +235,1 @@\n+        robot.waitForIdle();\n","filename":"test\/jdk\/com\/sun\/java\/swing\/plaf\/gtk\/TestFileChooserSingleDirectorySelection.java","additions":51,"deletions":26,"binary":false,"changes":77,"status":"modified"}]}