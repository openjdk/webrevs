{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,0 +49,1 @@\n+import java.util.Arrays;\n@@ -406,1 +407,4 @@\n-            if (!chc.isResumption || chc.resumingSession == null) {\n+            if (!chc.isResumption || chc.resumingSession == null\n+                    || chc.resumingSession.getPskIdentity() == null\n+                    || !Arrays.asList(ProtocolVersion.PROTOCOLS_10_12)\n+                        .contains(chc.resumingSession.getProtocolVersion())) {\n@@ -410,1 +414,1 @@\n-                return new SessionTicketSpec().getEncoded();\n+                return new byte[0];\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SessionTicketExtension.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,1 @@\n- * @bug 8211806 8277881\n+ * @bug 8211806 8277881 8277307\n@@ -105,1 +105,1 @@\n-        clientEngine.setEnabledProtocols(new String[] { \"TLSv1.3\" });\n+        clientEngine.setEnabledProtocols(new String[] { \"TLSv1.2\", \"TLSv1.3\" });\n@@ -117,1 +117,1 @@\n-        newCliEngine.setEnabledProtocols(new String[] { \"TLSv1.3\" });\n+        newCliEngine.setEnabledProtocols(new String[] { \"TLSv1.2\", \"TLSv1.3\" });\n@@ -397,0 +397,10 @@\n+                case 35:                \/\/ session_ticket\n+                    \/\/ This is a TLS1.2 extension; should be empty since we're\n+                    \/\/ negotiating TLS1.3. See JDK-8277307\n+                    System.err.format(\"* Found session_ticket extension \" +\n+                                    \"(%d bytes)\\n\", extLen);\n+                    if (extLen != 0) {\n+                        throw new Exception(\"Unexpected session_ticket content\");\n+                    }\n+                    resCliHello.position(resCliHello.position() + extLen);\n+                    break;\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLSession\/ResumeTLS13withSNI.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"}]}