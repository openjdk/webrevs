{"files":[{"patch":"@@ -27,2 +27,1 @@\n-import java.util.ArrayList;\n-import java.util.List;\n+import java.util.Arrays;\n@@ -34,1 +33,3 @@\n-    private final List<Attribute<?>> attributes = new ArrayList<>();\n+    private static Attribute<?>[] EMPTY_ATTRIBUTE_ARRAY = {};\n+    private int attributesCount = 0;\n+    private Attribute<?>[] attributes = EMPTY_ATTRIBUTE_ARRAY;\n@@ -45,1 +46,12 @@\n-        attributes.add(a);\n+\n+        addAttribute(a);\n+    }\n+\n+    private void addAttribute(Attribute<?> a) {\n+        int attributesCount = this.attributesCount;\n+        if (attributesCount >= attributes.length) {\n+            int newCapacity = attributesCount + 8;\n+            this.attributes = Arrays.copyOf(attributes, newCapacity);\n+        }\n+        attributes[attributesCount] = a;\n+        this.attributesCount = attributesCount + 1;\n@@ -49,1 +61,1 @@\n-        return attributes.size();\n+        return attributesCount;\n@@ -53,1 +65,5 @@\n-        Util.writeAttributes(buf, attributes);\n+        int attributesCount = this.attributesCount;\n+        buf.writeU2(attributesCount);\n+        for (int i = 0; i < attributesCount; i++) {\n+            Util.writeAttribute(buf, attributes[i]);\n+        }\n@@ -58,2 +74,2 @@\n-        for (int i = 0; i < attributes.size(); i++) {\n-            Attribute<?> a = attributes.get(i);\n+        for (int i = 0; i < attributesCount; i++) {\n+            Attribute<?> a = attributes[i];\n@@ -67,2 +83,2 @@\n-        for (int i = 0; i < attributes.size(); i++) {\n-            if (attributes.get(i).attributeMapper() == am)\n+        for (int i = 0; i < attributesCount; i++) {\n+            if (attributes[i].attributeMapper() == am)\n@@ -75,1 +91,8 @@\n-        attributes.removeIf(a -> a.attributeMapper() == am);\n+        for (int i = 0; i < attributesCount; i++) {\n+            Attribute<?> a = attributes[i];\n+            if (a.attributeMapper() == am) {\n+                attributesCount--;\n+                System.arraycopy(attributes, i + 1, attributes, i, attributesCount - i);\n+                i--;\n+            }\n+        }\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/classfile\/impl\/AttributeHolder.java","additions":34,"deletions":11,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -243,1 +243,1 @@\n-    private static <T extends Attribute<T>> void writeAttribute(BufWriterImpl writer, Attribute<?> attr) {\n+    public static <T extends Attribute<T>> void writeAttribute(BufWriterImpl writer, Attribute<?> attr) {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/classfile\/impl\/Util.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}