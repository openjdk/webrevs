{"files":[{"patch":"@@ -714,1 +714,10 @@\n-  return dlsym(handle, name);\n+  ::dlerror(); \/\/ Clear any previous error\n+  void* ret = ::dlsym(handle, name);\n+  if (ret == nullptr) {\n+    const char* tmp = ::dlerror();\n+    \/\/ It is possible that we found a NULL symbol, hence no error.\n+    if (tmp != nullptr) {\n+      log_debug(os)(\"Symbol %s not found in dll: %s\", name, tmp);\n+    }\n+  }\n+  return ret;\n","filename":"src\/hotspot\/os\/posix\/os_posix.cpp","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -1282,0 +1282,10 @@\n+static size_t format_message_fixup(char* buf, size_t end) {\n+  if (end > 3) {\n+    if (buf[end - 1] == '\\n') end--;\n+    if (buf[end - 1] == '\\r') end--;\n+    if (buf[end - 1] == '.')  end--;\n+    buf[end] = '\\0';\n+  }\n+  return end;\n+}\n+\n@@ -1283,1 +1293,16 @@\n-  return (void*)::GetProcAddress((HMODULE)lib, name);\n+  void* ret = ::GetProcAddress((HMODULE)lib, name);\n+  DWORD errval;\n+  if ((errval = GetLastError()) != 0) {\n+    char buf[512];\n+    size_t n = (size_t)FormatMessage(\n+                                     FORMAT_MESSAGE_FROM_SYSTEM|FORMAT_MESSAGE_IGNORE_INSERTS,\n+                                     nullptr,\n+                                     errval,\n+                                     0,\n+                                     buf,\n+                                     (DWORD)sizeof(buf),\n+                                     nullptr);\n+    format_message_fixup(buf, n);\n+    log_debug(os)(\"Symbol %s not found in dll: %s\", name, buf);\n+  }\n+  return ret;\n@@ -2168,8 +2193,1 @@\n-    if (n > 3) {\n-      \/\/ Drop final '.', CR, LF\n-      if (buf[n - 1] == '\\n') n--;\n-      if (buf[n - 1] == '\\r') n--;\n-      if (buf[n - 1] == '.') n--;\n-      buf[n] = '\\0';\n-    }\n-    return n;\n+    return format_message_fixup(buf, n);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":27,"deletions":9,"binary":false,"changes":36,"status":"modified"}]}