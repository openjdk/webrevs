{"files":[{"patch":"@@ -70,1 +70,3 @@\n-  JfrCheckpointManager::on_unloading_classes();\n+  if (JfrRecorder::is_created() || JfrRecorder::is_started_on_commandline()) {\n+    JfrCheckpointManager::on_unloading_classes();\n+  }\n","filename":"src\/hotspot\/share\/jfr\/jfr.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -116,9 +116,0 @@\n-  return true;\n-}\n-\n-\/\/ The instance is already created and so we only complete the setup of additional subsystems.\n-bool JfrCheckpointManager::initialize(JfrChunkWriter* cw) {\n-  assert(cw != nullptr, \"invariant\");\n-  _chunkwriter = cw;\n-\n-  assert(_global_mspace != nullptr, \"invariant\");\n@@ -141,0 +132,2 @@\n+  return true;\n+}\n@@ -142,0 +135,4 @@\n+\/\/ The instance is already created and so we only complete the setup of additional subsystems.\n+bool JfrCheckpointManager::initialize(JfrChunkWriter* cw) {\n+  assert(cw != nullptr, \"invariant\");\n+  _chunkwriter = cw;\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/jfrCheckpointManager.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"}]}