{"files":[{"patch":"@@ -260,1 +260,0 @@\n-java\/awt\/FullScreen\/UninitializedDisplayModeChangeTest\/UninitializedDisplayModeChangeTest.java 8273617 macosx-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -37,6 +37,5 @@\n-    public static void main(String[] args)\n-        throws InterruptedException, InvocationTargetException\n-    {\n-        final GraphicsDevice gd =\n-            GraphicsEnvironment.getLocalGraphicsEnvironment().\n-                getDefaultScreenDevice();\n+    private static final GraphicsDevice gd =\n+            GraphicsEnvironment.getLocalGraphicsEnvironment()\n+                               .getDefaultScreenDevice();\n+    private static final DisplayMode currentDM = gd.getDisplayMode();\n+    private static Frame f = null;\n@@ -44,3 +43,4 @@\n-        EventQueue.invokeAndWait(new Runnable() {\n-            public void run() {\n-                Frame f = null;\n+    public static void main(String[] args)\n+        throws InterruptedException, InvocationTargetException {\n+        try {\n+            EventQueue.invokeAndWait(() -> {\n@@ -48,18 +48,6 @@\n-                    try {\n-                        f = new Frame(\"DisplayChanger Frame\");\n-                        gd.setFullScreenWindow(f);\n-                        if (gd.isDisplayChangeSupported()) {\n-                            DisplayMode dm = findDisplayMode(gd);\n-                            if (gd != null) {\n-                                gd.setDisplayMode(dm);\n-                            }\n-                        }\n-                        try {\n-                            Thread.sleep(1000);\n-                        } catch (InterruptedException ex) {\n-                            ex.printStackTrace();\n-                        }\n-                        gd.setFullScreenWindow(null);\n-                    } finally {\n-                        if (f != null) {\n-                            f.dispose();\n+                    f = new Frame(\"DisplayChanger Frame\");\n+                    gd.setFullScreenWindow(f);\n+                    if (gd.isDisplayChangeSupported()) {\n+                        DisplayMode dm = findDisplayMode(gd);\n+                        if (gd != null) {\n+                            gd.setDisplayMode(dm);\n@@ -69,0 +57,5 @@\n+            });\n+            try {\n+                Thread.sleep(1000);\n+            } catch (InterruptedException ex) {\n+                ex.printStackTrace();\n@@ -70,1 +63,13 @@\n-        });\n+            EventQueue.invokeAndWait(() -> gd.setFullScreenWindow(null));\n+            try {\n+                Thread.sleep(1000);\n+            } catch (InterruptedException ex) {\n+                ex.printStackTrace();\n+            }\n+        } finally {\n+            EventQueue.invokeAndWait(() -> {\n+                if (f != null) {\n+                    f.dispose();\n+                }\n+            });\n+        }\n@@ -79,1 +84,0 @@\n-        DisplayMode currentDM = gd.getDisplayMode();\n","filename":"test\/jdk\/java\/awt\/FullScreen\/UninitializedDisplayModeChangeTest\/DisplayModeChanger.java","additions":33,"deletions":29,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -31,2 +31,2 @@\n- * @run main\/othervm UninitializedDisplayModeChangeTest\n- * @run main\/othervm -Djava.awt.headless=true UninitializedDisplayModeChangeTest\n+ * @run main\/othervm\/timeout=360 UninitializedDisplayModeChangeTest\n+ * @run main\/othervm\/timeout=360 -Djava.awt.headless=true UninitializedDisplayModeChangeTest\n@@ -90,1 +90,1 @@\n-            childProc.waitFor();\n+            childProc.waitFor(2, java.util.concurrent.TimeUnit.MINUTES);\n","filename":"test\/jdk\/java\/awt\/FullScreen\/UninitializedDisplayModeChangeTest\/UninitializedDisplayModeChangeTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}