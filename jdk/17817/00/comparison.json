{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1994, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1994, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -844,1 +844,1 @@\n-            int coder = StringUTF16.coderFromArrayLen(val, len);\n+            byte coder = StringUTF16.coderFromArrayLen(val, caLen);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/String.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,0 +43,1 @@\n+import static org.testng.Assert.assertEquals;\n@@ -45,1 +46,0 @@\n-import org.testng.annotations.AfterClass;\n@@ -51,1 +51,1 @@\n- * @bug 8201276 8205058 8209576 8287541 8288589\n+ * @bug 8201276 8205058 8209576 8287541 8288589 8325590\n@@ -64,0 +64,1 @@\n+    final static String TEXT_PERSON_CART_WHEELING = \"\\ud83e\\udd38\";\n@@ -157,1 +158,2 @@\n-            {testFiles[1], TEXT_UNICODE, UTF_8, UTF_8}\n+            {testFiles[1], TEXT_UNICODE, UTF_8, UTF_8},\n+            {testFiles[1], TEXT_PERSON_CART_WHEELING, UTF_16, UTF_16}\n@@ -307,0 +309,15 @@\n+    \/\/ Verify File.readString with UTF16 to confirm proper string length and contents.\n+    @Test\n+    public void regression_8325590() throws IOException {\n+        String original = \"ðŸ¤¸\";    \/\/ \"\\ud83e\\udd38\";\n+        Path tmp = Files.createTempFile(\"tmp\", \".txt\");\n+        Files.writeString(tmp, original, UTF_16);\n+        String actual = Files.readString(tmp, UTF_16);\n+        if (!actual.equals(original)) {\n+            System.out.printf(\"expected (%s), was (%s)\\n\", original, actual);\n+            System.out.printf(\"expected UTF_16 bytes: %s\\n\", Arrays.toString(original.getBytes(UTF_16)));\n+            System.out.printf(\"actual UTF_16 bytes: %s\\n\", Arrays.toString(actual.getBytes(UTF_16)));\n+        }\n+        assertEquals(actual, original, \"Round trip string mismatch with multi-byte encoding\");\n+    }\n+\n","filename":"test\/jdk\/java\/nio\/file\/Files\/ReadWriteString.java","additions":21,"deletions":4,"binary":false,"changes":25,"status":"modified"}]}