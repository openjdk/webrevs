{"files":[{"patch":"@@ -266,7 +266,12 @@\n-        } else if (contentLen == 0) {\n-            if (upgrade && rCode == 101) {\n-                o.setWrappedStream (new UpgradeOutputStream (this, ros));\n-                close = true;\n-            } else if (http10) {\n-                o.setWrappedStream (new UndefLengthOutputStream (this, ros));\n-                close = true;\n+        } else { \/* not a HEAD request or 304 response *\/\n+            if (contentLen == 0) {\n+                if (http10) {\n+                    o.setWrappedStream (new UndefLengthOutputStream (this, ros));\n+                    close = true;\n+                } else if (upgrade && rCode == 101) {\n+                    o.setWrappedStream (new UpgradeOutputStream (this, ros));\n+                    close = true;\n+                } else {\n+                    rspHdrs.set (\"Transfer-encoding\", \"chunked\");\n+                    o.setWrappedStream (new ChunkedOutputStream (this, ros));\n+                }\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/ExchangeImpl.java","additions":12,"deletions":7,"binary":false,"changes":19,"status":"modified"}]}