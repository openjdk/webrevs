{"files":[{"patch":"@@ -60,0 +60,1 @@\n+    boolean upgraded;\n@@ -309,0 +310,1 @@\n+            upgraded = true;\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/ExchangeImpl.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-        if (eof) {\n+        if (!t.upgraded) {\n@@ -51,1 +51,1 @@\n-        if (eof) {\n+        if (!t.upgraded) {\n@@ -67,1 +67,9 @@\n-}\n+\n+    @Override\n+    public byte[] readAllBytes() throws IOException {\n+        if (!t.upgraded) {\n+          return new byte[0];\n+        }\n+        throw new IOException(\"readAllBytes not supported for upgraded requests\");\n+    }\n+}\n\\ No newline at end of file\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/UpgradeInputStream.java","additions":11,"deletions":3,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -84,0 +84,2 @@\n+                    \tassertEquals(-1, msg.getRequestBody().read());\n+                        assertEquals(0, msg.getRequestBody().readAllBytes().length);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/SwitchingProtocolTest.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}