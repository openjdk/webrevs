{"files":[{"patch":"@@ -29,1 +29,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -39,1 +38,1 @@\n-    LinuxDebPackage create() throws ConfigException {\n+    LinuxDebPackage create() {\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxDebPackageBuilder.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -35,1 +35,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -38,1 +37,0 @@\n-import jdk.jpackage.internal.model.RuntimeLayout;\n@@ -41,0 +39,1 @@\n+import jdk.jpackage.internal.model.RuntimeLayout;\n@@ -49,4 +48,2 @@\n-    LinuxPackage create() throws ConfigException {\n-        if (literalName != null) {\n-            pkgBuilder.name(literalName);\n-        } else {\n+    LinuxPackage create() {\n+        pkgBuilder.name(Optional.ofNullable(literalName).orElseGet(() -> {\n@@ -54,2 +51,2 @@\n-            pkgBuilder.name(pkgBuilder.create().packageName().toLowerCase().replaceAll(\"[ _]\", \"-\"));\n-        }\n+            return pkgBuilder.create().packageName().toLowerCase().replaceAll(\"[ _]\", \"-\");\n+        }));\n@@ -59,4 +56,3 @@\n-        final var stdPkgType = tmpPkg.asStandardPackageType();\n-        if (stdPkgType.isPresent()) {\n-            validatePackageName(tmpPkg.packageName(), stdPkgType.orElseThrow());\n-        }\n+        tmpPkg.asStandardPackageType().ifPresent(stdPkgType -> {\n+            validatePackageName(tmpPkg.packageName(), stdPkgType);\n+        });\n@@ -84,1 +80,1 @@\n-    private LinuxPackage create(Package pkg) throws ConfigException {\n+    private LinuxPackage create(Package pkg) {\n@@ -140,2 +136,1 @@\n-    private static void validatePackageName(String packageName,\n-            StandardPackageType pkgType) throws ConfigException {\n+    private static void validatePackageName(String packageName, StandardPackageType pkgType) {\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxPackageBuilder.java","additions":10,"deletions":15,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -39,1 +38,1 @@\n-    LinuxRpmPackage create() throws ConfigException {\n+    LinuxRpmPackage create() {\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxRpmPackageBuilder.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -65,5 +64,2 @@\n-    Optional<AppImageSigningConfig> create() throws ConfigException {\n-        final var identityCfg = signingIdentityBuilder.create();\n-        if (identityCfg.isEmpty()) {\n-            return Optional.empty();\n-        } else {\n+    Optional<AppImageSigningConfig> create() {\n+        return signingIdentityBuilder.create().map(cfg -> {\n@@ -71,6 +67,8 @@\n-            return identityCfg.map(cfg -> {\n-                return new AppImageSigningConfig.Stub(cfg.identity(), signingIdentifierPrefix,\n-                        validatedEntitlements, cfg.keychain().map(Keychain::name),\n-                        Optional.ofNullable(entitlementsResourceName).orElse(\"entitlements.plist\"));\n-            });\n-        }\n+            return new AppImageSigningConfig.Stub(\n+                    Objects.requireNonNull(cfg.identity()),\n+                    Objects.requireNonNull(signingIdentifierPrefix),\n+                    validatedEntitlements,\n+                    cfg.keychain().map(Keychain::name),\n+                    Optional.ofNullable(entitlementsResourceName).orElse(\"entitlements.plist\")\n+            );\n+        });\n@@ -79,1 +77,1 @@\n-    private Optional<Path> validatedEntitlements() throws ConfigException {\n+    private Optional<Path> validatedEntitlements() {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/AppImageSigningConfigBuilder.java","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -31,2 +31,0 @@\n-import java.util.List;\n-import java.util.Set;\n@@ -35,0 +33,3 @@\n+import java.util.Set;\n+import jdk.jpackage.internal.model.AppImageLayout;\n+import jdk.jpackage.internal.model.AppImageSigningConfig;\n@@ -36,1 +37,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -40,2 +40,0 @@\n-import jdk.jpackage.internal.model.AppImageLayout;\n-import jdk.jpackage.internal.model.AppImageSigningConfig;\n@@ -95,1 +93,1 @@\n-    MacApplication create() throws ConfigException {\n+    MacApplication create() {\n@@ -139,1 +137,1 @@\n-    private static void validateAppVersion(Application app) throws ConfigException {\n+    private static void validateAppVersion(Application app) {\n@@ -159,1 +157,1 @@\n-    private MacApplicationBuilder createCopyForExternalInfoPlistFile() throws ConfigException {\n+    private MacApplicationBuilder createCopyForExternalInfoPlistFile() {\n@@ -190,6 +188,2 @@\n-    private Optional<AppImageSigningConfig> createSigningConfig() throws ConfigException {\n-        if (signingBuilder != null) {\n-            return signingBuilder.create();\n-        } else {\n-            return Optional.empty();\n-        }\n+    private Optional<AppImageSigningConfig> createSigningConfig() {\n+        return Optional.ofNullable(signingBuilder).flatMap(AppImageSigningConfigBuilder::create);\n@@ -198,1 +192,1 @@\n-    private String validatedBundleName() throws ConfigException {\n+    private String validatedBundleName() {\n@@ -217,1 +211,1 @@\n-    private String validatedBundleIdentifier() throws ConfigException {\n+    private String validatedBundleIdentifier() {\n@@ -241,1 +235,1 @@\n-    private String validatedCategory() throws ConfigException {\n+    private String validatedCategory() {\n@@ -245,6 +239,2 @@\n-    private Optional<Path> validatedIcon() throws ConfigException {\n-        if (icon != null) {\n-            LauncherBuilder.validateIcon(icon);\n-        }\n-\n-        return Optional.ofNullable(icon);\n+    private Optional<Path> validatedIcon() {\n+        return Optional.ofNullable(icon).map(LauncherBuilder::validateIcon);\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacApplicationBuilder.java","additions":13,"deletions":23,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -55,1 +54,1 @@\n-    MacDmgPackage create() throws ConfigException {\n+    MacDmgPackage create() {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacDmgPackageBuilder.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -38,1 +36,1 @@\n-    MacFileAssociation create(FileAssociation fa) throws ConfigException {\n+    MacFileAssociation create(FileAssociation fa) {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacFileAssociationBuilder.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -52,1 +51,1 @@\n-    MacPackage create() throws ConfigException {\n+    MacPackage create() {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacPackageBuilder.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -227,4 +227,6 @@\n-        return toSupplier(() -> {\n-            return new PackageBuilder(app, SignAppImagePackageType.VALUE).predefinedAppImage(\n-                    Objects.requireNonNull(env.appImageDir())).installDir(Path.of(\"\/foo\")).create();\n-        }).get();\n+        return new PackageBuilder(\n+                app,\n+                SignAppImagePackageType.VALUE\n+        ).predefinedAppImage(\n+                Objects.requireNonNull(env.appImageDir())\n+        ).installDir(Path.of(\"\/foo\")).create();\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacPackagingPipeline.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -45,1 +44,1 @@\n-    MacPkgPackage create() throws ConfigException {\n+    MacPkgPackage create() {\n@@ -51,8 +50,4 @@\n-    private Optional<PkgSigningConfig> createSigningConfig() throws ConfigException {\n-        if (signingBuilder != null) {\n-            return signingBuilder.create().map(cfg -> {\n-                return new PkgSigningConfig.Stub(cfg.identity(), cfg.keychain().map(Keychain::name));\n-            });\n-        } else {\n-            return Optional.empty();\n-        }\n+    private Optional<PkgSigningConfig> createSigningConfig() {\n+        return Optional.ofNullable(signingBuilder).flatMap(SigningIdentityBuilder::create).map(cfg -> {\n+            return new PkgSigningConfig.Stub(cfg.identity(), cfg.keychain().map(Keychain::name));\n+        });\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacPkgPackageBuilder.java","additions":5,"deletions":10,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -38,1 +37,1 @@\n-    static void validateRuntimeHasJliLib(RuntimeLayout runtimeLayout) throws ConfigException {\n+    static void validateRuntimeHasJliLib(RuntimeLayout runtimeLayout) {\n@@ -54,1 +53,1 @@\n-    static void validateRuntimeHasNoBinDir(RuntimeLayout runtimeLayout) throws ConfigException {\n+    static void validateRuntimeHasNoBinDir(RuntimeLayout runtimeLayout) {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacRuntimeValidator.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -85,1 +85,1 @@\n-    Optional<SigningConfig> create() throws ConfigException {\n+    Optional<SigningConfig> create() {\n@@ -93,1 +93,1 @@\n-    private Optional<Keychain> validatedKeychain() throws ConfigException {\n+    private Optional<Keychain> validatedKeychain() {\n@@ -97,1 +97,1 @@\n-    private SigningIdentity validatedSigningIdentity() throws ConfigException {\n+    private SigningIdentity validatedSigningIdentity() {\n@@ -145,1 +145,1 @@\n-            CertificateSelector certificateSelector, Optional<Keychain> keychain) throws ConfigException {\n+            CertificateSelector certificateSelector, Optional<Keychain> keychain) {\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/SigningIdentityBuilder.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-import java.util.stream.Collectors;\n@@ -42,1 +41,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -44,1 +42,0 @@\n-import jdk.jpackage.internal.model.JPackageException;\n@@ -53,1 +50,1 @@\n-    Application create() throws ConfigException {\n+    Application create() {\n@@ -59,14 +56,5 @@\n-        launchersAsList.stream().collect(Collectors.toMap(Launcher::name, x -> x, (a, b) -> {\n-            throw new JPackageException(I18N.format(\"error.launcher-duplicate-name\", a.name()));\n-        }));\n-\n-        final String effectiveName;\n-        if (name != null) {\n-            effectiveName = name;\n-        } else if (!launchersAsList.isEmpty()) {\n-            effectiveName = launchers.mainLauncher().name();\n-        } else {\n-            throw buildConfigException(\"error.no.name\").advice(\"error.no.name.advice\").create();\n-        }\n-\n-        Objects.requireNonNull(launchersAsList);\n+        final String effectiveName = Optional.ofNullable(name).or(() -> {\n+            return Optional.ofNullable(launchers).map(ApplicationLaunchers::mainLauncher).map(Launcher::name);\n+        }).orElseThrow(() -> {\n+            return buildConfigException(\"error.no.name\").advice(\"error.no.name.advice\").create();\n+        });\n@@ -82,1 +70,2 @@\n-                appImageLayout, Optional.ofNullable(runtimeBuilder), launchersAsList, Map.of());\n+                appImageLayout,\n+                Optional.ofNullable(runtimeBuilder), launchersAsList, Map.of());\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/ApplicationBuilder.java","additions":8,"deletions":19,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -44,1 +43,1 @@\n-    BuildEnv create() throws ConfigException {\n+    BuildEnv create() {\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/BuildEnvBuilder.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -53,1 +53,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -98,1 +97,1 @@\n-            Set<String> limitModules, List<String> options, List<LauncherStartupInfo> startupInfos) throws ConfigException {\n+            Set<String> limitModules, List<String> options, List<LauncherStartupInfo> startupInfos) {\n@@ -150,1 +149,1 @@\n-            Set<String> limitModules, List<String> options, List<LauncherStartupInfo> startupInfos) throws ConfigException {\n+            Set<String> limitModules, List<String> options, List<LauncherStartupInfo> startupInfos) {\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/JLinkRuntimeBuilder.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import static jdk.jpackage.internal.util.function.ThrowingConsumer.toConsumer;\n@@ -37,1 +36,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -39,1 +37,0 @@\n-import jdk.jpackage.internal.model.DefaultLauncherIcon;\n@@ -43,1 +40,0 @@\n-import jdk.jpackage.internal.util.PathUtils;\n@@ -46,1 +42,1 @@\n-import jdk.jpackage.internal.model.ResourceDirLauncherIcon;\n+import jdk.jpackage.internal.util.PathUtils;\n@@ -50,1 +46,1 @@\n-    Launcher create() throws ConfigException {\n+    Launcher create() {\n@@ -53,1 +49,1 @@\n-                .ifPresent(toConsumer(LauncherBuilder::validateIcon));\n+                .ifPresent(LauncherBuilder::validateIcon);\n@@ -126,1 +122,1 @@\n-    static void validateIcon(Path icon) throws ConfigException {\n+    static Path validateIcon(Path icon) {\n@@ -147,0 +143,2 @@\n+\n+        return icon;\n@@ -153,1 +151,1 @@\n-            List<FileAssociationGroup> groups, FileAssociationTraits faTraits) throws ConfigException {\n+            List<FileAssociationGroup> groups, FileAssociationTraits faTraits) {\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/LauncherBuilder.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -47,1 +46,1 @@\n-    Package create() throws ConfigException {\n+    Package create() {\n@@ -211,2 +210,1 @@\n-    private static Path mapInstallDir(Path installDir, PackageType pkgType)\n-            throws ConfigException {\n+    private static Path mapInstallDir(Path installDir, PackageType pkgType) {\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/PackageBuilder.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import static jdk.jpackage.internal.util.function.ThrowingSupplier.toSupplier;\n@@ -41,1 +40,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -115,2 +113,1 @@\n-    private static RuntimeBuilder createCopyingRuntimeBuilder(Path runtimeDir,\n-            Path... modulePath) throws ConfigException {\n+    private static RuntimeBuilder createCopyingRuntimeBuilder(Path runtimeDir, Path... modulePath) {\n@@ -150,1 +147,1 @@\n-            return toSupplier(() -> createCopyingRuntimeBuilder(\n+            return createCopyingRuntimeBuilder(\n@@ -152,2 +149,1 @@\n-                    Optional.ofNullable(thiz.modulePath).orElseGet(List::of).toArray(Path[]::new))\n-            ).get();\n+                    Optional.ofNullable(thiz.modulePath).orElseGet(List::of).toArray(Path[]::new));\n@@ -163,1 +159,1 @@\n-            return toSupplier(() -> JLinkRuntimeBuilder.createJLinkRuntimeBuilder(\n+            return JLinkRuntimeBuilder.createJLinkRuntimeBuilder(\n@@ -168,2 +164,1 @@\n-                    startupInfos)\n-            ).get();\n+                    startupInfos);\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/RuntimeBuilderBuilder.java","additions":5,"deletions":10,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -107,19 +107,0 @@\n-\n-    \/**\n-     * Throws the cause of the given {@link RuntimeException} exception\n-     * as {@link ConfigException} if the cause is of this type or re-throws the given\n-     * {@link RuntimeException} exception as-is otherwise.\n-     * <p>\n-     * Never return a value. It always throws some exception object.\n-     *\n-     * @param ex exception to re-throw\n-     * @return doesn't return value\n-     * @throws ConfigException\n-     *\/\n-    public static RuntimeException rethrowConfigException(RuntimeException ex) throws ConfigException {\n-        if (ex.getCause() instanceof ConfigException configEx) {\n-            throw configEx;\n-        } else {\n-            throw ex;\n-        }\n-    }\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/model\/ConfigException.java","additions":0,"deletions":19,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -40,5 +39,2 @@\n-    WinExePackage create() throws ConfigException {\n-        if (icon != null) {\n-            LauncherBuilder.validateIcon(icon);\n-        }\n-        return WinExePackage.create(pkg, Optional.ofNullable(icon));\n+    WinExePackage create() {\n+        return WinExePackage.create(pkg, Optional.ofNullable(icon).map(LauncherBuilder::validateIcon));\n","filename":"src\/jdk.jpackage\/windows\/classes\/jdk\/jpackage\/internal\/WinExePackageBuilder.java","additions":2,"deletions":6,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,1 +35,0 @@\n-\n@@ -37,1 +36,0 @@\n-import jdk.jpackage.internal.model.ConfigException;\n@@ -48,1 +46,1 @@\n-    WinMsiPackage create() throws ConfigException {\n+    WinMsiPackage create() {\n","filename":"src\/jdk.jpackage\/windows\/classes\/jdk\/jpackage\/internal\/WinMsiPackageBuilder.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,2 +27,0 @@\n-import static jdk.jpackage.internal.util.function.ThrowingSupplier.toSupplier;\n-\n@@ -39,1 +37,1 @@\n-        return Result.create(toSupplier(WixTool::createToolset)).map(WinSystemEnvironment::new);\n+        return Result.create(WixTool::createToolset).map(WinSystemEnvironment::new);\n","filename":"src\/jdk.jpackage\/windows\/classes\/jdk\/jpackage\/internal\/WinSystemEnvironment.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -92,1 +92,1 @@\n-    static WixToolset createToolset() throws ConfigException {\n+    static WixToolset createToolset() {\n","filename":"src\/jdk.jpackage\/windows\/classes\/jdk\/jpackage\/internal\/WixTool.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}