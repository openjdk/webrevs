{"files":[{"patch":"@@ -68,0 +68,1 @@\n+#include \"jvm.h\"\n@@ -91,0 +92,1 @@\n+#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -840,1 +842,0 @@\n-        vm_exit(0);\n@@ -843,1 +844,0 @@\n-        vm_exit(0);\n@@ -845,0 +845,2 @@\n+      ThreadToNativeFromVM ttnfv(THREAD);\n+      JVM_Halt(0);\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -435,2 +435,4 @@\n-  DynamicArchive::dump_at_exit(thread);\n-  assert(!thread->has_pending_exception(), \"must be\");\n+  if (CDSConfig::is_dumping_dynamic_archive()) {\n+    DynamicArchive::dump_at_exit(thread);\n+    assert(!thread->has_pending_exception(), \"must be\");\n+  }\n","filename":"src\/hotspot\/share\/runtime\/java.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}