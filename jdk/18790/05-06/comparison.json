{"files":[{"patch":"@@ -140,2 +140,1 @@\n-  assert(ProfileClassLinkage, \"already checked by the caller\");\n-  assert(log_is_enabled(Info, init), \"already checked by the caller\");\n+  assert(log_is_enabled(Info, perf, class, link), \"already checked by the caller\");\n@@ -1373,1 +1372,1 @@\n-  if (ProfileClassLinkage) {\n+  if (Arguments::perf_class_link()) {\n","filename":"src\/hotspot\/share\/classfile\/classLoader.cpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -113,0 +113,1 @@\n+  LOG_TAG(link) \\\n","filename":"src\/hotspot\/share\/logging\/logTag.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -66,0 +66,1 @@\n+#include \"runtime\/arguments.hpp\"\n@@ -1173,1 +1174,1 @@\n-  if (ProfileClassLinkage) {\n+  if (Arguments::perf_class_link()) {\n","filename":"src\/hotspot\/share\/oops\/method.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -127,0 +127,3 @@\n+\/\/ True if -Xlog:perf+class+link was specified\n+bool Arguments::_perf_class_link = false;\n+\n@@ -3767,8 +3770,6 @@\n-  if (log_is_enabled(Info, init)) {\n-    FLAG_SET_ERGO_IF_DEFAULT(ProfileClassLinkage, true);\n-  }\n-\n-  if (ProfileClassLinkage && !UsePerfData) {\n-    if (!FLAG_IS_DEFAULT(ProfileClassLinkage)) {\n-       warning(\"Disabling ProfileClassLinkage since UsePerfData is turned off.\");\n-       FLAG_SET_DEFAULT(ProfileClassLinkage, false);\n+  if (log_is_enabled(Info, perf, class, link)) {\n+    if (!UsePerfData) {\n+      warning(\"Disabling -Xlog:perf+class+link since UsePerfData is turned off.\");\n+      LogConfiguration::configure_stdout(LogLevel::Off, false, LOG_TAGS(perf, class, link));\n+    } else {\n+      _perf_class_link = true;\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":9,"deletions":8,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -255,0 +255,3 @@\n+  \/\/ true if -Xlog:perf+class+link is specified, default to false\n+  static bool _perf_class_link;\n+\n@@ -488,0 +491,2 @@\n+  static bool perf_class_link() { return _perf_class_link; }\n+\n","filename":"src\/hotspot\/share\/runtime\/arguments.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -1974,3 +1974,0 @@\n-  product(bool, ProfileClassLinkage, false, DIAGNOSTIC,                     \\\n-          \"Profile class loading, linking, and CP resolution\")              \\\n-                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -161,1 +161,1 @@\n-  LogStreamHandle(Info, init) log;\n+  LogStreamHandle(Info, perf, class, link) log;\n@@ -163,3 +163,1 @@\n-    if (ProfileClassLinkage) {\n-      ClassLoader::print_counters(st);\n-    }\n+    ClassLoader::print_counters(st);\n","filename":"src\/hotspot\/share\/runtime\/java.cpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -59,0 +59,1 @@\n+#include \"runtime\/arguments.hpp\"\n@@ -2575,1 +2576,1 @@\n-  if (ProfileClassLinkage) {\n+  if (Arguments::perf_class_link()) {\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -831,2 +831,2 @@\n-  if (ProfileClassLinkage) {\n-    LogStreamHandle(Info, init) log;\n+  if (Arguments::perf_class_link()) {\n+    LogStreamHandle(Info, perf, class, link) log;\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}