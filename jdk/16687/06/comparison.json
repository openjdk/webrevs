{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -447,1 +447,1 @@\n-                CERT_SYSTEM_STORE_LOCAL_MACHINE, pszCertStoreName);\n+                CERT_SYSTEM_STORE_LOCAL_MACHINE | CERT_STORE_MAXIMUM_ALLOWED_FLAG, pszCertStoreName);\n@@ -801,0 +801,4 @@\n+            DWORD keysetType;\n+            ::CryptGetProvParam((HCRYPTPROV)hCryptProv, PP_KEYSET_TYPE, \/\/deprecated\n+                (BYTE*)&keysetType, &cbData, 0);\n+\n@@ -803,1 +807,1 @@\n-                PROV_RSA_AES, 0) == FALSE)\n+                PROV_RSA_AES, 0 | keysetType) == FALSE)\n@@ -805,1 +809,0 @@\n-\n","filename":"src\/jdk.crypto.mscapi\/windows\/native\/libsunmscapi\/security.cpp","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,3 +48,2 @@\n-        var hasAdminPrivileges = detectIfRunningWithAdminPrivileges();\n-        var nmm = adminTest(\"windows-my-localmachine\", hasAdminPrivileges);\n-        var nrm = adminTest(\"windows-root-localmachine\", hasAdminPrivileges);\n+        var nmm = test(\"windows-my-localmachine\");\n+        var nrm = test(\"windows-root-localmachine\");\n@@ -55,20 +54,0 @@\n-    private static boolean detectIfRunningWithAdminPrivileges() {\n-        try {\n-            Process p = Runtime.getRuntime().exec(\"reg query \\\"HKU\\\\S-1-5-19\\\"\");\n-            p.waitFor();\n-            return (p.exitValue() == 0);\n-        }\n-        catch (Exception ex) {\n-            System.out.println(\"Warning: unable to detect admin privileges, assuming none\");\n-            return false;\n-        }\n-    }\n-\n-    private static List<String> adminTest(String type, boolean hasAdminPrivileges) throws Exception {\n-        if (hasAdminPrivileges) {\n-            return test(type);\n-        }\n-        System.out.println(\"Ignoring: \" + type + \" as it requires admin privileges\");\n-        return null;\n-    }\n-\n","filename":"test\/jdk\/sun\/security\/mscapi\/AllTypes.java","additions":3,"deletions":24,"binary":false,"changes":27,"status":"modified"}]}