{"files":[{"patch":"@@ -447,1 +447,1 @@\n-                CERT_SYSTEM_STORE_LOCAL_MACHINE, pszCertStoreName);\n+                CERT_SYSTEM_STORE_LOCAL_MACHINE | CERT_STORE_MAXIMUM_ALLOWED_FLAG, pszCertStoreName);\n@@ -805,0 +805,9 @@\n+                \/\/ If the key is in a local machine store, we need to try again with CRYPT_MACHINE flag.\n+                \/\/ See https:\/\/learn.microsoft.com\/en-us\/troubleshoot\/windows-server\/windows-security\/cryptacquirecontext-troubleshooting\n+                if (GetLastError() != NTE_BAD_KEYSET \n+                        || ::CryptAcquireContext(&hCryptProvAlt, LPCSTR(pbData), NULL, \/\/deprecated\n+                                                 PROV_RSA_AES, CRYPT_MACHINE_KEYSET) == FALSE)\n+                {\n+                    ThrowException(env, SIGNATURE_EXCEPTION, GetLastError());\n+                    __leave;\n+                }\n@@ -806,2 +815,0 @@\n-                ThrowException(env, SIGNATURE_EXCEPTION, GetLastError());\n-                __leave;\n","filename":"src\/jdk.crypto.mscapi\/windows\/native\/libsunmscapi\/security.cpp","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"}]}