{"files":[{"patch":"@@ -29,0 +29,1 @@\n+import com.sun.tools.attach.AttachOperationFailedException;\n@@ -34,0 +35,1 @@\n+import java.net.URISyntaxException;\n@@ -45,0 +47,1 @@\n+import sun.jvmstat.monitor.MonitorException;\n@@ -254,1 +257,1 @@\n-    private String findTargetProcessTmpDirectory(long pid) throws AttachNotSupportedException {\n+    private String findTargetProcessTmpDirectory(long pid) throws IOException {\n@@ -258,6 +261,10 @@\n-         * 1. Caller and target processes share PID namespace and root filesystem (host to host or container to\n-         *    container with both \/tmp mounted between containers).\n-         * 2. Caller and target processes share PID namespace and root filesystem but the target process has elevated\n-         *    privileges (host to host).\n-         * 3. Caller and target processes share PID namespace but NOT root filesystem (container to container).\n-         * 4. Caller and target processes share neither PID namespace nor root filesystem (host to container)\n+         * 1. Caller and target processes share PID namespace and root\n+         *    filesystem (host to host or container to container with both \/tmp\n+         *    mounted between containers).\n+         * 2. Caller and target processes share PID namespace and root\n+         *    filesystem but the target process has elevated privileges\n+         *    (host to host).\n+         * 3. Caller and target processes share PID namespace but NOT root\n+         *    filesystem (container to container).\n+         * 4. Caller and target processes share neither PID namespace nor root\n+         *    filesystem (host to container)\n@@ -265,7 +272,5 @@\n-         * if target is elevated, we cant use \/proc\/<pid>\/... so we have to fallback to \/tmp, but that may not be shared\n-         * with the target\/attachee process, so we should check whether \/tmp on both is same. This method would throw\n-         * AttachNotSupportedException if they are different because we cannot make a connection with target VM.\n-         *\n-         * In addition, we can also check the target pid's signal masks to see if it catches SIGQUIT and only do so if in\n-         * fact it does ... this reduces the risk of killing an innocent process in the current ns as opposed to\n-         * attaching to the actual target JVM ... c.f: checkCatchesAndSendQuitTo() below.\n+         * if target is elevated, we cant use \/proc\/<pid>\/... so we have to\n+         * fallback to \/tmp, but that may not be shared with the target\/attachee\n+         * process, so we should check whether \/tmp on both is same. This method\n+         * would throw AttachOperationFailedException if they are different\n+         * because we cannot make a connection with target VM.\n@@ -280,1 +285,1 @@\n-                throw new AttachNotSupportedException(\"Unable to access the filesystem of the target process\");\n+                throw new AttachOperationFailedException(\"Unable to access the filesystem of the target process\");\n@@ -293,2 +298,0 @@\n-                } else {\n-                    throw new AttachNotSupportedException(\"Unable to access the filesystem of the target process\", ioe);\n@@ -296,6 +299,12 @@\n-            } catch (AttachNotSupportedException e) {\n-                \/\/ AttachNotSupportedException happened in above should go through\n-                throw e;\n-            } catch (Exception e) {\n-                \/\/ Other exceptions would be wrapped with AttachNotSupportedException\n-                throw new AttachNotSupportedException(\"Unable to access the filesystem of the target process\", e);\n+                \/\/ Throw original IOE if target process not found on localhost.\n+                throw ioe;\n+            } catch (URISyntaxException e) {\n+                \/\/ URISyntaxException is defined as a checked exception at\n+                \/\/ MonitoredHost.getMonitoredHost() if the URI string poorly\n+                \/\/ formed. However \"\/\/localhost\" is hard-coded at here, so the\n+                \/\/ exception should not happen.\n+                throw new AssertionError(\"Unexpected exception\", e);\n+            } catch (MonitorException e) {\n+                \/\/ Other exceptions (happened at MonitoredHost) would be wrapped\n+                \/\/ with AttachOperationFailedException.\n+                throw new AttachOperationFailedException(\"Unable to find target proces\", e);\n","filename":"src\/jdk.attach\/linux\/classes\/sun\/tools\/attach\/VirtualMachineImpl.java","additions":32,"deletions":23,"binary":false,"changes":55,"status":"modified"},{"patch":"@@ -65,13 +65,0 @@\n-    \/**\n-     * Constructs an <code>AttachNotSupportedException<\/code> with\n-     * the specified cause.\n-     *\n-     * @param   message the detail message.\n-     * @param   cause   the cause of this exception.\n-     *\n-     * @since 27\n-     *\/\n-    public AttachNotSupportedException(String message, Throwable cause) {\n-        super(message, cause);\n-    }\n-\n","filename":"src\/jdk.attach\/share\/classes\/com\/sun\/tools\/attach\/AttachNotSupportedException.java","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -53,0 +53,14 @@\n+\n+    \/**\n+     * Constructs an <code>AttachOperationFailedException<\/code> with\n+     * the specified cause.\n+     *\n+     * @param   message the detail message.\n+     * @param   cause   the cause of this exception.\n+     *\n+     * @since 27\n+     *\/\n+    public AttachOperationFailedException(String message, Throwable cause) {\n+        super(message, cause);\n+    }\n+\n","filename":"src\/jdk.attach\/share\/classes\/com\/sun\/tools\/attach\/AttachOperationFailedException.java","additions":15,"deletions":1,"binary":false,"changes":16,"status":"modified"}]}