{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -119,6 +119,11 @@\n-        if (initialize()) {\n-            \/\/ Assuming the default locales do not include any extensions, so\n-            \/\/ no stripping is needed here.\n-            Control c = Control.getNoFallbackControl(Control.FORMAT_DEFAULT);\n-            String displayLocale = getDefaultLocale(CAT_DISPLAY);\n-            Locale l = Locale.forLanguageTag(displayLocale.replace('_', '-'));\n+        \/\/ Assuming the default locales do not include any extensions, so\n+        \/\/ no stripping is needed here.\n+        Control c = Control.getNoFallbackControl(Control.FORMAT_DEFAULT);\n+        String displayLocale = getDefaultLocale(CAT_DISPLAY);\n+        Locale l = Locale.forLanguageTag(displayLocale.replace('_', '-'));\n+        tmpSet.addAll(c.getCandidateLocales(\"\", l));\n+        nativeDisplayLanguage = l.getLanguage();\n+\n+        String formatLocale = getDefaultLocale(CAT_FORMAT);\n+        if (!formatLocale.equals(displayLocale)) {\n+            l = Locale.forLanguageTag(formatLocale.replace('_', '-'));\n@@ -126,9 +131,0 @@\n-            nativeDisplayLanguage = l.getLanguage();\n-\n-            String formatLocale = getDefaultLocale(CAT_FORMAT);\n-            if (!formatLocale.equals(displayLocale)) {\n-                l = Locale.forLanguageTag(formatLocale.replace('_', '-'));\n-                tmpSet.addAll(c.getCandidateLocales(\"\", l));\n-            }\n-        } else {\n-            nativeDisplayLanguage = \"\";\n@@ -853,1 +849,0 @@\n-    private static native boolean initialize();\n","filename":"src\/java.base\/windows\/classes\/sun\/util\/locale\/provider\/HostLocaleProviderAdapterImpl.java","additions":12,"deletions":17,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -42,9 +42,0 @@\n-\/\/ global variables\n-typedef int (WINAPI *PGLIE)(const jchar *, LCTYPE, LPWSTR, int);\n-typedef int (WINAPI *PGCIE)(const jchar *, CALID, LPCWSTR, CALTYPE, LPWSTR, int, LPDWORD);\n-typedef int (WINAPI *PECIEE)(CALINFO_ENUMPROCEXEX, const jchar *, CALID, LPCWSTR, CALTYPE, LPARAM);\n-PGLIE pGetLocaleInfoEx;\n-PGCIE pGetCalendarInfoEx;\n-PECIEE pEnumCalendarInfoExEx;\n-BOOL initialized = FALSE;\n-\n@@ -181,25 +172,0 @@\n-\/*\n- * Class:     sun_util_locale_provider_HostLocaleProviderAdapterImpl\n- * Method:    initialize\n- * Signature: ()Z\n- *\/\n-JNIEXPORT jboolean JNICALL Java_sun_util_locale_provider_HostLocaleProviderAdapterImpl_initialize\n-  (JNIEnv *env, jclass cls) {\n-    if (!initialized) {\n-        pGetLocaleInfoEx = (PGLIE)GetProcAddress(\n-            GetModuleHandle(\"kernel32.dll\"),\n-            \"GetLocaleInfoEx\");\n-        pGetCalendarInfoEx = (PGCIE)GetProcAddress(\n-            GetModuleHandle(\"kernel32.dll\"),\n-            \"GetCalendarInfoEx\");\n-        pEnumCalendarInfoExEx = (PECIEE)GetProcAddress(\n-            GetModuleHandle(\"kernel32.dll\"),\n-            \"EnumCalendarInfoExEx\");\n-        initialized =TRUE;\n-    }\n-\n-    return pGetLocaleInfoEx != NULL &&\n-           pGetCalendarInfoEx != NULL &&\n-           pEnumCalendarInfoExEx != NULL;\n-}\n-\n@@ -771,7 +737,3 @@\n-    if (pGetLocaleInfoEx) {\n-        if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n-            \/\/ defaults to \"en\"\n-            return pGetLocaleInfoEx(L\"en\", type, data, buflen);\n-        } else {\n-            return pGetLocaleInfoEx((LPWSTR)langtag, type, data, buflen);\n-        }\n+    if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n+        \/\/ defaults to \"en\"\n+        return GetLocaleInfoEx(L\"en\", type, data, buflen);\n@@ -779,4 +741,1 @@\n-        \/\/ If we ever wanted to support WinXP, we will need extra module from\n-        \/\/ MS...\n-        \/\/ return GetLocaleInfo(DownlevelLocaleNameToLCID(langtag, 0), type, data, buflen);\n-        return 0;\n+        return GetLocaleInfoEx((LPWSTR)langtag, type, data, buflen);\n@@ -787,7 +746,3 @@\n-    if (pGetCalendarInfoEx) {\n-        if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n-            \/\/ defaults to \"en\"\n-            return pGetCalendarInfoEx(L\"en\", id, reserved, type, data, buflen, val);\n-        } else {\n-            return pGetCalendarInfoEx((LPWSTR)langtag, id, reserved, type, data, buflen, val);\n-        }\n+    if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n+        \/\/ defaults to \"en\"\n+        return GetCalendarInfoEx(L\"en\", id, reserved, type, data, buflen, val);\n@@ -795,4 +750,1 @@\n-        \/\/ If we ever wanted to support WinXP, we will need extra module from\n-        \/\/ MS...\n-        \/\/ return GetCalendarInfo(DownlevelLocaleNameToLCID(langtag, 0), ...);\n-        return 0;\n+        return GetCalendarInfoEx((LPWSTR)langtag, id, reserved, type, data, buflen, val);\n@@ -1003,9 +955,4 @@\n-    if (pEnumCalendarInfoExEx) {\n-        if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n-            \/\/ defaults to \"en\"\n-            return pEnumCalendarInfoExEx(&EnumCalendarInfoProc, L\"en\",\n-                calid, NULL, type, (LPARAM)buf);\n-        } else {\n-            return pEnumCalendarInfoExEx(&EnumCalendarInfoProc, langtag,\n-                calid, NULL, type, (LPARAM)buf);\n-        }\n+    if (wcscmp(L\"und\", (LPWSTR)langtag) == 0) {\n+        \/\/ defaults to \"en\"\n+        return EnumCalendarInfoExEx(&EnumCalendarInfoProc, L\"en\",\n+            calid, NULL, type, (LPARAM)buf);\n@@ -1013,1 +960,2 @@\n-        return 0;\n+        return EnumCalendarInfoExEx(&EnumCalendarInfoProc, langtag,\n+            calid, NULL, type, (LPARAM)buf);\n","filename":"src\/java.base\/windows\/native\/libjava\/HostLocaleProviderAdapter_md.c","additions":15,"deletions":67,"binary":false,"changes":82,"status":"modified"}]}