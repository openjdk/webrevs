{"files":[{"patch":"@@ -31,1 +31,1 @@\n-InlinePrinter::InlinePrinter(Arena* arena, bool enabled) : _enabled(enabled), _root(new(arena) IPInlineSite(nullptr, arena)) {\n+InlinePrinter::InlinePrinter(Arena* arena, bool enabled) : _enabled(enabled), _root(new(arena) IPInlineSite(nullptr, arena, 0)) {\n@@ -34,2 +34,1 @@\n-InlinePrinter::IPInlineAttempt::IPInlineAttempt(InliningResult result) : result(result) {\n-}\n+InlinePrinter::IPInlineAttempt::IPInlineAttempt(InliningResult result) : result(result) {}\n@@ -52,1 +51,1 @@\n-  _root->dump(tty, -1, -1);\n+  _root->dump(tty, -1);\n@@ -64,1 +63,3 @@\n-  if (_children.length() <= bci) {\n+  int index = (bci == -1) ? 0 : bci; \/\/ -1 is a special case for some intrinsics (e.g. java.lang.ref.reference.get)\n+  assert(index >= 0, \"index cannot be negative\");\n+  if (_children.length() <= index) {\n@@ -66,2 +67,2 @@\n-    auto child = new (_arena) IPInlineSite(callee, _arena);\n-    _children.at_put_grow(bci, child, nullptr);\n+    auto child = new (_arena) IPInlineSite(callee, _arena, bci);\n+    _children.at_put_grow(index, child, nullptr);\n@@ -70,1 +71,1 @@\n-  if (auto child = _children.at(bci)) {\n+  if (auto child = _children.at(index)) {\n@@ -73,2 +74,2 @@\n-  auto child = new (_arena) IPInlineSite(callee, _arena);\n-  _children.at_put(bci, child);\n+  auto child = new (_arena) IPInlineSite(callee, _arena, bci);\n+  _children.at_put(index, child);\n@@ -84,1 +85,1 @@\n-void InlinePrinter::IPInlineSite::dump(outputStream* tty, int level, int bci) {\n+void InlinePrinter::IPInlineSite::dump(outputStream* tty, int level) {\n@@ -86,1 +87,1 @@\n-    CompileTask::print_inlining_header(tty, _method, level, bci);\n+    CompileTask::print_inlining_header(tty, _method, level, _bci);\n@@ -88,2 +89,1 @@\n-  for (auto* attempt : _attempts) {\n-    assert(bci >= 0, \"BCI cannot be negative. Is there an inline attempt for the root?\");\n+  for (IPInlineAttempt* attempt : _attempts) {\n@@ -96,2 +96,1 @@\n-  for (int bci = 0; bci < _children.length(); bci++) {\n-    auto child = _children.at(bci);\n+  for (IPInlineSite* child : _children) {\n@@ -99,1 +98,1 @@\n-      child->dump(tty, level + 1, bci);\n+      child->dump(tty, level + 1);\n","filename":"src\/hotspot\/share\/opto\/printinlining.cpp","additions":16,"deletions":17,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+    int bci;\n@@ -48,0 +49,1 @@\n+    int const _bci;\n@@ -55,3 +57,3 @@\n-    IPInlineSite(ciMethod* method, Arena* arena) : _arena(arena), _method(method),\n-                                                   _attempts(arena, 2, 0, nullptr),\n-                                                   _children(arena, 2, 0, nullptr) {}\n+    IPInlineSite(ciMethod* method, Arena* arena, int bci) : _arena(arena), _method(method), _bci(bci),\n+                                                            _attempts(arena, 2, 0, nullptr),\n+                                                            _children(arena, 2, 0, nullptr) {}\n@@ -65,1 +67,1 @@\n-    void dump(outputStream* tty, int level, int bci);\n+    void dump(outputStream* tty, int level);\n","filename":"src\/hotspot\/share\/opto\/printinlining.hpp","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"}]}