{"files":[{"patch":"@@ -1738,1 +1738,1 @@\n-        if (listener == null) {\n+        if (localL == null) {\n","filename":"src\/java.desktop\/share\/classes\/java\/awt\/Toolkit.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-  @bug 4290704\n+  @bug 4290704 8357598\n@@ -41,5 +41,0 @@\n-            if (\"sun.awt.X11.XToolkit\".equals(tk.getClass().getName())) {\n-                System.out.println(\"Do not test for XAWT Toolkit.\");\n-                System.out.println(\"Passing automatically.\");\n-                return;\n-            }\n@@ -49,6 +44,1 @@\n-            AWTEventListener[] array1 = tk.getAWTEventListeners();\n-            if (array1 == null || array1.length != 0) {\n-                System.out.println(\"[Empty array test failed!!]\");\n-                throw new RuntimeException(\"Test failed -\" +\n-                    \" didn't return 0-sized array\");\n-            }\n+            verify(tk, 0);\n@@ -57,0 +47,12 @@\n+            \/\/ check that if a null listener is added, returns an empty array\n+            tk.addAWTEventListener(null, AWTEvent.ACTION_EVENT_MASK);\n+            verify(tk, 0);\n+            NullProxyListener nl = new NullProxyListener();\n+            tk.addAWTEventListener(nl, AWTEvent.ACTION_EVENT_MASK);\n+            verify(tk, 0);\n+            \/\/ check that if a null listener is removed, returns an empty array\n+            tk.removeAWTEventListener(null);\n+            verify(tk, 0);\n+            tk.removeAWTEventListener(nl);\n+            verify(tk, 0);\n+\n@@ -61,0 +63,1 @@\n+            verify(tk, 1);\n@@ -62,6 +65,1 @@\n-            array1 = tk.getAWTEventListeners();\n-            if (array1 == null || array1.length != 1) {\n-                System.out.println(\"[Simple add\/get test failed!!]\");\n-                throw new RuntimeException(\"Test failed - didn't \" +\n-                    \"return array of 1\");\n-            }\n+            AWTEventListener[] array1 = tk.getAWTEventListeners();\n@@ -168,0 +166,9 @@\n+    private static void verify(Toolkit tk, int expected) {\n+        AWTEventListener[] array = tk.getAWTEventListeners();\n+        if (array == null || array.length != expected) {\n+            System.out.println(\"[Simple test failed!!]\");\n+            throw new RuntimeException(\n+                    \"Test failed didn't return \" + expected + \"-sized array\");\n+        }\n+    }\n+\n@@ -172,0 +179,6 @@\n+\n+    public final static class NullProxyListener extends AWTEventListenerProxy {\n+        public NullProxyListener() {\n+            super(0, null);\n+        }\n+    }\n","filename":"test\/jdk\/java\/awt\/Toolkit\/AWTEventListenerProxyTest\/AWTEventListenerProxyTest.java","additions":32,"deletions":19,"binary":false,"changes":51,"status":"modified"}]}