{"files":[{"patch":"@@ -2393,0 +2393,1 @@\n+  declare_constant(CodeBlobKind::Number_Of_Kinds)                         \\\n","filename":"src\/hotspot\/share\/runtime\/vmStructs.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -68,0 +68,3 @@\n+  private static int NumberOfKinds;\n+\n+  private static Class[] wrapperClasses;\n@@ -104,0 +107,1 @@\n+    NumberOfKinds      = db.lookupIntConstant(\"CodeBlobKind::Number_Of_Kinds\").intValue();\n@@ -105,2 +109,21 @@\n-      ExceptionKind    = db.lookupIntConstant(\"CodeBlobKind::Exception\").intValue();\n-      UncommonTrapKind = db.lookupIntConstant(\"CodeBlobKind::UncommonTrap\").intValue();\n+        ExceptionKind    = db.lookupIntConstant(\"CodeBlobKind::Exception\").intValue();\n+        UncommonTrapKind = db.lookupIntConstant(\"CodeBlobKind::UncommonTrap\").intValue();\n+    } else {\n+        \/\/ Set invalid value to not match default.\n+        ExceptionKind    = NumberOfKinds + 1;\n+        UncommonTrapKind = NumberOfKinds + 1;\n+    }\n+\n+    wrapperClasses                     = new Class[NumberOfKinds];\n+    wrapperClasses[NMethodKind]        = NMethod.class;\n+    wrapperClasses[BufferKind]         = BufferBlob.class;\n+    wrapperClasses[AdapterKind]        = AdapterBlob.class;\n+    wrapperClasses[VtableKind]         = VtableBlob.class;\n+    wrapperClasses[MHAdapterKind]      = MethodHandlesAdapterBlob.class;\n+    wrapperClasses[RuntimeStubKind]    = RuntimeStub.class;\n+    wrapperClasses[DeoptimizationKind] = DeoptimizationBlob.class;\n+    wrapperClasses[SafepointKind]      = SafepointBlob.class;\n+    wrapperClasses[UpcallKind]         = UpcallStub.class;\n+    if (VM.getVM().isServerCompiler()) {\n+      wrapperClasses[ExceptionKind]    = ExceptionBlob.class;\n+      wrapperClasses[UncommonTrapKind] = UncommonTrapBlob.class;\n@@ -120,27 +143,1 @@\n-      if (cb.isNMethod()) {\n-          return NMethod.class;\n-      } else if (cb.isBufferBlob()) {\n-          return BufferBlob.class;\n-      } else if (cb.isAdapterBlob()) {\n-          return AdapterBlob.class;\n-      } else if (cb.isVtableBlob()) {\n-          return VtableBlob.class;\n-      } else if (cb.isMHAdapterBlob()) {\n-          return MethodHandlesAdapterBlob.class;\n-      } else if (cb.isRuntimeStub()) {\n-          return RuntimeStub.class;\n-      } else if (cb.isDeoptimizationBlob()) {\n-          return DeoptimizationBlob.class;\n-      } else if (cb.isSafepointBlob()) {\n-          return SafepointBlob.class;\n-      } else if (cb.isUpcallStub()) {\n-          return UpcallStub.class;\n-      }\n-      if (VM.getVM().isServerCompiler()) {\n-        if (cb.isExceptionBlob()) {\n-            return ExceptionBlob.class;\n-        } else if (cb.isUncommonTrapBlob()) {\n-            return UncommonTrapBlob.class;\n-        }\n-      }\n-      return null;\n+      return wrapperClasses[cb.getKind()];\n@@ -212,4 +209,1 @@\n-  public boolean isUncommonTrapBlob()   {\n-    if (!VM.getVM().isServerCompiler()) return false;\n-    return getKind() == UncommonTrapKind;\n-  }\n+  public boolean isUncommonTrapBlob()   { return getKind() == UncommonTrapKind; }\n@@ -217,4 +211,1 @@\n-  public boolean isExceptionBlob()      {\n-    if (!VM.getVM().isServerCompiler()) return false;\n-    return getKind() == ExceptionKind;\n-  }\n+  public boolean isExceptionBlob()      { return getKind() == ExceptionKind; }\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/code\/CodeBlob.java","additions":28,"deletions":37,"binary":false,"changes":65,"status":"modified"}]}