{"files":[{"patch":"@@ -1798,1 +1798,1 @@\n-    if (!java_thread->java_suspend(single_suspend)) {\n+    if (!java_thread->java_suspend(is_virtual && single_suspend)) {\n@@ -1858,1 +1858,1 @@\n-    if (!java_thread->java_resume(single_resume)) {\n+    if (!java_thread->java_resume(is_virtual && single_resume)) {\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -733,1 +733,1 @@\n-bool HandshakeState::suspend_with_handshake(bool update_vthread_list) {\n+bool HandshakeState::suspend_with_handshake(bool register_vthread_SR) {\n@@ -748,1 +748,1 @@\n-      set_suspended(true, update_vthread_list);\n+      set_suspended(true, register_vthread_SR);\n@@ -756,1 +756,1 @@\n-  set_suspended(true, update_vthread_list);\n+  set_suspended(true, register_vthread_SR);\n@@ -766,1 +766,1 @@\n-  bool _update_vthread_list;\n+  bool _register_vthread_SR;\n@@ -769,2 +769,2 @@\n-  SuspendThreadHandshake(bool update_vthread_list) : HandshakeClosure(\"SuspendThread\"),\n-    _update_vthread_list(update_vthread_list), _did_suspend(false) {}\n+  SuspendThreadHandshake(bool register_vthread_SR) : HandshakeClosure(\"SuspendThread\"),\n+    _register_vthread_SR(register_vthread_SR), _did_suspend(false) {}\n@@ -773,1 +773,1 @@\n-    _did_suspend = target->handshake_state()->suspend_with_handshake(_update_vthread_list);\n+    _did_suspend = target->handshake_state()->suspend_with_handshake(_register_vthread_SR);\n@@ -778,1 +778,1 @@\n-bool HandshakeState::suspend(bool update_vthread_list) {\n+bool HandshakeState::suspend(bool register_vthread_SR) {\n@@ -786,1 +786,1 @@\n-    set_suspended(true, update_vthread_list);\n+    set_suspended(true, register_vthread_SR);\n@@ -790,1 +790,1 @@\n-    SuspendThreadHandshake st(update_vthread_list);\n+    SuspendThreadHandshake st(register_vthread_SR);\n@@ -796,1 +796,1 @@\n-bool HandshakeState::resume(bool update_vthread_list) {\n+bool HandshakeState::resume(bool register_vthread_SR) {\n@@ -803,1 +803,1 @@\n-  set_suspended(false, update_vthread_list);\n+  set_suspended(false, register_vthread_SR);\n@@ -808,1 +808,1 @@\n-void HandshakeState::set_suspended(bool is_suspend, bool update_vthread_list) {\n+void HandshakeState::set_suspended(bool is_suspend, bool register_vthread_SR) {\n@@ -810,1 +810,2 @@\n-  if (update_vthread_list && _handshakee->is_vthread_mounted()) {\n+  if (register_vthread_SR) {\n+    assert(_handshakee->is_vthread_mounted(), \"sanity check\");\n","filename":"src\/hotspot\/share\/runtime\/handshake.cpp","additions":15,"deletions":14,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -176,1 +176,1 @@\n-  bool suspend_with_handshake(bool update_vthread_list);\n+  bool suspend_with_handshake(bool register_vthread_SR);\n@@ -182,1 +182,1 @@\n-  void set_suspended(bool to, bool update_vthread_list);\n+  void set_suspended(bool to, bool register_vthread_SR);\n@@ -186,2 +186,2 @@\n-  bool suspend(bool update_vthread_list);\n-  bool resume(bool update_vthread_list);\n+  bool suspend(bool register_vthread_SR);\n+  bool resume(bool register_vthread_SR);\n","filename":"src\/hotspot\/share\/runtime\/handshake.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1196,1 +1196,1 @@\n-bool JavaThread::java_suspend(bool update_vthread_list) {\n+bool JavaThread::java_suspend(bool register_vthread_SR) {\n@@ -1205,1 +1205,1 @@\n-  return this->handshake_state()->suspend(update_vthread_list);\n+  return this->handshake_state()->suspend(register_vthread_SR);\n@@ -1208,1 +1208,1 @@\n-bool JavaThread::java_resume(bool update_vthread_list) {\n+bool JavaThread::java_resume(bool register_vthread_SR) {\n@@ -1211,1 +1211,1 @@\n-  return this->handshake_state()->resume(update_vthread_list);\n+  return this->handshake_state()->resume(register_vthread_SR);\n","filename":"src\/hotspot\/share\/runtime\/javaThread.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -701,2 +701,2 @@\n-  bool java_suspend(bool update_vthread_list);\n-  bool java_resume(bool update_vthread_list);\n+  bool java_suspend(bool register_vthread_SR);\n+  bool java_resume(bool register_vthread_SR);\n","filename":"src\/hotspot\/share\/runtime\/javaThread.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}