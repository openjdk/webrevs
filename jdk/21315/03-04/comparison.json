{"files":[{"patch":"@@ -800,1 +800,2 @@\n-                getCurrencySymbol(), \/\/ possible currency init occurs here\n+                \/\/ Currency fields are lazy. Init via get call to ensure non-null\n+                getCurrencySymbol(),\n","filename":"src\/java.base\/share\/classes\/java\/text\/DecimalFormatSymbols.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import org.junit.jupiter.api.Test;\n@@ -40,0 +41,1 @@\n+import java.util.Currency;\n@@ -45,0 +47,1 @@\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n@@ -53,3 +56,3 @@\n-            .filter(m -> Modifier.isPublic(m.getModifiers()))\n-            .filter(m -> m.getName().startsWith(\"set\"))\n-            .filter(m -> Stream.of(m.getParameterTypes()).noneMatch(Class::isPrimitive))\n+            .filter(m -> Modifier.isPublic(m.getModifiers())\n+                    && m.getName().startsWith(\"set\")\n+                    && Stream.of(m.getParameterTypes()).noneMatch(Class::isPrimitive))\n@@ -82,0 +85,17 @@\n+    \/\/ Prior to 8341445, if the international currency symbol was invalid,\n+    \/\/ the currency attribute was set to null. However, we should not have null\n+    \/\/ currency fields post initializeCurrency() call. Ensure invalid code\n+    \/\/ does not update the other fields.\n+    @Test\n+    public void setInternationalCurrencySymbolFallbackTest() {\n+        var code = \"fooBarBazQux\";\n+        \/\/ initialize() should provide null for all currency related fields\n+        var dfs = new DecimalFormatSymbols(Locale.ROOT);\n+        \/\/ Load the fallbacks via initCurrency() since the loc is Locale.ROOT\n+        dfs.setInternationalCurrencySymbol(code); \/\/ set invalid code\n+        \/\/ Ensure our values are the expected fallbacks, minus the updated intl code\n+        assertEquals(Currency.getInstance(\"XXX\"), dfs.getCurrency());\n+        assertEquals(\"\\u00A4\", dfs.getCurrencySymbol());\n+        assertEquals(\"fooBarBazQux\", dfs.getInternationalCurrencySymbol());\n+    }\n+\n","filename":"test\/jdk\/java\/text\/Format\/DecimalFormat\/SettersShouldThrowNPETest.java","additions":23,"deletions":3,"binary":false,"changes":26,"status":"modified"}]}