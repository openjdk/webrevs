{"files":[{"patch":"@@ -2121,0 +2121,1 @@\n+  Events::log_nmethod_flush(Thread::current(), \"Flushing %s nmethod \" INTPTR_FORMAT,  is_osr_method() ? \"osr\" : \"\", p2i(this));\n@@ -2122,1 +2123,20 @@\n-  MutexLocker ml(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n+  LogTarget(Debug, codecache) lt;\n+  if (lt.is_enabled()) {\n+    ResourceMark rm;\n+    const char* name = method()->name()->as_C_string();\n+    const char* is_jvmci = \"\";\n+    const size_t codecache_capacity = CodeCache::capacity()\/1024;\n+    const size_t codecache_free_space = CodeCache::unallocated_capacity(CodeCache::get_code_blob_type(this))\/1024;\n+#if INCLUDE_JVMCI\n+    if (is_compiled_by_jvmci()) {\n+      if (jvmci_name() != nullptr) {\n+        name = jvmci_name();\n+      }\n+      is_jvmci = \"JVMCI compiled \";\n+    }\n+#endif\n+    log_debug(codecache)(\"Flushing nmethod %3d\/\" INTPTR_FORMAT \", level=%d, osr=%d, cold=%d, epoch=\" UINT64_FORMAT \", cold_count=\" UINT64_FORMAT \". \"\n+                       \"Cache capacity: %zuKb, free space: %zuKb. %smethod %s\",\n+                       _compile_id, p2i(this), _comp_level, is_osr_method(), is_cold(), _gc_epoch, CodeCache::cold_gc_count(),\n+                       codecache_capacity, codecache_free_space, is_jvmci, name);\n+  }\n@@ -2124,6 +2144,1 @@\n-  \/\/ completely deallocate this method\n-  Events::log_nmethod_flush(Thread::current(), \"flushing %s nmethod \" INTPTR_FORMAT, is_osr_method() ? \"osr\" : \"\", p2i(this));\n-  log_debug(codecache)(\"*flushing %s nmethod %3d\/\" INTPTR_FORMAT \". Live blobs:\" UINT32_FORMAT\n-                       \"\/Free CodeCache:%zuKb\",\n-                       is_osr_method() ? \"osr\" : \"\",_compile_id, p2i(this), CodeCache::blob_count(),\n-                       CodeCache::unallocated_capacity(CodeCache::get_code_blob_type(this))\/1024);\n+  MutexLocker ml(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":22,"deletions":7,"binary":false,"changes":29,"status":"modified"}]}