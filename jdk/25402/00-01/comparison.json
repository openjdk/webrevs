{"files":[{"patch":"@@ -2121,2 +2121,1 @@\n-  MutexLocker ml(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n-  ResourceMark rm;\n+  Events::log_nmethod_flush(Thread::current(), \"Flushing %s nmethod \" INTPTR_FORMAT,  is_osr_method() ? \"osr\" : \"\", p2i(this));\n@@ -2124,5 +2123,7 @@\n-  const char* name = method()->name()->as_C_string();\n-  const char* is_jvmci = \"\";\n-  const char* is_osr = is_osr_method() ? \"osr\" : \"\";\n-  const size_t codecache_capacity = CodeCache::capacity()\/1024;\n-  const size_t codecache_free_space = CodeCache::unallocated_capacity(CodeCache::get_code_blob_type(this))\/1024;\n+  LogTarget(Debug, codecache) lt;\n+  if (lt.is_enabled()) {\n+    ResourceMark rm;\n+    const char* name = method()->name()->as_C_string();\n+    const char* is_jvmci = \"\";\n+    const size_t codecache_capacity = CodeCache::capacity()\/1024;\n+    const size_t codecache_free_space = CodeCache::unallocated_capacity(CodeCache::get_code_blob_type(this))\/1024;\n@@ -2130,3 +2131,5 @@\n-  if (is_compiled_by_jvmci()) {\n-    if (jvmci_name() != nullptr) {\n-      name = jvmci_name();\n+    if (is_compiled_by_jvmci()) {\n+      if (jvmci_name() != nullptr) {\n+        name = jvmci_name();\n+      }\n+      is_jvmci = \"JVMCI compiled \";\n@@ -2134,2 +2137,0 @@\n-    is_jvmci = \"JVMCI compiled \";\n-  }\n@@ -2137,3 +2138,1 @@\n-  Events::log_nmethod_flush(Thread::current(), \"Flushing %s nmethod \" INTPTR_FORMAT, is_osr, p2i(this));\n-\n-  log_debug(codecache)(\"Flushing nmethod %3d\/\" INTPTR_FORMAT \", level=%d, osr=%d, cold=%d, epoch=\" UINT64_FORMAT \", cold_count=\" UINT64_FORMAT \". \"\n+    log_debug(codecache)(\"Flushing nmethod %3d\/\" INTPTR_FORMAT \", level=%d, osr=%d, cold=%d, epoch=\" UINT64_FORMAT \", cold_count=\" UINT64_FORMAT \". \"\n@@ -2143,0 +2142,3 @@\n+  }\n+\n+  MutexLocker ml(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":17,"deletions":15,"binary":false,"changes":32,"status":"modified"}]}