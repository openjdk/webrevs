{"files":[{"patch":"@@ -2978,1 +2978,0 @@\n-#define G1PPRL_GCEFF_FORMAT           \"  %14s\"\n@@ -3093,1 +3092,1 @@\n-  do_cset_groups();\n+  log_cset_candidate_groups();\n@@ -3113,1 +3112,24 @@\n-void G1PrintRegionLivenessInfoClosure::do_cset_groups() {\n+void G1PrintRegionLivenessInfoClosure::log_cset_candidate_group_add_total(G1CSetCandidateGroup* group, const char* type) {\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n+                          G1PPRL_GID_FORMAT\n+                          G1PPRL_LEN_FORMAT\n+                          G1PPRL_GID_GCEFF_FORMAT\n+                          G1PPRL_BYTE_FORMAT\n+                          G1PPRL_BYTE_FORMAT\n+                          G1PPRL_TYPE_H_FORMAT,\n+                          group->group_id(),\n+                          group->length(),\n+                          group->gc_efficiency(),\n+                          group->liveness(),\n+                          group->card_set()->mem_size(),\n+                          type);\n+  _total_remset_bytes += group->card_set()->mem_size();\n+}\n+\n+void G1PrintRegionLivenessInfoClosure::log_cset_candidate_grouplist(G1CSetCandidateGroupList& gl, const char* type) {\n+  for (G1CSetCandidateGroup* group : gl) {\n+    log_cset_candidate_group_add_total(group, type);\n+  }\n+}\n+\n+void G1PrintRegionLivenessInfoClosure::log_cset_candidate_groups() {\n@@ -3115,2 +3137,2 @@\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\" Collectionset Candidate Groups\");\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX \" Types: Y=Young Regions, M=From Marking Regions, R=Retained Regions\");\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\" Collection Set Candidate Groups\");\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX \" Types: Y=Young, M=From Marking Regions, R=Retained Regions\");\n@@ -3140,1 +3162,0 @@\n-  G1CSetCandidateGroup* young_only_cset_group =g1h->young_regions_cset_group();\n@@ -3142,1 +3163,2 @@\n-  _total_remset_bytes += young_only_cset_group->card_set()->mem_size();\n+  log_cset_candidate_group_add_total(g1h->young_regions_cset_group(), \"Y\");\n+  _total_remset_bytes += g1h->young_regions_cset_group()->card_set()->mem_size();\n@@ -3144,41 +3166,3 @@\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                          G1PPRL_GID_FORMAT\n-                          G1PPRL_LEN_FORMAT\n-                          G1PPRL_GCEFF_FORMAT\n-                          G1PPRL_BYTE_FORMAT\n-                          G1PPRL_BYTE_FORMAT\n-                          G1PPRL_TYPE_H_FORMAT,\n-                          young_only_cset_group->group_id(), young_only_cset_group->length(),\n-                          \"-\",\n-                          size_t(0), young_only_cset_group->card_set()->mem_size(),\n-                          \"Y\");\n-\n-  for (G1CSetCandidateGroup* group : g1h->policy()->candidates()->from_marking_groups()) {\n-    _total_remset_bytes += group->card_set()->mem_size();\n-    log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                            G1PPRL_GID_FORMAT\n-                            G1PPRL_LEN_FORMAT\n-                            G1PPRL_GID_GCEFF_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_TYPE_H_FORMAT,\n-                            group->group_id(), group->length(),\n-                            group->gc_efficiency(),\n-                            group->liveness(), group->card_set()->mem_size(),\n-                            \"M\");\n-  }\n-\n-  for (G1CSetCandidateGroup* group : g1h->policy()->candidates()->retained_groups()) {\n-    _total_remset_bytes += group->card_set()->mem_size();\n-    log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                            G1PPRL_GID_FORMAT\n-                            G1PPRL_LEN_FORMAT\n-                            G1PPRL_GID_GCEFF_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_TYPE_H_FORMAT,\n-                            group->group_id(), group->length(),\n-                            group->gc_efficiency(),\n-                            group->liveness(), group->card_set()->mem_size(),\n-                            \"R\");\n-  }\n+  G1CollectionSetCandidates* candidates = g1h->policy()->candidates();\n+  log_cset_candidate_grouplist(candidates->from_marking_groups(), \"M\");\n+  log_cset_candidate_grouplist(candidates->retained_groups(), \"R\");\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":32,"deletions":48,"binary":false,"changes":80,"status":"modified"},{"patch":"@@ -45,0 +45,2 @@\n+class G1CSetCandidateGroup;\n+class G1CSetCandidateGroupList;\n@@ -977,1 +979,3 @@\n-  void do_cset_groups();\n+  void log_cset_candidate_group_add_total(G1CSetCandidateGroup* gr, const char* type);\n+  void log_cset_candidate_grouplist(G1CSetCandidateGroupList& gl, const char* type);\n+  void log_cset_candidate_groups();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.hpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"}]}