{"files":[{"patch":"@@ -128,1 +128,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(this);\n+  ClassLoaderDataGraph::classes_do(this);\n","filename":"src\/hotspot\/share\/cds\/cdsHeapVerifier.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -216,1 +216,1 @@\n-  ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&closure);\n+  ClassLoaderDataGraph::loaded_cld_do(&closure);\n","filename":"src\/hotspot\/share\/cds\/classListWriter.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -205,1 +205,1 @@\n-    ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&collect_classes);\n+    ClassLoaderDataGraph::loaded_cld_do(&collect_classes);\n@@ -628,1 +628,1 @@\n-    \/\/ ClassLoaderDataGraph::loaded_cld_do_no_keepalive requires ClassLoaderDataGraph_lock.\n+    \/\/ ClassLoaderDataGraph::loaded_cld_do requires ClassLoaderDataGraph_lock.\n@@ -633,1 +633,1 @@\n-    ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&collect_cld);\n+    ClassLoaderDataGraph::loaded_cld_do(&collect_cld);\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -251,1 +251,1 @@\n-class ClassLoaderDataGraph::ClassLoaderDataGraphNoKeepAliveIterator : public StackObj {\n+class ClassLoaderDataGraph::ClassLoaderDataGraphIterator : public StackObj {\n@@ -259,1 +259,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator() : _next(ClassLoaderDataGraph::_head), _thread(Thread::current()), _hm(_thread) {\n+  ClassLoaderDataGraphIterator() : _next(ClassLoaderDataGraph::_head), _thread(Thread::current()), _hm(_thread) {\n@@ -278,2 +278,2 @@\n-void ClassLoaderDataGraph::loaded_cld_do_no_keepalive(CLDClosure* cl) {\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+void ClassLoaderDataGraph::loaded_cld_do(CLDClosure* cl) {\n+  ClassLoaderDataGraphIterator iter;\n@@ -287,2 +287,2 @@\n-void ClassLoaderDataGraph::classes_do_no_keepalive(KlassClosure* klass_closure) {\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+void ClassLoaderDataGraph::classes_do(KlassClosure* klass_closure) {\n+  ClassLoaderDataGraphIterator iter;\n@@ -294,2 +294,2 @@\n-void ClassLoaderDataGraph::classes_do_no_keepalive(void f(Klass* const)) {\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+void ClassLoaderDataGraph::classes_do(void f(Klass* const)) {\n+  ClassLoaderDataGraphIterator iter;\n@@ -301,2 +301,2 @@\n-void ClassLoaderDataGraph::methods_do_no_keepalive(void f(Method*)) {\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+void ClassLoaderDataGraph::methods_do(void f(Method*)) {\n+  ClassLoaderDataGraphIterator iter;\n@@ -310,1 +310,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -318,1 +318,1 @@\n-void ClassLoaderDataGraph::modules_do_no_keepalive(void f(ModuleEntry*)) {\n+void ClassLoaderDataGraph::modules_do(void f(ModuleEntry*)) {\n@@ -320,1 +320,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -326,1 +326,1 @@\n-void ClassLoaderDataGraph::packages_do_no_keepalive(void f(PackageEntry*)) {\n+void ClassLoaderDataGraph::packages_do(void f(PackageEntry*)) {\n@@ -328,1 +328,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -335,1 +335,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -348,1 +348,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -357,1 +357,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -370,1 +370,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -554,1 +554,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n@@ -570,1 +570,1 @@\n-  ClassLoaderDataGraphNoKeepAliveIterator iter;\n+  ClassLoaderDataGraphIterator iter;\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.cpp","additions":21,"deletions":21,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -42,1 +42,1 @@\n-  class ClassLoaderDataGraphNoKeepAliveIterator;\n+  class ClassLoaderDataGraphIterator;\n@@ -74,5 +74,4 @@\n-  \/\/ All the do_no_keepalive suffixed functions do not keep the CLD alive. Any\n-  \/\/ CLD OopHandles (modules, mirrors, resolved refs) resolved must be treated\n-  \/\/ as no keepalive. And requires that its CLD's holder is kept alive if they\n-  \/\/ escape the caller's safepoint or ClassLoaderDataGraph_lock critical\n-  \/\/ section.\n+  \/\/ All the do suffixed functions do not keep the CLD alive. Any CLD OopHandles\n+  \/\/ (modules, mirrors, resolved refs) resolved must be treated as no keepalive.\n+  \/\/ And requires that its CLD's holder is kept alive if they escape the\n+  \/\/ caller's safepoint or ClassLoaderDataGraph_lock critical section.\n@@ -80,1 +79,1 @@\n-  static void loaded_cld_do_no_keepalive(CLDClosure* cl);\n+  static void loaded_cld_do(CLDClosure* cl);\n@@ -86,3 +85,3 @@\n-  static void classes_do_no_keepalive(KlassClosure* klass_closure);\n-  static void classes_do_no_keepalive(void f(Klass* const));\n-  static void methods_do_no_keepalive(void f(Method*));\n+  static void classes_do(KlassClosure* klass_closure);\n+  static void classes_do(void f(Klass* const));\n+  static void methods_do(void f(Method*));\n@@ -90,2 +89,2 @@\n-  static void modules_do_no_keepalive(void f(ModuleEntry*));\n-  static void packages_do_no_keepalive(void f(PackageEntry*));\n+  static void modules_do(void f(ModuleEntry*));\n+  static void packages_do(void f(PackageEntry*));\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.hpp","additions":11,"deletions":12,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -539,1 +539,1 @@\n-    ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&cl);\n+    ClassLoaderDataGraph::loaded_cld_do(&cl);\n","filename":"src\/hotspot\/share\/classfile\/classLoaderHierarchyDCmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -168,1 +168,1 @@\n-  ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&clsc);\n+  ClassLoaderDataGraph::loaded_cld_do(&clsc);\n","filename":"src\/hotspot\/share\/classfile\/classLoaderStats.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -151,1 +151,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&closure);\n+  ClassLoaderDataGraph::classes_do(&closure);\n@@ -177,1 +177,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&closure);\n+  ClassLoaderDataGraph::classes_do(&closure);\n","filename":"src\/hotspot\/share\/classfile\/classPrinter.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -135,1 +135,1 @@\n-    ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&clean);\n+    ClassLoaderDataGraph::loaded_cld_do(&clean);\n","filename":"src\/hotspot\/share\/classfile\/protectionDomainCache.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1583,1 +1583,1 @@\n-void SystemDictionary::methods_do_no_keepalive(void f(Method*)) {\n+void SystemDictionary::methods_do(void f(Method*)) {\n@@ -1588,1 +1588,1 @@\n-    ClassLoaderDataGraph::methods_do_no_keepalive(f);\n+    ClassLoaderDataGraph::methods_do(f);\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -179,1 +179,0 @@\n-\n@@ -181,2 +180,2 @@\n-  \/\/ Will not keep metadata alive. See ClassLoaderDataGraph::methods_do_no_keepalive.\n-  static void methods_do_no_keepalive(void f(Method*));\n+  \/\/ Will not keep metadata alive. See ClassLoaderDataGraph::methods_do.\n+  static void methods_do(void f(Method*));\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.hpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -129,1 +129,1 @@\n-  ClassLoaderDataGraph::modules_do_no_keepalive(&module_dependency_event_callback);\n+  ClassLoaderDataGraph::modules_do(&module_dependency_event_callback);\n@@ -136,1 +136,1 @@\n-  ClassLoaderDataGraph::packages_do_no_keepalive(&module_export_event_callback);\n+  ClassLoaderDataGraph::packages_do(&module_export_event_callback);\n","filename":"src\/hotspot\/share\/jfr\/periodic\/jfrModuleEvent.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -622,1 +622,1 @@\n-    ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&clsc);\n+    ClassLoaderDataGraph::loaded_cld_do(&clsc);\n","filename":"src\/hotspot\/share\/jfr\/periodic\/jfrPeriodic.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -514,1 +514,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&do_klass_on_clear);\n+  ClassLoaderDataGraph::classes_do(&do_klass_on_clear);\n@@ -641,1 +641,1 @@\n-  ClassLoaderDataGraph::packages_do_no_keepalive(&do_package);\n+  ClassLoaderDataGraph::packages_do(&do_package);\n@@ -748,1 +748,1 @@\n-  ClassLoaderDataGraph::modules_do_no_keepalive(&do_module);\n+  ClassLoaderDataGraph::modules_do(&do_module);\n@@ -871,1 +871,1 @@\n-  ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&cld_cb);\n+  ClassLoaderDataGraph::loaded_cld_do(&cld_cb);\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/jfrTypeSet.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -183,1 +183,1 @@\n-      ClassLoaderDataGraph::classes_do_no_keepalive(&finder);\n+      ClassLoaderDataGraph::classes_do(&finder);\n","filename":"src\/hotspot\/share\/memory\/heapInspection.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -206,1 +206,1 @@\n-  ClassLoaderDataGraph::loaded_cld_do_no_keepalive(&cl); \/\/ collect data and optionally print\n+  ClassLoaderDataGraph::loaded_cld_do(&cl); \/\/ collect data and optionally print\n","filename":"src\/hotspot\/share\/memory\/metaspace\/metaspaceReporter.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -639,1 +639,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&cl);\n+  ClassLoaderDataGraph::classes_do(&cl);\n","filename":"src\/hotspot\/share\/memory\/universe.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -281,1 +281,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&adjust_and_clean_metadata);\n+  ClassLoaderDataGraph::classes_do(&adjust_and_clean_metadata);\n@@ -300,1 +300,1 @@\n-    ClassLoaderDataGraph::classes_do_no_keepalive(&check_class);\n+    ClassLoaderDataGraph::classes_do(&check_class);\n@@ -3703,3 +3703,3 @@\n-\/\/ use the ClassLoaderDataGraph::classes_do_no_keepalive() facility and\n-\/\/ this helper to fix up these pointers.  MethodData also points to old\n-\/\/ methods and must be cleaned.\n+\/\/ use the ClassLoaderDataGraph::classes_do() facility and this helper\n+\/\/ to fix up these pointers.  MethodData also points to old methods and\n+\/\/ must be cleaned.\n@@ -4186,4 +4186,4 @@\n-\/\/      ClassLoaderDataGraph::classes_do_no_keepalive() facility which\n-\/\/      only allows a helper method to be specified. The interesting\n-\/\/      parameters that we would like to pass to the helper method are\n-\/\/      saved in static global fields in the VM operation.\n+\/\/      ClassLoaderDataGraph::classes_do() facility which only allows\n+\/\/      a helper method to be specified. The interesting parameters\n+\/\/      that we would like to pass to the helper method are saved in\n+\/\/      static global fields in the VM operation.\n","filename":"src\/hotspot\/share\/prims\/jvmtiRedefineClasses.cpp","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -334,1 +334,1 @@\n-  \/\/ These static fields are needed by ClassLoaderDataGraph::classes_do_no_keepalive()\n+  \/\/ These static fields are needed by ClassLoaderDataGraph::classes_do()\n","filename":"src\/hotspot\/share\/prims\/jvmtiRedefineClasses.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -228,1 +228,1 @@\n-  ClassLoaderDataGraph::classes_do_no_keepalive(&closure);\n+  ClassLoaderDataGraph::classes_do(&closure);\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -128,1 +128,1 @@\n-    SystemDictionary::methods_do_no_keepalive(collect_profiled_methods);\n+    SystemDictionary::methods_do(collect_profiled_methods);\n@@ -180,1 +180,1 @@\n-  SystemDictionary::methods_do_no_keepalive(collect_invoked_methods);\n+  SystemDictionary::methods_do(collect_invoked_methods);\n","filename":"src\/hotspot\/share\/runtime\/java.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -990,1 +990,1 @@\n-    ClassLoaderDataGraph::classes_do_no_keepalive(&closure);\n+    ClassLoaderDataGraph::classes_do(&closure);\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2468,1 +2468,1 @@\n-      ClassLoaderDataGraph::classes_do_no_keepalive(&locked_load_classes);\n+      ClassLoaderDataGraph::classes_do(&locked_load_classes);\n@@ -2491,1 +2491,1 @@\n-      ClassLoaderDataGraph::classes_do_no_keepalive(&class_dumper);\n+      ClassLoaderDataGraph::classes_do(&class_dumper);\n","filename":"src\/hotspot\/share\/services\/heapDumper.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}