{"files":[{"patch":"@@ -480,0 +480,1 @@\n+  PhaseGVN& gvn = kit->gvn();\n@@ -482,1 +483,1 @@\n-  uint adr_idx = kit->C->get_alias_index(access.addr().type());\n+  uint adr_idx = kit->C->get_alias_index(gvn.type(adr)->isa_ptr());\n","filename":"src\/hotspot\/share\/gc\/g1\/c2\/g1BarrierSetC2.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -147,0 +147,1 @@\n+  Node* adr = access.addr().node();\n@@ -152,1 +153,1 @@\n-    store = kit->store_to_memory(kit->control(), access.addr().node(), val.node(), bt,\n+    store = kit->store_to_memory(kit->control(), adr, val.node(), bt,\n@@ -161,2 +162,1 @@\n-    const TypePtr* adr_type = access.addr().type();\n-    int alias = gvn.C->get_alias_index(adr_type);\n+    int alias = gvn.C->get_alias_index(gvn.type(adr)->isa_ptr());\n@@ -164,2 +164,1 @@\n-\n-    StoreNode* st = StoreNode::make(gvn, ctl, mem, access.addr().node(), adr_type, val.node(), bt, mo, requires_atomic_access);\n+    StoreNode* st = StoreNode::make(gvn, ctl, mem, adr, val.node(), bt, mo, requires_atomic_access);\n@@ -187,1 +186,0 @@\n-  const TypePtr* adr_type = access.addr().type();\n@@ -210,1 +208,1 @@\n-                            adr_type, val_type, access.type(), mo, dep, requires_atomic_access,\n+                            val_type, access.type(), mo, dep, requires_atomic_access,\n@@ -224,2 +222,2 @@\n-    Node* mem = mm->memory_at(gvn.C->get_alias_index(adr_type));\n-    load = LoadNode::make(gvn, control, mem, adr, adr_type, val_type, access.type(), mo, dep,\n+    Node* mem = mm->memory_at(gvn.C->get_alias_index(gvn.type(adr)->isa_ptr()));\n+    load = LoadNode::make(gvn, control, mem, adr, val_type, access.type(), mo, dep,\n@@ -461,2 +459,0 @@\n-  const TypePtr* adr_type = access.addr().type();\n-\n@@ -470,1 +466,1 @@\n-      load_store = new CompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, adr_type, value_type->make_narrowoop(), mo);\n+      load_store = new CompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, value_type->make_narrowoop(), mo);\n@@ -474,1 +470,1 @@\n-      load_store = new CompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, adr_type, value_type->is_oopptr(), mo);\n+      load_store = new CompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, value_type->is_oopptr(), mo);\n@@ -479,1 +475,1 @@\n-        load_store = new CompareAndExchangeBNode(kit->control(), mem, adr, new_val, expected_val, adr_type, mo);\n+        load_store = new CompareAndExchangeBNode(kit->control(), mem, adr, new_val, expected_val, mo);\n@@ -483,1 +479,1 @@\n-        load_store = new CompareAndExchangeSNode(kit->control(), mem, adr, new_val, expected_val, adr_type, mo);\n+        load_store = new CompareAndExchangeSNode(kit->control(), mem, adr, new_val, expected_val, mo);\n@@ -487,1 +483,1 @@\n-        load_store = new CompareAndExchangeINode(kit->control(), mem, adr, new_val, expected_val, adr_type, mo);\n+        load_store = new CompareAndExchangeINode(kit->control(), mem, adr, new_val, expected_val, mo);\n@@ -491,1 +487,1 @@\n-        load_store = new CompareAndExchangeLNode(kit->control(), mem, adr, new_val, expected_val, adr_type, mo);\n+        load_store = new CompareAndExchangeLNode(kit->control(), mem, adr, new_val, expected_val, mo);\n@@ -595,1 +591,0 @@\n-  const TypePtr* adr_type = access.addr().type();\n@@ -602,1 +597,1 @@\n-      load_store = kit->gvn().transform(new GetAndSetNNode(kit->control(), mem, adr, newval_enc, adr_type, value_type->make_narrowoop()));\n+      load_store = kit->gvn().transform(new GetAndSetNNode(kit->control(), mem, adr, newval_enc, value_type->make_narrowoop()));\n@@ -606,1 +601,1 @@\n-      load_store = new GetAndSetPNode(kit->control(), mem, adr, new_val, adr_type, value_type->is_oopptr());\n+      load_store = new GetAndSetPNode(kit->control(), mem, adr, new_val, value_type->is_oopptr());\n@@ -611,1 +606,1 @@\n-        load_store = new GetAndSetBNode(kit->control(), mem, adr, new_val, adr_type);\n+        load_store = new GetAndSetBNode(kit->control(), mem, adr, new_val);\n@@ -614,1 +609,1 @@\n-        load_store = new GetAndSetSNode(kit->control(), mem, adr, new_val, adr_type);\n+        load_store = new GetAndSetSNode(kit->control(), mem, adr, new_val);\n@@ -617,1 +612,1 @@\n-        load_store = new GetAndSetINode(kit->control(), mem, adr, new_val, adr_type);\n+        load_store = new GetAndSetINode(kit->control(), mem, adr, new_val);\n@@ -620,1 +615,1 @@\n-        load_store = new GetAndSetLNode(kit->control(), mem, adr, new_val, adr_type);\n+        load_store = new GetAndSetLNode(kit->control(), mem, adr, new_val);\n@@ -646,1 +641,0 @@\n-  const TypePtr* adr_type = access.addr().type();\n@@ -651,1 +645,1 @@\n-      load_store = new GetAndAddBNode(kit->control(), mem, adr, new_val, adr_type);\n+      load_store = new GetAndAddBNode(kit->control(), mem, adr, new_val);\n@@ -654,1 +648,1 @@\n-      load_store = new GetAndAddSNode(kit->control(), mem, adr, new_val, adr_type);\n+      load_store = new GetAndAddSNode(kit->control(), mem, adr, new_val);\n@@ -657,1 +651,1 @@\n-      load_store = new GetAndAddINode(kit->control(), mem, adr, new_val, adr_type);\n+      load_store = new GetAndAddINode(kit->control(), mem, adr, new_val);\n@@ -660,1 +654,1 @@\n-      load_store = new GetAndAddLNode(kit->control(), mem, adr, new_val, adr_type);\n+      load_store = new GetAndAddLNode(kit->control(), mem, adr, new_val);\n","filename":"src\/hotspot\/share\/gc\/shared\/c2\/barrierSetC2.cpp","additions":23,"deletions":29,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -94,3 +94,0 @@\n-  \/\/ Get the alias_index for raw card-mark memory\n-  int adr_type = Compile::AliasIdxRaw;\n-\n@@ -100,0 +97,1 @@\n+  assert(kit->C->get_alias_index(kit->gvn().type(card_adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n@@ -108,1 +106,1 @@\n-    Node* card_val = __ load( __ ctrl(), card_adr, TypeInt::BYTE, T_BYTE, adr_type);\n+    Node* card_val = __ load( __ ctrl(), card_adr, TypeInt::BYTE, T_BYTE);\n@@ -113,1 +111,1 @@\n-  __ store(__ ctrl(), card_adr, dirty, T_BYTE, adr_type, MemNode::unordered);\n+  __ store(__ ctrl(), card_adr, dirty, T_BYTE, MemNode::unordered);\n","filename":"src\/hotspot\/share\/gc\/shared\/c2\/cardTableBarrierSetC2.cpp","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+#include \"opto\/phaseX.hpp\"\n@@ -195,1 +196,1 @@\n-\n+  PhaseGVN& gvn = kit->gvn();\n@@ -218,1 +219,2 @@\n-  Node* ld = __ load(__ ctrl(), gc_state, TypeInt::BYTE, T_BYTE, Compile::AliasIdxRaw);\n+  assert(kit->C->get_alias_index(gvn.type(gc_state)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+  Node *ld = __ load(__ ctrl(), gc_state, TypeInt::BYTE, T_BYTE);\n@@ -226,1 +228,2 @@\n-    Node* index   = __ load(__ ctrl(), index_adr, TypeX_X, index_bt, Compile::AliasIdxRaw);\n+    assert(kit->C->get_alias_index(gvn.type(index_adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+    Node* index   = __ load(__ ctrl(), index_adr, TypeX_X, index_bt);\n@@ -236,1 +239,2 @@\n-      Node* buffer  = __ load(__ ctrl(), buffer_adr, TypeRawPtr::NOTNULL, T_ADDRESS, Compile::AliasIdxRaw);\n+      assert(kit->C->get_alias_index(gvn.type(buffer_adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+      Node* buffer  = __ load(__ ctrl(), buffer_adr, TypeRawPtr::NOTNULL, T_ADDRESS);\n@@ -246,1 +250,2 @@\n-        __ store(__ ctrl(), log_addr, pre_val, T_OBJECT, Compile::AliasIdxRaw, MemNode::unordered);\n+        assert(kit->C->get_alias_index(gvn.type(log_addr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+        __ store(__ ctrl(), log_addr, pre_val, T_OBJECT, MemNode::unordered);\n@@ -248,1 +253,2 @@\n-        __ store(__ ctrl(), index_adr, next_index, index_bt, Compile::AliasIdxRaw, MemNode::unordered);\n+        assert(kit->C->get_alias_index(gvn.type(index_adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+        __ store(__ ctrl(), index_adr, next_index, index_bt, MemNode::unordered);\n@@ -475,1 +481,1 @@\n-\n+  PhaseGVN& gvn = kit->gvn();\n@@ -485,1 +491,3 @@\n-  Node* curr_ct_base_addr = __ load( __ ctrl(), curr_ct_holder_addr, TypeRawPtr::NOTNULL, T_ADDRESS, Compile::AliasIdxRaw);\n+\n+  assert(kit->C->get_alias_index(gvn.type(curr_ct_holder_addr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+  Node* curr_ct_base_addr = __ load( __ ctrl(), curr_ct_holder_addr, TypeRawPtr::NOTNULL, T_ADDRESS);\n@@ -493,2 +501,0 @@\n-  \/\/ Get the alias_index for raw card-mark memory\n-  int adr_type = Compile::AliasIdxRaw;\n@@ -497,0 +503,1 @@\n+  assert(kit->C->get_alias_index(gvn.type(card_adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n@@ -505,1 +512,1 @@\n-    Node* card_val = __ load( __ ctrl(), card_adr, TypeInt::BYTE, T_BYTE, adr_type);\n+    Node* card_val = __ load( __ ctrl(), card_adr, TypeInt::BYTE, T_BYTE);\n@@ -510,1 +517,1 @@\n-  __ store(__ ctrl(), card_adr, zero, T_BYTE, adr_type, MemNode::unordered);\n+  __ store(__ ctrl(), card_adr, zero, T_BYTE, MemNode::unordered);\n@@ -564,1 +571,0 @@\n-  const TypePtr* adr_type = access.addr().type();\n@@ -581,2 +587,2 @@\n-\n-    uint adr_idx = kit->C->get_alias_index(adr_type);\n+    PhaseGVN& gvn = kit->gvn();\n+    uint adr_idx = kit->C->get_alias_index(gvn.type(adr)->isa_ptr());\n@@ -682,1 +688,0 @@\n-    const TypePtr* adr_type = access.addr().type();\n@@ -690,1 +695,1 @@\n-        load_store = kit->gvn().transform(new ShenandoahCompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, adr_type, value_type->make_narrowoop(), mo));\n+        load_store = kit->gvn().transform(new ShenandoahCompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, value_type->make_narrowoop(), mo));\n@@ -692,1 +697,1 @@\n-        load_store = kit->gvn().transform(new CompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, adr_type, value_type->make_narrowoop(), mo));\n+        load_store = kit->gvn().transform(new CompareAndExchangeNNode(kit->control(), mem, adr, newval_enc, oldval_enc, value_type->make_narrowoop(), mo));\n@@ -698,1 +703,1 @@\n-        load_store = kit->gvn().transform(new ShenandoahCompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, adr_type, value_type->is_oopptr(), mo));\n+        load_store = kit->gvn().transform(new ShenandoahCompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, value_type->is_oopptr(), mo));\n@@ -700,1 +705,1 @@\n-        load_store = kit->gvn().transform(new CompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, adr_type, value_type->is_oopptr(), mo));\n+        load_store = kit->gvn().transform(new CompareAndExchangePNode(kit->control(), mem, adr, new_val, expected_val, value_type->is_oopptr(), mo));\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/c2\/shenandoahBarrierSetC2.cpp","additions":25,"deletions":20,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -188,2 +188,2 @@\n-  ShenandoahCompareAndExchangePNode(Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, const Type* t, MemNode::MemOrd mem_ord)\n-    : CompareAndExchangePNode(c, mem, adr, val, ex, at, t, mem_ord) { }\n+  ShenandoahCompareAndExchangePNode(Node *c, Node *mem, Node *adr, Node *val, Node *ex, const Type* t, MemNode::MemOrd mem_ord)\n+    : CompareAndExchangePNode(c, mem, adr, val, ex, t, mem_ord) { }\n@@ -193,1 +193,1 @@\n-      return new CompareAndExchangePNode(in(MemNode::Control), in(MemNode::Memory), in(MemNode::Address), in(MemNode::ValueIn), in(ExpectedIn), adr_type(), bottom_type(), order());\n+      return new CompareAndExchangePNode(in(MemNode::Control), in(MemNode::Memory), in(MemNode::Address), in(MemNode::ValueIn), in(ExpectedIn), bottom_type(), order());\n@@ -203,2 +203,2 @@\n-  ShenandoahCompareAndExchangeNNode(Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, const Type* t, MemNode::MemOrd mem_ord)\n-    : CompareAndExchangeNNode(c, mem, adr, val, ex, at, t, mem_ord) { }\n+  ShenandoahCompareAndExchangeNNode(Node *c, Node *mem, Node *adr, Node *val, Node *ex, const Type* t, MemNode::MemOrd mem_ord)\n+    : CompareAndExchangeNNode(c, mem, adr, val, ex, t, mem_ord) { }\n@@ -208,1 +208,1 @@\n-      return new CompareAndExchangeNNode(in(MemNode::Control), in(MemNode::Memory), in(MemNode::Address), in(MemNode::ValueIn), in(ExpectedIn), adr_type(), bottom_type(), order());\n+      return new CompareAndExchangeNNode(in(MemNode::Control), in(MemNode::Memory), in(MemNode::Address), in(MemNode::ValueIn), in(ExpectedIn), bottom_type(), order());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/c2\/shenandoahSupport.hpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+#include \"opto\/memnode.hpp\"\n@@ -46,0 +47,1 @@\n+#include \"utilities\/debug.hpp\"\n@@ -1732,0 +1734,1 @@\n+\n@@ -1737,1 +1740,1 @@\n-    mark_node = LoadNode::make(*phase, control, mem, proto_adr, TypeRawPtr::BOTTOM, TypeX_X, TypeX_X->basic_type(), MemNode::unordered);\n+    mark_node = LoadNode::make(*phase, control, mem, proto_adr, TypeX_X, TypeX_X->basic_type(), MemNode::unordered);\n","filename":"src\/hotspot\/share\/opto\/callnode.cpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+#include \"opto\/phase.hpp\"\n@@ -47,0 +48,1 @@\n+#include \"opto\/type.hpp\"\n@@ -1579,1 +1581,1 @@\n-  Node* ld = LoadNode::make(_gvn, ctl, mem, adr, adr_type, t, bt, mo, control_dependency, require_atomic_access, unaligned, mismatched, unsafe, barrier_data);\n+  Node* ld = LoadNode::make(_gvn, ctl, mem, adr, t, bt, mo, control_dependency, require_atomic_access, unaligned, mismatched, unsafe, barrier_data);\n@@ -1607,1 +1609,1 @@\n-  Node* st = StoreNode::make(_gvn, ctl, mem, adr, adr_type, val, bt, mo, require_atomic_access);\n+  Node* st = StoreNode::make(_gvn, ctl, mem, adr, val, bt, mo, require_atomic_access);\n@@ -2997,2 +2999,1 @@\n-                                    adr->bottom_type()->is_ptr(), TypeInt::BYTE,\n-                                    T_BYTE, MemNode::acquire);\n+                                    TypeInt::BYTE, T_BYTE, MemNode::acquire);\n@@ -3010,1 +3011,0 @@\n-\n@@ -3014,1 +3014,0 @@\n-\n@@ -3016,2 +3015,1 @@\n-                                     adr->bottom_type()->is_ptr(), TypePtr::NOTNULL,\n-                                     T_ADDRESS, MemNode::unordered);\n+                                     TypePtr::NOTNULL, T_ADDRESS, MemNode::unordered);\n","filename":"src\/hotspot\/share\/opto\/graphKit.cpp","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -350,1 +350,0 @@\n-                     int adr_idx,\n@@ -354,1 +353,1 @@\n-\n+  int adr_idx = C->get_alias_index(_gvn.type(adr)->isa_ptr());\n@@ -359,1 +358,1 @@\n-  Node* ld = LoadNode::make(_gvn, ctl, mem, adr, adr_type, t, bt, mo, control_dependency, require_atomic_access);\n+  Node* ld = LoadNode::make(_gvn, ctl, mem, adr, t, bt, mo, control_dependency, require_atomic_access);\n@@ -364,1 +363,0 @@\n-                      int adr_idx,\n@@ -367,0 +365,1 @@\n+  int adr_idx = C->get_alias_index(_gvn.type(adr)->isa_ptr());\n@@ -368,2 +367,0 @@\n-  const TypePtr* adr_type = nullptr;\n-  DEBUG_ONLY(adr_type = C->get_adr_type(adr_idx));\n@@ -371,1 +368,1 @@\n-  Node* st = StoreNode::make(_gvn, ctl, mem, adr, adr_type, val, bt, mo, require_atomic_access);\n+  Node* st = StoreNode::make(_gvn, ctl, mem, adr, val, bt, mo, require_atomic_access);\n","filename":"src\/hotspot\/share\/opto\/idealKit.cpp","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -222,1 +222,0 @@\n-             int adr_idx,\n@@ -232,1 +231,0 @@\n-              int adr_idx,\n","filename":"src\/hotspot\/share\/opto\/idealKit.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -990,1 +990,1 @@\n-      ? LoadNode::make(_gvn, nullptr, immutable_memory(), p, p->bottom_type()->is_ptr(),\n+      ? LoadNode::make(_gvn, nullptr, immutable_memory(), p,\n@@ -3060,1 +3060,3 @@\n-  Node* notify_jvmti_enabled = ideal.load(ideal.ctrl(), addr, TypeInt::BOOL, T_BOOLEAN, Compile::AliasIdxRaw);\n+\n+  assert(C->get_alias_index(gvn().type(addr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+  Node* notify_jvmti_enabled = ideal.load(ideal.ctrl(), addr, TypeInt::BOOL, T_BOOLEAN);\n@@ -3142,1 +3144,3 @@\n-    Node* kls_trace_id_raw = ideal.load(ideal.ctrl(), kls_trace_id_addr,TypeLong::LONG, T_LONG, Compile::AliasIdxRaw);\n+\n+    assert(C->get_alias_index(gvn().type(kls_trace_id_addr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+    Node* kls_trace_id_raw = ideal.load(ideal.ctrl(), kls_trace_id_addr,TypeLong::LONG, T_LONG);\n@@ -3145,1 +3149,3 @@\n-    Node* epoch = ideal.load(ideal.ctrl(), epoch_address, TypeInt::BOOL, T_BOOLEAN, Compile::AliasIdxRaw);\n+\n+    assert(C->get_alias_index(gvn().type(epoch_address)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+    Node* epoch = ideal.load(ideal.ctrl(), epoch_address, TypeInt::BOOL, T_BOOLEAN);\n@@ -3170,1 +3176,3 @@\n-      Node* array_kls_trace_id_raw = ideal.load(ideal.ctrl(), array_kls_trace_id_addr, TypeLong::LONG, T_LONG, Compile::AliasIdxRaw);\n+\n+      assert(C->get_alias_index(gvn().type(array_kls_trace_id_addr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+      Node* array_kls_trace_id_raw = ideal.load(ideal.ctrl(), array_kls_trace_id_addr, TypeLong::LONG, T_LONG);\n@@ -3179,1 +3187,3 @@\n-    Node* signaled = ideal.load(ideal.ctrl(), signaled_flag_address, TypeInt::BOOL, T_BOOLEAN, Compile::AliasIdxRaw, true, MemNode::acquire);\n+\n+    assert(C->get_alias_index(gvn().type(signaled_flag_address)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+    Node* signaled = ideal.load(ideal.ctrl(), signaled_flag_address, TypeInt::BOOL, T_BOOLEAN, true, MemNode::acquire);\n@@ -3181,1 +3191,2 @@\n-      ideal.store(ideal.ctrl(), signaled_flag_address, ideal.ConI(1), T_BOOLEAN, Compile::AliasIdxRaw, MemNode::release, true);\n+      assert(C->get_alias_index(gvn().type(signaled_flag_address)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n+      ideal.store(ideal.ctrl(), signaled_flag_address, ideal.ConI(1), T_BOOLEAN, MemNode::release, true);\n","filename":"src\/hotspot\/share\/opto\/library_call.cpp","additions":18,"deletions":7,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -1158,2 +1158,1 @@\n-  const TypePtr* adr_type = adr->bottom_type()->is_ptr();\n-  Node* value = LoadNode::make(_igvn, ctl, mem, adr, adr_type, value_type, bt, MemNode::unordered);\n+  Node* value = LoadNode::make(_igvn, ctl, mem, adr, value_type, bt, MemNode::unordered);\n@@ -1167,1 +1166,1 @@\n-  mem = StoreNode::make(_igvn, ctl, mem, adr, nullptr, value, bt, MemNode::unordered);\n+  mem = StoreNode::make(_igvn, ctl, mem, adr, value, bt, MemNode::unordered);\n","filename":"src\/hotspot\/share\/opto\/macro.cpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -974,1 +974,1 @@\n-        mem = StoreNode::make(_igvn, ctrl, mem, p1, adr_type, intcon(0), T_INT, MemNode::unordered);\n+        mem = StoreNode::make(_igvn, ctrl, mem, p1, intcon(0), T_INT, MemNode::unordered);\n@@ -1030,1 +1030,1 @@\n-          LoadNode::make(_igvn, *ctrl, (*mem)->memory_at(s_alias_idx), sptr, s_adr_type,\n+          LoadNode::make(_igvn, *ctrl, (*mem)->memory_at(s_alias_idx), sptr,\n@@ -1034,1 +1034,1 @@\n-          StoreNode::make(_igvn, *ctrl, (*mem)->memory_at(d_alias_idx), dptr, adr_type,\n+          StoreNode::make(_igvn, *ctrl, (*mem)->memory_at(d_alias_idx), dptr,\n","filename":"src\/hotspot\/share\/opto\/macroArrayCopy.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -947,1 +947,1 @@\n-Node* LoadNode::make(PhaseGVN& gvn, Node* ctl, Node* mem, Node* adr, const TypePtr* adr_type, const Type* rt, BasicType bt, MemOrd mo,\n+Node* LoadNode::make(PhaseGVN& gvn, Node* ctl, Node* mem, Node* adr, const Type* rt, BasicType bt, MemOrd mo,\n@@ -950,0 +950,1 @@\n+  const TypePtr* adr_type = gvn.type(adr)->isa_ptr();\n@@ -1355,1 +1356,1 @@\n-                        raw_adr_type(), rt, bt, _mo, _control_dependency,\n+                        rt, bt, _mo, _control_dependency,\n@@ -1375,1 +1376,1 @@\n-                        raw_adr_type(), rt, bt, _mo, _control_dependency,\n+                        rt, bt, _mo, _control_dependency,\n@@ -1403,1 +1404,1 @@\n-                        raw_adr_type(), rt, bt, _mo, _control_dependency,\n+                        rt, bt, _mo, _control_dependency,\n@@ -1426,1 +1427,1 @@\n-                                  raw_adr_type(), val, bt, _mo, require_atomic_access);\n+                                  val, bt, _mo, require_atomic_access);\n@@ -2689,1 +2690,1 @@\n-StoreNode* StoreNode::make(PhaseGVN& gvn, Node* ctl, Node* mem, Node* adr, const TypePtr* adr_type, Node* val, BasicType bt, MemOrd mo, bool require_atomic_access) {\n+StoreNode* StoreNode::make(PhaseGVN& gvn, Node* ctl, Node* mem, Node* adr, Node* val, BasicType bt, MemOrd mo, bool require_atomic_access) {\n@@ -2692,0 +2693,1 @@\n+  const TypePtr* adr_type = gvn.type(adr)->isa_ptr();\n@@ -3335,2 +3337,0 @@\n-  const TypePtr* new_adr_type = _store->adr_type();\n-\n@@ -3346,1 +3346,1 @@\n-                                            new_adr_type, merged_input_value, bt, MemNode::unordered);\n+                                            merged_input_value, bt, MemNode::unordered);\n@@ -3912,1 +3912,1 @@\n-LoadStoreNode::LoadStoreNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at, const Type* rt, uint required )\n+LoadStoreNode::LoadStoreNode( Node *c, Node *mem, Node *adr, Node *val, const Type* rt, uint required )\n@@ -3915,1 +3915,0 @@\n-    _adr_type(at),\n@@ -3999,1 +3998,1 @@\n-LoadStoreConditionalNode::LoadStoreConditionalNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex ) : LoadStoreNode(c, mem, adr, val, nullptr, TypeInt::BOOL, 5) {\n+LoadStoreConditionalNode::LoadStoreConditionalNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex ) : LoadStoreNode(c, mem, adr, val, TypeInt::BOOL, 5) {\n@@ -4121,2 +4120,1 @@\n-    const TypePtr* atp = TypeRawPtr::BOTTOM;\n-    mem = StoreNode::make(*phase, ctl, mem, adr, atp, phase->zerocon(T_INT), T_INT, MemNode::unordered);\n+    mem = StoreNode::make(*phase, ctl, mem, adr, phase->zerocon(T_INT), T_INT, MemNode::unordered);\n@@ -4180,2 +4178,1 @@\n-    const TypePtr* atp = TypeRawPtr::BOTTOM;\n-    mem = StoreNode::make(*phase, ctl, mem, adr, atp, phase->zerocon(T_INT), T_INT, MemNode::unordered);\n+    mem = StoreNode::make(*phase, ctl, mem, adr, phase->zerocon(T_INT), T_INT, MemNode::unordered);\n@@ -5180,1 +5177,0 @@\n-    const TypePtr* atp = TypeRawPtr::BOTTOM;\n@@ -5186,0 +5182,2 @@\n+\n+    assert(phase->C->get_alias_index(phase->type(adr)->isa_ptr()) == Compile::AliasIdxRaw, \"Computed slice mismatch\");\n@@ -5189,1 +5187,1 @@\n-      st[nst++] = StoreNode::make(*phase, ctl, zmem, adr, atp,\n+      st[nst++] = StoreNode::make(*phase, ctl, zmem, adr,\n@@ -5196,1 +5194,1 @@\n-        st[nst++] = StoreNode::make(*phase, ctl, zmem, adr, atp,\n+        st[nst++] = StoreNode::make(*phase, ctl, zmem, adr,\n@@ -5204,1 +5202,1 @@\n-        st[nst++] = StoreNode::make(*phase, ctl, zmem, adr, atp,\n+        st[nst++] = StoreNode::make(*phase, ctl, zmem, adr,\n","filename":"src\/hotspot\/share\/opto\/memnode.cpp","additions":18,"deletions":20,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -236,2 +236,1 @@\n-  static Node* make(PhaseGVN& gvn, Node* c, Node* mem, Node* adr,\n-                    const TypePtr* at, const Type* rt, BasicType bt,\n+  static Node* make(PhaseGVN& gvn, Node* c, Node* mem, Node* adr, const Type* rt, BasicType bt,\n@@ -632,1 +631,1 @@\n-                         const TypePtr* at, Node* val, BasicType bt,\n+                         Node* val, BasicType bt,\n@@ -817,1 +816,0 @@\n-  const TypePtr* _adr_type;     \/\/ What kind of memory is being addressed?\n@@ -821,1 +819,1 @@\n-  LoadStoreNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at, const Type* rt, uint required );\n+  LoadStoreNode( Node *c, Node *mem, Node *adr, Node *val, const Type* rt, uint required );\n@@ -827,1 +825,0 @@\n-  virtual const class TypePtr *adr_type() const { return _adr_type; }  \/\/ returns bottom_type of address\n@@ -864,2 +861,2 @@\n-  CompareAndExchangeNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord, const TypePtr* at, const Type* t) :\n-    LoadStoreNode(c, mem, adr, val, at, t, 5), _mem_ord(mem_ord) {\n+  CompareAndExchangeNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord, const Type* t) :\n+    LoadStoreNode(c, mem, adr, val, t, 5), _mem_ord(mem_ord) {\n@@ -962,1 +959,1 @@\n-  CompareAndExchangeBNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, TypeInt::BYTE) { }\n+  CompareAndExchangeBNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, TypeInt::BYTE) { }\n@@ -970,1 +967,1 @@\n-  CompareAndExchangeSNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, TypeInt::SHORT) { }\n+  CompareAndExchangeSNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, TypeInt::SHORT) { }\n@@ -977,1 +974,1 @@\n-  CompareAndExchangeLNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, TypeLong::LONG) { }\n+  CompareAndExchangeLNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, TypeLong::LONG) { }\n@@ -985,1 +982,1 @@\n-  CompareAndExchangeINode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, TypeInt::INT) { }\n+  CompareAndExchangeINode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, TypeInt::INT) { }\n@@ -993,1 +990,1 @@\n-  CompareAndExchangePNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, const Type* t, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, t) { }\n+  CompareAndExchangePNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const Type* t, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, t) { }\n@@ -1000,1 +997,1 @@\n-  CompareAndExchangeNNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const TypePtr* at, const Type* t, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, at, t) { }\n+  CompareAndExchangeNNode( Node *c, Node *mem, Node *adr, Node *val, Node *ex, const Type* t, MemNode::MemOrd mem_ord) : CompareAndExchangeNode(c, mem, adr, val, ex, mem_ord, t) { }\n@@ -1007,1 +1004,1 @@\n-  GetAndAddBNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::BYTE, 4) { }\n+  GetAndAddBNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::BYTE, 4) { }\n@@ -1014,1 +1011,1 @@\n-  GetAndAddSNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::SHORT, 4) { }\n+  GetAndAddSNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::SHORT, 4) { }\n@@ -1021,1 +1018,1 @@\n-  GetAndAddINode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::INT, 4) { }\n+  GetAndAddINode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::INT, 4) { }\n@@ -1028,1 +1025,1 @@\n-  GetAndAddLNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeLong::LONG, 4) { }\n+  GetAndAddLNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeLong::LONG, 4) { }\n@@ -1035,1 +1032,1 @@\n-  GetAndSetBNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::BYTE, 4) { }\n+  GetAndSetBNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::BYTE, 4) { }\n@@ -1042,1 +1039,1 @@\n-  GetAndSetSNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::SHORT, 4) { }\n+  GetAndSetSNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::SHORT, 4) { }\n@@ -1049,1 +1046,1 @@\n-  GetAndSetINode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeInt::INT, 4) { }\n+  GetAndSetINode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeInt::INT, 4) { }\n@@ -1056,1 +1053,1 @@\n-  GetAndSetLNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at ) : LoadStoreNode(c, mem, adr, val, at, TypeLong::LONG, 4) { }\n+  GetAndSetLNode( Node *c, Node *mem, Node *adr, Node *val) : LoadStoreNode(c, mem, adr, val, TypeLong::LONG, 4) { }\n@@ -1063,1 +1060,1 @@\n-  GetAndSetPNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at, const Type* t ) : LoadStoreNode(c, mem, adr, val, at, t, 4) { }\n+  GetAndSetPNode( Node *c, Node *mem, Node *adr, Node *val, const Type* t ) : LoadStoreNode(c, mem, adr, val, t, 4) { }\n@@ -1070,1 +1067,1 @@\n-  GetAndSetNNode( Node *c, Node *mem, Node *adr, Node *val, const TypePtr* at, const Type* t ) : LoadStoreNode(c, mem, adr, val, at, t, 4) { }\n+  GetAndSetNNode( Node *c, Node *mem, Node *adr, Node *val, const Type* t ) : LoadStoreNode(c, mem, adr, val, t, 4) { }\n","filename":"src\/hotspot\/share\/opto\/memnode.hpp","additions":21,"deletions":24,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -1583,1 +1583,1 @@\n-      __ store(__ ctrl(), adr, val, T_BYTE, byte_adr_idx, MemNode::unordered);\n+      __ store(__ ctrl(), adr, val, T_BYTE, MemNode::unordered);\n@@ -1601,1 +1601,1 @@\n-      __ store(__ ctrl(), adr, __ ConI(val), T_CHAR, byte_adr_idx, MemNode::unordered, false \/* require_atomic_access *\/,\n+      __ store(__ ctrl(), adr, __ ConI(val), T_CHAR, MemNode::unordered, false \/* require_atomic_access *\/,\n@@ -1681,1 +1681,1 @@\n-    __ store(__ ctrl(), adr, val, T_BYTE, byte_adr_idx, MemNode::unordered);\n+    __ store(__ ctrl(), adr, val, T_BYTE, MemNode::unordered);\n@@ -1689,1 +1689,1 @@\n-    __ store(__ ctrl(), adr, val, T_CHAR, byte_adr_idx, MemNode::unordered, false \/* require_atomic_access *\/,\n+    __ store(__ ctrl(), adr, val, T_CHAR, MemNode::unordered, false \/* require_atomic_access *\/,\n","filename":"src\/hotspot\/share\/opto\/stringopts.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}