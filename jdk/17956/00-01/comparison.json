{"files":[{"patch":"@@ -82,1 +82,1 @@\n-    private boolean ksP12;\n+    private final boolean ksP12;\n@@ -106,1 +106,0 @@\n-        KeyStore keyStore = null;\n@@ -109,1 +108,1 @@\n-        for (int i = 0, n = builders.size(); i < n; i++) {\n+        for (Builder builder : builders) {\n@@ -111,2 +110,1 @@\n-                Builder builder = builders.get(i);\n-                keyStore = builder.getKeyStore();\n+                KeyStore keyStore = builder.getKeyStore();\n@@ -333,5 +331,1 @@\n-\n-            \/\/ Convert KeyStore certificates to X509Certificates\n-            X509Certificate[] newCerts = Arrays.copyOf(keyStoreCerts,\n-                    keyStoreCerts.length, X509Certificate[].class);\n-            return Arrays.equals(cachedCerts, newCerts);\n+            return Arrays.equals(cachedCerts, keyStoreCerts);\n@@ -339,0 +333,4 @@\n+            if (SSLLogger.isOn && SSLLogger.isOn(\"keymanager\")) {\n+                SSLLogger.fine(\"KeyMgr: exception occurred during getKeyStore() \" +\n+                        \"operation\");\n+            }\n@@ -352,1 +350,1 @@\n-        if (!(newEntry instanceof PrivateKeyEntry)) {\n+        if (!(newEntry instanceof PrivateKeyEntry privateKeyEntry)) {\n@@ -356,1 +354,0 @@\n-        PrivateKeyEntry privateKeyEntry = (PrivateKeyEntry) newEntry;\n@@ -358,1 +355,1 @@\n-        Certificate[] certs = privateKeyEntry.getCertificateChain();\n+        X509Certificate[] certs = (X509Certificate[]) privateKeyEntry.getCertificateChain();\n@@ -360,12 +357,1 @@\n-        if ((certs == null) || (certs.length == 0) ||\n-                !(certs[0] instanceof X509Certificate)) {\n-            return false;\n-        }\n-\n-        if (!(certs instanceof X509Certificate[])) {\n-            Certificate[] tmp = new X509Certificate[certs.length];\n-            System.arraycopy(certs, 0, tmp, 0, certs.length);\n-            certs = tmp;\n-        }\n-\n-        X509Certificate cert = (X509Certificate) certs[0];\n+        X509Certificate cert = certs[0];\n@@ -379,2 +365,1 @@\n-        X509Credentials cred = new X509Credentials(privateKey,\n-                (X509Certificate[]) certs);\n+        X509Credentials cred = new X509Credentials(privateKey, certs);\n@@ -410,0 +395,4 @@\n+            if (SSLLogger.isOn && SSLLogger.isOn(\"keymanager\")) {\n+                SSLLogger.fine(\"KeyMgr: exception occurred during processing \" +\n+                        \"credentials for a key in cached map\");\n+            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/X509KeyManagerImpl.java","additions":16,"deletions":27,"binary":false,"changes":43,"status":"modified"}]}