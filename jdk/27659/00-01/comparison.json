{"files":[{"patch":"@@ -82,0 +82,2 @@\n+serviceability\/jvmti\/NMethodRelocation\/NMethodRelocationTest.java 8369150 generic-all\n+\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Serial\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Serial\"\n@@ -42,1 +43,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Parallel\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Parallel\"\n@@ -54,1 +56,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.G1\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"G1\"\n@@ -66,1 +69,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Shenandoah\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Shenandoah\"\n@@ -78,1 +82,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Z\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Z\"\n","filename":"test\/hotspot\/jtreg\/compiler\/whitebox\/DeoptimizeRelocatedNMethod.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -32,1 +32,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Serial\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Serial\"\n@@ -47,1 +48,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Parallel\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Parallel\"\n@@ -62,1 +64,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.G1\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"G1\"\n@@ -77,1 +80,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Shenandoah\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Shenandoah\"\n@@ -92,1 +96,2 @@\n- * @requires vm.opt.DeoptimizeALot != true & vm.gc.Z\n+ * @requires vm.opt.DeoptimizeALot != true\n+ * @requires vm.gc == \"null\" | vm.gc == \"Z\"\n","filename":"test\/hotspot\/jtreg\/compiler\/whitebox\/RelocateNMethod.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @requires vm.gc.Serial\n+ * @requires vm.gc == \"null\" | vm.gc == \"Serial\"\n@@ -45,1 +45,1 @@\n- * @requires vm.gc.Serial\n+ * @requires vm.gc == \"null\" | vm.gc == \"Serial\"\n@@ -61,1 +61,1 @@\n- * @requires vm.gc.Parallel\n+ * @requires vm.gc == \"null\" | vm.gc == \"Parallel\"\n@@ -77,1 +77,1 @@\n- * @requires vm.gc.Parallel\n+ * @requires vm.gc == \"null\" | vm.gc == \"Parallel\"\n@@ -93,1 +93,1 @@\n- * @requires vm.gc.G1\n+ * @requires vm.gc == \"null\" | vm.gc == \"G1\"\n@@ -109,1 +109,1 @@\n- * @requires vm.gc.G1\n+ * @requires vm.gc == \"null\" | vm.gc == \"G1\"\n@@ -125,1 +125,1 @@\n- * @requires vm.gc.Shenandoah\n+ * @requires vm.gc == \"null\" | vm.gc == \"Shenandoah\"\n@@ -141,1 +141,1 @@\n- * @requires vm.gc.Shenandoah\n+ * @requires vm.gc == \"null\" | vm.gc == \"Shenandoah\"\n@@ -157,1 +157,1 @@\n- * @requires vm.gc.Z\n+ * @requires vm.gc == \"null\" | vm.gc == \"Z\"\n@@ -173,1 +173,1 @@\n- * @requires vm.gc.Z\n+ * @requires vm.gc == \"null\" | vm.gc == \"Z\"\n","filename":"test\/hotspot\/jtreg\/compiler\/whitebox\/RelocateNMethodMultiplePaths.java","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -34,3 +34,2 @@\n- * @run main\/othervm\/timeout=600 -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n- *                   -XX:+SegmentedCodeCache -XX:+TieredCompilation -XX:+UnlockExperimentalVMOptions\n- *                   -XX:+NMethodRelocation compiler.whitebox.StressNMethodRelocation\n+ * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ *                   -XX:+UnlockExperimentalVMOptions -XX:+NMethodRelocation compiler.whitebox.StressNMethodRelocation\n@@ -49,1 +48,1 @@\n-import java.util.Arrays;\n+import java.util.ArrayList;\n@@ -56,1 +55,0 @@\n-    private static final int ACTIVE_METHODS = 1024;\n@@ -58,1 +56,1 @@\n-    private static TestMethod[] methods;\n+    private static ArrayList<TestMethod> methods;\n@@ -62,1 +60,2 @@\n-    private static long DURATION = 60_000;\n+    private static long COMPILE_DURATION = 30_000;\n+    private static long RUN_DURATION = 60_000;\n@@ -69,1 +68,1 @@\n-        methods = new TestMethod[ACTIVE_METHODS];\n+        methods = new ArrayList<>();\n@@ -112,1 +111,1 @@\n-    private static void generateCode(TestMethod[] m) throws Exception {\n+    private static void generateCode(ArrayList<TestMethod> m) throws Exception {\n@@ -115,4 +114,6 @@\n-        for (int i = 0; i < ACTIVE_METHODS; ++i) {\n-            m[i] = new TestMethod();\n-            m[i].profile(num1, num2, result);\n-            m[i].compileWithC2();\n+        long startTime = System.currentTimeMillis();\n+        while (System.currentTimeMillis() - startTime < COMPILE_DURATION) {\n+            TestMethod testMethod = new TestMethod();\n+            testMethod.profile(num1, num2, result);\n+            testMethod.compileWithC2();\n+            m.add(testMethod);\n@@ -198,1 +199,1 @@\n-            while (System.currentTimeMillis() - startTime < DURATION) {\n+            while (System.currentTimeMillis() - startTime < RUN_DURATION) {\n@@ -224,1 +225,1 @@\n-                while (System.currentTimeMillis() - startTime < DURATION) {\n+                while (System.currentTimeMillis() - startTime < RUN_DURATION) {\n","filename":"test\/hotspot\/jtreg\/compiler\/whitebox\/StressNMethodRelocation.java","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n- * @requires vm.jvmti & vm.gc.Serial\n+ * @requires vm.jvmti\n+ * @requires vm.gc == \"null\" | vm.gc == \"Serial\"\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/NMethodRelocation\/NMethodRelocationTest.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}