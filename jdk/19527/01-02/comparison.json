{"files":[{"patch":"@@ -25,0 +25,5 @@\n+import java.io.ByteArrayInputStream;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n@@ -48,0 +53,10 @@\n+\n+    private static byte[] getSerializedBytes(CopyOnWriteArrayList<?> list) throws IOException {\n+        ByteArrayOutputStream bytesOut = new ByteArrayOutputStream();\n+        ObjectOutputStream objectOut = new ObjectOutputStream(bytesOut);\n+        objectOut.writeObject(list);\n+\n+        objectOut.close();\n+        return bytesOut.toByteArray();\n+    }\n+\n@@ -54,1 +69,1 @@\n-    private CopyOnWriteArrayList<?> defaultInstance = new CopyOnWriteArrayList<>();\n+    private CopyOnWriteArrayList<?> emptyInstance = new CopyOnWriteArrayList<>();\n@@ -57,0 +72,12 @@\n+    private byte[] emptyInstanceBytes;\n+    private byte[] oneInstanceBytes;\n+\n+    public CopyOnWriteArrayListBenchmark() {\n+        try {\n+            emptyInstanceBytes = getSerializedBytes(emptyInstance);\n+            oneInstanceBytes = getSerializedBytes(oneItemInstance);\n+        } catch (IOException e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+\n@@ -65,1 +92,1 @@\n-        defaultInstance.clear();\n+        emptyInstance.clear();\n@@ -92,0 +119,14 @@\n+\n+    @Benchmark\n+    public CopyOnWriteArrayList<?> readInstance() throws IOException, ClassNotFoundException {\n+        try (ObjectInputStream objIn = new ObjectInputStream(new ByteArrayInputStream(oneInstanceBytes))) {\n+            return (CopyOnWriteArrayList<?>) objIn.readObject();\n+        }\n+    }\n+\n+    @Benchmark\n+    public CopyOnWriteArrayList<?> readInstanceEmpty() throws IOException, ClassNotFoundException {\n+        try (ObjectInputStream objIn = new ObjectInputStream(new ByteArrayInputStream(emptyInstanceBytes))) {\n+            return (CopyOnWriteArrayList<?>) objIn.readObject();\n+        }\n+    }\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/util\/concurrent\/CopyOnWriteArrayListBenchmark.java","additions":43,"deletions":2,"binary":false,"changes":45,"status":"modified"}]}