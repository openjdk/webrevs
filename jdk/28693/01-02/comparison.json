{"files":[{"patch":"@@ -1963,0 +1963,81 @@\n+\/\/ Helper function to decode min\/max reduction operation properties\n+static void decode_minmax_reduction_opc(int opc, bool& is_min, bool& is_unsigned,\n+                                        Assembler::Condition& cond) {\n+  switch(opc) {\n+    case Op_MinReductionV:\n+      is_min = true;  is_unsigned = false; cond = Assembler::LT; break;\n+    case Op_MaxReductionV:\n+      is_min = false; is_unsigned = false; cond = Assembler::GT; break;\n+    case Op_UMinReductionV:\n+      is_min = true;  is_unsigned = true;  cond = Assembler::LO; break;\n+    case Op_UMaxReductionV:\n+      is_min = false; is_unsigned = true;  cond = Assembler::HI; break;\n+    default:\n+      ShouldNotReachHere();\n+  }\n+}\n+\n+\/\/ neon minp: pairwise minimum operation\n+void C2_MacroAssembler::neon_minp(bool is_unsigned, FloatRegister dst,\n+                                  SIMD_Arrangement size, FloatRegister src1,\n+                                  FloatRegister src2) {\n+  if (is_unsigned) {\n+    uminp(dst, size, src1, src2);\n+  } else {\n+    sminp(dst, size, src1, src2);\n+  }\n+}\n+\n+\/\/ neon maxp: pairwise maximum operation\n+void C2_MacroAssembler::neon_maxp(bool is_unsigned, FloatRegister dst,\n+                                  SIMD_Arrangement size, FloatRegister src1,\n+                                  FloatRegister src2) {\n+  if (is_unsigned) {\n+    umaxp(dst, size, src1, src2);\n+  } else {\n+    smaxp(dst, size, src1, src2);\n+  }\n+}\n+\n+\/\/ neon minv: reduction minimum operation\n+void C2_MacroAssembler::neon_minv(bool is_unsigned, FloatRegister dst,\n+                                  SIMD_Arrangement size, FloatRegister src) {\n+  if (is_unsigned) {\n+    uminv(dst, size, src);\n+  } else {\n+    sminv(dst, size, src);\n+  }\n+}\n+\n+\/\/ neon maxv: reduction maximum operation\n+void C2_MacroAssembler::neon_maxv(bool is_unsigned, FloatRegister dst,\n+                                  SIMD_Arrangement size, FloatRegister src) {\n+  if (is_unsigned) {\n+    umaxv(dst, size, src);\n+  } else {\n+    smaxv(dst, size, src);\n+  }\n+}\n+\n+\/\/ sve minv: reduction minimum operation\n+void C2_MacroAssembler::sve_minv(bool is_unsigned, FloatRegister dst,\n+                                 SIMD_RegVariant size, PRegister pg,\n+                                 FloatRegister src) {\n+  if (is_unsigned) {\n+    sve_uminv(dst, size, pg, src);\n+  } else {\n+    sve_sminv(dst, size, pg, src);\n+  }\n+}\n+\n+\/\/ sve maxv: reduction maximum operation\n+void C2_MacroAssembler::sve_maxv(bool is_unsigned, FloatRegister dst,\n+                                 SIMD_RegVariant size, PRegister pg,\n+                                 FloatRegister src) {\n+  if (is_unsigned) {\n+    sve_umaxv(dst, size, pg, src);\n+  } else {\n+    sve_smaxv(dst, size, pg, src);\n+  }\n+}\n+\n@@ -1976,5 +2057,4 @@\n-  bool is_min = (opc == Op_MinReductionV || opc == Op_UMinReductionV);\n-  bool is_unsigned = (opc == Op_UMinReductionV || opc == Op_UMaxReductionV);\n-  Assembler::Condition cond = is_min ? (is_unsigned ? Assembler::LO : Assembler::LT)\n-                                     : (is_unsigned ? Assembler::HI : Assembler::GT);\n-\n+  bool is_min;\n+  bool is_unsigned;\n+  Condition cond;\n+  decode_minmax_reduction_opc(opc, is_min, is_unsigned, cond);\n@@ -1996,5 +2076,2 @@\n-        if (is_unsigned) {\n-          is_min ? uminp(vtmp, size, vsrc, vsrc) : umaxp(vtmp, size, vsrc, vsrc);\n-        } else {\n-          is_min ? sminp(vtmp, size, vsrc, vsrc) : smaxp(vtmp, size, vsrc, vsrc);\n-        }\n+        is_min ? neon_minp(is_unsigned, vtmp, size, vsrc, vsrc)\n+               : neon_maxp(is_unsigned, vtmp, size, vsrc, vsrc);\n@@ -2003,5 +2080,2 @@\n-        if (is_unsigned) {\n-          is_min ? uminv(vtmp, size, vsrc) : umaxv(vtmp, size, vsrc);\n-        } else {\n-          is_min ? sminv(vtmp, size, vsrc) : smaxv(vtmp, size, vsrc);\n-        }\n+        is_min ? neon_minv(is_unsigned, vtmp, size, vsrc)\n+               : neon_maxv(is_unsigned, vtmp, size, vsrc);\n@@ -2099,7 +2173,6 @@\n-      bool is_unsigned = (opc == Op_UMaxReductionV || opc == Op_UMinReductionV);\n-      bool is_min = (opc == Op_MinReductionV || opc == Op_UMinReductionV);\n-      if (is_unsigned) {\n-        is_min ? sve_uminv(tmp, size, pg, src2) : sve_umaxv(tmp, size, pg, src2);\n-      } else {\n-        is_min ? sve_sminv(tmp, size, pg, src2) : sve_smaxv(tmp, size, pg, src2);\n-      }\n+      bool is_min;\n+      bool is_unsigned;\n+      Condition cond;\n+      decode_minmax_reduction_opc(opc, is_min, is_unsigned, cond);\n+      is_min ? sve_minv(is_unsigned, tmp, size, pg, src2)\n+             : sve_maxv(is_unsigned, tmp, size, pg, src2);\n@@ -2112,2 +2185,0 @@\n-      Assembler::Condition cond = is_min ? (is_unsigned ? Assembler::LO : Assembler::LT)\n-                                         : (is_unsigned ? Assembler::HI : Assembler::GT);\n","filename":"src\/hotspot\/cpu\/aarch64\/c2_MacroAssembler_aarch64.cpp","additions":95,"deletions":24,"binary":false,"changes":119,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,0 +37,14 @@\n+  \/\/ Helper functions for min\/max reduction operations\n+  void neon_minp(bool is_unsigned, FloatRegister dst, SIMD_Arrangement size,\n+                 FloatRegister src1, FloatRegister src2);\n+  void neon_maxp(bool is_unsigned, FloatRegister dst, SIMD_Arrangement size,\n+                 FloatRegister src1, FloatRegister src2);\n+  void neon_minv(bool is_unsigned, FloatRegister dst, SIMD_Arrangement size,\n+                 FloatRegister src);\n+  void neon_maxv(bool is_unsigned, FloatRegister dst, SIMD_Arrangement size,\n+                 FloatRegister src);\n+  void sve_minv(bool is_unsigned, FloatRegister dst, SIMD_RegVariant size,\n+                PRegister pg, FloatRegister src);\n+  void sve_maxv(bool is_unsigned, FloatRegister dst, SIMD_RegVariant size,\n+                PRegister pg, FloatRegister src);\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/c2_MacroAssembler_aarch64.hpp","additions":15,"deletions":1,"binary":false,"changes":16,"status":"modified"}]}