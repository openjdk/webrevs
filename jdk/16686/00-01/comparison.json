{"files":[{"patch":"@@ -530,2 +530,2 @@\n-  \/\/ JvmtiThreadState objects for virtual thread filtered events enabled globally\n-  \/\/ must be created eagerly if the interp_only_mode is enabled. Otherwise,\n+  \/\/ If interp_only_mode is enabled then we must eagerly create JvmtiThreadState\n+  \/\/ objects for globally enabled virtual thread filtered events. Otherwise,\n@@ -536,8 +536,6 @@\n-  if (JvmtiExport::can_support_virtual_threads()) {\n-    if (JvmtiExport::should_post_vthread_start()) {\n-      JvmtiExport::post_vthread_start(vthread);\n-    }\n-    \/\/ post VirtualThreadMount event after VirtualThreadStart\n-    if (JvmtiExport::should_post_vthread_mount()) {\n-      JvmtiExport::post_vthread_mount(vthread);\n-    }\n+  if (JvmtiExport::should_post_vthread_start()) {\n+    JvmtiExport::post_vthread_start(vthread);\n+  }\n+  \/\/ post VirtualThreadMount event after VirtualThreadStart\n+  if (JvmtiExport::should_post_vthread_mount()) {\n+    JvmtiExport::post_vthread_mount(vthread);\n@@ -554,8 +552,6 @@\n-  if (JvmtiExport::can_support_virtual_threads()) {\n-    \/\/ post VirtualThreadUnmount event before VirtualThreadEnd\n-    if (JvmtiExport::should_post_vthread_unmount()) {\n-      JvmtiExport::post_vthread_unmount(vthread);\n-    }\n-    if (JvmtiExport::should_post_vthread_end()) {\n-      JvmtiExport::post_vthread_end(vthread);\n-    }\n+  \/\/ post VirtualThreadUnmount event before VirtualThreadEnd\n+  if (JvmtiExport::should_post_vthread_unmount()) {\n+    JvmtiExport::post_vthread_unmount(vthread);\n+  }\n+  if (JvmtiExport::should_post_vthread_end()) {\n+    JvmtiExport::post_vthread_end(vthread);\n@@ -578,2 +574,1 @@\n-    if (JvmtiExport::can_support_virtual_threads() &&\n-        JvmtiExport::should_post_vthread_mount()) {\n+    if (JvmtiExport::should_post_vthread_mount()) {\n@@ -588,2 +583,1 @@\n-    if (JvmtiExport::can_support_virtual_threads() &&\n-        JvmtiExport::should_post_vthread_unmount()) {\n+    if (JvmtiExport::should_post_vthread_unmount()) {\n","filename":"src\/hotspot\/share\/prims\/jvmtiThreadState.cpp","additions":16,"deletions":22,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -234,1 +234,1 @@\n-  static bool _seen_interp_only_mode; \/\/ needed for optimization\n+  static bool _seen_interp_only_mode; \/\/ interp_only_mode was requested once\n@@ -255,3 +255,1 @@\n-  \/\/ JvmtiThreadState objects for virtual thread filtered events enabled globally\n-  \/\/ must be created eagerly if the interp_only_mode is enabled. Otherwise,\n-  \/\/ it is an important optimization to create JvmtiThreadState objects lazily.\n+  \/\/ Return true if any thread has entered interp_only_mode at any point during the JVMs execution.\n","filename":"src\/hotspot\/share\/prims\/jvmtiThreadState.hpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"}]}