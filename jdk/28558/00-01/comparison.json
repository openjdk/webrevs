{"files":[{"patch":"@@ -220,1 +220,1 @@\n-  if (page->requires_barriers()) {\n+  if (!page->allows_raw_null()) {\n","filename":"src\/hotspot\/share\/gc\/z\/zBarrierSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -74,2 +74,2 @@\n-bool ZPage::requires_barriers() const {\n-  return is_old() || AtomicAccess::load(&_relocate_promoted);\n+bool ZPage::allows_raw_null() const {\n+  return is_young() && !AtomicAccess::load(&_relocate_promoted);\n","filename":"src\/hotspot\/share\/gc\/z\/zPage.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -107,1 +107,1 @@\n-  bool requires_barriers() const;\n+  bool allows_raw_null() const;\n","filename":"src\/hotspot\/share\/gc\/z\/zPage.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -72,0 +72,7 @@\n+  void track_if_promoted(ZPage* page, ZForwarding* forwarding, ZArray<ZPage*>& relocate_promoted) {\n+    if (forwarding->is_promotion()) {\n+      page->set_is_relocate_promoted();\n+      relocate_promoted.append(page);\n+    }\n+  }\n+\n@@ -73,1 +80,1 @@\n-  ZRelocationSetInstallTask(ZForwardingAllocator* allocator, const ZRelocationSetSelector* selector, ZRelocationSet* relocation_set)\n+  ZRelocationSetInstallTask(ZRelocationSet* relocation_set, const ZRelocationSetSelector* selector)\n@@ -76,1 +83,1 @@\n-      _allocator(allocator),\n+      _allocator(&relocation_set->_allocator),\n@@ -99,7 +106,0 @@\n-  void track_if_promoted(ZPage* page, ZForwarding* forwarding, ZArray<ZPage*>& relocate_promoted) {\n-    if (forwarding->is_promotion()) {\n-      page->set_is_relocate_promoted();\n-      relocate_promoted.append(page);\n-    }\n-  }\n-\n@@ -132,3 +132,1 @@\n-    if (!relocate_promoted.is_empty()) {\n-      _relocation_set->register_relocate_promoted(relocate_promoted);\n-    }\n+    _relocation_set->register_relocate_promoted(relocate_promoted);\n@@ -174,1 +172,1 @@\n-  ZRelocationSetInstallTask task(&_allocator, selector, this);\n+  ZRelocationSetInstallTask task(this, selector);\n@@ -216,0 +214,4 @@\n+  if (pages.is_empty()) {\n+    return;\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/z\/zRelocationSet.cpp","additions":15,"deletions":13,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+  friend class ZRelocationSetInstallTask;\n","filename":"src\/hotspot\/share\/gc\/z\/zRelocationSet.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}