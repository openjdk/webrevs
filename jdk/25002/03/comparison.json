{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -262,3 +262,1 @@\n-                        TypeElement e2 = (TypeElement)\n-                            ((DeclaredType) supertype).asElement();\n-                        if (e2.getSuperclass().getKind() != TypeKind.NONE)\n+                        if (isImportantType(supertype))\n@@ -527,1 +525,1 @@\n-                             .map(tpe -> annotationsToString(tpe) + tpe.toString())\n+                             .map(tpe -> annotationsToString(tpe) + tpe.toString() + printTypeVariableBoundsIfNeeded(tpe))\n@@ -534,0 +532,16 @@\n+        private String printTypeVariableBoundsIfNeeded(TypeParameterElement tpe) {\n+            List<? extends TypeMirror> printableBounds =\n+                    tpe.getBounds()\n+                       .stream()\n+                       .filter(type -> isImportantType(type))\n+                       .toList();\n+\n+            if (printableBounds.isEmpty()) {\n+                return \"\";\n+            }\n+\n+            return \" extends \" + printableBounds.stream()\n+                                                .map(t -> t.toString())\n+                                                .collect(Collectors.joining(\" & \"));\n+        }\n+\n@@ -773,0 +787,17 @@\n+        \/**{@return true if this type is either not {@code java.lang.Object},\n+         * or is annotated, and hence needs to be included in the output,\n+         * even for cases where there's implicit {@code java.lang.Object} type.}\n+         *\n+         * @param type the type to check.\n+         *\/\n+        private boolean isImportantType(TypeMirror type) {\n+            if (!type.getAnnotationMirrors().isEmpty()) {\n+                return true;\n+            }\n+            TypeElement e2 = (TypeElement)\n+                ((DeclaredType) type).asElement();\n+            if (!e2.getKind().isClass()) {\n+                return true;\n+            }\n+            return e2.getSuperclass().getKind() != TypeKind.NONE;\n+        }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/processing\/PrintingProcessor.java","additions":36,"deletions":5,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -0,0 +1,87 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8356057\n+ * @summary Verify annotated supertypes and type variable bounds are printed properly\n+ * @compile\/ref=XprintTypeAnnotationsAndTypeVarBounds.out -Xprint  XprintTypeAnnotationsAndTypeVarBounds.java\n+ *\/\n+\n+import java.lang.annotation.*;\n+\n+class AnnotatedObjectSuperType extends @TA Object {\n+}\n+\n+class UnannotatedObjectSuperType extends Object {\n+}\n+\n+class TypeVariableWithAnnotation1<@TA T> {\n+}\n+\n+class TypeVariableWithAnnotation2<@TA T extends Object> {\n+}\n+\n+class TypeVariableWithBound1<T extends @TA Object> {\n+}\n+\n+class TypeVariableWithBound2<T extends @TA CharSequence> {\n+}\n+\n+class TypeVariableWithBound3<T extends @TA Object & CharSequence> {\n+}\n+\n+class TypeVariableWithBound4<T extends Object & @TA CharSequence> {\n+}\n+\n+class TypeVariableWithBound5<T extends CharSequence> {\n+}\n+\n+class TypeVariableWithBound6<T extends Object & CharSequence> {\n+}\n+\n+class TypeVariableBoundsOnMethods {\n+    public <@TA T> void test1() {}\n+    public <@TA T extends Object> void test2() {}\n+    public <T extends @TA Object> void test3() {}\n+    public <T extends @TA CharSequence> void test4() {}\n+    public <T extends @TA Object & CharSequence> void test5() {}\n+    public <T extends Object & @TA CharSequence> void test6() {}\n+    public <T extends CharSequence> void test7() {}\n+    public <T extends Object & CharSequence> void test8() {}\n+}\n+\n+class TypeVariableBoundsOnConstructors {\n+    public <@TA T> TypeVariableBoundsOnConstructors(boolean b) {}\n+    public <@TA T extends Object> TypeVariableBoundsOnConstructors(byte b) {}\n+    public <T extends @TA Object> TypeVariableBoundsOnConstructors(char c) {}\n+    public <T extends @TA CharSequence> TypeVariableBoundsOnConstructors(short s) {}\n+    public <T extends @TA Object & CharSequence> TypeVariableBoundsOnConstructors(int i) {}\n+    public <T extends Object & @TA CharSequence> TypeVariableBoundsOnConstructors(long l) {}\n+    public <T extends CharSequence> TypeVariableBoundsOnConstructors(float f) {}\n+    public <T extends Object & CharSequence> TypeVariableBoundsOnConstructors(double d) {}\n+}\n+\n+@Target(ElementType.TYPE_USE)\n+@interface TA {\n+}\n","filename":"test\/langtools\/tools\/javac\/processing\/options\/XprintTypeAnnotationsAndTypeVarBounds.java","additions":87,"deletions":0,"binary":false,"changes":87,"status":"added"},{"patch":"@@ -0,0 +1,94 @@\n+\n+class AnnotatedObjectSuperType extends java.lang.@TA Object {\n+\n+  AnnotatedObjectSuperType();\n+}\n+\n+class UnannotatedObjectSuperType {\n+\n+  UnannotatedObjectSuperType();\n+}\n+\n+class TypeVariableWithAnnotation1<@TA T> {\n+\n+  TypeVariableWithAnnotation1();\n+}\n+\n+class TypeVariableWithAnnotation2<@TA T> {\n+\n+  TypeVariableWithAnnotation2();\n+}\n+\n+class TypeVariableWithBound1<T extends java.lang.@TA Object> {\n+\n+  TypeVariableWithBound1();\n+}\n+\n+class TypeVariableWithBound2<T extends java.lang.@TA CharSequence> {\n+\n+  TypeVariableWithBound2();\n+}\n+\n+class TypeVariableWithBound3<T extends java.lang.@TA Object & java.lang.CharSequence> {\n+\n+  TypeVariableWithBound3();\n+}\n+\n+class TypeVariableWithBound4<T extends java.lang.@TA CharSequence> {\n+\n+  TypeVariableWithBound4();\n+}\n+\n+class TypeVariableWithBound5<T extends java.lang.CharSequence> {\n+\n+  TypeVariableWithBound5();\n+}\n+\n+class TypeVariableWithBound6<T extends java.lang.CharSequence> {\n+\n+  TypeVariableWithBound6();\n+}\n+\n+class TypeVariableBoundsOnMethods {\n+\n+  TypeVariableBoundsOnMethods();\n+\n+  public <@TA T> void test1();\n+\n+  public <@TA T> void test2();\n+\n+  public <T extends java.lang.@TA Object> void test3();\n+\n+  public <T extends java.lang.@TA CharSequence> void test4();\n+\n+  public <T extends java.lang.@TA Object & java.lang.CharSequence> void test5();\n+\n+  public <T extends java.lang.@TA CharSequence> void test6();\n+\n+  public <T extends java.lang.CharSequence> void test7();\n+\n+  public <T extends java.lang.CharSequence> void test8();\n+}\n+\n+class TypeVariableBoundsOnConstructors {\n+\n+  public <@TA T> TypeVariableBoundsOnConstructors(boolean b);\n+\n+  public <@TA T> TypeVariableBoundsOnConstructors(byte b);\n+\n+  public <T extends java.lang.@TA Object> TypeVariableBoundsOnConstructors(char c);\n+\n+  public <T extends java.lang.@TA CharSequence> TypeVariableBoundsOnConstructors(short s);\n+\n+  public <T extends java.lang.@TA Object & java.lang.CharSequence> TypeVariableBoundsOnConstructors(int i);\n+\n+  public <T extends java.lang.@TA CharSequence> TypeVariableBoundsOnConstructors(long l);\n+\n+  public <T extends java.lang.CharSequence> TypeVariableBoundsOnConstructors(float f);\n+\n+  public <T extends java.lang.CharSequence> TypeVariableBoundsOnConstructors(double d);\n+}\n+\n+@java.lang.annotation.Target({TYPE_USE})\n+@interface TA {\n+}\n\\ No newline at end of file\n","filename":"test\/langtools\/tools\/javac\/processing\/options\/XprintTypeAnnotationsAndTypeVarBounds.out","additions":94,"deletions":0,"binary":false,"changes":94,"status":"added"},{"patch":"@@ -5,1 +5,1 @@\n-public class GeneratedSource<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedSource<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -15,1 +15,1 @@\n-public class GeneratedClass<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedClass<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -26,1 +26,1 @@\n-public class GeneratedSource<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedSource<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -36,1 +36,1 @@\n-public class GeneratedClass<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedClass<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n","filename":"test\/langtools\/tools\/javac\/processing\/rounds\/OverwriteBetweenCompilations_1.out","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -4,1 +4,1 @@\n-public class GeneratedSource<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedSource<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -14,1 +14,1 @@\n-public class GeneratedClass<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedClass<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -25,1 +25,1 @@\n-public abstract class GeneratedSource<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedSource<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n@@ -33,1 +33,1 @@\n-public abstract class GeneratedClass<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedClass<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n@@ -42,1 +42,1 @@\n-public abstract class GeneratedSource<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedSource<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n@@ -50,1 +50,1 @@\n-public abstract class GeneratedClass<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedClass<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n","filename":"test\/langtools\/tools\/javac\/processing\/rounds\/OverwriteBetweenCompilations_2.out","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -4,1 +4,1 @@\n-public abstract class GeneratedSource<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedSource<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n@@ -12,1 +12,1 @@\n-public abstract class GeneratedClass<E> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n+public abstract class GeneratedClass<E extends java.lang.Number> extends java.util.LinkedList<java.lang.Number> implements java.lang.Runnable, java.lang.CharSequence {\n@@ -21,1 +21,1 @@\n-public class GeneratedSource<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedSource<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -31,1 +31,1 @@\n-public class GeneratedClass<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedClass<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -42,1 +42,1 @@\n-public class GeneratedSource<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedSource<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n@@ -52,1 +52,1 @@\n-public class GeneratedClass<T> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n+public class GeneratedClass<T extends java.lang.CharSequence> extends java.util.ArrayList<java.lang.String> implements java.lang.Runnable {\n","filename":"test\/langtools\/tools\/javac\/processing\/rounds\/OverwriteBetweenCompilations_3.out","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}