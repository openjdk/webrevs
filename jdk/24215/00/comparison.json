{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -86,1 +86,2 @@\n-                    throw new IllegalArgumentException(new ConfigException(\n+                    try {\n+                        throw new ConfigException(\n@@ -88,1 +89,1 @@\n-                            \"error.invalid-value-for-package-name\"), s),\n+                            \"error.deb-invalid-value-for-package-name\"), s),\n@@ -90,1 +91,4 @@\n-                            \"error.invalid-value-for-package-name.advice\")));\n+                            \"error.deb-invalid-value-for-package-name.advice\"));\n+                    } catch (ConfigException ex) {\n+                        throw new IllegalArgumentException(ex);\n+                    }\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxDebBundler.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -90,5 +90,9 @@\n-                    String msgKey = \"error.invalid-value-for-package-name\";\n-                    throw new IllegalArgumentException(\n-                            new ConfigException(MessageFormat.format(\n-                                    I18N.getString(msgKey), s),\n-                                    I18N.getString(msgKey + \".advice\")));\n+                    try {\n+                        throw new ConfigException(\n+                            MessageFormat.format(I18N.getString(\n+                            \"error.rpm-invalid-value-for-package-name\"), s),\n+                            I18N.getString(\n+                            \"error.rpm-invalid-value-for-package-name.advice\"));\n+                    } catch (ConfigException ex) {\n+                        throw new IllegalArgumentException(ex);\n+                    }\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxRpmBundler.java","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,2 +49,5 @@\n-error.invalid-value-for-package-name=Invalid value \"{0}\" for the bundle name.\n-error.invalid-value-for-package-name.advice=Set the \"linux-bundle-name\" option to a valid Debian package name. Note that the package names must consist only of lower case letters (a-z), digits (0-9), plus (+) and minus (-) signs, and periods (.). They must be at least two characters long and must start with an alphanumeric character.\n+error.deb-invalid-value-for-package-name=Invalid value \"{0}\" for the package name.\n+error.deb-invalid-value-for-package-name.advice=Set the \"--linux-package-name\" option to a valid Debian package name. Note that the package names must consist only of lower case letters (a-z), digits (0-9), plus (+) and minus (-) signs, and periods (.). They must be at least two characters long and must start with a letter character.\n+\n+error.rpm-invalid-value-for-package-name=Invalid value \"{0}\" for the package name.\n+error.rpm-invalid-value-for-package-name.advice=Set the \"--linux-package-name\" option to a valid RPM package name. Note that the package names must consist only of letters (a-z, A-Z), digits (0-9), plus (+) and minus (-) signs, periods (.) and underscores (_). They must be at least one character long and must start with a letter.\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/resources\/LinuxResources.properties","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -703,3 +703,1 @@\n-            bundler.validate(localParams);\n-            Path result = bundler.execute(localParams,\n-                    StandardBundlerParam.OUTPUT_DIR.fetchFrom(params));\n+            Path result = executeBundler(bundler, params, localParams);\n@@ -740,0 +738,18 @@\n+    private static Path executeBundler(Bundler bundler, Map<String, ? super Object> params,\n+            Map<String, ? super Object> localParams) throws ConfigException, PackagerException {\n+        try {\n+            bundler.validate(localParams);\n+            return bundler.execute(localParams, StandardBundlerParam.OUTPUT_DIR.fetchFrom(params));\n+        } catch (ConfigException|PackagerException ex) {\n+            throw ex;\n+        } catch (RuntimeException ex) {\n+            if (ex.getCause() instanceof ConfigException cfgEx) {\n+                throw cfgEx;\n+            } else if (ex.getCause() instanceof PackagerException pkgEx) {\n+                throw pkgEx;\n+            } else {\n+                throw ex;\n+            }\n+        }\n+    }\n+\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/Arguments.java","additions":19,"deletions":3,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -413,0 +413,1 @@\n+    @ParameterSupplier(value=\"testLinux\", ifOS = LINUX)\n@@ -588,0 +589,17 @@\n+    public static Collection<Object[]> testLinux() {\n+        final List<TestSpec> testCases = new ArrayList<>();\n+\n+        testCases.addAll(Stream.of(\n+                testSpec().type(PackageType.LINUX_DEB).addArgs(\"--linux-package-name\", \"#\")\n+                        .error(\"error.deb-invalid-value-for-package-name\", \"#\")\n+                        .error(\"error.deb-invalid-value-for-package-name.advice\"),\n+                testSpec().type(PackageType.LINUX_RPM).addArgs(\"--linux-package-name\", \"#\")\n+                        .error(\"error.rpm-invalid-value-for-package-name\", \"#\")\n+                        .error(\"error.rpm-invalid-value-for-package-name.advice\")\n+        ).map(TestSpec.Builder::create).filter(spec -> {\n+            return spec.type().orElseThrow().isSupported();\n+        }).toList());\n+\n+        return toTestArgs(testCases.stream());\n+    }\n+\n","filename":"test\/jdk\/tools\/jpackage\/share\/ErrorTest.java","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"}]}