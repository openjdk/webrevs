{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -85,0 +85,16 @@\n+#define EXCEPTION_CHECK_WITH_RELEASE(situationDescription, returnVal, js, stringBytes)          \\\n+    if (exception = jniEnv->ExceptionOccurred()) {                                              \\\n+        PrintDebugString(\"[ERROR]: *** Exception occured while doing: %s - call to GetStringLength; returning %d\", situationDescription, returnVal);   \\\n+        jniEnv->ExceptionDescribe();                                                            \\\n+        jniEnv->ExceptionClear();                                                               \\\n+        jniEnv->ReleaseStringChars(js, stringBytes);                                            \\\n+        return (returnVal);                                                                     \\\n+    }                                                                                           \\\n+    jniEnv->ReleaseStringChars(js, stringBytes);                                                \\\n+    if (exception = jniEnv->ExceptionOccurred()) {                                              \\\n+        PrintDebugString(\"[ERROR]: *** Exception occured while doing: %s - call to ReleaseStringChars; returning %d\", situationDescription, returnVal);   \\\n+        jniEnv->ExceptionDescribe();                                                            \\\n+        jniEnv->ExceptionClear();                                                               \\\n+        return (returnVal);                                                                     \\\n+    }\n+\n@@ -1218,3 +1234,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleName\", FALSE, js, stringBytes);\n@@ -1383,3 +1397,1 @@\n-                EXCEPTION_CHECK(\"Getting AccessibleAttributesAtIndex - call to GetStringLength()\", FALSE);\n-                jniEnv->ReleaseStringChars(js, stringBytes);\n-                EXCEPTION_CHECK(\"Getting AccessibleAttributesAtIndex - call to ReleaseStringChars()\", FALSE);\n+                EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleAttributesAtIndex\", FALSE, js, stringBytes);\n@@ -1738,0 +1750,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleName\", FALSE, js, stringBytes);\n@@ -1740,3 +1753,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to ReleaseStringChars()\", FALSE);\n@@ -1770,0 +1780,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleName\", FALSE, js, stringBytes);\n@@ -1772,3 +1783,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleName - call to ReleaseStringChars()\", FALSE);\n@@ -1802,0 +1810,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleRole\", FALSE, js, stringBytes);\n@@ -1804,3 +1813,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleRole - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleRole - call to ReleaseStringChars()\", FALSE);\n@@ -1834,0 +1840,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleRole_en_US\", FALSE, js, stringBytes);\n@@ -1836,3 +1843,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleRole_en_US - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleRole_en_US - call to ReleaseStringChars()\", FALSE);\n@@ -1865,0 +1869,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleState\", FALSE, js, stringBytes);\n@@ -1867,3 +1872,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleState - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleState - call to ReleaseStringChars()\", FALSE);\n@@ -1896,0 +1898,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleState_en_US\", FALSE, js, stringBytes);\n@@ -1898,3 +1901,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleState_en_US - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleState_en_US - call to ReleaseStringChars()\", FALSE);\n@@ -2812,0 +2812,1 @@\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleRelation key\", FALSE, js, stringBytes);\n@@ -2814,3 +2815,0 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleRelation key - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleRelation key - call to ReleaseStringChars()\", FALSE);\n@@ -2918,3 +2916,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleHyperlink text\", FALSE, js, stringBytes);\n@@ -3055,3 +3051,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleHyperlink text\", FALSE, js, stringBytes);\n@@ -3174,3 +3168,1 @@\n-        EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to GetStringLength()\", FALSE);\n-        jniEnv->ReleaseStringChars(js, stringBytes);\n-        EXCEPTION_CHECK(\"Getting AccessibleHyperlink text - call to ReleaseStringChars()\", FALSE);\n+        EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleHyperlink text\", FALSE, js, stringBytes);\n@@ -3303,3 +3295,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleIcon description - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleIcon description - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleIcon description\", FALSE, js, stringBytes);\n@@ -3382,3 +3372,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleAction name  - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleAction name  - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleAction name\", FALSE, js, stringBytes);\n@@ -3564,3 +3552,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleWordAtIndex - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleWordAtIndex - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleWordAtIndex\", FALSE, js, stringBytes);\n@@ -3600,3 +3586,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleSentenceAtIndex - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleSentenceAtIndex - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleSentenceAtIndex\", FALSE, js, stringBytes);\n@@ -3676,3 +3660,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleTextSelectedText - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleTextSelectedText - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleTextSelectedText\", FALSE, js, stringBytes);\n@@ -3893,3 +3875,1 @@\n-            EXCEPTION_CHECK(\"Getting BackgroundColorFromAttributeSet - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting BackgroundColorFromAttributeSet - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting BackgroundColorFromAttributeSet\", FALSE, js, stringBytes);\n@@ -3930,3 +3910,1 @@\n-            EXCEPTION_CHECK(\"Getting ForegroundColorFromAttributeSet - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting ForegroundColorFromAttributeSet - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting ForegroundColorFromAttributeSet\", FALSE, js, stringBytes);\n@@ -3967,3 +3945,1 @@\n-            EXCEPTION_CHECK(\"Getting FontFamilyFromAttributeSet - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting FontFamilyFromAttributeSet - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting FontFamilyFromAttributeSet\", FALSE, js, stringBytes);\n@@ -4173,3 +4149,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleAttributesAtIndex - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleAttributesAtIndex - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleAttributesAtIndex\", FALSE, js, stringBytes);\n@@ -4416,3 +4390,1 @@\n-            EXCEPTION_CHECK(\"Getting AccessibleTextRange - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting AccessibleTextRange - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting AccessibleTextRange\", FALSE, js, stringBytes);\n@@ -4461,3 +4433,1 @@\n-            EXCEPTION_CHECK(\"Getting CurrentAccessibleValue - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting CurrentAccessibleValue - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting CurrentAccessibleValue\", FALSE, js, stringBytes);\n@@ -4504,3 +4474,1 @@\n-            EXCEPTION_CHECK(\"Getting MaximumAccessibleValue - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting MaximumAccessibleValue - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting MaximumAccessibleValue\", FALSE, js, stringBytes);\n@@ -4547,3 +4515,1 @@\n-            EXCEPTION_CHECK(\"Getting MinimumAccessibleValue - call to GetStringLength()\", FALSE);\n-            jniEnv->ReleaseStringChars(js, stringBytes);\n-            EXCEPTION_CHECK(\"Getting MinimumAccessibleValue - call to ReleaseStringChars()\", FALSE);\n+            EXCEPTION_CHECK_WITH_RELEASE(\"Getting MinimumAccessibleValue\", FALSE, js, stringBytes);\n","filename":"src\/jdk.accessibility\/windows\/native\/libjavaaccessbridge\/AccessBridgeJavaEntryPoints.cpp","additions":42,"deletions":76,"binary":false,"changes":118,"status":"modified"}]}