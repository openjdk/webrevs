{"files":[{"patch":"@@ -38,0 +38,1 @@\n+#include \"utilities\/debug.hpp\"\n@@ -76,1 +77,2 @@\n-  _max_depth(max_dfs_depth), _depth(0), _ignore_root_set(false) {\n+  _max_depth(max_dfs_depth), _depth(0), _ignore_root_set(false),\n+  _probe_stack(max_dfs_depth) {\n@@ -79,1 +81,6 @@\n-void DFSClosure::drain_probe_stack() {\n+#ifdef ASSERT\n+DFSClosure::~DFSClosure() {\n+  assert(_probe_stack.is_empty() || GranularTimer::is_finished(),\n+         \"Should have drained the probe stack\");\n+}\n+#endif \/\/ ASSERT\n@@ -81,1 +88,1 @@\n-  while (!_probe_stack.is_empty()) {\n+void DFSClosure::drain_probe_stack() {\n@@ -83,3 +90,2 @@\n-    if (GranularTimer::is_finished()) {\n-      return;\n-    }\n+  while (!_probe_stack.is_empty() &&\n+         !GranularTimer::is_finished()) {\n@@ -103,1 +109,1 @@\n-        return;\n+        continue;\n","filename":"src\/hotspot\/share\/jfr\/leakprofiler\/chains\/dfsClosure.cpp","additions":13,"deletions":7,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+#include \"utilities\/macros.hpp\"\n@@ -56,0 +57,1 @@\n+  DEBUG_ONLY(~DFSClosure());\n","filename":"src\/hotspot\/share\/jfr\/leakprofiler\/chains\/dfsClosure.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}