{"files":[{"patch":"@@ -4969,3 +4969,1 @@\n-\/\/\n-\/\/ The out parameter success is required to be initialized to true.\n-static clockid_t get_thread_clockid(Thread* thread, bool total, bool* success) {\n+static bool get_thread_clockid(Thread* thread, clockid_t* clockid, bool total) {\n@@ -4975,5 +4973,2 @@\n-  clockid_t clockid;\n-  int rc = pthread_getcpuclockid(thread->osthread()->pthread_id(), &clockid);\n-  if (rc == 0) {\n-    clockid = total ? clockid : (clockid & ~CLOCK_TYPE_MASK) | CPUCLOCK_VIRT;\n-  } else {\n+  int rc = pthread_getcpuclockid(thread->osthread()->pthread_id(), clockid);\n+  if (rc != 0) {\n@@ -4983,1 +4978,7 @@\n-    *success = false;\n+    return false;\n+  }\n+\n+  if (!total) {\n+    clockid_t clockid_tmp = *clockid;\n+    clockid_tmp = (clockid_tmp & ~CLOCK_TYPE_MASK) | CPUCLOCK_VIRT;\n+    *clockid = clockid_tmp;\n@@ -4985,1 +4986,2 @@\n-  return clockid;\n+\n+  return true;\n@@ -4991,2 +4993,2 @@\n-  bool success = true;\n-  clockid_t clockid = get_thread_clockid(thread, true, &success);\n+  clockid_t clockid;\n+  bool success = get_thread_clockid(thread, &clockid, true);\n@@ -5029,2 +5031,2 @@\n-  bool success = true;\n-  clockid_t clockid = get_thread_clockid(thread, false, &success);\n+  clockid_t clockid;\n+  bool success = get_thread_clockid(thread, &clockid, false);\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":16,"deletions":14,"binary":false,"changes":30,"status":"modified"}]}