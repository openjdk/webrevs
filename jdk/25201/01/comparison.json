{"files":[{"patch":"@@ -84,9 +84,16 @@\n-            \/\/StringBuilder sb = new StringBuilder(256);\n-            \/\/sb.append(\"REQUEST HEADERS:\\n\");\n-            \/\/Log.dumpHeaders(sb, \"    \", systemHeaders);\n-            \/\/Log.dumpHeaders(sb, \"    \", userHeaders);\n-            \/\/Log.logHeaders(sb.toString());\n-\n-            String s = completeHeaders.replaceAll(\"\\r\\n\", \"\\n\");\n-            if (s.endsWith(\"\\n\\n\")) s = s.substring(0, s.length() - 2);\n-            Log.logHeaders(\"REQUEST HEADERS:\\n{0}\\n\", s);\n+            StringBuilder sb = new StringBuilder(completeHeaders.length());\n+            sb.append(\"REQUEST HEADERS:\\n\");\n+            boolean[] firstLine = {true};\n+            completeHeaders.lines().forEach(line -> {\n+                \/\/ First line contains `GET \/foo HTTP\/1.1`.\n+                \/\/ Convert it to look like other `Log.logHeaders()` outputs.\n+                if (firstLine[0]) {\n+                    int protocolFieldPrefixIndex = line.lastIndexOf(' ');\n+                    assert protocolFieldPrefixIndex > 0;\n+                    sb.append(\"  \").append(line, 0, protocolFieldPrefixIndex).append('\\n');\n+                    firstLine[0] = false;\n+                } else if (!line.isBlank()) {\n+                    sb.append(\"    \").append(line).append('\\n');\n+                }\n+            });\n+            Log.logHeaders(sb.toString());\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Request.java","additions":16,"deletions":9,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -227,0 +227,1 @@\n+                    sb.append(\"  %s %s %d\\n\".formatted(request.method(), request.uri(), responseCode));\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Response.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1688,2 +1688,2 @@\n-            StringBuilder sb = new StringBuilder(\"HEADERS FRAME (stream=\");\n-            sb.append(stream.streamid).append(\")\\n\");\n+            StringBuilder sb = new StringBuilder(\"HEADERS FRAME (streamid=%d):\\n\".formatted(stream.streamid));\n+            sb.append(\"  %s %s\\n\".formatted(stream.request.method(), stream.request.uri()));\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http2Connection.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -665,1 +665,2 @@\n-                StringBuilder sb = new StringBuilder(\"RESPONSE HEADERS:\\n\");\n+                StringBuilder sb = new StringBuilder(\"RESPONSE HEADERS (streamid=%d):\\n\".formatted(streamid));\n+                sb.append(\"  %s %s %d\\n\".formatted(request.method(), request.uri(), responseCode));\n@@ -676,1 +677,2 @@\n-                StringBuilder sb = new StringBuilder(\"TRAILING HEADERS:\\n\");\n+                StringBuilder sb = new StringBuilder(\"TRAILING HEADERS (streamid=%d):\\n\".formatted(streamid));\n+                sb.append(\"  %s %s %d\\n\".formatted(request.method(), request.uri(), responseCode));\n@@ -1773,2 +1775,2 @@\n-                    StringBuilder sb = new StringBuilder(\"RESPONSE HEADERS\");\n-                    sb.append(\" (streamid=\").append(streamid).append(\"):\\n\");\n+                    StringBuilder sb = new StringBuilder(\"RESPONSE HEADERS (streamid=%d):\\n\".formatted(streamid));\n+                    sb.append(\"  %s %s %d\\n\".formatted(request.method(), request.uri(), responseCode));\n@@ -1785,2 +1787,2 @@\n-                    StringBuilder sb = new StringBuilder(\"TRAILING HEADERS\");\n-                    sb.append(\" (streamid=\").append(streamid).append(\"):\\n\");\n+                    StringBuilder sb = new StringBuilder(\"TRAILING HEADERS (streamid=%d):\\n\".formatted(streamid));\n+                    sb.append(\"  %s %s %d\\n\".formatted(request.method(), request.uri(), responseCode));\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"}]}