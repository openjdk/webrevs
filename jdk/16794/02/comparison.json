{"files":[{"patch":"@@ -46,1 +46,2 @@\n-static volatile gboolean sessionClosed = TRUE;\n+static gboolean hasPipewireFailed = FALSE;\n+static gboolean sessionClosed = TRUE;\n@@ -174,0 +175,1 @@\n+    hasPipewireFailed = FALSE;\n@@ -341,0 +343,2 @@\n+\n+    fp_pw_thread_loop_signal(pw.loop, FALSE);\n@@ -354,0 +358,6 @@\n+    if (state == PW_STREAM_STATE_ERROR\n+        || state == PW_STREAM_STATE_UNCONNECTED) {\n+\n+        hasPipewireFailed = TRUE;\n+        fp_pw_thread_loop_signal(pw.loop, FALSE);\n+    }\n@@ -476,0 +486,5 @@\n+        fp_pw_thread_loop_accept(pw.loop);\n+        if (hasPipewireFailed) {\n+            fp_pw_thread_loop_unlock(pw.loop);\n+            return FALSE;\n+        }\n@@ -483,2 +498,0 @@\n-    fp_pw_thread_loop_accept(pw.loop);\n-\n@@ -542,1 +555,6 @@\n-    fp_pw_thread_loop_unlock(pw.loop);\n+    if (id == PW_ID_CORE) {\n+        fp_pw_thread_loop_lock(pw.loop);\n+        hasPipewireFailed = TRUE;\n+        fp_pw_thread_loop_signal(pw.loop, FALSE);\n+        fp_pw_thread_loop_unlock(pw.loop);\n+    }\n@@ -907,0 +925,1 @@\n+        fp_pw_thread_loop_lock(pw.loop);\n@@ -908,0 +927,7 @@\n+        if (hasPipewireFailed) {\n+            fp_pw_thread_loop_unlock(pw.loop);\n+            doCleanup();\n+            releaseToken(env, jtoken, token);\n+            return RESULT_ERROR;\n+        }\n+        fp_pw_thread_loop_unlock(pw.loop);\n","filename":"src\/java.desktop\/unix\/native\/libawt_xawt\/awt\/screencast_pipewire.c","additions":30,"deletions":4,"binary":false,"changes":34,"status":"modified"}]}