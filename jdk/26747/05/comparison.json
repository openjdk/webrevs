{"files":[{"patch":"@@ -5848,1 +5848,1 @@\n-  cmpptr(count, 2<<shift); \/\/ Short arrays (< 8 bytes) fill by element\n+  cmpptr(count, 8 << shift); \/\/ Short arrays (< 32 bytes) fill by element\n@@ -5911,1 +5911,0 @@\n-        Label L_fill_64_bytes_loop;\n@@ -5916,1 +5915,0 @@\n-        align(16);\n@@ -5918,0 +5916,25 @@\n+        \/\/ align data for 64-byte chunks\n+        Label L_fill_64_bytes_loop, L_align_64_bytes_loop;\n+        if (EnableX86ECoreOpts) {\n+            \/\/ align 'big' arrays to cache lines to minimize split_stores\n+            cmpptr(count, 96 << shift);\n+            jcc(Assembler::below, L_fill_64_bytes_loop);\n+\n+            \/\/ Find the bytes needed for alignment\n+            movptr(rtmp, to);\n+            andptr(rtmp, 0x1c);\n+            jcc(Assembler::zero, L_fill_64_bytes_loop);\n+            negptr(rtmp);           \/\/ number of bytes to fill 32-rtmp. it filled by 2 mov by 32\n+            addptr(rtmp, 32);\n+            shrptr(rtmp, 2 - shift);\/\/ get number of elements from bytes\n+            subptr(count, rtmp);    \/\/ adjust count by number of elements\n+\n+            align(16);\n+            BIND(L_align_64_bytes_loop);\n+            movdl(Address(to, 0), xtmp);\n+            addptr(to, 4);\n+            subptr(rtmp, 1 << shift);\n+            jcc(Assembler::greater, L_align_64_bytes_loop);\n+        }\n+\n+        align(16);\n@@ -5925,0 +5948,1 @@\n+        align(16);\n@@ -5969,0 +5993,1 @@\n+      align(16);\n@@ -5977,3 +6002,3 @@\n-  \/\/ fill trailing 4 bytes\n-  BIND(L_fill_4_bytes);\n-  testl(count, 1<<shift);\n+\n+  Label L_fill_4_bytes_loop;\n+  testl(count, 1 << shift);\n@@ -5981,0 +6006,3 @@\n+\n+  align(16);\n+  BIND(L_fill_4_bytes_loop);\n@@ -5982,0 +6010,6 @@\n+  addptr(to, 4);\n+\n+  BIND(L_fill_4_bytes);\n+  subptr(count, 1 << shift);\n+  jccb(Assembler::greaterEqual, L_fill_4_bytes_loop);\n+\n@@ -5984,1 +6018,1 @@\n-    addptr(to, 4);\n+    addptr(count, 1 << shift);\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.cpp","additions":41,"deletions":7,"binary":false,"changes":48,"status":"modified"}]}