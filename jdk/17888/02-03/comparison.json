{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -97,4 +97,0 @@\n-  jlong get_starttime() {\n-    return _start_time;\n-  }\n-\n","filename":"src\/hotspot\/share\/jfr\/recorder\/service\/jfrEvent.hpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -221,1 +221,1 @@\n-int SafepointSynchronize::synchronize_threads(jlong safepoint_limit_time, int nof_threads, int* initial_running, Ticks& ttsp_start)\n+int SafepointSynchronize::synchronize_threads(jlong safepoint_limit_time, int nof_threads, int* initial_running)\n@@ -223,0 +223,5 @@\n+#if INCLUDE_JFR\n+  bool ttsp_event_enabled = EventTimeToSafepoint::is_enabled();\n+  Ticks ttsp_start = ttsp_event_enabled ? Ticks::now() : Ticks(0);\n+#endif\n+\n@@ -261,4 +266,0 @@\n-#if INCLUDE_JFR\n-  bool ttsp_event_enabled = ttsp_start.value() > 0;\n-#endif\n-\n@@ -375,10 +376,0 @@\n-\n-  Ticks ttsp_start = Ticks(0);\n-#if INCLUDE_JFR\n-  if (EventTimeToSafepoint::is_enabled()) {\n-    jlong time = begin_event.get_starttime();\n-    \/\/ reuse the startime of the begin event\n-    ttsp_start = time == 0 ? Ticks::now() : Ticks(time);\n-  }\n-#endif\n-\n@@ -422,1 +413,1 @@\n-  int iterations = synchronize_threads(safepoint_limit_time, nof_threads, &initial_running, ttsp_start);\n+  int iterations = synchronize_threads(safepoint_limit_time, nof_threads, &initial_running);\n@@ -471,5 +462,1 @@\n-#if INCLUDE_JFR\n-  if (ttsp_start.value() > 0) {\n-    JfrTimeToSafepoint::emit_events();\n-  }\n-#endif\n+  JFR_ONLY(JfrTimeToSafepoint::emit_events();)\n","filename":"src\/hotspot\/share\/runtime\/safepoint.cpp","additions":8,"deletions":21,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +33,0 @@\n-#include \"utilities\/ticks.hpp\"\n@@ -116,1 +115,1 @@\n-  static int synchronize_threads(jlong safepoint_limit_time, int nof_threads, int* initial_running, Ticks& ttsp_start);\n+  static int synchronize_threads(jlong safepoint_limit_time, int nof_threads, int* initial_running);\n","filename":"src\/hotspot\/share\/runtime\/safepoint.hpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"}]}