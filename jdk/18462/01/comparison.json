{"files":[{"patch":"@@ -1,49 +0,0 @@\n-<!--\n- Copyright (c) 2007, Oracle and\/or its affiliates. All rights reserved.\n- DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-   \n- This code is free software; you can redistribute it and\/or modify it\n- under the terms of the GNU General Public License version 2 only, as\n- published by the Free Software Foundation.\n-  \n- This code is distributed in the hope that it will be useful, but WITHOUT\n- ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- version 2 for more details (a copy is included in the LICENSE file that\n- accompanied this code).\n-  \n- You should have received a copy of the GNU General Public License version\n- 2 along with this work; if not, write to the Free Software Foundation,\n- Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-\n- Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- or visit www.oracle.com if you need additional information or have any\n- questions.\n--->\n-\n-<!DOCTYPE HTML PUBLIC \"-\/\/IETF\/\/DTD HTML\/\/EN\">\n-<!-- \n-   @test\n-   @bug 4186119\n-   @summary Confirm that the clip and transform of the Graphics2D is\n-            affected by the landscape orientation of the PageFormat.\n-   @key printer\n-   @run applet\/manual=yesno SetOrient.html\n-  -->\n-<html>\n-  <head>\n-    <title>SetOrient<\/title>\n-  <\/head>\n-\n-  <body>\n-This test prints two pages and sends them to the printer.\n-One page is in PORTRAIT orientation and the other is in LANDSCAPE\n-orientation.  On each page it draws an ellipse inscribed in the clip\n-boundary established by the PrinterJob.  The ellipse should fill the\n-page within the bounds established by the default margins and not\n-extend off any end or side of the page.  Also, the string \"Portrait\"\n-or \"Landscape\" should be oriented correctly.\n-\n-      <applet code=\"SetOrient.class\" width=200 height=200><\/applet>\n-  <\/body>\n-<\/html>\n","filename":"test\/jdk\/java\/awt\/print\/PageFormat\/SetOrient.html","additions":0,"deletions":49,"binary":false,"changes":49,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,2 +24,6 @@\n-\/**\n- * @bug 4186119: setting orientation does not affect printer\n+\/*\n+ * @test\n+ * @key printer\n+ * @bug 4186119\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n@@ -28,1 +32,1 @@\n- * @run applet\/manual=yesno SetOrient.html\n+ * @run main\/manual SetOrient\n@@ -31,7 +35,9 @@\n-import java.awt.*;\n-import java.awt.geom.*;\n-import java.awt.print.*;\n-import java.applet.Applet;\n-\n-public class SetOrient extends Applet implements Printable {\n-    PrinterJob pjob;\n+import java.awt.Color;\n+import java.awt.Graphics;\n+import java.awt.Graphics2D;\n+import java.awt.geom.Ellipse2D;\n+import java.awt.print.Book;\n+import java.awt.print.PageFormat;\n+import java.awt.print.Printable;\n+import java.awt.print.PrinterException;\n+import java.awt.print.PrinterJob;\n@@ -39,2 +45,1 @@\n-    public void init() {\n-        pjob = PrinterJob.getPrinterJob();\n+import javax.swing.JButton;\n@@ -42,8 +47,11 @@\n-        Book book = new Book();\n-        PageFormat pf = pjob.defaultPage();\n-        pf.setOrientation(PageFormat.PORTRAIT);\n-        book.append(this, pf);\n-        pf = pjob.defaultPage();\n-        pf.setOrientation(PageFormat.LANDSCAPE);\n-        book.append(this, pf);\n-        pjob.setPageable(book);\n+public class SetOrient {\n+    private static final String INSTRUCTIONS =\n+            \"\"\"\n+             This test prints two pages and sends them to the printer.\n+             One page is in PORTRAIT orientation and the other is in LANDSCAPE\n+             orientation. On each page it draws an ellipse inscribed in the clip\n+             boundary established by the PrinterJob. The ellipse should fill the\n+             page within the bounds established by the default margins and not\n+             extend off any end or side of the page. Also, the string \"Portrait\"\n+             or \"Landscape\" should be oriented correctly.\n+            \"\"\";\n@@ -51,5 +59,10 @@\n-        try {\n-            pjob.print();\n-        } catch (PrinterException e) {\n-            throw new RuntimeException(e.getMessage());\n-        }\n+    public static void main(String[] args) throws Exception {\n+        PassFailJFrame\n+                .builder()\n+                .title(\"SetOrient Test Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .rows((int) INSTRUCTIONS.lines().count() + 2)\n+                .columns(40)\n+                .splitUIBottom(SetOrient::createAndShowGUI)\n+                .build()\n+                .awaitAndCheck();\n@@ -58,5 +71,25 @@\n-    public int print(Graphics g, PageFormat pf, int pageIndex) {\n-        Graphics2D g2d = (Graphics2D)g;\n-        drawGraphics(g2d, pf);\n-        return Printable.PAGE_EXISTS;\n-    }\n+    public static JButton createAndShowGUI() {\n+        JButton btn = new JButton(\"PRINT\");\n+        btn.addActionListener(e -> {\n+            PrinterJob pjob = PrinterJob.getPrinterJob();\n+\n+            Printable p = new Printable() {\n+                public int print(Graphics g, PageFormat pf, int pageIndex) {\n+                    Graphics2D g2d = (Graphics2D)g;\n+                    drawGraphics(g2d, pf);\n+                    return Printable.PAGE_EXISTS;\n+                }\n+\n+                void drawGraphics(Graphics2D g, PageFormat pf) {\n+                    double ix = pf.getImageableX();\n+                    double iy = pf.getImageableY();\n+                    double iw = pf.getImageableWidth();\n+                    double ih = pf.getImageableHeight();\n+\n+                    g.setColor(Color.black);\n+                    g.drawString(((pf.getOrientation() == PageFormat.PORTRAIT)\n+                                    ? \"Portrait\" : \"Landscape\"),\n+                            (int) (ix + iw \/ 2), (int) (iy + ih \/ 2));\n+                    g.draw(new Ellipse2D.Double(ix, iy, iw, ih));\n+                }\n+            };\n@@ -64,5 +97,8 @@\n-    void drawGraphics(Graphics2D g, PageFormat pf) {\n-        double ix = pf.getImageableX();\n-        double iy = pf.getImageableY();\n-        double iw = pf.getImageableWidth();\n-        double ih = pf.getImageableHeight();\n+            Book book = new Book();\n+            PageFormat pf = pjob.defaultPage();\n+            pf.setOrientation(PageFormat.PORTRAIT);\n+            book.append(p, pf);\n+            pf = pjob.defaultPage();\n+            pf.setOrientation(PageFormat.LANDSCAPE);\n+            book.append(p, pf);\n+            pjob.setPageable(book);\n@@ -70,5 +106,9 @@\n-        g.setColor(Color.black);\n-        g.drawString(((pf.getOrientation() == PageFormat.PORTRAIT)\n-                      ? \"Portrait\" : \"Landscape\"),\n-                     (int) (ix+iw\/2), (int) (iy+ih\/2));\n-        g.draw(new Ellipse2D.Double(ix, iy, iw, ih));\n+            try {\n+                pjob.print();\n+            } catch (PrinterException ex) {\n+                ex.printStackTrace();\n+                String msg = \"PrinterException: \" + ex.getMessage();\n+                PassFailJFrame.forceFail(msg);\n+            }\n+        });\n+        return btn;\n","filename":"test\/jdk\/java\/awt\/print\/PageFormat\/SetOrient.java","additions":81,"deletions":41,"binary":false,"changes":122,"status":"modified"}]}