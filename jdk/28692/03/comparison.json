{"files":[{"patch":"@@ -2876,1 +2876,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (byte) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (byte) VectorMath.minUnsigned(a, b)));\n@@ -2878,1 +2878,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (byte) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (byte) VectorMath.maxUnsigned(a, b)));\n@@ -2893,0 +2893,2 @@\n+    private static final byte UMIN_VALUE = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMAX_VALUE = (byte)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/ByteVector.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2861,1 +2861,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (int) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (int) VectorMath.minUnsigned(a, b)));\n@@ -2863,1 +2863,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (int) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (int) VectorMath.maxUnsigned(a, b)));\n@@ -2878,0 +2878,2 @@\n+    private static final int UMIN_VALUE = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMAX_VALUE = (int)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/IntVector.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2727,1 +2727,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (long) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (long) VectorMath.minUnsigned(a, b)));\n@@ -2729,1 +2729,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (long) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (long) VectorMath.maxUnsigned(a, b)));\n@@ -2744,0 +2744,2 @@\n+    private static final long UMIN_VALUE = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMAX_VALUE = (long)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/LongVector.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2877,1 +2877,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> (short) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> (short) VectorMath.minUnsigned(a, b)));\n@@ -2879,1 +2879,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> (short) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> (short) VectorMath.maxUnsigned(a, b)));\n@@ -2894,0 +2894,2 @@\n+    private static final short UMIN_VALUE = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMAX_VALUE = (short)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/ShortVector.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -3451,1 +3451,1 @@\n-                    toBits(v.rOp(MAX_OR_INF, m, (i, a, b) -> ($type$) VectorMath.minUnsigned(a, b)));\n+                    toBits(v.rOp(UMAX_VALUE, m, (i, a, b) -> ($type$) VectorMath.minUnsigned(a, b)));\n@@ -3453,1 +3453,1 @@\n-                    toBits(v.rOp(MIN_OR_INF, m, (i, a, b) -> ($type$) VectorMath.maxUnsigned(a, b)));\n+                    toBits(v.rOp(UMIN_VALUE, m, (i, a, b) -> ($type$) VectorMath.maxUnsigned(a, b)));\n@@ -3475,0 +3475,2 @@\n+    private static final $type$ UMIN_VALUE = ($type$)0;   \/\/ Minimum unsigned value\n+    private static final $type$ UMAX_VALUE = ($type$)-1;  \/\/ Maximum unsigned value\n","filename":"src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/X-Vector.java.template","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte SUADD_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3614,1 +3626,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3623,1 +3635,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3635,8 +3647,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3645,1 +3650,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3648,1 +3653,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3656,0 +3663,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3657,1 +3682,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3667,1 +3692,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3681,8 +3706,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3691,1 +3709,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3694,1 +3712,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                byte v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3703,1 +3723,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3712,1 +3732,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3727,0 +3747,1 @@\n+            ra = OR_IDENTITY;\n@@ -3729,9 +3750,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3745,0 +3760,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3746,1 +3779,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3756,1 +3789,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3773,0 +3806,1 @@\n+            ra = OR_IDENTITY;\n@@ -3775,9 +3809,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3792,1 +3820,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3801,1 +3829,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3816,0 +3844,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3818,9 +3847,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3834,0 +3857,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3835,1 +3876,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3845,1 +3886,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3862,0 +3903,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3864,9 +3906,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3881,1 +3917,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3890,1 +3926,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3905,0 +3941,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3907,9 +3944,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3923,0 +3954,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3924,1 +3973,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3934,1 +3983,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3951,0 +4000,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3953,9 +4003,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                byte v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3970,1 +4014,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3979,1 +4023,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3991,8 +4035,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4001,1 +4038,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4004,1 +4041,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4012,0 +4051,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4013,1 +4070,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4023,1 +4080,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4037,8 +4094,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4047,1 +4097,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4050,1 +4100,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                byte v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4059,1 +4111,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4068,1 +4120,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4080,8 +4132,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4090,1 +4135,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4093,1 +4138,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4101,0 +4148,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4102,1 +4167,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4112,1 +4177,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4126,8 +4191,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4136,1 +4194,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4139,1 +4197,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4148,1 +4208,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4157,1 +4217,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4169,8 +4229,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4179,1 +4232,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4182,1 +4235,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4190,0 +4245,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4191,1 +4264,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4201,1 +4274,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4215,8 +4288,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4225,1 +4291,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4228,1 +4294,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4237,1 +4305,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4246,1 +4314,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4258,8 +4326,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4268,1 +4329,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4271,1 +4332,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4279,0 +4342,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4280,1 +4361,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4290,1 +4371,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4304,8 +4385,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4314,1 +4388,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4317,1 +4391,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4326,1 +4402,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4335,1 +4411,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4347,8 +4423,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4357,1 +4426,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4360,1 +4429,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4368,0 +4439,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4369,1 +4458,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4379,1 +4468,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4393,8 +4482,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4403,1 +4485,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4406,1 +4488,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4415,1 +4499,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4424,1 +4508,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4436,8 +4520,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4446,1 +4523,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4449,1 +4526,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4457,0 +4536,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4458,1 +4555,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4565,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4482,8 +4579,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4492,1 +4582,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4495,1 +4585,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4552,1 +4644,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4561,1 +4653,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4576,0 +4668,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4578,9 +4671,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                byte v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4594,0 +4681,18 @@\n+    @Test(dataProvider = \"byteSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4595,1 +4700,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4605,1 +4710,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4621,0 +4726,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4623,9 +4729,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                byte v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte128VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte SUADD_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3614,1 +3626,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3623,1 +3635,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3635,8 +3647,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3645,1 +3650,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3648,1 +3653,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3656,0 +3663,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3657,1 +3682,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3667,1 +3692,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3681,8 +3706,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3691,1 +3709,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3694,1 +3712,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                byte v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3703,1 +3723,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3712,1 +3732,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3727,0 +3747,1 @@\n+            ra = OR_IDENTITY;\n@@ -3729,9 +3750,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3745,0 +3760,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3746,1 +3779,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3756,1 +3789,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3773,0 +3806,1 @@\n+            ra = OR_IDENTITY;\n@@ -3775,9 +3809,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3792,1 +3820,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3801,1 +3829,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3816,0 +3844,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3818,9 +3847,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3834,0 +3857,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3835,1 +3876,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3845,1 +3886,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3862,0 +3903,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3864,9 +3906,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3881,1 +3917,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3890,1 +3926,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3905,0 +3941,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3907,9 +3944,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3923,0 +3954,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3924,1 +3973,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3934,1 +3983,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3951,0 +4000,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3953,9 +4003,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                byte v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3970,1 +4014,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3979,1 +4023,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3991,8 +4035,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4001,1 +4038,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4004,1 +4041,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4012,0 +4051,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4013,1 +4070,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4023,1 +4080,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4037,8 +4094,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4047,1 +4097,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4050,1 +4100,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                byte v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4059,1 +4111,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4068,1 +4120,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4080,8 +4132,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4090,1 +4135,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4093,1 +4138,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4101,0 +4148,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4102,1 +4167,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4112,1 +4177,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4126,8 +4191,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4136,1 +4194,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4139,1 +4197,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4148,1 +4208,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4157,1 +4217,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4169,8 +4229,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4179,1 +4232,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4182,1 +4235,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4190,0 +4245,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4191,1 +4264,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4201,1 +4274,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4215,8 +4288,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4225,1 +4291,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4228,1 +4294,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4237,1 +4305,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4246,1 +4314,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4258,8 +4326,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4268,1 +4329,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4271,1 +4332,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4279,0 +4342,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4280,1 +4361,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4290,1 +4371,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4304,8 +4385,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4314,1 +4388,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4317,1 +4391,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4326,1 +4402,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4335,1 +4411,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4347,8 +4423,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4357,1 +4426,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4360,1 +4429,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4368,0 +4439,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4369,1 +4458,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4379,1 +4468,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4393,8 +4482,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4403,1 +4485,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4406,1 +4488,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4415,1 +4499,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4424,1 +4508,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4436,8 +4520,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4446,1 +4523,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4449,1 +4526,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4457,0 +4536,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4458,1 +4555,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4565,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4482,8 +4579,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4492,1 +4582,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4495,1 +4585,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4552,1 +4644,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4561,1 +4653,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4576,0 +4668,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4578,9 +4671,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                byte v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4594,0 +4681,18 @@\n+    @Test(dataProvider = \"byteSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4595,1 +4700,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4605,1 +4710,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4621,0 +4726,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4623,9 +4729,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                byte v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte256VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte SUADD_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3614,1 +3626,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3623,1 +3635,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3635,8 +3647,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3645,1 +3650,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3648,1 +3653,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3656,0 +3663,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3657,1 +3682,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3667,1 +3692,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3681,8 +3706,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3691,1 +3709,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3694,1 +3712,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                byte v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3703,1 +3723,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3712,1 +3732,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3727,0 +3747,1 @@\n+            ra = OR_IDENTITY;\n@@ -3729,9 +3750,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3745,0 +3760,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3746,1 +3779,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3756,1 +3789,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3773,0 +3806,1 @@\n+            ra = OR_IDENTITY;\n@@ -3775,9 +3809,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3792,1 +3820,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3801,1 +3829,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3816,0 +3844,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3818,9 +3847,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3834,0 +3857,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3835,1 +3876,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3845,1 +3886,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3862,0 +3903,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3864,9 +3906,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3881,1 +3917,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3890,1 +3926,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3905,0 +3941,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3907,9 +3944,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3923,0 +3954,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3924,1 +3973,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3934,1 +3983,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3951,0 +4000,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3953,9 +4003,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                byte v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3970,1 +4014,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3979,1 +4023,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3991,8 +4035,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4001,1 +4038,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4004,1 +4041,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4012,0 +4051,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4013,1 +4070,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4023,1 +4080,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4037,8 +4094,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4047,1 +4097,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4050,1 +4100,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                byte v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4059,1 +4111,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4068,1 +4120,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4080,8 +4132,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4090,1 +4135,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4093,1 +4138,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4101,0 +4148,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4102,1 +4167,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4112,1 +4177,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4126,8 +4191,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4136,1 +4194,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4139,1 +4197,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4148,1 +4208,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4157,1 +4217,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4169,8 +4229,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4179,1 +4232,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4182,1 +4235,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4190,0 +4245,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4191,1 +4264,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4201,1 +4274,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4215,8 +4288,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4225,1 +4291,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4228,1 +4294,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4237,1 +4305,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4246,1 +4314,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4258,8 +4326,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4268,1 +4329,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4271,1 +4332,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4279,0 +4342,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4280,1 +4361,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4290,1 +4371,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4304,8 +4385,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4314,1 +4388,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4317,1 +4391,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4326,1 +4402,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4335,1 +4411,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4347,8 +4423,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4357,1 +4426,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4360,1 +4429,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4368,0 +4439,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4369,1 +4458,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4379,1 +4468,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4393,8 +4482,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4403,1 +4485,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4406,1 +4488,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4415,1 +4499,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4424,1 +4508,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4436,8 +4520,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4446,1 +4523,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4449,1 +4526,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4457,0 +4536,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4458,1 +4555,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4565,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4482,8 +4579,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4492,1 +4582,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4495,1 +4585,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4552,1 +4644,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4561,1 +4653,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4576,0 +4668,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4578,9 +4671,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                byte v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4594,0 +4681,18 @@\n+    @Test(dataProvider = \"byteSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4595,1 +4700,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4605,1 +4710,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4621,0 +4726,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4623,9 +4729,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                byte v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte512VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte SUADD_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3614,1 +3626,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3623,1 +3635,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3635,8 +3647,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3645,1 +3650,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3648,1 +3653,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3656,0 +3663,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3657,1 +3682,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3667,1 +3692,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3681,8 +3706,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3691,1 +3709,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3694,1 +3712,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                byte v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3703,1 +3723,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3712,1 +3732,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3727,0 +3747,1 @@\n+            ra = OR_IDENTITY;\n@@ -3729,9 +3750,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3745,0 +3760,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3746,1 +3779,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3756,1 +3789,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3773,0 +3806,1 @@\n+            ra = OR_IDENTITY;\n@@ -3775,9 +3809,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3792,1 +3820,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3801,1 +3829,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3816,0 +3844,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3818,9 +3847,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3834,0 +3857,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3835,1 +3876,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3845,1 +3886,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3862,0 +3903,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3864,9 +3906,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3881,1 +3917,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3890,1 +3926,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3905,0 +3941,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3907,9 +3944,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3923,0 +3954,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3924,1 +3973,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3934,1 +3983,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3951,0 +4000,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3953,9 +4003,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                byte v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3970,1 +4014,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3979,1 +4023,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3991,8 +4035,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4001,1 +4038,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4004,1 +4041,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4012,0 +4051,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4013,1 +4070,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4023,1 +4080,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4037,8 +4094,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4047,1 +4097,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4050,1 +4100,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                byte v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4059,1 +4111,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4068,1 +4120,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4080,8 +4132,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4090,1 +4135,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4093,1 +4138,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4101,0 +4148,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4102,1 +4167,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4112,1 +4177,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4126,8 +4191,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4136,1 +4194,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4139,1 +4197,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4148,1 +4208,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4157,1 +4217,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4169,8 +4229,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4179,1 +4232,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4182,1 +4235,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4190,0 +4245,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4191,1 +4264,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4201,1 +4274,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4215,8 +4288,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4225,1 +4291,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4228,1 +4294,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4237,1 +4305,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4246,1 +4314,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4258,8 +4326,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4268,1 +4329,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4271,1 +4332,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4279,0 +4342,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4280,1 +4361,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4290,1 +4371,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4304,8 +4385,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4314,1 +4388,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4317,1 +4391,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4326,1 +4402,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4335,1 +4411,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4347,8 +4423,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4357,1 +4426,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4360,1 +4429,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4368,0 +4439,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4369,1 +4458,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4379,1 +4468,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4393,8 +4482,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4403,1 +4485,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4406,1 +4488,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4415,1 +4499,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4424,1 +4508,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4436,8 +4520,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4446,1 +4523,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4449,1 +4526,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4457,0 +4536,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4458,1 +4555,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4565,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4482,8 +4579,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4492,1 +4582,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4495,1 +4585,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4552,1 +4644,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4561,1 +4653,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4576,0 +4668,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4578,9 +4671,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                byte v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4594,0 +4681,18 @@\n+    @Test(dataProvider = \"byteSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4595,1 +4700,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4605,1 +4710,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4621,0 +4726,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4623,9 +4729,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                byte v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Byte64VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final byte ADD_IDENTITY = (byte)0;\n+    private static final byte AND_IDENTITY = (byte)-1;\n+    private static final byte FIRST_NONZERO_IDENTITY = (byte)0;\n+    private static final byte MAX_IDENTITY = Byte.MIN_VALUE;\n+    private static final byte MIN_IDENTITY = Byte.MAX_VALUE;\n+    private static final byte MUL_IDENTITY = (byte)1;\n+    private static final byte OR_IDENTITY = (byte)0;\n+    private static final byte SUADD_IDENTITY = (byte)0;\n+    private static final byte UMAX_IDENTITY = (byte)0;   \/\/ Minimum unsigned value\n+    private static final byte UMIN_IDENTITY = (byte)-1;  \/\/ Maximum unsigned value\n+    private static final byte XOR_IDENTITY = (byte)0;\n+\n@@ -3619,1 +3632,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3628,1 +3641,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3640,8 +3653,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3650,1 +3656,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3653,1 +3659,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                byte v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3661,0 +3669,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = AND_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3662,1 +3688,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3672,1 +3698,1 @@\n-        byte res = -1;\n+        byte res = AND_IDENTITY;\n@@ -3686,8 +3712,1 @@\n-        byte ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -3696,1 +3715,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3699,1 +3718,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                byte v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3708,1 +3729,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3717,1 +3738,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3732,0 +3753,1 @@\n+            ra = OR_IDENTITY;\n@@ -3734,9 +3756,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                byte v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3750,0 +3766,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = OR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3751,1 +3785,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3761,1 +3795,1 @@\n-        byte res = 0;\n+        byte res = OR_IDENTITY;\n@@ -3778,0 +3812,1 @@\n+            ra = OR_IDENTITY;\n@@ -3780,9 +3815,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3797,1 +3826,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3806,1 +3835,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3821,0 +3850,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3823,9 +3853,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                byte v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3839,0 +3863,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3840,1 +3882,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3850,1 +3892,1 @@\n-        byte res = 0;\n+        byte res = XOR_IDENTITY;\n@@ -3867,0 +3909,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3869,9 +3912,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                byte v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3886,1 +3923,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3895,1 +3932,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3910,0 +3947,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3912,9 +3950,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                byte v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3928,0 +3960,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3929,1 +3979,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3939,1 +3989,1 @@\n-        byte res = 0;\n+        byte res = ADD_IDENTITY;\n@@ -3956,0 +4006,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3958,9 +4009,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                byte v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3975,1 +4020,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3984,1 +4029,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -3996,8 +4041,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4006,1 +4044,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4009,1 +4047,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                byte v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4017,0 +4057,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((byte) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4018,1 +4076,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4028,1 +4086,1 @@\n-        byte res = 1;\n+        byte res = MUL_IDENTITY;\n@@ -4042,8 +4100,1 @@\n-        byte ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4052,1 +4103,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4055,1 +4106,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                byte v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4064,1 +4117,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4073,1 +4126,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4085,8 +4138,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4095,1 +4141,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4098,1 +4144,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                byte v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4106,0 +4154,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4107,1 +4173,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4117,1 +4183,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = MIN_IDENTITY;\n@@ -4131,8 +4197,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4141,1 +4200,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4144,1 +4203,3 @@\n-                ra = (byte) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.min(ra, v);\n@@ -4153,1 +4214,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4162,1 +4223,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4174,8 +4235,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4184,1 +4238,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4187,1 +4241,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                byte v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4195,0 +4251,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4196,1 +4270,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4206,1 +4280,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = MAX_IDENTITY;\n@@ -4220,8 +4294,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4230,1 +4297,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4233,1 +4300,3 @@\n-                ra = (byte) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (byte) Math.max(ra, v);\n@@ -4242,1 +4311,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4251,1 +4320,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4263,8 +4332,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4273,1 +4335,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4276,1 +4338,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                byte v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4284,0 +4348,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4285,1 +4367,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4295,1 +4377,1 @@\n-        byte res = Byte.MAX_VALUE;\n+        byte res = UMIN_IDENTITY;\n@@ -4309,8 +4391,1 @@\n-        byte ra = Byte.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4319,1 +4394,1 @@\n-            ra = Byte.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4322,1 +4397,3 @@\n-                ra = (byte) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.minUnsigned(ra, v);\n@@ -4331,1 +4408,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4340,1 +4417,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4352,8 +4429,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4362,1 +4432,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4365,1 +4435,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                byte v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4373,0 +4445,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4374,1 +4464,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4384,1 +4474,1 @@\n-        byte res = Byte.MIN_VALUE;\n+        byte res = UMAX_IDENTITY;\n@@ -4398,8 +4488,1 @@\n-        byte ra = Byte.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4408,1 +4491,1 @@\n-            ra = Byte.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4411,1 +4494,3 @@\n-                ra = (byte) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                byte v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.maxUnsigned(ra, v);\n@@ -4420,1 +4505,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4429,1 +4514,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4441,8 +4526,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4451,1 +4529,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4454,1 +4532,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4462,0 +4542,18 @@\n+    @Test(dataProvider = \"byteUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4463,1 +4561,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4473,1 +4571,1 @@\n-        byte res = (byte) 0;\n+        byte res = FIRST_NONZERO_IDENTITY;\n@@ -4487,8 +4585,1 @@\n-        byte ra = (byte) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        byte ra = 0;\n@@ -4497,1 +4588,1 @@\n-            ra = (byte) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4500,1 +4591,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                byte v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4557,1 +4650,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4566,1 +4659,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4581,0 +4674,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4583,9 +4677,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                byte v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4599,0 +4687,18 @@\n+    @Test(dataProvider = \"byteSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<byte[]> fa) {\n+        byte[] a = fa.apply(SPECIES.length());\n+        byte id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            byte x = a[i];\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((byte) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4600,1 +4706,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4610,1 +4716,1 @@\n-        byte res = 0;\n+        byte res = SUADD_IDENTITY;\n@@ -4626,0 +4732,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4628,9 +4735,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ByteVector av = ByteVector.fromArray(SPECIES, a, i);\n-                ra = (byte) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                byte v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (byte) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/ByteMaxVectorTests.java","additions":358,"deletions":257,"binary":false,"changes":615,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2387,1 +2393,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2396,1 +2402,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2411,0 +2417,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2413,9 +2420,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2429,0 +2430,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2430,1 +2449,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2440,1 +2459,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2457,0 +2476,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2459,9 +2479,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                double v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2476,1 +2490,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2485,1 +2499,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2497,8 +2511,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2507,1 +2514,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2510,1 +2517,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2518,0 +2527,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2519,1 +2546,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2529,1 +2556,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2543,8 +2570,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2553,1 +2573,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2556,1 +2576,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                double v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2565,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2574,1 +2596,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2586,8 +2608,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2596,1 +2611,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2599,1 +2614,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2607,0 +2624,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2608,1 +2643,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2618,1 +2653,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2632,8 +2667,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2642,1 +2670,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2645,1 +2673,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2654,1 +2684,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2663,1 +2693,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2675,8 +2705,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2685,1 +2708,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2688,1 +2711,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2696,0 +2721,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2697,1 +2740,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2707,1 +2750,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2721,8 +2764,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2731,1 +2767,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2734,1 +2770,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2743,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2752,1 +2790,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2764,8 +2802,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2774,1 +2805,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2777,1 +2808,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2785,0 +2818,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2786,1 +2837,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2796,1 +2847,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2810,8 +2861,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2820,1 +2864,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2823,1 +2867,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double128VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2387,1 +2393,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2396,1 +2402,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2411,0 +2417,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2413,9 +2420,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2429,0 +2430,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2430,1 +2449,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2440,1 +2459,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2457,0 +2476,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2459,9 +2479,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                double v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2476,1 +2490,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2485,1 +2499,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2497,8 +2511,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2507,1 +2514,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2510,1 +2517,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2518,0 +2527,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2519,1 +2546,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2529,1 +2556,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2543,8 +2570,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2553,1 +2573,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2556,1 +2576,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                double v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2565,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2574,1 +2596,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2586,8 +2608,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2596,1 +2611,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2599,1 +2614,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2607,0 +2624,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2608,1 +2643,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2618,1 +2653,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2632,8 +2667,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2642,1 +2670,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2645,1 +2673,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2654,1 +2684,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2663,1 +2693,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2675,8 +2705,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2685,1 +2708,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2688,1 +2711,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2696,0 +2721,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2697,1 +2740,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2707,1 +2750,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2721,8 +2764,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2731,1 +2767,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2734,1 +2770,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2743,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2752,1 +2790,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2764,8 +2802,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2774,1 +2805,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2777,1 +2808,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2785,0 +2818,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2786,1 +2837,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2796,1 +2847,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2810,8 +2861,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2820,1 +2864,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2823,1 +2867,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double256VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2387,1 +2393,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2396,1 +2402,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2411,0 +2417,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2413,9 +2420,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2429,0 +2430,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2430,1 +2449,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2440,1 +2459,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2457,0 +2476,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2459,9 +2479,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                double v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2476,1 +2490,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2485,1 +2499,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2497,8 +2511,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2507,1 +2514,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2510,1 +2517,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2518,0 +2527,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2519,1 +2546,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2529,1 +2556,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2543,8 +2570,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2553,1 +2573,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2556,1 +2576,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                double v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2565,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2574,1 +2596,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2586,8 +2608,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2596,1 +2611,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2599,1 +2614,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2607,0 +2624,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2608,1 +2643,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2618,1 +2653,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2632,8 +2667,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2642,1 +2670,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2645,1 +2673,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2654,1 +2684,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2663,1 +2693,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2675,8 +2705,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2685,1 +2708,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2688,1 +2711,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2696,0 +2721,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2697,1 +2740,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2707,1 +2750,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2721,8 +2764,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2731,1 +2767,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2734,1 +2770,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2743,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2752,1 +2790,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2764,8 +2802,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2774,1 +2805,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2777,1 +2808,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2785,0 +2818,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2786,1 +2837,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2796,1 +2847,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2810,8 +2861,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2820,1 +2864,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2823,1 +2867,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double512VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n@@ -2387,1 +2393,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2396,1 +2402,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2411,0 +2417,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2413,9 +2420,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2429,0 +2430,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2430,1 +2449,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2440,1 +2459,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2457,0 +2476,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2459,9 +2479,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                double v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2476,1 +2490,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2485,1 +2499,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2497,8 +2511,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2507,1 +2514,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2510,1 +2517,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2518,0 +2527,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2519,1 +2546,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2529,1 +2556,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2543,8 +2570,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2553,1 +2573,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2556,1 +2576,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                double v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2565,1 +2587,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2574,1 +2596,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2586,8 +2608,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2596,1 +2611,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2599,1 +2614,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2607,0 +2624,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2608,1 +2643,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2618,1 +2653,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2632,8 +2667,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2642,1 +2670,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2645,1 +2673,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2654,1 +2684,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2663,1 +2693,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2675,8 +2705,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2685,1 +2708,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2688,1 +2711,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2696,0 +2721,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2697,1 +2740,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2707,1 +2750,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2721,8 +2764,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2731,1 +2767,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2734,1 +2770,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2743,1 +2781,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2752,1 +2790,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2764,8 +2802,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2774,1 +2805,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2777,1 +2808,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2785,0 +2818,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2786,1 +2837,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2796,1 +2847,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2810,8 +2861,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2820,1 +2864,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2823,1 +2867,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Double64VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,7 @@\n+    \/\/ Identity values for reduction operations\n+    private static final double ADD_IDENTITY = (double)0;\n+    private static final double FIRST_NONZERO_IDENTITY = (double)0;\n+    private static final double MAX_IDENTITY = Double.NEGATIVE_INFINITY;\n+    private static final double MIN_IDENTITY = Double.POSITIVE_INFINITY;\n+    private static final double MUL_IDENTITY = (double)1;\n+\n@@ -2392,1 +2399,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2401,1 +2408,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2416,0 +2423,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2418,9 +2426,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                double v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2434,0 +2436,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((double) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2435,1 +2455,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2445,1 +2465,1 @@\n-        double res = 0;\n+        double res = ADD_IDENTITY;\n@@ -2462,0 +2482,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2464,9 +2485,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                double v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2481,1 +2496,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2490,1 +2505,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2502,8 +2517,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        double ra = 0;\n@@ -2512,1 +2520,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2515,1 +2523,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                double v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2523,0 +2533,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((double) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2524,1 +2552,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2534,1 +2562,1 @@\n-        double res = 1;\n+        double res = MUL_IDENTITY;\n@@ -2548,8 +2576,1 @@\n-        double ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2558,1 +2579,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2561,1 +2582,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                double v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2570,1 +2593,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2579,1 +2602,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2591,8 +2614,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        double ra = 0;\n@@ -2601,1 +2617,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2604,1 +2620,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                double v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2612,0 +2630,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2613,1 +2649,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2623,1 +2659,1 @@\n-        double res = Double.POSITIVE_INFINITY;\n+        double res = MIN_IDENTITY;\n@@ -2637,8 +2673,1 @@\n-        double ra = Double.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2647,1 +2676,1 @@\n-            ra = Double.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2650,1 +2679,3 @@\n-                ra = (double) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                double v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (double) Math.min(ra, v);\n@@ -2659,1 +2690,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2668,1 +2699,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2680,8 +2711,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        double ra = 0;\n@@ -2690,1 +2714,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2693,1 +2717,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                double v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2701,0 +2727,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((double) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals((double) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((double) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2702,1 +2746,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2712,1 +2756,1 @@\n-        double res = Double.NEGATIVE_INFINITY;\n+        double res = MAX_IDENTITY;\n@@ -2726,8 +2770,1 @@\n-        double ra = Double.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2736,1 +2773,1 @@\n-            ra = Double.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2739,1 +2776,3 @@\n-                ra = (double) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                double v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (double) Math.max(ra, v);\n@@ -2748,1 +2787,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2757,1 +2796,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2769,8 +2808,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        double ra = 0;\n@@ -2779,1 +2811,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2782,1 +2814,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2790,0 +2824,18 @@\n+    @Test(dataProvider = \"doubleUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<double[]> fa) {\n+        double[] a = fa.apply(SPECIES.length());\n+        double id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            double x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2791,1 +2843,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2801,1 +2853,1 @@\n-        double res = (double) 0;\n+        double res = FIRST_NONZERO_IDENTITY;\n@@ -2815,8 +2867,1 @@\n-        double ra = (double) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                DoubleVector av = DoubleVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        double ra = 0;\n@@ -2825,1 +2870,1 @@\n-            ra = (double) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2828,1 +2873,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                double v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/DoubleMaxVectorTests.java","additions":166,"deletions":119,"binary":false,"changes":285,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2398,1 +2404,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2407,1 +2413,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2422,0 +2428,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2424,9 +2431,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2440,0 +2441,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2441,1 +2460,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2451,1 +2470,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2468,0 +2487,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2470,9 +2490,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                float v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2487,1 +2501,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2496,1 +2510,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2508,8 +2522,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2518,1 +2525,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2521,1 +2528,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2529,0 +2538,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2530,1 +2557,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2540,1 +2567,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2554,8 +2581,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2564,1 +2584,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2567,1 +2587,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                float v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2576,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2585,1 +2607,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2597,8 +2619,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2607,1 +2622,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2610,1 +2625,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2618,0 +2635,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2619,1 +2654,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2629,1 +2664,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2643,8 +2678,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2653,1 +2681,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2656,1 +2684,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2665,1 +2695,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2674,1 +2704,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2686,8 +2716,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2696,1 +2719,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2699,1 +2722,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2707,0 +2732,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2708,1 +2751,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2718,1 +2761,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2732,8 +2775,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2742,1 +2778,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2745,1 +2781,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2754,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2763,1 +2801,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2775,8 +2813,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2785,1 +2816,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2788,1 +2819,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2796,0 +2829,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2797,1 +2848,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2807,1 +2858,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2821,8 +2872,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2831,1 +2875,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2834,1 +2878,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float128VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2398,1 +2404,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2407,1 +2413,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2422,0 +2428,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2424,9 +2431,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2440,0 +2441,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2441,1 +2460,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2451,1 +2470,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2468,0 +2487,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2470,9 +2490,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                float v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2487,1 +2501,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2496,1 +2510,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2508,8 +2522,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2518,1 +2525,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2521,1 +2528,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2529,0 +2538,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2530,1 +2557,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2540,1 +2567,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2554,8 +2581,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2564,1 +2584,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2567,1 +2587,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                float v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2576,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2585,1 +2607,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2597,8 +2619,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2607,1 +2622,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2610,1 +2625,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2618,0 +2635,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2619,1 +2654,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2629,1 +2664,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2643,8 +2678,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2653,1 +2681,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2656,1 +2684,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2665,1 +2695,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2674,1 +2704,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2686,8 +2716,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2696,1 +2719,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2699,1 +2722,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2707,0 +2732,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2708,1 +2751,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2718,1 +2761,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2732,8 +2775,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2742,1 +2778,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2745,1 +2781,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2754,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2763,1 +2801,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2775,8 +2813,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2785,1 +2816,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2788,1 +2819,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2796,0 +2829,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2797,1 +2848,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2807,1 +2858,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2821,8 +2872,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2831,1 +2875,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2834,1 +2878,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float256VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2398,1 +2404,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2407,1 +2413,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2422,0 +2428,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2424,9 +2431,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2440,0 +2441,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2441,1 +2460,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2451,1 +2470,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2468,0 +2487,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2470,9 +2490,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                float v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2487,1 +2501,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2496,1 +2510,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2508,8 +2522,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2518,1 +2525,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2521,1 +2528,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2529,0 +2538,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2530,1 +2557,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2540,1 +2567,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2554,8 +2581,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2564,1 +2584,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2567,1 +2587,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                float v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2576,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2585,1 +2607,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2597,8 +2619,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2607,1 +2622,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2610,1 +2625,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2618,0 +2635,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2619,1 +2654,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2629,1 +2664,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2643,8 +2678,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2653,1 +2681,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2656,1 +2684,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2665,1 +2695,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2674,1 +2704,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2686,8 +2716,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2696,1 +2719,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2699,1 +2722,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2707,0 +2732,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2708,1 +2751,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2718,1 +2761,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2732,8 +2775,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2742,1 +2778,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2745,1 +2781,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2754,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2763,1 +2801,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2775,8 +2813,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2785,1 +2816,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2788,1 +2819,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2796,0 +2829,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2797,1 +2848,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2807,1 +2858,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2821,8 +2872,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2831,1 +2875,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2834,1 +2878,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float512VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,6 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n@@ -2398,1 +2404,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2407,1 +2413,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2422,0 +2428,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2424,9 +2431,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2440,0 +2441,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2441,1 +2460,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2451,1 +2470,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2468,0 +2487,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2470,9 +2490,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                float v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2487,1 +2501,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2496,1 +2510,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2508,8 +2522,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2518,1 +2525,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2521,1 +2528,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2529,0 +2538,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2530,1 +2557,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2540,1 +2567,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2554,8 +2581,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2564,1 +2584,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2567,1 +2587,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                float v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2576,1 +2598,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2585,1 +2607,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2597,8 +2619,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2607,1 +2622,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2610,1 +2625,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2618,0 +2635,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2619,1 +2654,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2629,1 +2664,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2643,8 +2678,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2653,1 +2681,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2656,1 +2684,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2665,1 +2695,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2674,1 +2704,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2686,8 +2716,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2696,1 +2719,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2699,1 +2722,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2707,0 +2732,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2708,1 +2751,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2718,1 +2761,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2732,8 +2775,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2742,1 +2778,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2745,1 +2781,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2754,1 +2792,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2763,1 +2801,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2775,8 +2813,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2785,1 +2816,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2788,1 +2819,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2796,0 +2829,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2797,1 +2848,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2807,1 +2858,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2821,8 +2872,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2831,1 +2875,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2834,1 +2878,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Float64VectorTests.java","additions":165,"deletions":119,"binary":false,"changes":284,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,7 @@\n+    \/\/ Identity values for reduction operations\n+    private static final float ADD_IDENTITY = (float)0;\n+    private static final float FIRST_NONZERO_IDENTITY = (float)0;\n+    private static final float MAX_IDENTITY = Float.NEGATIVE_INFINITY;\n+    private static final float MIN_IDENTITY = Float.POSITIVE_INFINITY;\n+    private static final float MUL_IDENTITY = (float)1;\n+\n@@ -2403,1 +2410,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2412,1 +2419,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2427,0 +2434,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2429,9 +2437,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                float v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -2445,0 +2447,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((float) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2446,1 +2466,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2456,1 +2476,1 @@\n-        float res = 0;\n+        float res = ADD_IDENTITY;\n@@ -2473,0 +2493,1 @@\n+            ra = ADD_IDENTITY;\n@@ -2475,9 +2496,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                float v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -2492,1 +2507,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2501,1 +2516,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2513,8 +2528,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        float ra = 0;\n@@ -2523,1 +2531,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2526,1 +2534,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                float v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -2534,0 +2544,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((float) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2535,1 +2563,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2545,1 +2573,1 @@\n-        float res = 1;\n+        float res = MUL_IDENTITY;\n@@ -2559,8 +2587,1 @@\n-        float ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2569,1 +2590,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -2572,1 +2593,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                float v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -2581,1 +2604,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2590,1 +2613,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2602,8 +2625,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        float ra = 0;\n@@ -2612,1 +2628,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2615,1 +2631,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                float v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2623,0 +2641,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2624,1 +2660,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2634,1 +2670,1 @@\n-        float res = Float.POSITIVE_INFINITY;\n+        float res = MIN_IDENTITY;\n@@ -2648,8 +2684,1 @@\n-        float ra = Float.POSITIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2658,1 +2687,1 @@\n-            ra = Float.POSITIVE_INFINITY;\n+            ra = MIN_IDENTITY;\n@@ -2661,1 +2690,3 @@\n-                ra = (float) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                float v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (float) Math.min(ra, v);\n@@ -2670,1 +2701,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2679,1 +2710,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2691,8 +2722,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        float ra = 0;\n@@ -2701,1 +2725,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2704,1 +2728,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                float v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2712,0 +2738,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((float) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals((float) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((float) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2713,1 +2757,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2723,1 +2767,1 @@\n-        float res = Float.NEGATIVE_INFINITY;\n+        float res = MAX_IDENTITY;\n@@ -2737,8 +2781,1 @@\n-        float ra = Float.NEGATIVE_INFINITY;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2747,1 +2784,1 @@\n-            ra = Float.NEGATIVE_INFINITY;\n+            ra = MAX_IDENTITY;\n@@ -2750,1 +2787,3 @@\n-                ra = (float) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                float v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (float) Math.max(ra, v);\n@@ -2759,1 +2798,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2768,1 +2807,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2780,8 +2819,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        float ra = 0;\n@@ -2790,1 +2822,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2793,1 +2825,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -2801,0 +2835,18 @@\n+    @Test(dataProvider = \"floatUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<float[]> fa) {\n+        float[] a = fa.apply(SPECIES.length());\n+        float id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            float x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -2802,1 +2854,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2812,1 +2864,1 @@\n-        float res = (float) 0;\n+        float res = FIRST_NONZERO_IDENTITY;\n@@ -2826,8 +2878,1 @@\n-        float ra = (float) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                FloatVector av = FloatVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        float ra = 0;\n@@ -2836,1 +2881,1 @@\n-            ra = (float) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -2839,1 +2884,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                float v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/FloatMaxVectorTests.java","additions":166,"deletions":119,"binary":false,"changes":285,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int SUADD_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3658,1 +3670,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3667,1 +3679,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3679,8 +3691,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3689,1 +3694,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3692,1 +3697,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3700,0 +3707,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3701,1 +3726,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3711,1 +3736,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3725,8 +3750,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3735,1 +3753,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3738,1 +3756,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                int v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3747,1 +3767,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3756,1 +3776,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3771,0 +3791,1 @@\n+            ra = OR_IDENTITY;\n@@ -3773,9 +3794,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3789,0 +3804,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3790,1 +3823,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3800,1 +3833,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3817,0 +3850,1 @@\n+            ra = OR_IDENTITY;\n@@ -3819,9 +3853,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                int v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3836,1 +3864,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3845,1 +3873,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3860,0 +3888,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3862,9 +3891,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3878,0 +3901,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3879,1 +3920,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3889,1 +3930,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3906,0 +3947,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3908,9 +3950,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                int v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3925,1 +3961,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3934,1 +3970,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3949,0 +3985,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3951,9 +3988,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3967,0 +3998,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3968,1 +4017,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3978,1 +4027,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3995,0 +4044,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3997,9 +4047,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                int v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4014,1 +4058,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4023,1 +4067,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4035,8 +4079,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -4045,1 +4082,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4048,1 +4085,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4056,0 +4095,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4057,1 +4114,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4067,1 +4124,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4081,8 +4138,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4091,1 +4141,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4094,1 +4144,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                int v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4103,1 +4155,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4112,1 +4164,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4124,8 +4176,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4134,1 +4179,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4137,1 +4182,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4145,0 +4192,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4146,1 +4211,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4156,1 +4221,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4170,8 +4235,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4180,1 +4238,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4183,1 +4241,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4192,1 +4252,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4201,1 +4261,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4213,8 +4273,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4223,1 +4276,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4226,1 +4279,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4234,0 +4289,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4235,1 +4308,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4245,1 +4318,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4259,8 +4332,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4269,1 +4335,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4272,1 +4338,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4281,1 +4349,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4290,1 +4358,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4302,8 +4370,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4312,1 +4373,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4315,1 +4376,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4323,0 +4386,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4324,1 +4405,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4334,1 +4415,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4348,8 +4429,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4358,1 +4432,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4361,1 +4435,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4370,1 +4446,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4379,1 +4455,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4391,8 +4467,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4401,1 +4470,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4404,1 +4473,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4412,0 +4483,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4413,1 +4502,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4423,1 +4512,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4437,8 +4526,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4447,1 +4529,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4450,1 +4532,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4459,1 +4543,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4552,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4480,8 +4564,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4490,1 +4567,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4493,1 +4570,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4501,0 +4580,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4502,1 +4599,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4512,1 +4609,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4526,8 +4623,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4536,1 +4626,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4539,1 +4629,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4596,1 +4688,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4605,1 +4697,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4620,0 +4712,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4622,9 +4715,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                int v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4638,0 +4725,18 @@\n+    @Test(dataProvider = \"intSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4639,1 +4744,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4649,1 +4754,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4665,0 +4770,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4667,9 +4773,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                int v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int128VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int SUADD_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3658,1 +3670,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3667,1 +3679,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3679,8 +3691,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3689,1 +3694,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3692,1 +3697,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3700,0 +3707,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3701,1 +3726,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3711,1 +3736,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3725,8 +3750,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3735,1 +3753,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3738,1 +3756,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                int v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3747,1 +3767,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3756,1 +3776,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3771,0 +3791,1 @@\n+            ra = OR_IDENTITY;\n@@ -3773,9 +3794,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3789,0 +3804,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3790,1 +3823,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3800,1 +3833,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3817,0 +3850,1 @@\n+            ra = OR_IDENTITY;\n@@ -3819,9 +3853,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                int v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3836,1 +3864,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3845,1 +3873,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3860,0 +3888,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3862,9 +3891,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3878,0 +3901,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3879,1 +3920,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3889,1 +3930,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3906,0 +3947,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3908,9 +3950,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                int v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3925,1 +3961,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3934,1 +3970,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3949,0 +3985,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3951,9 +3988,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3967,0 +3998,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3968,1 +4017,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3978,1 +4027,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3995,0 +4044,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3997,9 +4047,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                int v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4014,1 +4058,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4023,1 +4067,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4035,8 +4079,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -4045,1 +4082,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4048,1 +4085,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4056,0 +4095,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4057,1 +4114,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4067,1 +4124,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4081,8 +4138,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4091,1 +4141,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4094,1 +4144,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                int v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4103,1 +4155,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4112,1 +4164,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4124,8 +4176,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4134,1 +4179,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4137,1 +4182,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4145,0 +4192,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4146,1 +4211,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4156,1 +4221,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4170,8 +4235,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4180,1 +4238,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4183,1 +4241,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4192,1 +4252,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4201,1 +4261,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4213,8 +4273,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4223,1 +4276,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4226,1 +4279,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4234,0 +4289,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4235,1 +4308,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4245,1 +4318,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4259,8 +4332,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4269,1 +4335,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4272,1 +4338,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4281,1 +4349,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4290,1 +4358,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4302,8 +4370,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4312,1 +4373,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4315,1 +4376,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4323,0 +4386,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4324,1 +4405,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4334,1 +4415,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4348,8 +4429,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4358,1 +4432,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4361,1 +4435,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4370,1 +4446,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4379,1 +4455,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4391,8 +4467,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4401,1 +4470,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4404,1 +4473,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4412,0 +4483,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4413,1 +4502,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4423,1 +4512,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4437,8 +4526,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4447,1 +4529,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4450,1 +4532,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4459,1 +4543,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4552,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4480,8 +4564,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4490,1 +4567,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4493,1 +4570,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4501,0 +4580,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4502,1 +4599,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4512,1 +4609,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4526,8 +4623,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4536,1 +4626,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4539,1 +4629,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4596,1 +4688,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4605,1 +4697,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4620,0 +4712,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4622,9 +4715,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                int v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4638,0 +4725,18 @@\n+    @Test(dataProvider = \"intSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4639,1 +4744,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4649,1 +4754,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4665,0 +4770,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4667,9 +4773,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                int v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int256VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int SUADD_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3658,1 +3670,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3667,1 +3679,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3679,8 +3691,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3689,1 +3694,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3692,1 +3697,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3700,0 +3707,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3701,1 +3726,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3711,1 +3736,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3725,8 +3750,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3735,1 +3753,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3738,1 +3756,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                int v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3747,1 +3767,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3756,1 +3776,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3771,0 +3791,1 @@\n+            ra = OR_IDENTITY;\n@@ -3773,9 +3794,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3789,0 +3804,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3790,1 +3823,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3800,1 +3833,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3817,0 +3850,1 @@\n+            ra = OR_IDENTITY;\n@@ -3819,9 +3853,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                int v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3836,1 +3864,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3845,1 +3873,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3860,0 +3888,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3862,9 +3891,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3878,0 +3901,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3879,1 +3920,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3889,1 +3930,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3906,0 +3947,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3908,9 +3950,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                int v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3925,1 +3961,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3934,1 +3970,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3949,0 +3985,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3951,9 +3988,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3967,0 +3998,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3968,1 +4017,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3978,1 +4027,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3995,0 +4044,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3997,9 +4047,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                int v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4014,1 +4058,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4023,1 +4067,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4035,8 +4079,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -4045,1 +4082,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4048,1 +4085,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4056,0 +4095,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4057,1 +4114,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4067,1 +4124,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4081,8 +4138,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4091,1 +4141,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4094,1 +4144,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                int v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4103,1 +4155,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4112,1 +4164,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4124,8 +4176,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4134,1 +4179,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4137,1 +4182,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4145,0 +4192,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4146,1 +4211,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4156,1 +4221,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4170,8 +4235,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4180,1 +4238,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4183,1 +4241,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4192,1 +4252,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4201,1 +4261,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4213,8 +4273,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4223,1 +4276,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4226,1 +4279,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4234,0 +4289,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4235,1 +4308,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4245,1 +4318,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4259,8 +4332,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4269,1 +4335,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4272,1 +4338,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4281,1 +4349,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4290,1 +4358,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4302,8 +4370,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4312,1 +4373,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4315,1 +4376,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4323,0 +4386,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4324,1 +4405,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4334,1 +4415,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4348,8 +4429,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4358,1 +4432,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4361,1 +4435,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4370,1 +4446,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4379,1 +4455,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4391,8 +4467,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4401,1 +4470,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4404,1 +4473,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4412,0 +4483,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4413,1 +4502,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4423,1 +4512,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4437,8 +4526,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4447,1 +4529,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4450,1 +4532,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4459,1 +4543,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4552,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4480,8 +4564,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4490,1 +4567,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4493,1 +4570,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4501,0 +4580,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4502,1 +4599,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4512,1 +4609,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4526,8 +4623,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4536,1 +4626,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4539,1 +4629,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4596,1 +4688,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4605,1 +4697,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4620,0 +4712,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4622,9 +4715,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                int v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4638,0 +4725,18 @@\n+    @Test(dataProvider = \"intSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4639,1 +4744,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4649,1 +4754,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4665,0 +4770,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4667,9 +4773,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                int v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int512VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int SUADD_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3658,1 +3670,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3667,1 +3679,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3679,8 +3691,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3689,1 +3694,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3692,1 +3697,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3700,0 +3707,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3701,1 +3726,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3711,1 +3736,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3725,8 +3750,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3735,1 +3753,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3738,1 +3756,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                int v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3747,1 +3767,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3756,1 +3776,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3771,0 +3791,1 @@\n+            ra = OR_IDENTITY;\n@@ -3773,9 +3794,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3789,0 +3804,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3790,1 +3823,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3800,1 +3833,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3817,0 +3850,1 @@\n+            ra = OR_IDENTITY;\n@@ -3819,9 +3853,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                int v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3836,1 +3864,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3845,1 +3873,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3860,0 +3888,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3862,9 +3891,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3878,0 +3901,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3879,1 +3920,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3889,1 +3930,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3906,0 +3947,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3908,9 +3950,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                int v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3925,1 +3961,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3934,1 +3970,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3949,0 +3985,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3951,9 +3988,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3967,0 +3998,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3968,1 +4017,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3978,1 +4027,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3995,0 +4044,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3997,9 +4047,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                int v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4014,1 +4058,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4023,1 +4067,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4035,8 +4079,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -4045,1 +4082,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4048,1 +4085,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4056,0 +4095,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4057,1 +4114,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4067,1 +4124,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4081,8 +4138,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4091,1 +4141,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4094,1 +4144,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                int v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4103,1 +4155,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4112,1 +4164,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4124,8 +4176,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4134,1 +4179,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4137,1 +4182,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4145,0 +4192,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4146,1 +4211,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4156,1 +4221,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4170,8 +4235,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4180,1 +4238,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4183,1 +4241,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4192,1 +4252,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4201,1 +4261,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4213,8 +4273,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4223,1 +4276,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4226,1 +4279,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4234,0 +4289,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4235,1 +4308,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4245,1 +4318,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4259,8 +4332,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4269,1 +4335,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4272,1 +4338,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4281,1 +4349,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4290,1 +4358,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4302,8 +4370,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4312,1 +4373,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4315,1 +4376,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4323,0 +4386,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4324,1 +4405,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4334,1 +4415,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4348,8 +4429,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4358,1 +4432,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4361,1 +4435,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4370,1 +4446,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4379,1 +4455,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4391,8 +4467,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4401,1 +4470,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4404,1 +4473,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4412,0 +4483,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4413,1 +4502,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4423,1 +4512,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4437,8 +4526,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4447,1 +4529,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4450,1 +4532,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4459,1 +4543,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4468,1 +4552,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4480,8 +4564,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4490,1 +4567,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4493,1 +4570,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4501,0 +4580,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4502,1 +4599,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4512,1 +4609,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4526,8 +4623,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4536,1 +4626,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4539,1 +4629,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4596,1 +4688,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4605,1 +4697,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4620,0 +4712,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4622,9 +4715,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                int v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4638,0 +4725,18 @@\n+    @Test(dataProvider = \"intSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4639,1 +4744,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4649,1 +4754,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4665,0 +4770,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4667,9 +4773,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                int v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Int64VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final int ADD_IDENTITY = (int)0;\n+    private static final int AND_IDENTITY = (int)-1;\n+    private static final int FIRST_NONZERO_IDENTITY = (int)0;\n+    private static final int MAX_IDENTITY = Integer.MIN_VALUE;\n+    private static final int MIN_IDENTITY = Integer.MAX_VALUE;\n+    private static final int MUL_IDENTITY = (int)1;\n+    private static final int OR_IDENTITY = (int)0;\n+    private static final int SUADD_IDENTITY = (int)0;\n+    private static final int UMAX_IDENTITY = (int)0;   \/\/ Minimum unsigned value\n+    private static final int UMIN_IDENTITY = (int)-1;  \/\/ Maximum unsigned value\n+    private static final int XOR_IDENTITY = (int)0;\n+\n@@ -3663,1 +3676,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3672,1 +3685,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3684,8 +3697,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        int ra = 0;\n@@ -3694,1 +3700,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3697,1 +3703,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                int v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3705,0 +3713,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = AND_IDENTITY;\n+\n+        Assert.assertEquals((int) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3706,1 +3732,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3716,1 +3742,1 @@\n-        int res = -1;\n+        int res = AND_IDENTITY;\n@@ -3730,8 +3756,1 @@\n-        int ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -3740,1 +3759,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3743,1 +3762,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                int v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3752,1 +3773,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3761,1 +3782,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3776,0 +3797,1 @@\n+            ra = OR_IDENTITY;\n@@ -3778,9 +3800,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                int v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3794,0 +3810,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = OR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3795,1 +3829,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3805,1 +3839,1 @@\n-        int res = 0;\n+        int res = OR_IDENTITY;\n@@ -3822,0 +3856,1 @@\n+            ra = OR_IDENTITY;\n@@ -3824,9 +3859,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                int v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3841,1 +3870,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3850,1 +3879,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3865,0 +3894,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3867,9 +3897,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                int v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3883,0 +3907,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((int) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3884,1 +3926,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3894,1 +3936,1 @@\n-        int res = 0;\n+        int res = XOR_IDENTITY;\n@@ -3911,0 +3953,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3913,9 +3956,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                int v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3930,1 +3967,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3939,1 +3976,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3954,0 +3991,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3956,9 +3994,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                int v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3972,0 +4004,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((int) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3973,1 +4023,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -3983,1 +4033,1 @@\n-        int res = 0;\n+        int res = ADD_IDENTITY;\n@@ -4000,0 +4050,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4002,9 +4053,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                int v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4019,1 +4064,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4028,1 +4073,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4040,8 +4085,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        int ra = 0;\n@@ -4050,1 +4088,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4053,1 +4091,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                int v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4061,0 +4101,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((int) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4062,1 +4120,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4072,1 +4130,1 @@\n-        int res = 1;\n+        int res = MUL_IDENTITY;\n@@ -4086,8 +4144,1 @@\n-        int ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4096,1 +4147,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4099,1 +4150,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                int v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4108,1 +4161,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4117,1 +4170,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4129,8 +4182,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4139,1 +4185,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4142,1 +4188,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                int v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4150,0 +4198,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4151,1 +4217,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4161,1 +4227,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = MIN_IDENTITY;\n@@ -4175,8 +4241,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4185,1 +4244,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4188,1 +4247,3 @@\n-                ra = (int) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (int) Math.min(ra, v);\n@@ -4197,1 +4258,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4206,1 +4267,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4218,8 +4279,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4228,1 +4282,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4231,1 +4285,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                int v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4239,0 +4295,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((int) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4240,1 +4314,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4250,1 +4324,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = MAX_IDENTITY;\n@@ -4264,8 +4338,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4274,1 +4341,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4277,1 +4344,3 @@\n-                ra = (int) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (int) Math.max(ra, v);\n@@ -4286,1 +4355,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4295,1 +4364,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4307,8 +4376,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        int ra = 0;\n@@ -4317,1 +4379,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4320,1 +4382,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                int v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4328,0 +4392,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4329,1 +4411,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4339,1 +4421,1 @@\n-        int res = Integer.MAX_VALUE;\n+        int res = UMIN_IDENTITY;\n@@ -4353,8 +4435,1 @@\n-        int ra = Integer.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4363,1 +4438,1 @@\n-            ra = Integer.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4366,1 +4441,3 @@\n-                ra = (int) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.minUnsigned(ra, v);\n@@ -4375,1 +4452,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4384,1 +4461,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4396,8 +4473,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        int ra = 0;\n@@ -4406,1 +4476,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4409,1 +4479,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                int v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4417,0 +4489,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4418,1 +4508,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4428,1 +4518,1 @@\n-        int res = Integer.MIN_VALUE;\n+        int res = UMAX_IDENTITY;\n@@ -4442,8 +4532,1 @@\n-        int ra = Integer.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4452,1 +4535,1 @@\n-            ra = Integer.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4455,1 +4538,3 @@\n-                ra = (int) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                int v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.maxUnsigned(ra, v);\n@@ -4464,1 +4549,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4473,1 +4558,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4485,8 +4570,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        int ra = 0;\n@@ -4495,1 +4573,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4498,1 +4576,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4506,0 +4586,18 @@\n+    @Test(dataProvider = \"intUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4507,1 +4605,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4517,1 +4615,1 @@\n-        int res = (int) 0;\n+        int res = FIRST_NONZERO_IDENTITY;\n@@ -4531,8 +4629,1 @@\n-        int ra = (int) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        int ra = 0;\n@@ -4541,1 +4632,1 @@\n-            ra = (int) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4544,1 +4635,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                int v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4601,1 +4694,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4610,1 +4703,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4625,0 +4718,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4627,9 +4721,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                int v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4643,0 +4731,18 @@\n+    @Test(dataProvider = \"intSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<int[]> fa) {\n+        int[] a = fa.apply(SPECIES.length());\n+        int id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            int x = a[i];\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((int) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4644,1 +4750,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4654,1 +4760,1 @@\n-        int res = 0;\n+        int res = SUADD_IDENTITY;\n@@ -4670,0 +4776,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4672,9 +4779,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                IntVector av = IntVector.fromArray(SPECIES, a, i);\n-                ra = (int) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                int v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (int) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/IntMaxVectorTests.java","additions":358,"deletions":257,"binary":false,"changes":615,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long SUADD_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3680,1 +3692,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3689,1 +3701,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3701,8 +3713,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3711,1 +3716,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3714,1 +3719,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3722,0 +3729,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3723,1 +3748,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3733,1 +3758,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3747,8 +3772,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -3757,1 +3775,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3760,1 +3778,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                long v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3769,1 +3789,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3778,1 +3798,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3793,0 +3813,1 @@\n+            ra = OR_IDENTITY;\n@@ -3795,9 +3816,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3811,0 +3826,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3812,1 +3845,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3822,1 +3855,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3839,0 +3872,1 @@\n+            ra = OR_IDENTITY;\n@@ -3841,9 +3875,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                long v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3858,1 +3886,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3867,1 +3895,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3882,0 +3910,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3884,9 +3913,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3900,0 +3923,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3901,1 +3942,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3911,1 +3952,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3928,0 +3969,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3930,9 +3972,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                long v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3947,1 +3983,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3956,1 +3992,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3971,0 +4007,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3973,9 +4010,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3989,0 +4020,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3990,1 +4039,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4000,1 +4049,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4017,0 +4066,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4019,9 +4069,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                long v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4036,1 +4080,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4045,1 +4089,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4057,8 +4101,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -4067,1 +4104,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4070,1 +4107,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4078,0 +4117,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4079,1 +4136,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4089,1 +4146,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4103,8 +4160,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4113,1 +4163,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4116,1 +4166,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                long v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4125,1 +4177,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4134,1 +4186,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4146,8 +4198,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4156,1 +4201,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4159,1 +4204,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4167,0 +4214,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4168,1 +4233,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4178,1 +4243,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4192,8 +4257,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4202,1 +4260,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4205,1 +4263,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4214,1 +4274,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4223,1 +4283,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4235,8 +4295,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4245,1 +4298,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4248,1 +4301,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4256,0 +4311,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4257,1 +4330,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4267,1 +4340,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4281,8 +4354,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4291,1 +4357,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4294,1 +4360,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4303,1 +4371,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4312,1 +4380,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4324,8 +4392,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4334,1 +4395,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4337,1 +4398,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4345,0 +4408,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4346,1 +4427,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4356,1 +4437,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4370,8 +4451,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4380,1 +4454,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4383,1 +4457,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4392,1 +4468,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4401,1 +4477,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4413,8 +4489,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4423,1 +4492,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4426,1 +4495,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4434,0 +4505,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4435,1 +4524,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4445,1 +4534,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4459,8 +4548,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4469,1 +4551,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4472,1 +4554,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4481,1 +4565,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4490,1 +4574,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4502,8 +4586,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4512,1 +4589,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4515,1 +4592,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4523,0 +4602,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4524,1 +4621,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4534,1 +4631,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4548,8 +4645,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4558,1 +4648,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4561,1 +4651,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4618,1 +4710,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4627,1 +4719,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4642,0 +4734,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4644,9 +4737,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                long v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4660,0 +4747,18 @@\n+    @Test(dataProvider = \"longSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4661,1 +4766,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4671,1 +4776,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4687,0 +4792,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4689,9 +4795,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                long v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long128VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long SUADD_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3680,1 +3692,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3689,1 +3701,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3701,8 +3713,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3711,1 +3716,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3714,1 +3719,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3722,0 +3729,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3723,1 +3748,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3733,1 +3758,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3747,8 +3772,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -3757,1 +3775,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3760,1 +3778,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                long v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3769,1 +3789,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3778,1 +3798,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3793,0 +3813,1 @@\n+            ra = OR_IDENTITY;\n@@ -3795,9 +3816,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3811,0 +3826,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3812,1 +3845,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3822,1 +3855,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3839,0 +3872,1 @@\n+            ra = OR_IDENTITY;\n@@ -3841,9 +3875,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                long v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3858,1 +3886,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3867,1 +3895,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3882,0 +3910,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3884,9 +3913,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3900,0 +3923,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3901,1 +3942,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3911,1 +3952,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3928,0 +3969,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3930,9 +3972,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                long v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3947,1 +3983,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3956,1 +3992,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3971,0 +4007,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3973,9 +4010,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3989,0 +4020,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3990,1 +4039,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4000,1 +4049,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4017,0 +4066,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4019,9 +4069,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                long v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4036,1 +4080,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4045,1 +4089,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4057,8 +4101,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -4067,1 +4104,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4070,1 +4107,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4078,0 +4117,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4079,1 +4136,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4089,1 +4146,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4103,8 +4160,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4113,1 +4163,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4116,1 +4166,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                long v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4125,1 +4177,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4134,1 +4186,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4146,8 +4198,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4156,1 +4201,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4159,1 +4204,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4167,0 +4214,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4168,1 +4233,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4178,1 +4243,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4192,8 +4257,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4202,1 +4260,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4205,1 +4263,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4214,1 +4274,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4223,1 +4283,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4235,8 +4295,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4245,1 +4298,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4248,1 +4301,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4256,0 +4311,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4257,1 +4330,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4267,1 +4340,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4281,8 +4354,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4291,1 +4357,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4294,1 +4360,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4303,1 +4371,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4312,1 +4380,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4324,8 +4392,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4334,1 +4395,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4337,1 +4398,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4345,0 +4408,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4346,1 +4427,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4356,1 +4437,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4370,8 +4451,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4380,1 +4454,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4383,1 +4457,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4392,1 +4468,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4401,1 +4477,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4413,8 +4489,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4423,1 +4492,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4426,1 +4495,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4434,0 +4505,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4435,1 +4524,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4445,1 +4534,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4459,8 +4548,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4469,1 +4551,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4472,1 +4554,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4481,1 +4565,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4490,1 +4574,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4502,8 +4586,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4512,1 +4589,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4515,1 +4592,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4523,0 +4602,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4524,1 +4621,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4534,1 +4631,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4548,8 +4645,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4558,1 +4648,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4561,1 +4651,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4618,1 +4710,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4627,1 +4719,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4642,0 +4734,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4644,9 +4737,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                long v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4660,0 +4747,18 @@\n+    @Test(dataProvider = \"longSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4661,1 +4766,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4671,1 +4776,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4687,0 +4792,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4689,9 +4795,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                long v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long256VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long SUADD_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3680,1 +3692,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3689,1 +3701,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3701,8 +3713,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3711,1 +3716,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3714,1 +3719,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3722,0 +3729,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3723,1 +3748,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3733,1 +3758,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3747,8 +3772,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -3757,1 +3775,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3760,1 +3778,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                long v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3769,1 +3789,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3778,1 +3798,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3793,0 +3813,1 @@\n+            ra = OR_IDENTITY;\n@@ -3795,9 +3816,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3811,0 +3826,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3812,1 +3845,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3822,1 +3855,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3839,0 +3872,1 @@\n+            ra = OR_IDENTITY;\n@@ -3841,9 +3875,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                long v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3858,1 +3886,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3867,1 +3895,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3882,0 +3910,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3884,9 +3913,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3900,0 +3923,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3901,1 +3942,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3911,1 +3952,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3928,0 +3969,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3930,9 +3972,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                long v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3947,1 +3983,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3956,1 +3992,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3971,0 +4007,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3973,9 +4010,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3989,0 +4020,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3990,1 +4039,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4000,1 +4049,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4017,0 +4066,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4019,9 +4069,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                long v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4036,1 +4080,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4045,1 +4089,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4057,8 +4101,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -4067,1 +4104,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4070,1 +4107,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4078,0 +4117,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4079,1 +4136,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4089,1 +4146,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4103,8 +4160,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4113,1 +4163,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4116,1 +4166,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                long v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4125,1 +4177,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4134,1 +4186,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4146,8 +4198,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4156,1 +4201,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4159,1 +4204,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4167,0 +4214,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4168,1 +4233,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4178,1 +4243,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4192,8 +4257,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4202,1 +4260,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4205,1 +4263,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4214,1 +4274,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4223,1 +4283,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4235,8 +4295,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4245,1 +4298,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4248,1 +4301,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4256,0 +4311,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4257,1 +4330,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4267,1 +4340,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4281,8 +4354,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4291,1 +4357,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4294,1 +4360,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4303,1 +4371,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4312,1 +4380,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4324,8 +4392,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4334,1 +4395,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4337,1 +4398,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4345,0 +4408,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4346,1 +4427,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4356,1 +4437,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4370,8 +4451,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4380,1 +4454,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4383,1 +4457,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4392,1 +4468,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4401,1 +4477,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4413,8 +4489,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4423,1 +4492,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4426,1 +4495,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4434,0 +4505,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4435,1 +4524,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4445,1 +4534,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4459,8 +4548,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4469,1 +4551,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4472,1 +4554,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4481,1 +4565,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4490,1 +4574,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4502,8 +4586,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4512,1 +4589,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4515,1 +4592,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4523,0 +4602,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4524,1 +4621,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4534,1 +4631,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4548,8 +4645,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4558,1 +4648,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4561,1 +4651,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4618,1 +4710,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4627,1 +4719,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4642,0 +4734,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4644,9 +4737,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                long v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4660,0 +4747,18 @@\n+    @Test(dataProvider = \"longSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4661,1 +4766,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4671,1 +4776,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4687,0 +4792,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4689,9 +4795,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                long v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long512VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long SUADD_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3680,1 +3692,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3689,1 +3701,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3701,8 +3713,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3711,1 +3716,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3714,1 +3719,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3722,0 +3729,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3723,1 +3748,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3733,1 +3758,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3747,8 +3772,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -3757,1 +3775,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3760,1 +3778,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                long v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3769,1 +3789,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3778,1 +3798,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3793,0 +3813,1 @@\n+            ra = OR_IDENTITY;\n@@ -3795,9 +3816,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3811,0 +3826,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3812,1 +3845,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3822,1 +3855,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3839,0 +3872,1 @@\n+            ra = OR_IDENTITY;\n@@ -3841,9 +3875,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                long v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3858,1 +3886,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3867,1 +3895,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3882,0 +3910,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3884,9 +3913,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3900,0 +3923,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3901,1 +3942,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3911,1 +3952,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3928,0 +3969,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3930,9 +3972,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                long v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3947,1 +3983,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3956,1 +3992,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3971,0 +4007,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3973,9 +4010,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3989,0 +4020,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3990,1 +4039,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4000,1 +4049,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4017,0 +4066,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4019,9 +4069,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                long v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4036,1 +4080,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4045,1 +4089,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4057,8 +4101,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -4067,1 +4104,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4070,1 +4107,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4078,0 +4117,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4079,1 +4136,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4089,1 +4146,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4103,8 +4160,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4113,1 +4163,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4116,1 +4166,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                long v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4125,1 +4177,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4134,1 +4186,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4146,8 +4198,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4156,1 +4201,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4159,1 +4204,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4167,0 +4214,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4168,1 +4233,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4178,1 +4243,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4192,8 +4257,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4202,1 +4260,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4205,1 +4263,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4214,1 +4274,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4223,1 +4283,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4235,8 +4295,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4245,1 +4298,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4248,1 +4301,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4256,0 +4311,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4257,1 +4330,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4267,1 +4340,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4281,8 +4354,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4291,1 +4357,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4294,1 +4360,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4303,1 +4371,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4312,1 +4380,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4324,8 +4392,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4334,1 +4395,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4337,1 +4398,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4345,0 +4408,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4346,1 +4427,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4356,1 +4437,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4370,8 +4451,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4380,1 +4454,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4383,1 +4457,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4392,1 +4468,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4401,1 +4477,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4413,8 +4489,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4423,1 +4492,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4426,1 +4495,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4434,0 +4505,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4435,1 +4524,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4445,1 +4534,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4459,8 +4548,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4469,1 +4551,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4472,1 +4554,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4481,1 +4565,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4490,1 +4574,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4502,8 +4586,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4512,1 +4589,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4515,1 +4592,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4523,0 +4602,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4524,1 +4621,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4534,1 +4631,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4548,8 +4645,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4558,1 +4648,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4561,1 +4651,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4618,1 +4710,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4627,1 +4719,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4642,0 +4734,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4644,9 +4737,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                long v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4660,0 +4747,18 @@\n+    @Test(dataProvider = \"longSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4661,1 +4766,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4671,1 +4776,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4687,0 +4792,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4689,9 +4795,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                long v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Long64VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final long ADD_IDENTITY = (long)0;\n+    private static final long AND_IDENTITY = (long)-1;\n+    private static final long FIRST_NONZERO_IDENTITY = (long)0;\n+    private static final long MAX_IDENTITY = Long.MIN_VALUE;\n+    private static final long MIN_IDENTITY = Long.MAX_VALUE;\n+    private static final long MUL_IDENTITY = (long)1;\n+    private static final long OR_IDENTITY = (long)0;\n+    private static final long SUADD_IDENTITY = (long)0;\n+    private static final long UMAX_IDENTITY = (long)0;   \/\/ Minimum unsigned value\n+    private static final long UMIN_IDENTITY = (long)-1;  \/\/ Maximum unsigned value\n+    private static final long XOR_IDENTITY = (long)0;\n+\n@@ -3685,1 +3698,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3694,1 +3707,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3706,8 +3719,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        long ra = 0;\n@@ -3716,1 +3722,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3719,1 +3725,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                long v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3727,0 +3735,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = AND_IDENTITY;\n+\n+        Assert.assertEquals((long) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3728,1 +3754,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3738,1 +3764,1 @@\n-        long res = -1;\n+        long res = AND_IDENTITY;\n@@ -3752,8 +3778,1 @@\n-        long ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -3762,1 +3781,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3765,1 +3784,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                long v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3774,1 +3795,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3783,1 +3804,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3798,0 +3819,1 @@\n+            ra = OR_IDENTITY;\n@@ -3800,9 +3822,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                long v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3816,0 +3832,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = OR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3817,1 +3851,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3827,1 +3861,1 @@\n-        long res = 0;\n+        long res = OR_IDENTITY;\n@@ -3844,0 +3878,1 @@\n+            ra = OR_IDENTITY;\n@@ -3846,9 +3881,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                long v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3863,1 +3892,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3872,1 +3901,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3887,0 +3916,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3889,9 +3919,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                long v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3905,0 +3929,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((long) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3906,1 +3948,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3916,1 +3958,1 @@\n-        long res = 0;\n+        long res = XOR_IDENTITY;\n@@ -3933,0 +3975,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3935,9 +3978,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                long v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3952,1 +3989,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3961,1 +3998,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -3976,0 +4013,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3978,9 +4016,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                long v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3994,0 +4026,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((long) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3995,1 +4045,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4005,1 +4055,1 @@\n-        long res = 0;\n+        long res = ADD_IDENTITY;\n@@ -4022,0 +4072,1 @@\n+            ra = ADD_IDENTITY;\n@@ -4024,9 +4075,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                long v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -4041,1 +4086,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4050,1 +4095,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4062,8 +4107,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        long ra = 0;\n@@ -4072,1 +4110,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4075,1 +4113,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                long v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4083,0 +4123,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((long) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4084,1 +4142,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4094,1 +4152,1 @@\n-        long res = 1;\n+        long res = MUL_IDENTITY;\n@@ -4108,8 +4166,1 @@\n-        long ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4118,1 +4169,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4121,1 +4172,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                long v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4130,1 +4183,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4139,1 +4192,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4151,8 +4204,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4161,1 +4207,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4164,1 +4210,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                long v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4172,0 +4220,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4173,1 +4239,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4183,1 +4249,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = MIN_IDENTITY;\n@@ -4197,8 +4263,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4207,1 +4266,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4210,1 +4269,3 @@\n-                ra = (long) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (long) Math.min(ra, v);\n@@ -4219,1 +4280,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4228,1 +4289,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4240,8 +4301,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4250,1 +4304,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4253,1 +4307,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                long v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4261,0 +4317,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((long) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4262,1 +4336,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4272,1 +4346,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = MAX_IDENTITY;\n@@ -4286,8 +4360,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4296,1 +4363,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4299,1 +4366,3 @@\n-                ra = (long) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (long) Math.max(ra, v);\n@@ -4308,1 +4377,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4317,1 +4386,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4329,8 +4398,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        long ra = 0;\n@@ -4339,1 +4401,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4342,1 +4404,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                long v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4350,0 +4414,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4351,1 +4433,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4361,1 +4443,1 @@\n-        long res = Long.MAX_VALUE;\n+        long res = UMIN_IDENTITY;\n@@ -4375,8 +4457,1 @@\n-        long ra = Long.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4385,1 +4460,1 @@\n-            ra = Long.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4388,1 +4463,3 @@\n-                ra = (long) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.minUnsigned(ra, v);\n@@ -4397,1 +4474,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4406,1 +4483,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4418,8 +4495,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        long ra = 0;\n@@ -4428,1 +4498,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4431,1 +4501,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                long v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4439,0 +4511,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4440,1 +4530,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4450,1 +4540,1 @@\n-        long res = Long.MIN_VALUE;\n+        long res = UMAX_IDENTITY;\n@@ -4464,8 +4554,1 @@\n-        long ra = Long.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4474,1 +4557,1 @@\n-            ra = Long.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4477,1 +4560,3 @@\n-                ra = (long) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                long v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.maxUnsigned(ra, v);\n@@ -4486,1 +4571,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4495,1 +4580,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4507,8 +4592,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        long ra = 0;\n@@ -4517,1 +4595,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4520,1 +4598,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4528,0 +4608,18 @@\n+    @Test(dataProvider = \"longUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4529,1 +4627,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4539,1 +4637,1 @@\n-        long res = (long) 0;\n+        long res = FIRST_NONZERO_IDENTITY;\n@@ -4553,8 +4651,1 @@\n-        long ra = (long) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        long ra = 0;\n@@ -4563,1 +4654,1 @@\n-            ra = (long) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4566,1 +4657,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                long v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4623,1 +4716,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4632,1 +4725,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4647,0 +4740,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4649,9 +4743,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                long v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4665,0 +4753,18 @@\n+    @Test(dataProvider = \"longSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<long[]> fa) {\n+        long[] a = fa.apply(SPECIES.length());\n+        long id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            long x = a[i];\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((long) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4666,1 +4772,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4676,1 +4782,1 @@\n-        long res = 0;\n+        long res = SUADD_IDENTITY;\n@@ -4692,0 +4798,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4694,9 +4801,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                LongVector av = LongVector.fromArray(SPECIES, a, i);\n-                ra = (long) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                long v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (long) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/LongMaxVectorTests.java","additions":358,"deletions":257,"binary":false,"changes":615,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short SUADD_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3605,1 +3617,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3614,1 +3626,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3626,8 +3638,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3636,1 +3641,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3639,1 +3644,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3647,0 +3654,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3648,1 +3673,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3658,1 +3683,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3672,8 +3697,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3682,1 +3700,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3685,1 +3703,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                short v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3694,1 +3714,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3703,1 +3723,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3718,0 +3738,1 @@\n+            ra = OR_IDENTITY;\n@@ -3720,9 +3741,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3736,0 +3751,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3737,1 +3770,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3747,1 +3780,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3764,0 +3797,1 @@\n+            ra = OR_IDENTITY;\n@@ -3766,9 +3800,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                short v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3783,1 +3811,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3792,1 +3820,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3807,0 +3835,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3809,9 +3838,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3825,0 +3848,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3826,1 +3867,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3836,1 +3877,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3853,0 +3894,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3855,9 +3897,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                short v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3872,1 +3908,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3881,1 +3917,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3896,0 +3932,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3898,9 +3935,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3914,0 +3945,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3915,1 +3964,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3925,1 +3974,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3942,0 +3991,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3944,9 +3994,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                short v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3961,1 +4005,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3970,1 +4014,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3982,8 +4026,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3992,1 +4029,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3995,1 +4032,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4003,0 +4042,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4004,1 +4061,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4014,1 +4071,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4028,8 +4085,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4038,1 +4088,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4041,1 +4091,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                short v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4050,1 +4102,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4059,1 +4111,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4071,8 +4123,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4081,1 +4126,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4084,1 +4129,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4092,0 +4139,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4093,1 +4158,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4103,1 +4168,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4117,8 +4182,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4127,1 +4185,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4130,1 +4188,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4139,1 +4199,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4148,1 +4208,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4160,8 +4220,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4170,1 +4223,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4173,1 +4226,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4181,0 +4236,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4182,1 +4255,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4192,1 +4265,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4206,8 +4279,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4216,1 +4282,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4219,1 +4285,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4228,1 +4296,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4237,1 +4305,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4249,8 +4317,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4259,1 +4320,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4262,1 +4323,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4270,0 +4333,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4271,1 +4352,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4281,1 +4362,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4295,8 +4376,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4305,1 +4379,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4308,1 +4382,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4317,1 +4393,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4326,1 +4402,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4338,8 +4414,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4348,1 +4417,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4351,1 +4420,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4359,0 +4430,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4360,1 +4449,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4370,1 +4459,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4384,8 +4473,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4394,1 +4476,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4397,1 +4479,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4406,1 +4490,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4415,1 +4499,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4427,8 +4511,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4437,1 +4514,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4440,1 +4517,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4448,0 +4527,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4449,1 +4546,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4459,1 +4556,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4473,8 +4570,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4483,1 +4573,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4486,1 +4576,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4543,1 +4635,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4552,1 +4644,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4567,0 +4659,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4569,9 +4662,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                short v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4585,0 +4672,18 @@\n+    @Test(dataProvider = \"shortSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4586,1 +4691,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4596,1 +4701,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4612,0 +4717,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4614,9 +4720,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                short v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short128VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short SUADD_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3605,1 +3617,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3614,1 +3626,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3626,8 +3638,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3636,1 +3641,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3639,1 +3644,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3647,0 +3654,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3648,1 +3673,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3658,1 +3683,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3672,8 +3697,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3682,1 +3700,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3685,1 +3703,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                short v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3694,1 +3714,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3703,1 +3723,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3718,0 +3738,1 @@\n+            ra = OR_IDENTITY;\n@@ -3720,9 +3741,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3736,0 +3751,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3737,1 +3770,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3747,1 +3780,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3764,0 +3797,1 @@\n+            ra = OR_IDENTITY;\n@@ -3766,9 +3800,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                short v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3783,1 +3811,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3792,1 +3820,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3807,0 +3835,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3809,9 +3838,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3825,0 +3848,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3826,1 +3867,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3836,1 +3877,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3853,0 +3894,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3855,9 +3897,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                short v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3872,1 +3908,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3881,1 +3917,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3896,0 +3932,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3898,9 +3935,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3914,0 +3945,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3915,1 +3964,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3925,1 +3974,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3942,0 +3991,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3944,9 +3994,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                short v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3961,1 +4005,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3970,1 +4014,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3982,8 +4026,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3992,1 +4029,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3995,1 +4032,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4003,0 +4042,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4004,1 +4061,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4014,1 +4071,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4028,8 +4085,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4038,1 +4088,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4041,1 +4091,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                short v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4050,1 +4102,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4059,1 +4111,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4071,8 +4123,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4081,1 +4126,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4084,1 +4129,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4092,0 +4139,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4093,1 +4158,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4103,1 +4168,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4117,8 +4182,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4127,1 +4185,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4130,1 +4188,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4139,1 +4199,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4148,1 +4208,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4160,8 +4220,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4170,1 +4223,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4173,1 +4226,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4181,0 +4236,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4182,1 +4255,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4192,1 +4265,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4206,8 +4279,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4216,1 +4282,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4219,1 +4285,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4228,1 +4296,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4237,1 +4305,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4249,8 +4317,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4259,1 +4320,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4262,1 +4323,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4270,0 +4333,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4271,1 +4352,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4281,1 +4362,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4295,8 +4376,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4305,1 +4379,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4308,1 +4382,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4317,1 +4393,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4326,1 +4402,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4338,8 +4414,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4348,1 +4417,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4351,1 +4420,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4359,0 +4430,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4360,1 +4449,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4370,1 +4459,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4384,8 +4473,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4394,1 +4476,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4397,1 +4479,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4406,1 +4490,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4415,1 +4499,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4427,8 +4511,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4437,1 +4514,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4440,1 +4517,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4448,0 +4527,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4449,1 +4546,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4459,1 +4556,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4473,8 +4570,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4483,1 +4573,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4486,1 +4576,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4543,1 +4635,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4552,1 +4644,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4567,0 +4659,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4569,9 +4662,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                short v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4585,0 +4672,18 @@\n+    @Test(dataProvider = \"shortSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4586,1 +4691,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4596,1 +4701,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4612,0 +4717,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4614,9 +4720,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                short v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short256VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short SUADD_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3605,1 +3617,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3614,1 +3626,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3626,8 +3638,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3636,1 +3641,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3639,1 +3644,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3647,0 +3654,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3648,1 +3673,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3658,1 +3683,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3672,8 +3697,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3682,1 +3700,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3685,1 +3703,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                short v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3694,1 +3714,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3703,1 +3723,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3718,0 +3738,1 @@\n+            ra = OR_IDENTITY;\n@@ -3720,9 +3741,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3736,0 +3751,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3737,1 +3770,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3747,1 +3780,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3764,0 +3797,1 @@\n+            ra = OR_IDENTITY;\n@@ -3766,9 +3800,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                short v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3783,1 +3811,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3792,1 +3820,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3807,0 +3835,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3809,9 +3838,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3825,0 +3848,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3826,1 +3867,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3836,1 +3877,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3853,0 +3894,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3855,9 +3897,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                short v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3872,1 +3908,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3881,1 +3917,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3896,0 +3932,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3898,9 +3935,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3914,0 +3945,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3915,1 +3964,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3925,1 +3974,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3942,0 +3991,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3944,9 +3994,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                short v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3961,1 +4005,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3970,1 +4014,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3982,8 +4026,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3992,1 +4029,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3995,1 +4032,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4003,0 +4042,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4004,1 +4061,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4014,1 +4071,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4028,8 +4085,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4038,1 +4088,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4041,1 +4091,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                short v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4050,1 +4102,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4059,1 +4111,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4071,8 +4123,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4081,1 +4126,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4084,1 +4129,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4092,0 +4139,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4093,1 +4158,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4103,1 +4168,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4117,8 +4182,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4127,1 +4185,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4130,1 +4188,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4139,1 +4199,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4148,1 +4208,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4160,8 +4220,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4170,1 +4223,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4173,1 +4226,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4181,0 +4236,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4182,1 +4255,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4192,1 +4265,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4206,8 +4279,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4216,1 +4282,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4219,1 +4285,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4228,1 +4296,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4237,1 +4305,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4249,8 +4317,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4259,1 +4320,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4262,1 +4323,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4270,0 +4333,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4271,1 +4352,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4281,1 +4362,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4295,8 +4376,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4305,1 +4379,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4308,1 +4382,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4317,1 +4393,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4326,1 +4402,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4338,8 +4414,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4348,1 +4417,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4351,1 +4420,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4359,0 +4430,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4360,1 +4449,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4370,1 +4459,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4384,8 +4473,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4394,1 +4476,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4397,1 +4479,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4406,1 +4490,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4415,1 +4499,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4427,8 +4511,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4437,1 +4514,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4440,1 +4517,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4448,0 +4527,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4449,1 +4546,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4459,1 +4556,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4473,8 +4570,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4483,1 +4573,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4486,1 +4576,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4543,1 +4635,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4552,1 +4644,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4567,0 +4659,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4569,9 +4662,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                short v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4585,0 +4672,18 @@\n+    @Test(dataProvider = \"shortSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4586,1 +4691,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4596,1 +4701,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4612,0 +4717,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4614,9 +4720,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                short v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short512VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,0 @@\n-\n@@ -69,0 +68,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short SUADD_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3605,1 +3617,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3614,1 +3626,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3626,8 +3638,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3636,1 +3641,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3639,1 +3644,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3647,0 +3654,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3648,1 +3673,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3658,1 +3683,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3672,8 +3697,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3682,1 +3700,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3685,1 +3703,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                short v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3694,1 +3714,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3703,1 +3723,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3718,0 +3738,1 @@\n+            ra = OR_IDENTITY;\n@@ -3720,9 +3741,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3736,0 +3751,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3737,1 +3770,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3747,1 +3780,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3764,0 +3797,1 @@\n+            ra = OR_IDENTITY;\n@@ -3766,9 +3800,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                short v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3783,1 +3811,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3792,1 +3820,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3807,0 +3835,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3809,9 +3838,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3825,0 +3848,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3826,1 +3867,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3836,1 +3877,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3853,0 +3894,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3855,9 +3897,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                short v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3872,1 +3908,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3881,1 +3917,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3896,0 +3932,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3898,9 +3935,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3914,0 +3945,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3915,1 +3964,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3925,1 +3974,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3942,0 +3991,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3944,9 +3994,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                short v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3961,1 +4005,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3970,1 +4014,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3982,8 +4026,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3992,1 +4029,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -3995,1 +4032,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4003,0 +4042,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4004,1 +4061,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4014,1 +4071,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4028,8 +4085,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4038,1 +4088,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4041,1 +4091,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                short v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4050,1 +4102,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4059,1 +4111,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4071,8 +4123,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4081,1 +4126,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4084,1 +4129,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4092,0 +4139,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4093,1 +4158,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4103,1 +4168,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4117,8 +4182,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4127,1 +4185,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4130,1 +4188,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4139,1 +4199,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4148,1 +4208,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4160,8 +4220,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4170,1 +4223,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4173,1 +4226,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4181,0 +4236,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4182,1 +4255,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4192,1 +4265,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4206,8 +4279,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4216,1 +4282,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4219,1 +4285,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4228,1 +4296,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4237,1 +4305,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4249,8 +4317,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4259,1 +4320,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4262,1 +4323,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4270,0 +4333,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4271,1 +4352,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4281,1 +4362,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4295,8 +4376,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4305,1 +4379,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4308,1 +4382,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4317,1 +4393,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4326,1 +4402,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4338,8 +4414,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4348,1 +4417,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4351,1 +4420,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4359,0 +4430,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4360,1 +4449,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4370,1 +4459,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4384,8 +4473,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4394,1 +4476,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4397,1 +4479,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4406,1 +4490,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4415,1 +4499,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4427,8 +4511,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4437,1 +4514,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4440,1 +4517,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4448,0 +4527,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4449,1 +4546,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4459,1 +4556,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4473,8 +4570,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4483,1 +4573,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4486,1 +4576,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4543,1 +4635,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4552,1 +4644,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4567,0 +4659,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4569,9 +4662,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                short v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4585,0 +4672,18 @@\n+    @Test(dataProvider = \"shortSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4586,1 +4691,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4596,1 +4701,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4612,0 +4717,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4614,9 +4720,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                short v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Short64VectorTests.java","additions":358,"deletions":258,"binary":false,"changes":616,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -74,0 +74,13 @@\n+    \/\/ Identity values for reduction operations\n+    private static final short ADD_IDENTITY = (short)0;\n+    private static final short AND_IDENTITY = (short)-1;\n+    private static final short FIRST_NONZERO_IDENTITY = (short)0;\n+    private static final short MAX_IDENTITY = Short.MIN_VALUE;\n+    private static final short MIN_IDENTITY = Short.MAX_VALUE;\n+    private static final short MUL_IDENTITY = (short)1;\n+    private static final short OR_IDENTITY = (short)0;\n+    private static final short SUADD_IDENTITY = (short)0;\n+    private static final short UMAX_IDENTITY = (short)0;   \/\/ Minimum unsigned value\n+    private static final short UMIN_IDENTITY = (short)-1;  \/\/ Maximum unsigned value\n+    private static final short XOR_IDENTITY = (short)0;\n+\n@@ -3610,1 +3623,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3619,1 +3632,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3631,8 +3644,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND);\n-            }\n-        }\n+        short ra = 0;\n@@ -3641,1 +3647,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3644,1 +3650,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND);\n+                short v = av.reduceLanes(VectorOperators.AND);\n+                r[i] = v;\n+                ra &= v;\n@@ -3652,0 +3660,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ANDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = AND_IDENTITY;\n+\n+        Assert.assertEquals((short) (id & id), id,\n+                            \"AND(AND_IDENTITY, AND_IDENTITY) != AND_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id & x), x,\n+                                \"AND(AND_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x & id), x,\n+                                \"AND(\" + x + \", AND_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3653,1 +3679,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3663,1 +3689,1 @@\n-        short res = -1;\n+        short res = AND_IDENTITY;\n@@ -3677,8 +3703,1 @@\n-        short ra = -1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.AND, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -3687,1 +3706,1 @@\n-            ra = -1;\n+            ra = AND_IDENTITY;\n@@ -3690,1 +3709,3 @@\n-                ra &= av.reduceLanes(VectorOperators.AND, vmask);\n+                short v = av.reduceLanes(VectorOperators.AND, vmask);\n+                r[i] = v;\n+                ra &= v;\n@@ -3699,1 +3720,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3708,1 +3729,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3723,0 +3744,1 @@\n+            ra = OR_IDENTITY;\n@@ -3725,9 +3747,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR);\n+                short v = av.reduceLanes(VectorOperators.OR);\n+                r[i] = v;\n+                ra |= v;\n@@ -3741,0 +3757,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = OR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id | id), id,\n+                            \"OR(OR_IDENTITY, OR_IDENTITY) != OR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id | x), x,\n+                                \"OR(OR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x | id), x,\n+                                \"OR(\" + x + \", OR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3742,1 +3776,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3752,1 +3786,1 @@\n-        short res = 0;\n+        short res = OR_IDENTITY;\n@@ -3769,0 +3803,1 @@\n+            ra = OR_IDENTITY;\n@@ -3771,9 +3806,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.OR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra |= av.reduceLanes(VectorOperators.OR, vmask);\n+                short v = av.reduceLanes(VectorOperators.OR, vmask);\n+                r[i] = v;\n+                ra |= v;\n@@ -3788,1 +3817,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3797,1 +3826,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3812,0 +3841,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3814,9 +3844,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR);\n+                short v = av.reduceLanes(VectorOperators.XOR);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3830,0 +3854,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void XORReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = XOR_IDENTITY;\n+\n+        Assert.assertEquals((short) (id ^ id), id,\n+                            \"XOR(XOR_IDENTITY, XOR_IDENTITY) != XOR_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id ^ x), x,\n+                                \"XOR(XOR_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x ^ id), x,\n+                                \"XOR(\" + x + \", XOR_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3831,1 +3873,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3841,1 +3883,1 @@\n-        short res = 0;\n+        short res = XOR_IDENTITY;\n@@ -3858,0 +3900,1 @@\n+            ra = XOR_IDENTITY;\n@@ -3860,9 +3903,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.XOR, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra ^= av.reduceLanes(VectorOperators.XOR, vmask);\n+                short v = av.reduceLanes(VectorOperators.XOR, vmask);\n+                r[i] = v;\n+                ra ^= v;\n@@ -3877,1 +3914,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3886,1 +3923,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3901,0 +3938,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3903,9 +3941,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD);\n+                short v = av.reduceLanes(VectorOperators.ADD);\n+                r[i] = v;\n+                ra += v;\n@@ -3919,0 +3951,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void ADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = ADD_IDENTITY;\n+\n+        Assert.assertEquals((short) (id + id), id,\n+                            \"ADD(ADD_IDENTITY, ADD_IDENTITY) != ADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id + x), x,\n+                                \"ADD(ADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x + id), x,\n+                                \"ADD(\" + x + \", ADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -3920,1 +3970,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3930,1 +3980,1 @@\n-        short res = 0;\n+        short res = ADD_IDENTITY;\n@@ -3947,0 +3997,1 @@\n+            ra = ADD_IDENTITY;\n@@ -3949,9 +4000,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.ADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra += av.reduceLanes(VectorOperators.ADD, vmask);\n+                short v = av.reduceLanes(VectorOperators.ADD, vmask);\n+                r[i] = v;\n+                ra += v;\n@@ -3966,1 +4011,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3975,1 +4020,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -3987,8 +4032,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL);\n-            }\n-        }\n+        short ra = 0;\n@@ -3997,1 +4035,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4000,1 +4038,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL);\n+                short v = av.reduceLanes(VectorOperators.MUL);\n+                r[i] = v;\n+                ra *= v;\n@@ -4008,0 +4048,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MULReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MUL_IDENTITY;\n+\n+        Assert.assertEquals((short) (id * id), id,\n+                            \"MUL(MUL_IDENTITY, MUL_IDENTITY) != MUL_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) (id * x), x,\n+                                \"MUL(MUL_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) (x * id), x,\n+                                \"MUL(\" + x + \", MUL_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4009,1 +4067,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4019,1 +4077,1 @@\n-        short res = 1;\n+        short res = MUL_IDENTITY;\n@@ -4033,8 +4091,1 @@\n-        short ra = 1;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MUL, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4043,1 +4094,1 @@\n-            ra = 1;\n+            ra = MUL_IDENTITY;\n@@ -4046,1 +4097,3 @@\n-                ra *= av.reduceLanes(VectorOperators.MUL, vmask);\n+                short v = av.reduceLanes(VectorOperators.MUL, vmask);\n+                r[i] = v;\n+                ra *= v;\n@@ -4055,1 +4108,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4064,1 +4117,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4076,8 +4129,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4086,1 +4132,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4089,1 +4135,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN));\n+                short v = av.reduceLanes(VectorOperators.MIN);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4097,0 +4145,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MIN_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.min(id, id), id,\n+                            \"MIN(MIN_IDENTITY, MIN_IDENTITY) != MIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.min(id, x), x,\n+                                \"MIN(MIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.min(x, id), x,\n+                                \"MIN(\" + x + \", MIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4098,1 +4164,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4108,1 +4174,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = MIN_IDENTITY;\n@@ -4122,8 +4188,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4132,1 +4191,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = MIN_IDENTITY;\n@@ -4135,1 +4194,3 @@\n-                ra = (short) Math.min(ra, av.reduceLanes(VectorOperators.MIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.MIN, vmask);\n+                r[i] = v;\n+                ra = (short) Math.min(ra, v);\n@@ -4144,1 +4205,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4153,1 +4214,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4165,8 +4226,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4175,1 +4229,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4178,1 +4232,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX));\n+                short v = av.reduceLanes(VectorOperators.MAX);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4186,0 +4242,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void MAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = MAX_IDENTITY;\n+\n+        Assert.assertEquals((short) Math.max(id, id), id,\n+                            \"MAX(MAX_IDENTITY, MAX_IDENTITY) != MAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) Math.max(id, x), x,\n+                                \"MAX(MAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) Math.max(x, id), x,\n+                                \"MAX(\" + x + \", MAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4187,1 +4261,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4197,1 +4271,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = MAX_IDENTITY;\n@@ -4211,8 +4285,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.MAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4221,1 +4288,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = MAX_IDENTITY;\n@@ -4224,1 +4291,3 @@\n-                ra = (short) Math.max(ra, av.reduceLanes(VectorOperators.MAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.MAX, vmask);\n+                r[i] = v;\n+                ra = (short) Math.max(ra, v);\n@@ -4233,1 +4302,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4242,1 +4311,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4254,8 +4323,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN);\n-            }\n-        }\n+        short ra = 0;\n@@ -4264,1 +4326,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4267,1 +4329,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN));\n+                short v = av.reduceLanes(VectorOperators.UMIN);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4275,0 +4339,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMINReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMIN_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.minUnsigned(id, id), id,\n+                            \"UMIN(UMIN_IDENTITY, UMIN_IDENTITY) != UMIN_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.minUnsigned(id, x), x,\n+                                \"UMIN(UMIN_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.minUnsigned(x, id), x,\n+                                \"UMIN(\" + x + \", UMIN_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4276,1 +4358,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4286,1 +4368,1 @@\n-        short res = Short.MAX_VALUE;\n+        short res = UMIN_IDENTITY;\n@@ -4300,8 +4382,1 @@\n-        short ra = Short.MAX_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMIN, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4310,1 +4385,1 @@\n-            ra = Short.MAX_VALUE;\n+            ra = UMIN_IDENTITY;\n@@ -4313,1 +4388,3 @@\n-                ra = (short) VectorMath.minUnsigned(ra, av.reduceLanes(VectorOperators.UMIN, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMIN, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.minUnsigned(ra, v);\n@@ -4322,1 +4399,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4331,1 +4408,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4343,8 +4420,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX);\n-            }\n-        }\n+        short ra = 0;\n@@ -4353,1 +4423,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4356,1 +4426,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX));\n+                short v = av.reduceLanes(VectorOperators.UMAX);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4364,0 +4436,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void UMAXReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = UMAX_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.maxUnsigned(id, id), id,\n+                            \"UMAX(UMAX_IDENTITY, UMAX_IDENTITY) != UMAX_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(id, x), x,\n+                                \"UMAX(UMAX_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.maxUnsigned(x, id), x,\n+                                \"UMAX(\" + x + \", UMAX_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4365,1 +4455,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4375,1 +4465,1 @@\n-        short res = Short.MIN_VALUE;\n+        short res = UMAX_IDENTITY;\n@@ -4389,8 +4479,1 @@\n-        short ra = Short.MIN_VALUE;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.UMAX, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4399,1 +4482,1 @@\n-            ra = Short.MIN_VALUE;\n+            ra = UMAX_IDENTITY;\n@@ -4402,1 +4485,3 @@\n-                ra = (short) VectorMath.maxUnsigned(ra, av.reduceLanes(VectorOperators.UMAX, vmask));\n+                short v = av.reduceLanes(VectorOperators.UMAX, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.maxUnsigned(ra, v);\n@@ -4411,1 +4496,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4420,1 +4505,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4432,8 +4517,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n-            }\n-        }\n+        short ra = 0;\n@@ -4442,1 +4520,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4445,1 +4523,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4453,0 +4533,18 @@\n+    @Test(dataProvider = \"shortUnaryOpProvider\")\n+    static void FIRST_NONZEROReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = FIRST_NONZERO_IDENTITY;\n+\n+        Assert.assertEquals(firstNonZero(id, id), id,\n+                            \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, FIRST_NONZERO_IDENTITY) != FIRST_NONZERO_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals(firstNonZero(id, x), x,\n+                                \"FIRST_NONZERO(FIRST_NONZERO_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(firstNonZero(x, id), x,\n+                                \"FIRST_NONZERO(\" + x + \", FIRST_NONZERO_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4454,1 +4552,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4464,1 +4562,1 @@\n-        short res = (short) 0;\n+        short res = FIRST_NONZERO_IDENTITY;\n@@ -4478,8 +4576,1 @@\n-        short ra = (short) 0;\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n-            }\n-        }\n+        short ra = 0;\n@@ -4488,1 +4579,1 @@\n-            ra = (short) 0;\n+            ra = FIRST_NONZERO_IDENTITY;\n@@ -4491,1 +4582,3 @@\n-                ra = firstNonZero(ra, av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask));\n+                short v = av.reduceLanes(VectorOperators.FIRST_NONZERO, vmask);\n+                r[i] = v;\n+                ra = firstNonZero(ra, v);\n@@ -4548,1 +4641,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4557,1 +4650,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4572,0 +4665,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4574,9 +4668,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD));\n+                short v = av.reduceLanes(VectorOperators.SUADD);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n@@ -4590,0 +4678,18 @@\n+    @Test(dataProvider = \"shortSaturatingUnaryOpProvider\")\n+    static void SUADDReduceIdentityValueTests(IntFunction<short[]> fa) {\n+        short[] a = fa.apply(SPECIES.length());\n+        short id = SUADD_IDENTITY;\n+\n+        Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, id), id,\n+                            \"SUADD(SUADD_IDENTITY, SUADD_IDENTITY) != SUADD_IDENTITY\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            short x = a[i];\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(id, x), x,\n+                                \"SUADD(SUADD_IDENTITY, \" + x + \") != \" + x);\n+\n+            Assert.assertEquals((short) VectorMath.addSaturatingUnsigned(x, id), x,\n+                                \"SUADD(\" + x + \", SUADD_IDENTITY) != \" + x);\n+        }\n+    }\n+\n@@ -4591,1 +4697,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4601,1 +4707,1 @@\n-        short res = 0;\n+        short res = SUADD_IDENTITY;\n@@ -4617,0 +4723,1 @@\n+            ra = SUADD_IDENTITY;\n@@ -4619,9 +4726,3 @@\n-                r[i] = av.reduceLanes(VectorOperators.SUADD, vmask);\n-            }\n-        }\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            ra = 0;\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                ShortVector av = ShortVector.fromArray(SPECIES, a, i);\n-                ra = (short) VectorMath.addSaturatingUnsigned(ra, av.reduceLanes(VectorOperators.SUADD, vmask));\n+                short v = av.reduceLanes(VectorOperators.SUADD, vmask);\n+                r[i] = v;\n+                ra = (short) VectorMath.addSaturatingUnsigned(ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/ShortMaxVectorTests.java","additions":358,"deletions":257,"binary":false,"changes":615,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n-# Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -514,10 +514,10 @@\n-gen_reduction_op \"AND\" \"\\&\" \"BITWISE\" \"-1\"\n-gen_reduction_op \"OR\" \"|\" \"BITWISE\" \"0\"\n-gen_reduction_op \"XOR\" \"^\" \"BITWISE\" \"0\"\n-gen_reduction_op \"ADD\" \"+\" \"\" \"0\"\n-gen_reduction_op \"MUL\" \"*\" \"\" \"1\"\n-gen_reduction_op_func \"MIN\" \"(\\$type\\$) Math.min\" \"\" \"\\$Wideboxtype\\$.\\$MaxValue\\$\"\n-gen_reduction_op_func \"MAX\" \"(\\$type\\$) Math.max\" \"\" \"\\$Wideboxtype\\$.\\$MinValue\\$\"\n-gen_reduction_op_func \"UMIN\" \"(\\$type\\$) VectorMath.minUnsigned\" \"BITWISE\" \"\\$Wideboxtype\\$.\\$MaxValue\\$\"\n-gen_reduction_op_func \"UMAX\" \"(\\$type\\$) VectorMath.maxUnsigned\" \"BITWISE\" \"\\$Wideboxtype\\$.\\$MinValue\\$\"\n-gen_reduction_op_func \"FIRST_NONZERO\" \"firstNonZero\" \"\" \"(\\$type\\$) 0\"\n+gen_reduction_op \"AND\" \"\\&\" \"BITWISE\" \"AND_IDENTITY\"\n+gen_reduction_op \"OR\" \"|\" \"BITWISE\" \"OR_IDENTITY\"\n+gen_reduction_op \"XOR\" \"^\" \"BITWISE\" \"XOR_IDENTITY\"\n+gen_reduction_op \"ADD\" \"+\" \"\" \"ADD_IDENTITY\"\n+gen_reduction_op \"MUL\" \"*\" \"\" \"MUL_IDENTITY\"\n+gen_reduction_op_func \"MIN\" \"(\\$type\\$) Math.min\" \"\" \"MIN_IDENTITY\"\n+gen_reduction_op_func \"MAX\" \"(\\$type\\$) Math.max\" \"\" \"MAX_IDENTITY\"\n+gen_reduction_op_func \"UMIN\" \"(\\$type\\$) VectorMath.minUnsigned\" \"BITWISE\" \"UMIN_IDENTITY\"\n+gen_reduction_op_func \"UMAX\" \"(\\$type\\$) VectorMath.maxUnsigned\" \"BITWISE\" \"UMAX_IDENTITY\"\n+gen_reduction_op_func \"FIRST_NONZERO\" \"firstNonZero\" \"\" \"FIRST_NONZERO_IDENTITY\"\n@@ -530,1 +530,1 @@\n-gen_saturating_reduction_op \"SUADD\" \"(\\$type\\$) VectorMath.addSaturatingUnsigned\" \"BITWISE\" \"0\"\n+gen_saturating_reduction_op \"SUADD\" \"(\\$type\\$) VectorMath.addSaturatingUnsigned\" \"BITWISE\" \"SUADD_IDENTITY\"\n","filename":"test\/jdk\/jdk\/incubator\/vector\/gen-template.sh","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -5,8 +5,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -18,1 +11,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]], vmask));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-Masked-op-func.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -5,8 +5,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -18,1 +11,3 @@\n-                ra [[TEST_OP]]= av.reduceLanes(VectorOperators.[[TEST]], vmask);\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n+                r[i] = v;\n+                ra [[TEST_OP]]= v;\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-Masked-op.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3,8 +3,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]]);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -16,1 +9,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]]));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]]);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-op-func.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3,8 +3,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]]);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -16,1 +9,3 @@\n-                ra [[TEST_OP]]= av.reduceLanes(VectorOperators.[[TEST]]);\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]]);\n+                r[i] = v;\n+                ra [[TEST_OP]]= v;\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-Reduction-op.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -5,8 +5,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -18,1 +11,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]], vmask));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]], vmask);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-SaturatingReduction-Masked-op.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3,8 +3,1 @@\n-        $type$ ra = [[TEST_INIT]];\n-\n-        for (int ic = 0; ic < INVOC_COUNT; ic++) {\n-            for (int i = 0; i < a.length; i += SPECIES.length()) {\n-                $abstractvectortype$ av = $abstractvectortype$.fromArray(SPECIES, a, i);\n-                r[i] = av.reduceLanes(VectorOperators.[[TEST]]);\n-            }\n-        }\n+        $type$ ra = 0;\n@@ -16,1 +9,3 @@\n-                ra = [[TEST_OP]](ra, av.reduceLanes(VectorOperators.[[TEST]]));\n+                $type$ v = av.reduceLanes(VectorOperators.[[TEST]]);\n+                r[i] = v;\n+                ra = [[TEST_OP]](ra, v);\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Kernel-SaturatingReduction-op.template","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -8,0 +8,18 @@\n+\n+    @Test(dataProvider = \"$type$UnaryOpProvider\")\n+    static void [[TEST]]ReduceIdentityValueTests(IntFunction<$type$[]> fa) {\n+        $type$[] a = fa.apply(SPECIES.length());\n+        $type$ id = [[TEST_INIT]];\n+\n+        Assert.assertEquals([[TEST_OP]](id, id), id,\n+                            \"[[TEST]]([[TEST_INIT]], [[TEST_INIT]]) != [[TEST_INIT]]\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            $type$ x = a[i];\n+            Assert.assertEquals([[TEST_OP]](id, x), x,\n+                                \"[[TEST]]([[TEST_INIT]], \" + x + \") != \" + x);\n+\n+            Assert.assertEquals([[TEST_OP]](x, id), x,\n+                                \"[[TEST]](\" + x + \", [[TEST_INIT]]) != \" + x);\n+        }\n+    }\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-Reduction-op-func.template","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -12,0 +12,18 @@\n+\n+    @Test(dataProvider = \"$type$UnaryOpProvider\")\n+    static void [[TEST]]ReduceIdentityValueTests(IntFunction<$type$[]> fa) {\n+        $type$[] a = fa.apply(SPECIES.length());\n+        $type$ id = [[TEST_INIT]];\n+\n+        Assert.assertEquals(($type$) (id [[TEST_OP]] id), id,\n+                            \"[[TEST]]([[TEST_INIT]], [[TEST_INIT]]) != [[TEST_INIT]]\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            $type$ x = a[i];\n+            Assert.assertEquals(($type$) (id [[TEST_OP]] x), x,\n+                                \"[[TEST]]([[TEST_INIT]], \" + x + \") != \" + x);\n+\n+            Assert.assertEquals(($type$) (x [[TEST_OP]] id), x,\n+                                \"[[TEST]](\" + x + \", [[TEST_INIT]]) != \" + x);\n+        }\n+    }\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-Reduction-op.template","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -8,0 +8,18 @@\n+\n+    @Test(dataProvider = \"$type$SaturatingUnaryOpProvider\")\n+    static void [[TEST]]ReduceIdentityValueTests(IntFunction<$type$[]> fa) {\n+        $type$[] a = fa.apply(SPECIES.length());\n+        $type$ id = [[TEST_INIT]];\n+\n+        Assert.assertEquals([[TEST_OP]](id, id), id,\n+                            \"[[TEST]]([[TEST_INIT]], [[TEST_INIT]]) != [[TEST_INIT]]\");\n+\n+        for (int i = 0; i < a.length; i++) {\n+            $type$ x = a[i];\n+            Assert.assertEquals([[TEST_OP]](id, x), x,\n+                                \"[[TEST]]([[TEST_INIT]], \" + x + \") != \" + x);\n+\n+            Assert.assertEquals([[TEST_OP]](x, id), x,\n+                                \"[[TEST]](\" + x + \", [[TEST_INIT]]) != \" + x);\n+        }\n+    }\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-SaturatingReduction-op.template","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -89,1 +89,0 @@\n-\n@@ -91,0 +90,1 @@\n+\n@@ -97,1 +97,0 @@\n-\n@@ -99,0 +98,1 @@\n+\n@@ -101,0 +101,17 @@\n+\n+    \/\/ Identity values for reduction operations\n+    private static final $type$ ADD_IDENTITY = ($type$)0;\n+#if[BITWISE]\n+    private static final $type$ AND_IDENTITY = ($type$)-1;\n+#end[BITWISE]\n+    private static final $type$ FIRST_NONZERO_IDENTITY = ($type$)0;\n+    private static final $type$ MAX_IDENTITY = $Wideboxtype$.$MinValue$;\n+    private static final $type$ MIN_IDENTITY = $Wideboxtype$.$MaxValue$;\n+    private static final $type$ MUL_IDENTITY = ($type$)1;\n+#if[BITWISE]\n+    private static final $type$ OR_IDENTITY = ($type$)0;\n+    private static final $type$ SUADD_IDENTITY = ($type$)0;\n+    private static final $type$ UMAX_IDENTITY = ($type$)0;   \/\/ Minimum unsigned value\n+    private static final $type$ UMIN_IDENTITY = ($type$)-1;  \/\/ Maximum unsigned value\n+    private static final $type$ XOR_IDENTITY = ($type$)0;\n+#end[BITWISE]\n@@ -102,0 +119,1 @@\n+\n","filename":"test\/jdk\/jdk\/incubator\/vector\/templates\/Unit-header.template","additions":21,"deletions":3,"binary":false,"changes":24,"status":"modified"}]}