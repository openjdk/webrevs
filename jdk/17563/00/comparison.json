{"files":[{"patch":"@@ -24,2 +24,0 @@\n-\n-\n@@ -47,1 +45,1 @@\n- * @run main ShapeNotSetSometimes\n+ * @run main\/othervm -Dsun.java2d.uiScale=1 ShapeNotSetSometimes\n@@ -58,1 +56,0 @@\n-    private final Rectangle bounds = new Rectangle(220, 400, 300, 300);\n@@ -63,0 +60,2 @@\n+    private static final int DIM = 300;\n+    private static final int DELTA = 2;\n@@ -73,1 +72,2 @@\n-        backgroundFrame.setBounds(bounds);\n+        backgroundFrame.setSize(DIM, DIM);\n+        backgroundFrame.setLocationRelativeTo(null);\n@@ -84,1 +84,1 @@\n-\n+        \/\/ point at the center of white ellipse\n@@ -86,0 +86,2 @@\n+\n+        \/\/ mid points on the 4 sides - on the green background frame\n@@ -93,0 +95,1 @@\n+        \/\/ points just outside the ellipse (opposite side of diagonal)\n@@ -100,1 +103,2 @@\n-        window.setBounds(bounds);\n+        window.setSize(DIM, DIM);\n+        window.setLocationRelativeTo(null);\n@@ -111,1 +115,1 @@\n-            g.fillRect(0, 0, 300, 300);\n+            g.fillRect(0, 0, DIM, DIM);\n@@ -123,1 +127,1 @@\n-            g.fillRect(0, 0, bounds.width, bounds.height);\n+            g.fillRect(0, 0, DIM, DIM);\n@@ -158,2 +162,6 @@\n-                backgroundFrame.dispose();\n-                window.dispose();\n+                if (backgroundFrame != null) {\n+                    backgroundFrame.dispose();\n+                }\n+                if (window != null) {\n+                    window.dispose();\n+                }\n@@ -165,1 +173,0 @@\n-\n@@ -179,1 +186,1 @@\n-        if (mustBeExpectedColor != expectedColor.equals(actualColor)) {\n+        if (mustBeExpectedColor != colorCompare(expectedColor, actualColor)) {\n@@ -193,0 +200,9 @@\n+    private static boolean colorCompare(Color expected, Color actual) {\n+        if (Math.abs(expected.getRed() - actual.getRed()) <= DELTA\n+                && Math.abs(expected.getGreen() - actual.getGreen()) <= DELTA\n+                && Math.abs(expected.getBlue() - actual.getBlue()) <= DELTA) {\n+            return true;\n+        }\n+        return false;\n+    }\n+\n","filename":"test\/jdk\/java\/awt\/Frame\/ShapeNotSetSometimes\/ShapeNotSetSometimes.java","additions":29,"deletions":13,"binary":false,"changes":42,"status":"modified"}]}