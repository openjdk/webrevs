{"files":[{"patch":"@@ -129,1 +129,14 @@\n-    transient private PropertyChangeListener propListener;\n+    transient private PropertyChangeListener propListener =\n+        new PropertyChangeListener() {\n+            public void propertyChange(PropertyChangeEvent e) {\n+                String propertyName = e.getPropertyName();\n+                if (propertyName == \"ancestor\") {\n+                    if (e.getOldValue() != null &&\n+                            e.getNewValue() == null) {\n+                        if (isVisible()) {\n+                            setVisible(false);\n+                        }\n+                    }\n+                }\n+            }\n+        };\n@@ -952,15 +965,0 @@\n-            propListener = new PropertyChangeListener() {\n-                public void propertyChange(PropertyChangeEvent e) {\n-                    String propertyName = e.getPropertyName();\n-                    if (propertyName == \"ancestor\") {\n-                        if (e.getOldValue() != null &&\n-                                e.getNewValue() == null) {\n-                            if (popup != null) {\n-                                popup.dispose();\n-                                popup = null;\n-                            }\n-\n-                        }\n-                    }\n-                }\n-            };\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/JPopupMenu.java","additions":14,"deletions":16,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -48,2 +48,0 @@\n-    static volatile Point pt;\n-    static volatile Rectangle size;\n@@ -63,1 +61,1 @@\n-    public static void main(String args[]) throws Exception {\n+    public static void main(String[] args) throws Exception {\n@@ -66,1 +64,1 @@\n-            SwingUtilities.invokeAndWait(() -> createUI());\n+            SwingUtilities.invokeAndWait(TestPopupInvoker::createUI);\n@@ -69,0 +67,1 @@\n+\n@@ -75,2 +74,0 @@\n-                pt = label.getLocationOnScreen();\n-                size = label.getBounds();\n@@ -79,1 +76,2 @@\n-            robot.delay(2000);\n+            robot.delay(1000);\n+\n","filename":"test\/jdk\/javax\/swing\/JPopupMenu\/TestPopupInvoker.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"}]}