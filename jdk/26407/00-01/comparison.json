{"files":[{"patch":"@@ -129,0 +129,1 @@\n+    transient private PropertyChangeListener propListener;\n@@ -944,10 +945,1 @@\n-        PropertyChangeListener propListener = new PropertyChangeListener() {\n-            public void propertyChange(PropertyChangeEvent e) {\n-                String propertyName = e.getPropertyName();\n-                if (propertyName == \"ancestor\") {\n-                    if (e.getOldValue() != null &&\n-                            e.getNewValue() == null) {\n-                        if (popup != null) {\n-                            popup.dispose();\n-                            popup = null;\n-                        }\n+        PropertyChangeListener oldPropListener = propListener;\n@@ -955,4 +947,0 @@\n-                    }\n-                }\n-            }\n-        };\n@@ -962,1 +950,1 @@\n-                oldInvoker.removePropertyChangeListener(propListener);\n+                oldInvoker.removePropertyChangeListener(oldPropListener);\n@@ -964,0 +952,16 @@\n+            propListener = new PropertyChangeListener() {\n+                public void propertyChange(PropertyChangeEvent e) {\n+                    String propertyName = e.getPropertyName();\n+                    if (propertyName == \"ancestor\") {\n+                        if (e.getOldValue() != null &&\n+                                e.getNewValue() == null) {\n+                            if (popup != null) {\n+                                popup.dispose();\n+                                popup = null;\n+                            }\n+\n+                        }\n+                    }\n+                }\n+            };\n+            invoker.addPropertyChangeListener(propListener);\n@@ -966,1 +970,0 @@\n-        invoker.addPropertyChangeListener(propListener);\n@@ -1379,0 +1382,4 @@\n+        if (propListener instanceof Serializable) {\n+            values.addElement(\"propListener\");\n+            values.addElement(propListener);\n+        }\n@@ -1423,0 +1430,5 @@\n+        if(indexCounter < maxCounter && values.elementAt(indexCounter).\n+                equals(\"propListener\")) {\n+            propListener = (PropertyChangeListener) values.elementAt(++indexCounter);\n+            indexCounter++;\n+        }\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/JPopupMenu.java","additions":28,"deletions":16,"binary":false,"changes":44,"status":"modified"}]}