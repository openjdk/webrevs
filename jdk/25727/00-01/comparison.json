{"files":[{"patch":"@@ -353,2 +353,2 @@\n-                final ClassLoader cl = ClassLoader.getSystemClassLoader();\n-                final ServiceLoader<CharsetProvider> sl =\n+                ClassLoader cl = ClassLoader.getSystemClassLoader();\n+                ServiceLoader<CharsetProvider> sl =\n@@ -356,1 +356,1 @@\n-                final Iterator<CharsetProvider> i = sl.iterator();\n+                Iterator<CharsetProvider> i = sl.iterator();\n@@ -380,0 +380,4 @@\n+                public void remove() {\n+                    throw new UnsupportedOperationException();\n+                }\n+\n@@ -654,1 +658,4 @@\n-    private final Set<String> aliasSet;\n+    private final String[] aliases;     \/\/ tickles a bug in oldjavac\n+    @Stable\n+    private final Supplier<Set<String>> aliasSet = StableValue.supplier(\n+            new Supplier<>() { public Set<String> get() { return Set.of(aliases); }});\n@@ -670,1 +677,6 @@\n-        final String[] as = Objects.requireNonNullElse(aliases, zeroAliases);\n+        String[] as =\n+            aliases == null ?\n+                zeroAliases :\n+                VM.isSystemDomainLoader(getClass().getClassLoader()) ?\n+                    aliases :\n+                    Arrays.copyOf(aliases, aliases.length);\n@@ -678,2 +690,2 @@\n-            for (String a : as) {\n-                checkName(a);\n+            for (int i = 0; i < as.length; i++) {\n+                checkName(as[i]);\n@@ -683,1 +695,1 @@\n-        this.aliasSet = Set.of(as);\n+        this.aliases = as;\n@@ -701,1 +713,1 @@\n-        return aliasSet;\n+        return aliasSet.get();\n","filename":"src\/java.base\/share\/classes\/java\/nio\/charset\/Charset.java","additions":21,"deletions":9,"binary":false,"changes":30,"status":"modified"}]}