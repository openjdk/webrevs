{"files":[{"patch":"@@ -359,1 +359,1 @@\n-    st->print_cr(\"f%d=\" INTPTR_FORMAT \" | %g\", r, (intptr_t)f_ext_state->__f[r], (double)f_ext_state->__f[r]);\n+    st->print_cr(\"f%d=\" INTPTR_FORMAT, r, (intptr_t)f_ext_state->__f[r]);\n@@ -367,1 +367,1 @@\n-\/\/ No other choice but to define it.\n+\/\/ No other choice but to define it (arch\/riscv\/include\/uapi\/asm\/sigcontext.h).\n@@ -372,4 +372,0 @@\n-  \/\/ vector state\n-  struct __riscv_extra_ext_header *ext;\n-  struct __riscv_v_ext_state *v_ext_state;\n-\n@@ -377,1 +373,1 @@\n-  ext = (struct __riscv_extra_ext_header *)(&uc->uc_mcontext.__fpregs);\n+  struct __riscv_extra_ext_header *ext = (struct __riscv_extra_ext_header *)(&uc->uc_mcontext.__fpregs);\n@@ -384,1 +380,1 @@\n-  \/\/ size = sizeof(struct __riscv_ctx_hdr) + sizeof(struct __sc_riscv_v_state) + riscv_v_vsize;\n+  \/\/ size = sizeof(struct __riscv_ctx_hdr) + sizeof(struct __riscv_v_ext_state) + riscv_v_vsize;\n@@ -387,1 +383,1 @@\n-  if (ext_size < (sizeof(struct __riscv_ctx_hdr) + sizeof(*v_ext_state))) {\n+  if (ext_size < (sizeof(struct __riscv_ctx_hdr) + sizeof(struct __riscv_v_ext_state))) {\n@@ -392,3 +388,1 @@\n-  ext_size -= (sizeof(struct __riscv_ctx_hdr) + sizeof(*v_ext_state));\n-\n-  v_ext_state = (struct __riscv_v_ext_state *)((char *)(ext) + sizeof(*ext));\n+  struct __riscv_v_ext_state *v_ext_state = (struct __riscv_v_ext_state *)((char *)(ext) + sizeof(struct __riscv_extra_ext_header));\n@@ -398,4 +392,4 @@\n-  st->print_cr(\"vl=\" INTPTR_FORMAT, v_ext_state->vl);\n-  st->print_cr(\"vtype=\" INTPTR_FORMAT, v_ext_state->vtype);\n-  st->print_cr(\"vcsr=\" INTPTR_FORMAT, v_ext_state->vcsr);\n-  st->print_cr(\"vlenb=\" INTPTR_FORMAT, v_ext_state->vlenb);\n+  st->print_cr(\"vl    =\" INTPTR_FORMAT, v_ext_state->vl);\n+  st->print_cr(\"vtype =\" INTPTR_FORMAT, v_ext_state->vtype);\n+  st->print_cr(\"vcsr  =\" INTPTR_FORMAT, v_ext_state->vcsr);\n+  st->print_cr(\"vlenb =\" INTPTR_FORMAT, v_ext_state->vlenb);\n@@ -406,1 +400,4 @@\n-  if (ext_size < (32 * vr_size)) {\n+  \/\/ Registers are after the v extensions header.\n+  ext_size -= (sizeof(struct __riscv_ctx_hdr) + sizeof(struct __riscv_v_ext_state));\n+\n+  if (ext_size != (32 * vr_size)) {\n@@ -410,0 +407,1 @@\n+\n","filename":"src\/hotspot\/os_cpu\/linux_riscv\/os_linux_riscv.cpp","additions":15,"deletions":17,"binary":false,"changes":32,"status":"modified"}]}