{"files":[{"patch":"@@ -116,2 +116,1 @@\n-        \/\/ count uniques\n-        int cnt = 0;\n+        b.writeU2(infos.length);\n@@ -120,15 +119,2 @@\n-            if (offset > prevOffset) {\n-                cnt ++;\n-                prevOffset = offset;\n-            }\n-        }\n-        \/\/ reset\n-        prevOffset = -1;\n-        b.writeU2(cnt);\n-        for (var fr : infos) {\n-            int offset = dcb.labelToBci(fr.target());\n-            \/\/ skip duplicates\n-            if (offset > prevOffset) {\n-                writeFrame(buf, offset - prevOffset - 1, prevLocals, fr);\n-                prevOffset = offset;\n-                prevLocals = fr.locals();\n+            if (offset == prevOffset) {\n+                throw new IllegalArgumentException(\"Duplicated stack frame bytecode index: \" + offset);\n@@ -136,0 +122,3 @@\n+            writeFrame(buf, offset - prevOffset - 1, prevLocals, fr);\n+            prevOffset = offset;\n+            prevLocals = fr.locals();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/classfile\/impl\/StackMapDecoder.java","additions":6,"deletions":17,"binary":false,"changes":23,"status":"modified"}]}