{"files":[{"patch":"@@ -1360,1 +1360,1 @@\n-  if (state == nullptr) {\n+  if (state == nullptr || !state->is_enabled(JVMTI_EVENT_FRAME_POP)) {\n@@ -1366,2 +1366,2 @@\n-    if (ets->has_frame_pops() && ets->is_enabled(JVMTI_EVENT_FRAME_POP) &&\n-        ets->is_frame_pop(top_frame_num)) {\n+    if (ets->has_frame_pops() && ets->is_frame_pop(top_frame_num)) {\n+      assert(ets->is_enabled(JVMTI_EVENT_FRAME_POP), \"sanity check\");\n@@ -1890,0 +1890,4 @@\n+  JvmtiThreadState* state = thread->jvmti_thread_state();\n+  if (state == nullptr) {\n+    return;\n+  }\n@@ -1908,1 +1912,0 @@\n-  JvmtiThreadState* state; \/\/ should be initialized in vm state only\n@@ -1910,1 +1913,1 @@\n-  bool need_processing;\n+\n@@ -1912,3 +1915,1 @@\n-    state = get_jvmti_thread_state(thread);\n-    need_processing = state != nullptr && current_frame.is_interpreted_frame();\n-    if (need_processing) {\n+    if (state != nullptr) {\n@@ -1916,0 +1917,1 @@\n+        assert(state->is_interp_only_mode(), \"sanity check\");\n@@ -1929,1 +1931,1 @@\n-  if (need_processing) {\n+  if (state != nullptr) {\n","filename":"src\/hotspot\/share\/prims\/jvmtiExport.cpp","additions":11,"deletions":9,"binary":false,"changes":20,"status":"modified"}]}