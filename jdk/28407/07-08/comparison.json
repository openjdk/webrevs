{"files":[{"patch":"@@ -216,0 +216,36 @@\n+void\n+JvmtiThreadState::process_vthread_pending_deopts() {\n+  if (!has_vthread_pending_deopts()) {\n+    return;\n+  }\n+  JavaThread* thread = get_thread();\n+  ResourceMark rm;\n+  GrowableArray<int>* deopts = vthread_pending_deopts();\n+  javaVFrame* jvf = JvmtiEnvBase::get_vthread_jvf(thread->vthread());\n+  int frame_count = (int)JvmtiEnvBase::get_frame_count(jvf);\n+\n+  for (int idx = deopts->length() - 1; idx >= 0; idx--) {\n+    int frame_number = deopts->at(idx);\n+    deopts->remove_at(idx);\n+    int depth = frame_count - frame_number;\n+    jvf = JvmtiEnvBase::jvf_for_thread_and_depth(thread, depth);\n+    frame fr = jvf->fr();\n+    if (fr.is_heap_frame()) {\n+      fr = jvf->stack_chunk()->derelativize(fr);\n+    }\n+    Deoptimization::deoptimize(thread, fr);\n+  }\n+}\n+\n+void\n+JvmtiThreadState::process_pending_interp_only(JavaThread* current) {\n+  JvmtiThreadState* state = current->jvmti_thread_state();\n+\n+  if (state != nullptr && (state->is_pending_interp_only_mode())) {\n+    MutexLocker mu(JvmtiThreadState_lock);\n+    if (state->is_pending_interp_only_mode()) {\n+      JvmtiEventController::enter_interp_only_mode(state);\n+    }\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/prims\/jvmtiThreadState.cpp","additions":36,"deletions":0,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-#include \"prims\/jvmtiEventController.hpp\"\n+#include \"prims\/jvmtiEventController.inline.hpp\"\n","filename":"src\/hotspot\/share\/prims\/jvmtiThreadState.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}