{"files":[{"patch":"@@ -304,1 +304,2 @@\n-     * @throws IllegalArgumentException if the classfile format is unsupported or invalid\n+     * @throws IllegalArgumentException or its subclass if the classfile format is\n+     * not supported or an incompatibility prevents parsing of the classfile\n@@ -313,1 +314,2 @@\n-     * @throws IllegalArgumentException if the classfile format is unsupported or invalid\n+     * @throws IllegalArgumentException or its subclass if the classfile format is\n+     * not supported or an incompatibility prevents parsing of the classfile\n","filename":"src\/java.base\/share\/classes\/java\/lang\/classfile\/ClassFile.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -398,1 +398,2 @@\n- * implemented strictly to throw exceptions if a new and unknown classfile\n+ * implemented strictly to throw exceptions if running on a newer JDK, if the\n+ * transformed class file is a newer version, or if a new and unknown classfile\n@@ -400,2 +401,4 @@\n- * code transformation snippet:\n- * {@snippet lang=\"java\" class=\"PackageSnippets\" region=\"strictTransform\"}\n+ * transformation snippets:\n+ * {@snippet lang=\"java\" class=\"PackageSnippets\" region=\"strictTransform1\"}\n+ * {@snippet lang=\"java\" class=\"PackageSnippets\" region=\"strictTransform2\"}\n+ * {@snippet lang=\"java\" class=\"PackageSnippets\" region=\"strictTransform3\"}\n","filename":"src\/java.base\/share\/classes\/java\/lang\/classfile\/package-info.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import java.lang.classfile.ClassBuilder;\n@@ -46,0 +47,1 @@\n+import java.lang.classfile.ClassFileVersion;\n@@ -220,2 +222,29 @@\n-    void strictTransform() {\n-        \/\/ @start region=\"strictTransform\"\n+    void strictTransform1() {\n+        \/\/ @start region=\"strictTransform1\"\n+        CodeTransform fooToBar = (b, e) -> {\n+            if (ClassFile.latestMajorVersion() > ClassFile.JAVA_22_VERSION) {\n+                throw new IllegalArgumentException(\"Cannot run on JDK > 22\");\n+            }\n+            switch (e) {\n+                case ArrayLoadInstruction i -> doSomething(b, i);\n+                case ArrayStoreInstruction i -> doSomething(b, i);\n+                default ->  b.with(e);\n+            }\n+        };\n+        \/\/ @end\n+    }\n+\n+    void strictTransform2() {\n+        \/\/ @start region=\"strictTransform2\"\n+        ClassTransform fooToBar = (b, e) -> {\n+            switch (e) {\n+                case ClassFileVersion v when v.majorVersion() > ClassFile.JAVA_22_VERSION ->\n+                    throw new IllegalArgumentException(\"Cannot transform class file version \" + v.majorVersion());\n+                default ->  doSomething(b, e);\n+            }\n+        };\n+        \/\/ @end\n+    }\n+\n+    void strictTransform3() {\n+        \/\/ @start region=\"strictTransform3\"\n@@ -271,0 +300,2 @@\n+    void doSomething(ClassBuilder b, ClassElement e) {}\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/classfile\/snippet-files\/PackageSnippets.java","additions":33,"deletions":2,"binary":false,"changes":35,"status":"modified"}]}