{"files":[{"patch":"@@ -31,1 +31,1 @@\n-#include \"oops\/klass.hpp\"\n+#include \"oops\/klass.inline.hpp\"\n@@ -34,1 +34,0 @@\n-#include \"utilities\/ostream.hpp\"\n@@ -36,0 +35,1 @@\n+#include \"utilities\/ostream.hpp\"\n@@ -96,1 +96,4 @@\n-    _klasses.append(InstanceKlass::cast(k));\n+    InstanceKlass* ik = InstanceKlass::cast(k);\n+    if (ik->is_loaded() && ik->name()->is_star_match(_class_name_pattern)) {\n+      _klasses.append(ik);\n+    }\n@@ -100,1 +103,1 @@\n-    _klasses.sort(compare_klasses_alphadetically);\n+    _klasses.sort(compare_klasses_alphabetically);\n@@ -111,2 +114,2 @@\n-  static int compare_klasses_alphadetically(InstanceKlass** a, InstanceKlass** b) {\n-    return compare_symbols_alphadetically((*a)->name(), (*b)->name());\n+  static int compare_klasses_alphabetically(InstanceKlass** a, InstanceKlass** b) {\n+    return compare_symbols_alphabetically((*a)->name(), (*b)->name());\n@@ -115,1 +118,1 @@\n-  static int compare_methods_alphadetically(const void* a, const void* b) {\n+  static int compare_methods_alphabetically(const void* a, const void* b) {\n@@ -118,1 +121,1 @@\n-    int n = compare_symbols_alphadetically(ma->name(), mb->name());\n+    int n = compare_symbols_alphabetically(ma->name(), mb->name());\n@@ -120,1 +123,1 @@\n-      n = compare_symbols_alphadetically(ma->signature(), mb->signature());\n+      n = compare_symbols_alphabetically(ma->signature(), mb->signature());\n@@ -125,1 +128,1 @@\n-  static int compare_symbols_alphadetically(Symbol* a, Symbol *b) {\n+  static int compare_symbols_alphabetically(Symbol* a, Symbol *b) {\n@@ -147,11 +150,10 @@\n-    if (ik->is_loaded() && ik->name()->is_star_match(_class_name_pattern)) {\n-      ResourceMark rm;\n-      if (_has_printed_methods) {\n-        \/\/ We have printed some methods in the previous class.\n-        \/\/ Print a new line to separate the two classes\n-        _st->cr();\n-      }\n-      _has_printed_methods = false;\n-      if (_always_print_class_name) {\n-        print_klass_name(ik);\n-      }\n+    ResourceMark rm;\n+    if (_has_printed_methods) {\n+      \/\/ We have printed some methods in the previous class.\n+      \/\/ Print a new line to separate the two classes\n+      _st->cr();\n+    }\n+    _has_printed_methods = false;\n+    if (_always_print_class_name) {\n+      print_klass_name(ik);\n+    }\n@@ -159,5 +161,5 @@\n-      if (has_mode(_flags, ClassPrinter::PRINT_CLASS_DETAILS)) {\n-        _st->print(\"InstanceKlass: \");\n-        ik->print_on(_st);\n-        oop mirror = ik->java_mirror();\n-        if (mirror != nullptr) {\n+    if (has_mode(_flags, ClassPrinter::PRINT_CLASS_DETAILS)) {\n+      _st->print(\"InstanceKlass: \");\n+      ik->print_on(_st);\n+      oop mirror = ik->java_mirror();\n+      if (mirror != nullptr) {\n@@ -165,2 +167,1 @@\n-          mirror->print_on(_st);\n-        }\n+        mirror->print_on(_st);\n@@ -168,0 +169,1 @@\n+    }\n@@ -169,4 +171,4 @@\n-      if (has_mode(_flags, ClassPrinter::PRINT_METHOD_NAME)) {\n-        bool print_codes = has_mode(_flags, ClassPrinter::PRINT_BYTECODE);\n-        int len = ik->methods()->length();\n-        int num_methods_printed = 0;\n+    if (has_mode(_flags, ClassPrinter::PRINT_METHOD_NAME)) {\n+      bool print_codes = has_mode(_flags, ClassPrinter::PRINT_BYTECODE);\n+      int len = ik->methods()->length();\n+      int num_methods_printed = 0;\n@@ -174,4 +176,4 @@\n-        Method** sorted_methods = NEW_RESOURCE_ARRAY(Method*, len);\n-        for (int index = 0; index < len; index++) {\n-          sorted_methods[index] = ik->methods()->at(index);\n-        }\n+      Method** sorted_methods = NEW_RESOURCE_ARRAY(Method*, len);\n+      for (int index = 0; index < len; index++) {\n+        sorted_methods[index] = ik->methods()->at(index);\n+      }\n@@ -179,1 +181,1 @@\n-        qsort(sorted_methods, len, sizeof(Method*), compare_methods_alphadetically);\n+      qsort(sorted_methods, len, sizeof(Method*), compare_methods_alphabetically);\n@@ -181,7 +183,7 @@\n-        for (int index = 0; index < len; index++) {\n-          Method* m = sorted_methods[index];\n-          if (match(_method_name_pattern, m->name()) &&\n-              match(_method_signature_pattern, m->signature())) {\n-            if (print_codes && num_methods_printed++ > 0) {\n-              _st->cr();\n-            }\n+      for (int index = 0; index < len; index++) {\n+        Method* m = sorted_methods[index];\n+        if (match(_method_name_pattern, m->name()) &&\n+            match(_method_signature_pattern, m->signature())) {\n+          if (print_codes && num_methods_printed++ > 0) {\n+            _st->cr();\n+          }\n@@ -189,5 +191,3 @@\n-            if (_has_printed_methods == false) {\n-              if (!_always_print_class_name) {\n-                print_klass_name(ik);\n-              }\n-              _has_printed_methods = true;\n+          if (_has_printed_methods == false) {\n+            if (!_always_print_class_name) {\n+              print_klass_name(ik);\n@@ -195,1 +195,1 @@\n-            print_method(m);\n+            _has_printed_methods = true;\n@@ -197,0 +197,1 @@\n+          print_method(m);\n","filename":"src\/hotspot\/share\/classfile\/classPrinter.cpp","additions":51,"deletions":50,"binary":false,"changes":101,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-    PRINT_METHOD_DETAILS    = 1 << 6, \/\/ print details of the C++ that represent methods\n+    PRINT_METHOD_DETAILS    = 1 << 6, \/\/ print details of the C++ objects that represent methods\n","filename":"src\/hotspot\/share\/classfile\/classPrinter.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}