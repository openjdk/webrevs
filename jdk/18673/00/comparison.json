{"files":[{"patch":"@@ -134,0 +134,4 @@\n+}\n+\n+inline bool operator<=(zoffset_end first, zoffset second) {\n+  return untype(first) <= untype(second);\n","filename":"src\/hotspot\/share\/gc\/z\/zAddress.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n-  zoffset _end;\n+  zoffset_end _end;\n@@ -44,1 +44,1 @@\n-  zoffset end() const;\n+  zoffset_end end() const;\n","filename":"src\/hotspot\/share\/gc\/z\/zPhysicalMemory.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-    _end(zoffset(UINTPTR_MAX)),\n+    _end(zoffset_end(UINTPTR_MAX)),\n@@ -39,1 +39,1 @@\n-    _end(start + size),\n+    _end(to_zoffset_end(start, size)),\n@@ -46,1 +46,1 @@\n-inline zoffset ZPhysicalMemorySegment::end() const {\n+inline zoffset_end ZPhysicalMemorySegment::end() const {\n","filename":"src\/hotspot\/share\/gc\/z\/zPhysicalMemory.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,0 +28,18 @@\n+class ZAddressOffsetMaxSetter {\n+private:\n+  const size_t _old_max;\n+  const size_t _old_mask;\n+\n+public:\n+  ZAddressOffsetMaxSetter()\n+    : _old_max(ZAddressOffsetMax),\n+      _old_mask(ZAddressOffsetMask) {\n+    ZAddressOffsetMax = size_t(16) * G * 1024;\n+    ZAddressOffsetMask = ZAddressOffsetMax - 1;\n+  }\n+  ~ZAddressOffsetMaxSetter() {\n+    ZAddressOffsetMax = _old_max;\n+    ZAddressOffsetMask = _old_mask;\n+  }\n+};\n+\n@@ -29,0 +47,2 @@\n+  ZAddressOffsetMaxSetter setter;\n+\n@@ -55,0 +75,2 @@\n+  ZAddressOffsetMaxSetter setter;\n+\n@@ -117,0 +139,2 @@\n+  ZAddressOffsetMaxSetter setter;\n+\n@@ -133,0 +157,2 @@\n+  ZAddressOffsetMaxSetter setter;\n+\n@@ -161,0 +187,2 @@\n+  ZAddressOffsetMaxSetter setter;\n+\n@@ -175,0 +203,17 @@\n+\n+TEST(ZPhysicalMemoryTest, limits) {\n+  ZAddressOffsetMaxSetter setter;\n+\n+  const size_t HalfZAddressOffsetMax = ZAddressOffsetMax >> 1;\n+  ZPhysicalMemory pmem0;\n+  pmem0.add_segment(ZPhysicalMemorySegment(zoffset(0), HalfZAddressOffsetMax, true));\n+  pmem0.add_segment(ZPhysicalMemorySegment(zoffset(HalfZAddressOffsetMax), HalfZAddressOffsetMax, false));\n+  EXPECT_EQ(pmem0.nsegments(), 2);\n+  EXPECT_EQ(pmem0.size(), ZAddressOffsetMax);\n+\n+  ZPhysicalMemory pmem1 = pmem0.split_committed();\n+  EXPECT_EQ(pmem0.nsegments(), 1);\n+  EXPECT_EQ(pmem0.size(), HalfZAddressOffsetMax);\n+  EXPECT_EQ(pmem1.nsegments(), 1);\n+  EXPECT_EQ(pmem1.size(), HalfZAddressOffsetMax);\n+}\n","filename":"test\/hotspot\/gtest\/gc\/z\/test_zPhysicalMemory.cpp","additions":45,"deletions":0,"binary":false,"changes":45,"status":"modified"}]}