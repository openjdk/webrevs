{"files":[{"patch":"@@ -455,0 +455,2 @@\n+  print_frame_event_info(jvmti, jni, thread, method, \"VirtualThreadMount\", ++vthread_mounted_count);\n+\n@@ -456,1 +458,1 @@\n-         brkptBreakpointHit, ++vthread_mounted_count, cname, mname, (void*)thread);\n+         brkptBreakpointHit, vthread_mounted_count, cname, mname, (void*)thread);\n@@ -461,1 +463,10 @@\n-  print_frame_event_info(jvmti, jni, thread, method, \"VirtualThreadMount\", vthread_mounted_count);\n+  LOG(\"\\nHit #%d: VirtualThreadMount #%d: enabling duplicated FramePop for method: %s::%s on virtual thread: %p\\n\",\n+         brkptBreakpointHit, vthread_mounted_count, cname, mname, (void*)thread);\n+\n+  err = jvmti->NotifyFramePop(thread, 0);\n+  if (err == JVMTI_ERROR_DUPLICATE) {\n+    LOG(\"NotifyFramePop at VirtualThreadUnmount event returned expected JVMTI_ERROR_DUPLICATE\\n\");\n+  } else {\n+    LOG(\"Failed: expected JVMTI_ERROR_DUPLICATE from NotifyFramePop at VirtualThreadUnmount event\\n\");\n+    jni->FatalError(\"NotifyFramePop error: expected error code JVMTI_ERROR_DUPLICATE\");\n+  }\n@@ -500,4 +511,1 @@\n-  LOG(\"\\nHit #%d: VirtualThreadUnmount #%d: enabling FramePop for method: %s::%s on virtual thread: %p\\n\",\n-         brkptBreakpointHit, ++vthread_unmounted_count, cname, mname, (void*)thread);\n-\n-  print_frame_event_info(jvmti, jni, thread, method, \"VirtualThreadUnmount\", vthread_unmounted_count);\n+  print_frame_event_info(jvmti, jni, thread, method, \"VirtualThreadUnmount\", ++vthread_unmounted_count);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/MethodExitTest\/libMethodExitTest.cpp","additions":14,"deletions":6,"binary":false,"changes":20,"status":"modified"}]}