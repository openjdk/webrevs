{"files":[{"patch":"@@ -693,0 +693,7 @@\n+template <class S, class U, class CT>\n+static TypeIntPrototype<S, U> int_type_intersection(const CT* t1, const CT* t2) {\n+  return TypeIntPrototype<S, U>{{MAX2(t1->_lo, t2->_lo), MIN2(t1->_hi, t2->_hi)},\n+                                {MAX2(t1->_ulo, t2->_ulo), MIN2(t1->_uhi, t2->_uhi)},\n+                                {t1->_bits._zeros | t2->_bits._zeros, t1->_bits._ones | t2->_bits._ones}};\n+}\n+\n@@ -700,4 +707,1 @@\n-    return CT::make_or_top(TypeIntPrototype<S, U>{{MAX2(t1->_lo, t2->_lo), MIN2(t1->_hi, t2->_hi)},\n-                                                  {MAX2(t1->_ulo, t2->_ulo), MIN2(t1->_uhi, t2->_uhi)},\n-                                                  {t1->_bits._zeros | t2->_bits._zeros, t1->_bits._ones | t2->_bits._ones}},\n-                           MIN2(t1->_widen, t2->_widen), true);\n+    return CT::make_or_top(int_type_intersection<S, U>(t1, t2), MIN2(t1->_widen, t2->_widen), true);\n@@ -713,4 +717,1 @@\n-  return CT::make_or_top(TypeIntPrototype<S, U>{{MAX2(t1->_lo, t2->_lo), MIN2(t1->_hi, t2->_hi)},\n-                                                {MAX2(t1->_ulo, t2->_ulo), MIN2(t1->_uhi, t2->_uhi)},\n-                                                {t1->_bits._zeros | t2->_bits._zeros, t1->_bits._ones | t2->_bits._ones}},\n-                         MIN2(t1->_widen, t2->_widen), false);\n+  return CT::make_or_top(int_type_intersection<S, U>(t1, t2), MIN2(t1->_widen, t2->_widen), false);\n","filename":"src\/hotspot\/share\/opto\/rangeinference.cpp","additions":9,"deletions":8,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -1024,5 +1024,8 @@\n-    tty->print_cr(\"=== Meet Not Commutative ===\");\n-    tty->print(\"t1          = \");  t1->dump(); tty->cr();\n-    tty->print(\"t2          = \");  t2->dump(); tty->cr();\n-    tty->print(\"t1 meets t2 = \"); mt1->dump(); tty->cr();\n-    tty->print(\"t2 meets t1 = \"); mt2->dump(); tty->cr();\n+    stringStream ss;\n+    ss.print_cr(\"=== Meet Not Commutative ===\");\n+    ss.print(\"t1          = \");  t1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2          = \");  t2->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 meets t2 = \"); mt1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 meets t1 = \"); mt2->dump_on(&ss); ss.cr();\n+    tty->print(\"%s\", ss.as_string());\n+    tty->flush();\n@@ -1035,5 +1038,8 @@\n-    tty->print_cr(\"=== Join Not Commutative ===\");\n-    tty->print(\"t1          = \");  t1->dump(); tty->cr();\n-    tty->print(\"t2          = \");  t2->dump(); tty->cr();\n-    tty->print(\"t1 joins t2 = \"); jt1->dump(); tty->cr();\n-    tty->print(\"t2 joins t1 = \"); jt2->dump(); tty->cr();\n+    stringStream ss;\n+    ss.print_cr(\"=== Join Not Commutative ===\");\n+    ss.print(\"t1          = \");  t1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2          = \");  t2->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 joins t2 = \"); jt1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 joins t1 = \"); jt2->dump_on(&ss); ss.cr();\n+    tty->print(\"%s\", ss.as_string());\n+    tty->flush();\n@@ -1044,4 +1050,7 @@\n-    tty->print_cr(\"=== Join of Nullable Pointers Cannot Be Empty ===\");\n-    tty->print(\"t1          = \");  t1->dump(); tty->cr();\n-    tty->print(\"t2          = \");  t2->dump(); tty->cr();\n-    tty->print(\"t1 joins t2 = \"); jt1->dump(); tty->cr();\n+    stringStream ss;\n+    ss.print_cr(\"=== Join of Nullable Pointers Cannot Be Empty ===\");\n+    ss.print(\"t1          = \");  t1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2          = \");  t2->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 joins t2 = \"); jt1->dump_on(&ss); ss.cr();\n+    tty->print(\"%s\", ss.as_string());\n+    tty->flush();\n@@ -1059,5 +1068,8 @@\n-      tty->print_cr(\"=== Join May Be Incorrect ===\");\n-      tty->print(\"t1                                    = \");  t1->dump(); tty->cr();\n-      tty->print(\"t2                                    = \");  t2->dump(); tty->cr();\n-      tty->print(\"t1 joins t2                           = \"); jt1->dump(); tty->cr();\n-      tty->print(\"(t1->dual() meets t2->dual())->dual() = \"); mdt->dump(); tty->cr();\n+      stringStream ss;\n+      ss.print_cr(\"=== Join May Be Incorrect ===\");\n+      ss.print(\"t1                                    = \");  t1->dump_on(&ss); ss.cr();\n+      ss.print(\"t2                                    = \");  t2->dump_on(&ss); ss.cr();\n+      ss.print(\"t1 joins t2                           = \"); jt1->dump_on(&ss); ss.cr();\n+      ss.print(\"(t1->dual() meets t2->dual())->dual() = \"); mdt->dump_on(&ss); ss.cr();\n+      tty->print(\"%s\", ss.as_string());\n+      tty->flush();\n@@ -1082,15 +1094,18 @@\n-    tty->print_cr(\"=== Fundamental Laws Violation ===\");\n-    tty->print(\"t1               = \"); t1->dump(); tty->cr();\n-    tty->print(\"t2               = \"); t2->dump(); tty->cr();\n-    tty->print(\"mt = t1 meets t2 = \"); mt->dump(); tty->cr();\n-    tty->print(\"jt = t1 joins t2 = \"); jt->dump(); tty->cr();\n-\n-    tty->print(\"t1 meets mt      = \"); t1mmt->dump(); tty->cr();\n-    tty->print(\"t2 meets mt      = \"); t2mmt->dump(); tty->cr();\n-    tty->print(\"t1 joins mt      = \"); t1jmt->dump(); tty->cr();\n-    tty->print(\"t2 joins mt      = \"); t2jmt->dump(); tty->cr();\n-    tty->print(\"t1 meets jt      = \"); t1mjt->dump(); tty->cr();\n-    tty->print(\"t2 meets jt      = \"); t2mjt->dump(); tty->cr();\n-    tty->print(\"t1 joins jt      = \"); t1jjt->dump(); tty->cr();\n-    tty->print(\"t2 joins jt      = \"); t2jjt->dump(); tty->cr();\n-\n+    stringStream ss;\n+    ss.print_cr(\"=== Fundamental Laws Violation ===\");\n+    ss.print(\"t1               = \"); t1->dump_on(&ss); ss.cr();\n+    ss.print(\"t2               = \"); t2->dump_on(&ss); ss.cr();\n+    ss.print(\"mt = t1 meets t2 = \"); mt->dump_on(&ss); ss.cr();\n+    ss.print(\"jt = t1 joins t2 = \"); jt->dump_on(&ss); ss.cr();\n+\n+    ss.print(\"t1 meets mt      = \"); t1mmt->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 meets mt      = \"); t2mmt->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 joins mt      = \"); t1jmt->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 joins mt      = \"); t2jmt->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 meets jt      = \"); t1mjt->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 meets jt      = \"); t2mjt->dump_on(&ss); ss.cr();\n+    ss.print(\"t1 joins jt      = \"); t1jjt->dump_on(&ss); ss.cr();\n+    ss.print(\"t2 joins jt      = \"); t2jjt->dump_on(&ss); ss.cr();\n+\n+    tty->print(\"%s\", ss.as_string());\n+    tty->flush();\n@@ -2285,2 +2300,0 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n@@ -2400,2 +2413,0 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n@@ -2714,3 +2725,1 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n-const Type *TypePtr::xmeet(const Type *t) const {\n+const Type* TypePtr::xmeet(const Type* t) const {\n@@ -3274,2 +3283,0 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n@@ -3797,2 +3804,0 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n@@ -4405,2 +4410,0 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n@@ -5171,3 +5174,2 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n-const Type *TypeAryPtr::xmeet_helper(const Type *t) const {\n+\n+const Type* TypeAryPtr::xmeet_helper(const Type* t) const {\n@@ -5811,3 +5813,1 @@\n-\/\/------------------------------meet-------------------------------------------\n-\/\/ Compute the MEET of two types.  It returns a new Type object.\n-const Type *TypeMetadataPtr::xmeet( const Type *t ) const {\n+const Type* TypeMetadataPtr::xmeet(const Type* t) const {\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":53,"deletions":53,"binary":false,"changes":106,"status":"modified"}]}