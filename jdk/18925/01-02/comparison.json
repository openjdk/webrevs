{"files":[{"patch":"@@ -126,1 +126,1 @@\n-  if (!_thread->in_internal_oome_mark()) {\n+  if (!_thread->is_in_internal_oome_mark()) {\n@@ -140,1 +140,1 @@\n-    THROW_OOP_(Universe::out_of_memory_error_java_heap(\/* omit_backtrace*\/ true), true);\n+    THROW_OOP_(Universe::out_of_memory_error_java_heap_without_backtrace(), true);\n","filename":"src\/hotspot\/share\/gc\/shared\/memAllocator.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -131,1 +131,1 @@\n-  InternalOOMEMark(JavaThread* thread) {\n+  explicit InternalOOMEMark(JavaThread* thread) {\n@@ -133,2 +133,2 @@\n-      _outer = thread->in_internal_oome_mark();\n-      thread->set_in_internal_oome_mark(true);\n+      _outer = thread->is_in_internal_oome_mark();\n+      thread->set_is_in_internal_oome_mark(true);\n@@ -145,3 +145,3 @@\n-      \/\/ JavaThread::_in_internal_oome_mark\n-      assert(_thread->in_internal_oome_mark(), \"must be\");\n-      _thread->set_in_internal_oome_mark(_outer);\n+      \/\/ JavaThread::_is_in_internal_oome_mark\n+      assert(_thread->is_in_internal_oome_mark(), \"must be\");\n+      _thread->set_is_in_internal_oome_mark(_outer);\n@@ -151,1 +151,0 @@\n-  \/\/ Returns nullptr iff `activate` was false in the constructor.\n","filename":"src\/hotspot\/share\/gc\/shared\/memAllocator.hpp","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -107,1 +107,1 @@\n-    JavaThread* THREAD = _iom.thread();\n+    JavaThread* THREAD = _iom.thread(); \/\/ For exception macros.\n","filename":"src\/hotspot\/share\/jvmci\/jvmciRuntime.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -653,6 +653,6 @@\n-oop Universe::out_of_memory_error_java_heap(bool omit_backtrace) {\n-  oop oome = out_of_memory_errors()->obj_at(_oom_java_heap);\n-  if (!omit_backtrace) {\n-    oome = gen_out_of_memory_error(oome);\n-  }\n-  return oome;\n+oop Universe::out_of_memory_error_java_heap() {\n+  return gen_out_of_memory_error(out_of_memory_errors()->obj_at(_oom_java_heap));\n+}\n+\n+oop Universe::out_of_memory_error_java_heap_without_backtrace() {\n+  return out_of_memory_errors()->obj_at(_oom_java_heap);\n","filename":"src\/hotspot\/share\/memory\/universe.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -274,1 +274,2 @@\n-  static oop out_of_memory_error_java_heap(bool omit_backtrace=false);\n+  static oop out_of_memory_error_java_heap();\n+  static oop out_of_memory_error_java_heap_without_backtrace();\n","filename":"src\/hotspot\/share\/memory\/universe.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -876,1 +876,1 @@\n-    if (!THREAD->in_internal_oome_mark()) {\n+    if (!THREAD->is_in_internal_oome_mark()) {\n@@ -881,1 +881,1 @@\n-      THROW_OOP(Universe::out_of_memory_error_java_heap(\/* omit_backtrace*\/ true));\n+      THROW_OOP(Universe::out_of_memory_error_java_heap_without_backtrace());\n","filename":"src\/hotspot\/share\/oops\/klass.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -458,1 +458,1 @@\n-  _in_internal_oome_mark(false),\n+  _is_in_internal_oome_mark(false),\n","filename":"src\/hotspot\/share\/runtime\/javaThread.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -55,0 +55,1 @@\n+class InternalOOMEMark;\n@@ -57,1 +58,0 @@\n-class InternalOOMEMark;\n@@ -339,1 +339,1 @@\n-  bool _in_internal_oome_mark;\n+  bool _is_in_internal_oome_mark;\n@@ -716,2 +716,3 @@\n-  bool in_internal_oome_mark() const            { return _in_internal_oome_mark; }\n-  void set_in_internal_oome_mark(bool b)        { _in_internal_oome_mark = b;    }\n+  \/\/ Is thread in scope of an InternalOOMEMark?\n+  bool is_in_internal_oome_mark() const          { return _is_in_internal_oome_mark; }\n+  void set_is_in_internal_oome_mark(bool b)      { _is_in_internal_oome_mark = b;    }\n","filename":"src\/hotspot\/share\/runtime\/javaThread.hpp","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"}]}