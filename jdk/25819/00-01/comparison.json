{"files":[{"patch":"@@ -218,6 +218,2 @@\n-     * On Windows, the backlog value of SOMAXCONN allows the underlying\n-     * platform implementation to set the backlog to a maximum reasonable value.\n-     * In order to use a backlog higher than what SOMAXCONN determines, Windows\n-     * documentation of listen() function suggests using SOMAXCONN_HINT(N)\n-     * (where N is a number).\n-     * SOMAXCONN_HINT will adjust the value N to be within the range (200, 65535).\n+     * Use SOMAXCONN_HINT when backlog larger than 200. It will adjust the value\n+     * to be within the range (200, 65535).\n@@ -225,1 +221,1 @@\n-    if (backlog >= 200) {\n+    if (backlog > 200) {\n","filename":"src\/java.base\/windows\/native\/libnio\/ch\/Net.c","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.nio.channels.AsynchronousServerSocketChannel;\n@@ -37,1 +38,1 @@\n- * @summary verify that java.net.ServerSocket and java.nio.channels.ServerSocketChannel,\n+ * @summary verify that java.net.ServerSocket and the server socket channels in java.nio.channels\n@@ -70,0 +71,13 @@\n+    @Test\n+    void testAsynchronousServerSocketChannel() throws Exception {\n+        final int backlog = 209;\n+        \/\/ Create a AsynchronousServerSocketChannel configured with the given backlog.\n+        \/\/ The channel never accept()s a connection so each connect() attempt\n+        \/\/ will be backlogged.\n+        try (var serverChannel = AsynchronousServerSocketChannel.open()) {\n+            serverChannel.bind(new InetSocketAddress(InetAddress.getLoopbackAddress(), 0), backlog);\n+            final int serverPort = ((InetSocketAddress) serverChannel.getLocalAddress()).getPort();\n+            testBackloggedConnects(backlog, serverPort);\n+        }\n+    }\n+\n@@ -72,1 +86,1 @@\n-        System.out.println(\"attempting \" + backlog + \" connections to port \" + serverPort);\n+        System.err.println(\"attempting \" + backlog + \" connections to port \" + serverPort);\n@@ -77,1 +91,1 @@\n-                System.out.println(\"connection \" + i + \" established \" + sock);\n+                System.err.println(\"connection \" + i + \" established \" + sock);\n@@ -84,1 +98,1 @@\n-        System.out.println(numSuccessfulConnects + \" connections successfully established\");\n+        System.err.println(numSuccessfulConnects + \" connections successfully established\");\n","filename":"test\/jdk\/java\/net\/ServerSocket\/LargeBacklogTest.java","additions":18,"deletions":4,"binary":false,"changes":22,"status":"modified"}]}