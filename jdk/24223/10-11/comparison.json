{"files":[{"patch":"@@ -512,4 +512,7 @@\n-void ClassListParser::check_supertype_overshadowing(int supertype_id, const InstanceKlass* supertype, TRAPS) {\n-  const InstanceKlass* overshadower = SystemDictionaryShared::get_unregistered_class(supertype->name());\n-  if (overshadower == nullptr || overshadower == supertype) {\n-    return;\n+void ClassListParser::check_supertype_obstruction(int specified_supertype_id, const InstanceKlass* specified_supertype, TRAPS) {\n+  if (specified_supertype->is_shared_unregistered_class()) {\n+    return; \/\/ Only registered supertypes can be obstructed\n+  }\n+  const InstanceKlass* obstructor = SystemDictionaryShared::get_unregistered_class(specified_supertype->name());\n+  if (obstructor == nullptr) {\n+    return; \/\/ No unregistered types with the same name have been loaded, i.e. no obstruction\n@@ -517,1 +520,1 @@\n-  assert(!supertype->is_shared_unregistered_class(), \"unregistered supertype cannot be overshadowed\");\n+  \/\/ 'specified_supertype' is S1, 'obstructor' is S2 from the explanation above\n@@ -520,2 +523,2 @@\n-            err_msg(\"%s (id %d) has super-type %s (id %d) overshadowed by another class with the same name\",\n-                    _class_name, _id, supertype->external_name(), supertype_id));\n+            err_msg(\"%s (id %d) has super-type %s (id %d) obstructed by another class with the same name\",\n+                    _class_name, _id, specified_supertype->external_name(), specified_supertype_id));\n@@ -550,3 +553,3 @@\n-  \/\/ Overshadowing must be checked before the class loading attempt because it\n-  \/\/ may cause class loading errors (JVMS 5.3.5.3-5.3.5.4)\n-  check_supertype_overshadowing(_super, specified_super, CHECK_NULL);\n+  \/\/ Obstruction must be checked before the class loading attempt because it may\n+  \/\/ cause class loading errors (JVMS 5.3.5.3-5.3.5.4)\n+  check_supertype_obstruction(_super, specified_super, CHECK_NULL);\n@@ -554,1 +557,1 @@\n-    check_supertype_overshadowing(_interfaces->at(i), specified_interfaces.at(i), CHECK_NULL);\n+    check_supertype_obstruction(_interfaces->at(i), specified_interfaces.at(i), CHECK_NULL);\n","filename":"src\/hotspot\/share\/cds\/classListParser.cpp","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -141,1 +141,1 @@\n-  void check_supertype_overshadowing(int supertype_id, const InstanceKlass* supertype, TRAPS);\n+  void check_supertype_obstruction(int specified_supertype_id, const InstanceKlass* specified_supertype, TRAPS);\n","filename":"src\/hotspot\/share\/cds\/classListParser.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -76,1 +76,1 @@\n-            out.shouldContain(\"CustomLoadee3Child (id 3) has super-type CustomLoadee3 (id 1) overshadowed by another class with the same name\");\n+            out.shouldContain(\"CustomLoadee3Child (id 3) has super-type CustomLoadee3 (id 1) obstructed by another class with the same name\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/customLoader\/RegUnregSuperTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}