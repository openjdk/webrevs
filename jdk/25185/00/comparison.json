{"files":[{"patch":"@@ -809,1 +809,1 @@\n-                                  methodHandle(), 0, CompileTask::Reason_Replay, THREAD);\n+                                  0, CompileTask::Reason_Replay, THREAD);\n","filename":"src\/hotspot\/share\/ci\/ciReplay.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -107,1 +107,1 @@\n-    CompileBroker::compile_method(m, InvocationEntryBci, level, methodHandle(), 0, CompileTask::Reason_MustBeCompiled, THREAD);\n+    CompileBroker::compile_method(m, InvocationEntryBci, level, 0, CompileTask::Reason_MustBeCompiled, THREAD);\n@@ -815,1 +815,1 @@\n-    CompileBroker::compile_method(mh, bci, level, mh, hot_count, CompileTask::Reason_Tiered, THREAD);\n+    CompileBroker::compile_method(mh, bci, level, hot_count, CompileTask::Reason_Tiered, THREAD);\n","filename":"src\/hotspot\/share\/compiler\/compilationPolicy.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -401,1 +401,0 @@\n-  methodHandle save_hot_method;\n@@ -456,1 +455,0 @@\n-    save_hot_method = methodHandle(thread, task->hot_method());\n@@ -1157,1 +1155,0 @@\n-                                        const methodHandle& hot_method,\n@@ -1176,7 +1173,2 @@\n-    if (!hot_method.is_null()) {\n-      tty->print(\" hot: \");\n-      if (hot_method() != method()) {\n-          hot_method->print_short_name(tty);\n-      } else {\n-        tty->print(\"yes\");\n-      }\n+    if (hot_count > 0) {\n+      tty->print(\" hot: yes\");\n@@ -1329,1 +1321,1 @@\n-                               hot_method, hot_count, compile_reason,\n+                               hot_count, compile_reason,\n@@ -1340,1 +1332,1 @@\n-                                       const methodHandle& hot_method, int hot_count,\n+                                       int hot_count,\n@@ -1360,1 +1352,1 @@\n-  nmethod* nm = CompileBroker::compile_method(method, osr_bci, comp_level, hot_method, hot_count, compile_reason, directive, THREAD);\n+  nmethod* nm = CompileBroker::compile_method(method, osr_bci, comp_level, hot_count, compile_reason, directive, THREAD);\n@@ -1367,1 +1359,1 @@\n-                                         const methodHandle& hot_method, int hot_count,\n+                                         int hot_count,\n@@ -1463,1 +1455,1 @@\n-    compile_method_base(method, osr_bci, comp_level, hot_method, hot_count, compile_reason, is_blocking, THREAD);\n+    compile_method_base(method, osr_bci, comp_level, hot_count, compile_reason, is_blocking, THREAD);\n@@ -1610,1 +1602,0 @@\n-                                                const methodHandle& hot_method,\n@@ -1616,1 +1607,1 @@\n-                       hot_method, hot_count, compile_reason,\n+                       hot_count, compile_reason,\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.cpp","additions":8,"deletions":17,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -270,1 +270,0 @@\n-                                          const methodHandle& hot_method,\n@@ -291,1 +290,0 @@\n-                                  const methodHandle& hot_method,\n@@ -325,1 +323,0 @@\n-                                 const methodHandle& hot_method,\n@@ -336,1 +333,0 @@\n-                                   const methodHandle& hot_method,\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -69,2 +69,1 @@\n-    if ((task->_method_holder != nullptr && JNIHandles::is_weak_global_handle(task->_method_holder)) ||\n-        (task->_hot_method_holder != nullptr && JNIHandles::is_weak_global_handle(task->_hot_method_holder))) {\n+    if ((task->_method_holder != nullptr && JNIHandles::is_weak_global_handle(task->_method_holder))) {\n@@ -72,1 +71,0 @@\n-      JNIHandles::destroy_weak_global(task->_hot_method_holder);\n@@ -75,1 +73,0 @@\n-      JNIHandles::destroy_global(task->_hot_method_holder);\n@@ -93,1 +90,0 @@\n-                             const methodHandle& hot_method,\n@@ -115,2 +111,0 @@\n-  _hot_method = nullptr;\n-  _hot_method_holder = nullptr;\n@@ -130,12 +124,0 @@\n-  if (LogCompilation) {\n-    if (hot_method.not_null()) {\n-      if (hot_method == method) {\n-        _hot_method = _method;\n-      } else {\n-        _hot_method = hot_method();\n-        \/\/ only add loader or mirror if different from _method_holder\n-        _hot_method_holder = JNIHandles::make_weak_global(Handle(thread, hot_method->method_holder()->klass_holder()));\n-      }\n-    }\n-  }\n-\n@@ -162,1 +144,0 @@\n-  JNIHandles::destroy_weak_global(_hot_method_holder);\n@@ -164,3 +145,0 @@\n-  if (_hot_method != nullptr) {\n-    _hot_method_holder = JNIHandles::make_global(Handle(thread, _hot_method->method_holder()->klass_holder()));\n-  }\n@@ -176,3 +154,0 @@\n-  if (_hot_method != nullptr) {\n-    _hot_method->set_on_stack(true);\n-  }\n@@ -191,3 +166,0 @@\n-  if (hot_method() != nullptr && hot_method() != method()) {\n-    f->do_metadata(hot_method());\n-  }\n@@ -332,3 +304,0 @@\n-  if (_hot_method != nullptr && _hot_method != _method) {\n-    xtty->method(_hot_method);\n-  }\n","filename":"src\/hotspot\/share\/compiler\/compileTask.cpp","additions":1,"deletions":32,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -109,2 +109,0 @@\n-  Method*              _hot_method;   \/\/ which method actually triggered this task\n-  jobject              _hot_method_holder;\n@@ -125,1 +123,1 @@\n-                  const methodHandle& hot_method, int hot_count,\n+                  int hot_count,\n@@ -133,1 +131,0 @@\n-  Method*      hot_method() const                { return _hot_method; }\n","filename":"src\/hotspot\/share\/compiler\/compileTask.hpp","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -92,1 +92,1 @@\n-      CompileBroker::compile_method(mh, InvocationEntryBci, CompLevel_full_optimization, mh, hot_count, CompileTask::Reason_Bootstrap, CHECK);\n+      CompileBroker::compile_method(mh, InvocationEntryBci, CompLevel_full_optimization, hot_count, CompileTask::Reason_Bootstrap, CHECK);\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompiler.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1127,1 +1127,1 @@\n-  nmethod* nm = CompileBroker::compile_method(mh, bci, comp_level, mh, mh->invocation_count(), CompileTask::Reason_Whitebox, CHECK_false);\n+  nmethod* nm = CompileBroker::compile_method(mh, bci, comp_level, mh->invocation_count(), CompileTask::Reason_Whitebox, CHECK_false);\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}