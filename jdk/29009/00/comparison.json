{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -247,1 +247,5 @@\n-        buf.append(\"init = \" + init + \"(\" + (init >> 10) + \"K) \");\n+        if (init == -1) {\n+            buf.append(\"init = N\/A \");\n+        } else {\n+            buf.append(\"init = \" + init + \"(\" + (init >> 10) + \"K) \");\n+        }\n@@ -251,1 +255,5 @@\n-        buf.append(\"max = \" + max + \"(\" + (max >> 10) + \"K)\");\n+        if (max == -1) {\n+            buf.append(\"max = N\/A\");\n+        } else {\n+            buf.append(\"max = \" + max + \"(\" + (max >> 10) + \"K)\");\n+        }\n","filename":"src\/java.management\/share\/classes\/java\/lang\/management\/MemoryUsage.java","additions":11,"deletions":3,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -170,0 +170,88 @@\n+        \/\/ Check toString() method\n+\n+        \/\/ 3.1. init is -1, should show N\/A\n+        MemoryUsage mu = new MemoryUsage(-1, 1024, 2048, 4096);\n+        String result = mu.toString();\n+        if (!result.contains(\"init = N\/A\")) {\n+            out.println(\"Failure 3.1.\");\n+            out.println(\"toString() should show 'init = N\/A' for undefined init, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (result.contains(\"init = -1\")) {\n+            out.println(\"Failure 3.1.\");\n+            out.println(\"toString() should not show 'init = -1' for undefined init, but got: \" + result);\n+            testFailed = true;\n+        }\n+\n+        \/\/ 3.2. max is -1, should show N\/A\n+        mu = new MemoryUsage(1024, 2048, 4096, -1);\n+        result = mu.toString();\n+        if (!result.contains(\"max = N\/A\")) {\n+            out.println(\"Failure 3.2.\");\n+            out.println(\"toString() should show 'max = N\/A' for undefined max, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (result.contains(\"max = -1\")) {\n+            out.println(\"Failure 3.2.\");\n+            out.println(\"toString() should not show 'max = -1' for undefined max, but got: \" + result);\n+            testFailed = true;\n+        }\n+\n+        \/\/ 3.3. both init and max are -1, should show N\/A for both\n+        mu = new MemoryUsage(-1, 1024, 2048, -1);\n+        result = mu.toString();\n+        if (!result.contains(\"init = N\/A\")) {\n+            out.println(\"Failure 3.3.\");\n+            out.println(\"toString() should show 'init = N\/A' when both are undefined, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (!result.contains(\"max = N\/A\")) {\n+            out.println(\"Failure 3.3.\");\n+            out.println(\"toString() should show 'max = N\/A' when both are undefined, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (result.contains(\"init = -1\") || result.contains(\"max = -1\")) {\n+            out.println(\"Failure 3.3.\");\n+            out.println(\"toString() should not show '-1' for undefined values, but got: \" + result);\n+            testFailed = true;\n+        }\n+\n+        \/\/ 3.4. all values are valid, should not show N\/A\n+        mu = new MemoryUsage(1024, 2048, 4096, 8192);\n+        result = mu.toString();\n+        if (!result.contains(\"init = 1024\")) {\n+            out.println(\"Failure 3.4.\");\n+            out.println(\"toString() should show init value for valid init, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (!result.contains(\"used = 2048\")) {\n+            out.println(\"Failure 3.4.\");\n+            out.println(\"toString() should show used value, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (!result.contains(\"committed = 4096\")) {\n+            out.println(\"Failure 3.4.\");\n+            out.println(\"toString() should show committed value, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (!result.contains(\"max = 8192\")) {\n+            out.println(\"Failure 3.4.\");\n+            out.println(\"toString() should show max value for valid max, but got: \" + result);\n+            testFailed = true;\n+        }\n+        if (result.contains(\"N\/A\")) {\n+            out.println(\"Failure 3.4.\");\n+            out.println(\"toString() should not show 'N\/A' for valid values, but got: \" + result);\n+            testFailed = true;\n+        }\n+\n+        \/\/ 3.5. zero values\n+        mu = new MemoryUsage(0, 0, 0, 0);\n+        result = mu.toString();\n+        if (!result.contains(\"init = 0\") || !result.contains(\"used = 0\") ||\n+            !result.contains(\"committed = 0\") || !result.contains(\"max = 0\")) {\n+            out.println(\"Failure 3.5.\");\n+            out.println(\"toString() should show zero values correctly, but got: \" + result);\n+            testFailed = true;\n+        }\n+\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/MemoryUsage\/MemoryUsage\/memoryusage001.java","additions":89,"deletions":1,"binary":false,"changes":90,"status":"modified"}]}