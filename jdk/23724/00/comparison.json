{"files":[{"patch":"@@ -179,1 +179,1 @@\n-  intptr_t* tos          = operand_stack_base - tempcount - popframe_extra_args;\n+  intptr_t* esp          = operand_stack_base - tempcount - popframe_extra_args - 1;\n@@ -209,1 +209,1 @@\n-  interpreter_frame->interpreter_frame_set_tos_address(tos);\n+  interpreter_frame->interpreter_frame_set_esp(esp);\n","filename":"src\/hotspot\/cpu\/s390\/abstractInterpreter_s390.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -501,3 +501,0 @@\n-  \/\/ Where z_ijava_state.esp is saved.\n-  inline intptr_t** interpreter_frame_esp_addr() const;\n-\n@@ -505,0 +502,4 @@\n+\n+  inline intptr_t* interpreter_frame_esp() const;\n+  \/\/ Where z_ijava_state.esp is saved.\n+  inline void interpreter_frame_set_esp(intptr_t* esp);\n@@ -506,1 +507,0 @@\n-  inline void interpreter_frame_set_tos_address(intptr_t* x);\n","filename":"src\/hotspot\/cpu\/s390\/frame_s390.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -229,0 +229,4 @@\n+inline intptr_t* frame::interpreter_frame_esp() const {\n+  return (intptr_t*) at_relative(_z_ijava_idx(esp));\n+}\n+\n@@ -230,2 +234,4 @@\n-inline intptr_t** frame::interpreter_frame_esp_addr() const {\n-  return (intptr_t**) &(ijava_state()->esp);\n+inline void frame::interpreter_frame_set_esp(intptr_t* esp) {\n+  assert(is_interpreted_frame(), \"interpreted frame expected\");\n+  \/\/ set relativized esp\n+  ijava_state()->esp = (intptr_t) (esp - fp());\n@@ -236,5 +242,1 @@\n-  return *interpreter_frame_esp_addr() + 1;\n-}\n-\n-inline void frame::interpreter_frame_set_tos_address(intptr_t* x) {\n-  *interpreter_frame_esp_addr() = x - 1;\n+  return interpreter_frame_esp() + Interpreter::stackElementWords;\n","filename":"src\/hotspot\/cpu\/s390\/frame_s390.inline.hpp","additions":9,"deletions":7,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -669,1 +669,3 @@\n-  z_stg(Z_esp, Address(Z_fp, _z_ijava_state_neg(esp)));\n+  z_sgrk(Z_R1, Z_esp, Z_fp);\n+  z_srag(Z_R1, Z_R1, Interpreter::logStackElementSize);\n+  z_stg(Z_R1, Address(Z_fp, _z_ijava_state_neg(esp)));\n@@ -675,0 +677,2 @@\n+  z_slag(Z_esp, Z_esp, Interpreter::logStackElementSize);\n+  z_agr(Z_esp, Z_fp);\n","filename":"src\/hotspot\/cpu\/s390\/interp_masm_s390.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1183,1 +1183,4 @@\n-  __ z_stg(Z_esp, _z_ijava_state_neg(esp), fp);\n+\n+  __ z_sgrk(Z_R0, Z_esp, fp);\n+  __ z_srag(Z_R0, Z_R0, Interpreter::logStackElementSize);\n+  __ z_stg(Z_R0, _z_ijava_state_neg(esp), fp);\n","filename":"src\/hotspot\/cpu\/s390\/templateInterpreterGenerator_s390.cpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"}]}