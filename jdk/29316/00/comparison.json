{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,0 +50,2 @@\n+import java.util.jar.Attributes;\n+import java.util.jar.Manifest;\n@@ -275,0 +277,20 @@\n+                \/\/ Check for a valid and consistent automatic module name\n+                try (InputStream jis = zf.getInputStream(zf.getEntry(entryName))) {\n+                    Manifest manifest = new Manifest(jis);\n+                    Attributes global = manifest.getMainAttributes();\n+                    String name = global.getValue(\"Automatic-Module-Name\");\n+                    if (name != null) {\n+                        try {\n+                            ModuleDescriptor.newAutomaticModule(name);\n+                        } catch (IllegalArgumentException e) {\n+                            errorAndInvalid(formatMsg(\"error.validator.manifest.invalid.automatic.module.name\", name));\n+                        }\n+                        if (md != null) {\n+                            if (!name.equals(md.name())) {\n+                                errorAndInvalid(formatMsg(\"error.validator.manifest.inconsistent.automatic.module.name\", name, md.name()));\n+                            }\n+                        }\n+                    }\n+                } catch (IOException e) {\n+                    errorAndInvalid(e.getMessage());\n+                }\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/tools\/jar\/Validator.java","additions":23,"deletions":1,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -141,0 +141,4 @@\n+error.validator.manifest.invalid.automatic.module.name=\\\n+        invalid module name of Automatic-Module-Name entry in manifest: {0}\n+error.validator.manifest.inconsistent.automatic.module.name=\\\n+        expected module name is: {1} - but found Automatic-Module-Name entry in manifest: {0}\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/tools\/jar\/resources\/jar.properties","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2025, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8345431\n+ * @bug 8345431 8375433\n@@ -28,4 +28,0 @@\n- * @library \/test\/lib\n- * @modules jdk.jartool\n- * @build jdk.test.lib.Platform\n- *        jdk.test.lib.util.FileUtils\n@@ -62,2 +58,0 @@\n-import jdk.test.lib.util.FileUtils;\n-\n@@ -69,0 +63,4 @@\n+    private static final ToolProvider JAVAC_TOOL = ToolProvider.findFirst(\"javac\")\n+        .orElseThrow(() ->\n+            new RuntimeException(\"javac tool not found\")\n+        );\n@@ -313,0 +311,46 @@\n+    @Test\n+    public void testInvalidAutomaticModuleName() throws Exception {\n+        System.out.printf(\"%n%n*****Creating Jar with invalid Automatic-Module-Name in Manifest*****%n%n\");\n+        var file = Path.of(\"InvalidAutomaticModuleName.jar\");\n+        var manifest = Path.of(\"MANIFEST.MF\");\n+        Files.writeString(manifest,\n+                \"\"\"\n+                Automatic-Module-Name: default\n+                \"\"\");\n+        jar(\"--create --file \" + file + \" --manifest \" + manifest);\n+        try {\n+            jar(\"--validate --file \" + file.toString());\n+            fail(\"Expecting non-zero exit code\");\n+        } catch (IOException e) {\n+            var err = e.getMessage();\n+            System.out.println(err);\n+            assertTrue(err.contains(\"invalid module name of Automatic-Module-Name entry in manifest: default\"), \"missing warning for: default\");\n+        }\n+    }\n+\n+    @Test\n+    public void testWrongAutomaticModuleName() throws Exception {\n+        System.out.printf(\"%n%n*****Creating Jar with wrong Automatic-Module-Name in Manifest*****%n%n\");\n+        var file = Path.of(\"WrongAutomaticModuleName.jar\");\n+        var foo = Path.of(\"module-info.java\");\n+        Files.writeString(foo,\n+                \"\"\"\n+                module foo {}\n+                \"\"\");\n+        var manifest = Path.of(\"MANIFEST.MF\");\n+        Files.writeString(manifest,\n+                \"\"\"\n+                Automatic-Module-Name: bar\n+                \"\"\");\n+        JAVAC_TOOL.run(System.out, System.err, foo.toString());\n+        jar(\"--create --file \" + file + \" --manifest \" + manifest + \" module-info.class\");\n+        try {\n+            jar(\"--validate --file \" + file.toString());\n+            fail(\"Expecting non-zero exit code\");\n+        } catch (IOException e) {\n+            var err = e.getMessage();\n+            System.out.println(err);\n+            assertTrue(err.contains(\"expected module name is: foo - but found Automatic-Module-Name entry in manifest: bar\"), \"missing warning for: foo\/bar\");\n+        }\n+    }\n+\n","filename":"test\/jdk\/tools\/jar\/ValidatorTest.java","additions":52,"deletions":8,"binary":false,"changes":60,"status":"modified"}]}