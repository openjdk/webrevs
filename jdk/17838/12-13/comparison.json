{"files":[{"patch":"@@ -115,3 +115,0 @@\n-                    if (systemTray != null) {\n-                        systemTray.remove(trayIcon);\n-                    }\n@@ -127,3 +124,0 @@\n-            if (systemTray != null) {\n-                systemTray.remove(trayIcon);\n-            }\n","filename":"test\/jdk\/java\/awt\/TrayIcon\/DisposeInActionEventTest\/DisposeInActionEventTest.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -24,9 +24,0 @@\n-\/*\n- * @test\n- * @bug 6384984 8004032 8316931\n- * @library ..\/..\/regtesthelpers \/test\/lib\n- * @build PassFailJFrame jtreg.SkippedException\n- * @summary TrayIcon try to dispay a tooltip when is not visible\n- * @run main\/manual ShowAfterDisposeTest\n-*\/\n-\n@@ -45,0 +36,8 @@\n+\/*\n+ * @test\n+ * @bug 6384984 8004032 8316931\n+ * @library ..\/..\/regtesthelpers \/test\/lib\n+ * @build PassFailJFrame jtreg.SkippedException\n+ * @summary TrayIcon try to dispay a tooltip when is not visible\n+ * @run main\/manual ShowAfterDisposeTest\n+ *\/\n@@ -46,0 +45,3 @@\n+    private static SystemTray tray;\n+    private static TrayIcon icon ;\n+\n@@ -67,9 +69,15 @@\n-        PassFailJFrame.builder()\n-                .title(\"Test Instructions Frame\")\n-                .instructions(instructions)\n-                .testTimeOut(10)\n-                .rows(10)\n-                .columns(45)\n-                .testUI(ShowAfterDisposeTest::showFrameAndIcon)\n-                .build()\n-                .awaitAndCheck();\n+        try {\n+            PassFailJFrame.builder()\n+                    .title(\"Test Instructions Frame\")\n+                    .instructions(instructions)\n+                    .testTimeOut(10)\n+                    .rows(10)\n+                    .columns(45)\n+                    .testUI(ShowAfterDisposeTest::showFrameAndIcon)\n+                    .build()\n+                    .awaitAndCheck();\n+        } finally {\n+            if (tray != null) {\n+                tray.remove(icon);\n+            }\n+        }\n@@ -90,2 +98,2 @@\n-        final SystemTray tray = SystemTray.getSystemTray();\n-        final TrayIcon icon = new TrayIcon(img);\n+        tray = SystemTray.getSystemTray();\n+        icon = new TrayIcon(img);\n","filename":"test\/jdk\/java\/awt\/TrayIcon\/ShowAfterDisposeTest\/ShowAfterDisposeTest.java","additions":28,"deletions":20,"binary":false,"changes":48,"status":"modified"}]}