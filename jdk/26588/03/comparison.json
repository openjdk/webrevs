{"files":[{"patch":"@@ -708,0 +708,10 @@\n+  \/\/ Usually, all class unloading work occurs at the end of phase 1, but Serial\n+  \/\/ full-gc accesses dead-objs' klass to find out the start of next live-obj\n+  \/\/ during phase 2. This requires klasses of dead-objs to be kept loaded.\n+  \/\/ Therefore, we declare ClassUnloadingContext at the same level as\n+  \/\/ full-gc phases, and purge dead classes (invoking\n+  \/\/ ClassLoaderDataGraph::purge) after all phases of full-gc.\n+  ClassUnloadingContext ctx(1 \/* num_nmethod_unlink_workers *\/,\n+                            false \/* unregister_nmethods_during_purge *\/,\n+                            false \/* lock_nmethod_free_separately *\/);\n+\n@@ -758,0 +768,7 @@\n+  \/\/ Delete metaspaces for unloaded class loaders and clean up CLDG.\n+  ClassLoaderDataGraph::purge(true \/* at_safepoint *\/);\n+  DEBUG_ONLY(MetaspaceUtils::verify();)\n+\n+  \/\/ Need to clear claim bits for the next full-gc (specifically phase 1 and 3).\n+  ClassLoaderDataGraph::clear_claimed_marks();\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialFullGC.cpp","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -606,3 +606,0 @@\n-  ClassUnloadingContext ctx(1 \/* num_nmethod_unlink_workers *\/,\n-                            false \/* unregister_nmethods_during_purge *\/,\n-                            false \/* lock_nmethod_free_separately *\/);\n@@ -633,7 +630,0 @@\n-  \/\/ Delete metaspaces for unloaded class loaders and clean up loader_data graph\n-  ClassLoaderDataGraph::purge(\/*at_safepoint*\/true);\n-  DEBUG_ONLY(MetaspaceUtils::verify();)\n-\n-  \/\/ Need to clear claim bits for the next mark.\n-  ClassLoaderDataGraph::clear_claimed_marks();\n-\n","filename":"src\/hotspot\/share\/gc\/serial\/serialHeap.cpp","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"}]}