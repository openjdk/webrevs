{"files":[{"patch":"@@ -78,3 +78,1 @@\n-    \/**\n-     * Paint MenuItem.\n-     *\/\n+    @Override\n@@ -86,3 +84,8 @@\n-            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n-                    arrowIcon, background, foreground, defaultTextIconGap,\n-                    menuItem, getPropertyPrefix());\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c,\n+                                            checkIcon, arrowIcon,\n+                                            background, foreground,\n+                                            disabledForeground,\n+                                            acceleratorSelectionForeground,\n+                                            acceleratorForeground,\n+                                            defaultTextIconGap,\n+                                            menuItem, getPropertyPrefix());\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsCheckBoxMenuItemUI.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import java.awt.Insets;\n@@ -36,1 +35,0 @@\n-import java.util.Enumeration;\n@@ -38,2 +36,0 @@\n-import javax.swing.AbstractButton;\n-import javax.swing.ButtonGroup;\n@@ -41,1 +37,0 @@\n-import javax.swing.DefaultButtonModel;\n@@ -70,3 +65,0 @@\n-    private static Color disabledForeground;\n-    private static Color acceleratorSelectionForeground;\n-    private static Color acceleratorForeground;\n@@ -137,21 +129,0 @@\n-    protected void installDefaults() {\n-        super.installDefaults();\n-        String prefix = getPropertyPrefix();\n-\n-        if (acceleratorSelectionForeground == null ||\n-                acceleratorSelectionForeground instanceof UIResource) {\n-            acceleratorSelectionForeground =\n-                    UIManager.getColor(prefix + \".acceleratorSelectionForeground\");\n-        }\n-        if (acceleratorForeground == null ||\n-                acceleratorForeground instanceof UIResource) {\n-            acceleratorForeground =\n-                    UIManager.getColor(prefix + \".acceleratorForeground\");\n-        }\n-        if (disabledForeground == null ||\n-                disabledForeground instanceof UIResource) {\n-            disabledForeground =\n-                    UIManager.getColor(prefix + \".disabledForeground\");\n-        }\n-    }\n-\n@@ -170,0 +141,1 @@\n+    @Override\n@@ -175,2 +147,6 @@\n-            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n-                                            arrowIcon, background, foreground,\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c,\n+                                            checkIcon, arrowIcon,\n+                                            background, foreground,\n+                                            disabledForeground,\n+                                            acceleratorSelectionForeground,\n+                                            acceleratorForeground,\n@@ -186,1 +162,2 @@\n-                              JComponent c, Icon checkIcon, Icon arrowIcon,\n+                              JComponent c,\n+                              Icon checkIcon, Icon arrowIcon,\n@@ -188,1 +165,7 @@\n-                              int defaultTextIconGap, JMenuItem menuItem, String prefix) {\n+                              Color disabledForeground,\n+                              Color acceleratorSelectionForeground,\n+                              Color acceleratorForeground,\n+                              int defaultTextIconGap, JMenuItem menuItem,\n+                              String prefix) {\n+        assert c == menuItem : \"menuItem passed as 'c' must be the same\";\n+\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsMenuItemUI.java","additions":16,"deletions":33,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -133,3 +133,1 @@\n-    \/**\n-     * Paint MenuItem.\n-     *\/\n+    @Override\n@@ -140,0 +138,1 @@\n+        assert c == menuItem : \"menuItem passed as 'c' must be the same\";\n@@ -141,1 +140,2 @@\n-            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon, arrowIcon,\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c,\n+                                            checkIcon, arrowIcon,\n@@ -143,0 +143,3 @@\n+                                            disabledForeground,\n+                                            acceleratorSelectionForeground,\n+                                            acceleratorForeground,\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsMenuUI.java","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -78,3 +78,1 @@\n-    \/**\n-     * Paint MenuItem.\n-     *\/\n+    @Override\n@@ -86,3 +84,8 @@\n-            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n-                    arrowIcon, background, foreground, defaultTextIconGap,\n-                    menuItem, getPropertyPrefix());\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c,\n+                                            checkIcon, arrowIcon,\n+                                            background, foreground,\n+                                            disabledForeground,\n+                                            acceleratorSelectionForeground,\n+                                            acceleratorForeground,\n+                                            defaultTextIconGap,\n+                                            menuItem, getPropertyPrefix());\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsRadioButtonMenuItemUI.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -0,0 +1,158 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.BorderLayout;\n+import java.awt.Color;\n+import java.awt.event.InputEvent;\n+import java.awt.event.KeyEvent;\n+\n+import javax.swing.Box;\n+import javax.swing.JFrame;\n+import javax.swing.JLabel;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuBar;\n+import javax.swing.JMenuItem;\n+import javax.swing.JPanel;\n+import javax.swing.KeyStroke;\n+import javax.swing.UIManager;\n+\n+import static javax.swing.BorderFactory.createEmptyBorder;\n+\n+\/*\n+ * @test id=windows\n+ * @bug 8348760 8365375 8365389 8365625\n+ * @requires (os.family == \"windows\")\n+ * @summary Verify that Windows Look & Feel allows changing\n+ *          accelerator colors\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual MenuItemAcceleratorColor\n+ *\/\n+\n+\/*\n+ * @test id=classic\n+ * @bug 8348760 8365375 8365389 8365625\n+ * @requires (os.family == \"windows\")\n+ * @summary Verify that Windows Classic Look & Feel allows changing\n+ *          accelerator colors\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual MenuItemAcceleratorColor classic\n+ *\/\n+public final class MenuItemAcceleratorColor {\n+    private static final String INSTRUCTIONS =\n+            \"Click the Menu to open it.\\n\" +\n+            \"\\n\" +\n+            \"Verify that the first and the last menu items render \" +\n+            \"their accelerators using the default colors, the color \" +\n+            \"should match that of the menu item itself in regular and \" +\n+            \"selected states.\\n\" +\n+            \"\\n\" +\n+            \"Verify that the second menu item renders with green and \" +\n+            \"that the color changes to red when selected.\\n\" +\n+            \"\\n\" +\n+            \"Verify that the third menu item renders with magenta and \" +\n+            \"yellow correspondingly.\\n\" +\n+            \"\\n\" +\n+            \"If the above conditions are satisfied, press the Pass button; \" +\n+            \"otherwise, press the Fail button.\";\n+\n+    public static void main(String[] args) throws Exception {\n+        UIManager.setLookAndFeel((args.length > 0 && \"classic\".equals(args[0]))\n+                                 ? \"com.sun.java.swing.plaf.windows.WindowsClassicLookAndFeel\"\n+                                 : \"com.sun.java.swing.plaf.windows.WindowsLookAndFeel\");\n+\n+        PassFailJFrame.builder()\n+                      .instructions(INSTRUCTIONS)\n+                      .rows(17)\n+                      .columns(50)\n+                      .testUI(MenuItemAcceleratorColor::createUI)\n+                      .build()\n+                      .awaitAndCheck();\n+    }\n+\n+    private static Box createInfoPanel() {\n+        Box box = Box.createVerticalBox();\n+        box.add(new JLabel(\"Look and Feel: \"\n+                           + UIManager.getLookAndFeel()\n+                                      .getName()));\n+        box.add(new JLabel(\"Java version: \"\n+                           + System.getProperty(\"java.runtime.version\")));\n+        return box;\n+    }\n+\n+    private static JFrame createUI() {\n+        JPanel content = new JPanel(new BorderLayout());\n+        content.setBorder(createEmptyBorder(8, 8, 8, 8));\n+        content.add(createInfoPanel(),\n+                    BorderLayout.SOUTH);\n+\n+        JFrame frame = new JFrame(\"Accelerator colors in Windows L&F\");\n+        frame.setJMenuBar(createMenuBar());\n+        frame.add(content, BorderLayout.CENTER);\n+        frame.setSize(300, 220);\n+        return frame;\n+    }\n+\n+    private static JMenuBar createMenuBar() {\n+        JMenuItem first = new JMenuItem(\"First menu item\");\n+        first.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_F,\n+                                                    InputEvent.CTRL_DOWN_MASK));\n+\n+        \/\/ Modify colors for accelerator rendering\n+        Color acceleratorForeground = UIManager.getColor(\"MenuItem.acceleratorForeground\");\n+        Color acceleratorSelectionForeground = UIManager.getColor(\"MenuItem.acceleratorSelectionForeground\");\n+        UIManager.put(\"MenuItem.acceleratorForeground\", Color.GREEN);\n+        UIManager.put(\"MenuItem.acceleratorSelectionForeground\", Color.RED);\n+\n+        JMenuItem second = new JMenuItem(\"Second menu item\");\n+        second.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_S,\n+                                                     InputEvent.SHIFT_DOWN_MASK\n+                                                     | InputEvent.CTRL_DOWN_MASK));\n+\n+        UIManager.put(\"MenuItem.acceleratorForeground\", Color.MAGENTA);\n+        UIManager.put(\"MenuItem.acceleratorSelectionForeground\", Color.YELLOW);\n+        JMenuItem third = new JMenuItem(\"Third menu item\");\n+        third.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T,\n+                                                    InputEvent.ALT_DOWN_MASK));\n+\n+        \/\/ Restore colors\n+        UIManager.put(\"MenuItem.acceleratorForeground\", acceleratorForeground);\n+        UIManager.put(\"MenuItem.acceleratorSelectionForeground\", acceleratorSelectionForeground);\n+\n+        JMenuItem quit = new JMenuItem(\"Quit\");\n+        quit.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_Q,\n+                                                   InputEvent.CTRL_DOWN_MASK));\n+\n+        JMenu menu = new JMenu(\"Menu\");\n+        menu.add(first);\n+        menu.add(second);\n+        menu.add(third);\n+        menu.add(quit);\n+\n+        JMenuBar menuBar = new JMenuBar();\n+        menuBar.add(menu);\n+\n+        return menuBar;\n+    }\n+}\n","filename":"test\/jdk\/com\/sun\/java\/swing\/plaf\/windows\/MenuItem\/MenuItemAcceleratorColor.java","additions":158,"deletions":0,"binary":false,"changes":158,"status":"added"}]}