{"files":[{"patch":"@@ -38,0 +38,1 @@\n+#include \"classfile\/symbolTable.hpp\"\n@@ -2339,2 +2340,2 @@\n-PrintClassClosure::PrintClassClosure(outputStream* st, bool verbose)\n-  :_st(st), _verbose(verbose) {\n+PrintClassClosure::PrintClassClosure(outputStream* st, bool verbose, bool location)\n+  :_st(st), _verbose(verbose), _location(location) {\n@@ -2378,0 +2379,35 @@\n+\n+  if (k->is_instance_klass() && _location) {\n+\n+    oop pd = java_lang_Class::protection_domain(k->java_mirror());\n+\n+    InstanceKlass* ik;\n+\n+    if (pd != nullptr && (ik = InstanceKlass::cast(pd->klass()))->is_instance_klass()) {\n+\n+      TempNewSymbol css  = SymbolTable::new_symbol(\"codesource\");\n+      TempNewSymbol csss = SymbolTable::new_symbol(\"Ljava\/security\/CodeSource;\");\n+\n+      fieldDescriptor csfd;\n+\n+      if (ik->find_field(css, csss, &csfd)) {\n+\n+        oop cs = pd->obj_field(csfd.offset());\n+\n+        if (cs != nullptr && (ik = InstanceKlass::cast(cs->klass()))->is_instance_klass()) {\n+          fieldDescriptor locfd;\n+\n+          TempNewSymbol csls  = SymbolTable::new_symbol(\"locationNoFragString\");\n+          TempNewSymbol cslss = SymbolTable::new_symbol(\"Ljava\/lang\/String;\");\n+\n+          if (ik->find_field(csls, cslss, &locfd)) {\n+            oop loc = cs->obj_field(locfd.offset());\n+\n+            if (loc != nullptr && loc->klass() == vmClasses::String_klass()) {\n+              java_lang_String::print(loc, _st, MAXPATHLEN);\n+            }\n+          }\n+        }\n+      }\n+    }\n+  }\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":38,"deletions":2,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -1212,0 +1212,1 @@\n+  bool _location;\n@@ -1213,1 +1214,1 @@\n-  PrintClassClosure(outputStream* st, bool verbose);\n+  PrintClassClosure(outputStream* st, bool verbose, bool location);\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -961,1 +961,2 @@\n-           \"BOOLEAN\", false, \"false\") {\n+           \"BOOLEAN\", false, \"false\"),\n+  _location(\"-location\", \"print class file location url (if available)\", \"BOOLEAN\", false, \"false\") {\n@@ -963,0 +964,1 @@\n+  _dcmdparser.add_dcmd_option(&_location);\n@@ -969,0 +971,1 @@\n+  bool _location;\n@@ -970,1 +973,1 @@\n-  VM_PrintClasses(outputStream* out, bool verbose) : _out(out), _verbose(verbose) {}\n+  VM_PrintClasses(outputStream* out, bool verbose, bool location) : _out(out), _verbose(verbose), _location(location) {}\n@@ -975,1 +978,1 @@\n-    PrintClassClosure closure(_out, _verbose);\n+    PrintClassClosure closure(_out, _verbose, _location);\n@@ -981,1 +984,1 @@\n-  VM_PrintClasses vmop(output(), _verbose.value());\n+  VM_PrintClasses vmop(output(), _verbose.value(), _location.value());\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -740,0 +740,1 @@\n+  DCmdArgument<bool> _location;\n@@ -741,1 +742,1 @@\n-  static int num_arguments() { return 1; }\n+  static int num_arguments() { return 2; }\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}