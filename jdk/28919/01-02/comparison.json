{"files":[{"patch":"@@ -117,11 +117,4 @@\n-            final Duration waitDuration = Duration.between(terminationStartedAt,\n-                    waitEndedAt);\n-            System.out.println(\"wait completed in \" + waitDuration);\n-            if (waitDuration.compareTo(EXPECTED_MAX_DURATION) > 0) {\n-                throw new RuntimeException(\"Took unexpectedly long (duration=\" +\n-                        waitDuration + \") to invoke Unreferenced.unreferenced(),\" +\n-                        \" expected max duration=\" + EXPECTED_MAX_DURATION);\n-            } else {\n-                System.err.println(\"TEST PASSED: unreferenced() invoked in timely\" +\n-                        \" fashion (duration=\" + waitDuration + \")\");\n-            }\n+            final Duration waitDuration = assertWithinExpectedTimeLimit(waitEndedAt,\n+                    terminationStartedAt);\n+            System.err.println(\"TEST PASSED: unreferenced() invoked in timely\" +\n+                    \" fashion (duration=\" + waitDuration + \")\");\n@@ -142,0 +135,18 @@\n+\n+    \/*\n+     * Verifies that the duration between the lease expiration and the callback\n+     * invocation is within the expected limit. Throws an exception if the wait\n+     * duration is larger than expected limit, else returns the actual wait duration.\n+     *\/\n+    private static Duration assertWithinExpectedTimeLimit(final Instant waitEndedAt,\n+                                                          final Instant terminationStartedAt) {\n+\n+        final Duration waitDuration = Duration.between(terminationStartedAt, waitEndedAt);\n+        System.out.println(\"wait completed in \" + waitDuration);\n+        if (waitDuration.compareTo(EXPECTED_MAX_DURATION) > 0) {\n+            throw new RuntimeException(\"Took unexpectedly long (duration=\" +\n+                    waitDuration + \") to invoke Unreferenced.unreferenced(),\" +\n+                    \" expected max duration=\" + EXPECTED_MAX_DURATION);\n+        }\n+        return waitDuration;\n+    }\n","filename":"test\/jdk\/java\/rmi\/server\/Unreferenced\/leaseCheckInterval\/LeaseCheckInterval.java","additions":22,"deletions":11,"binary":false,"changes":33,"status":"modified"}]}