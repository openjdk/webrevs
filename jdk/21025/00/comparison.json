{"files":[{"patch":"@@ -33,1 +33,0 @@\n-import java.time.LocalDateTime;\n@@ -291,37 +290,0 @@\n-\n-    static String expandFilename(String filename) {\n-        if (filename == null || filename.indexOf('%') == -1) {\n-            return filename;\n-        }\n-\n-        String pid = null;\n-        String time = null;\n-        StringBuilder sb = new StringBuilder();\n-        for (int i = 0; i < filename.length(); i++) {\n-            char c = filename.charAt(i);\n-            if (c == '%' && i < filename.length() - 1) {\n-                char nc = filename.charAt(i + 1);\n-                if (nc == '%') { \/\/ %% ==> %\n-                    sb.append('%');\n-                    i++;\n-                } else if (nc == 'p') {\n-                    if (pid == null) {\n-                        pid = JVM.getPid();\n-                    }\n-                    sb.append(pid);\n-                    i++;\n-                } else if (nc == 't') {\n-                    if (time == null) {\n-                        time = ValueFormatter.formatDateTime(LocalDateTime.now());\n-                    }\n-                    sb.append(time);\n-                    i++;\n-                } else {\n-                    sb.append('%');\n-                }\n-            } else {\n-                sb.append(c);\n-            }\n-        }\n-        return sb.toString();\n-    }\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/dcmd\/AbstractDCmd.java","additions":0,"deletions":38,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.time.LocalDateTime;\n@@ -34,0 +35,2 @@\n+\n+import jdk.jfr.internal.JVM;\n@@ -36,0 +39,1 @@\n+import jdk.jfr.internal.util.ValueFormatter;\n@@ -229,0 +233,1 @@\n+            case \"FILE\" -> text == null ? \"\" : parseFilename(text);\n@@ -233,0 +238,43 @@\n+    \/**\n+     * Expands filename arguments replacing '%p' with the PID\n+     * and '%t' with the time in 'yyyy_MM_dd_HH_mm_ss' format.\n+     * @param filename a filename to be expanded\n+     * @return filename with expanded arguments\n+     *\/\n+    private String parseFilename(String filename) {\n+        if (filename == null || filename.indexOf('%') == -1) {\n+            return filename;\n+        }\n+\n+        String pid = null;\n+        String time = null;\n+        StringBuilder sb = new StringBuilder();\n+        for (int i = 0; i < filename.length(); i++) {\n+            char c = filename.charAt(i);\n+            if (c == '%' && i < filename.length() - 1) {\n+                char nc = filename.charAt(i + 1);\n+                if (nc == '%') { \/\/ %% ==> %\n+                    sb.append('%');\n+                    i++;\n+                } else if (nc == 'p') {\n+                    if (pid == null) {\n+                        pid = JVM.getPid();\n+                    }\n+                    sb.append(pid);\n+                    i++;\n+                } else if (nc == 't') {\n+                    if (time == null) {\n+                        time = ValueFormatter.formatDateTime(LocalDateTime.now());\n+                    }\n+                    sb.append(time);\n+                    i++;\n+                } else {\n+                    sb.append('%');\n+                }\n+            } else {\n+                sb.append(c);\n+            }\n+        }\n+        return sb.toString();\n+    }\n+\n@@ -364,1 +412,1 @@\n-}\n\\ No newline at end of file\n+}\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/dcmd\/ArgumentParser.java","additions":49,"deletions":1,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -58,1 +58,1 @@\n-        String filename = expandFilename(parser.getOption(\"filename\"));\n+        String filename = parser.getOption(\"filename\");\n@@ -233,1 +233,1 @@\n-                                  the specified directory. (STRING, no default value)\n+                                  the specified directory. (FILE, no default value)\n@@ -287,1 +287,1 @@\n-               \"STRING\", false, true, null, false),\n+               \"FILE\", false, true, null, false),\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/dcmd\/DCmdDump.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -83,1 +83,1 @@\n-        String path = expandFilename(parser.getOption(\"filename\"));\n+        String path = parser.getOption(\"filename\");\n@@ -380,1 +380,1 @@\n-                                  directory. (STRING, no default value)\n+                                  directory. (FILE, no default value)\n@@ -504,1 +504,1 @@\n-                \"STRING\", false, true, \"hotspot-pid-xxxxx-id-y-YYYY_MM_dd_HH_mm_ss.jfr\", false),\n+                \"FILE\", false, true, \"hotspot-pid-xxxxx-id-y-YYYY_MM_dd_HH_mm_ss.jfr\", false),\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/dcmd\/DCmdStart.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-        String filename = expandFilename(parser.getOption(\"filename\"));\n+        String filename = parser.getOption(\"filename\");\n@@ -83,1 +83,1 @@\n-                           is discarded. (STRING, no default value)\n+                           is discarded. (FILE, no default value)\n@@ -110,1 +110,1 @@\n-                \"STRING\", false, true, null, false)\n+                \"FILE\", false, true, null, false)\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/dcmd\/DCmdStop.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}