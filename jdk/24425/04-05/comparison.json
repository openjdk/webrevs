{"files":[{"patch":"@@ -828,1 +828,1 @@\n-            \/\/ Protocol version is negotiated, reset locally supported\n+            \/\/ Protocol version is negotiated, update locally supported\n@@ -830,1 +830,1 @@\n-            SignatureScheme.setHandshakeLocalSupportedAlgs(context);\n+            SignatureScheme.updateHandshakeLocalSupportedAlgs(context);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ClientHello.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -363,1 +363,1 @@\n-                \/\/ Protocol version is negotiated, reset locally supported\n+                \/\/ Protocol version is negotiated, update locally supported\n@@ -365,1 +365,1 @@\n-                SignatureScheme.setHandshakeLocalSupportedAlgs(shc);\n+                SignatureScheme.updateHandshakeLocalSupportedAlgs(shc);\n@@ -579,1 +579,1 @@\n-                \/\/ Protocol version is negotiated, reset locally supported\n+                \/\/ Protocol version is negotiated, update locally supported\n@@ -581,1 +581,1 @@\n-                SignatureScheme.setHandshakeLocalSupportedAlgs(shc);\n+                SignatureScheme.updateHandshakeLocalSupportedAlgs(shc);\n@@ -972,1 +972,1 @@\n-            \/\/ Protocol version is negotiated, reset locally supported\n+            \/\/ Protocol version is negotiated, update locally supported\n@@ -974,1 +974,1 @@\n-            SignatureScheme.setHandshakeLocalSupportedAlgs(chc);\n+            SignatureScheme.updateHandshakeLocalSupportedAlgs(chc);\n@@ -1027,1 +1027,1 @@\n-            \/\/ Protocol version is negotiated, reset locally supported\n+            \/\/ Protocol version is negotiated, update locally supported\n@@ -1029,1 +1029,1 @@\n-            SignatureScheme.setHandshakeLocalSupportedAlgs(chc);\n+            SignatureScheme.updateHandshakeLocalSupportedAlgs(chc);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ServerHello.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -553,1 +553,1 @@\n-    \/\/ Convenience method to set all locally supported signature schemes for\n+    \/\/ Convenience method to update all locally supported signature schemes for\n@@ -555,1 +555,12 @@\n-    static void setHandshakeLocalSupportedAlgs(HandshakeContext hc) {\n+    static void updateHandshakeLocalSupportedAlgs(HandshakeContext hc) {\n+        \/\/ To improve performance we only update when necessary.\n+        \/\/ No need to do anything if we already computed the local supported\n+        \/\/ algorithms when the only active protocol ends up to be the\n+        \/\/ negotiated protocol.\n+        if (hc.localSupportedSignAlgs != null\n+                && hc.localSupportedCertSignAlgs != null\n+                && hc.activeProtocols.size() == 1\n+                && hc.activeProtocols.get(0).equals(hc.negotiatedProtocol)) {\n+            return;\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SignatureScheme.java","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"}]}