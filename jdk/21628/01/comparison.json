{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,0 @@\n-import java.io.IOException;\n@@ -151,14 +150,0 @@\n-\n-            \/\/ Signing will not work without Xcode with command line developer tools\n-            try {\n-                ProcessBuilder pb = new ProcessBuilder(\"\/usr\/bin\/xcrun\", \"--help\");\n-                Process p = pb.start();\n-                int code = p.waitFor();\n-                if (code != 0) {\n-                    throw new ConfigException(\n-                        I18N.getString(\"error.no.xcode.signing\"),\n-                        I18N.getString(\"error.no.xcode.signing.advice\"));\n-                }\n-            } catch (IOException | InterruptedException ex) {\n-                throw new ConfigException(ex);\n-            }\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacAppBundler.java","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -60,1 +60,0 @@\n-import static jdk.jpackage.internal.MacBaseInstallerBundler.SIGNING_KEY_USER;\n@@ -79,2 +78,0 @@\n-import static jdk.jpackage.internal.StandardBundlerParam.getPredefinedAppImage;\n-import static jdk.jpackage.internal.StandardBundlerParam.hasPredefinedAppImage;\n@@ -757,0 +754,8 @@\n+                \/\/ Signing might not work without Xcode with command line\n+                \/\/ developer tools. Show user if Xcode is missing as possible\n+                \/\/ reason.\n+                if (!isXcodeDevToolsInstalled()) {\n+                    Log.info(I18N.getString(\n+                        \"message.codesign.failed.reason.xcode.tools\"));\n+                }\n+\n@@ -767,0 +772,10 @@\n+    private static boolean isXcodeDevToolsInstalled() {\n+        try {\n+            Executor.of(\"\/usr\/bin\/xcrun\", \"--help\").executeExpectSuccess();\n+        } catch (IOException e) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacAppImageBuilder.java","additions":18,"deletions":3,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-error.no.xcode.signing=Xcode with command line developer tools is required for signing\n-error.no.xcode.signing.advice=Install Xcode with command line developer tools.\n@@ -98,0 +96,1 @@\n+message.codesign.failed.reason.xcode.tools=Possible reason for \"codesign\" failure is missing Xcode with command line developer tools. Install Xcode with command line developer tools to see if it resolves the problem.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources.properties","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-error.no.xcode.signing=Für die Signatur ist Xcode mit Befehlszeilen-Entwicklertools erforderlich\n-error.no.xcode.signing.advice=Installieren Sie Xcode mit Befehlszeilen-Entwicklertools.\n@@ -98,0 +96,1 @@\n+message.codesign.failed.reason.xcode.tools=Possible reason for \"codesign\" failure is missing Xcode with command line developer tools. Install Xcode with command line developer tools to see if it resolves the problem.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_de.properties","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-error.no.xcode.signing=署名には、Xcodeとコマンドライン・デベロッパ・ツールが必要です\n-error.no.xcode.signing.advice=Xcodeとコマンドライン・デベロッパ・ツールをインストールしてください。\n@@ -98,0 +96,1 @@\n+message.codesign.failed.reason.xcode.tools=Possible reason for \"codesign\" failure is missing Xcode with command line developer tools. Install Xcode with command line developer tools to see if it resolves the problem.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_ja.properties","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-error.no.xcode.signing=需要使用带命令行开发人员工具的 Xcode 进行签名\n-error.no.xcode.signing.advice=安装带命令行开发人员工具的 Xcode。\n@@ -98,0 +96,1 @@\n+message.codesign.failed.reason.xcode.tools=Possible reason for \"codesign\" failure is missing Xcode with command line developer tools. Install Xcode with command line developer tools to see if it resolves the problem.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_zh_CN.properties","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -35,0 +35,5 @@\n+ * @library \/test\/lib\n+ * @library base\n+ * @build SigningBase\n+ * @build SigningCheck\n+ * @build jtreg.SkippedException\n@@ -47,0 +52,5 @@\n+ * @library \/test\/lib\n+ * @library base\n+ * @build SigningBase\n+ * @build SigningCheck\n+ * @build jtreg.SkippedException\n@@ -72,1 +82,2 @@\n-                    \"Mutually exclusive options\"},\n+                    \"Mutually exclusive options\",\n+                    Boolean.FALSE},\n@@ -79,1 +90,2 @@\n-                    \"Mutually exclusive options\"},\n+                    \"Mutually exclusive options\",\n+                    Boolean.FALSE},\n@@ -85,1 +97,2 @@\n-                    \"Option [--mac-installer-sign-identity] is not valid with type\"},\n+                    \"Option [--mac-installer-sign-identity] is not valid with type\",\n+                    Boolean.FALSE},\n@@ -92,1 +105,2 @@\n-                    \"Option [--mac-installer-sign-identity] is not valid with type\"},\n+                    \"Option [--mac-installer-sign-identity] is not valid with type\",\n+                    Boolean.FALSE},\n@@ -107,1 +121,2 @@\n-                    \" was supplied via the \\\"--app-content\\\" parameter.\"},\n+                    \" was supplied via the \\\"--app-content\\\" parameter.\",\n+                    Boolean.TRUE},\n@@ -112,1 +127,2 @@\n-                              String[] removeArgs, String expectedError) {\n+                              String[] removeArgs, String expectedError,\n+                              Boolean checkRequirements) {\n@@ -115,0 +131,4 @@\n+        if (checkRequirements) {\n+            SigningCheck.isXcodeDevToolsInstalled();\n+        }\n+\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/SigningOptionsTest.java","additions":26,"deletions":6,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.IOException;\n@@ -92,0 +93,8 @@\n+    public static void isXcodeDevToolsInstalled() {\n+        int code = Executor.of(\"\/usr\/bin\/xcrun\", \"--help\")\n+                .executeWithoutExitCodeCheck().getExitCode();\n+        if (code != 0) {\n+            TKit.throwSkippedException(\"Missing Xcode with command line developer tools\");\n+        }\n+    }\n+\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/base\/SigningCheck.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"}]}