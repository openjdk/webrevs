{"files":[{"patch":"@@ -28,1 +28,0 @@\n-import sun.security.ssl.Hybrid;\n@@ -58,2 +57,0 @@\n-import static sun.security.util.SecurityConstants.PROVIDER_VER;\n-\n@@ -70,69 +67,0 @@\n-    \/\/ DHasKEM in its own private provider so we always getInstance from here.\n-    public static final Provider PROVIDER = new ProviderImpl();\n-\n-    \/\/ This is an internal provider used in the JSSE code for DH-as-KEM\n-    \/\/ and Hybrid KEM support. It doesn't actually get installed in the\n-    \/\/ system's list of security providers that is searched at runtime.\n-    \/\/ JSSE loads this provider internally.\n-    \/\/ It registers Hybrid KeyPairGenerator, KeyFactory, and KEM\n-    \/\/ implementations for hybrid named groups as Provider services.\n-    private static class ProviderImpl extends Provider {\n-        @java.io.Serial\n-        private static final long serialVersionUID = 0L;\n-        private ProviderImpl() {\n-            super(\"InternalJCEDHasKEM\", PROVIDER_VER,\n-                    \"Internal DHasKEM provider\");\n-            put(\"KEM.DH\", DHasKEM.class.getName());\n-\n-            \/\/ Hybrid KeyPairGenerator\/KeyFactory\/KEM\n-\n-            \/\/ The order of shares in the concatenation for group name\n-            \/\/ X25519MLKEM768 has been reversed. This is due to IETF\n-            \/\/ historical reasons.\n-            var attrs = Map.of(\"name\", \"X25519MLKEM768\", \"left\", \"ML-KEM-768\",\n-                    \"right\", \"X25519\");\n-            putService(new HybridService(this, \"KeyPairGenerator\",\n-                    \"X25519MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KEM\",\n-                    \"X25519MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KEMImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KeyFactory\",\n-                    \"X25519MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n-                    null, attrs));\n-\n-            attrs = Map.of(\"name\", \"SecP256r1MLKEM768\", \"left\", \"secp256r1\",\n-                    \"right\", \"ML-KEM-768\");\n-            putService(new HybridService(this, \"KeyPairGenerator\",\n-                    \"SecP256r1MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KEM\",\n-                    \"SecP256r1MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KEMImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KeyFactory\",\n-                    \"SecP256r1MLKEM768\",\n-                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n-                    null, attrs));\n-\n-            attrs = Map.of(\"name\", \"SecP384r1MLKEM1024\", \"left\", \"secp384r1\",\n-                    \"right\", \"ML-KEM-1024\");\n-            putService(new HybridService(this, \"KeyPairGenerator\",\n-                    \"SecP384r1MLKEM1024\",\n-                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KEM\",\n-                    \"SecP384r1MLKEM1024\",\n-                    \"sun.security.ssl.Hybrid$KEMImpl\",\n-                    null, attrs));\n-            putService(new HybridService(this, \"KeyFactory\",\n-                    \"SecP384r1MLKEM1024\",\n-                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n-                    null, attrs));\n-        }\n-    }\n-\n@@ -331,1 +259,1 @@\n-    private static class HybridService extends Provider.Service {\n+    public static class HybridService extends Provider.Service {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/DHasKEM.java","additions":1,"deletions":73,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -105,1 +105,1 @@\n-     * implementation provided by DHasKEM.PROVIDER.\n+     * implementation provided by DHasKEM class.\n@@ -107,1 +107,2 @@\n-     * using the given algorithm name.\n+     * with \"ML-KEM\". This is done to work with 3rd-party providers that\n+     * only have \"ML-KEM\" KEM algorithm.\n@@ -111,1 +112,1 @@\n-            return KEM.getInstance(\"DH\", DHasKEM.PROVIDER);\n+            return KEM.getInstance(\"DH\", HybridProvider.PROVIDER);\n@@ -113,1 +114,1 @@\n-            return KEM.getInstance(name);\n+            return KEM.getInstance(\"ML-KEM\");\n@@ -129,11 +130,0 @@\n-\n-            try {\n-                left.initialize(leftSpec);\n-                right.initialize(rightSpec);\n-            } catch (InvalidAlgorithmParameterException iape) {\n-                throw new ProviderException(\"Invalid algorithm parameters \" +\n-                        \"for hybrid keypair generator\", iape);\n-            } catch (Exception e) {\n-                throw new ProviderException(\"Failed to initialize hybrid \" +\n-                        \"keypair generator\", e);\n-            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/Hybrid.java","additions":5,"deletions":15,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -0,0 +1,104 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package sun.security.ssl;\n+\n+import java.security.Provider;\n+import java.util.Map;\n+\n+import static sun.security.util.SecurityConstants.PROVIDER_VER;\n+\n+\/\/ This is an internal provider used in the JSSE code for DH-as-KEM\n+\/\/ and Hybrid KEM support. It doesn't actually get installed in the\n+\/\/ system's list of security providers that is searched at runtime.\n+\/\/ JSSE loads this provider internally.\n+\/\/ It registers Hybrid KeyPairGenerator, KeyFactory, and KEM\n+\/\/ implementations for hybrid named groups as Provider services.\n+\n+public class HybridProvider {\n+\n+    public static final Provider PROVIDER = new ProviderImpl();\n+\n+    private static final class ProviderImpl extends Provider {\n+        @java.io.Serial\n+        private static final long serialVersionUID = 0L;\n+\n+        ProviderImpl() {\n+            super(\"HybridAndDHAsKEM\", PROVIDER_VER,\n+                    \"Hybrid and DHAsKEM provider\");\n+            put(\"KEM.DH\", DHasKEM.class.getName());\n+\n+            \/\/ Hybrid KeyPairGenerator\/KeyFactory\/KEM\n+\n+            \/\/ The order of shares in the concatenation for group name\n+            \/\/ X25519MLKEM768 has been reversed. This is due to IETF\n+            \/\/ historical reasons.\n+            var attrs = Map.of(\"name\", \"X25519MLKEM768\", \"left\", \"ML-KEM-768\",\n+                    \"right\", \"X25519\");\n+            putService(new DHasKEM.HybridService(this, \"KeyPairGenerator\",\n+                    \"X25519MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KEM\",\n+                    \"X25519MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KEMImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KeyFactory\",\n+                    \"X25519MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n+                    null, attrs));\n+\n+            attrs = Map.of(\"name\", \"SecP256r1MLKEM768\", \"left\", \"secp256r1\",\n+                    \"right\", \"ML-KEM-768\");\n+            putService(new DHasKEM.HybridService(this, \"KeyPairGenerator\",\n+                    \"SecP256r1MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KEM\",\n+                    \"SecP256r1MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KEMImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KeyFactory\",\n+                    \"SecP256r1MLKEM768\",\n+                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n+                    null, attrs));\n+\n+            attrs = Map.of(\"name\", \"SecP384r1MLKEM1024\", \"left\", \"secp384r1\",\n+                    \"right\", \"ML-KEM-1024\");\n+            putService(new DHasKEM.HybridService(this, \"KeyPairGenerator\",\n+                    \"SecP384r1MLKEM1024\",\n+                    \"sun.security.ssl.Hybrid$KeyPairGeneratorImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KEM\",\n+                    \"SecP384r1MLKEM1024\",\n+                    \"sun.security.ssl.Hybrid$KEMImpl\",\n+                    null, attrs));\n+            putService(new DHasKEM.HybridService(this, \"KeyFactory\",\n+                    \"SecP384r1MLKEM1024\",\n+                    \"sun.security.ssl.Hybrid$KeyFactoryImpl\",\n+                    null, attrs));\n+        }\n+    }\n+}\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/HybridProvider.java","additions":104,"deletions":0,"binary":false,"changes":104,"status":"added"},{"patch":"@@ -236,1 +236,1 @@\n-            DHasKEM.PROVIDER),\n+            HybridProvider.PROVIDER),\n@@ -242,1 +242,1 @@\n-            DHasKEM.PROVIDER),\n+            HybridProvider.PROVIDER),\n@@ -248,1 +248,1 @@\n-            DHasKEM.PROVIDER),\n+            HybridProvider.PROVIDER),\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/NamedGroup.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}