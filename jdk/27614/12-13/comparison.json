{"files":[{"patch":"@@ -79,1 +79,1 @@\n-        if (APS.isGenericEC(name)) {\n+        if (name.startsWith(\"secp\")) {\n@@ -88,1 +88,1 @@\n-        if (APS.isGenericEC(name)) {\n+        if (name.startsWith(\"secp\")) {\n@@ -96,1 +96,1 @@\n-        if (APS.isGenericEC(name)) {\n+        if (name.startsWith(\"secp\")) {\n@@ -110,1 +110,1 @@\n-        if (APS.isGenericEC(name) || APS.isXDH(name)) {\n+        if (name.startsWith(\"secp\") || name.equals(\"X25519\")) {\n@@ -142,0 +142,16 @@\n+        @Override\n+        public void initialize(AlgorithmParameterSpec params,\n+                SecureRandom random)\n+                throws InvalidAlgorithmParameterException {\n+\n+            try {\n+                left.initialize(leftSpec, random);\n+                right.initialize(rightSpec, random);\n+            } catch (InvalidAlgorithmParameterException iape) {\n+                throw iape;\n+            } catch (Exception e) {\n+                throw new ProviderException(\"Failed to initialize hybrid \" +\n+                        \"keypair generator\", e);\n+            }\n+        }\n+\n@@ -201,1 +217,1 @@\n-                    if (APS.isGenericEC(leftname)) {\n+                    if (leftname.startsWith(\"secp\")) {\n@@ -215,1 +231,1 @@\n-                    if (APS.isXDH(rightname)) {\n+                    if (rightname.equals(\"X25519\")) {\n@@ -464,10 +480,0 @@\n-\n-    private static final class APS {\n-        static boolean isGenericEC(String name) {\n-            return name != null && name.startsWith(\"secp\");\n-        }\n-\n-        static boolean isXDH(String name) {\n-            return name != null && name.equals(\"X25519\");\n-        }\n-    }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/Hybrid.java","additions":22,"deletions":16,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+import java.security.SecureRandom;\n@@ -166,1 +167,1 @@\n-    KEM.Encapsulated encapsulate(String algorithm)\n+    KEM.Encapsulated encapsulate(String algorithm, SecureRandom random)\n@@ -184,1 +185,1 @@\n-            KEM.Encapsulator e = kem.newEncapsulator(pk);\n+            KEM.Encapsulator e = kem.newEncapsulator(pk, random);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/KAKeyDerivation.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -128,0 +128,1 @@\n+                kpg.initialize(namedGroup.keAlgParamSpec, random);\n@@ -162,0 +163,1 @@\n+        private final SecureRandom random;\n@@ -163,1 +165,1 @@\n-        KEMSenderPossession(NamedGroup namedGroup) {\n+        KEMSenderPossession(NamedGroup namedGroup, SecureRandom random) {\n@@ -165,0 +167,6 @@\n+            this.random = random;\n+        }\n+\n+        \/\/ Package-private\n+        SecureRandom getRandom() {\n+            return random;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/KEMKeyExchange.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -589,0 +589,4 @@\n+\n+                    \/\/ SSLKeyExchange.createPossessions() returns at most one\n+                    \/\/ key-agreement possession or one KEMSenderPossession\n+                    \/\/ per handshake.\n@@ -598,1 +602,1 @@\n-                                    \"TlsHandshakeSecret\");\n+                                    \"TlsHandshakeSecret\", xp.getRandom());\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/KeyShareExtension.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -848,1 +848,1 @@\n-                    : new KEMKeyExchange.KEMSenderPossession(ng);\n+                    : new KEMKeyExchange.KEMSenderPossession(ng, random);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/NamedGroup.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}