{"files":[{"patch":"@@ -120,24 +120,0 @@\n-    \/**\n-     * The X25519MLKEM768 parameters\n-     *\n-     * @since 26\n-     *\/\n-    public static final NamedParameterSpec X25519MLKEM768\n-            = new NamedParameterSpec(\"X25519MLKEM768\");\n-\n-    \/**\n-     * The SecP256r1MLKEM768 parameters\n-     *\n-     * @since 26\n-     *\/\n-    public static final NamedParameterSpec SecP256r1MLKEM768\n-            = new NamedParameterSpec(\"SecP256r1MLKEM768\");\n-\n-    \/**\n-     * The SecP384r1MLKEM1024 parameters\n-     *\n-     * @since 26\n-     *\/\n-    public static final NamedParameterSpec SecP384r1MLKEM1024\n-            = new NamedParameterSpec(\"SecP384r1MLKEM1024\");\n-\n","filename":"src\/java.base\/share\/classes\/java\/security\/spec\/NamedParameterSpec.java","additions":0,"deletions":24,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -43,0 +43,1 @@\n+import sun.security.util.Hybrid;\n@@ -236,1 +237,1 @@\n-            NamedParameterSpec.X25519MLKEM768,\n+            Hybrid.X25519_MLKEM768,\n@@ -242,1 +243,1 @@\n-            NamedParameterSpec.SecP256r1MLKEM768,\n+            Hybrid.SECP256R1_MLKEM768,\n@@ -248,1 +249,1 @@\n-            NamedParameterSpec.SecP384r1MLKEM1024,\n+            Hybrid.SECP384R1_MLKEM1024,\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/NamedGroup.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -118,1 +118,0 @@\n-        private boolean initialized = false;\n@@ -120,1 +119,1 @@\n-        public KeyPairGeneratorImpl(String left, String right)\n+        public KeyPairGeneratorImpl(String leftAlg, String rightAlg)\n@@ -122,4 +121,15 @@\n-            this.left = getKeyPairGenerator(left);\n-            this.right = getKeyPairGenerator(right);\n-            leftSpec = getSpec(left);\n-            rightSpec = getSpec(right);\n+            left = getKeyPairGenerator(leftAlg);\n+            right = getKeyPairGenerator(rightAlg);\n+            leftSpec = getSpec(leftAlg);\n+            rightSpec = getSpec(rightAlg);\n+\n+            try {\n+                left.initialize(leftSpec);\n+                right.initialize(rightSpec);\n+            } catch (InvalidAlgorithmParameterException iape) {\n+                throw new ProviderException(\"Invalid algorithm parameters \" +\n+                        \"for hybrid keypair generator\", iape);\n+            } catch (Exception e) {\n+                throw new ProviderException(\"Failed to initialize hybrid \" +\n+                        \"keypair generator\", e);\n+            }\n@@ -133,1 +143,2 @@\n-                initialized = true;\n+            } catch (InvalidParameterException ipe) {\n+                throw ipe;\n@@ -135,1 +146,2 @@\n-                throw new InvalidParameterException(e);\n+                throw new ProviderException(\"Failed to initialize hybrid \" +\n+                        \"keypair generator\", e);\n@@ -141,9 +153,0 @@\n-            if (!initialized) {\n-                try {\n-                    left.initialize(leftSpec);\n-                    right.initialize(rightSpec);\n-                    initialized = true;\n-                } catch (Exception e) {\n-                    throw new ProviderException(e);\n-                }\n-            }\n@@ -177,0 +180,4 @@\n+            if (keySpec == null) {\n+                throw new InvalidKeySpecException(\"keySpec must not be null\");\n+            }\n+\n@@ -179,0 +186,11 @@\n+                if (key == null) {\n+                    throw new InvalidKeySpecException(\n+                            \"RawkeySpec contains null key data\");\n+                }\n+                if (key.length <= leftlen) {\n+                    throw new InvalidKeySpecException(\n+                            \"Hybrid key length \" + key.length +\n+                            \" is too short and its left key length is \" +\n+                            leftlen);\n+                }\n+\n@@ -230,2 +248,2 @@\n-            throw new InvalidKeySpecException(keySpec.toString());\n-\n+            throw new InvalidKeySpecException(\n+                    keySpec.getClass().getName() + \" not supported\");\n@@ -435,0 +453,9 @@\n+\n+    public static final NamedParameterSpec X25519_MLKEM768 =\n+            new NamedParameterSpec(\"X25519MLKEM768\");\n+\n+    public static final NamedParameterSpec SECP256R1_MLKEM768 =\n+            new NamedParameterSpec(\"SecP256r1MLKEM768\");\n+\n+    public static final NamedParameterSpec SECP384R1_MLKEM1024 =\n+            new NamedParameterSpec(\"SecP384r1MLKEM1024\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/Hybrid.java","additions":46,"deletions":19,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2024, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8345057 8314323\n+ * @bug 8345057\n@@ -44,1 +44,0 @@\n-        \"X25519MLKEM768\", \"SecP256r1MLKEM768\", \"SecP384r1MLKEM1024\",\n","filename":"test\/jdk\/java\/security\/spec\/TestNamedParameterSpec.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @bug 8029661 8325164 8368073 8368514 8368520 8314323\n+ * @bug 8029661 8325164 8368073 8368514 8368520\n","filename":"test\/jdk\/sun\/security\/pkcs11\/tls\/fips\/FipsModeTLS.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}