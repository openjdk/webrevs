{"files":[{"patch":"@@ -1544,2 +1544,9 @@\n-      \/\/ _lock_id is the thread ID of the mounted virtual thread\n-      st->print_cr(\"   Carrying virtual thread #\" INT64_FORMAT, lock_id());\n+      st->print(\"   Carrying virtual thread #\");\n+      \/\/ _lock_id is the thread ID of the mounted virtual thread. If it equals\n+      \/\/ the tid of the carrier we caught thread at the start of a temporary\n+      \/\/ transition in VirtualThread.switchToCarrierThread. Ignore that case.\n+      if (lock_id() != java_lang_Thread::thread_id(thread_oop)) {\n+        st->print_cr(INT64_FORMAT, lock_id());\n+      } else {\n+        st->print_cr(\"%s\", \"(Unavailable)\");\n+      }\n","filename":"src\/hotspot\/share\/runtime\/javaThread.cpp","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -165,1 +165,4 @@\n-  \/\/ attached thread cases where this field can have a temporary value.\n+  \/\/ attached thread cases where this field can have a temporary value. Also,\n+  \/\/ calls to VirtualThread.switchToCarrierThread will temporary change _vthread\n+  \/\/ to refer to the carrier while preserving the j.l.Thread.tid of the virtual\n+  \/\/ thread in this field.\n","filename":"src\/hotspot\/share\/runtime\/javaThread.hpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -334,1 +334,1 @@\n-  \/\/ points to current's stack, false othwerwise.\n+  \/\/ points to current's stack, false otherwise.\n","filename":"src\/hotspot\/share\/runtime\/objectMonitor.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1336,2 +1336,9 @@\n-          \/\/ _lock_id is the thread ID of the mounted virtual thread\n-          st->print_cr(\"   Mounted virtual thread #\" INT64_FORMAT, p->lock_id());\n+          st->print(\"   Mounted virtual thread #\");\n+          \/\/ _lock_id is the thread ID of the mounted virtual thread. If it equals\n+          \/\/ the tid of the carrier we caught thread at the start of a temporary\n+          \/\/ transition in VirtualThread.switchToCarrierThread. Ignore that case.\n+          if (p->lock_id() != java_lang_Thread::thread_id(p->threadObj())) {\n+            st->print_cr(INT64_FORMAT, p->lock_id());\n+          } else {\n+            st->print_cr(\"%s\", \"(Unavailable)\");\n+          }\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"}]}