{"files":[{"patch":"@@ -1950,0 +1950,5 @@\n+#if INCLUDE_JVMCI\n+  if (is_jvmci_hosted()) {\n+    return;\n+  }\n+#endif\n@@ -2059,10 +2064,2 @@\n-#if INCLUDE_JVMCI\n-      if (jvmci_nmethod_data() != nullptr && !jvmci_nmethod_data()->is_default()) {\n-        \/\/ Non-default (i.e., non-CompileBroker) compilations are\n-        \/\/ not subject to the recompilation cutoff\n-      } else\n-#endif\n-      {\n-        \/\/ Mark the method as decompiled.\n-        inc_decompile_count();\n-      }\n+      \/\/ Mark the method as decompiled.\n+      inc_decompile_count();\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -919,0 +919,6 @@\n+\n+  \/\/ Returns true if a JVMCI compiled method is non-default,\n+  \/\/ i.e., not triggered by CompilerBroker\n+  bool is_jvmci_hosted() const {\n+    return jvmci_nmethod_data() != nullptr && !jvmci_nmethod_data()->is_default();\n+  }\n","filename":"src\/hotspot\/share\/code\/nmethod.hpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2127,1 +2127,1 @@\n-    if (result != JVMCI::ok) {\n+    if (install_default && result != JVMCI::ok) {\n","filename":"src\/hotspot\/share\/jvmci\/jvmciRuntime.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -108,3 +108,0 @@\n-#if INCLUDE_JVMCI\n-#include \"jvmci\/jvmciRuntime.hpp\"\n-#endif\n@@ -2369,0 +2366,5 @@\n+#if INCLUDE_JVMCI\n+    if (nm->is_jvmci_hosted()) {\n+      update_trap_state = false;\n+    }\n+#endif\n@@ -2479,5 +2481,0 @@\n-#if INCLUDE_JVMCI\n-    if (nm->jvmci_nmethod_data() != nullptr && !nm->jvmci_nmethod_data()->is_default()) {\n-      inc_recompile_count = false;\n-    }\n-#endif\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":5,"deletions":8,"binary":false,"changes":13,"status":"modified"}]}