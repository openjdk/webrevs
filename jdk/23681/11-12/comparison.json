{"files":[{"patch":"@@ -105,1 +105,3 @@\n-                                chc, CERTIFICATE_SCOPE);\n+                                chc.sslConfig,\n+                                chc.algorithmConstraints, chc.activeProtocols,\n+                                CERTIFICATE_SCOPE);\n@@ -193,1 +195,4 @@\n-                            shc, spec.signatureSchemes, CERTIFICATE_SCOPE);\n+                            shc.sslConfig,\n+                            shc.algorithmConstraints, shc.negotiatedProtocol,\n+                            spec.signatureSchemes,\n+                            CERTIFICATE_SCOPE);\n@@ -246,1 +251,4 @@\n-                                shc, CERTIFICATE_SCOPE);\n+                                shc.sslConfig,\n+                                shc.algorithmConstraints,\n+                                List.of(shc.negotiatedProtocol),\n+                                CERTIFICATE_SCOPE);\n@@ -333,1 +341,4 @@\n-                            chc, spec.signatureSchemes, CERTIFICATE_SCOPE);\n+                            chc.sslConfig,\n+                            chc.algorithmConstraints, chc.negotiatedProtocol,\n+                            spec.signatureSchemes,\n+                            CERTIFICATE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CertSignAlgsExtension.java","additions":15,"deletions":4,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -642,1 +642,3 @@\n-                                shc, HANDSHAKE_SCOPE);\n+                                shc.sslConfig,\n+                                shc.algorithmConstraints, shc.activeProtocols,\n+                                HANDSHAKE_SCOPE);\n@@ -648,1 +650,3 @@\n-                                shc, CERTIFICATE_SCOPE);\n+                                shc.sslConfig,\n+                                shc.algorithmConstraints, shc.activeProtocols,\n+                                CERTIFICATE_SCOPE);\n@@ -750,1 +754,4 @@\n-                            chc, crm.algorithmIds, HANDSHAKE_SCOPE);\n+                            chc.sslConfig,\n+                            chc.algorithmConstraints, chc.negotiatedProtocol,\n+                            crm.algorithmIds,\n+                            HANDSHAKE_SCOPE);\n@@ -754,1 +761,4 @@\n-                            chc, crm.algorithmIds, CERTIFICATE_SCOPE);\n+                            chc.sslConfig,\n+                            chc.algorithmConstraints, chc.negotiatedProtocol,\n+                            crm.algorithmIds,\n+                            CERTIFICATE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CertificateRequest.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -451,1 +451,3 @@\n-                            shc, CERTIFICATE_SCOPE);\n+                            shc.sslConfig,\n+                            shc.algorithmConstraints, shc.activeProtocols,\n+                            CERTIFICATE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/PreSharedKeyExtension.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -278,1 +278,3 @@\n-                                shc, HANDSHAKE_SCOPE);\n+                                shc.sslConfig,\n+                                shc.algorithmConstraints, shc.activeProtocols,\n+                                HANDSHAKE_SCOPE);\n@@ -284,1 +286,3 @@\n-                                    shc, CERTIFICATE_SCOPE);\n+                                    shc.sslConfig,\n+                                    shc.algorithmConstraints, shc.activeProtocols,\n+                                    CERTIFICATE_SCOPE);\n@@ -524,1 +528,3 @@\n-                                shc, HANDSHAKE_SCOPE);\n+                                shc.sslConfig,\n+                                shc.algorithmConstraints, shc.activeProtocols,\n+                                HANDSHAKE_SCOPE);\n@@ -530,1 +536,3 @@\n-                                    shc, CERTIFICATE_SCOPE);\n+                                    shc.sslConfig,\n+                                    shc.algorithmConstraints, shc.activeProtocols,\n+                                    CERTIFICATE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ServerHello.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -359,1 +359,3 @@\n-                                chc, CERTIFICATE_SCOPE);\n+                                chc.sslConfig,\n+                                chc.algorithmConstraints, chc.activeProtocols,\n+                                CERTIFICATE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SessionTicketExtension.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -193,1 +193,3 @@\n-                            chc, HANDSHAKE_SCOPE);\n+                            chc.sslConfig,\n+                            chc.algorithmConstraints, chc.activeProtocols,\n+                            HANDSHAKE_SCOPE);\n@@ -280,1 +282,4 @@\n-                            shc, spec.signatureSchemes, HANDSHAKE_SCOPE);\n+                            shc.sslConfig,\n+                            shc.algorithmConstraints, shc.negotiatedProtocol,\n+                            spec.signatureSchemes,\n+                            HANDSHAKE_SCOPE);\n@@ -417,1 +422,4 @@\n-                            shc, HANDSHAKE_SCOPE);\n+                            shc.sslConfig,\n+                            shc.algorithmConstraints,\n+                            List.of(shc.negotiatedProtocol),\n+                            HANDSHAKE_SCOPE);\n@@ -505,1 +513,4 @@\n-                            chc, spec.signatureSchemes, HANDSHAKE_SCOPE);\n+                            chc.sslConfig,\n+                            chc.algorithmConstraints, chc.negotiatedProtocol,\n+                            spec.signatureSchemes,\n+                            HANDSHAKE_SCOPE);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SignatureAlgorithmsExtension.java","additions":15,"deletions":4,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -379,1 +379,4 @@\n-            HandshakeContext hc, Set<SSLScope> scopes) {\n+            SSLConfiguration config,\n+            SSLAlgorithmConstraints constraints,\n+            List<ProtocolVersion> activeProtocols,\n+            Set<SSLScope> scopes) {\n@@ -382,4 +385,0 @@\n-        List<ProtocolVersion> activeProtocols = hc.negotiatedProtocol != null\n-                ? List.of(hc.negotiatedProtocol)\n-                : hc.activeProtocols;\n-\n@@ -387,1 +386,1 @@\n-                hc.sslConfig.signatureSchemes == null ?\n+                config.signatureSchemes == null ?\n@@ -389,1 +388,1 @@\n-                    namesOfAvailable(hc.sslConfig.signatureSchemes);\n+                    namesOfAvailable(config.signatureSchemes);\n@@ -410,1 +409,1 @@\n-                if (ss.isPermitted(hc.algorithmConstraints, scopes)) {\n+                if (ss.isPermitted(constraints, scopes)) {\n@@ -428,1 +427,5 @@\n-            HandshakeContext hc, int[] algorithmIds, Set<SSLScope> scopes) {\n+            SSLConfiguration config,\n+            SSLAlgorithmConstraints constraints,\n+            ProtocolVersion protocolVersion,\n+            int[] algorithmIds,\n+            Set<SSLScope> scopes) {\n@@ -438,3 +441,3 @@\n-            } else if ((hc.sslConfig.signatureSchemes == null\n-                        || Utilities.contains(hc.sslConfig.signatureSchemes, ss.name))\n-                    && ss.isAllowed(hc.algorithmConstraints, hc.negotiatedProtocol, scopes)) {\n+            } else if ((config.signatureSchemes == null\n+                        || Utilities.contains(config.signatureSchemes, ss.name))\n+                    && ss.isAllowed(constraints, protocolVersion, scopes)) {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SignatureScheme.java","additions":15,"deletions":12,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -746,4 +746,4 @@\n-#     HANDSHAKE restricts algorithm to be used for signing TLS handshake.\n-#     CERTIFICATE restricts algorithm to be used for signatures in certificates.\n-#     These constraints can't be mixed with any other usage constraints for the\n-#     same algorithm, they also can't be linked with other constraints by an\n+#     Handshake restricts the use of the algorithm in TLS handshake signatures.\n+#     Certificate restricts the use of the algorithm in certificate signatures.\n+#     These constraints cannot be mixed with other usage constraints for the\n+#     same algorithm, they also cannot be linked with other constraints by an\n@@ -751,2 +751,0 @@\n-#     See https:\/\/datatracker.ietf.org\/doc\/html\/rfc8446#section-4.2.3 for more\n-#     information on signatures used in TLS handshake and in certificates.\n","filename":"src\/java.base\/share\/conf\/security\/java.security","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -896,1 +896,1 @@\n-        SSLContext ctx = SSLContext.getInstance(\"TLSv1.2\");\n+        SSLContext ctx = SSLContext.getInstance(\"TLS\");\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/DNSIdentities.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -904,1 +904,1 @@\n-        SSLContext ctx = SSLContext.getInstance(\"TLSv1.2\");\n+        SSLContext ctx = SSLContext.getInstance(\"TLS\");\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/IPAddressIPIdentities.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -903,1 +903,1 @@\n-        SSLContext ctx = SSLContext.getInstance(\"TLSv1.2\");\n+        SSLContext ctx = SSLContext.getInstance(\"TLS\");\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/IPIdentities.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -896,1 +896,1 @@\n-        SSLContext ctx = SSLContext.getInstance(\"TLSv1.2\");\n+        SSLContext ctx = SSLContext.getInstance(\"TLS\");\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/Identities.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}