{"files":[{"patch":"@@ -718,1 +718,1 @@\n-    private static Path fetchNssLib(String osId, Path libraryName) {\n+    private static Path fetchNssLib(String osId, Path libraryName) throws IOException {\n@@ -747,17 +747,3 @@\n-    private static Path fetchNssLib(Class<?> clazz, Path libraryName) {\n-        Path path = null;\n-        try {\n-            Path p = ArtifactResolver.resolve(clazz).entrySet().stream()\n-                    .findAny().get().getValue();\n-            path = findNSSLibrary(p, libraryName);\n-        } catch (ArtifactResolverException | IOException e) {\n-            Throwable cause = e.getCause();\n-            if (cause == null) {\n-                System.out.println(\"Cannot resolve artifact, \"\n-                        + \"please check if JIB jar is present in classpath.\");\n-            } else {\n-                throw new RuntimeException(\"Fetch artifact failed: \" + clazz\n-                        + \"\\nPlease make sure the artifact is available.\", e);\n-            }\n-        }\n-        return path;\n+    private static Path fetchNssLib(Class<?> clazz, Path libraryName) throws IOException {\n+        Path p = ArtifactResolver.fetchOne(clazz);\n+        return findNSSLibrary(p, libraryName);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/PKCS11Test.java","additions":4,"deletions":18,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -85,7 +85,1 @@\n-            if (opensslPath != null) {\n-                \/\/ if the current version of openssl is available, perform all\n-                \/\/ keytool <-> openssl interop tests\n-                generateInitialKeystores(opensslPath);\n-                testWithJavaCommands();\n-                testWithOpensslCommands(opensslPath);\n-            } else {\n+            if (opensslPath == null) {\n@@ -98,0 +92,6 @@\n+\n+            \/\/ if the current version of openssl is available, perform all\n+            \/\/ keytool <-> openssl interop tests\n+            generateInitialKeystores(opensslPath);\n+            testWithJavaCommands();\n+            testWithOpensslCommands(opensslPath);\n","filename":"test\/jdk\/sun\/security\/pkcs12\/KeytoolOpensslInteropTest.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-import jdk.test.lib.artifacts.ArtifactResolverException;\n@@ -30,0 +29,1 @@\n+import java.io.IOException;\n@@ -109,1 +109,1 @@\n-        Path archivePath = fetchACVPServerTests(ACVP_SERVER_TESTS.class);\n+        Path archivePath = ArtifactResolver.fetchOne(ACVP_SERVER_TESTS.class);\n@@ -181,15 +181,0 @@\n-    private static Path fetchACVPServerTests(Class<?> clazz) {\n-        try {\n-            return ArtifactResolver.resolve(clazz).entrySet().stream()\n-                    .findAny().get().getValue();\n-        } catch (ArtifactResolverException e) {\n-            Throwable cause = e.getCause();\n-            if (cause == null) {\n-                throw new SkippedException(\"Cannot resolve artifact, \"\n-                        + \"please check if JIB jar is present in classpath.\", e);\n-            }\n-\n-            throw new SkippedException(\"Fetch artifact failed: \" + clazz, e);\n-        }\n-    }\n-\n","filename":"test\/jdk\/sun\/security\/provider\/acvp\/Launcher.java","additions":2,"deletions":17,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -26,0 +26,3 @@\n+import jtreg.SkippedException;\n+\n+import java.io.IOException;\n@@ -71,0 +74,31 @@\n+    \/**\n+     * Retrieve an artifact\/library\/file from a repository or local file system.\n+     * <p>\n+     * Artifacts are defined with the {@link jdk.test.lib.artifacts.Artifact}\n+     * annotation. The file name should have the format ARTIFACT_NAME-VERSION.EXT\n+     * <p>\n+     * If you have a local version of a dependency that you want to use, you can\n+     * specify that by setting the System property:\n+     * <code>jdk.test.lib.artifacts.ARTIFACT_NAME<\/code>\n+     * <p>\n+     * Generally, tests that use this method should be run with <code>make test<\/code>.\n+     * However, tests can also be run with <code>jtreg<\/code> but you must have a\n+     * local copy of the artifact and the system property must be set as specified\n+     * above.\n+     *\n+     * @param klass a class annotated with {@link jdk.test.lib.artifacts.Artifact}\n+     * @return the local path to the artifact. If the artifact is a compressed\n+     * file that gets unpacked, this path will point to the root\n+     * directory of the uncompressed file.\n+     * @throws SkippedException thrown if the artifact cannot be found\n+     *\/\n+    public static Path fetchOne(Class<?> klass) {\n+        try {\n+            return ArtifactResolver.resolve(klass).entrySet().stream()\n+                    .findAny().get().getValue();\n+        } catch (ArtifactResolverException e) {\n+            Artifact artifact = klass.getAnnotation(Artifact.class);\n+            throw new SkippedException(\"Cannot find the artifact \" + artifact.name(), e);\n+        }\n+    }\n+\n","filename":"test\/lib\/jdk\/test\/lib\/artifacts\/ArtifactResolver.java","additions":34,"deletions":0,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n-import java.io.File;\n+import java.io.IOException;\n@@ -33,1 +33,0 @@\n-import jdk.test.lib.artifacts.ArtifactResolverException;\n@@ -115,17 +114,3 @@\n-        String path = null;\n-        try {\n-            path = ArtifactResolver.resolve(clazz).entrySet().stream()\n-                    .findAny().get().getValue() + File.separator + \"openssl\"\n-                    + File.separator + \"bin\" + File.separator + \"openssl\";\n-            System.out.println(\"path: \" + path);\n-        } catch (ArtifactResolverException e) {\n-            Throwable cause = e.getCause();\n-            if (cause == null) {\n-                System.out.println(\"Cannot resolve artifact, \"\n-                        + \"please check if JIB jar is present in classpath.\");\n-            } else {\n-                throw new RuntimeException(\"Fetch artifact failed: \" + clazz\n-                        + \"\\nPlease make sure the artifact is available.\", e);\n-            }\n-        }\n-        return path;\n+        return ArtifactResolver.fetchOne(clazz)\n+                .resolve(\"openssl\", \"bin\", \"openssl\")\n+                .toString();\n","filename":"test\/lib\/jdk\/test\/lib\/security\/OpensslArtifactFetcher.java","additions":4,"deletions":19,"binary":false,"changes":23,"status":"modified"}]}