{"files":[{"patch":"@@ -423,3 +423,6 @@\n-        if ((existing_map->memsz != page_size) &&\n-            (existing_map->fd != lib_fd) &&\n-            (ROUNDUP(existing_map->memsz, page_size) != ROUNDUP(lib_php->p_memsz, page_size))) {\n+        size_t aligned_map_memsz = ROUNDUP(existing_map->memsz, page_size);\n+        bool is_extended_memsz = aligned_map_memsz == ROUNDUP(lib_php->p_memsz + (lib_php->p_offset & (page_size - 1)), page_size);\n+        if (!is_extended_memsz &&\n+            existing_map->memsz != page_size &&\n+            existing_map->fd != lib_fd &&\n+            aligned_map_memsz != ROUNDUP(lib_php->p_memsz, page_size)) {\n@@ -438,1 +441,6 @@\n-        existing_map->memsz = ROUNDUP(lib_php->p_memsz, page_size);\n+        if (!is_extended_memsz) {\n+          existing_map->memsz = ROUNDUP(lib_php->p_memsz, page_size);\n+        } else {\n+          \/\/ The offset in the core dump is aligned down to page_size.\n+          \/\/ We should trust the core dump in this case.\n+        }\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/ps_core.c","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"}]}