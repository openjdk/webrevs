{"files":[{"patch":"@@ -2793,2 +2793,8 @@\n-  enum DataOrder { Unknown, Forward, Reverse};\n-  DataOrder  _value_order;\n+  \/\/ State machine with initial state Unknown\n+  \/\/ Allowed transitions:\n+  \/\/   Unknown  -> Forward\n+  \/\/   Unknown  -> Backward\n+  \/\/   Forward  -> Forward\n+  \/\/   Backward -> Backward\n+  enum ValueOrder { Unknown, Forward, Backward };\n+  ValueOrder  _value_order;\n@@ -2800,1 +2806,1 @@\n-    _phase(phase), _store(store), _value_order(DataOrder::Unknown)\n+    _phase(phase), _store(store), _value_order(ValueOrder::Unknown)\n@@ -2993,2 +2999,2 @@\n-  \/\/ initialize value_order once\n-  if (_value_order == DataOrder::Unknown) {\n+  \/\/ Initial state \"Unknown\": check for transition to Forward or Backward.\n+  if (_value_order == ValueOrder::Unknown) {\n@@ -2996,1 +3002,1 @@\n-      _value_order = DataOrder::Forward;\n+      _value_order = ValueOrder::Forward; \/\/ First pair has Forward order\n@@ -3001,1 +3007,1 @@\n-      _value_order = DataOrder::Reverse;  \/\/ only support reverse bytes\n+      _value_order = ValueOrder::Backward;  \/\/ only support reverse bytes\n@@ -3008,3 +3014,3 @@\n-  if ((_value_order == DataOrder::Forward && shift_n1 > shift_n2) ||\n-      (_value_order == DataOrder::Reverse && shift_n1 < shift_n2)) {\n-    \/\/ wrong order\n+  if ((_value_order == ValueOrder::Forward  && shift_n1 > shift_n2) ||\n+      (_value_order == ValueOrder::Backward && shift_n1 < shift_n2)) {\n+    \/\/ Wrong order: mixed Forward and Backward not allowed.\n@@ -3231,1 +3237,1 @@\n-    assert(_value_order != DataOrder::Unknown, \"sanity\");\n+    assert(_value_order != ValueOrder::Unknown, \"sanity\");\n@@ -3238,1 +3244,1 @@\n-    if (_value_order == DataOrder::Reverse) {\n+    if (_value_order == ValueOrder::Backward) {\n@@ -3270,1 +3276,2 @@\n-  if (_value_order == DataOrder::Reverse) {\n+  if (_value_order == ValueOrder::Backward) {\n+    assert(_store->memory_size() == 1, \"only implemented for bytes\");\n","filename":"src\/hotspot\/share\/opto\/memnode.cpp","additions":20,"deletions":13,"binary":false,"changes":33,"status":"modified"}]}