{"files":[{"patch":"@@ -46,1 +46,0 @@\n-    int invocation = 1;\n@@ -90,6 +89,9 @@\n-            OutputStream os = t.getResponseBody();\n-            PrintStream p = new PrintStream (os);\n-            p.println (\"<h2>Directory listing for: \" + path+ \"<\/h2>\");\n-            p.println (\"<ul>\");\n-            for (int i=0; i<list.length; i++) {\n-                p.println (\"<li><a href=\\\"\"+list[i]+\"\\\">\"+list[i]+\"<\/a><\/li>\");\n+            try (final OutputStream os = t.getResponseBody();\n+                 final PrintStream p = new PrintStream (os)) {\n+                p.println(\"<h2>Directory listing for: \" + path + \"<\/h2>\");\n+                p.println(\"<ul>\");\n+                for (int i = 0; i < list.length; i++) {\n+                    p.println(\"<li><a href=\\\"\" + list[i] + \"\\\">\" + list[i] + \"<\/a><\/li>\");\n+                }\n+                p.println(\"<\/ul><p><hr>\");\n+                p.flush();\n@@ -97,3 +99,0 @@\n-            p.println (\"<\/ul><p><hr>\");\n-            p.flush();\n-            p.close();\n@@ -108,2 +107,0 @@\n-            OutputStream os = t.getResponseBody();\n-            FileInputStream fis = new FileInputStream (f);\n@@ -111,1 +108,2 @@\n-            try {\n+            try (final OutputStream os = t.getResponseBody();\n+                 final FileInputStream fis = new FileInputStream (f)) {\n@@ -121,2 +119,0 @@\n-            fis.close();\n-            os.close();\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/FileServerHandler.java","additions":11,"deletions":15,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -64,1 +64,0 @@\n-        ExecutorService executor=null;\n@@ -67,1 +66,1 @@\n-        try {\n+        try (final ExecutorService executor = Executors.newCachedThreadPool()) {\n@@ -78,1 +77,0 @@\n-            executor = Executors.newCachedThreadPool();\n@@ -112,2 +110,6 @@\n-            if (executor != null)\n-                executor.shutdown();\n+            \/\/ it's OK to delete these files since the server side handlers\n+            \/\/ serving these files have completed (guaranteed by the completion of Executor.close())\n+            System.out.println(\"deleting \" + smallFilePath);\n+            Files.delete(smallFilePath);\n+            System.out.println(\"deleting \" + largeFilePath);\n+            Files.delete(largeFilePath);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/Test12.java","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"}]}