{"files":[{"patch":"@@ -29,1 +29,0 @@\n-#include <signal.h>\n@@ -148,1 +147,0 @@\n-    sigset_t unblock_signals;\n@@ -176,4 +174,0 @@\n-    \/\/ Reset any mask signals from parent\n-    sigemptyset(&unblock_signals);\n-    sigprocmask(SIG_SETMASK, &unblock_signals, NULL);\n-\n","filename":"src\/java.base\/unix\/native\/jspawnhelper\/jspawnhelper.c","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include <signal.h>\n@@ -408,0 +409,7 @@\n+    \/\/ Reset any mask signals from parent, but not in VFORK mode\n+    if (p->mode != MODE_VFORK) {\n+        sigset_t unblock_signals;\n+        sigemptyset(&unblock_signals);\n+        sigprocmask(SIG_SETMASK, &unblock_signals, NULL);\n+    }\n+\n","filename":"src\/java.base\/unix\/native\/libjava\/childproc.c","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -27,2 +27,2 @@\n- * @test\n- * @summary Verify Signal mask is cleared by ProcessBuilder start\n+ * @test id=posix_spawn\n+ * @summary Verify Signal mask is cleared by ProcessBuilder start when using posix_spawn mode\n@@ -33,2 +33,2 @@\n- * @run main\/othervm UnblockSignals\n- * @run main\/othervm -Xrs UnblockSignals\n+ * @run main\/othervm -Djdk.lang.Process.launchMechanism=POSIX_SPAWN UnblockSignals\n+ * @run main\/othervm -Djdk.lang.Process.launchMechanism=POSIX_SPAWN -Xrs UnblockSignals\n@@ -36,0 +36,12 @@\n+\n+\/*\n+ * @test id=fork\n+ * @summary Verify Signal mask is cleared by ProcessBuilder start when using fork mode\n+ * @bug 8357683\n+ * @requires (os.family == \"linux\" | os.family == \"mac\")\n+ * @comment Don't allow -Xcomp, it disturbs the relative timing of the sleep and kill commands\n+ * @requires (vm.compMode != \"Xcomp\")\n+ * @run main\/othervm -Djdk.lang.Process.launchMechanism=FORK UnblockSignals\n+ * @run main\/othervm -Djdk.lang.Process.launchMechanism=FORK -Xrs UnblockSignals\n+ *\/\n+\n","filename":"test\/jdk\/java\/lang\/ProcessBuilder\/UnblockSignals.java","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"}]}