{"files":[{"patch":"@@ -861,1 +861,2 @@\n-  assert(Thread::current()->osthread() == osthread,\n+  \/\/ FIXME: See NonJavaThread::post_run that clears Thread::current before we reach here!\n+  assert(Thread::current_or_null() == nullptr || Thread::current()->osthread() == osthread,\n","filename":"src\/hotspot\/os\/aix\/os_aix.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -768,1 +768,2 @@\n-  assert(Thread::current()->osthread() == osthread,\n+  \/\/ FIXME: See NonJavaThread::post_run that clears Thread::current before we reach here!\n+  assert(Thread::current_or_null() == nullptr || Thread::current()->osthread() == osthread,\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1184,1 +1184,2 @@\n-  assert(Thread::current()->osthread() == osthread,\n+  \/\/ FIXME: See NonJavaThread::post_run that clears Thread::current before we reach here!\n+  assert(Thread::current_or_null() == nullptr || Thread::current()->osthread() == osthread,\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -793,1 +793,2 @@\n-  assert(Thread::current()->osthread() == osthread,\n+  \/\/ FIXME: See NonJavaThread::post_run that clears Thread::current before we reach here!\n+  assert(Thread::current_or_null() == nullptr || Thread::current()->osthread() == osthread,\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -538,2 +538,6 @@\n-  os::create_thread(this, os::os_thread);\n-  os::start_thread(this);\n+  if (os::create_thread(this, os::os_thread)) {\n+    os::start_thread(this);\n+  } else {\n+    vm_exit_during_initialization(\"Unable to create archive worker\",\n+                                  os::native_thread_creation_failed_msg());\n+  }\n@@ -553,0 +557,5 @@\n+\n+void ArchiveWorkerThread::post_run() {\n+  this->NamedThread::post_run();\n+  delete this;\n+}\n","filename":"src\/hotspot\/share\/cds\/archiveUtils.cpp","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -375,0 +375,2 @@\n+  void post_run() override;\n+\n","filename":"src\/hotspot\/share\/cds\/archiveUtils.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-\/\/ Test a repeated cycle of pool start works.\n+\/\/ Test a repeated cycle of workers init\/shutdown without task works.\n","filename":"test\/hotspot\/gtest\/cds\/test_archiveWorkers.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}