{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,13 +25,28 @@\n-  @test\n-  @key headful\n-  @bug 7124430\n-  @summary Tests that SunToolkit.grab API works\n-  @author anton.tarasov@oracle.com: area=awt.toolkit\n-  @library ..\/..\/regtesthelpers\n-  @modules java.desktop\/sun.awt\n-  @build Util\n-  @run main GrabTest\n-*\/\n-\n-import java.awt.*;\n-import java.awt.event.*;\n+ * @test\n+ * @key headful\n+ * @bug 7124430\n+ * @summary Tests that SunToolkit.grab API works\n+ * @library ..\/..\/regtesthelpers\n+ * @modules java.desktop\/sun.awt\n+ * @build Util\n+ * @run main GrabTest\n+ *\/\n+\n+\n+import java.awt.AWTEvent;\n+import java.awt.Button;\n+import java.awt.Color;\n+import java.awt.FlowLayout;\n+import java.awt.Point;\n+import java.awt.event.ActionEvent;\n+import java.awt.event.ActionListener;\n+import java.awt.event.InputEvent;\n+import java.awt.event.MouseEvent;\n+import java.awt.Frame;\n+import java.awt.Robot;\n+import java.awt.Toolkit;\n+import java.awt.Window;\n+import java.awt.event.AWTEventListener;\n+import java.awt.event.MouseAdapter;\n+\n+import javax.swing.SwingUtilities;\n@@ -59,1 +74,4 @@\n-    public static void main(String[] args) {\n+    public static void main(String[] args) throws Exception {\n+\n+        robot = new Robot();\n+        robot.setAutoDelay(100);\n@@ -61,1 +79,2 @@\n-        Toolkit.getDefaultToolkit().addAWTEventListener(new AWTEventListener() {\n+        SwingUtilities.invokeAndWait(() -> {\n+            Toolkit.getDefaultToolkit().addAWTEventListener(new AWTEventListener() {\n@@ -70,3 +89,3 @@\n-        f = new Frame(\"Frame\");\n-        f.setBounds(0, 0, 300, 300);\n-        f.addMouseListener(new MouseAdapter() {\n+            f = new Frame(\"Frame\");\n+            f.setBounds(0, 0, 300, 300);\n+            f.addMouseListener(new MouseAdapter() {\n@@ -79,2 +98,2 @@\n-        f1 = new Frame(\"OtherFrame\");\n-        f1.setBounds(700, 100, 300, 300);\n+            f1 = new Frame(\"OtherFrame\");\n+            f1.setBounds(700, 100, 300, 300);\n@@ -82,4 +101,4 @@\n-        w = new Window(f);\n-        w.setLayout(new FlowLayout());\n-        b = new Button(\"Press\");\n-        b.addActionListener(new ActionListener() {\n+            w = new Window(f);\n+            w.setLayout(new FlowLayout());\n+            b = new Button(\"Press\");\n+            b.addActionListener(new ActionListener() {\n@@ -91,4 +110,4 @@\n-        w.add(b);\n-        w.setBounds(400, 100, 300, 300);\n-        w.setBackground(Color.blue);\n-        w.addMouseListener(new MouseAdapter() {\n+            w.add(b);\n+            w.setBounds(400, 100, 300, 300);\n+            w.setBackground(Color.blue);\n+            w.addMouseListener(new MouseAdapter() {\n@@ -101,2 +120,2 @@\n-        f.setVisible(true);\n-        w.setVisible(true);\n+            f.setVisible(true);\n+            w.setVisible(true);\n@@ -104,5 +123,5 @@\n-        frame = new Frame();\n-        window1 = new Window(frame);\n-        window1.setSize(200, 200);\n-        window1.setLocationRelativeTo(null);\n-        window1.setBackground(Color.blue);\n+            frame = new Frame();\n+            window1 = new Window(frame);\n+            window1.setSize(200, 200);\n+            window1.setLocationRelativeTo(null);\n+            window1.setBackground(Color.blue);\n@@ -110,4 +129,4 @@\n-        window2 = new Window(window1);\n-        window2.setSize(100, 100);\n-        window2.setLocationRelativeTo(null);\n-        window2.setBackground(Color.green);\n+            window2 = new Window(window1);\n+            window2.setSize(100, 100);\n+            window2.setLocationRelativeTo(null);\n+            window2.setBackground(Color.green);\n@@ -115,7 +134,2 @@\n-        tk = (sun.awt.SunToolkit)Toolkit.getDefaultToolkit();\n-\n-        try {\n-            robot = new Robot();\n-        } catch (AWTException ex) {\n-            throw new RuntimeException(ex);\n-        }\n+            tk = (sun.awt.SunToolkit)Toolkit.getDefaultToolkit();\n+        });\n@@ -124,1 +138,1 @@\n-\n+        robot.delay(500);\n@@ -134,0 +148,1 @@\n+\n@@ -154,0 +169,1 @@\n+\n@@ -176,0 +192,2 @@\n+        robot.delay(500);\n+\n@@ -177,0 +195,2 @@\n+        Util.waitForIdle(robot);\n+\n@@ -183,0 +203,1 @@\n+\n@@ -189,1 +210,0 @@\n-\n@@ -194,3 +214,3 @@\n-        robot.mousePress(InputEvent.BUTTON1_MASK);\n-        robot.delay(50);\n-        robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+\n+        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -198,0 +218,1 @@\n+\n@@ -221,0 +242,1 @@\n+        robot.delay(500);\n","filename":"test\/jdk\/java\/awt\/Window\/Grab\/GrabTest.java","additions":74,"deletions":52,"binary":false,"changes":126,"status":"modified"}]}