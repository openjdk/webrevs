{"files":[{"patch":"@@ -1862,4 +1862,0 @@\n-                    String msg = \"Insufficient buffer remaining for AEAD cipher \" +\n-                        \"fragment (\" + bb.remaining() + \"). Needs to be \" +\n-                        \"more than tag size (\" + tagSize + \")\";\n-\n@@ -1868,4 +1864,3 @@\n-                        msg = \"Unexpected plaintext alert received. This can happen\"\n-                            + \" during TLSv1.3 handshake if client doesn't receive\"\n-                            + \" server_hello due to network timeout and tries to\"\n-                            + \" close a connection by sending an alert message.\";\n+                        \/\/ In TLSv1.3 alert level can be ignored, we only get the alert.\n+                        final String msg = \"Unexpected plaintext alert received: \"\n+                                + Alert.nameOf(bb.get(bb.position() + 1));\n@@ -1876,1 +1871,0 @@\n-                    }\n@@ -1878,1 +1872,7 @@\n-                    throw new BadPaddingException(msg);\n+                        throw new GeneralSecurityException(msg);\n+                    } else {\n+                        throw new BadPaddingException(\n+                                \"Insufficient buffer remaining for AEAD cipher \" +\n+                                        \"fragment (\" + bb.remaining() + \"). Needs to be \" +\n+                                        \"more than tag size (\" + tagSize + \")\");\n+                    }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLCipher.java","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import java.security.GeneralSecurityException;\n@@ -42,1 +43,0 @@\n-import javax.crypto.BadPaddingException;\n@@ -46,1 +46,1 @@\n-import javax.net.ssl.SSLHandshakeException;\n+import javax.net.ssl.SSLProtocolException;\n@@ -64,4 +64,1 @@\n-        \"Unexpected plaintext alert received. This can happen\"\n-            + \" during TLSv1.3 handshake if client doesn't receive\"\n-            + \" server_hello due to network timeout and tries to\"\n-            + \" close a connection by sending an alert message.\";\n+            \"Unexpected plaintext alert received: user_canceled\";\n@@ -201,3 +198,3 @@\n-        } catch (SSLHandshakeException e) {\n-            assertEquals(e.getCause().getClass(), BadPaddingException.class);\n-            assertEquals(e.getCause().getMessage(), EXCEPTION_MSG);\n+        } catch (SSLProtocolException e) {\n+            assertEquals(GeneralSecurityException.class, e.getCause().getClass());\n+            assertEquals(EXCEPTION_MSG, e.getCause().getMessage());\n@@ -206,1 +203,1 @@\n-        fail();\n+        fail(\"Server should have thrown SSLProtocolException\");\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLCipher\/SSLEngineNoServerHelloClientShutdown.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import java.security.GeneralSecurityException;\n@@ -42,1 +43,0 @@\n-import javax.crypto.BadPaddingException;\n@@ -46,1 +46,1 @@\n-import javax.net.ssl.SSLHandshakeException;\n+import javax.net.ssl.SSLProtocolException;\n@@ -101,3 +101,3 @@\n-                assertEquals(serverException.getClass(), SSLHandshakeException.class);\n-                assertEquals(serverException.getCause().getClass(), BadPaddingException.class);\n-                assertEquals(serverException.getCause().getMessage(), EXCEPTION_MSG);\n+                assertEquals(SSLProtocolException.class, serverException.getClass());\n+                assertEquals(GeneralSecurityException.class, serverException.getCause().getClass());\n+                assertEquals(EXCEPTION_MSG, serverException.getCause().getMessage());\n@@ -105,1 +105,1 @@\n-                fail(\"Server should have thrown SSLHandshakeException\");\n+                fail(\"Server should have thrown SSLProtocolException\");\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLCipher\/SSLSocketNoServerHelloClientShutdown.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}