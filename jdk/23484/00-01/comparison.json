{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2016, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -724,2 +724,0 @@\n-  $1_JAVA_TOOL_OPTS := $$(addprefix -J, $$($1_VM_OPTIONS))\n-\n@@ -729,9 +727,1 @@\n-\t$(foreach jtool, javac javap jlink jar, \\\n-\t    $(info AOT: Create cache configuration for $(jtool)) \\\n-\t    $$(call ExecuteWithLog, $$($1_TEST_SUPPORT_DIR)\/aot.$(jtool), ( \\\n-\t        $$(FIXPATH) $(JDK_UNDER_TEST)\/bin\/$(jtool) $$($1_JAVA_TOOL_OPTS) \\\n-\t                    -J-XX:AOTMode=record -J-XX:AOTConfiguration=$$($1_AOT_JDK_CONF).$(jtool) --help \\\n-\t    ))\n-\t)\n-\n-\t$$(info AOT: Copy $(JDK_UNDER_TEST)\/lib\/classlist to $$($1_AOT_JDK_CONF).jdk )\n+\t$(info AOT: Create cache configuration) \\\n@@ -739,1 +729,3 @@\n-\t\t$$(FIXPATH) $(CP) $(JDK_UNDER_TEST)\/lib\/classlist $$($1_AOT_JDK_CONF).jdk \\\n+\t    $$(FIXPATH) $(JDK_UNDER_TEST)\/bin\/java $$($1_VM_OPTIONS) \\\n+\t                -XX:AOTMode=record -XX:AOTConfiguration=$$($1_AOT_JDK_CONF) \\\n+\t                'jdk.internal.misc.CDS$$$$TestTrainingApp' \\\n@@ -742,7 +734,0 @@\n-\t$$(FIXPATH) $$(CAT) $$($1_AOT_JDK_CONF).* > $$($1_AOT_JDK_CONF).temp\n-\t$$(FIXPATH) $$(CAT) $$($1_AOT_JDK_CONF).temp | $(GREP) -v '#' | $(GREP) -v '@' | $(SORT) | \\\n-\t        $(SED) -e 's\/id:.*\/\/g' | uniq \\\n-\t\t> $$($1_AOT_JDK_CONF)\n-\t$$(FIXPATH) $$(CAT) $$($1_AOT_JDK_CONF).temp | $(GREP) '@cp' | $(SORT) \\\n-\t        >> $$($1_AOT_JDK_CONF)\n-\n@@ -753,0 +738,1 @@\n+\t        -XX:ExtraSharedClassListFile=$(JDK_UNDER_TEST)\/lib\/classlist \\\n","filename":"make\/RunTests.gmk","additions":6,"deletions":20,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -389,2 +389,3 @@\n-      log_warning(cds)(\"This archive was created with AllowArchivingWithJavaAgent. It should be used \"\n-              \"for testing purposes only and should not be used in a production environment\");\n+      log_warning(cds)(\"This %s was created with AllowArchivingWithJavaAgent. It should be used \"\n+                       \"for testing purposes only and should not be used in a production environment\",\n+                       CDSConfig::type_of_archive_being_loaded());\n","filename":"src\/hotspot\/share\/cds\/dynamicArchive.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -966,0 +966,8 @@\n+  }\n+\n+  if (CDSConfig::is_dumping_final_static_archive()) {\n+    if (ExtraSharedClassListFile) {\n+      log_info(cds)(\"Loading extra classes from %s ...\", ExtraSharedClassListFile);\n+      ClassListParser::parse_classlist(ExtraSharedClassListFile,\n+                                       ClassListParser::_parse_all, CHECK);\n+    }\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -43,0 +43,1 @@\n+import java.util.spi.ToolProvider;\n@@ -452,0 +453,14 @@\n+\n+    public static class TestTrainingApp {\n+        static ClassLoader loader = jdk.internal.loader.ClassLoaders.appClassLoader();\n+        public static void main(String[] args) throws Throwable {\n+            String[] tools = {\n+                \"javac\", \"javap\", \"jlink\", \"jar\",\n+            };\n+            for (String tool : tools) {\n+                ToolProvider t  = ToolProvider.findFirst(tool)\n+                    .orElseThrow(() -> new RuntimeException(tool + \" not found\"));\n+                t.run(System.out, System.out, \"--help\");\n+            }\n+        }\n+    }\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/misc\/CDS.java","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -165,1 +165,1 @@\n-        output.shouldContain(\"Specified shared archive not found\");\n+        output.shouldContain(\"Specified shared archive file not found\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/TestAutoCreateSharedArchiveUpgrade.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}