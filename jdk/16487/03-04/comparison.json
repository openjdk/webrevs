{"files":[{"patch":"@@ -45,2 +45,0 @@\n-    private static final int INCREMENT = 64;\n-\n@@ -60,1 +58,1 @@\n-     * @return internal or new byte array of non-blocksize data.\n+     * @return internal buffer.\n@@ -62,2 +60,1 @@\n-    @Override\n-    public byte[] toByteArray() {\n+    public byte[] getBuffer() {\n@@ -76,2 +73,2 @@\n-            buf = Arrays.copyOf(buf, ArraysSupport.newLength(blen, blen + len,\n-                blen));\n+            buf = Arrays.copyOf(buf, ArraysSupport.newLength(blen,  len,\n+                Math.max(len, blen)));\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AEADBufferedStream.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -1615,1 +1615,1 @@\n-                ctPlusTag = cipherBuf.toByteArray();\n+                ctPlusTag = cipherBuf.getBuffer();\n@@ -1671,1 +1671,1 @@\n-                    ct = cipherBuf.toByteArray();\n+                    ct = cipherBuf.getBuffer();\n@@ -1676,1 +1676,1 @@\n-                    buf = cipherBuf.toByteArray();\n+                    buf = cipherBuf.getBuffer();\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/ChaCha20Cipher.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -845,1 +845,1 @@\n-                    byte[] aad = aadBuffer.toByteArray();\n+                    byte[] aad = aadBuffer.getBuffer();\n@@ -1133,1 +1133,1 @@\n-                byte[] buffer = ibuffer.toByteArray();\n+                byte[] buffer = ibuffer.getBuffer();\n@@ -1209,1 +1209,1 @@\n-                    ByteBuffer buffer = ByteBuffer.wrap(ibuffer.toByteArray(),\n+                    ByteBuffer buffer = ByteBuffer.wrap(ibuffer.getBuffer(),\n@@ -1271,1 +1271,1 @@\n-                byte[] buffer = ibuffer.toByteArray();\n+                byte[] buffer = ibuffer.getBuffer();\n@@ -1334,1 +1334,1 @@\n-                        ByteBuffer.wrap(ibuffer.toByteArray(), 0,\n+                        ByteBuffer.wrap(ibuffer.getBuffer(), 0,\n@@ -1409,1 +1409,1 @@\n-                byte[] buffer = ibuffer.toByteArray();\n+                byte[] buffer = ibuffer.getBuffer();\n@@ -1544,1 +1544,1 @@\n-                buffer = ByteBuffer.wrap(ibuffer.toByteArray(), 0,\n+                buffer = ByteBuffer.wrap(ibuffer.getBuffer(), 0,\n@@ -1661,1 +1661,1 @@\n-                buffer = ibuffer.toByteArray();\n+                buffer = ibuffer.getBuffer();\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/GaloisCounterMode.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"}]}