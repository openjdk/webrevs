{"files":[{"patch":"@@ -27,2 +27,0 @@\n- * @library .. \/test\/lib\n- * @build jdk.test.lib.Platform\n@@ -34,2 +32,1 @@\n-\n-import jdk.test.lib.Platform;\n+import java.nio.file.Files;\n@@ -38,0 +35,2 @@\n+import org.junit.jupiter.api.condition.EnabledOnOs;\n+import org.junit.jupiter.api.condition.OS;\n@@ -46,2 +45,1 @@\n-    private static final File DIR = new File(\".\", \"dir\");\n-    private static final File FILE = new File(DIR, \"file\");\n+    private static final File ROOT = new File(\".\");\n@@ -55,3 +53,15 @@\n-    void deleteReadOnlyRegularFile() throws IOException {\n-        assertTrue(DIR.mkdir());\n-        assertTrue(FILE.createNewFile());\n+    @EnabledOnOs({OS.AIX, OS.LINUX, OS.MAC})\n+    void deleteReadOnlyRegularFileUnix() throws IOException {\n+        File dir = Files.createTempDirectory(ROOT.toPath(), \"dir\").toFile();\n+        File file = File.createTempFile(\"tow\", \"hee\", dir);\n+\n+        file.setReadOnly();\n+        assertTrue(file.delete());\n+        assertTrue(dir.delete());\n+    }\n+\n+    @Test\n+    @EnabledOnOs({OS.WINDOWS})\n+    void deleteReadOnlyRegularFileWindows() throws IOException {\n+        File dir = Files.createTempDirectory(ROOT.toPath(), \"dir\").toFile();\n+        File file = File.createTempFile(\"tow\", \"hee\", dir);\n@@ -59,1 +69,1 @@\n-        FILE.setReadOnly();\n+        file.setReadOnly();\n@@ -61,3 +71,2 @@\n-        boolean deleted = FILE.delete();\n-        boolean shouldBeDeleted = !Platform.isWindows() || DELETE_READ_ONLY;\n-        assertEquals(shouldBeDeleted, deleted);\n+        boolean deleted = file.delete();\n+        assertEquals(DELETE_READ_ONLY, deleted);\n@@ -66,2 +75,2 @@\n-            FILE.setWritable(true);\n-            assertTrue(FILE.delete());\n+            file.setWritable(true);\n+            assertTrue(file.delete());\n@@ -70,1 +79,1 @@\n-        assertTrue(DIR.delete());\n+        assertTrue(dir.delete());\n@@ -75,2 +84,2 @@\n-        assertTrue(DIR.mkdir());\n-        deleteReadOnlyFile(DIR);\n+        File dir = Files.createTempDirectory(ROOT.toPath(), \"dir\").toFile();\n+        deleteReadOnlyFile(dir);\n","filename":"test\/jdk\/java\/io\/File\/DeleteReadOnly.java","additions":27,"deletions":18,"binary":false,"changes":45,"status":"modified"}]}