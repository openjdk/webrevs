{"files":[{"patch":"@@ -38,1 +38,0 @@\n-import java.security.ProviderException;\n@@ -191,5 +190,5 @@\n-        } else if (kdfParameterSpec instanceof HKDFParameterSpec.ExtractExpand) {\n-            HKDFParameterSpec.ExtractExpand anExtractExpand =\n-                (HKDFParameterSpec.ExtractExpand) kdfParameterSpec;\n-            ikms = anExtractExpand.ikms();\n-            salts = anExtractExpand.salts();\n+        } else if (kdfParameterSpec instanceof HKDFParameterSpec.ExtractThenExpand) {\n+            HKDFParameterSpec.ExtractThenExpand anExtractThenExpand =\n+                (HKDFParameterSpec.ExtractThenExpand) kdfParameterSpec;\n+            ikms = anExtractThenExpand.ikms();\n+            salts = anExtractThenExpand.salts();\n@@ -208,1 +207,1 @@\n-            if ((info = anExtractExpand.info()) == null) {\n+            if ((info = anExtractThenExpand.info()) == null) {\n@@ -212,1 +211,1 @@\n-            if ((length = anExtractExpand.length()) <= 0) {\n+            if ((length = anExtractThenExpand.length()) <= 0) {\n@@ -233,1 +232,1 @@\n-                    \"an HKDF ExtractExpand could not be initialized with the \"\n+                    \"an HKDF ExtractThenExpand could not be initialized with the \"\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/HkdfKeyDerivation.java","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -77,1 +77,1 @@\n-         * {@code ExtractExpand}\n+         * {@code ExtractThenExpand}\n@@ -84,1 +84,1 @@\n-         * @return an {@code ExtractExpand}\n+         * @return an {@code ExtractThenExpand}\n@@ -86,2 +86,2 @@\n-        public ExtractExpand andExpand(byte[] info, int length) {\n-            return new ExtractExpand(\n+        public ExtractThenExpand thenExpand(byte[] info, int length) {\n+            return new ExtractThenExpand(\n@@ -203,1 +203,1 @@\n-     * Returns a builder for building {@code Extract} and {@code ExtractExpand} objects.\n+     * Returns a builder for building {@code Extract}-Only and {@code ExtractThenExpand} objects.\n@@ -211,1 +211,1 @@\n-    static Builder builder() {\n+    static Builder buildExtract() {\n@@ -216,1 +216,1 @@\n-     * Static helper-method that may be used to initialize an {@code Expand}\n+     * Defines the input parameters of an {@code Expand}-Only\n@@ -231,1 +231,1 @@\n-    static Expand expand(SecretKey prk, byte[] info, int length) {\n+    static Expand expandOnly(SecretKey prk, byte[] info, int length) {\n@@ -242,1 +242,1 @@\n-     * Defines the input parameters of an Extract operation as defined in <a\n+     * Defines the input parameters of an Extract-Only operation as defined in <a\n@@ -305,1 +305,1 @@\n-            \/\/ a null prk could be indicative of ExtractExpand\n+            \/\/ a null prk could be indicative of ExtractThenExpand\n@@ -345,1 +345,1 @@\n-     * Defines the input parameters of an ExtractExpand operation as defined in\n+     * Defines the input parameters of an ExtractThenExpand operation as defined in\n@@ -349,1 +349,1 @@\n-    final class ExtractExpand implements HKDFParameterSpec {\n+    final class ExtractThenExpand implements HKDFParameterSpec {\n@@ -354,1 +354,1 @@\n-         * Constructor that may be used to initialize an {@code ExtractExpand}\n+         * Constructor that may be used to initialize an {@code ExtractThenExpand}\n@@ -368,1 +368,1 @@\n-        private ExtractExpand(Extract ext, byte[] info, int length) {\n+        private ExtractThenExpand(Extract ext, byte[] info, int length) {\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/spec\/HKDFParameterSpec.java","additions":14,"deletions":14,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-        var extractOnly = HKDFParameterSpec.builder().addIKM(ikm).addSalt(salt).extractOnly();\n+        var extractOnly = HKDFParameterSpec.buildExtract().addIKM(ikm).addSalt(salt).extractOnly();\n@@ -49,1 +49,1 @@\n-        var expandOnly = HKDFParameterSpec.expand(prk, info, len);\n+        var expandOnly = HKDFParameterSpec.expandOnly(prk, info, len);\n@@ -51,1 +51,1 @@\n-        var extractAndExpand = HKDFParameterSpec.builder().addIKM(ikm).addSalt(salt).andExpand(info, len);\n+        var extractAndExpand = HKDFParameterSpec.buildExtract().addIKM(ikm).addSalt(salt).thenExpand(info, len);\n@@ -64,3 +64,3 @@\n-        test(HKDFParameterSpec.builder().extractOnly());\n-        test(HKDFParameterSpec.builder().andExpand(new byte[0], 32));\n-        test(HKDFParameterSpec.builder().addIKM(ikm).addSalt(new byte[0]).extractOnly());\n+        test(HKDFParameterSpec.buildExtract().extractOnly());\n+        test(HKDFParameterSpec.buildExtract().thenExpand(new byte[0], 32));\n+        test(HKDFParameterSpec.buildExtract().addIKM(ikm).addSalt(new byte[0]).extractOnly());\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/KDF\/Functions.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -169,1 +169,1 @@\n-            HKDFParameterSpec.builder().addIKM(ikmKey)\n+            HKDFParameterSpec.buildExtract().addIKM(ikmKey)\n@@ -184,1 +184,1 @@\n-        KDFParameterSpec kdfParameterSpecExpand = HKDFParameterSpec.expand(\n+        KDFParameterSpec kdfParameterSpecExpand = HKDFParameterSpec.expandOnly(\n@@ -201,1 +201,1 @@\n-            HKDFParameterSpec.builder().addIKM(ikmKey)\n+            HKDFParameterSpec.buildExtract().addIKM(ikmKey)\n@@ -203,2 +203,2 @@\n-                             .andExpand(testData.info,\n-                                        testData.outLen);\n+                             .thenExpand(testData.info,\n+                                         testData.outLen);\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/KDF\/TestHKDF.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"}]}