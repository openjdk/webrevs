{"files":[{"patch":"@@ -0,0 +1,133 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import java.nio.CharBuffer;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.PrimitiveIterator.OfInt;\n+\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.Arguments;\n+import org.junit.jupiter.params.provider.MethodSource;\n+\n+\/*\n+ * @test\n+ * @summary tests the CharBuffer implementations behaving as CharSequence in various states (postion, limit, offset)\n+ * @run junit CharBufferAsCharSequenceTest\n+ *\/\n+public class CharBufferAsCharSequenceTest {\n+\n+    static List<Arguments> charBufferArguments() {\n+        List<Arguments> args = new ArrayList<>();\n+        char[] buf = new char[1273];\n+        for (int i = 0; i < buf.length; ++i) {\n+            buf[i] = (char) i;\n+        }\n+        String stringBuf = new String(buf);\n+\n+        for (int i = 0; i < 29; i += 7) {\n+            CharBuffer buffer = CharBuffer.wrap(buf, i, buf.length - i);\n+            args.add(Arguments.of(buffer, buf, i, buf.length, \"HeapCharBuffer index \" + i + \" to end\"));\n+            args.add(Arguments.of(buffer.slice(), buf, i, buf.length, \"HeapCharBuffer slice \" + i + \" to end\"));\n+\n+            args.add(Arguments.of(CharBuffer.wrap(new String(buf, i, buf.length - i)), buf, i, buf.length,\n+                    \"StringCharBuffer index \" + i + \" to end\"));\n+            buffer = CharBuffer.wrap(stringBuf);\n+            buffer.position(i);\n+            args.add(Arguments.of(buffer.slice(), buf, i, buf.length, \"StringCharBuffer slice \" + i + \" to end\"));\n+\n+            if (i > 0) {\n+                buffer = CharBuffer.wrap(buf, 1, buf.length - 1).slice();\n+                buffer.position(i - 1);\n+                args.add(Arguments.of(buffer, buf, i, buf.length,\n+                        \"HeapCharBuffer slice\/offset 1 index \" + (i - 1) + \" to end\"));\n+\n+                int end = buf.length - i;\n+\n+                buffer = CharBuffer.wrap(buf, i, buf.length - (2 * i));\n+                args.add(Arguments.of(buffer, buf, i, end, \"HeapCharBuffer index \" + i + \" to \" + end));\n+                args.add(Arguments.of(buffer.slice(), buf, i, end, \"HeapCharBuffer slice \" + i + \" to \" + end));\n+\n+                args.add(Arguments.of(CharBuffer.wrap(new String(buf, i, buf.length - (2 * i))), buf, i, end,\n+                        \"StringCharBuffer index \" + i + \" to \" + end));\n+                buffer = CharBuffer.wrap(stringBuf);\n+                buffer.position(i);\n+                buffer.limit(end);\n+                args.add(Arguments.of(buffer.slice(), buf, i, end, \"StringCharBuffer slice \" + i + \" to \" + end));\n+            }\n+        }\n+        return args;\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testToString(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        assertEquals(new String(expected, start, stop - start), actual.toString(), description);\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testLength(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        assertEquals(stop - start, actual.length(), description);\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testGetChars_range(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        char[] val = new char[16];\n+        actual.getChars(1, 5, val, 3);\n+\n+        for (int i = 0; i < 4; ++i) {\n+            assertEquals(expected[i + start + 1], val[i + 3], \"val at offset of \" + i + \" from \" + description);\n+        }\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testCharAt(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        for (int i = 0, j = stop - start; i < j; ++i) {\n+            assertEquals(expected[start + i], actual.charAt(i), \"chart at \" + i + \": \" + description);\n+        }\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testChars(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        OfInt chars = actual.chars().iterator();\n+        for (int i = 0, j = stop - start; i < j; ++i) {\n+            assertEquals(expected[start + i], (char) chars.nextInt(), \"chart at \" + i + \": \" + description);\n+        }\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"charBufferArguments\")\n+    void testSubSequence(CharSequence actual, char[] expected, int start, int stop, String description) {\n+        for (int i = 0; i < 7; ++i) {\n+            assertEquals(new String(expected, start + i, stop - start - (2 * i)),\n+                    actual.subSequence(i, actual.length() - i).toString(),\n+                    \"subsequence at index \" + i + \" for \" + description);\n+        }\n+    }\n+}\n","filename":"test\/jdk\/java\/nio\/Buffer\/CharBufferAsCharSequenceTest.java","additions":133,"deletions":0,"binary":false,"changes":133,"status":"added"}]}