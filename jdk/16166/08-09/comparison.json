{"files":[{"patch":"@@ -217,21 +217,0 @@\n-    private String getOutputBinValue(Attribute attr) {\n-        if (attr instanceof CustomOutputBin customOutputBin) {\n-            return customOutputBin.getChoiceName();\n-        } else if (attr instanceof OutputBin outputBin) {\n-            String name = outputBin.toString().replace('-', ' ');\n-            PrintService ps = getPrintService();\n-            if (ps == null) {\n-                return name;\n-            }\n-            OutputBin[] supportedBins = (OutputBin[]) ps.getSupportedAttributeValues(OutputBin.class, null, null);\n-            for (OutputBin bin : supportedBins) {\n-                CustomOutputBin customBin = (CustomOutputBin) bin;\n-                if (customBin.getCustomName().equalsIgnoreCase(name)) {\n-                    return customBin.getChoiceName();\n-                }\n-            }\n-            return name;\n-        }\n-        return null;\n-    }\n-\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/lwawt\/macosx\/CPrinterJob.java","additions":0,"deletions":21,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -64,0 +64,1 @@\n+import javax.print.attribute.standard.OutputBin;\n@@ -494,0 +495,1 @@\n+        mOptions = \"\";\n@@ -499,1 +501,1 @@\n-                mOptions = \" InputSlot=\"+ choice;\n+                mOptions += \" InputSlot=\"+ choice;\n@@ -502,0 +504,4 @@\n+        String outputBin = getOutputBinValue(outputBinAttr);\n+        if (outputBin != null) {\n+            mOptions += \" output-bin=\" + outputBin;\n+        }\n@@ -1646,1 +1652,3 @@\n-                execCmd[n++] = \"-o\" + options;\n+                for(String option: options.trim().split(\" \")) {\n+                    execCmd[n++] = \"-o \" + option;\n+                }\n@@ -1669,1 +1677,3 @@\n-                execCmd[n++] = \"-o\" + options;\n+                for(String option: options.trim().split(\" \")) {\n+                    execCmd[n++] = \"-o \" + option;\n+                }\n","filename":"src\/java.desktop\/share\/classes\/sun\/print\/PSPrinterJob.java","additions":13,"deletions":3,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2628,0 +2628,21 @@\n+\n+    protected String getOutputBinValue(Attribute attr) {\n+        if (attr instanceof CustomOutputBin customOutputBin) {\n+            return customOutputBin.getChoiceName();\n+        } else if (attr instanceof OutputBin outputBin) {\n+            String name = outputBin.toString().replace('-', ' ');\n+            PrintService ps = getPrintService();\n+            if (ps == null) {\n+                return name;\n+            }\n+            OutputBin[] supportedBins = (OutputBin[]) ps.getSupportedAttributeValues(OutputBin.class, null, null);\n+            for (OutputBin bin : supportedBins) {\n+                CustomOutputBin customBin = (CustomOutputBin) bin;\n+                if (customBin.getCustomName().equalsIgnoreCase(name)) {\n+                    return customBin.getChoiceName();\n+                }\n+            }\n+            return name;\n+        }\n+        return null;\n+    }\n","filename":"src\/java.desktop\/share\/classes\/sun\/print\/RasterPrinterJob.java","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2916,0 +2916,2 @@\n+                    } else if (outputBins.length == 1) {\n+                        cbOutput.setSelectedIndex(0);\n@@ -2917,1 +2919,0 @@\n-                }\n@@ -2919,1 +2920,2 @@\n-                outputEnabled = cbOutput.getItemCount() != 0;\n+                    outputEnabled = outputBins.length > 1;\n+                }\n","filename":"src\/java.desktop\/share\/classes\/sun\/print\/ServiceDialog.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -446,0 +446,1 @@\n+                outputBins = new OutputBin[0];\n@@ -466,1 +467,3 @@\n-                        outputBins = cps.getOutputBins();\n+                        outputBins = PrintServiceLookupProvider.isMac()\n+                                ? cps.getOutputBins()\n+                                : getSupportedOutputBins();\n@@ -500,0 +503,5 @@\n+\n+            if (outputBins == null) {\n+                outputBins = getSupportedOutputBins();\n+            }\n+\n@@ -1062,0 +1070,19 @@\n+    private OutputBin[] getSupportedOutputBins() {\n+        if ((getAttMap != null) && getAttMap.containsKey(\"output-bin-supported\")) {\n+\n+            AttributeClass attribClass = getAttMap.get(\"output-bin-supported\");\n+\n+            if (attribClass != null) {\n+                String[] values = attribClass.getArrayOfStringValues();\n+                if (values == null || values.length == 0) {\n+                    return null;\n+                }\n+                OutputBin[] outputBinNames = new OutputBin[values.length];\n+                for (int i = 0; i < values.length; i++) {\n+                    outputBinNames[i] = CustomOutputBin.createOutputBin(values[i], values[i]);\n+                }\n+                return outputBinNames;\n+            }\n+        }\n+        return null;\n+    }\n@@ -1079,0 +1106,5 @@\n+\n+                if (pra == OutputBin.TOP && (outputBins == null || outputBins.length == 0)) {\n+                    continue;\n+                }\n+\n@@ -1157,0 +1189,5 @@\n+        if (category == OutputBin.class\n+                && (outputBins == null || outputBins.length == 0)) {\n+            return false;\n+        }\n+\n@@ -1655,0 +1692,4 @@\n+        } else if (category == OutputBin.class) {\n+            if (attribClass != null) {\n+                return CustomOutputBin.createOutputBin(attribClass.getStringValue(), attribClass.getStringValue());\n+            }\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/IPPPrintService.java","additions":42,"deletions":1,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @requires (os.family == \"mac\")\n+ * @requires (os.family == \"linux\" | os.family == \"mac\")\n@@ -51,0 +51,1 @@\n+import java.util.Arrays;\n@@ -73,3 +74,6 @@\n-        OutputBin[] supportedOutputBins = getSupportedOutputBinttributes();\n-        if (supportedOutputBins.length < 1) {\n-            return;\n+        if (dialogTypeSelection == DialogTypeSelection.NATIVE) {\n+            String os = System.getProperty(\"os.name\").toLowerCase();\n+            if (os.startsWith(\"linux\")) {\n+                \/\/ The Linux native dialog is the same as the native\n+                return;\n+            }\n@@ -78,5 +82,4 @@\n-        \/\/ Test only the first and the last output bins to reduce number of tests\n-        final Set<OutputBin> outputBins = new HashSet<>();\n-        outputBins.add(supportedOutputBins[0]);\n-        outputBins.add(supportedOutputBins[supportedOutputBins.length - 1]);\n-\n+        final OutputBin[] supportedOutputBins = getSupportedOutputBinttributes();\n+        if (supportedOutputBins.length < 2) {\n+            return;\n+        }\n@@ -85,3 +88,3 @@\n-            testTotalCount = outputBins.size();\n-            for (OutputBin outputBin : outputBins) {\n-                testPrint(dialogTypeSelection, outputBin, outputBins);\n+            testTotalCount = supportedOutputBins.length;\n+            for (OutputBin outputBin : supportedOutputBins) {\n+                testPrint(dialogTypeSelection, outputBin, supportedOutputBins);\n@@ -199,1 +202,1 @@\n-    private static void testPrint(DialogTypeSelection dialogTypeSelection, OutputBin outputBin, Set<OutputBin> supportedOutputBins) {\n+    private static void testPrint(DialogTypeSelection dialogTypeSelection, OutputBin outputBin, OutputBin[] supportedOutputBins) {\n@@ -205,1 +208,1 @@\n-                supportedOutputBins.toString(),\n+                Arrays.toString(supportedOutputBins),\n","filename":"test\/jdk\/javax\/print\/attribute\/OutputBinAttributePrintDialogTest.java","additions":17,"deletions":14,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @requires (os.family == \"mac\")\n+ * @requires (os.family == \"linux\" | os.family == \"mac\")\n","filename":"test\/jdk\/javax\/print\/attribute\/OutputBinAttributeTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}