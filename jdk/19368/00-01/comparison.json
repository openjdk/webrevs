{"files":[{"patch":"@@ -2229,1 +2229,1 @@\n-  cmpdi(CCR0, r_bitmap, (bit + 1) & Klass::SECONDARY_SUPERS_TABLE_MASK);\n+  testbitdi(CCR0, \/* temp *\/ r_array_length, r_bitmap, (bit + 1) & Klass::SECONDARY_SUPERS_TABLE_MASK);\n@@ -2305,2 +2305,9 @@\n-    cmpdi(CCR0, result, 0);\n-    asm_assert_ne(\"result must be != 0 after lookup_secondary_supers_table\");\n+    {\n+      \/\/ We should only reach here after having found two bits in the bitmap.\n+      \/\/ Invariant: array_length == popcount(bitmap)\n+      Label ok;\n+      cmpdi(CCR0, r_array_length, 2);\n+      bge(CCR0, ok);\n+      stop(\"array_length too small\");\n+      bind(ok);\n+    }\n@@ -2311,2 +2318,1 @@\n-    sldi_(r_array_length, r_array_length, LogBytesPerWord);\n-    blt(CCR0, L_fallthrough); \/\/ length negative after decrement: failure (result != 0)\n+    sldi(r_array_length, r_array_length, LogBytesPerWord);\n","filename":"src\/hotspot\/cpu\/ppc\/macroAssembler_ppc.cpp","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"}]}