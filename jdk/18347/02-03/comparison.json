{"files":[{"patch":"@@ -1175,25 +1175,0 @@\n-        \/\/ Ensure offsets match\n-        if (st->is_StoreVectorScatter()) {\n-          const Node* offsets = st->as_StoreVectorScatter()->in(StoreVectorScatterNode::Offsets);\n-          if (!is_LoadVectorGather() || !offsets->eqv_uncast(as_LoadVectorGather()->in(LoadVectorGatherNode::Offsets))) {\n-            return nullptr;\n-          }\n-        \/\/ Ensure masks match\n-        } else if (st->is_StoreVectorMasked()) {\n-          const Node* mask = st->as_StoreVectorMasked()->in(StoreVectorMaskedNode::Mask);\n-          if (!is_LoadVectorMasked() || !mask->eqv_uncast(as_LoadVectorMasked()->in(LoadVectorMaskedNode::Mask))) {\n-            return nullptr;\n-          }\n-        \/\/ Ensure offsets and masks match\n-        } else if (st->is_StoreVectorScatterMasked()) {\n-          const StoreVectorScatterMaskedNode* stv = st->as_StoreVectorScatterMasked();\n-          const Node* offsets = stv->in(StoreVectorScatterMaskedNode::Offsets);\n-          const Node* mask = stv->in(StoreVectorScatterMaskedNode::Mask);\n-          if (!is_LoadVectorGatherMasked() ||\n-              !offsets->eqv_uncast(as_LoadVectorGatherMasked()->in(LoadVectorGatherMaskedNode::Offsets)) ||\n-              !mask->eqv_uncast(as_LoadVectorGatherMasked()->in(LoadVectorGatherMaskedNode::Mask))) {\n-            return nullptr;\n-          }\n-        } else {\n-          return nullptr;\n-        }\n@@ -3531,30 +3506,1 @@\n-        \/\/ Handle StoreVector with offsets and masks\n-        \/\/ Ensure offsets match\n-        if (is_StoreVectorScatter()) {\n-          const Node* offsets_store = as_StoreVectorScatter()->in(StoreVectorScatterNode::Offsets);\n-          const Node* offsets_load = val->as_LoadVectorGather()->in(LoadVectorGatherNode::Offsets);\n-          if (offsets_store->eqv_uncast(offsets_load)) {\n-            result = mem;\n-          }\n-        \/\/ Ensure masks match\n-        } else if (is_StoreVectorMasked()) {\n-          const Node* mask = as_StoreVectorMasked()->in(StoreVectorMaskedNode::Mask);\n-          if (val->is_LoadVectorMasked() && mask->eqv_uncast(val->as_LoadVectorMasked()->in(LoadVectorMaskedNode::Mask))) {\n-            result = mem;\n-          }\n-        \/\/ Ensure offsets and masks match\n-        } else if (is_StoreVectorScatterMasked()) {\n-          const StoreVectorScatterMaskedNode* stv = as_StoreVectorScatterMasked();\n-          const Node* offsets = stv->in(StoreVectorScatterMaskedNode::Offsets);\n-          const Node* mask = stv->in(StoreVectorScatterMaskedNode::Mask);\n-          if (val->is_LoadVectorGatherMasked()) {\n-            const LoadVectorGatherMaskedNode* lvgm = val->as_LoadVectorGatherMasked();\n-            if (offsets->eqv_uncast(lvgm->in(LoadVectorGatherMaskedNode::Offsets)) &&\n-              mask->eqv_uncast(lvgm->in(LoadVectorGatherMaskedNode::Mask))) {\n-              result = mem;\n-            }\n-          }\n-        \/\/ Regular store (no offsets or mask)\n-        } else {\n-          result = mem;\n-        }\n+    result = mem;\n","filename":"src\/hotspot\/share\/opto\/memnode.cpp","additions":1,"deletions":55,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -914,0 +914,4 @@\n+  virtual int store_Opcode() const {\n+    \/\/ Ensure it is different from any store opcode\n+    return Op_LoadVectorGather;\n+  }\n@@ -1014,0 +1018,4 @@\n+  virtual int store_Opcode() const {\n+    \/\/ Ensure it is different from any store opcode\n+    return Op_LoadVectorMasked;\n+  }\n@@ -1040,0 +1048,4 @@\n+  virtual int store_Opcode() const {\n+    \/\/ Ensure it is different from any store opcode\n+    return Op_LoadVectorGatherMasked;\n+  }\n","filename":"src\/hotspot\/share\/opto\/vectornode.hpp","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -151,1 +151,0 @@\n-    @Warmup(10000)\n@@ -160,1 +159,0 @@\n-    @Warmup(10000)\n@@ -169,1 +167,0 @@\n-    @Warmup(10000)\n@@ -178,1 +175,0 @@\n-    @Warmup(10000)\n@@ -187,1 +183,0 @@\n-    @Warmup(10000)\n@@ -196,1 +191,0 @@\n-    @Warmup(10000)\n@@ -205,1 +199,0 @@\n-    @Warmup(10000)\n@@ -214,1 +207,0 @@\n-    @Warmup(10000)\n@@ -223,1 +215,0 @@\n-    @Warmup(10000)\n@@ -235,1 +226,0 @@\n-    @Warmup(10000)\n@@ -244,1 +234,0 @@\n-    @Warmup(10000)\n@@ -253,1 +242,0 @@\n-    @Warmup(10000)\n@@ -262,1 +250,0 @@\n-    @Warmup(10000)\n@@ -271,1 +258,0 @@\n-    @Warmup(10000)\n@@ -280,1 +266,0 @@\n-    @Warmup(10000)\n@@ -289,1 +274,0 @@\n-    @Warmup(10000)\n@@ -298,1 +282,0 @@\n-    @Warmup(10000)\n@@ -307,1 +290,0 @@\n-    @Warmup(10000)\n@@ -319,1 +301,0 @@\n-    @Warmup(10000)\n@@ -328,1 +309,0 @@\n-    @Warmup(10000)\n@@ -337,1 +317,0 @@\n-    @Warmup(10000)\n@@ -346,1 +325,0 @@\n-    @Warmup(10000)\n@@ -355,1 +333,0 @@\n-    @Warmup(10000)\n@@ -364,1 +341,0 @@\n-    @Warmup(10000)\n@@ -373,1 +349,0 @@\n-    @Warmup(10000)\n@@ -382,1 +357,0 @@\n-    @Warmup(10000)\n@@ -391,1 +365,0 @@\n-    @Warmup(10000)\n@@ -403,1 +376,0 @@\n-    @Warmup(10000)\n@@ -412,1 +384,0 @@\n-    @Warmup(10000)\n@@ -421,1 +392,0 @@\n-    @Warmup(10000)\n@@ -430,1 +400,0 @@\n-    @Warmup(10000)\n@@ -439,1 +408,0 @@\n-    @Warmup(10000)\n@@ -448,1 +416,0 @@\n-    @Warmup(10000)\n@@ -457,1 +424,0 @@\n-    @Warmup(10000)\n@@ -466,1 +432,0 @@\n-    @Warmup(10000)\n@@ -475,1 +440,0 @@\n-    @Warmup(10000)\n@@ -489,1 +453,0 @@\n-    @Warmup(10000)\n@@ -500,1 +463,0 @@\n-    @Warmup(10000)\n@@ -511,1 +473,0 @@\n-    @Warmup(10000)\n@@ -522,1 +483,0 @@\n-    @Warmup(10000)\n@@ -533,1 +493,0 @@\n-    @Warmup(10000)\n@@ -544,1 +503,0 @@\n-    @Warmup(10000)\n@@ -555,1 +513,0 @@\n-    @Warmup(10000)\n@@ -566,1 +523,0 @@\n-    @Warmup(10000)\n@@ -577,1 +533,0 @@\n-    @Warmup(10000)\n@@ -591,1 +546,0 @@\n-    @Warmup(10000)\n@@ -602,1 +556,0 @@\n-    @Warmup(10000)\n@@ -613,1 +566,0 @@\n-    @Warmup(10000)\n@@ -624,1 +576,0 @@\n-    @Warmup(10000)\n@@ -635,1 +586,0 @@\n-    @Warmup(10000)\n@@ -646,1 +596,0 @@\n-    @Warmup(10000)\n@@ -657,1 +606,0 @@\n-    @Warmup(10000)\n@@ -668,1 +616,0 @@\n-    @Warmup(10000)\n@@ -679,1 +626,0 @@\n-    @Warmup(10000)\n@@ -693,1 +639,0 @@\n-    @Warmup(10000)\n@@ -704,1 +649,0 @@\n-    @Warmup(10000)\n@@ -715,1 +659,0 @@\n-    @Warmup(10000)\n@@ -726,1 +669,0 @@\n-    @Warmup(10000)\n@@ -737,1 +679,0 @@\n-    @Warmup(10000)\n@@ -748,1 +689,0 @@\n-    @Warmup(10000)\n@@ -759,1 +699,0 @@\n-    @Warmup(10000)\n@@ -770,1 +709,0 @@\n-    @Warmup(10000)\n@@ -781,1 +719,0 @@\n-    @Warmup(10000)\n@@ -795,1 +732,0 @@\n-    @Warmup(10000)\n@@ -806,1 +742,0 @@\n-    @Warmup(10000)\n@@ -817,1 +752,0 @@\n-    @Warmup(10000)\n@@ -828,1 +762,0 @@\n-    @Warmup(10000)\n@@ -839,1 +772,0 @@\n-    @Warmup(10000)\n@@ -850,1 +782,0 @@\n-    @Warmup(10000)\n@@ -861,1 +792,0 @@\n-    @Warmup(10000)\n@@ -872,1 +802,0 @@\n-    @Warmup(10000)\n@@ -883,1 +812,0 @@\n-    @Warmup(10000)\n@@ -895,1 +823,4 @@\n-        TestFramework.runWithFlags(\"--add-modules=jdk.incubator.vector\", \"-XX:+IncrementalInlineForceCleanup\");\n+        TestFramework testFramework = new TestFramework();\n+        testFramework.setDefaultWarmup(10000)\n+                     .addFlags(\"--add-modules=jdk.incubator.vector\", \"-XX:+IncrementalInlineForceCleanup\")\n+                     .start();\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/VectorGatherMaskFoldingTest.java","additions":4,"deletions":73,"binary":false,"changes":77,"status":"modified"}]}