{"files":[{"patch":"@@ -63,0 +63,5 @@\n+        \/\/ Defensive validation first\n+        if (host == null || host.isEmpty()) {\n+            throw new IllegalArgumentException(\"empty authority\");\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/java\/net\/HostPortrange.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -530,0 +530,3 @@\n+            if (authority == null || authority.isEmpty()) {\n+                throw new IllegalArgumentException(\"Invalid URL authority: empty host\");\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/net\/URLPermission.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -0,0 +1,69 @@\n+\/*\n+* Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+*\n+* This code is free software; you can redistribute it and\/or modify it\n+* under the terms of the GNU General Public License version 2 only, as\n+* published by the Free Software Foundation.\n+*\n+* This code is distributed in the hope that it will be useful, but WITHOUT\n+* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+* version 2 for more details (a copy is included in the LICENSE file that\n+* accompanied this code).\n+*\n+* You should have received a copy of the GNU General Public License version\n+* 2 along with this work; if not, write to the Free Software Foundation,\n+* Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+*\n+* Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+* or visit www.oracle.com if you need additional information or have any\n+* questions.\n+*\/\n+\n+\/*\n+* @test\n+* @bug 8367049\n+* @summary URLPermission must reject empty\/missing host authority with IAE (no SIOOBE)\n+* @run testng EmptyAuthorityTest\n+*\/\n+\n+import java.net.URLPermission;\n+import org.testng.Assert;\n+import org.testng.annotations.DataProvider;\n+import org.testng.annotations.Test;\n+\n+public class EmptyAuthorityTest {\n+\n+    @DataProvider(name = \"badUrls\")\n+    public Object[][] badUrls() {\n+        return new Object[][]{\n+                { \"http:\/\/\/path\" }, \/\/ empty authority\n+                { \"https:\/\/\/x\" }, \/\/ empty authority\n+                { \"http:\/\/@\/x\" }, \/\/ userinfo + empty host\n+                { \"http:\/\/user@\/x\" }, \/\/ userinfo + empty host\n+                { \"http:\/\/:80\/x\" }, \/\/ port with no host\n+                { \"http:\/\/[]\/x\" } \/\/ empty IPv6 literal\n+        };\n+    }\n+\n+    @DataProvider(name = \"goodUrls\")\n+    public Object[][] goodUrls() {\n+        return new Object[][]{\n+                { \"http:\/\/example.com\/x\" },\n+                { \"http:\/\/example.com:80\/x\" },\n+                { \"http:\/\/[::1]\/x\" },\n+                { \"http:\/\/[::1]:8080\/x\" }\n+        };\n+    }\n+\n+    @Test(dataProvider = \"badUrls\")\n+    public void rejectsEmptyOrMalformedAuthority(String url) {\n+        Assert.expectThrows(IllegalArgumentException.class, () -> new URLPermission(url));\n+    }\n+\n+    @Test(dataProvider = \"goodUrls\")\n+    public void acceptsValidAuthorities(String url) {\n+        new URLPermission(url); \/\/ should not throw\n+    }\n+}\n","filename":"test\/jdk\/java\/net\/URLPermission\/EmptyAuthorityTest.java","additions":69,"deletions":0,"binary":false,"changes":69,"status":"added"}]}