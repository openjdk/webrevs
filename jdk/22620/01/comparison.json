{"files":[{"patch":"@@ -90,5 +90,2 @@\n-# The test first suspends a vthread and all the carriers and then it resumes the vthread expecting it\n-# to run to completion. In mainline it only works because the suspension step happens while the vthread is\n-# pinned to the carrier blocked on synchronized. So the carrier only actually suspends on the next unmount\n-# transition which in this test happens once the vthread has finished executing the expected code.\n-\n+# Fails because resume of a virtual thread is not enough to allow the virtual thread\n+# to make progress when all other threads are currently suspended.\n@@ -97,6 +94,0 @@\n-###\n-# The test sends a StopThread to a vthread expecting that is currently pinned to the carrier blocked on\n-# synchronized. Since the vthread is now unmounted StopThread returns JVMTI_ERROR_OPAQUE_FRAME error.\n-\n-vmTestbase\/nsk\/jdb\/kill\/kill001\/kill001.java 8338714 generic-all\n-\n","filename":"test\/hotspot\/jtreg\/ProblemList-Virtual.txt","additions":2,"deletions":11,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+import jdk.test.lib.thread.VThreadPinner;\n@@ -155,0 +156,11 @@\n+        boolean vthreadMode = \"Virtual\".equals(System.getProperty(\"test.thread.factory\"));\n+        if (vthreadMode) {\n+            \/\/ JVMTI StopThread is only supported for mounted virtual threads. We need to\n+            \/\/ pin the virtual threads so they remain mounted.\n+            VThreadPinner.runPinned(() -> test());\n+        } else {\n+            test();\n+        }\n+    }\n+\n+    public void test() {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdb\/kill\/kill001\/kill001a.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -140,0 +140,3 @@\n+            \/* Some jdb tests need java.library.path setup for native libraries. *\/\n+            String libpath = System.getProperty(\"java.library.path\");\n+            args.add(\"-R-Djava.library.path=\" + libpath);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jdb\/Launcher.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}