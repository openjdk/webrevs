{"files":[{"patch":"@@ -83,4 +83,2 @@\n-        } catch (SocketException e) {\n-            if ((e.getCause() instanceof ClosedByInterruptException) && interruptible) {\n-                System.out.println(\"Got expected ClosedByInterruptException: \" + e);\n-            } else {\n+        } catch (SocketException | ClosedByInterruptException e) {\n+            if (!interruptible) {\n@@ -89,4 +87,1 @@\n-        } catch (ClosedByInterruptException e) {\n-            if (!interruptible)\n-                throw e;\n-            System.out.println(\"Got expected ClosedByInterruptException: \" + e);\n+            System.out.println(\"Got expected: \" + e);\n@@ -101,4 +96,1 @@\n-        if (Thread.currentThread().isVirtual()) {\n-            throw new jtreg.SkippedException(\n-                    \"skipping test execution - main thread is a virtual thread\");\n-        }\n+        final boolean isVirtualThread = Thread.currentThread().isVirtual();\n@@ -106,3 +98,6 @@\n-            System.out.println(\"Testing interrupt of DatagramSocket receive \" +\n-                    \"on endpoint \" + s.getLocalSocketAddress());\n-            test(s, false);\n+            System.out.println(\n+                    (isVirtualThread ? \"(virtual thread) \" : \"\")\n+                            + \"Testing interrupt of DatagramSocket receive \"\n+                            + \"on endpoint \" + s.getLocalSocketAddress()\n+            );\n+            test(s, isVirtualThread);\n@@ -111,3 +106,6 @@\n-            System.out.println(\"Testing interrupt of MulticastSocket receive\" +\n-                    \" on endpoint \" + s.getLocalSocketAddress());\n-            test(s, false);\n+            System.out.println(\n+                    (isVirtualThread ? \"(virtual thread) \" : \"\")\n+                            + \"Testing interrupt of MulticastSocket receive \"\n+                            + \"on endpoint \" + s.getLocalSocketAddress()\n+            );\n+            test(s, isVirtualThread);\n@@ -116,2 +114,5 @@\n-            System.out.println(\"Testing interrupt of DatagramChannel socket \" +\n-                    \"receive on endpoint \" + s.getLocalSocketAddress());\n+            System.out.println(\n+                    (isVirtualThread ? \"(virtual thread) \" : \"\")\n+                            + \"Testing interrupt of DatagramChannel socket \"\n+                            + \"receive on endpoint \" + s.getLocalSocketAddress()\n+            );\n","filename":"test\/jdk\/java\/net\/DatagramSocket\/InterruptibleDatagramSocket.java","additions":21,"deletions":20,"binary":false,"changes":41,"status":"modified"}]}