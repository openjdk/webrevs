{"files":[{"patch":"@@ -1,73 +0,0 @@\n-\/*\n- * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.io.Console;\n-import java.nio.file.Files;\n-import java.nio.file.Paths;\n-\n-import jdk.test.lib.process.OutputAnalyzer;\n-import jdk.test.lib.process.ProcessTools;\n-import static jdk.test.lib.Utils.*;\n-\n-\/**\n- * @test\n- * @bug 8264208 8265918 8356985\n- * @summary Tests Console.charset() method. \"expect\" command in Windows\/Cygwin\n- *          does not work as expected. Ignoring tests on Windows.\n- * @requires (os.family == \"linux\") | (os.family == \"mac\")\n- * @library \/test\/lib\n- * @run main CharsetTest en_US.ISO8859-1 ISO-8859-1\n- * @run main CharsetTest en_US.US-ASCII US-ASCII\n- * @run main CharsetTest en_US.UTF-8 UTF-8\n- *\/\n-public class CharsetTest {\n-    public static void main(String... args) throws Throwable {\n-        if (args.length == 0) {\n-            \/\/ no arg means child java process being tested.\n-            Console con = System.console();\n-            System.out.println(con.charset());\n-            return;\n-        } else {\n-            \/\/ check \"expect\" command availability\n-            var expect = Paths.get(\"\/usr\/bin\/expect\");\n-            if (!Files.exists(expect) || !Files.isExecutable(expect)) {\n-                throw new jtreg.SkippedException(\"'expect' command not found. Test ignored.\");\n-            }\n-\n-            \/\/ invoking \"expect\" command\n-            OutputAnalyzer output = ProcessTools.executeProcess(\n-                    \"expect\",\n-                    \"-n\",\n-                    TEST_SRC + \"\/script.exp\",\n-                    TEST_JDK + \"\/bin\/java\",\n-                    args[0],\n-                    args[1],\n-                    TEST_CLASSES);\n-            output.reportDiagnosticSummary();\n-            var eval = output.getExitValue();\n-            if (eval != 0) {\n-                throw new RuntimeException(\"Test failed. Exit value from 'expect' command: \" + eval);\n-            }\n-        }\n-    }\n-}\n","filename":"test\/jdk\/java\/io\/Console\/CharsetTest.java","additions":0,"deletions":73,"binary":false,"changes":73,"status":"deleted"},{"patch":"@@ -107,4 +107,1 @@\n-        var eval = output.getExitValue();\n-        if (eval != 0) {\n-            throw new RuntimeException(\"Test failed. Exit value from 'expect' command: \" + eval);\n-        }\n+        output.shouldHaveExitValue(0);\n","filename":"test\/jdk\/java\/io\/Console\/ConsolePromptTest.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,1 +35,0 @@\n-import static org.junit.jupiter.api.Assertions.*;\n@@ -75,1 +74,1 @@\n-        assertEquals(0, output.getExitValue());\n+        output.shouldHaveExitValue(0);\n","filename":"test\/jdk\/java\/io\/Console\/RestoreEchoTest.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import static org.junit.jupiter.api.Assertions.assertEquals;\n@@ -67,2 +66,1 @@\n-        var eval = output.getExitValue();\n-        assertEquals(0, eval, \"Test failed. Exit value from 'expect' command: \" + eval);\n+        output.shouldHaveExitValue(0);\n","filename":"test\/jdk\/java\/io\/Console\/StdinEncodingTest.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,75 @@\n+\/*\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+\n+import jdk.test.lib.process.OutputAnalyzer;\n+import jdk.test.lib.process.ProcessTools;\n+import static jdk.test.lib.Utils.*;\n+\n+import org.junit.jupiter.api.Assumptions;\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.CsvSource;\n+\n+\/**\n+ * @test\n+ * @bug 8264208 8265918 8356985 8358158\n+ * @summary Tests if \"stdout.encoding\" property is reflected in\n+ *          Console.charset() method. \"expect\" command in Windows\/Cygwin\n+ *          does not work as expected. Ignoring tests on Windows.\n+ * @requires (os.family == \"linux\") | (os.family == \"mac\")\n+ * @library \/test\/lib\n+ * @run junit StdoutEncodingTest\n+ *\/\n+public class StdoutEncodingTest {\n+\n+    @ParameterizedTest\n+    @CsvSource({\n+        \"en_US.ISO8859-1, ISO-8859-1\",\n+        \"en_US.US-ASCII, US-ASCII\",\n+        \"en_US.UTF-8, UTF-8\"\n+    })\n+    void testCharset(String locale, String expectedCharset) throws Exception {\n+        \/\/ check \"expect\" command availability\n+        var expect = Paths.get(\"\/usr\/bin\/expect\");\n+        Assumptions.assumeTrue(Files.exists(expect) && Files.isExecutable(expect),\n+            \"'\" + expect + \"' not found. Test ignored.\");\n+\n+        \/\/ invoking \"expect\" command\n+        OutputAnalyzer output = ProcessTools.executeProcess(\n+                \"expect\",\n+                \"-n\",\n+                TEST_SRC + \"\/stdoutEncoding.exp\",\n+                TEST_JDK + \"\/bin\/java\",\n+                locale,\n+                expectedCharset,\n+                TEST_CLASSES);\n+        output.reportDiagnosticSummary();\n+        output.shouldHaveExitValue(0);\n+    }\n+\n+    public static void main(String... args) {\n+        System.out.println(System.console().charset());\n+    }\n+}\n","filename":"test\/jdk\/java\/io\/Console\/StdoutEncodingTest.java","additions":75,"deletions":0,"binary":false,"changes":75,"status":"added"},{"patch":"@@ -1,32 +0,0 @@\n-#\n-# Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n-# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-#\n-# This code is free software; you can redistribute it and\/or modify it\n-# under the terms of the GNU General Public License version 2 only, as\n-# published by the Free Software Foundation.\n-#\n-# This code is distributed in the hope that it will be useful, but WITHOUT\n-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-# version 2 for more details (a copy is included in the LICENSE file that\n-# accompanied this code).\n-#\n-# You should have received a copy of the GNU General Public License version\n-# 2 along with this work; if not, write to the Free Software Foundation,\n-# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-#\n-# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n-# or visit www.oracle.com if you need additional information or have any\n-# questions.\n-#\n-\n-set java [lrange $argv 0 0]\n-set locale [lrange $argv 1 1]\n-set expected [lrange $argv 2 2]\n-set args [lrange $argv 3 end]\n-regexp {([a-zA-Z_]*).([a-zA-Z0-9\\-]*)} $locale dummy lang_region encoding\n-\n-eval spawn $java -Dstdout.encoding=$encoding -classpath $args CharsetTest\n-expect $expected\n-expect eof\n","filename":"test\/jdk\/java\/io\/Console\/script.exp","additions":0,"deletions":32,"binary":false,"changes":32,"status":"deleted"},{"patch":"@@ -0,0 +1,34 @@\n+#\n+# Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+# `expect` script for StdoutEncodingTest\n+\n+set java [lrange $argv 0 0]\n+set locale [lrange $argv 1 1]\n+set expected [lrange $argv 2 2]\n+set classpath [lrange $argv 3 end]\n+regexp {([a-zA-Z_]*).([a-zA-Z0-9\\-]*)} $locale dummy lang_region encoding\n+\n+eval spawn $java -Dstdout.encoding=$encoding -classpath $classpath StdoutEncodingTest\n+expect $expected\n+expect eof\n","filename":"test\/jdk\/java\/io\/Console\/stdoutEncoding.exp","additions":34,"deletions":0,"binary":false,"changes":34,"status":"added"}]}