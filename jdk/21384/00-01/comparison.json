{"files":[{"patch":"@@ -175,3 +175,2 @@\n-        \/*\n-         * A small ZIP using ZIP64. Since such a small ZIP64 file cannot\n-         * be produced using ZipOutputStream, it is included inline here.\n+        \/**\n+         * A small ZIP using the ZIP64 format.\n@@ -179,19 +178,2 @@\n-         * The file has the following structure:\n-         *\n-         * ------  Local File Header  ------\n-         * 000000  signature          0x04034b50\n-         * 000004  version            45\n-         * 000006  flags              0x0808\n-         * 000008  method             8              Deflated\n-         * 000010  time               0x542c         10:33:24\n-         * 000012  date               0x5947         2024-10-07\n-         * 000014  crc                0x00000000\n-         * 000018  csize              4294967295\n-         * 000022  size               4294967295\n-         * 000026  nlen               5\n-         * 000028  elen               20\n-         * 000030  name               5 bytes        'entry'\n-         * 000035  ext id             0x0001         Zip64 extended information extra field\n-         * 000037  ext size           16\n-         * 000039  z64 size           0\n-         * 000047  z64 csize          0\n+         * ZIP created using: \"echo -n hello | zip zip64.zip -\"\n+         * Hex encoded using: \"cat zip64.zip | xxd -ps\"\n@@ -199,2 +181,1 @@\n-         * ------  File Data  ------\n-         * 000055  data               7 bytes\n+         * The file has the following structure:\n@@ -202,5 +183,17 @@\n-         * ------  Data Descriptor  ------\n-         * 000062  signature          0x08074b50\n-         * 000066  crc                0x3610a686\n-         * 000070  csize              7\n-         * 000078  size               5\n+         * 0000 LOCAL HEADER #1       04034B50\n+         * 0004 Extract Zip Spec      2D '4.5'\n+         * 0005 Extract OS            00 'MS-DOS'\n+         * 0006 General Purpose Flag  0000\n+         * 0008 Compression Method    0000 'Stored'\n+         * 000A Last Mod Time         5947AB78 'Mon Oct  7 21:27:48 2024'\n+         * 000E CRC                   363A3020\n+         * 0012 Compressed Length     FFFFFFFF\n+         * 0016 Uncompressed Length   FFFFFFFF\n+         * 001A Filename Length       0001\n+         * 001C Extra Length          0014\n+         * 001E Filename              '-'\n+         * 001F Extra ID #0001        0001 'ZIP64'\n+         * 0021   Length              0010\n+         * 0023   Uncompressed Size   0000000000000006\n+         * 002B   Compressed Size     0000000000000006\n+         * 0033 PAYLOAD               hello.\n@@ -208,26 +201,23 @@\n-         * ------  Central Directory File Header  ------\n-         * 000086  signature          0x02014b50\n-         * 000090  made by version    45\n-         * 000092  extract version    45\n-         * 000094  flags              0x0808\n-         * 000096  method             8              Deflated\n-         * 000098  time               0x542c         10:33:24\n-         * 000100  date               0x5947         2024-10-07\n-         * 000102  crc                0x3610a686\n-         * 000106  csize              4294967295\n-         * 000110  size               4294967295\n-         * 000114  diskstart          65535\n-         * 000116  nlen               5\n-         * 000118  elen               32\n-         * 000120  clen               9\n-         * 000122  iattr              0x00\n-         * 000124  eattr              0x0000\n-         * 000128  loc offset         4294967295\n-         * 000132  name               5 bytes        'entry'\n-         * 000137  ext id             0x0001         Zip64 extended information extra field\n-         * 000139  ext size           28\n-         * 000141  z64 size           5\n-         * 000149  z64 csize          7\n-         * 000157  z64 locoff         0\n-         * 000165  z64 diskStart      0\n-         * 000169  comment            9 bytes        'A comment'\n+         * 0039 CENTRAL HEADER #1     02014B50\n+         * 003D Created Zip Spec      1E '3.0'\n+         * 003E Created OS            03 'Unix'\n+         * 003F Extract Zip Spec      2D '4.5'\n+         * 0040 Extract OS            00 'MS-DOS'\n+         * 0041 General Purpose Flag  0000\n+         * 0043 Compression Method    0000 'Stored'\n+         * 0045 Last Mod Time         5947AB78 'Mon Oct  7 21:27:48 2024'\n+         * 0049 CRC                   363A3020\n+         * 004D Compressed Length     00000006\n+         * 0051 Uncompressed Length   FFFFFFFF\n+         * 0055 Filename Length       0001\n+         * 0057 Extra Length          000C\n+         * 0059 Comment Length        0000\n+         * 005B Disk Start            0000\n+         * 005D Int File Attributes   0001\n+         *      [Bit 0]               1 Text Data\n+         * 005F Ext File Attributes   11B00000\n+         * 0063 Local Header Offset   00000000\n+         * 0067 Filename              '-'\n+         * 0068 Extra ID #0001        0001 'ZIP64'\n+         * 006A   Length              0008\n+         * 006C   Uncompressed Size   0000000000000006\n@@ -235,11 +225,13 @@\n-         * ------  Zip64 End of Central Directory Record  ------\n-         * 000178  signature          0x06064b50\n-         * 000182  record size        44\n-         * 000190  made by version    45\n-         * 000192  extract version    45\n-         * 000194  this disk          0\n-         * 000198  cen disk           0\n-         * 000202  entries            1\n-         * 000210  total entries      1\n-         * 000218  cen size           92\n-         * 000226  cen offset         86\n+         * 0074 ZIP64 END CENTRAL DIR 06064B50\n+         *      RECORD\n+         * 0078 Size of record        000000000000002C\n+         * 0080 Created Zip Spec      1E '3.0'\n+         * 0081 Created OS            03 'Unix'\n+         * 0082 Extract Zip Spec      2D '4.5'\n+         * 0083 Extract OS            00 'MS-DOS'\n+         * 0084 Number of this disk   00000000\n+         * 0088 Central Dir Disk no   00000000\n+         * 008C Entries in this disk  0000000000000001\n+         * 0094 Total Entries         0000000000000001\n+         * 009C Size of Central Dir   000000000000003B\n+         * 00A4 Offset to Central dir 0000000000000039\n@@ -247,5 +239,5 @@\n-         * ------  Zip64 End of Central Directory Locator  ------\n-         * 000234  signature          0x07064b50\n-         * 000238  eoc disk           0\n-         * 000242  eoc offset         178\n-         * 000250  total disks        1\n+         * 00AC ZIP64 END CENTRAL DIR 07064B50\n+         *      LOCATOR\n+         * 00B0 Central Dir Disk no   00000000\n+         * 00B4 Offset to Central dir 0000000000000074\n+         * 00BC Total no of Disks     00000001\n@@ -253,9 +245,8 @@\n-         * ------  End of Central Directory  ------\n-         * 000254  signature          0x06054b50\n-         * 000258  this disk          0\n-         * 000260  cen disk           0\n-         * 000262  entries disk       65535\n-         * 000264  entries total      65535\n-         * 000266  cen size           4294967295\n-         * 000270  cen offset         4294967295\n-         * 000274  clen               0\n+         * 00C0 END CENTRAL HEADER    06054B50\n+         * 00C4 Number of this disk   0000\n+         * 00C6 Central Dir Disk no   0000\n+         * 00C8 Entries in this disk  0001\n+         * 00CA Total Entries         0001\n+         * 00CC Size of Central Dir   0000003B\n+         * 00D0 Offset to Central Dir FFFFFFFF\n+         * 00D4 Comment Length        0000\n@@ -265,11 +256,9 @@\n-               504b03042d00080808002c54475900000000ffffffffffffffff05001400\n-               656e7472790100100000000000000000000000000000000000cb48cdc9c9\n-               0700504b070886a6103607000000000000000500000000000000504b0102\n-               2d002d00080808002c54475986a61036ffffffffffffffff050020000900\n-               ffff000000000000ffffffff656e74727901001c00050000000000000007\n-               000000000000000000000000000000000000004120636f6d6d656e74504b\n-               06062c000000000000002d002d0000000000000000000100000000000000\n-               01000000000000005c000000000000005600000000000000504b06070000\n-               0000b20000000000000001000000504b050600000000ffffffffffffffff\n-               ffffffff0000\n-               \"\"\".replaceAll(\"\\n\",\"\"));\n+                504b03042d000000000078ab475920303a36ffffffffffffffff01001400\n+                2d010010000600000000000000060000000000000068656c6c6f0a504b01\n+                021e032d000000000078ab475920303a3606000000ffffffff01000c0000\n+                00000001000000b011000000002d010008000600000000000000504b0606\n+                2c000000000000001e032d00000000000000000001000000000000000100\n+                0000000000003b000000000000003900000000000000504b060700000000\n+                740000000000000001000000504b050600000000010001003b000000ffff\n+                ffff0000\n+                \"\"\".replaceAll(\"\\n\",\"\"));\n@@ -279,5 +268,5 @@\n-        \/\/ Offset of the 'total entries' in the 'Zip64 End of Central Directory' record\n-        int totOffset = 210;\n-        \/\/ Update entry count to a value which cannot possibly fit in the small CEN\n-        buf.putLong(totOffset, MAX_CEN_SIZE \/ 3);\n-\n+        \/\/ Offset of the 'total entries' in the 'ZIP64 END CENTRAL DIR' record\n+        \/\/ Update ZIP64 entry count to a value which cannot possibly fit in the small CEN\n+        buf.putLong(0x94, MAX_CEN_SIZE \/ 3);\n+        \/\/ The corresponding END field needs the ZIP64 magic value\n+        buf.putShort(0xCA, (short) 0xFFFF);\n","filename":"test\/jdk\/java\/util\/zip\/ZipFile\/EndOfCenValidation.java","additions":85,"deletions":96,"binary":false,"changes":181,"status":"modified"}]}