{"files":[{"patch":"@@ -95,0 +95,2 @@\n+<li><a href=\"#graphviz-and-pandoc\" id=\"toc-graphviz-and-pandoc\">Graphviz\n+and Pandoc<\/a><\/li>\n@@ -865,0 +867,7 @@\n+<h3 id=\"graphviz-and-pandoc\">Graphviz and Pandoc<\/h3>\n+<p>In order to build the full docs (see the\n+<code>--enable-full-docs<\/code> configure option) <a\n+href=\"https:\/\/www.graphviz.org\">Graphviz<\/a> and <a\n+href=\"https:\/\/pandoc.org\">Pandoc<\/a> are required. Any recent versions\n+should work. For reference, and subject to change, Oracle builds use\n+Graphviz 9.0.0 and Pandoc 2.19.2.<\/p>\n","filename":"doc\/building.html","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -688,0 +688,8 @@\n+### Graphviz and Pandoc\n+\n+In order to build the full docs (see the `--enable-full-docs`\n+configure option) [Graphviz](https:\/\/www.graphviz.org) and\n+[Pandoc](https:\/\/pandoc.org) are required. Any recent versions should\n+work. For reference, and subject to change, Oracle builds use Graphviz\n+9.0.0 and Pandoc 2.19.2.\n+\n","filename":"doc\/building.md","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -444,1 +444,1 @@\n-            dependencies: [\"devkit\", \"gtest\", \"pandoc\"],\n+            dependencies: [\"devkit\", \"gtest\", \"graphviz\", \"pandoc\"],\n@@ -456,1 +456,1 @@\n-            dependencies: [\"devkit\", \"gtest\", \"pandoc\"],\n+            dependencies: [\"devkit\", \"gtest\", \"graphviz\", \"pandoc\"],\n@@ -489,1 +489,1 @@\n-            dependencies: [\"devkit\", \"gtest\", \"build_devkit\", \"pandoc\"],\n+            dependencies: [\"devkit\", \"gtest\", \"build_devkit\", \"graphviz\", \"pandoc\"],\n@@ -1240,1 +1240,1 @@\n-            revision: \"2.38.0-1+1.1\",\n+            revision: \"9.0.0+1.0\",\n","filename":"make\/conf\/jib-profiles.js","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-#!\/bin\/bash -e\n+#!\/bin\/bash\n@@ -3,1 +3,1 @@\n-# Copyright (c) 2017, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,22 +29,89 @@\n-TMPDIR=`mktemp -d -t graphvizbundle-XXXX`\n-trap \"rm -rf \\\"$TMPDIR\\\"\" EXIT\n-\n-ORIG_DIR=`pwd`\n-cd \"$TMPDIR\"\n-GRAPHVIZ_VERSION=2.38.0-1\n-PACKAGE_VERSION=1.1\n-TARGET_PLATFORM=linux_x64\n-BUNDLE_NAME=graphviz-$TARGET_PLATFORM-$GRAPHVIZ_VERSION+$PACKAGE_VERSION.tar.gz\n-wget http:\/\/www.graphviz.org\/pub\/graphviz\/stable\/redhat\/el6\/x86_64\/os\/graphviz-$GRAPHVIZ_VERSION.el6.x86_64.rpm\n-wget http:\/\/www.graphviz.org\/pub\/graphviz\/stable\/redhat\/el6\/x86_64\/os\/graphviz-libs-$GRAPHVIZ_VERSION.el6.x86_64.rpm\n-wget http:\/\/www.graphviz.org\/pub\/graphviz\/stable\/redhat\/el6\/x86_64\/os\/graphviz-plugins-core-$GRAPHVIZ_VERSION.el6.x86_64.rpm\n-wget http:\/\/www.graphviz.org\/pub\/graphviz\/stable\/redhat\/el6\/x86_64\/os\/graphviz-plugins-x-$GRAPHVIZ_VERSION.el6.x86_64.rpm\n-wget http:\/\/public-yum.oracle.com\/repo\/OracleLinux\/OL6\/latest\/x86_64\/getPackage\/libtool-ltdl-2.2.6-15.5.el6.x86_64.rpm\n-\n-mkdir graphviz\n-cd graphviz\n-for rpm in ..\/*.rpm; do\n-  rpm2cpio $rpm | cpio --extract --make-directories\n-done\n-\n-cat > dot << EOF\n+set -eux\n+\n+mydir=\"$(cd -- $(dirname ${BASH_SOURCE[0]}) && pwd)\"\n+me=\"${mydir}\/$(basename ${BASH_SOURCE[0]})\"\n+\n+EXPAT_VERSION=\"2.6.0\"\n+EXPAT_URL=\"https:\/\/github.com\/libexpat\/libexpat\/releases\/download\/R_${EXPAT_VERSION\/\/.\/_}\/expat-${EXPAT_VERSION}.tar.gz\"\n+EXPAT_SHA256=\"a13447b9aa67d7c860783fdf6820f33ebdea996900d6d8bbc50a628f55f099f7\"\n+\n+GRAPHVIZ_VERSION=\"9.0.0\"\n+GRAPHVIZ_URL=\"https:\/\/gitlab.com\/api\/v4\/projects\/4207231\/packages\/generic\/graphviz-releases\/${GRAPHVIZ_VERSION}\/graphviz-${GRAPHVIZ_VERSION}.tar.xz\"\n+GRAPHVIZ_SHA256=\"6c9afda06a732af7658c2619ee713d2545818c3ff19b7b8fd48effcd06d57bf6\"\n+\n+uname_s=\"$(uname -s)\"\n+case ${uname_s} in\n+    Linux)\n+        bundle_os=\"linux\"\n+        shacmd=\"sha256sum --strict --check -\"\n+        lib_path_var=\"LD_LIBRARY_PATH\"\n+        ;;\n+    Darwin)\n+        bundle_os=\"macosx\"\n+        shacmd=\"shasum -a 256 --strict --check -\"\n+        lib_path_var=\"DYLD_LIBRARY_PATH\"\n+        ;;\n+    *)\n+        echo \"Unknown OS: ${uname_s}\"\n+        exit 1\n+        ;;\n+esac\n+uname_m=\"$(uname -m)\"\n+case ${uname_m} in\n+    aarch64|arm64)\n+        bundle_cpu=\"aarch64\"\n+        ;;\n+    x86_64)\n+        bundle_cpu=\"x64\"\n+        ;;\n+esac\n+bundle_platform=\"${bundle_os}_${bundle_cpu}\"\n+\n+build_dir=\"${mydir}\/..\/..\/build\/graphviz\"\n+download_dir=\"${build_dir}\/download\"\n+install_dir=\"${build_dir}\/result\/graphviz-${bundle_platform}-${GRAPHVIZ_VERSION}\"\n+bundle_file=\"${install_dir}.tar.gz\"\n+\n+expat_dir=\"${build_dir}\/expat\"\n+expat_src_dir=\"${expat_dir}\/src\"\n+\n+graphviz_dir=\"${build_dir}\/graphviz\"\n+graphviz_src_dir=\"${graphviz_dir}\/src\"\n+graphviz_doc_dir=\"${install_dir}\/doc\"\n+\n+mkdir -p \"${build_dir}\"\n+cd \"${build_dir}\"\n+\n+download_and_unpack() {\n+    local url=\"$1\"\n+    local sha256=\"$2\"\n+    local file=\"$3\"\n+    local dir=\"$4\"\n+\n+    mkdir -p \"$(dirname \"${file}\")\"\n+    if [ ! -f \"${file}\" ]; then\n+        curl -L -o \"${file}\" \"${url}\"\n+    fi\n+    echo \"${sha256}  ${file}\" | ${shacmd}\n+    if [ ! -d \"${dir}\" ]; then\n+        mkdir -p \"${dir}\"\n+        tar --extract --file \"${file}\" --directory \"${dir}\" --strip-components 1\n+    fi\n+}\n+\n+download_and_unpack \"${EXPAT_URL}\" \"${EXPAT_SHA256}\" \"${download_dir}\/expat.tar.gz\" \"${expat_src_dir}\"\n+download_and_unpack \"${GRAPHVIZ_URL}\" \"${GRAPHVIZ_SHA256}\" \"${download_dir}\/graphviz.tar.gz\" \"${graphviz_src_dir}\"\n+\n+(\n+    cd \"${expat_src_dir}\"\n+    .\/configure --prefix=\"${install_dir}\"\n+    make -j install\n+)\n+\n+(\n+    cd \"${graphviz_src_dir}\"\n+    .\/configure --prefix=\"${install_dir}\" EXPAT_CFLAGS=\"-I${install_dir}\/include\" EXPAT_LIBS=\"-L${install_dir}\/lib -lexpat\"\n+    make -j install\n+)\n+\n+cat > \"${install_dir}\/dot\" << EOF\n@@ -53,4 +120,4 @@\n-this_script_dir=\\`dirname \\$0\\`\n-this_script_dir=\\`cd \\$this_script_dir > \/dev\/null && pwd\\`\n-export LD_LIBRARY_PATH=\"\\$this_script_dir\/usr\/lib64:\\$LD_LIBRARY_PATH\"\n-exec \\$this_script_dir\/usr\/bin\/dot \"\\$@\"\n+this_script_dir=\"\\$(dirname \\$0)\"\n+this_script_dir=\"\\$(cd \\${this_script_dir} > \/dev\/null && pwd)\"\n+export ${lib_path_var}=\"\\${this_script_dir}\/lib:\\${this_script_dir}\/lib\/graphviz\"\n+exec \"\\${this_script_dir}\/bin\/dot\" \"\\$@\"\n@@ -58,2 +125,1 @@\n-chmod +x dot\n-export LD_LIBRARY_PATH=\"$TMPDIR\/graphviz\/usr\/lib64:$LD_LIBRARY_PATH\"\n+chmod +x \"${install_dir}\/dot\"\n@@ -61,3 +127,5 @@\n-.\/dot -c\n-tar -cvzf ..\/$BUNDLE_NAME *\n-cp ..\/$BUNDLE_NAME \"$ORIG_DIR\"\n+\"${install_dir}\/dot\" -c\n+\n+cp \"${me}\" \"${install_dir}\"\n+\n+tar --create --gzip --file \"${bundle_file}\" -C \"${install_dir}\" .\n","filename":"make\/devkit\/createGraphvizBundle.sh","additions":101,"deletions":33,"binary":false,"changes":134,"status":"modified"}]}