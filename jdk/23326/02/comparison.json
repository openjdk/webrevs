{"files":[{"patch":"@@ -42,1 +42,0 @@\n-#include \"runtime\/perfData.inline.hpp\"\n@@ -391,3 +390,0 @@\n-    \/\/ Hopefully the performance counters are allocated on distinct\n-    \/\/ cache lines to avoid false sharing on MP systems ...\n-    OM_PERFDATA_OP(Inflations, inc());\n@@ -881,3 +877,0 @@\n-        \/\/ Hopefully the performance counters are allocated on distinct\n-        \/\/ cache lines to avoid false sharing on MP systems ...\n-        OM_PERFDATA_OP(Inflations, inc());\n@@ -922,3 +915,0 @@\n-    \/\/ Hopefully the performance counters are allocated on distinct\n-    \/\/ cache lines to avoid false sharing on MP systems ...\n-    OM_PERFDATA_OP(Inflations, inc());\n","filename":"src\/hotspot\/share\/runtime\/lightweightSynchronizer.cpp","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -52,1 +52,0 @@\n-#include \"runtime\/perfData.hpp\"\n@@ -651,2 +650,0 @@\n-\n-  OM_PERFDATA_OP(ContendedLockAttempts, inc());\n@@ -1021,8 +1018,0 @@\n-    \/\/ Keep a tally of the # of futile wakeups.\n-    \/\/ Note that the counter is not protected by a lock or updated by atomics.\n-    \/\/ That is by design - we trade \"lossy\" counters which are exposed to\n-    \/\/ races during updates for a lower probe effect.\n-    \/\/ We are in safepoint safe state, so shutdown can remove the counter\n-    \/\/ under our feet. Make sure we make this access safely.\n-    OM_PERFDATA_SAFE_OP(FutileWakeups, inc());\n-\n@@ -1141,6 +1130,0 @@\n-\n-    \/\/ Keep a tally of the # of futile wakeups.\n-    \/\/ Note that the counter is not protected by a lock or updated by atomics.\n-    \/\/ That is by design - we trade \"lossy\" counters which are exposed to\n-    \/\/ races during updates for a lower probe effect.\n-    OM_PERFDATA_OP(FutileWakeups, inc());\n@@ -1604,3 +1587,0 @@\n-\n-  \/\/ Maintain stats and report events to JVMTI\n-  OM_PERFDATA_OP(Parks, inc());\n@@ -2041,1 +2021,0 @@\n-  OM_PERFDATA_OP(Notifications, inc(tally));\n@@ -2070,2 +2049,0 @@\n-  OM_PERFDATA_OP(Notifications, inc(tally));\n-\n@@ -2510,8 +2487,0 @@\n-\/\/ PerfData support\n-PerfCounter * ObjectMonitor::_sync_ContendedLockAttempts       = nullptr;\n-PerfCounter * ObjectMonitor::_sync_FutileWakeups               = nullptr;\n-PerfCounter * ObjectMonitor::_sync_Parks                       = nullptr;\n-PerfCounter * ObjectMonitor::_sync_Notifications               = nullptr;\n-PerfCounter * ObjectMonitor::_sync_Inflations                  = nullptr;\n-PerfCounter * ObjectMonitor::_sync_Deflations                  = nullptr;\n-PerfLongVariable * ObjectMonitor::_sync_MonExtant              = nullptr;\n@@ -2534,23 +2503,0 @@\n-  if (UsePerfData) {\n-    EXCEPTION_MARK;\n-#define NEWPERFCOUNTER(n)                                                \\\n-  {                                                                      \\\n-    n = PerfDataManager::create_counter(SUN_RT, #n, PerfData::U_Events,  \\\n-                                        CHECK);                          \\\n-  }\n-#define NEWPERFVARIABLE(n)                                                \\\n-  {                                                                       \\\n-    n = PerfDataManager::create_variable(SUN_RT, #n, PerfData::U_Events,  \\\n-                                         CHECK);                          \\\n-  }\n-    NEWPERFCOUNTER(_sync_Inflations);\n-    NEWPERFCOUNTER(_sync_Deflations);\n-    NEWPERFCOUNTER(_sync_ContendedLockAttempts);\n-    NEWPERFCOUNTER(_sync_FutileWakeups);\n-    NEWPERFCOUNTER(_sync_Parks);\n-    NEWPERFCOUNTER(_sync_Notifications);\n-    NEWPERFVARIABLE(_sync_MonExtant);\n-#undef NEWPERFCOUNTER\n-#undef NEWPERFVARIABLE\n-  }\n-\n","filename":"src\/hotspot\/share\/runtime\/objectMonitor.cpp","additions":0,"deletions":54,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-#include \"runtime\/perfDataTypes.hpp\"\n@@ -221,38 +220,0 @@\n-  \/\/ Only perform a PerfData operation if the PerfData object has been\n-  \/\/ allocated and if the PerfDataManager has not freed the PerfData\n-  \/\/ objects which can happen at normal VM shutdown. This operation is\n-  \/\/ only safe when thread is not in safepoint-safe code, i.e. PerfDataManager\n-  \/\/ could not reach the safepoint and free the counter while we are using it.\n-  \/\/ If this is not guaranteed, use OM_PERFDATA_SAFE_OP instead.\n-  #define OM_PERFDATA_OP(f, op_str)                 \\\n-    do {                                            \\\n-      if (ObjectMonitor::_sync_ ## f != nullptr) {  \\\n-        if (PerfDataManager::has_PerfData()) {      \\\n-          ObjectMonitor::_sync_ ## f->op_str;       \\\n-        }                                           \\\n-      }                                             \\\n-    } while (0)\n-\n-  \/\/ Only perform a PerfData operation if the PerfData object has been\n-  \/\/ allocated and if the PerfDataManager has not freed the PerfData\n-  \/\/ objects which can happen at normal VM shutdown. Additionally, we\n-  \/\/ enter the critical section to resolve the race against PerfDataManager\n-  \/\/ entering the safepoint and deleting the counter during shutdown.\n-  #define OM_PERFDATA_SAFE_OP(f, op_str)            \\\n-    do {                                            \\\n-      if (ObjectMonitor::_sync_ ## f != nullptr) {  \\\n-        GlobalCounter::CriticalSection cs(Thread::current()); \\\n-        if (PerfDataManager::has_PerfData()) {      \\\n-          ObjectMonitor::_sync_ ## f->op_str;       \\\n-        }                                           \\\n-      }                                             \\\n-    } while (0)\n-\n-  static PerfCounter * _sync_ContendedLockAttempts;\n-  static PerfCounter * _sync_FutileWakeups;\n-  static PerfCounter * _sync_Parks;\n-  static PerfCounter * _sync_Notifications;\n-  static PerfCounter * _sync_Inflations;\n-  static PerfCounter * _sync_Deflations;\n-  static PerfLongVariable * _sync_MonExtant;\n-\n","filename":"src\/hotspot\/share\/runtime\/objectMonitor.hpp","additions":0,"deletions":39,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-#include \"runtime\/perfData.hpp\"\n@@ -379,1 +378,0 @@\n-      int free_count = 0;\n@@ -382,1 +380,0 @@\n-        ++free_count;\n@@ -384,1 +381,0 @@\n-      OM_PERFDATA_OP(Notifications, inc(free_count));\n@@ -1598,3 +1594,0 @@\n-      \/\/ Hopefully the performance counters are allocated on distinct cache lines\n-      \/\/ to avoid false sharing on MP systems ...\n-      OM_PERFDATA_OP(Inflations, inc());\n@@ -1640,3 +1633,0 @@\n-    \/\/ Hopefully the performance counters are allocated on distinct\n-    \/\/ cache lines to avoid false sharing on MP systems ...\n-    OM_PERFDATA_OP(Inflations, inc());\n@@ -1870,3 +1860,0 @@\n-  OM_PERFDATA_OP(MonExtant, set_value(_in_use_list.count()));\n-  OM_PERFDATA_OP(Deflations, inc(deflated_count));\n-\n","filename":"src\/hotspot\/share\/runtime\/synchronizer.cpp","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"}]}