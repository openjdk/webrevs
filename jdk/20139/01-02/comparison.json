{"files":[{"patch":"@@ -30,0 +30,1 @@\n+import java.util.*;\n@@ -44,0 +45,17 @@\n+    private static String[] args(String... add) {\n+        List<String> args = new ArrayList<>();\n+\n+         \/\/ Use PerMethodTrapLimit=0 to compile all branches in the intrinsics.\n+        args.add(\"-XX:PerMethodTrapLimit=0\");\n+\n+        \/\/ Forcefully inline all methods to reach the intrinsic code.\n+        args.add(\"-XX:CompileCommand=inline,compiler.c2.irTests.gc.ReferenceClearTests::*\");\n+        args.add(\"-XX:CompileCommand=inline,java.lang.ref.Reference::*\");\n+        args.add(\"-XX:CompileCommand=inline,java.lang.ref.PhantomReference::*\");\n+\n+        \/\/ Mix in test config code.\n+        args.addAll(Arrays.asList(add));\n+\n+        return args.toArray(new String[0]);\n+    }\n+\n@@ -47,2 +65,0 @@\n-        \/\/ Use PerMethodTrapLimit=0 to compile all branches in the intrinsics.\n-\n@@ -54,2 +70,1 @@\n-            framework.addScenarios(new Scenario(idx++,\n-                \"-XX:PerMethodTrapLimit=0\",\n+            framework.addScenarios(new Scenario(idx++, args(\n@@ -57,1 +72,1 @@\n-            ));\n+            )));\n@@ -63,4 +78,3 @@\n-            framework.addScenarios(new Scenario(idx++,\n-                \"-XX:PerMethodTrapLimit=0\",\n-                \"-XX:+UseParallelGC\")\n-            );\n+            framework.addScenarios(new Scenario(idx++, args(\n+                \"-XX:+UseParallelGC\"\n+            )));\n@@ -72,2 +86,1 @@\n-            framework.addScenarios(new Scenario(idx++,\n-                \"-XX:PerMethodTrapLimit=0\",\n+            framework.addScenarios(new Scenario(idx++, args(\n@@ -75,1 +88,1 @@\n-            ));\n+            )));\n@@ -81,2 +94,1 @@\n-            framework.addScenarios(new Scenario(idx++,\n-                \"-XX:PerMethodTrapLimit=0\",\n+            framework.addScenarios(new Scenario(idx++, args(\n@@ -87,1 +99,1 @@\n-            ));\n+            )));\n@@ -91,2 +103,1 @@\n-            framework.addScenarios(new Scenario(idx++,\n-                \"-XX:PerMethodTrapLimit=0\",\n+            framework.addScenarios(new Scenario(idx++, args(\n@@ -94,1 +105,1 @@\n-            ));\n+            )));\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/irTests\/gc\/ReferenceClearTests.java","additions":29,"deletions":18,"binary":false,"changes":47,"status":"modified"}]}