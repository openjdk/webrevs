{"files":[{"patch":"@@ -92,2 +92,3 @@\n-        String copyText = resources.getText(\"doclet.Copy_url_to_clipboard\");\n-        String copiedText = resources.getText(\"doclet.Copied_url_to_clipboard\");\n+        String copyText = resources.getText(\"doclet.Copy_to_clipboard\");\n+        String copiedText = resources.getText(\"doclet.Copied_to_clipboard\");\n+        String copyUrlText = resources.getText(\"doclet.Copy_url_to_clipboard\");\n@@ -120,1 +121,1 @@\n-                                        .put(HtmlAttr.ALT, copyText))\n+                                        .put(HtmlAttr.ALT, copyUrlText))\n@@ -124,0 +125,1 @@\n+                                .put(HtmlAttr.ARIA_LABEL, copyUrlText)\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/SearchWriter.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -714,2 +714,3 @@\n-        String copyText = resources.getText(\"doclet.Copy_snippet_to_clipboard\");\n-        String copiedText = resources.getText(\"doclet.Copied_snippet_to_clipboard\");\n+        String copyText = resources.getText(\"doclet.Copy_to_clipboard\");\n+        String copiedText = resources.getText(\"doclet.Copied_to_clipboard\");\n+        String copySnippetText = resources.getText(\"doclet.Copy_snippet_to_clipboard\");\n@@ -722,1 +723,1 @@\n-                                .put(HtmlAttr.ALT, copyText))\n+                                .put(HtmlAttr.ALT, copySnippetText))\n@@ -725,0 +726,1 @@\n+                        .put(HtmlAttr.ARIA_LABEL, copySnippetText)\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/TagletWriterImpl.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -42,17 +42,2 @@\n-        var textarea = document.createElement(\"textarea\");\n-        textarea.style.height = 0;\n-        document.body.appendChild(textarea);\n-        textarea.value = this.previousSibling.innerText;\n-        textarea.select();\n-        document.execCommand(\"copy\");\n-        document.body.removeChild(textarea);\n-        var span = this.lastElementChild;\n-        var copied = span.getAttribute(\"data-copied\");\n-        if (span.innerHTML !== copied) {\n-            var initialLabel = span.innerHTML;\n-            span.innerHTML = copied;\n-            var parent = this.parentElement.parentElement;\n-            parent.onmouseleave = parent.ontouchend = copy[0].onmouseenter = function() {\n-                span.innerHTML = initialLabel;\n-            };\n-        }\n+        copyToClipboard(this.previousSibling.innerText);\n+        switchCopyLabel(this, this.lastElementChild);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/resources\/search-page.js","additions":3,"deletions":18,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,3 @@\n-    copyUrl: \"##REPLACE:doclet.Copy_url_to_clipboard##\",\n-    urlCopied: \"##REPLACE:doclet.Copied_url_to_clipboard##\"\n+    copyToClipboard: \"##REPLACE:doclet.Copy_to_clipboard##\",\n+    copyUrlToClipboard: \"##REPLACE:doclet.Copy_url_to_clipboard##\",\n+    copiedToClipboard: \"##REPLACE:doclet.Copied_to_clipboard##\"\n@@ -410,8 +411,9 @@\n-    $(\"section[id] > :header, :header[id], :header:has(a[id])\").hover(\n-        function () {\n-            $(this).append($(\"<button class='copy copy-header' onclick='copyUrl(this)'> \" +\n-                \"<img src='\" + pathtoroot + \"copy.svg' alt='\" + messages.copyUrl + \"'> \" +\n-                \"<span data-copied='\" + messages.urlCopied + \"'><\/span><\/button>\"));\n-        },\n-        function () {\n-            $(this).find(\"button:last\").remove();\n+    $(\"section[id] > :header, :header[id], :header:has(a[id])\").each(function(idx, el) {\n+        \/\/ Create copy-to-clipboard buttons for headers with an associated id attribute\n+        var hdr = $(el);\n+        var id = hdr.attr(\"id\") || hdr.parent(\"section\").attr(\"id\") || hdr.children(\"a\").attr(\"id\");\n+        if (id) {\n+            hdr.append($(\"<button class='copy copy-header' onclick='copyUrl(this)' aria-label='\"\n+                + messages.copyUrlToClipboard +\"'> \" + \"<img src='\" + pathtoroot + \"copy.svg' alt='\" +\n+                messages.copyUrlToClipboard + \"'> \" + \"<span data-copied='\" + messages.copiedToClipboard +\n+                \"'>\" + messages.copyToClipboard + \"<\/span><\/button>\"));\n@@ -419,1 +421,1 @@\n-    );\n+    });\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/resources\/search.js.template","additions":14,"deletions":12,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -58,0 +58,2 @@\n+doclet.Copy_to_clipboard=Copy\n+doclet.Copied_to_clipboard=Copied!\n@@ -59,3 +61,1 @@\n-doclet.Copied_url_to_clipboard=Copied!\n-doclet.Copy_snippet_to_clipboard=Copy\n-doclet.Copied_snippet_to_clipboard=Copied!\n+doclet.Copy_snippet_to_clipboard=Copy snippet\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/doclets.properties","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -205,1 +205,1 @@\n-    switchCopyLabel(button.firstElementChild, button.parentElement);\n+    switchCopyLabel(button, button.firstElementChild);\n@@ -224,1 +224,1 @@\n-    switchCopyLabel(button.lastElementChild, button.parentElement);\n+    switchCopyLabel(button, button.lastElementChild);\n@@ -235,1 +235,1 @@\n-function switchCopyLabel(span, parent) {\n+function switchCopyLabel(button, span) {\n@@ -237,7 +237,11 @@\n-    if (span.innerHTML !== copied) {\n-        var initialLabel = span.innerHTML;\n-        span.innerHTML = copied;\n-        parent.onmouseleave = parent.ontouchend = function() {\n-            span.innerHTML = initialLabel;\n-        };\n-    }\n+    button.classList.add(\"visible\");\n+    var initialLabel = span.innerHTML;\n+    span.innerHTML = copied;\n+    setTimeout(function() {\n+        button.classList.remove(\"visible\");\n+        setTimeout(function() {\n+            if (initialLabel !== copied) {\n+                span.innerHTML = initialLabel;\n+            }\n+        }, 100);\n+    }, 1900);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/script.js","additions":15,"deletions":11,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -918,1 +918,1 @@\n-    opacity: 80%;\n+    opacity: 70%;\n@@ -923,1 +923,1 @@\n-    transition: opacity 0.2s;\n+    transition: opacity 0.3s;\n@@ -926,0 +926,3 @@\n+:hover > button.copy {\n+    opacity: 80%;\n+}\n@@ -927,1 +930,3 @@\n-button.copy:active {\n+button.copy:active,\n+button.copy:focus-visible,\n+button.copy.visible {\n@@ -945,0 +950,6 @@\n+    opacity: 0;\n+}\n+button.copy:hover span,\n+button.copy:focus-visible span,\n+button.copy.visible span {\n+    opacity: 100%;\n@@ -951,0 +962,1 @@\n+    opacity: 0;\n@@ -970,1 +982,0 @@\n-    content: attr(aria-label);\n@@ -974,1 +985,0 @@\n-    opacity: 0;\n@@ -976,1 +986,0 @@\n-div.page-search-info:hover button#page-search-copy,\n@@ -978,1 +987,1 @@\n-    opacity: 90%;\n+    opacity: 100%;\n@@ -986,1 +995,0 @@\n-    opacity: 50%;\n@@ -995,1 +1003,0 @@\n-    content: attr(aria-label);\n@@ -1000,1 +1007,0 @@\n-    display: none;\n@@ -1003,6 +1009,0 @@\n-    display: inline;\n-}\n-div.snippet-container:hover button.snippet-copy {\n-    opacity: 80%;\n-}\n-div.snippet-container button.snippet-copy:hover {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/stylesheet.css","additions":16,"deletions":16,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -132,1 +132,1 @@\n-        removeAll(styleSheetNames, \"css\", \"png\", \"w3\");\n+        removeAll(styleSheetNames, \"css\", \"png\", \"w3\", \"org\");\n@@ -141,1 +141,2 @@\n-                \"search-result-link\", \"two-column-search-results\", \"ui-static-link\");\n+                \"search-result-link\", \"two-column-search-results\", \"ui-static-link\",\n+                \"sort-asc\", \"sort-desc\", \"visible\");\n@@ -206,1 +207,1 @@\n-            Pattern p = Pattern.compile(\"(?i)(\\\\s|([a-z][a-z0-9-]*))\\\\.(?<name>[a-z][a-z0-9-]+)\\\\b\");\n+            Pattern p = Pattern.compile(\"(?i)\\\\.(?<name>[a-z][a-z0-9-]+)\\\\b\");\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/checkStylesheetClasses\/CheckStylesheetClasses.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -122,2 +122,3 @@\n-                <div class=\"snippet-container\"><button class=\"copy snippet-copy\" onclick=\"copySnippet(this)\">\\\n-                <span data-copied=\"Copied!\">Copy<\/span><img src=\"%s\" alt=\"Copy\"><\/button>\n+                <div class=\"snippet-container\"><button class=\"copy snippet-copy\" aria-label=\"Copy snippet\" \\\n+                onclick=\"copySnippet(this)\"><span data-copied=\"Copied!\">Copy<\/span><img src=\"%s\" alt=\"Copy \\\n+                snippet\"><\/button>\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testSnippetTag\/SnippetTester.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,0 +40,1 @@\n+import java.util.Optional;\n@@ -90,4 +91,1 @@\n-                        <div class=\"snippet-container\"><button class=\"copy snippet-copy\" onclick=\"copySnippet\\\n-                        (this)\"><span data-copied=\"Copied!\">Copy<\/span><img src=\"copy.svg\" alt=\"Copy\"><\/button>\n-                        <pre class=\"snippet\"><code class=\"language-java\">public class S { }<\/code><\/pre>\n-                        <\/div>\n+                        %s\n@@ -95,1 +93,2 @@\n-                         After.\"\"\");\n+                         After.\"\"\".formatted(getSnippetHtmlRepresentation(\"C.html\",\n+                        \"public class S { }\", Optional.of(\"java\"))));\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testSnippetTag\/TestSnippetUnnamedPackage.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"}]}