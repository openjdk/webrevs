{"files":[{"patch":"@@ -35,0 +35,3 @@\n+  static-suffix:\n+    description: 'Static bundle file name suffix'\n+    required: false\n@@ -39,0 +42,3 @@\n+  static-jdk-path:\n+    description: 'Path to the installed static JDK bundle'\n+    value: ${{ steps.path-name.outputs.static_jdk }}\n@@ -53,1 +59,1 @@\n-        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}\n+        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}\n@@ -60,1 +66,1 @@\n-        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}\n+        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}\n@@ -78,0 +84,14 @@\n+        if [[ '${{ inputs.static-suffix }}' != '' ]]; then\n+          if [[ -e bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.zip ]]; then\n+            echo 'Unpacking static jdk bundle...'\n+            mkdir -p bundles\/static-jdk\n+            unzip -q bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.zip -d bundles\/static-jdk\n+          fi\n+\n+          if [[ -e bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.tar.gz ]]; then\n+            echo 'Unpacking static jdk bundle...'\n+            mkdir -p bundles\/static-jdk\n+            tar -xf bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.tar.gz -C bundles\/static-jdk\n+          fi\n+        fi\n+\n@@ -109,0 +129,8 @@\n+\n+        if [[ '${{ inputs.static-suffix }}' != '' ]]; then\n+          static_jdk_dir=\"$GITHUB_WORKSPACE\/$(dirname $(find bundles\/static-jdk -name bin -type d))\"\n+          if [[ '${{ runner.os }}' == 'Windows' ]]; then\n+            static_jdk_dir=\"$(cygpath $static_jdk_dir)\"\n+          fi\n+          echo \"static_jdk=$static_jdk_dir\" >> $GITHUB_OUTPUT\n+        fi\n","filename":".github\/actions\/get-bundles\/action.yml","additions":30,"deletions":2,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -38,0 +38,3 @@\n+  static-suffix:\n+    description: 'Static JDK bundle name suffix, possibly empty'\n+    required: false\n@@ -49,0 +52,2 @@\n+        static_jdk_bundle_zip=\"$(ls build\/*\/bundles\/static-jdk-*_bin${{ inputs.debug-suffix }}.zip 2> \/dev\/null || true)\"\n+        static_jdk_bundle_tar_gz=\"$(ls build\/*\/bundles\/static-jdk-*_bin${{ inputs.debug-suffix }}.tar.gz 2> \/dev\/null || true)\"\n@@ -61,0 +66,6 @@\n+        if [[ \"$static_jdk_bundle_zip\" != \"\" ]]; then\n+          mv \"$static_jdk_bundle_zip\" \"bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.zip\"\n+        fi\n+        if [[ \"$static_jdk_bundle_tar_gz\" != \"\" ]]; then\n+          mv \"$static_jdk_bundle_tar_gz\" \"bundles\/jdk-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}.tar.gz\"\n+        fi\n@@ -81,1 +92,1 @@\n-        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.bundle-suffix }}\n+        name: bundles-${{ inputs.platform }}${{ inputs.debug-suffix }}${{ inputs.static-suffix }}${{ inputs.bundle-suffix }}\n","filename":".github\/actions\/upload-bundles\/action.yml","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -67,0 +67,3 @@\n+      static-suffix:\n+        required: false\n+        type: string\n@@ -146,0 +149,1 @@\n+          static-suffix: ${{ inputs.static-suffix }}\n","filename":".github\/workflows\/build-linux.yml","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -234,1 +234,1 @@\n-      make-target: 'static-jdk-image'\n+      make-target: 'static-jdk-bundles'\n@@ -241,3 +241,1 @@\n-      # It currently doesn't produce any bundles, but probably will do in\n-      # the future.\n-      bundle-suffix: \"-static\"\n+      static-suffix: \"-static\"\n@@ -364,0 +362,13 @@\n+      debug-suffix: -debug\n+\n+  test-linux-x64-static:\n+    name: linux-x64-static\n+    needs:\n+      - build-linux-x64\n+      - build-linux-x64-static\n+    uses: .\/.github\/workflows\/test.yml\n+    with:\n+      platform: linux-x64\n+      bootjdk-platform: linux-x64\n+      runs-on: ubuntu-22.04\n+      static-suffix: \"-static\"\n@@ -375,0 +386,1 @@\n+      debug-suffix: -debug\n@@ -385,0 +397,1 @@\n+      debug-suffix: -debug\n","filename":".github\/workflows\/main.yml","additions":17,"deletions":4,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -43,0 +43,6 @@\n+      debug-suffix:\n+        required: false\n+        type: string\n+      static-suffix:\n+        required: false\n+        type: string\n@@ -89,1 +95,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -93,1 +99,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -97,1 +103,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -101,1 +107,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -105,1 +111,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -109,1 +115,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -113,1 +119,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -117,1 +123,1 @@\n-            debug-suffix: -debug\n+            debug-suffix: ${{ inputs.debug-suffix }}\n@@ -143,0 +149,1 @@\n+          static-suffix: ${{ inputs.static-suffix }}\n@@ -163,0 +170,24 @@\n+          if [[ '${{ inputs.static-suffix }}' == '-static' ]]; then\n+            echo \"static-hotspot-problemlist-path=`pwd`\/test\/hotspot\/jtreg\/ProblemList-StaticJdk.txt\" >> $GITHUB_OUTPUT\n+            echo \"static-jdk-problemlist-path=`pwd`\/test\/jdk\/ProblemList-StaticJdk.txt\" >> $GITHUB_OUTPUT\n+            echo \"static-langtools-problemlist-path=`pwd`\/test\/langtools\/ProblemList-StaticJdk.txt\" >> $GITHUB_OUTPUT\n+            echo \"static-lib-test-problemlist-path=`pwd`\/test\/lib-test\/ProblemList-StaticJdk.txt\" >> $GITHUB_OUTPUT\n+          fi\n+\n+      - name: 'Run tests on static JDK'\n+        id: run-tests-static\n+        if: ${{ inputs.static-suffix == '-static' }}\n+        run: >\n+          make test-prebuilt\n+          TEST='${{ matrix.test-suite }}'\n+          BOOT_JDK=${{ steps.bootjdk.outputs.path }}\n+          JDK_UNDER_TEST=${{ steps.bundles.outputs.static-jdk-path }}\n+          JDK_FOR_COMPILE=${{ steps.bundles.outputs.jdk-path }}\n+          JT_HOME=${{ steps.jtreg.outputs.path }}\n+          JDK_IMAGE_DIR=${{ steps.bundles.outputs.jdk-path }}\n+          SYMBOLS_IMAGE_DIR=${{ steps.bundles.outputs.symbols-path }}\n+          TEST_IMAGE_DIR=${{ steps.bundles.outputs.tests-path }}\n+          JTREG='JAVA_OPTIONS=-XX:-CreateCoredumpOnCrash;VERBOSE=fail,error,time;KEYWORDS=!headful;EXTRA_PROBLEM_LISTS=${{ steps.path.outputs.static-hotspot-problemlist-path }}%20${{ steps.path.outputs.static-jdk-problemlist-path }}%20${{ steps.path.outputs.static-langtools-problemlist-path }}%20${{ steps.path.outputs.static-lib-test-problemlist-path }}'\n+          && bash .\/.github\/scripts\/gen-test-summary.sh \"$GITHUB_STEP_SUMMARY\" \"$GITHUB_OUTPUT\"\n+        env:\n+          PATH: ${{ steps.path.outputs.value }}\n@@ -166,0 +197,1 @@\n+        if: ${{ inputs.static-suffix != '-static' }}\n@@ -207,1 +239,1 @@\n-          artifact_name=\"results-${{ inputs.platform }}-$(echo ${{ matrix.test-name }} | tr '\/ ' '__')\"\n+          artifact_name=\"results-${{ inputs.platform }}-$(echo ${{ matrix.test-name }}${{ inputs.static-suffix }} | tr '\/ ' '__')\"\n@@ -224,0 +256,6 @@\n+\n+      - name: 'Notify about test failures on static JDK'\n+        uses: actions\/github-script@v7\n+        with:\n+          script: core.setFailed('${{ steps.run-tests-static.outputs.error-message }}')\n+        if: steps.run-tests-static.outputs.failure == 'true'\n","filename":".github\/workflows\/test.yml","additions":47,"deletions":9,"binary":false,"changes":56,"status":"modified"}]}