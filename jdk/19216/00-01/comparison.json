{"files":[{"patch":"@@ -31,0 +31,1 @@\n+ * @run main\/othervm -Djdk.net.hosts.file=TestHosts CaseSensitive no\n@@ -32,1 +33,1 @@\n- *      -Djdk.security.krb5.name.case.sensitive=true CaseSensitive\n+ *      -Djdk.security.krb5.name.case.sensitive=true CaseSensitive yes\n@@ -36,0 +37,1 @@\n+import org.ietf.jgss.GSSException;\n@@ -41,0 +43,5 @@\n+        switch (args[0]) {\n+            case \"yes\" -> testSensitive();\n+            case \"no\" -> testInsensitive();\n+        }\n+    }\n@@ -42,0 +49,1 @@\n+    static void testSensitive() throws Exception {\n@@ -43,1 +51,0 @@\n-        kdc.addPrincipal(\"HELLO\", \"different\".toCharArray());\n@@ -47,3 +54,17 @@\n-        Context c, s;\n-        c = Context.fromJAAS(\"client\");\n-        s = Context.fromJAAS(\"com.sun.security.jgss.krb5.accept\");\n+        Context c = Context.fromJAAS(\"client\");\n+        Context s = Context.fromJAAS(\"com.sun.security.jgss.krb5.accept\");\n+\n+        \/\/ There is only \"hello\". Cannot talk to \"HELLO\"\n+        c.startAsClient(\"HELLO\", GSSUtil.GSS_KRB5_MECH_OID);\n+        s.startAsServer(GSSUtil.GSS_KRB5_MECH_OID);\n+        try {\n+            Context.handshake(c, s);\n+            throw new RuntimeException(\"Should not succeed\");\n+        } catch(GSSException ge) {\n+            System.out.println(ge.getMessage());\n+            System.out.println(\"No HELLO in db. Expected\");\n+        }\n+\n+        \/\/ Add \"HELLO\". Can talk to \"HELLO\" now.\n+        kdc.addPrincipal(\"HELLO\", \"different\".toCharArray());\n+        kdc.writeKtab(OneKDC.KTAB);\n@@ -60,0 +81,1 @@\n+        \/\/ Can also talk to \"hello\", which has a different password.\n@@ -63,1 +85,0 @@\n-        \/\/ Name could be partial without realm, so only compare the beginning\n@@ -69,0 +90,18 @@\n+\n+    static void testInsensitive() throws Exception {\n+        var kdc = new OneKDC(null).writeJAASConf();\n+        kdc.addPrincipal(\"hello\", \"password\".toCharArray());\n+        kdc.writeKtab(OneKDC.KTAB);\n+\n+        Context c = Context.fromJAAS(\"client\");\n+        Context s = Context.fromJAAS(\"com.sun.security.jgss.krb5.accept\");\n+\n+        \/\/ There is only \"hello\" but we can talk to \"HELLO\".\n+        c.startAsClient(\"HELLO\", GSSUtil.GSS_KRB5_MECH_OID);\n+        s.startAsServer(GSSUtil.GSS_KRB5_MECH_OID);\n+        Context.handshake(c, s);\n+        Asserts.assertTrue(c.x().getTargName().toString().startsWith(\"HELLO\"),\n+                c.x().getTargName().toString());\n+        Asserts.assertTrue(s.x().getTargName().toString().startsWith(\"HELLO\"),\n+                s.x().getTargName().toString());\n+    }\n","filename":"test\/jdk\/sun\/security\/krb5\/auto\/CaseSensitive.java","additions":45,"deletions":6,"binary":false,"changes":51,"status":"modified"}]}