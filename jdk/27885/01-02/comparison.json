{"files":[{"patch":"@@ -60,0 +60,1 @@\n+   @Override\n@@ -61,2 +62,2 @@\n-      RISCV64ThreadContext context = (RISCV64ThreadContext) thread.getContext();\n-      Address rsp = context.getRegisterAsAddress(RISCV64ThreadContext.SP);\n+      return sender(thread, null, null);\n+   }\n@@ -64,2 +65,13 @@\n-      if ((fp == null) || fp.lessThan(rsp)) {\n-        return null;\n+   @Override\n+   public CFrame sender(ThreadProxy thread, Address nextFP, Address nextPC) {\n+      \/\/ Check fp\n+      \/\/ Skip if both nextFP and nextPC are given - do not need to load from fp.\n+      if (nextFP == null && nextPC == null) {\n+        if (fp == null) {\n+          return null;\n+        }\n+\n+        \/\/ Check alignment of fp\n+        if (dbg.getAddressValue(fp) % (2 * ADDRESS_SIZE) != 0) {\n+          return null;\n+        }\n@@ -68,2 +80,4 @@\n-      \/\/ Check alignment of fp\n-      if (dbg.getAddressValue(fp) % (2 * ADDRESS_SIZE) != 0) {\n+      if (nextFP == null) {\n+        nextFP = fp.getAddressAt(C_FRAME_LINK_OFFSET * ADDRESS_SIZE);\n+      }\n+      if (nextFP == null) {\n@@ -73,3 +87,2 @@\n-      Address nextFP = fp.getAddressAt(C_FRAME_LINK_OFFSET * ADDRESS_SIZE);\n-      if (nextFP == null || nextFP.lessThanOrEqual(fp)) {\n-        return null;\n+      if (nextPC == null) {\n+        nextPC = fp.getAddressAt(C_FRAME_RETURN_ADDR_OFFSET * ADDRESS_SIZE);\n@@ -77,1 +90,0 @@\n-      Address nextPC  = fp.getAddressAt(C_FRAME_RETURN_ADDR_OFFSET * ADDRESS_SIZE);\n@@ -81,0 +93,1 @@\n+\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/debugger\/linux\/riscv64\/LinuxRISCV64CFrame.java","additions":23,"deletions":10,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- * @requires (os.arch == \"amd64\" | os.arch == \"aarch64\")\n+ * @requires (os.arch == \"amd64\" | os.arch == \"aarch64\" | os.arch == \"riscv64\")\n@@ -69,1 +69,0 @@\n-        System.out.println(\"DEBUG: before loop\");\n@@ -73,1 +72,0 @@\n-                System.out.println(\"DEBUG: IN\");\n@@ -76,1 +74,0 @@\n-                System.out.println(\"DEBUG: OUT\");\n@@ -81,1 +78,0 @@\n-                System.out.println(\"DEBUG: \" + line);\n@@ -85,1 +81,0 @@\n-        System.out.println(\"DEBUG: after loop\");\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/TestJhsdbJstackMixedWithXComp.java","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"}]}