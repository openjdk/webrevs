{"files":[{"patch":"@@ -63,4 +63,8 @@\n-COMPARE_EXCEPTIONS_INCLUDE=\"$TOPDIR\/make\/scripts\/compare_exceptions.sh.incl\"\n-if [ ! -e \"$COMPARE_EXCEPTIONS_INCLUDE\" ]; then\n-    echo \"Error: Cannot locate the exceptions file, it should have been here: $COMPARE_EXCEPTIONS_INCLUDE\"\n-    exit 1\n+\n+if [ \"$OPENJDK_TARGET_OS\" = \"windows\" ]; then\n+  # We ship a pdb file inside a published zip. Such files can never be built\n+  # reproducibly, so ignore it.\n+  ACCEPTED_JARZIP_CONTENTS=\"\/modules_libs\/java.security.jgss\/w2k_lsa_auth.dll.pdb\"\n+elif [ \"$OPENJDK_TARGET_OS\" = \"macosx\" ]; then\n+  # Due to signing, we can never get a byte-by-byte identical build on macOS\n+  STRIP_TESTS_BEFORE_COMPARE=\"true\"\n@@ -68,2 +72,0 @@\n-# Include exception definitions\n-. \"$COMPARE_EXCEPTIONS_INCLUDE\"\n@@ -120,29 +122,0 @@\n-    if test \"x$SUFFIX\" = \"xclass\"; then\n-        if [ \"$NAME\" = \"SystemModules\\$all.class\" ] \\\n-           || [ \"$NAME\" = \"SystemModules\\$default.class\" ]; then\n-            # The SystemModules\\$*.classes are not comparable as they contain the\n-            # module hashes which would require a whole other level of\n-            # reproducible builds to get reproducible. There is also random\n-            # order of map initialization.\n-            TMP=\"\"\n-        elif [ \"$NAME\" = \"module-info.class\" ]; then\n-            # The module-info.class have several issues with random ordering of\n-            # elements in HashSets.\n-            MODULES_CLASS_FILTER=\"$SED \\\n-                -e 's\/,$\/\/' \\\n-                -e 's\/;$\/\/' \\\n-                -e 's\/^ *[0-9]*:\/\/' \\\n-                -e 's\/#[0-9]* *\/#\/' \\\n-                -e 's\/ *\\\/\\\/\/ \\\/\\\/\/' \\\n-                -e 's\/aload *[0-9]*\/aload X\/' \\\n-                -e 's\/ldc_w\/ldc  \/' \\\n-                | $SORT \\\n-                \"\n-            $JAVAP -c -constants -l -p \"${OTHER_FILE}\" \\\n-                | eval \"$MODULES_CLASS_FILTER\" >  ${OTHER_FILE}.javap &\n-            $JAVAP -c -constants -l -p \"${THIS_FILE}\" \\\n-                | eval \"$MODULES_CLASS_FILTER\" > ${THIS_FILE}.javap &\n-            wait\n-            TMP=$($DIFF ${OTHER_FILE}.javap ${THIS_FILE}.javap)\n-        fi\n-    fi\n@@ -322,9 +295,4 @@\n-    GENERAL_FILES=$(cd $THIS_DIR && $FIND . -type f ! -name \"*.so\" ! -name \"*.jar\" \\\n-        ! -name \"*.zip\" ! -name \"*.debuginfo\" ! -name \"*.dylib\" ! -name \"jexec\" \\\n-        ! -name \"modules\" ! -name \"ct.sym\" ! -name \"*.diz\" ! -name \"*.dll\" \\\n-        ! -name \"*.cpl\" ! -name \"*.pdb\" ! -name \"*.exp\" ! -name \"*.ilk\" \\\n-        ! -name \"*.lib\" ! -name \"*.jmod\" ! -name \"*.exe\" \\\n-        ! -name \"*.obj\" ! -name \"*.o\" ! -name \"jspawnhelper\" ! -name \"*.a\" \\\n-        ! -name \"*.tar.gz\" ! -name \"gtestLauncher\" \\\n-        ! -name \"*.map\" \\\n-        | $GREP -v \".\/bin\/\"  | $SORT | $FILTER)\n+    GENERAL_FILES=$(cd $THIS_DIR && $FIND . -type f ! -name \"*.pdb\" \\\n+        | $GREP -v \"\/hotspot\/gtest\/server\/gtestLauncher\" \\\n+        | $GREP -v \"\/hotspot\/gtest\/server\/libjvm.dylib\" \\\n+        | $SORT | $FILTER)\n@@ -453,0 +421,1 @@\n+        REGRESSIONS=true\n@@ -459,0 +428,1 @@\n+        REGRESSIONS=true\n@@ -487,0 +457,1 @@\n+            REGRESSIONS=true\n@@ -511,0 +482,1 @@\n+                REGRESSIONS=true\n@@ -550,0 +522,1 @@\n+        REGRESSIONS=true\n@@ -556,0 +529,1 @@\n+        REGRESSIONS=true\n@@ -581,1 +555,0 @@\n-                    return_value=1\n@@ -583,0 +556,1 @@\n+                    return_value=1\n@@ -609,1 +583,0 @@\n-                    return_value=1\n@@ -611,0 +584,1 @@\n+                    return_value=1\n@@ -639,1 +613,0 @@\n-                    return_value=1\n@@ -641,0 +614,1 @@\n+                    return_value=1\n@@ -1067,0 +1041,1 @@\n+                    REGRESSIONS=true\n@@ -1111,0 +1086,1 @@\n+                    REGRESSIONS=true\n","filename":"make\/scripts\/compare.sh","additions":23,"deletions":47,"binary":false,"changes":70,"status":"modified"},{"patch":"@@ -1,65 +0,0 @@\n-#!\/bin\/bash\n-#\n-# Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n-# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-#\n-# This code is free software; you can redistribute it and\/or modify it\n-# under the terms of the GNU General Public License version 2 only, as\n-# published by the Free Software Foundation.\n-#\n-# This code is distributed in the hope that it will be useful, but WITHOUT\n-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-# version 2 for more details (a copy is included in the LICENSE file that\n-# accompanied this code).\n-#\n-# You should have received a copy of the GNU General Public License version\n-# 2 along with this work; if not, write to the Free Software Foundation,\n-# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-#\n-# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n-# or visit www.oracle.com if you need additional information or have any\n-# questions.\n-#\n-\n-# This script is not to be run as stand-alone, it should be included from\n-# compare.sh.\n-\n-##########################################################################################\n-# Check that we are run via inclusion from compare.sh and not as stand-alone.\n-if [ -z \"$COMPARE_EXCEPTIONS_INCLUDE\" ]; then\n-    echo \"Error: This script should not be run as stand-alone. It is included by compare.sh\"\n-    exit 1\n-fi\n-\n-##########################################################################################\n-# Diff exceptions\n-\n-if [ \"$OPENJDK_TARGET_OS\" = \"linux\" ]; then\n-  if [ \"$USE_PRECOMPILED_HEADER\" = \"true\" ]; then\n-    ACCEPTED_BIN_DIFF=\"\n-        .\/lib\/server\/libjvm.so\n-        .\/hotspot\/gtest\/server\/libjvm.so\n-        \"\n-    STRIP_BEFORE_COMPARE=\"\n-        .\/hotspot\/gtest\/server\/libjvm.so\n-        \"\n-   fi\n-elif [ \"$OPENJDK_TARGET_OS\" = \"windows\" ]; then\n-  SKIP_BIN_DIFF=\"true\"\n-  SKIP_FULLDUMP_DIFF=\"true\"\n-  ACCEPTED_JARZIP_CONTENTS=\"\n-      \/modules_libs\/java.security.jgss\/w2k_lsa_auth.dll.pdb\n-      \/modules_libs\/java.security.jgss\/w2k_lsa_auth.dll.map\n-      \/modules_libs\/java.security.jgss\/w2k_lsa_auth.dll\n-      \"\n-elif [ \"$OPENJDK_TARGET_OS\" = \"macosx\" ]; then\n-  ACCEPTED_BIN_DIFF=\"\n-      .\/lib\/libawt_lwawt.dylib\n-      .\/lib\/libosxapp.dylib\n-      .\/lib\/libosxui.dylib\n-      .\/lib\/server\/libjvm.dylib\n-      .\/hotspot\/gtest\/server\/libjvm.dylib\n-      \"\n-  STRIP_TESTS_BEFORE_COMPARE=\"true\"\n-fi\n","filename":"make\/scripts\/compare_exceptions.sh.incl","additions":0,"deletions":65,"binary":false,"changes":65,"status":"modified"}]}