{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,0 +49,1 @@\n+    private static final int MAX_SKIP_BUFFER_SIZE = 2048;\n@@ -102,0 +103,26 @@\n+    @Override\n+    public synchronized long skip(long n) throws IOException {\n+        long remaining = n;\n+        int nr;\n+\n+        if (n <= 0) {\n+            return 0;\n+        }\n+\n+        int size = (int)Math.min(MAX_SKIP_BUFFER_SIZE, remaining);\n+        byte[] skipBuffer = new byte[size];\n+        while (remaining > 0) {\n+            if (server.isFinishing()) {\n+                break;\n+            }\n+            nr = readImpl(skipBuffer, 0, (int)Math.min(size, remaining));\n+            if (nr < 0) {\n+                eof = true;\n+                break;\n+            }\n+            remaining -= nr;\n+        }\n+\n+        return n - remaining;\n+    }\n+\n@@ -109,2 +136,0 @@\n-        int bufSize = 2048;\n-        byte[] db = new byte [bufSize];\n@@ -112,10 +137,3 @@\n-            if (server.isFinishing()) {\n-                break;\n-            }\n-            long len = readImpl (db, 0, bufSize);\n-            if (len == -1) {\n-                eof = true;\n-                return true;\n-            } else {\n-                l = l - len;\n-            }\n+            long skip = skip(l);\n+            if (skip <= 0) break; \/\/ might return 0 if isFinishing or EOF\n+            l -= skip;\n@@ -123,1 +141,1 @@\n-        return false;\n+        return eof;\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/LeftOverInputStream.java","additions":32,"deletions":14,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -162,1 +162,1 @@\n-            is.readAllBytes();\n+            is.skip(Integer.MAX_VALUE);\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/simpleserver\/FileServerHandler.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}