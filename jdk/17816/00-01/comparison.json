{"files":[{"patch":"@@ -122,1 +122,1 @@\n-        AlgorithmParameters ecParams = ECUtil.getECParameters(null);\n+        AlgorithmParameters ecParams = ECUtil.getECParameters();\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ec\/ECKeyPairGenerator.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2006, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2006, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -137,2 +137,8 @@\n-        NamedCurve spec = ECUtil.getECParameterSpec(params);\n-        if (spec != null) {\n+        DerValue encodedParams = new DerValue(params);\n+        if (encodedParams.tag == DerValue.tag_ObjectId) {\n+            ObjectIdentifier oid = encodedParams.getOID();\n+            NamedCurve spec = CurveDB.lookup(oid.toString());\n+            if (spec == null) {\n+                throw new IOException(\"Unknown named curve: \" + oid);\n+            }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/ECParameters.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2006, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2006, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -143,1 +143,1 @@\n-    public static AlgorithmParameters getECParameters(Provider p) {\n+    public static AlgorithmParameters getECParameters() {\n@@ -145,4 +145,0 @@\n-            if (p != null) {\n-                return AlgorithmParameters.getInstance(\"EC\", p);\n-            }\n-\n@@ -156,2 +152,5 @@\n-        NamedCurve curve = CurveDB.lookup(spec);\n-        if (curve == null) {\n+        AlgorithmParameters parameters = getECParameters();\n+\n+        try {\n+            parameters.init(spec);\n+        } catch (InvalidParameterSpecException ipse) {\n@@ -160,1 +159,7 @@\n-        return curve.getEncoded();\n+\n+        try {\n+            return parameters.getEncoded();\n+        } catch (IOException ioe) {\n+            \/\/ it is a bug if this should happen\n+            throw new RuntimeException(ioe);\n+        }\n@@ -164,1 +169,8 @@\n-        return CurveDB.lookup(spec);\n+        AlgorithmParameters parameters = getECParameters();\n+\n+        try {\n+            parameters.init(spec);\n+            return parameters.getParameterSpec(ECParameterSpec.class);\n+        } catch (InvalidParameterSpecException ipse) {\n+            return null;\n+        }\n@@ -167,1 +179,1 @@\n-    public static NamedCurve getECParameterSpec(byte[] params)\n+    public static ECParameterSpec getECParameterSpec(byte[] params)\n@@ -169,7 +181,3 @@\n-        DerValue encodedParams = new DerValue(params);\n-        if (encodedParams.tag == DerValue.tag_ObjectId) {\n-            ObjectIdentifier oid = encodedParams.getOID();\n-            NamedCurve spec = CurveDB.lookup(oid.toString());\n-            if (spec == null) {\n-                throw new IOException(\"Unknown named curve: \" + oid);\n-            }\n+        AlgorithmParameters parameters = getECParameters();\n+\n+        parameters.init(params);\n@@ -177,1 +185,4 @@\n-            return spec;\n+        try {\n+            return parameters.getParameterSpec(ECParameterSpec.class);\n+        } catch (InvalidParameterSpecException ipse) {\n+            return null;\n@@ -179,1 +190,0 @@\n-        return null;\n@@ -183,1 +193,8 @@\n-        return CurveDB.lookup(name);\n+        AlgorithmParameters parameters = getECParameters();\n+\n+        try {\n+            parameters.init(new ECGenParameterSpec(name));\n+            return parameters.getParameterSpec(ECParameterSpec.class);\n+        } catch (InvalidParameterSpecException ipse) {\n+            return null;\n+        }\n@@ -187,1 +204,9 @@\n-        return CurveDB.lookup(keySize);\n+        AlgorithmParameters parameters = getECParameters();\n+\n+        try {\n+            parameters.init(new ECKeySizeParameterSpec(keySize));\n+            return parameters.getParameterSpec(ECParameterSpec.class);\n+        } catch (InvalidParameterSpecException ipse) {\n+            return null;\n+        }\n+\n@@ -190,1 +215,1 @@\n-    public static String getCurveName(Provider p, ECParameterSpec spec) {\n+    public static String getCurveName(ECParameterSpec spec) {\n@@ -192,1 +217,1 @@\n-        AlgorithmParameters parameters = getECParameters(p);\n+        AlgorithmParameters parameters = getECParameters();\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/ECUtil.java","additions":49,"deletions":24,"binary":false,"changes":73,"status":"modified"}]}