{"files":[{"patch":"@@ -977,1 +977,0 @@\n-        int[] temp = new int[WB];\n@@ -984,10 +983,11 @@\n-            System.arraycopy(w, i * WB, temp, 0, WB);\n-            temp[0] = TMI0[temp[0] >>> 24] ^ TMI1[(temp[0] >> 16) & 0xFF]\n-                    ^ TMI2[(temp[0] >> 8) & 0xFF] ^ TMI3[temp[0] & 0xFF];\n-            temp[1] = TMI0[temp[1] >>> 24] ^ TMI1[(temp[1] >> 16) & 0xFF]\n-                    ^ TMI2[(temp[1] >> 8) & 0xFF] ^ TMI3[temp[1] & 0xFF];\n-            temp[2] = TMI0[temp[2] >>> 24] ^ TMI1[(temp[2] >> 16) & 0xFF]\n-                    ^ TMI2[(temp[2] >> 8) & 0xFF] ^ TMI3[temp[2] & 0xFF];\n-            temp[3] = TMI0[temp[3] >>> 24] ^ TMI1[(temp[3] >> 16) & 0xFF]\n-                    ^ TMI2[(temp[3] >> 8) & 0xFF] ^ TMI3[temp[3] & 0xFF];\n-            System.arraycopy(temp, 0, dw, kLen - (i * WB), WB);\n+            int widx = i * WB;\n+            int idx = kLen - widx;\n+\n+            dw[idx] = TMI0[w[widx] >>> 24] ^ TMI1[(w[widx] >> 16) & 0xFF]\n+                    ^ TMI2[(w[widx] >> 8) & 0xFF] ^ TMI3[w[widx] & 0xFF];\n+            dw[idx+1] = TMI0[w[widx+1] >>> 24] ^ TMI1[(w[widx+1] >> 16) & 0xFF]\n+                    ^ TMI2[(w[widx+1] >> 8) & 0xFF] ^ TMI3[w[widx+1] & 0xFF];\n+            dw[idx+2] = TMI0[w[widx+2] >>> 24] ^ TMI1[(w[widx+2] >> 16) & 0xFF]\n+                    ^ TMI2[(w[widx+2] >> 8) & 0xFF] ^ TMI3[w[widx+2] & 0xFF];\n+            dw[idx+3] = TMI0[w[widx+3] >>> 24] ^ TMI1[(w[widx+3] >> 16) & 0xFF]\n+                    ^ TMI2[(w[widx+3] >> 8) & 0xFF] ^ TMI3[w[widx+3] & 0xFF];\n@@ -997,1 +997,0 @@\n-        Arrays.fill(temp, 0);\n@@ -1011,4 +1010,3 @@\n-        byte b0 = (byte) (word >>> 24);\n-        byte b1 = (byte) ((word >> 16) & 0xFF);\n-        byte b2 = (byte) ((word >> 8) & 0xFF);\n-        byte b3 = (byte) (word & 0xFF);\n+        byte b0 = (byte) (word >> 24);\n+        byte b1 = (byte) (word >> 16);\n+        byte b2 = (byte) (word >> 8);\n@@ -1019,1 +1017,1 @@\n-                | (SBOX[(b3 & 0xF0) >> 4][b3 & 0x0F] & 0xFF);\n+                | (SBOX[(word & 0xF0) >> 4][word & 0x0F] & 0xFF);\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":15,"deletions":17,"binary":false,"changes":32,"status":"modified"}]}