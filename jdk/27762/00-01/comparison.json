{"files":[{"patch":"@@ -45,0 +45,1 @@\n+#include \"utilities\/deferredStatic.hpp\"\n@@ -170,1 +171,1 @@\n-  static OSXSemaphore* sr_semaphore;\n+  static DeferredStatic<OSXSemaphore> sr_semaphore;\n@@ -172,1 +173,1 @@\n-  static PosixSemaphore* sr_semaphore;\n+  static DeferredStatic<PosixSemaphore> sr_semaphore;\n@@ -180,1 +181,1 @@\n-static Semaphore* sig_semaphore = nullptr;\n+static DeferredStatic<Semaphore> sig_semaphore;\n@@ -354,1 +355,2 @@\n-  sig_semaphore = new Semaphore();\n+  int sem_count = 0;\n+  sig_semaphore.initialize(sem_count);\n@@ -358,1 +360,4 @@\n-  if (sig_semaphore != nullptr) {\n+    \/\/ Signal thread is not created with ReduceSignalUsage and jdk_misc_signal_init\n+    \/\/ initialization isn't called. This code is also never called.\n+    assert(!ReduceSignalUsage, \"Should not reach here if ReduceSignalUsage is set\");\n+\n@@ -361,5 +366,0 @@\n-  } else {\n-    \/\/ Signal thread is not created with ReduceSignalUsage and jdk_misc_signal_init\n-    \/\/ initialization isn't called.\n-    assert(ReduceSignalUsage, \"signal semaphore should be created\");\n-  }\n@@ -1734,5 +1734,2 @@\n-#if defined(__APPLE__)\n-  sr_semaphore = new OSXSemaphore(0);\n-#else\n-  sr_semaphore = new PosixSemaphore(0);\n-#endif\n+  int sem_count = 0;\n+  sr_semaphore.initialize(sem_count);\n","filename":"src\/hotspot\/os\/posix\/signals_posix.cpp","additions":12,"deletions":15,"binary":false,"changes":27,"status":"modified"}]}