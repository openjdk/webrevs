{"files":[{"patch":"@@ -3300,4 +3300,18 @@\n-  MEMORYSTATUSEX ms;\n-  ms.dwLength = sizeof(ms);\n-  GlobalMemoryStatusEx(&ms);\n-  return (size_t)ms.ullAvailVirtual;\n+  JOBOBJECT_EXTENDED_LIMIT_INFORMATION jeli = {};\n+  BOOL res = QueryInformationJobObject(nullptr, JobObjectExtendedLimitInformation, &jeli, sizeof(jeli), nullptr);\n+\n+  \/\/ If there was an error calling QueryInformationJobObject, conservatively assume no limit.\n+  if (!res) {\n+    return SIZE_MAX;\n+  }\n+\n+  if (jeli.BasicLimitInformation.LimitFlags & JOB_OBJECT_LIMIT_PROCESS_MEMORY) {\n+    return jeli.ProcessMemoryLimit;\n+  }\n+\n+  if (jeli.BasicLimitInformation.LimitFlags & JOB_OBJECT_LIMIT_JOB_MEMORY) {\n+    return jeli.JobMemoryLimit;\n+  }\n+\n+  \/\/ No limit\n+  return SIZE_MAX;\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":18,"deletions":4,"binary":false,"changes":22,"status":"modified"}]}