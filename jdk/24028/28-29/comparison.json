{"files":[{"patch":"@@ -259,1 +259,1 @@\n-  void check_tree(Tree& tree,const ExpectedTree<N>& et, int line_no) {\n+  void check_tree(Tree& tree, const ExpectedTree<N>& et, int line_no) {\n@@ -301,0 +301,1 @@\n+    print_tree(et, line_no);\n@@ -303,0 +304,20 @@\n+  template<int N>\n+  void print_tree(const ExpectedTree<N>& et, int line_no) {\n+    const State Rs = State::Reserved;\n+    const State Rl = State::Released;\n+    const State C = State::Committed;\n+    stringStream ss;\n+    ss.print_cr(\"Tree nodes for line %d\", line_no);\n+    ss.print_cr(\"\/\/            1         2         3         4         5         6         7\");\n+    ss.print_cr(\"\/\/  01234567890123456789012345678901234567890123456789012345678901234567890\");\n+    ss.print   (\"    \");\n+    for (int i = 0; i < N; i++) {\n+      char state_char = et.states[i+1] == Rl ? '.' :\n+                        et.states[i+1] == Rs ? 'r' :\n+                        et.states[i+1] ==  C ? 'C' : ' ';\n+      for (int j = et.nodes[i]; i < (N - 1) && j < et.nodes[i + 1]; j++) {\n+        ss.put(state_char);\n+      }\n+    }\n+    tty->print_cr(\"%s\", ss.base());\n+  }\n@@ -1136,6 +1157,4 @@\n-    \/\/            1         2         3         4         5\n-    \/\/  012345678901234567890123456789012345678901234567890\n-    \/\/  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.\n-    \/\/  Legend:\n-    \/\/  a - Test (reserved)\n-    \/\/  . - free\n+    \/\/            1         2         3         4         5         6         7\n+    \/\/  0123456789012345678901234567890123456789012345678901234567890123456789\n+    \/\/  rrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr....................\n+\n@@ -1268,1 +1287,1 @@\n-    tree.reserve_mapping(0, 100, call_stack_1);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n@@ -1270,2 +1289,2 @@\n-    \/\/ Pre:  .........0----------------------------100.........\n-    \/\/ Post: .........0--------10--------20--------100.........\n+    \/\/ Pre:  .........0----------------------------50.........\n+    \/\/ Post: .........0--------10--------20--------50.........\n@@ -1274,1 +1293,1 @@\n-    \/\/        -        si_1      si_2      si_1      -\n+    \/\/        -        si_1      si_4      si_1      -\n@@ -1276,1 +1295,1 @@\n-    ExpectedTree<4> et1 = {{     0,     10,     20,     100       },\n+    ExpectedTree<4> et1 = {{     0,     10,     20,     50       },\n@@ -1285,2 +1304,2 @@\n-    tree.commit_mapping(0, 100, call_stack_1);\n-    ExpectedTree<2> et = {{     0,     100       },\n+    tree.commit_mapping(0, 50, call_stack_1);\n+    ExpectedTree<2> et = {{     0,      50       },\n@@ -1295,3 +1314,3 @@\n-    tree.commit_mapping(0, 100, call_stack_2);\n-    tree.reserve_mapping(0, 100, call_stack_1);\n-    ExpectedTree<2> et = {{     0,     100       },\n+    tree.commit_mapping(0, 50, call_stack_2);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    ExpectedTree<2> et = {{     0,      50       },\n@@ -1335,4 +1354,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1340,4 +1359,4 @@\n-    tree.reserve_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100................200------------------------300********400........\n-    \/\/ Request:               100--------------------------------250\n-    \/\/ Post: ........0--------100--------------------------------250--------300********400........\n+    tree.reserve_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10................20------------------------30********40........\n+    \/\/ Request:               10--------------------------------25\n+    \/\/ Post: ........0--------10--------------------------------25--------30********40........\n@@ -1348,1 +1367,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1358,4 +1377,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1363,4 +1382,4 @@\n-    tree.commit_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100................200------------------------300********400........\n-    \/\/ Request:               100********************************250\n-    \/\/ Post: ........0--------100********************************250--------300********400........\n+    tree.commit_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10................20------------------------30********40........\n+    \/\/ Request:               10********************************25\n+    \/\/ Post: ........0--------10********************************25--------30********40........\n@@ -1371,1 +1390,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1381,4 +1400,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1386,1 +1405,1 @@\n-    tree.uncommit_mapping(100, 150, call_stack_2);\n+    tree.uncommit_mapping(10, 15, call_stack_2);\n@@ -1388,4 +1407,3 @@\n-    \/\/ to be re-written after 8354115\n-    \/\/ Pre:  ........0--------100................200------------------------300********400........\n-    \/\/ Request:               100--------------------------------250\n-    \/\/ Post: ........0--------100................200------------------------300********400........\n+    \/\/ Pre:  ........0--------10................20------------------------30********40........\n+    \/\/ Request:               10--------------------------------25\n+    \/\/ Post: ........0--------10................20------------------------30********40........\n@@ -1396,1 +1414,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    200,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     20,     30,     40         },\n@@ -1406,4 +1424,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1411,4 +1429,4 @@\n-    tree.release_mapping(100, 150);\n-    \/\/ Pre:  ........0--------100................200------------------------300********400........\n-    \/\/ Request:               100................................250\n-    \/\/ Post: ........0--------100................................250--------300********400........\n+    tree.release_mapping(10, 15);\n+    \/\/ Pre:  ........0--------10................20------------------------30********40........\n+    \/\/ Request:               10................................25\n+    \/\/ Post: ........0--------10................................25--------30********40........\n@@ -1419,1 +1437,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1429,4 +1447,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_1);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_1);\n@@ -1434,4 +1452,4 @@\n-    tree.reserve_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100----------------200------------------------300********400........\n-    \/\/ Request:               100--------------------------------250\n-    \/\/ Post: ........0--------100--------------------------------250--------300********400........\n+    tree.reserve_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10----------------20------------------------30********40........\n+    \/\/ Request:               10--------------------------------25\n+    \/\/ Post: ........0--------10--------------------------------25--------30********40........\n@@ -1442,1 +1460,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1452,4 +1470,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_1);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_1);\n@@ -1457,4 +1475,4 @@\n-    tree.commit_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100----------------200------------------------300********400........\n-    \/\/ Request:               100********************************250\n-    \/\/ Post: ........0--------100********************************250--------300********400........\n+    tree.commit_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10----------------20------------------------30********40........\n+    \/\/ Request:               10********************************25\n+    \/\/ Post: ........0--------10********************************25--------30********40........\n@@ -1465,1 +1483,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1475,4 +1493,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_2);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_2);\n@@ -1480,4 +1498,4 @@\n-    tree.uncommit_mapping(100, 150, call_stack_1_mtNone);\n-    \/\/ Pre:  ........0--------100----------------200------------------------300********400........\n-    \/\/ Request:               100--------------------------------250\n-    \/\/ Post: ........0--------100----------------200------------------------300********400........\n+    tree.uncommit_mapping(10, 15, call_stack_1_mtNone);\n+    \/\/ Pre:  ........0--------10----------------20------------------------30********40........\n+    \/\/ Request:               10--------------------------------25\n+    \/\/ Post: ........0--------10----------------20------------------------30********40........\n@@ -1488,1 +1506,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    200,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     20,     30,     40         },\n@@ -1498,4 +1516,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_1);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_1);\n@@ -1503,4 +1521,4 @@\n-    tree.release_mapping(100, 150);\n-    \/\/ Pre:  ........0--------100----------------200------------------------300********400........\n-    \/\/ Request:               100................................250\n-    \/\/ Post: ........0--------100................................250--------300********400........\n+    tree.release_mapping(10, 15);\n+    \/\/ Pre:  ........0--------10----------------20------------------------30********40........\n+    \/\/ Request:               10................................25\n+    \/\/ Post: ........0--------10................................25--------30********40........\n@@ -1511,1 +1529,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1521,3 +1539,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1525,4 +1543,4 @@\n-    tree.reserve_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100****************200------------------------300********400........\n-    \/\/ Request:               100--------------------------------250\n-    \/\/ Post: ........0--------100--------------------------------250--------300********400........\n+    tree.reserve_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10****************20------------------------30********40........\n+    \/\/ Request:               10--------------------------------25\n+    \/\/ Post: ........0--------10--------------------------------25--------30********40........\n@@ -1533,1 +1551,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1543,3 +1561,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1547,4 +1565,4 @@\n-    tree.commit_mapping(100, 150, call_stack_2);\n-    \/\/ Pre:  ........0--------100****************200------------------------300********400........\n-    \/\/ Request:               100********************************250\n-    \/\/ Post: ........0--------100********************************250--------300********400........\n+    tree.commit_mapping(10, 15, call_stack_2);\n+    \/\/ Pre:  ........0--------10****************20------------------------30********40........\n+    \/\/ Request:               10********************************25\n+    \/\/ Post: ........0--------10********************************25--------30********40........\n@@ -1555,1 +1573,1 @@\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400         },\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40         },\n@@ -1565,3 +1583,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1569,9 +1587,9 @@\n-    tree.uncommit_mapping(100, 150, call_stack_1_mtNone);\n-    \/\/ Pre:  ........0--------100****************200------------------300********400........\n-    \/\/ Request:               100--------------------------250\n-    \/\/ Post: ........0------------------------------------------------300********400........\n-    \/\/        mtNone                    mtTest                            mtTest     mtNone\n-    \/\/        Rl                        Rs                                C          Rl\n-    \/\/        -                         si_1                              si_1       -\n-    \/\/        -                         -                                 si_1       -\n-    ExpectedTree<3> et = {{     0,    300,    400         },\n+    tree.uncommit_mapping(10, 15, call_stack_1_mtNone);\n+    \/\/ Pre:  ........0--------10****************20------------------30********40........\n+    \/\/ Request:               10--------------------------25\n+    \/\/ Post: ........0----------------------------------------------30********40........\n+    \/\/        mtNone                    mtTest                         mtTest     mtNone\n+    \/\/        Rl                        Rs                             C          Rl\n+    \/\/        -                         si_1                           si_1       -\n+    \/\/        -                         -                              si_1       -\n+    ExpectedTree<3> et = {{     0,     30,     40         },\n@@ -1587,3 +1605,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1591,9 +1609,9 @@\n-    tree.release_mapping(100, 150);\n-    \/\/ Pre:  ........0--------100****************200------------------------300********400........\n-    \/\/ Request:               100................................250\n-    \/\/ Post: ........0--------100................................250--------300********400........\n-    \/\/        mtNone   mtTest                 mtNone                 mtTest     mtTest     mtNone\n-    \/\/        Rl       Rs                     Rl                     Rs         C          Rl\n-    \/\/        -        si_1                   -                      si_1       si_1       -\n-    \/\/        -        -                      -                      -          si_1       -\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,    400          },\n+    tree.release_mapping(10, 15);\n+    \/\/ Pre:  ........0--------10****************20------------------------30********40........\n+    \/\/ Request:               10................................25\n+    \/\/ Post: ........0--------10................................25--------30********40........\n+    \/\/        mtNone   mtTest               mtNone                 mtTest    mtTest     mtNone\n+    \/\/        Rl       Rs                   Rl                     Rs        C          Rl\n+    \/\/        -        si_1                 -                      si_1      si_1       -\n+    \/\/        -        -                    -                      -         si_1       -\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,     40          },\n@@ -1626,4 +1644,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1631,9 +1649,9 @@\n-    tree.reserve_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100................200-----------------------300*********400........\n-    \/\/ Request:                          150----------------250\n-    \/\/ Post: ........0--------100........150----------------250------------300*********400........\n-    \/\/        mtNone   mtTest     mtNone         mtTest           mtTest        mtTest     mtNone\n-    \/\/        Rl       Rs         Rl             Rs               Rs            C          Rl\n-    \/\/        -        si_1       -              si_2             si_1          si_1       -\n-    \/\/        -        -          -              -                -             si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.reserve_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10................20----------------------30*********40........\n+    \/\/ Request:                         15----------------25\n+    \/\/ Post: ........0--------10........15----------------25------------30*********40........\n+    \/\/        mtNone   mtTest    mtNone        mtTest          mtTest      mtTest     mtNone\n+    \/\/        Rl       Rs        Rl            Rs              Rs          C          Rl\n+    \/\/        -        si_1      -             si_2            si_1        si_1       -\n+    \/\/        -        -         -              -               -          si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1649,4 +1667,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1654,9 +1672,9 @@\n-    tree.commit_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100................200-----------------------300********400........\n-    \/\/ Request:                          150****************250\n-    \/\/ Post: ........0--------100........150****************250------------300********400........\n-    \/\/        mtNone   mtTest     mtNone         mtTest           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         Rl             C                Rs           C          Rl\n-    \/\/        -        si_1       -1             si_2             si_1         si_1       -\n-    \/\/        -        -          -1             si_2             -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.commit_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10................20----------------------30********40........\n+    \/\/ Request:                         15****************25\n+    \/\/ Post: ........0--------10........15****************25------------30********40........\n+    \/\/        mtNone   mtTest    mtNone        mtTest         mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs        Rl            C              Rs           C          Rl\n+    \/\/        -        si_1      -1            si_2           si_1         si_1       -\n+    \/\/        -        -         -1            si_2           -            si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1672,4 +1690,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1678,9 +1696,9 @@\n-    tree.uncommit_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100................200-----------------------300********400........\n-    \/\/ Request:                          150----------------250\n-    \/\/ Post: ........0--------100................200-----------------------300********400........\n-    \/\/        mtNone   mtTest       mtNone                 mtTest              mtTest     mtNone\n-    \/\/        Rl       Rs           Rl                     Rs                  C          Rl\n-    \/\/        -        si_1         -                      si_1                si_1       -\n-    \/\/        -        -            -                      -                   si_1       -\n-    ExpectedTree<5> et = {{     0,    100,    200,    300,   400          },\n+    tree.uncommit_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10................20-----------------------30********40........\n+    \/\/ Request:                         15----------------25\n+    \/\/ Post: ........0--------10................20-----------------------30********40........\n+    \/\/        mtNone   mtTest     mtNone                 mtTest             mtTest     mtNone\n+    \/\/        Rl       Rs         Rl                     Rs                 C          Rl\n+    \/\/        -        si_1       -                      si_1               si_1       -\n+    \/\/        -        -          -                      -                  si_1       -\n+    ExpectedTree<5> et = {{     0,     10,     20,     30,    40          },\n@@ -1696,4 +1714,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.release_mapping(100, 100);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.release_mapping(10, 10);\n@@ -1701,10 +1719,10 @@\n-    tree.release_mapping(150, 100);\n-    \/\/ Pre:  ........0--------100................200--------------------300********400........\n-    \/\/ Request:                           150............250\n-    \/\/ Post: ........0--------100........................250------------300********400........\n-    \/\/        mtNone   mtTest             mtNone               mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs                 Rl                   Rs           C          Rl\n-    \/\/        -        si_1               -                    si_1         si_1       -\n-    \/\/        -        -                  -                    -            si_1       -\n-    ExpectedTree<5> et = {{     0,    100,    250,    300,   400          },\n-                          {mtNone, mtTest,  mtNone, mtTest, mtTest, mtNone },\n+    tree.release_mapping(15, 10);\n+    \/\/ Pre:  ........0--------10................20--------------------30********40........\n+    \/\/ Request:                           15............25\n+    \/\/ Post: ........0--------10........................25------------30********40........\n+    \/\/        mtNone   mtTest          mtNone               mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs              Rl                   Rs           C          Rl\n+    \/\/        -        si_1            -                    si_1         si_1       -\n+    \/\/        -        -               -                    -            si_1       -\n+    ExpectedTree<5> et = {{     0,     10,     25,     30,    40          },\n+                          {mtNone, mtTest,  mtNone, mtTest, mtTest, mtNone},\n@@ -1719,4 +1737,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_3);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_3);\n@@ -1724,9 +1742,9 @@\n-    tree.reserve_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100----------------200-----------------------300********400........\n-    \/\/ Request:                          150----------------250\n-    \/\/ Post: ........0--------100--------150----------------250------------300********400........\n-    \/\/        mtNone   mtTest     mtTest         mtTest           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         Rs             Rs               Rs           C          Rl\n-    \/\/        -        si_1       si_3           si_2             si_1         si_1       -\n-    \/\/        -        -          -              -                -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.reserve_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10----------------20----------------------30********40........\n+    \/\/ Request:                         15----------------25\n+    \/\/ Post: ........0--------10--------15----------------25------------30********40........\n+    \/\/        mtNone   mtTest    mtTest     mtTest           mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs        Rs         Rs               Rs           C          Rl\n+    \/\/        -        si_1      si_3       si_2             si_1         si_1       -\n+    \/\/        -        -         -          -                -            si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1742,4 +1760,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_3);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_3);\n@@ -1747,2 +1765,2 @@\n-    tree.commit_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100-------------------200--------------------300********400........\n+    tree.commit_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10-------------------20------------------30********40........\n@@ -1751,7 +1769,7 @@\n-    \/\/ Request:                          150*******************250\n-    \/\/ Post: ........0--------100--------150********200********250---------300********400........\n-    \/\/        mtNone   mtTest     mtTest     mtTest     mtTest      mtTest     mtTest     mtNone\n-    \/\/        Rl       Rs         Rs         C          C           Rs         C          Rl\n-    \/\/        -        si_1       si_3       si_3       si_1        si_1       si_1       -\n-    \/\/        -        -          -          si_2       si_2        -          si_1       -\n-    ExpectedTree<7> et = {{     0,    100,    150,    200,    250,    300,   400          },\n+    \/\/ Request:                         15******************25\n+    \/\/ Post: ........0--------10--------15********20********25---------30********40........\n+    \/\/        mtNone   mtTest     mtTest   mtTest    mtTest     mtTest     mtTest     mtNone\n+    \/\/        Rl       Rs         Rs       C         C          Rs         C          Rl\n+    \/\/        -        si_1       si_3     si_3      si_1       si_1       si_1       -\n+    \/\/        -        -          -        si_2      si_2       -          si_1       -\n+    ExpectedTree<7> et = {{     0,     10,     15,     20,     25,     30,    40          },\n@@ -1767,4 +1785,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_2);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_2);\n@@ -1772,2 +1790,2 @@\n-    tree.uncommit_mapping(150, 100, call_stack_1_mtNone);\n-    \/\/ Pre:  ........0--------100----------------200-----------------------300********400........\n+    tree.uncommit_mapping(15, 10, call_stack_1_mtNone);\n+    \/\/ Pre:  ........0--------10----------------20-----------------------30********40........\n@@ -1776,7 +1794,7 @@\n-    \/\/ Reqquest:                      150-------------------250\n-    \/\/ Pre:  ........0--------100----------------200-----------------------300********400........\n-    \/\/        mtNone   mtTest        mtTest                mtTest              mtTest     mtNone\n-    \/\/        Rl       Rs            Rs                    Rs                  C          Rl\n-    \/\/        -        si_1          si_2                  si_1                si_1       -\n-    \/\/        -        -             -                     -                   si_1       -\n-    ExpectedTree<5> et = {{     0,    100,    200,    300,   400          },\n+    \/\/ Reqquest:                      15-------------------25\n+    \/\/ Pre:  ........0--------10----------------20-----------------------30********40........\n+    \/\/        mtNone   mtTest        mtTest             mtTest              mtTest     mtNone\n+    \/\/        Rl       Rs            Rs                 Rs                  C          Rl\n+    \/\/        -        si_1          si_2               si_1                si_1       -\n+    \/\/        -        -             -                  -                   si_1       -\n+    ExpectedTree<5> et = {{     0,     10,     20,     30,    40          },\n@@ -1792,4 +1810,4 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.reserve_mapping(100, 100, call_stack_2);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(10, 10, call_stack_2);\n@@ -1797,9 +1815,9 @@\n-    tree.release_mapping(150, 100);\n-    \/\/ Pre:  ........0--------100----------------200-----------------------300********400........\n-    \/\/ Request:                          150................250\n-    \/\/ Post: ........0--------100--------150................250------------300********400........\n-    \/\/        mtNone   mtTest     mtTest         mtNone           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         Rs             Rl               Rs           C          Rl\n-    \/\/        -        si_1       si_2           -                si_1         si_1       -\n-    \/\/        -        -          -              -                -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.release_mapping(15, 10);\n+    \/\/ Pre:  ........0--------10----------------20----------------------30********40........\n+    \/\/ Request:                         15................25\n+    \/\/ Post: ........0--------10--------15................25------------30********40........\n+    \/\/        mtNone   mtTest     mtTest       mtNone          mtTest      mtTest     mtNone\n+    \/\/        Rl       Rs         Rs           Rl              Rs          C          Rl\n+    \/\/        -        si_1       si_2         -               si_1        si_1       -\n+    \/\/        -        -          -            -               -           si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1815,3 +1833,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1819,9 +1837,9 @@\n-    tree.reserve_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100****************200-----------------------300********400........\n-    \/\/ Request:                          150----------------250\n-    \/\/ Post: ........0--------100********150----------------250------------300********400........\n-    \/\/        mtNone   mtTest     mtTest         mtTest           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         C              Rs               Rs           C          Rl\n-    \/\/        -        si_1       si_1           si_2             si_1         si_1       -\n-    \/\/        -        -          si_1           -                -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.reserve_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10****************20----------------------30********40........\n+    \/\/ Request:                         15----------------25\n+    \/\/ Post: ........0--------10********15----------------25------------30********40........\n+    \/\/        mtNone   mtTest    mtTest      mtTest           mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs        C           Rs               Rs           C          Rl\n+    \/\/        -        si_1      si_1        si_2             si_1         si_1       -\n+    \/\/        -        -         si_1        -                -            si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1837,3 +1855,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1841,9 +1859,9 @@\n-    tree.commit_mapping(150, 100, call_stack_2);\n-    \/\/ Pre:  ........0--------100****************200-----------------------300********400........\n-    \/\/ Request:                          150****************250\n-    \/\/ Post: ........0--------100********150****************250------------300********400........\n-    \/\/        mtNone   mtTest     mtTest         mtTest           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         C              C                Rs           C          Rl\n-    \/\/        -        si_1       si_1           si_1             si_1         si_1       -\n-    \/\/        -        -          si_1           si_2             -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.commit_mapping(15, 10, call_stack_2);\n+    \/\/ Pre:  ........0--------10****************20----------------------30********40........\n+    \/\/ Request:                         15****************25\n+    \/\/ Post: ........0--------10********15****************25------------30********40........\n+    \/\/        mtNone   mtTest     mtTest     mtTest           mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs         C          C                Rs           C          Rl\n+    \/\/        -        si_1       si_1       si_1             si_1         si_1       -\n+    \/\/        -        -          si_1       si_2             -            si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1859,3 +1877,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1863,9 +1881,9 @@\n-    tree.uncommit_mapping(150, 100, call_stack_1_mtNone);\n-    \/\/ Pre:  ........0--------100*******************200--------------------300********400........\n-    \/\/ Request:                          150--------------------250\n-    \/\/ Post: ........0--------100********150-------------------------------300********400........\n-    \/\/        mtNone   mtTest     mtTest                mtTest                 mtTest     mtNone\n-    \/\/        Rl       Rs         C                     Rs                     C          Rl\n-    \/\/        -        si_1       si_1                  si_1                   si_1       -\n-    \/\/        -        -          si_1                  -                      si_1       -\n-    ExpectedTree<5> et = {{     0,    100,    150,    300,   400          },\n+    tree.uncommit_mapping(15, 10, call_stack_1_mtNone);\n+    \/\/ Pre:  ........0--------10*******************20--------------------30********40........\n+    \/\/ Request:                         15--------------------25\n+    \/\/ Post: ........0--------10********15-------------------------------30********40........\n+    \/\/        mtNone   mtTest    mtTest              mtTest                 mtTest     mtNone\n+    \/\/        Rl       Rs        C                   Rs                     C          Rl\n+    \/\/        -        si_1      si_1                si_1                   si_1       -\n+    \/\/        -        -         si_1                -                      si_1       -\n+    ExpectedTree<5> et = {{     0,     10,     15,     30,    40          },\n@@ -1881,3 +1899,3 @@\n-    tree.reserve_mapping(0, 400, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 40, call_stack_1);\n+    tree.commit_mapping(10, 10, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 10, call_stack_1_mtNone, true);\n@@ -1885,9 +1903,9 @@\n-    tree.release_mapping(150, 100);\n-    \/\/ Pre:  ........0--------100****************200-----------------------300********400........\n-    \/\/ Request:                          150................250\n-    \/\/ Post: ........0--------100********150................250------------300********400........\n-    \/\/        mtNone   mtTest     mtTest         mtNone           mtTest       mtTest     mtNone\n-    \/\/        Rl       Rs         C              Rl               Rs           C          Rl\n-    \/\/        -        si_1       si_1           -                si_1         si_1       -\n-    \/\/        -        -          si_1           -                -            si_1       -\n-    ExpectedTree<6> et = {{     0,    100,    150,    250,    300,   400          },\n+    tree.release_mapping(15, 10);\n+    \/\/ Pre:  ........0--------10****************20----------------------30********40........\n+    \/\/ Request:                         15................25\n+    \/\/ Post: ........0--------10********15................25------------30********40........\n+    \/\/        mtNone   mtTest     mtTest     mtNone           mtTest       mtTest     mtNone\n+    \/\/        Rl       Rs         C          Rl               Rs           C          Rl\n+    \/\/        -        si_1       si_1       -                si_1         si_1       -\n+    \/\/        -        -          si_1       -                -            si_1       -\n+    ExpectedTree<6> et = {{     0,     10,     15,     25,     30,    40          },\n@@ -1921,4 +1939,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -1926,9 +1944,9 @@\n-    tree.reserve_mapping(50, 900, call_stack_2);\n-    \/\/ Pre:     ........0----------------100*********200--------300********400--------500********600-------------------1000........\n-    \/\/ Request: (reserve)        50-------------------------------------------------------------------------950\n-    \/\/ Post:    ........0--------50-------------------------------------------------------------------------950--------1000........\n-    \/\/           mtNone   mtTest                                 mtTest                                         mtTest      mtNone\n-    \/\/           Rl       Rs                                     Rs                                             Rs          Rl\n-    \/\/           -        si_1                                   si_2                                           si_1        -\n-    \/\/           -        -                                      -                                              -           -\n-    ExpectedTree<4> et = {{     0,    50,    950,    1000         },\n+    tree.reserve_mapping(5, 40, call_stack_2);\n+    \/\/ Pre:     ........0----------------10*********15--------20********25--------30********35-------------------50........\n+    \/\/ Request: (reserve)        5-----------------------------------------------------------------------45\n+    \/\/ Post:    ........0--------5-----------------------------------------------------------------------45-------50........\n+    \/\/           mtNone   mtTest                                 mtTest                                     mtTest      mtNone\n+    \/\/           Rl       Rs                                     Rs                                         Rs          Rl\n+    \/\/           -        si_1                                   si_2                                       si_1        -\n+    \/\/           -        -                                      -                                          -           -\n+    ExpectedTree<4> et = {{     0,      5,     45,     50         },\n@@ -1944,4 +1962,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -1949,9 +1967,9 @@\n-    tree.reserve_mapping(50, 550, call_stack_2);\n-    \/\/ Pre:     ........0----------------100*********200--------300********400--------500********600-------------------1000........\n-    \/\/ Request:                  50--------------------------------------------------------------600\n-    \/\/ Post:    ........0--------50--------------------------------------------------------------600-------------------1000........\n-    \/\/           mtNone                                          mtTest                                   mtTest            mtNone\n-    \/\/           Rl                                              Rs                                       Rs                Rl\n-    \/\/           -                                               si_2                                     si_1              -\n-    \/\/           -                                               -                                        -                 -\n-    ExpectedTree<4> et = {{     0,    50,    600,    1000         },\n+    tree.reserve_mapping(5, 30, call_stack_2);\n+    \/\/ Pre:     ........0----------------10*********15--------20********25--------30********35-------------------50........\n+    \/\/ Request: (reserve)        5----------------------------------------------------------35\n+    \/\/ Post:    ........0--------5----------------------------------------------------------35-------------------50........\n+    \/\/           mtNone                                          mtTest                            mtTest            mtNone\n+    \/\/           Rl                                              Rs                                Rs                Rl\n+    \/\/           -                                               si_2                              si_1              -\n+    \/\/           -                                               -                                 -                 -\n+    ExpectedTree<4> et = {{     0,      5,     35,     50         },\n@@ -1967,4 +1985,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -1972,9 +1990,9 @@\n-    tree.reserve_mapping(0, 950, call_stack_2);\n-    \/\/ Pre:     ........0----------------100*********200--------300********400--------500********600-------------------1000........\n-    \/\/ Request:         0-----------------------------------------------------------------------------------950\n-    \/\/ Post:    ........0-----------------------------------------------------------------------------------950--------1000........\n-    \/\/           mtNone                                          mtTest                                         mtTest      mtNone\n-    \/\/           Rl                                              Rs                                             Rs          Rl\n-    \/\/           -                                               si_2                                           si_1        -\n-    \/\/           -                                               -                                              -           -\n-    ExpectedTree<3> et = {{     0,    950,    1000        },\n+    tree.reserve_mapping(0, 45, call_stack_2);\n+    \/\/ Pre:     ..........0----------------10*********15--------20********25--------30********35------------50........\n+    \/\/ Request: (reserve) 0-------------------------------------------------------------------------45\n+    \/\/ Post:    ..........0-------------------------------------------------------------------------45------50........\n+    \/\/           mtNone                                 mtTest                                         mtTest  mtNone\n+    \/\/           Rl                                     Rs                                             Rs      Rl\n+    \/\/           -                                      si_2                                           si_1    -\n+    \/\/           -                                      -                                              -       -\n+    ExpectedTree<3> et = {{     0,     45,     50        },\n@@ -1990,4 +2008,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -1995,9 +2013,9 @@\n-    tree.uncommit_mapping(50, 900, call_stack_1_mtNone);\n-    \/\/ Pre:     ........0----------------100*********200--------300********400--------500********600-------------------1000........\n-    \/\/ Request: (uncommit)       50-------------------------------------------------------------------------950\n-    \/\/ Post:    ........0----------------------------------------------------------------------------------------------1000........\n-    \/\/           mtNone                                           mtTest                                                    mtNone\n-    \/\/           Rl                                               Rs                                                        Rl\n-    \/\/           -                                                si_1                                                      -\n-    \/\/           -                                                -                                                         -\n-    ExpectedTree<2> et = {{     0,   1000         },\n+    tree.uncommit_mapping(5, 40, call_stack_1_mtNone);\n+    \/\/ Pre:     ..........0----------------10*********15--------20********25--------30********35------------50........\n+    \/\/ Request: (uncommit)         5----------------------------------------------------------------45\n+    \/\/ Post:    ..........0---------------------------------------------------------------------------------50........\n+    \/\/           mtNone                                           mtTest                                       mtNone\n+    \/\/           Rl                                               Rs                                           Rl\n+    \/\/           -                                                si_1                                         -\n+    \/\/           -                                                -                                            -\n+    ExpectedTree<2> et = {{     0,     50         },\n@@ -2009,1 +2027,1 @@\n-    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(50);\n+    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(5);\n@@ -2011,1 +2029,1 @@\n-    EXPECT_EQ((int)r.end->key(), 1000);\n+    EXPECT_EQ((int)r.end->key(), 50);\n@@ -2016,4 +2034,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.reserve_mapping(100, 100, call_stack_2);\n-    tree.reserve_mapping(300, 100, call_stack_2);\n-    tree.reserve_mapping(500, 100, call_stack_2);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.reserve_mapping(10, 5, call_stack_2);\n+    tree.reserve_mapping(20, 5, call_stack_2);\n+    tree.reserve_mapping(30, 5, call_stack_2);\n@@ -2021,1 +2039,1 @@\n-    tree.uncommit_mapping(50, 900, call_stack_3_mtNone); \/\/ The call-stack should not be taken into account\n+    tree.uncommit_mapping(5, 35, call_stack_3_mtNone); \/\/ The call-stack should not be taken into account\n@@ -2023,2 +2041,2 @@\n-    \/\/ Pre:     ........0----------------100---------200--------300--------400--------500--------600-------------------1000........\n-    \/\/                         si_1             si_2       si_1      si_2       si_1       si_2          si_1               -\n+    \/\/ Pre:     ........0----------------10---------15--------20--------25--------30--------35-------------------50........\n+    \/\/                         si_1          si_2       si_1      si_2       si_1       si_2          si_1           -\n@@ -2026,1 +2044,1 @@\n-    \/\/ Request: (uncommit)       50-----------------------------------------------------------------------------950\n+    \/\/ Request: (uncommit)       5---------------------------------------------------------------------40\n@@ -2029,6 +2047,6 @@\n-    \/\/ Post:    ........0----------------100---------200--------300--------400--------500--------600-------------------1000........\n-    \/\/           mtNone       mtTest         mtTest      mtTest     mtTest     mtTest     mtTest        mtTest              mtNone                                      mtNone\n-    \/\/           Rl           Rs             Rs          Rs         Rs         Rs         Rs            Rs                  Rl\n-    \/\/           -            si_1           si_2        si_1       si_2       si_1       si_2          si_1                -\n-    \/\/           -            -              -           -          -          -          -             -                   -\n-    ExpectedTree<8> et = {{     0,    100,    200,    300,    400,    500,    600,   1000         },\n+    \/\/ Post:    ........0----------------10----------15--------20--------25--------30--------35-------------------50........\n+    \/\/           mtNone       mtTest         mtTest      mtTest     mtTest     mtTest     mtTest        mtTest       mtNone                                      mtNone\n+    \/\/           Rl           Rs             Rs          Rs         Rs         Rs         Rs            Rs           Rl\n+    \/\/           -            si_1           si_2        si_1       si_2       si_1       si_2          si_1         -\n+    \/\/           -            -              -           -          -          -          -             -            -\n+    ExpectedTree<8> et = {{     0,     10,     15,     20,     25,     30,     35,     50         },\n@@ -2044,4 +2062,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2049,1 +2067,1 @@\n-    tree.uncommit_mapping(50, 550, call_stack_1_mtNone);\n+    tree.uncommit_mapping(5, 30, call_stack_1_mtNone);\n@@ -2057,1 +2075,1 @@\n-    ExpectedTree<2> et = {{     0,   1000         },\n+    ExpectedTree<2> et = {{     0,     50         },\n@@ -2063,1 +2081,1 @@\n-    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(50);\n+    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(5);\n@@ -2065,1 +2083,1 @@\n-    EXPECT_EQ((int)r.end->key(), 1000);\n+    EXPECT_EQ((int)r.end->key(), 50);\n@@ -2070,4 +2088,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2075,1 +2093,1 @@\n-    tree.uncommit_mapping(100, 850, call_stack_1_mtNone);\n+    tree.uncommit_mapping(10, 40, call_stack_1_mtNone);\n@@ -2083,1 +2101,1 @@\n-    ExpectedTree<2> et = {{     0,   1000         },\n+    ExpectedTree<2> et = {{     0,     50         },\n@@ -2089,3 +2107,3 @@\n-    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(50);\n-    EXPECT_EQ((int)r.start->key(), 0);  \/\/ make sure both 50 and 600 are removed\n-    EXPECT_EQ((int)r.end->key(), 1000);\n+    VMATree::VMATreap::Range r = tree.tree().find_enclosing_range(5);\n+    EXPECT_EQ((int)r.start->key(), 0);\n+    EXPECT_EQ((int)r.end->key(), 50);\n@@ -2096,4 +2114,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2101,1 +2119,1 @@\n-    tree.release_mapping(50, 900);\n+    tree.release_mapping(5, 40);\n@@ -2109,1 +2127,1 @@\n-    ExpectedTree<4> et = {{     0,    50,    950,    1000         },\n+    ExpectedTree<4> et = {{     0,      5,     45,     50         },\n@@ -2119,4 +2137,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2124,1 +2142,1 @@\n-    tree.release_mapping(50, 550);\n+    tree.release_mapping(5, 30);\n@@ -2132,1 +2150,1 @@\n-    ExpectedTree<4> et = {{     0,    50,    600,    1000         },\n+    ExpectedTree<4> et = {{     0,      5,     35,     50         },\n@@ -2142,4 +2160,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2147,1 +2165,1 @@\n-    tree.release_mapping(50, 950);\n+    tree.release_mapping(5, 40);\n@@ -2155,1 +2173,1 @@\n-    ExpectedTree<2> et = {{     0,    50,         },\n+    ExpectedTree<2> et = {{     0,      5,        },\n@@ -2165,4 +2183,4 @@\n-    tree.reserve_mapping(0, 1000, call_stack_1);\n-    tree.commit_mapping(100, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(300, 100, call_stack_1_mtNone, true);\n-    tree.commit_mapping(500, 100, call_stack_1_mtNone, true);\n+    tree.reserve_mapping(0, 50, call_stack_1);\n+    tree.commit_mapping(10, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(20, 5, call_stack_1_mtNone, true);\n+    tree.commit_mapping(30, 5, call_stack_1_mtNone, true);\n@@ -2170,1 +2188,1 @@\n-    tree.release_mapping(0, 700);\n+    tree.release_mapping(0, 40);\n@@ -2178,1 +2196,1 @@\n-    ExpectedTree<2> et = {{   700,   1000,        },\n+    ExpectedTree<2> et = {{    40,     50,        },\n@@ -2186,1 +2204,1 @@\n-    EXPECT_EQ((int)r.end->key(), 700);\n+    EXPECT_EQ((int)r.end->key(), 40);\n@@ -2221,1 +2239,1 @@\n-    ExpectedTree<5> pre = {{   100,    120,    140,    160,    200        },\n+    ExpectedTree<5> pre = {{    10,     12,     14,     16,     20        },\n@@ -2228,4 +2246,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 200, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 200);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 100);\n-    ExpectedTree<6> et = {{   50,     100,    120,    140,    160,    250        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(5, 20, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 20);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 10);\n+    ExpectedTree<6> et = {{     5,     10,     12,     14,     16,     25        },\n@@ -2249,1 +2267,1 @@\n-    ExpectedTree<5> pre = {{   100,    120,    140,    160,    200        },\n+    ExpectedTree<5> pre = {{    10,     12,     14,     16,     20        },\n@@ -2256,4 +2274,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 150, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 150);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 50);\n-    ExpectedTree<6> et = {{   50,     100,    120,    140,    160,    200        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(5, 15, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 15);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 5);\n+    ExpectedTree<6> et = {{   5,      10,     12,     14,     16,      20        },\n@@ -2301,4 +2319,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 200, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 200);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 200);\n-    ExpectedTree<4> et = {{     0,     10,     50,    250        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(20, 20, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 20);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 20);\n+    ExpectedTree<4> et = {{     0,     10,     20,     40        },\n@@ -2320,1 +2338,1 @@\n-    ExpectedTree<2> pre = {{    10,     70,       },\n+    ExpectedTree<2> pre = {{    0,     10,       },\n@@ -2327,4 +2345,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 200, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 200);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 250 - 70);\n-    ExpectedTree<4> et = {{    10,     50,     70,    250        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(5, 20, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 20);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 25 - 10);\n+    ExpectedTree<4> et = {{     0,      5,     10,     25        },\n@@ -2350,1 +2368,1 @@\n-    ExpectedTree<7> pre = {{     0,     10,    100,    120,    140,    160,    200        },\n+    ExpectedTree<7> pre = {{     0,      5,     10,     12,     14,     16,     20        },\n@@ -2357,4 +2375,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 200, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 200);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 100);\n-    ExpectedTree<8> et = {{     0,     10,     50,    100,    120,    140,    160,    250        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(7, 20, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 20);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 10);\n+    ExpectedTree<8> et = {{     0,      5,      7,    10,      12,     14,     16,     27        },\n@@ -2377,1 +2395,1 @@\n-    ExpectedTree<7> pre = {{     0,     10,    100,    120,    140,    160,    200        },\n+    ExpectedTree<7> pre = {{     0,      5,     10,     12,     14,     16,     20        },\n@@ -2384,4 +2402,4 @@\n-    VMATree::SummaryDiff diff = tree.commit_mapping(50, 150, call_stack_2, false);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 150);\n-    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 50);\n-    ExpectedTree<8> et = {{     0,     10,     50,    100,    120,    140,    160,    200        },\n+    VMATree::SummaryDiff diff = tree.commit_mapping(7, 13, call_stack_2, false);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].commit, 13);\n+    EXPECT_EQ(diff.tag[NMTUtil::tag_to_index(mtTest)].reserve, 3);\n+    ExpectedTree<8> et = {{     0,      5,      7,     10,     12,     14,     16,     20        },\n","filename":"test\/hotspot\/gtest\/nmt\/test_vmatree.cpp","additions":440,"deletions":422,"binary":false,"changes":862,"status":"modified"}]}