{"files":[{"patch":"@@ -666,1 +666,0 @@\n-      NOT_PRODUCT(_peeling_rounds_of_node(comp_arena(), 8, 0, Pair<node_idx_t, uint>(0, 0)) COMMA)\n@@ -5293,11 +5292,0 @@\n-\n-uint& Compile::peeling_rounds_at_node(const Node* const head) {\n-  for(int i = 0; i < _peeling_rounds_of_node.length(); ++i) {\n-    auto& head_and_round_count = _peeling_rounds_of_node.at(i);\n-    if(head_and_round_count.first == head->_idx) {\n-      return head_and_round_count.second;\n-    }\n-  }\n-  _peeling_rounds_of_node.push(Pair<node_idx_t, uint>(head->_idx, 0));\n-  return _peeling_rounds_of_node.at(_peeling_rounds_of_node.length() - 1).second;\n-}\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":0,"deletions":12,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -50,1 +50,0 @@\n-#include \"utilities\/pair.hpp\"\n@@ -388,1 +387,0 @@\n-  GrowableArray<Pair<node_idx_t, uint>> _peeling_rounds_of_node;\n@@ -687,1 +685,0 @@\n-  uint& peeling_rounds_at_node(const Node* head);\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -506,1 +506,0 @@\n-  \/\/ Peeling is not legal here, we don't even stress peel!\n@@ -510,0 +509,1 @@\n+      \/\/ Peeling is not legal here (cf. assert in do_peeling), we don't even stress peel!\n@@ -514,1 +514,1 @@\n-#ifndef PRODUCT\n+#ifdef ASSERT\n@@ -517,0 +517,1 @@\n+    LoopNode* loop_head = _head->as_Loop();\n@@ -518,3 +519,2 @@\n-    uint& rounds = phase->C->peeling_rounds_at_node(_head);\n-    if (rounds < max_peeling_opportunities) {\n-      rounds++;\n+    if (loop_head->_peeling_opportunities_count < max_peeling_opportunities) {\n+      loop_head->_peeling_opportunities_count++;\n","filename":"src\/hotspot\/share\/opto\/loopTransform.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -136,0 +136,4 @@\n+#ifdef ASSERT\n+  uint _peeling_opportunities_count = 0;\n+#endif\n+\n","filename":"src\/hotspot\/share\/opto\/loopnode.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"}]}