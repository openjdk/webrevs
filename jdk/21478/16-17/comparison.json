{"files":[{"patch":"@@ -41,4 +41,10 @@\n-        if (name.endsWith(\"512\")) return 512;\n-        else if (name.endsWith(\"768\")) return 768;\n-        else if (name.endsWith(\"1024\")) return 1024;\n-        else throw new ProviderException();\n+        if (name.endsWith(\"512\")) {\n+            return 512;\n+        } else if (name.endsWith(\"768\")) {\n+            return 768;\n+        } else if (name.endsWith(\"1024\")) {\n+            return 1024;\n+        } else {\n+            \/\/ should not happen\n+            throw new ProviderException(\"Unknown name \" + name);\n+        }\n@@ -70,1 +76,1 @@\n-                throw new RuntimeException(\"internal error\", e);\n+                throw new ProviderException(\"provider error\", e);\n@@ -76,2 +82,3 @@\n-                kp.encapsulationKey().keyBytes(),\n-                kp.decapsulationKey().keyBytes() };\n+                    kp.encapsulationKey().keyBytes(),\n+                    kp.decapsulationKey().keyBytes()\n+            };\n@@ -139,1 +146,1 @@\n-                    new ML_KEM.ML_KEM_EncapsulationKey(encapsulationKey), randomBytes);\n+                        new ML_KEM.ML_KEM_EncapsulationKey(encapsulationKey), randomBytes);\n@@ -141,1 +148,1 @@\n-                throw new RuntimeException(e); \/\/ should not happen\n+                throw new ProviderException(\"provider error\", e); \/\/ should not happen\n@@ -148,1 +155,2 @@\n-                mlKemEncapsulateResult.sharedSecret() };\n+                mlKemEncapsulateResult.sharedSecret()\n+            };\n@@ -159,1 +167,1 @@\n-                    new ML_KEM.ML_KEM_DecapsulationKey(decapsulationKey), kpkeCipherText);\n+                        new ML_KEM.ML_KEM_DecapsulationKey(decapsulationKey), kpkeCipherText);\n@@ -161,1 +169,1 @@\n-                throw new ProviderException(e); \/\/ should not happen\n+                throw new ProviderException(\"provider error\", e); \/\/ should not happen\n@@ -168,1 +176,3 @@\n-        public int implSecretSize(String name) {return ML_KEM.SECRET_SIZE;}\n+        public int implSecretSize(String name) {\n+            return ML_KEM.SECRET_SIZE;\n+        }\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/ML_KEM_Provider.java","additions":23,"deletions":13,"binary":false,"changes":36,"status":"modified"}]}