{"files":[{"patch":"@@ -36,0 +36,1 @@\n+#include \"utilities\/ticks.hpp\"\n@@ -117,0 +118,1 @@\n+    GCLockerTimingDebugLogger logger(\"Thread stalled by JNI critical section.\");\n@@ -130,0 +132,4 @@\n+  if (needs_gc()) {\n+    log_debug_jni(\"Blocking thread as there is a pending GC request\");\n+  }\n+\n@@ -131,0 +137,1 @@\n+    GCLockerTimingDebugLogger logger(\"Thread blocked to enter critical region.\");\n@@ -151,0 +158,1 @@\n+  log_debug_jni(\"Thread exiting critical region.\");\n@@ -164,1 +172,1 @@\n-      log_debug_jni(\"Performing GC after exiting critical section.\");\n+      log_debug_jni(\"Last thread exiting. Performing GC after exiting critical section.\");\n@@ -171,0 +179,15 @@\n+\n+GCLockerTimingDebugLogger::GCLockerTimingDebugLogger(const char* log_message) :\n+  _log_message(log_message) {\n+  assert(_log_message != nullptr, \"GC locker debug message must be set.\");\n+  _start = Ticks::now();\n+}\n+\n+GCLockerTimingDebugLogger::~GCLockerTimingDebugLogger() {\n+  const Tickspan elapsed_time = Ticks::now() - _start;\n+  Log(gc, jni) log;\n+  if (log.is_debug()) {\n+    ResourceMark rm; \/\/ JavaThread::name() allocates to convert to UTF8\n+    log.debug(\"%s Resumed after \" JLONG_FORMAT \"ms. Thread \\\"%s\\\".\", _log_message, elapsed_time.milliseconds(), Thread::current()->name());\n+  }\n+}\n\\ No newline at end of file\n","filename":"src\/hotspot\/share\/gc\/shared\/gcLocker.cpp","additions":24,"deletions":1,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+#include \"utilities\/ticks.hpp\"\n@@ -153,0 +154,13 @@\n+\n+\/*\n+ * GCLockerTimingDebugLogger tracks specific timing information for GC lock waits.\n+ *\/\n+class GCLockerTimingDebugLogger : public StackObj {\n+private:\n+  const char*  _log_message;\n+  Ticks _start;\n+\n+public:\n+  GCLockerTimingDebugLogger(const char* log_message);\n+  ~GCLockerTimingDebugLogger();\n+};\n\\ No newline at end of file\n","filename":"src\/hotspot\/share\/gc\/shared\/gcLocker.hpp","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"}]}