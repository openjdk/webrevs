{"files":[{"patch":"@@ -509,20 +509,1 @@\n-        SLICE {\n-            @Override\n-            String format(AbstractMemorySegmentImpl segment, long offset, long size, long length) {\n-                return String.format(\n-                        \"Out of bound access on segment %s; attempting to get slice of length %d at offset %d \" +\n-                                \"which is outside the valid range 0 <= offset+length < byteSize (=%d)\",\n-                        segment, size, offset, length\n-                );\n-            }\n-        },\n-        ACCESS {\n-            @Override\n-            String format(AbstractMemorySegmentImpl segment, long offset, long size, long length) {\n-                return String.format(\n-                        \"Out of bound access on segment %s; attempting to access an element of length %d at offset %d \" +\n-                                \"which is outside the valid range 0 <= offset+length < byteSize (=%d)\",\n-                        segment, size, offset, length\n-                );\n-            }\n-        };\n+        ACCESS, SLICE;\n@@ -532,1 +513,8 @@\n-            return new IndexOutOfBoundsException(format(segment, offset, size, length));\n+            String formatString = switch (this) {\n+                case ACCESS -> \"Out of bound access on segment %s; attempting to access an element of length %d at offset %d \" +\n+                        \"which is outside the valid range 0 <= offset+length < byteSize (=%d)\";\n+                case SLICE -> \"Out of bound access on segment %s; attempting to get slice of length %d at offset %d \" +\n+                        \"which is outside the valid range 0 <= offset+length < byteSize (=%d)\";\n+            };\n+            String message = formatString.formatted(segment, size, offset, length);\n+            return new IndexOutOfBoundsException(message);\n@@ -534,2 +522,0 @@\n-\n-        abstract String format(AbstractMemorySegmentImpl segment, long offset, long size, long length);\n@@ -538,9 +524,2 @@\n-    private static final class BoundsCheckHandler implements BiFunction<String, List<Number>, IndexOutOfBoundsException> {\n-        final AbstractMemorySegmentImpl segment;\n-        final BoundPolicy policy;\n-\n-        BoundsCheckHandler(AbstractMemorySegmentImpl segment, BoundPolicy policy) {\n-            this.segment = segment;\n-            this.policy = policy;\n-        }\n-\n+    private record BoundsCheckHandler(AbstractMemorySegmentImpl segment, BoundPolicy policy)\n+            implements BiFunction<String, List<Number>, IndexOutOfBoundsException> {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/AbstractMemorySegmentImpl.java","additions":11,"deletions":32,"binary":false,"changes":43,"status":"modified"}]}