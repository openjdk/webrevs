{"files":[{"patch":"@@ -169,0 +169,3 @@\n+        } catch (RunImageLinkException e) {\n+            \/\/ Propagate reason for run-time image based links\n+            throw e.getReason();\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ImageFileCreator.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -51,1 +51,2 @@\n-        if (handler.analyzer().getExitValue() == 0) {\n+        OutputAnalyzer analyzer = handler.analyzer();\n+        if (analyzer.getExitValue() == 0) {\n@@ -54,1 +55,4 @@\n-        handler.analyzer().stdoutShouldContain(modifiedFile.toString() + \" has been modified\");\n+        analyzer.stdoutShouldContain(modifiedFile.toString() + \" has been modified\");\n+        \/\/ Verify the error message is reasonable\n+        analyzer.stdoutShouldNotContain(\"jdk.tools.jlink.internal.RunImageLinkException\");\n+        analyzer.stdoutShouldNotContain(\"java.lang.IllegalArgumentException\");\n","filename":"test\/jdk\/tools\/jlink\/JmodLess\/ModifiedFilesExitTest.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-import java.util.Scanner;\n@@ -27,0 +26,1 @@\n+import jdk.test.lib.process.OutputAnalyzer;\n@@ -66,0 +66,1 @@\n+        OutputAnalyzer out = handler.analyzer();\n@@ -67,20 +68,3 @@\n-        expectMatch(modifiedFile.toString(), handler.stdErr());\n-        expectMatch(\"WARNING: \", handler.stdErr());\n-        expectMatch(\"has been modified\", handler.stdErr());\n-    }\n-\n-    private static void expectMatch(String string, String lines) {\n-        boolean foundMatch = false;\n-        try (Scanner lineScan = new Scanner(lines)) {\n-            String line;\n-            while (lineScan.hasNextLine()) {\n-                line = lineScan.nextLine();\n-                if (line.contains(string)) {\n-                    foundMatch = true;\n-                    break;\n-                }\n-            }\n-        }\n-        if (!foundMatch) {\n-            throw new AssertionError(String.format(\"Expected to find '%s' in '%s'\", string, lines));\n-        }\n+        out.stderrShouldMatch(\"WARNING: .* has been modified\");\n+        out.stderrShouldNotContain(\"java.lang.IllegalArgumentException\");\n+        out.stderrShouldNotContain(\"jdk.tools.jlink.internal.RunImageLinkException\");\n","filename":"test\/jdk\/tools\/jlink\/JmodLess\/ModifiedFilesWarningTest.java","additions":5,"deletions":21,"binary":false,"changes":26,"status":"modified"}]}