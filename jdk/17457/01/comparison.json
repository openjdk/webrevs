{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -251,1 +251,2 @@\n-    guarantee(res == WAIT_OBJECT_0, \"wait failed\");\n+    guarantee(res != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    guarantee(res == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", res);\n@@ -254,1 +255,3 @@\n-    guarantee(res == WAIT_OBJECT_0, \"wait failed\");\n+    guarantee(res != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    guarantee(res == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", res);\n+\n@@ -341,0 +344,3 @@\n+  assert(res != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+  assert(res == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", res);\n+\n","filename":"src\/hotspot\/os\/windows\/attachListener_windows.cpp","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -5357,1 +5357,2 @@\n-    assert(rv == WAIT_OBJECT_0 || rv == WAIT_TIMEOUT, \"WaitForSingleObject failed\");\n+    assert(rv != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    assert(rv == WAIT_OBJECT_0 || rv == WAIT_TIMEOUT, \"WaitForSingleObject failed with return value: %lu\", rv);\n@@ -5396,1 +5397,2 @@\n-    assert(rv == WAIT_OBJECT_0, \"WaitForSingleObject failed\");\n+    assert(rv != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    assert(rv == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", rv);\n@@ -5459,2 +5461,1 @@\n-  if (thread->is_interrupted(false) ||\n-      WaitForSingleObject(_ParkHandle, 0) == WAIT_OBJECT_0) {\n+  if (thread->is_interrupted(false)) {\n@@ -5464,2 +5465,9 @@\n-    ThreadBlockInVM tbivm(thread);\n-    OSThreadWaitState osts(thread->osthread(), false \/* not Object.wait() *\/);\n+    DWORD rv = WaitForSingleObject(_ParkHandle, 0);\n+    assert(rv != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    assert(rv == WAIT_OBJECT_0 || rv == WAIT_TIMEOUT, \"WaitForSingleObject failed with return value: %lu\", rv);\n+    if (rv == WAIT_OBJECT_0) {\n+      ResetEvent(_ParkHandle);\n+      return;\n+    } else {\n+      ThreadBlockInVM tbivm(thread);\n+      OSThreadWaitState osts(thread->osthread(), false \/* not Object.wait() *\/);\n@@ -5467,2 +5475,5 @@\n-    WaitForSingleObject(_ParkHandle, time);\n-    ResetEvent(_ParkHandle);\n+      rv = WaitForSingleObject(_ParkHandle, time);\n+      assert(rv != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+      assert(rv == WAIT_OBJECT_0 || rv == WAIT_TIMEOUT, \"WaitForSingleObject failed with return value: %lu\", rv);\n+      ResetEvent(_ParkHandle);\n+    }\n@@ -5544,1 +5555,3 @@\n-    WaitForSingleObject(pi.hProcess, INFINITE);\n+    DWORD rv = WaitForSingleObject(pi.hProcess, INFINITE);\n+    assert(rv != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    assert(rv == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", rv);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":23,"deletions":10,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -67,1 +67,2 @@\n-    assert(ret == WAIT_OBJECT_0, \"unexpected return value from WaitForSingleObject\");\n+    assert(ret != WAIT_FAILED,   \"WaitForSingleObject failed with error code: %lu\", GetLastError());\n+    assert(ret == WAIT_OBJECT_0, \"WaitForSingleObject failed with return value: %lu\", ret);\n","filename":"src\/hotspot\/os\/windows\/threadCritical_windows.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}