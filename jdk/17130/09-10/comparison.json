{"files":[{"patch":"@@ -4820,1 +4820,1 @@\n-  void sha1_prepare_k(int round, Register cur_k) {\n+  void sha1_prepare_k(Register cur_k, int round) {\n@@ -4836,0 +4836,6 @@\n+      \/\/ in the first 16 rounds, in ws[], every register contains 2 W't, e.g.\n+      \/\/   in ws[0], high part contains W't-0, low part contains W't-1,\n+      \/\/   in ws[1], high part contains W't-2, low part contains W't-3,\n+      \/\/   ...\n+      \/\/   in ws[7], high part contains W't-14, low part contains W't-15.\n+\n@@ -4944,0 +4950,4 @@\n+\n+    \/\/ cur_w will be recalculated at the beginning of each round,\n+    \/\/ so, we can reuse it as a temp register here.\n+    Register tmp2 = cur_w;\n@@ -4946,7 +4956,5 @@\n-      Register t = e;\n-      \/\/ cur_w will be recalculated at the beginning of each round,\n-      \/\/ so, we can reuse it as a temp register here.\n-      __ add(cur_w, cur_k, cur_w);\n-      __ add(t, t, cur_w);\n-      __ rolw_imm(cur_w, a, 5, t0);\n-      \/\/ as pointed above, we can use cur_w as temporary register here.\n+      Register tmp3 = e;\n+      __ add(tmp2, cur_k, tmp2);\n+      __ add(tmp3, tmp3, tmp2);\n+      __ rolw_imm(tmp2, a, 5, t0);\n+\n@@ -4954,2 +4962,3 @@\n-      __ add(cur_w, cur_w, tmp);\n-      __ add(cur_w, cur_w, t);\n+\n+      __ add(tmp2, tmp2, tmp);\n+      __ add(tmp2, tmp2, tmp3);\n@@ -4965,1 +4974,1 @@\n-    \/\/ as pointed above, we can use cur_w as temporary register here.\n+\n@@ -4968,1 +4977,1 @@\n-    __ mv(a, cur_w);\n+    __ mv(a, tmp2);\n@@ -5060,1 +5069,1 @@\n-    \/\/ at different round (even or odd), w't value resdie in different items in ws[].\n+    \/\/ at different round (even or odd), w't value reside in different items in ws[].\n@@ -5110,1 +5119,1 @@\n-      sha1_prepare_k(round, cur_k);\n+      sha1_prepare_k(cur_k, round);\n@@ -5126,2 +5135,0 @@\n-    const Register mask32 = t2;\n-    __ mv(mask32, 0xffffffff);\n@@ -5129,1 +5136,1 @@\n-    __ andr(a, a, mask32);\n+    __ zero_extend(a, a, 32);\n@@ -5133,1 +5140,1 @@\n-    __ andr(c, c, mask32);\n+    __ zero_extend(c, c, 32);\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":25,"deletions":18,"binary":false,"changes":43,"status":"modified"}]}