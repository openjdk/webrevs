{"files":[{"patch":"@@ -508,0 +508,6 @@\n+  } else if (0 == strcmp(outputstr, StdoutLog->name())) { \/\/ stdout\n+    idx = 0;\n+    assert(find_output(outputstr) == idx, \"sanity check\");\n+  } else if (0 == strcmp(outputstr, StderrLog->name())) { \/\/ stderr\n+    idx = 1;\n+    assert(find_output(outputstr) == idx, \"sanity check\");\n","filename":"src\/hotspot\/share\/logging\/logConfiguration.cpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -259,1 +259,3 @@\n-  set_log_config(\"stdout\", \"logging=debug\");\n+  if (set_log_config(\"stdout\", \"logging=debug\")) {\n+    test_asynclog_ls();\n+    test_asynclog_drop_messages();\n@@ -261,2 +263,2 @@\n-  test_asynclog_ls();\n-  test_asynclog_drop_messages();\n+    AsyncLogWriter::flush();\n+    fflush(nullptr);\n@@ -264,2 +266,5 @@\n-  AsyncLogWriter::flush();\n-  fflush(nullptr);\n+    if (write_to_file(testing::internal::GetCapturedStdout())) {\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"header\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"LogStreamWithAsyncLogImpl\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream msg1-msg2-msg3\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream newline\"));\n@@ -267,8 +272,3 @@\n-  if (write_to_file(testing::internal::GetCapturedStdout())) {\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"header\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"LogStreamWithAsyncLogImpl\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream msg1-msg2-msg3\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream newline\"));\n-\n-    if (AsyncLogWriter::instance() != nullptr) {\n-      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"messages dropped due to async logging\"));\n+      if (AsyncLogWriter::instance() != nullptr) {\n+        EXPECT_TRUE(file_contains_substring(TestLogFileName, \"messages dropped due to async logging\"));\n+      }\n@@ -282,1 +282,3 @@\n-  set_log_config(\"stderr\", \"logging=debug\");\n+  if (set_log_config(\"stderr\", \"logging=debug\")) {\n+    test_asynclog_ls();\n+    test_asynclog_drop_messages();\n@@ -284,2 +286,2 @@\n-  test_asynclog_ls();\n-  test_asynclog_drop_messages();\n+    AsyncLogWriter::flush();\n+    fflush(nullptr);\n@@ -287,2 +289,5 @@\n-  AsyncLogWriter::flush();\n-  fflush(nullptr);\n+    if (write_to_file(testing::internal::GetCapturedStderr())) {\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"header\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"LogStreamWithAsyncLogImpl\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream msg1-msg2-msg3\"));\n+      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream newline\"));\n@@ -290,8 +295,3 @@\n-  if (write_to_file(testing::internal::GetCapturedStderr())) {\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"header\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"LogStreamWithAsyncLogImpl\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream msg1-msg2-msg3\"));\n-    EXPECT_TRUE(file_contains_substring(TestLogFileName, \"logStream newline\"));\n-\n-    if (AsyncLogWriter::instance() != nullptr) {\n-      EXPECT_TRUE(file_contains_substring(TestLogFileName, \"messages dropped due to async logging\"));\n+      if (AsyncLogWriter::instance() != nullptr) {\n+        EXPECT_TRUE(file_contains_substring(TestLogFileName, \"messages dropped due to async logging\"));\n+      }\n","filename":"test\/hotspot\/gtest\/logging\/test_asynclog.cpp","additions":26,"deletions":26,"binary":false,"changes":52,"status":"modified"}]}