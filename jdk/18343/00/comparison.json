{"files":[{"patch":"@@ -42,1 +42,0 @@\n-HSDIS_TOOLCHAIN_LDFLAGS := $(LDFLAGS_JDKLIB)\n@@ -130,1 +129,2 @@\n-    HSDIS_TOOLCHAIN_LDFLAGS := -L$(MINGW_GCC_LIB_PATH) -L$(MINGW_SYSROOT_LIB_PATH)\n+    HSDIS_TOOLCHAIN_DEFAULT_LDFLAGS := false\n+    HSDIS_LDFLAGS += -L$(MINGW_GCC_LIB_PATH) -L$(MINGW_SYSROOT_LIB_PATH)\n@@ -151,1 +151,3 @@\n-    LDFLAGS := $(HSDIS_TOOLCHAIN_LDFLAGS) $(HSDIS_LDFLAGS) $(SHARED_LIBRARY_FLAGS), \\\n+    LD_SET_ORIGIN := false, \\\n+    DEFAULT_LDFLAGS := $(HSDIS_TOOLCHAIN_DEFAULT_LDFLAGS), \\\n+    LDFLAGS := $(HSDIS_LDFLAGS) $(SHARED_LIBRARY_FLAGS), \\\n","filename":"make\/Hsdis.gmk","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -214,0 +214,12 @@\n+  ifneq ($$($1_DEFAULT_LDFLAGS), false)\n+    # Set the default flags first to be able to override\n+    $1_LDFLAGS := $$(filter-out $$($1_LDFLAGS_FILTER_OUT), $$(LDFLAGS_JDKLIB)) $$($1_LDFLAGS)\n+  endif\n+\n+  ifneq ($$($1_LD_SET_ORIGIN), false)\n+    $1_LDFLAGS += $$(call SET_SHARED_LIBRARY_ORIGIN)\n+  endif\n+  # APPEND_LDFLAGS, if it exists, must be set after the origin flags\n+  # This is a workaround to keep existing behavior\n+  $1_LDFLAGS += $$($1_APPEND_LDFLAGS)\n+\n@@ -272,0 +284,9 @@\n+  ifneq ($$($1_DEFAULT_LDFLAGS), false)\n+    # Set the default flags first to be able to override\n+    $1_LDFLAGS := $$(filter-out $$($1_LDFLAGS_FILTER_OUT), $$(LDFLAGS_JDKEXE)) $$($1_LDFLAGS)\n+  endif\n+\n+  ifneq ($$($1_LD_SET_ORIGIN), false)\n+    $1_LDFLAGS += $$(call SET_EXECUTABLE_ORIGIN)\n+  endif\n+\n","filename":"make\/common\/JdkNativeCompilation.gmk","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -152,3 +152,1 @@\n-      LDFLAGS := $$(LDFLAGS_JDKEXE) \\\n-          $$(call SET_EXECUTABLE_ORIGIN) \\\n-          $$($1_LDFLAGS), \\\n+      LDFLAGS := $$($1_LDFLAGS), \\\n","filename":"make\/common\/modules\/LauncherCommon.gmk","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -108,0 +108,2 @@\n+    LD_SET_ORIGIN := false, \\\n+    DEFAULT_LDFLAGS := false, \\\n@@ -145,1 +147,1 @@\n-    LDFLAGS := $(LDFLAGS_JDKEXE), \\\n+    LD_SET_ORIGIN := false, \\\n","filename":"make\/hotspot\/lib\/CompileGtest.gmk","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -206,0 +206,2 @@\n+    LD_SET_ORIGIN := false, \\\n+    DEFAULT_LDFLAGS := false, \\\n","filename":"make\/hotspot\/lib\/CompileJvm.gmk","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -66,1 +66,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKEXE), \\\n+      LD_SET_ORIGIN := false, \\\n@@ -83,1 +83,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKEXE), \\\n+      LD_SET_ORIGIN := false, \\\n","filename":"make\/modules\/java.base\/Launcher.gmk","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -52,2 +52,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -78,2 +76,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -103,3 +99,1 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            -L$(SUPPORT_OUTPUTDIR)\/modules_libs\/java.base \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+        LDFLAGS := -L$(SUPPORT_OUTPUTDIR)\/modules_libs\/java.base,\\\n@@ -129,2 +123,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -207,1 +199,1 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB), \\\n+    LD_SET_ORIGIN := false, \\\n@@ -223,2 +215,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-                 $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -240,2 +230,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.base\/Lib.gmk","additions":2,"deletions":14,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -38,2 +38,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -60,2 +58,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -99,2 +95,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -116,2 +110,1 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+    LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n@@ -172,2 +165,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.base\/lib\/CoreLibraries.gmk","additions":1,"deletions":10,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -67,2 +67,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -93,2 +91,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -121,3 +117,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          -L$(SUPPORT_OUTPUTDIR)\/modules_libs\/java.desktop \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+      LDFLAGS := -L$(SUPPORT_OUTPUTDIR)\/modules_libs\/java.desktop, \\\n","filename":"make\/modules\/java.desktop\/Lib.gmk","additions":1,"deletions":7,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -53,2 +53,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -148,1 +146,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -269,4 +266,2 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN) \\\n-            -L$(INSTALL_LIBRARIES_HERE), \\\n-        LIBS :=  $(X_LIBS) $(LIBAWT_XAWT_LIBS), \\\n+        LDFLAGS := -L$(INSTALL_LIBRARIES_HERE), \\\n+        LIBS := $(X_LIBS) $(LIBAWT_XAWT_LIBS), \\\n@@ -320,2 +315,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -362,2 +355,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -412,2 +403,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -453,2 +442,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -563,3 +550,2 @@\n-    LDFLAGS := $(subst -Xlinker -z -Xlinker defs,, \\\n-        $(subst -Wl$(COMMA)-z$(COMMA)defs,,$(LDFLAGS_JDKLIB))) $(LDFLAGS_CXX_JDK) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+    LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n+    LDFLAGS_FILTER_OUT :=-Wl$(COMMA)-z$(COMMA)defs, \\\n@@ -614,1 +600,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK), \\\n+      LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n@@ -660,2 +646,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -814,2 +798,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -881,3 +863,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN) \\\n-          -L$(INSTALL_LIBRARIES_HERE), \\\n+      LDFLAGS := -L$(INSTALL_LIBRARIES_HERE), \\\n@@ -946,4 +926,2 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN) \\\n-          -Wl$(COMMA)-rpath$(COMMA)@loader_path \\\n-          -L$(INSTALL_LIBRARIES_HERE), \\\n+      APPEND_LDFLAGS := -Wl$(COMMA)-rpath$(COMMA)@loader_path, \\\n+      LDFLAGS := -L$(INSTALL_LIBRARIES_HERE), \\\n","filename":"make\/modules\/java.desktop\/lib\/Awt2dLibraries.gmk","additions":8,"deletions":30,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -43,3 +43,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN) \\\n-        $(LIBINSTRUMENT_LDFLAGS), \\\n","filename":"make\/modules\/java.instrument\/Lib.gmk","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -40,2 +40,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.management\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -39,2 +39,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.prefs\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,2 +33,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.rmi\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -36,2 +36,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -48,2 +46,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -64,2 +60,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -79,2 +73,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.security.jgss\/Lib.gmk","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,2 +35,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/java.smartcardio\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -50,1 +50,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKEXE), \\\n@@ -72,1 +71,1 @@\n-      LDFLAGS := $$(LDFLAGS_JDKEXE) -stack:655360, \\\n+      LDFLAGS := -stack:655360, \\\n@@ -94,1 +93,1 @@\n-      LDFLAGS := $$(LDFLAGS_JDKEXE) -stack:655360, \\\n+      LDFLAGS := -stack:655360, \\\n","filename":"make\/modules\/jdk.accessibility\/Launcher.gmk","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB), \\\n@@ -77,1 +76,1 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n+        LDFLAGS := \\\n@@ -94,1 +93,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB), \\\n","filename":"make\/modules\/jdk.accessibility\/Lib.gmk","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -42,2 +42,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.attach\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,2 +34,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.crypto.cryptoki\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,2 +35,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+      LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n","filename":"make\/modules\/jdk.crypto.mscapi\/Lib.gmk","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -68,1 +68,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.hotspot.agent\/Lib.gmk","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -33,2 +33,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.incubator.vector\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB), \\\n+      LD_SET_ORIGIN := false, \\\n","filename":"make\/modules\/jdk.internal.le\/Lib.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB), \\\n","filename":"make\/modules\/jdk.jdi\/Lib.gmk","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -37,2 +37,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n@@ -63,2 +61,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.jdwp.agent\/Lib.gmk","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -67,1 +67,1 @@\n-    LDFLAGS := $(LDFLAGS_JDKEXE), \\\n+    LD_SET_ORIGIN := false, \\\n@@ -102,1 +102,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB), \\\n+      LD_SET_ORIGIN := false, \\\n@@ -120,2 +120,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n+      LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n@@ -143,1 +142,1 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) $(LDFLAGS_CXX_JDK), \\\n+      LDFLAGS := $(LDFLAGS_CXX_JDK), \\\n@@ -163,1 +162,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKEXE), \\\n@@ -181,0 +179,1 @@\n+      LD_SET_ORIGIN := $(BUILD_JPACKAGE_APPLAUNCHEREXE_LD_SET_ORIGIN), \\\n","filename":"make\/modules\/jdk.jpackage\/Lib.gmk","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -33,2 +33,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.management.agent\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -49,2 +49,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.management\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,2 +35,0 @@\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-          $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.net\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -40,2 +40,0 @@\n-        LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-            $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.sctp\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,2 +33,0 @@\n-    LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n","filename":"make\/modules\/jdk.security.auth\/Lib.gmk","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}