{"files":[{"patch":"@@ -233,9 +233,5 @@\n-    static void validateSIPUSH(ConstantDesc d) {\n-        if (d instanceof Integer iVal && Short.MIN_VALUE <= iVal && iVal <= Short.MAX_VALUE)\n-            return;\n-\n-        if (d instanceof Long lVal && Short.MIN_VALUE <= lVal && Short.MAX_VALUE <= lVal)\n-            return;\n-\n-        throw new IllegalArgumentException(\"SIPUSH: value must be within: Short.MIN_VALUE <= value <= Short.MAX_VALUE\"\n-                                           + \", found: \" + d);\n+    static void validateSipush(long value) {\n+        if (value < Short.MIN_VALUE || Short.MAX_VALUE < value)\n+            throw new IllegalArgumentException(\n+                    \"SIPUSH: value must be within: Short.MIN_VALUE <= value <= Short.MAX_VALUE, found: \"\n+                            .concat(Long.toString(value)));\n@@ -244,3 +240,6 @@\n-    static void validateBIPUSH(ConstantDesc d) {\n-        if (d instanceof Integer iVal && Byte.MIN_VALUE <= iVal && iVal <= Byte.MAX_VALUE)\n-            return;\n+    static void validateBipush(long value) {\n+        if (value < Byte.MIN_VALUE || Byte.MAX_VALUE < value)\n+            throw new IllegalArgumentException(\n+                    \"BIPUSH: value must be within: Byte.MIN_VALUE <= value <= Byte.MAX_VALUE, found: \"\n+                            .concat(Long.toString(value)));\n+    }\n@@ -248,2 +247,9 @@\n-        if (d instanceof Long lVal && Byte.MIN_VALUE <= lVal && Byte.MAX_VALUE <= lVal)\n-            return;\n+    static void validateSipush(ConstantDesc d) {\n+        if (d instanceof Integer iVal) {\n+            validateSipush(iVal.longValue());\n+        } else if (d instanceof Long lVal) {\n+            validateSipush(lVal.longValue());\n+        } else {\n+            throw new IllegalArgumentException(\"SIPUSH: not an integral number: \".concat(d.toString()));\n+        }\n+    }\n@@ -251,2 +257,8 @@\n-        throw new IllegalArgumentException(\"BIPUSH: value must be within: Byte.MIN_VALUE <= value <= Byte.MAX_VALUE\"\n-                                           + \", found: \" + d);\n+    static void validateBipush(ConstantDesc d) {\n+        if (d instanceof Integer iVal) {\n+            validateBipush(iVal.longValue());\n+        } else if (d instanceof Long lVal) {\n+            validateBipush(lVal.longValue());\n+        } else {\n+            throw new IllegalArgumentException(\"BIPUSH: not an integral number: \".concat(d.toString()));\n+        }\n@@ -292,1 +304,1 @@\n-                    validateSIPUSH(v);\n+                    validateSipush(v);\n@@ -294,1 +306,1 @@\n-                    validateBIPUSH(v);\n+                    validateBipush(v);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/classfile\/impl\/BytecodeHelpers.java","additions":30,"deletions":18,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -540,1 +540,1 @@\n-        writeBytecode(Opcode.LOOKUPSWITCH);\n+        writeBytecode(LOOKUPSWITCH);\n@@ -561,1 +561,1 @@\n-        writeBytecode(Opcode.TABLESWITCH);\n+        writeBytecode(TABLESWITCH);\n@@ -597,1 +597,1 @@\n-        writeBytecode(Opcode.INVOKEDYNAMIC);\n+        writeBytecode(INVOKEDYNAMIC);\n@@ -603,1 +603,1 @@\n-        writeBytecode(Opcode.NEW);\n+        writeBytecode(NEW);\n@@ -608,1 +608,1 @@\n-        writeBytecode(Opcode.NEWARRAY);\n+        writeBytecode(NEWARRAY);\n@@ -613,1 +613,1 @@\n-        writeBytecode(Opcode.ANEWARRAY);\n+        writeBytecode(ANEWARRAY);\n@@ -618,1 +618,1 @@\n-        writeBytecode(Opcode.MULTIANEWARRAY);\n+        writeBytecode(MULTIANEWARRAY);\n@@ -798,1 +798,1 @@\n-        if (opcode == Opcode.INVOKEINTERFACE) {\n+        if (opcode == INVOKEINTERFACE) {\n@@ -854,1 +854,1 @@\n-        writeBytecode(Opcode.ACONST_NULL);\n+        writeBytecode(ACONST_NULL);\n@@ -878,1 +878,1 @@\n-        BytecodeHelpers.validateBIPUSH(b);\n+        BytecodeHelpers.validateBipush(b);\n@@ -1458,1 +1458,1 @@\n-        BytecodeHelpers.validateSIPUSH(s);\n+        BytecodeHelpers.validateSipush(s);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/classfile\/impl\/DirectCodeBuilder.java","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"}]}