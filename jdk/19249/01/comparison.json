{"files":[{"patch":"@@ -4183,1 +4183,1 @@\n-    if (loaded->ptr() == TypePtr::TopPTR)        { return unloaded; }\n+    if (loaded->ptr() == TypePtr::TopPTR)        { return unloaded->with_speculative(speculative); }\n@@ -4185,1 +4185,1 @@\n-    else if (loaded->ptr() == TypePtr::BotPTR)   { return TypeInstPtr::BOTTOM; }\n+    else if (loaded->ptr() == TypePtr::BotPTR)   { return TypeInstPtr::BOTTOM->with_speculative(speculative); }\n@@ -4187,2 +4187,2 @@\n-      if (unloaded->ptr() == TypePtr::BotPTR)    { return TypeInstPtr::BOTTOM;  }\n-      else                                       { return TypeInstPtr::NOTNULL; }\n+      if (unloaded->ptr() == TypePtr::BotPTR)    { return TypeInstPtr::BOTTOM->with_speculative(speculative);  }\n+      else                                       { return TypeInstPtr::NOTNULL->with_speculative(speculative); }\n@@ -4190,1 +4190,1 @@\n-    else if (unloaded->ptr() == TypePtr::TopPTR) { return unloaded; }\n+    else if (unloaded->ptr() == TypePtr::TopPTR) { return unloaded->with_speculative(speculative); }\n@@ -4192,1 +4192,1 @@\n-    return unloaded->cast_to_ptr_type(TypePtr::AnyNull)->is_instptr();\n+    return unloaded->cast_to_ptr_type(TypePtr::AnyNull)->is_instptr()->with_speculative(speculative);\n@@ -4198,1 +4198,1 @@\n-    return TypeInstPtr::NOTNULL;\n+    return TypeInstPtr::NOTNULL->with_speculative(speculative);\n@@ -4200,1 +4200,1 @@\n-  return TypeInstPtr::BOTTOM;\n+  return TypeInstPtr::BOTTOM->with_speculative(speculative);\n@@ -4603,0 +4603,4 @@\n+const TypeInstPtr* TypeInstPtr::with_speculative(const TypePtr* speculative) const {\n+  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), _offset, _instance_id, speculative, _inline_depth);\n+}\n+\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -1359,0 +1359,1 @@\n+  const TypeInstPtr* with_speculative(const TypePtr* speculative) const;\n","filename":"src\/hotspot\/share\/opto\/type.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -34,0 +34,6 @@\n+ *\n+ * @run main\/othervm -Xbootclasspath\/a:.\n+ *                   -Xbatch -XX:-TieredCompilation -XX:CompileCommand=exclude,*::test\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:+PrintCompilation -XX:+PrintInlining\n+ *                      compiler.runtime.unloaded.TestMHUnloaded\n+ *\n@@ -37,0 +43,1 @@\n+ *                   -XX:+IgnoreUnrecognizedVMOptions -XX:+AlwaysIncrementalInline\n","filename":"test\/hotspot\/jtreg\/compiler\/runtime\/unloaded\/TestMHUnloaded.java","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"}]}