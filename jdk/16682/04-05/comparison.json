{"files":[{"patch":"@@ -372,2 +372,1 @@\n-        delete[] value;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -376,0 +375,8 @@\n+    goto execution;\n+\n+err:\n+    delete[] value;\n+    return GSS_S_FAILURE;\n+\n+execution:\n+\n@@ -378,2 +385,1 @@\n-        delete[] value;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -395,2 +401,1 @@\n-        delete[] value;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -417,2 +422,1 @@\n-        delete[] value;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -533,4 +537,1 @@\n-        if (fullname != name) {\n-            delete[] fullname;\n-        }\n-        return result;\n+        goto err;\n@@ -542,4 +543,1 @@\n-        if (fullname != name) {\n-            delete[] fullname;\n-        }\n-        return result;\n+        goto err;\n@@ -551,6 +549,3 @@\n-    char* buffer = (char*) malloc(10 + mechLen + len);\n-    if (buffer == NULL) {\n-        if (fullname != name) {\n-            delete[] fullname;\n-        }\n-        return result;\n+    char* buffer = static_cast<char*>(malloc(10 + mechLen + len));\n+    if (buffer == nullptr) {\n+        goto err;\n@@ -571,4 +566,1 @@\n-        if (fullname != name) {\n-            delete[] fullname;\n-        }\n-        return result;\n+        goto err;\n@@ -579,1 +571,1 @@\n-\n+err:\n@@ -907,0 +899,16 @@\n+    goto execution;\n+\n+err:\n+    if (firstTime) {\n+        OM_uint32 dummy;\n+        gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n+    }\n+    delete newCred;\n+    if (output_token->value) {\n+        gss_release_buffer(NULL, output_token);\n+    }\n+    output_token = GSS_C_NO_BUFFER;\n+    return GSS_S_FAILURE;\n+\n+execution:\n+\n@@ -916,10 +924,1 @@\n-        if (firstTime) {\n-            OM_uint32 dummy;\n-            gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-        }\n-        delete newCred;\n-        if (output_token->value) {\n-            gss_release_buffer(NULL, output_token);\n-        }\n-        output_token = GSS_C_NO_BUFFER;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -960,10 +959,1 @@\n-                if (firstTime) {\n-                    OM_uint32 dummy;\n-                    gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-                }\n-                delete newCred;\n-                if (output_token->value) {\n-                    gss_release_buffer(NULL, output_token);\n-                }\n-                output_token = GSS_C_NO_BUFFER;\n-                return GSS_S_FAILURE;\n+                goto err;\n@@ -989,10 +979,1 @@\n-                if (firstTime) {\n-                    OM_uint32 dummy;\n-                    gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-                }\n-                delete newCred;\n-                if (output_token->value) {\n-                    gss_release_buffer(NULL, output_token);\n-                }\n-                output_token = GSS_C_NO_BUFFER;\n-                return GSS_S_FAILURE;\n+                goto err;\n@@ -1020,10 +1001,1 @@\n-        if (firstTime) {\n-            OM_uint32 dummy;\n-            gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-        }\n-        delete newCred;\n-        if (output_token->value) {\n-            gss_release_buffer(NULL, output_token);\n-        }\n-        output_token = GSS_C_NO_BUFFER;\n-        return GSS_S_FAILURE;\n+        goto err;\n@@ -1048,10 +1020,1 @@\n-            if (firstTime) {\n-                OM_uint32 dummy;\n-                gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-            }\n-            delete newCred;\n-            if (output_token->value) {\n-                gss_release_buffer(NULL, output_token);\n-            }\n-            output_token = GSS_C_NO_BUFFER;\n-            return GSS_S_FAILURE;\n+            goto err;\n@@ -1069,10 +1032,1 @@\n-            if (firstTime) {\n-                OM_uint32 dummy;\n-                gss_delete_sec_context(&dummy, context_handle, GSS_C_NO_BUFFER);\n-            }\n-            delete newCred;\n-            if (output_token->value) {\n-                gss_release_buffer(NULL, output_token);\n-            }\n-            output_token = GSS_C_NO_BUFFER;\n-            return GSS_S_FAILURE;\n+            goto err;\n","filename":"src\/java.security.jgss\/windows\/native\/libsspi_bridge\/sspi.cpp","additions":41,"deletions":87,"binary":false,"changes":128,"status":"modified"}]}