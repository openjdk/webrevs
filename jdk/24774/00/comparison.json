{"files":[{"patch":"@@ -27,1 +27,1 @@\n- * @requires (os.family != \"mac\")\n+ * @key headful\n@@ -35,0 +35,2 @@\n+import java.awt.Robot;\n+import javax.swing.JFrame;\n@@ -44,0 +46,1 @@\n+    private static JFrame frame;\n@@ -48,6 +51,3 @@\n-        String osName = System.getProperty(\"os.name\");\n-        if (osName.toLowerCase().contains(\"os x\")) {\n-            System.out.println(\"This test is not for MacOS, considered passed.\");\n-            return;\n-        }\n-        SwingUtilities.invokeAndWait(() -> setupTest());\n+        try {\n+            Robot robot = new Robot();\n+            SwingUtilities.invokeAndWait(() -> createAndShowGUI());\n@@ -55,4 +55,7 @@\n-        SwingUtilities.invokeAndWait(() -> sbar.pressMouse());\n-        if (!mousePressLatch.await(2, TimeUnit.SECONDS)) {\n-            throw new RuntimeException(\"Timed out waiting for mouse press\");\n-        }\n+            robot.waitForIdle();\n+            robot.delay(1000);\n+\n+            SwingUtilities.invokeAndWait(() -> sbar.pressMouse());\n+            if (!mousePressLatch.await(2, TimeUnit.SECONDS)) {\n+                throw new RuntimeException(\"Timed out waiting for mouse press\");\n+            }\n@@ -60,2 +63,10 @@\n-        if (getValue() != 9) {\n-            throw new RuntimeException(\"The scrollbar block increment is incorrect\");\n+            if (getValue() != 9) {\n+                throw new RuntimeException(\"The scrollbar block increment \" +\n+                                            getValue() + \" is incorrect\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n@@ -76,2 +87,2 @@\n-    private static void setupTest() {\n-\n+    private static void createAndShowGUI() {\n+        frame = new JFrame(\"bug4865918\");\n@@ -86,1 +97,5 @@\n-\n+        frame.getContentPane().add(sbar);\n+        frame.pack();\n+        frame.setLocationRelativeTo(null);\n+        frame.setVisible(true);\n+        frame.toFront();\n","filename":"test\/jdk\/javax\/swing\/JScrollBar\/4865918\/bug4865918.java","additions":31,"deletions":16,"binary":false,"changes":47,"status":"modified"}]}