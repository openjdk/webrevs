{"files":[{"patch":"@@ -53,0 +53,4 @@\n+    static final int INT_RANDOM_CONST = RANDOM.nextInt();\n+    static final int INT_RANDOM_SHIFT = RANDOM.nextInt();\n+    static final int INT_RANDOM_MASK = RANDOM.nextInt();\n+\n@@ -60,1 +64,18 @@\n-    static final int ADD_CONST = RANDOM.nextInt();\n+    static final long LONG_RANDOM_CONST = RANDOM.nextLong();\n+    static final long LONG_RANDOM_SHIFT = RANDOM.nextLong();\n+    static final long LONG_RANDOM_MASK = RANDOM.nextLong();\n+\n+    @Test\n+    public static int intSumAndMask(int i, int j) {\n+        return (j + i << INT_RANDOM_SHIFT + INT_RANDOM_CONST) & INT_RANDOM_MASK;\n+    }\n+\n+    @Run(test = { \"intSumAndMask\" })\n+    public static void checkIntSumAndMask() {\n+        int j = RANDOM.nextInt();\n+        int i = RANDOM.nextInt();\n+        int res = intSumAndMask(i, j);\n+        if (res != ((j + i << INT_RANDOM_SHIFT + INT_RANDOM_CONST) & INT_RANDOM_MASK)) {\n+            throw new RuntimeException(\"incorrect result: \" + res);\n+        }\n+    }\n@@ -76,0 +97,15 @@\n+    @Test\n+    public static long longSumAndMask(long i, long j) {\n+        return (j + i << LONG_RANDOM_SHIFT + LONG_RANDOM_CONST) & LONG_RANDOM_MASK;\n+    }\n+\n+    @Run(test = { \"longSumAndMask\" })\n+    public static void checkLongSumAndMask() {\n+        long j = RANDOM.nextLong();\n+        long i = RANDOM.nextLong();\n+        long res = longSumAndMask(i, j);\n+        if (res != ((j + i << LONG_RANDOM_SHIFT + LONG_RANDOM_CONST) & LONG_RANDOM_MASK)) {\n+            throw new RuntimeException(\"incorrect result: \" + res);\n+        }\n+    }\n+\n@@ -156,1 +192,1 @@\n-        return (j + ((i + ADD_CONST) << INT_MASK_WIDTH)) & INT_MASK; \/\/ transformed to: return j & INT_MASK;\n+        return (j + ((i + INT_RANDOM_CONST) << INT_MASK_WIDTH)) & INT_MASK; \/\/ transformed to: return j & INT_MASK;\n@@ -259,1 +295,1 @@\n-        return (j + ((i - 5) << LONG_MASK_WIDTH)) & LONG_MASK; \/\/ transformed to: return j & INT_MASK;\n+        return (j + ((i + LONG_RANDOM_CONST) << LONG_MASK_WIDTH)) & LONG_MASK; \/\/ transformed to: return j & LONG_MASK;\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/irTests\/TestShiftAndMask.java","additions":39,"deletions":3,"binary":false,"changes":42,"status":"modified"}]}