{"files":[{"patch":"@@ -25,0 +25,1 @@\n+#include <sys\/resource.h>\n@@ -27,0 +28,2 @@\n+static jint limit_num_fds();\n+\n@@ -29,0 +32,6 @@\n+  \/\/ Lower the number of possible open files to make the test go faster\n+  jint ret = limit_num_fds();\n+  if (ret != 0) {\n+    return ret;\n+  }\n+\n@@ -37,0 +46,23 @@\n+\n+static jint limit_num_fds() {\n+  struct rlimit rl;\n+\n+  \/\/ Fetch the current limit\n+  int ret = getrlimit(RLIMIT_NOFILE, &rl);\n+  if (ret != 0) {\n+    return JNI_ERR;\n+  }\n+\n+  \/\/ Use a lower value unless it is already low\n+  if (100 < rl.rlim_cur) {\n+    rl.rlim_cur = 100;\n+  }\n+\n+  \/\/ Lower the value\n+  int ret2 = setrlimit(RLIMIT_NOFILE, &rl);\n+  if (ret2 != 0) {\n+    return JNI_ERR;\n+  }\n+\n+  return JNI_OK;\n+}\n","filename":"test\/jdk\/java\/lang\/ProcessBuilder\/FDLeakTest\/libFDLeaker.c","additions":32,"deletions":0,"binary":false,"changes":32,"status":"modified"}]}