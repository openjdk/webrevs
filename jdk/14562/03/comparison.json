{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @summary Test verifies that jhsdb jmap could generate heap dump from core when metspace is full\n+ * @summary Test verifies that jhsdb jmap could generate heap dump from core when metaspace is full\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/TestJmapCoreMetaspace.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -56,1 +56,1 @@\n-                \"isHardenedOSX\");\n+                \"isHardenedOSX\", \"hasOSXPlistEntries\");\n","filename":"test\/lib-test\/jdk\/test\/lib\/TestMutuallyExclusivePlatformPredicates.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -263,11 +263,1 @@\n-    \/**\n-     * Return true if the test JDK is hardened, otherwise false. Only valid on OSX.\n-     *\/\n-    public static boolean isHardenedOSX() throws IOException {\n-        \/\/ We only care about hardened binaries for 10.14 and later (actually 10.14.5, but\n-        \/\/ for simplicity we'll also include earlier 10.14 versions).\n-        if (getOsVersionMajor() == 10 && getOsVersionMinor() < 14) {\n-            return false; \/\/ assume not hardened\n-        }\n-\n-        \/\/ Find the path to the java binary.\n+    private static Process launchCodesignOnJavaBinary() throws IOException {\n@@ -280,2 +270,0 @@\n-\n-        \/\/ Run codesign on the java binary.\n@@ -285,0 +273,30 @@\n+        return codesignProcess;\n+    }\n+\n+    public static boolean hasOSXPlistEntries() throws IOException {\n+        Process codesignProcess = launchCodesignOnJavaBinary();\n+        BufferedReader is = new BufferedReader(new InputStreamReader(codesignProcess.getInputStream()));\n+        String line;\n+        while ((line = is.readLine()) != null) {\n+            System.out.println(\"STDOUT: \" + line);\n+            if (line.indexOf(\"Info.plist=not bound\") != -1) {\n+                return false;\n+            }\n+            if (line.indexOf(\"Info.plist entries=\") != -1) {\n+                return true;\n+            }\n+        }\n+        System.out.println(\"No matching Info.plist entry was found\");\n+        return false;\n+    }\n+\n+    \/**\n+     * Return true if the test JDK is hardened, otherwise false. Only valid on OSX.\n+     *\/\n+    public static boolean isHardenedOSX() throws IOException {\n+        \/\/ We only care about hardened binaries for 10.14 and later (actually 10.14.5, but\n+        \/\/ for simplicity we'll also include earlier 10.14 versions).\n+        if (getOsVersionMajor() == 10 && getOsVersionMinor() < 14) {\n+            return false; \/\/ assume not hardened\n+        }\n+        Process codesignProcess = launchCodesignOnJavaBinary();\n","filename":"test\/lib\/jdk\/test\/lib\/Platform.java","additions":32,"deletions":14,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -130,0 +130,2 @@\n+        } else {\n+            System.out.println(\"Core file not found. Trying to find a reason why...\");\n@@ -151,0 +153,5 @@\n+            } else {\n+                \/\/ codesign has to add entitlements using the plist. If this is not present we might not generate a core file.\n+                if (!Platform.hasOSXPlistEntries()) {\n+                    throw new SkippedException(\"Cannot produce core file with binary having no plist entitlement entries\");\n+                }\n","filename":"test\/lib\/jdk\/test\/lib\/util\/CoreUtils.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"}]}