{"files":[{"patch":"@@ -390,9 +390,0 @@\n-#define CHECK_EXCEPTION_NULL_FAIL(obj) \\\n-    do { \\\n-        if ((*env)->ExceptionOccurred(env)) { \\\n-            return 0; \\\n-        } else if (obj == NULL) { \\\n-            return 0; \\\n-        } \\\n-    } while (JNI_FALSE)\n-\n@@ -400,2 +391,3 @@\n- * Invoke a static main with arguments. Returns 1 (true) if successful otherwise\n- * processes the pending exception from GetStaticMethodID and returns 0 (false).\n+ * Invokes static main(String[]) method if found.\n+ * Returns 0 with a pending exception if not found. Returns 1 if invoked, maybe\n+ * a pending exception if the method threw.\n@@ -407,1 +399,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainID);\n+    if (mainID == NULL) {\n+        \/\/ static main(String[]) not found\n+        return 0;\n+    }\n@@ -409,1 +404,1 @@\n-    return 1;\n+    return 1; \/\/ method was invoked\n@@ -413,2 +408,3 @@\n- * Invoke an instance main with arguments. Returns 1 (true) if successful otherwise\n- * processes the pending exception from GetMethodID and returns 0 (false).\n+ * Invokes instance main(String[]) method if found.\n+ * Returns 0 with a pending exception if not found. Returns 1 if invoked, maybe\n+ * a pending exception if the method threw.\n@@ -419,1 +415,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(constructor);\n+    if (constructor == NULL) {\n+        \/\/ main class' no-arg constructor not found\n+        return 0;\n+    }\n@@ -421,1 +420,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainObject);\n+    if (mainObject == NULL) {\n+        \/\/ main class instance couldn't be constructed\n+        return 0;\n+    }\n@@ -424,1 +426,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainID);\n+    if (mainID == NULL) {\n+        \/\/ instance method main(String[]) method not found\n+        return 0;\n+    }\n@@ -426,1 +431,1 @@\n-    return 1;\n+    return 1; \/\/ method was invoked\n@@ -430,2 +435,3 @@\n- * Invoke a static main without arguments. Returns 1 (true) if successful otherwise\n- * processes the pending exception from GetStaticMethodID and returns 0 (false).\n+ * Invokes no-arg static main() method if found.\n+ * Returns 0 with a pending exception if not found. Returns 1 if invoked, maybe\n+ * a pending exception if the method threw.\n@@ -437,1 +443,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainID);\n+    if (mainID == NULL) {\n+        \/\/ static main() method couldn't be located\n+        return 0;\n+    }\n@@ -439,1 +448,1 @@\n-    return 1;\n+    return 1; \/\/ method was invoked\n@@ -443,2 +452,3 @@\n- * Invoke an instance main without arguments. Returns 1 (true) if successful otherwise\n- * processes the pending exception from GetMethodID and returns 0 (false).\n+ * Invokes no-arg instance main() method if found.\n+ * Returns 0 with a pending exception if not found. Returns 1 if invoked, maybe\n+ * a pending exception if the method threw.\n@@ -449,1 +459,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(constructor);\n+    if (constructor == NULL) {\n+        \/\/ main class' no-arg constructor not found\n+        return 0;\n+    }\n@@ -451,1 +464,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainObject);\n+    if (mainObject == NULL) {\n+        \/\/ couldn't create instance of main class\n+        return 0;\n+    }\n@@ -454,1 +470,4 @@\n-    CHECK_EXCEPTION_NULL_FAIL(mainID);\n+    if (mainID == NULL) {\n+        \/\/ instance method main() not found\n+        return 0;\n+    }\n@@ -456,1 +475,1 @@\n-    return 1;\n+    return 1; \/\/ method was invoked\n@@ -642,0 +661,2 @@\n+        \/\/ An appropriate main method couldn't be located, check and report\n+        \/\/ any exception and LEAVE()\n@@ -649,2 +670,9 @@\n-    ret = (*env)->ExceptionOccurred(env) == NULL ? 0 : 1;\n-\n+    if (ret && (*env)->ExceptionOccurred(env) == NULL) {\n+        \/\/ main method was invoked and no exception was thrown from it,\n+        \/\/ return success.\n+        ret = 0;\n+    } else {\n+        \/\/ Either the main method couldn't be located or an exception occurred\n+        \/\/ in the invoked main method, return failure.\n+        ret = 1;\n+    }\n","filename":"src\/java.base\/share\/native\/libjli\/java.c","additions":59,"deletions":31,"binary":false,"changes":90,"status":"modified"}]}