{"files":[{"patch":"@@ -52,1 +52,2 @@\n-SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base>* VirtualMemoryTracker::_reserved_regions;\n+SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base, AnyObj::ARENA>* VirtualMemoryTracker::_reserved_regions;\n+Arena* VirtualMemoryTracker::_backing_arena;\n@@ -110,0 +111,19 @@\n+ReservedMemoryRegion::ReservedMemoryRegion(address base, size_t size, const NativeCallStack& stack, MEMFLAGS flag) :\n+  VirtualMemoryRegion(base, size),\n+  _committed_regions(VirtualMemoryTracker::_backing_arena),\n+  _stack(stack), _flag(flag) { }\n+\n+\n+ReservedMemoryRegion::ReservedMemoryRegion(address base, size_t size) :\n+  VirtualMemoryRegion(base, size),\n+  _committed_regions(VirtualMemoryTracker::_backing_arena),\n+  _stack(NativeCallStack::empty_stack()), _flag(mtNone) { }\n+\n+\/\/ Copy constructor\n+ReservedMemoryRegion::ReservedMemoryRegion(const ReservedMemoryRegion& rr) :\n+    VirtualMemoryRegion(rr.base(), rr.size()),\n+    _committed_regions(VirtualMemoryTracker::_backing_arena) {\n+    *this = rr;\n+}\n+\n+\n@@ -326,0 +346,1 @@\n+    _backing_arena = new (mtNMT) Arena{mtNMT, Chunk::size};\n@@ -327,1 +348,1 @@\n-      SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base>();\n+      SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base, AnyObj::ARENA>(_backing_arena);\n@@ -467,1 +488,3 @@\n-  ReservedMemoryRegion backup(*rgn);\n+  address base = rgn->base();\n+  size_t size = rgn->size();\n+  const char* flag_name = rgn->flag_name();\n@@ -470,1 +493,1 @@\n-                backup.flag_name(), p2i(backup.base()), backup.size(), (result ? \"Succeeded\" : \"Failed\"));\n+                flag_name, p2i(base), size, (result ? \"Succeeded\" : \"Failed\"));\n@@ -478,1 +501,1 @@\n-                backup.flag_name(), p2i(backup.base()), backup.size(), (result ? \"Succeeded\" : \"Failed\"));\n+                flag_name, p2i(base), size, (result ? \"Succeeded\" : \"Failed\"));\n","filename":"src\/hotspot\/share\/services\/virtualMemoryTracker.cpp","additions":28,"deletions":5,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+#include \"memory\/arena.hpp\"\n@@ -38,3 +39,1 @@\n-\/*\n- * Virtual memory counter\n- *\/\n+\/\/ Virtual memory counter\n@@ -287,1 +286,1 @@\n-  SortedLinkedList<CommittedMemoryRegion, compare_committed_region>\n+  SortedLinkedList<CommittedMemoryRegion, compare_committed_region, AnyObj::ARENA>\n@@ -294,7 +293,0 @@\n-  ReservedMemoryRegion(address base, size_t size, const NativeCallStack& stack,\n-    MEMFLAGS flag = mtNone) :\n-    VirtualMemoryRegion(base, size), _stack(stack), _flag(flag) { }\n-\n-\n-  ReservedMemoryRegion(address base, size_t size) :\n-    VirtualMemoryRegion(base, size), _stack(NativeCallStack::empty_stack()), _flag(mtNone) { }\n@@ -302,5 +294,2 @@\n-  \/\/ Copy constructor\n-  ReservedMemoryRegion(const ReservedMemoryRegion& rr) :\n-    VirtualMemoryRegion(rr.base(), rr.size()) {\n-    *this = rr;\n-  }\n+  ReservedMemoryRegion(address base, size_t size, const NativeCallStack& stack, MEMFLAGS flag = mtNone);\n+  ReservedMemoryRegion(address base, size_t size);\n@@ -330,0 +319,3 @@\n+  \/\/ Copy constructor\n+  ReservedMemoryRegion(const ReservedMemoryRegion& rr);\n+\n@@ -373,0 +365,1 @@\n+  friend class ReservedMemoryRegion;\n@@ -401,1 +394,2 @@\n-  static SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base>* _reserved_regions;\n+  static Arena* _backing_arena;\n+  static SortedLinkedList<ReservedMemoryRegion, compare_reserved_region_base, AnyObj::ARENA>* _reserved_regions;\n","filename":"src\/hotspot\/share\/services\/virtualMemoryTracker.hpp","additions":11,"deletions":17,"binary":false,"changes":28,"status":"modified"}]}