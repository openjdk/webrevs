{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -78,0 +78,1 @@\n+import static jdk.jpackage.internal.StandardBundlerParam.APP_CONTENT;\n@@ -736,2 +737,3 @@\n-    private static void runCodesign(ProcessBuilder pb, boolean quiet)\n-                                                            throws IOException {\n+    private static void runCodesign(\n+            ProcessBuilder pb, boolean quiet, Map<String, ? super Object> params)\n+            throws IOException {\n@@ -744,3 +746,12 @@\n-                \/\/ Log output of \"codesign\" in case of\n-                \/\/ error. It should help user to diagnose\n-                \/\/ issue when using --mac-app-image-sign-identity\n+                \/\/ Log output of \"codesign\" in case of error. It should help\n+                \/\/ user to diagnose issues when using --mac-app-image-sign-identity.\n+                \/\/ In addition add possible reason for failure. For example\n+                \/\/ \"--app-content\" can fail \"codesign\".\n+\n+                \/\/ APP_CONTENT is never null.\n+                if (!APP_CONTENT.fetchFrom(params).isEmpty()) {\n+                    Log.info(MessageFormat.format(I18N.getString(\n+                        \"message.tool.failed.reason.app.content\"), \"codesign\"));\n+                }\n+\n+                \/\/ Log \"codesign\" output\n@@ -750,0 +761,1 @@\n+\n@@ -821,1 +833,1 @@\n-                            runCodesign(pb, true);\n+                            runCodesign(pb, true, params);\n@@ -849,1 +861,1 @@\n-                runCodesign(pb, false);\n+                runCodesign(pb, false, params);\n@@ -880,1 +892,1 @@\n-        runCodesign(pb, false);\n+        runCodesign(pb, false, params);\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacAppImageBuilder.java","additions":21,"deletions":9,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -97,0 +97,1 @@\n+message.tool.failed.reason.app.content=One of the possible reason for \"{0}\" failure is additional content provided via \"--app-content\", which made application bundle structure invalid. Make sure to provide additional content in a way it will not break application bundle structure, otherwise add additional content as post-processing step.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources.properties","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -97,0 +97,1 @@\n+message.tool.failed.reason.app.content=One of the possible reason for \"{0}\" failure is additional content provided via \"--app-content\", which made application bundle structure invalid. Make sure to provide additional content in a way it will not break application bundle structure, otherwise add additional content as post-processing step.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_de.properties","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -97,0 +97,1 @@\n+message.tool.failed.reason.app.content=One of the possible reason for \"{0}\" failure is additional content provided via \"--app-content\", which made application bundle structure invalid. Make sure to provide additional content in a way it will not break application bundle structure, otherwise add additional content as post-processing step.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_ja.properties","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -97,0 +97,1 @@\n+message.tool.failed.reason.app.content=One of the possible reason for \"{0}\" failure is additional content provided via \"--app-content\", which made application bundle structure invalid. Make sure to provide additional content in a way it will not break application bundle structure, otherwise add additional content as post-processing step.\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/resources\/MacResources_zh_CN.properties","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -60,0 +60,3 @@\n+    private static final String TEST_DUKE = TKit.TEST_SRC_ROOT.resolve(\n+            \"apps\/dukeplug.png\").toString();\n+\n@@ -90,0 +93,5 @@\n+            \/\/ --mac-installer-sign-identity and --type dmg\n+            {\"Hello\",\n+                    new String[]{\"--app-content\", TEST_DUKE},\n+                    null,\n+                    \"\\\"codesign\\\" failure is additional content provided via \\\"--app-content\\\"\"},\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/SigningOptionsTest.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"}]}