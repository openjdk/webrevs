{"files":[{"patch":"@@ -29,0 +29,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -45,0 +46,2 @@\n+\/\/ CDS Compatibility Logs & Compatibility Macros\n+\/\/ =============================================\n@@ -46,2 +49,3 @@\n-\/\/ PrintAOTLogsAsCDSLogs\n-\/\/ =====================\n+\/\/ A subset of the original CDS logs (the \"CDS Compatibility Logs\") have been\n+\/\/ selected in JDK 25. These logs are guarded using the aot_log_xxx compatibility\n+\/\/ macros. Before JDK 25, such code looked like this:\n@@ -49,3 +53,1 @@\n-\/\/ Original CDS logging code would look like this before JDK 25\n-\/\/\n-\/\/      log_info(aot)(\"trying to map %s%s\", info, _full_path);\n+\/\/      log_info(cds)(\"trying to map %s%s\", info, _full_path);\n@@ -54,1 +56,1 @@\n-\/\/ New code since JDK 25\n+\/\/ New code since JDK 25:\n@@ -60,1 +62,2 @@\n-\/\/ using the [cds] tag when running with a \"classic\" CDS archives:\n+\/\/ using the [cds] tag when running with the \"classic\" CDS flags such as\n+\/\/ -XX:SharedArchiveFile:\n@@ -66,1 +69,2 @@\n-\/\/ However, when running with an AOT cache, these messages are under the [aot] tag\n+\/\/ However, when running new AOT flags such as-XX:AOTCache, these messages are\n+\/\/ under the [aot] tag:\n@@ -68,3 +72,3 @@\n-\/\/     $ java -Xlog:aot -XX:AOTCache=bad.aot ...\n-\/\/     [0.020s][info][cds] trying to map bad.jsa\n-\/\/     [0.020s][warning][cds] Unable to read the file header\n+\/\/      $ java -Xlog:aot -XX:AOTCache=bad.aot ...\n+\/\/      [0.020s][info][aot] trying to map bad.aot\n+\/\/      [0.020s][warning][aot] Unable to read the file header\n@@ -77,1 +81,1 @@\n-\/\/ [2] When using CDS archives, and PrintAOTLogsAsCDSLogs=true\n+\/\/ [2] When using CDS archives\n@@ -80,2 +84,2 @@\n-\/\/ [3] When using CDS archives, and PrintAOTLogsAsCDSLogs=false\n-\/\/     - These logs can be selected ONLY with -Xlog:aot. They are always printed with [aot] decoration\n+\/\/ Deprecation Process\n+\/\/ ===================\n@@ -83,2 +87,18 @@\n-\/\/ PrintAOTLogsAsCDSLogs is ergonomically set to true when using CDS\n-\/\/ archives. The user can override this to false to get the behavior in [3]\n+\/\/ This is model after the deprecate\/obsolete\/removal process of VM options in arguments.cpp\n+\/\/\n+\/\/ JDK 25 - When using OLD CDS flags (see the list of flags in CDSConfig::check_new_flag()), the\n+\/\/          the CDS Compatibility Logs must be selected with -Xlog:cds\n+\/\/\n+\/\/ JDK 26 - Same as above, except that when -Xlog:cds is specified in the command-line, an warning\n+\/\/          message is printed to indicate that -Xlog:cds is deprecated.\n+\/\/\n+\/\/ JDK 27 - When using OLD CDS flags (see the list of flags in CDSConfig::check_new_flag()), the\n+\/\/          the CDS Compatibility Logs must be selected with -Xlog:aot.\n+\/\/\n+\/\/          When -Xlog:cds is specified in the command-line, an warning message is printed to\n+\/\/          indicate that -Xlog:cds is obsolete.\n+\/\/\n+\/\/ JDK 28 - When -Xlog:cds is specified in the command-line, the VM will exit with an error message:\n+\/\/\n+\/\/          [0.002s][error][logging] Invalid tag 'cds' in log selection.\n+\/\/          Invalid -Xlog option '-Xlog:cds', see error log for details.\n@@ -86,3 +106,0 @@\n-\/\/ Eventually (a couple releases after JDK 25), we will retire the aot_log_xxx() macros\n-\/\/ and will replace them with the regular log_xxx() macros.\n-\n@@ -115,3 +132,1 @@\n-    if (PrintAOTLogsAsCDSLogs) {\n-      return LogTagSetMapping<LogTag::_cds, T1, T2, T3, T4>::tagset().is_level(level);\n-    } else {\n+    if (CDSConfig::new_aot_flags_used()) {\n@@ -119,0 +134,2 @@\n+    } else {\n+      return LogTagSetMapping<LogTag::_cds, T1, T2, T3, T4>::tagset().is_level(level);\n@@ -141,3 +158,1 @@\n-    if (PrintAOTLogsAsCDSLogs) {\n-      LogTagSetMapping<LogTag::_cds, T1, T2, T3, T4>::tagset().vwrite(level, fmt, args);\n-    } else {\n+    if (CDSConfig::new_aot_flags_used()) {\n@@ -145,0 +160,2 @@\n+    } else {\n+      LogTagSetMapping<LogTag::_cds, T1, T2, T3, T4>::tagset().vwrite(level, fmt, args);\n","filename":"src\/hotspot\/share\/cds\/aotLogging.hpp","additions":42,"deletions":25,"binary":false,"changes":67,"status":"modified"},{"patch":"@@ -411,7 +411,0 @@\n-\n-    \/\/ The old \"cds\" log tags are deprecated, but we keep some of them for now as [cds]\n-    \/\/ for the classic workflow to be backwards compatible with older script. This will be\n-    \/\/ removed as part of JDK-8356317.\n-    \/\/\n-    \/\/  See aotLogging.hpp for details.\n-    FLAG_SET_ERGO_IF_DEFAULT(PrintAOTLogsAsCDSLogs, true);\n@@ -420,2 +413,0 @@\n-    \/\/ When using the new flags, never print any [aot] logs as [cds]\n-    FLAG_SET_ERGO(PrintAOTLogsAsCDSLogs, false);\n","filename":"src\/hotspot\/share\/cds\/cdsConfig.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -102,4 +102,0 @@\n-  product(bool, PrintAOTLogsAsCDSLogs, false, DIAGNOSTIC,                   \\\n-          \"Print some [aot] logs as [cds] logs when AOT cache is not \"      \\\n-          \"specified in command line\")                                      \\\n-                                                                            \\\n","filename":"src\/hotspot\/share\/cds\/cds_globals.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"}]}