{"files":[{"patch":"@@ -519,2 +519,0 @@\n-  const size_t os_attach_point_alignment =\n-#ifdef AIX\n@@ -526,4 +524,4 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t os_attach_point_alignment =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n+\n","filename":"src\/hotspot\/share\/memory\/virtualspace.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1895,2 +1895,0 @@\n-  const size_t system_allocation_granularity =\n-#ifdef AIX\n@@ -1902,4 +1900,4 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t system_allocation_granularity =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n+\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -61,10 +61,9 @@\n-#ifdef AIX\n-  \/\/ AIX is the only platform that uses System V shm for reserving virtual memory.\n-  \/\/ In this case, the required alignment of the allocated size (64K) and the alignment\n-  \/\/ of possible start points of the memory region (256M) differ.\n-  \/\/ This is not reflected by os_allocation_granularity().\n-  \/\/ The logic here is dual to the one in pd_reserve_memory in os_aix.cpp\n-      EXPECT_TRUE(is_aligned(addr, os::vm_page_size() == 4*K ? 4*K : 256*M)) << ERRINFO;\n-#else\n-      EXPECT_TRUE(is_aligned(addr, os::vm_allocation_granularity())) << ERRINFO;\n-#endif\n+\n+    \/\/ AIX is the only platform that uses System V shm for reserving virtual memory.\n+    \/\/ In this case, the required alignment of the allocated size (64K) and the alignment\n+    \/\/ of possible start points of the memory region (256M) differ.\n+    \/\/ This is not reflected by os_allocation_granularity().\n+    \/\/ The logic here is dual to the one in pd_reserve_memory in os_aix.cpp\n+    AIX_ONLY(EXPECT_TRUE(is_aligned(addr, os::vm_page_size() == 4*K ? 4*K : 256*M)) << ERRINFO)\n+    NOT_AIX(EXPECT_TRUE(is_aligned(addr, os::vm_allocation_granularity())) << ERRINFO);\n+\n@@ -186,2 +185,0 @@\n-  const size_t ag =\n-#ifdef AIX\n@@ -193,4 +190,3 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t ag =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n@@ -275,2 +271,1 @@\n-  const size_t ag =\n-#ifdef AIX\n+\n@@ -282,4 +277,3 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t ag =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n@@ -303,2 +297,1 @@\n-  const size_t system_allocation_granularity =\n-#ifdef AIX\n+\n@@ -310,4 +303,4 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t system_allocation_granularity =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n+\n@@ -330,2 +323,1 @@\n-  const size_t ag =\n-#ifdef AIX\n+\n@@ -337,4 +329,4 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t ag =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n+\n@@ -380,2 +372,1 @@\n-  const size_t ag =\n-#ifdef AIX\n+\n@@ -387,4 +378,4 @@\n-      os::vm_page_size() == 4*K ? 4*K : 256*M;\n-#else\n-      os::vm_allocation_granularity();\n-#endif\n+  const size_t ag =\n+    AIX_ONLY(os::vm_page_size() == 4*K ? 4*K : 256*M)\n+    NOT_AIX(os::vm_allocation_granularity());\n+\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_reserve_between.cpp","additions":31,"deletions":40,"binary":false,"changes":71,"status":"modified"}]}