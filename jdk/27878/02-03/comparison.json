{"files":[{"patch":"@@ -1629,2 +1629,3 @@\n-  if (!cont.entry()->is_virtual_thread() && JvmtiExport::has_frame_pops(thread)) {\n-    int num_frames = num_java_frames(cont);\n+  if (!cont.entry()->is_virtual_thread()) {\n+    if (JvmtiExport::has_frame_pops(thread)) {\n+      int num_frames = num_java_frames(cont);\n@@ -1632,2 +1633,4 @@\n-    ContinuationWrapper::SafepointOp so(Thread::current(), cont);\n-    JvmtiExport::continuation_yield_cleanup(JavaThread::current(), num_frames);\n+      ContinuationWrapper::SafepointOp so(Thread::current(), cont);\n+      JvmtiExport::continuation_yield_cleanup(thread, num_frames);\n+    }\n+    invalidate_jvmti_stack(thread);\n@@ -1688,1 +1691,0 @@\n-  JVMTI_ONLY(invalidate_jvmti_stack(JavaThread::current()));\n@@ -2314,1 +2316,1 @@\n-  JVMTI_ONLY(invalidate_jvmti_stack(_thread));\n+  JVMTI_ONLY(if (!_cont.entry()->is_virtual_thread()) invalidate_jvmti_stack(_thread));\n","filename":"src\/hotspot\/share\/runtime\/continuationFreezeThaw.cpp","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"}]}