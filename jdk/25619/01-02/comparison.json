{"files":[{"patch":"@@ -5462,0 +5462,1 @@\n+    CriticalSection::Lock l(AwtObject::GetGlobalLock());\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Component.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+CriticalSection AwtObject::g_pDataLock;\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Object.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -62,0 +62,2 @@\n+    static CriticalSection g_pDataLock;\n+\n@@ -77,0 +79,2 @@\n+    static CriticalSection& GetGlobalLock() { return g_pDataLock; }\n+\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Object.h","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2498,0 +2498,1 @@\n+    CriticalSection::Lock l(AwtObject::GetGlobalLock());\n@@ -2500,0 +2501,3 @@\n+    jint result = -1;\n+    PDATA pData;\n+    AwtWindow* w = NULL;\n@@ -2503,20 +2507,2 @@\n-    \/\/ Alert caller w\/ IllegalComponentStateException.\n-    if (self == NULL) {\n-        JNU_ThrowByName(env, \"java\/awt\/IllegalComponentStateException\",\n-                        \"Peer null in JNI\");\n-        return 0;\n-    }\n-\n-    jboolean destroyed = JNI_GET_DESTROYED(self);\n-    if (destroyed == JNI_TRUE){\n-        env->DeleteGlobalRef(self);\n-        return AwtWin32GraphicsDevice::GetDefaultDeviceIndex();\n-    }\n-\n-    PDATA pData = JNI_GET_PDATA(self);\n-    if (pData == NULL) {\n-        JNU_ThrowByName(env, \"java\/awt\/IllegalComponentStateException\",\n-                        \"Native resources unavailable\");\n-        env->DeleteGlobalRef(self);\n-        return 0;\n-    }\n+    \/\/ Return the default screen.\n+    JNI_CHECK_PEER_GOTO(self, ret);\n@@ -2524,2 +2510,1 @@\n-    jint result = 0;\n-    AwtWindow *w = (AwtWindow *)pData;\n+    w = (AwtWindow *)pData;\n@@ -2531,0 +2516,1 @@\n+  ret:\n@@ -2532,2 +2518,1 @@\n-\n-    return result;\n+    return (result != -1) ? result : AwtWin32GraphicsDevice::GetDefaultDeviceIndex();\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Window.cpp","additions":9,"deletions":24,"binary":false,"changes":33,"status":"modified"}]}