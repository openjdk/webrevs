{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,1 +27,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -29,0 +28,1 @@\n+import sun.java2d.SurfaceData;\n@@ -73,7 +73,2 @@\n-        MTLSurfaceData dstData;\n-        try {\n-            dstData = (MTLSurfaceData) sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" +\n-                    sg2d.surfaceData);\n-        }\n+        MTLSurfaceData dstData = SurfaceData.convertTo(MTLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/java2d\/metal\/MTLMaskFill.java","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -30,0 +29,1 @@\n+import sun.java2d.SurfaceData;\n@@ -52,6 +52,2 @@\n-        MTLSurfaceData dstData;\n-        try {\n-            dstData = (MTLSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        MTLSurfaceData dstData = SurfaceData.convertTo(MTLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -66,6 +62,2 @@\n-        MTLSurfaceData dstData;\n-        try {\n-            dstData = (MTLSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        MTLSurfaceData dstData = SurfaceData.convertTo(MTLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -85,6 +77,2 @@\n-            MTLSurfaceData dstData;\n-            try {\n-                dstData = (MTLSurfaceData)sg2d.surfaceData;\n-            } catch (ClassCastException e) {\n-                throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-            }\n+            MTLSurfaceData dstData = SurfaceData.convertTo(MTLSurfaceData.class,\n+                                                           sg2d.surfaceData);\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/java2d\/metal\/MTLRenderer.java","additions":8,"deletions":20,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -1094,0 +1094,11 @@\n+\n+    \/**\n+     * Converts surfaceData to the particular subclass or throws InvalidPipeException\n+     *\/\n+    public static <T> T convertTo(Class<T> surfaceDataClass, SurfaceData surfaceData) {\n+        try {\n+            return surfaceDataClass.cast(surfaceData);\n+        } catch(ClassCastException e) {\n+            throw new InvalidPipeException(\"wrong surface data type: \" + surfaceData);\n+        }\n+    }\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/SurfaceData.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -31,0 +30,1 @@\n+import sun.java2d.SurfaceData;\n@@ -71,7 +71,2 @@\n-        OGLSurfaceData dstData;\n-        try {\n-            dstData = (OGLSurfaceData) sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" +\n-                                           sg2d.surfaceData);\n-        }\n+        OGLSurfaceData dstData = SurfaceData.convertTo(OGLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/opengl\/OGLMaskFill.java","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -32,0 +31,1 @@\n+import sun.java2d.SurfaceData;\n@@ -50,6 +50,2 @@\n-        OGLSurfaceData dstData;\n-        try {\n-            dstData = (OGLSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        OGLSurfaceData dstData = SurfaceData.convertTo(OGLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -64,6 +60,2 @@\n-        OGLSurfaceData dstData;\n-        try {\n-            dstData = (OGLSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        OGLSurfaceData dstData = SurfaceData.convertTo(OGLSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -83,6 +75,2 @@\n-            OGLSurfaceData dstData;\n-            try {\n-                dstData = (OGLSurfaceData)sg2d.surfaceData;\n-            } catch (ClassCastException e) {\n-                throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-            }\n+            OGLSurfaceData dstData = SurfaceData.convertTo(OGLSurfaceData.class,\n+                                                           sg2d.surfaceData);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/opengl\/OGLRenderer.java","additions":8,"deletions":20,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,1 @@\n+import sun.java2d.SurfaceData;\n@@ -64,2 +65,1 @@\n-\n-            XRSurfaceData x11sd = (XRSurfaceData) sg2d.surfaceData;\n+            XRSurfaceData x11sd = SurfaceData.convertTo(XRSurfaceData.class, sg2d.surfaceData);\n","filename":"src\/java.desktop\/unix\/classes\/sun\/font\/XRTextRenderer.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -102,1 +102,1 @@\n-            XRSurfaceData x11sd = (XRSurfaceData) sData;\n+            XRSurfaceData x11sd = SurfaceData.convertTo(XRSurfaceData.class, sData);\n","filename":"src\/java.desktop\/unix\/classes\/sun\/java2d\/xr\/XRMaskFill.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -33,0 +32,1 @@\n+import sun.java2d.SurfaceData;\n@@ -73,6 +73,2 @@\n-        XRSurfaceData xrsd;\n-        try {\n-            xrsd = (XRSurfaceData) sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        XRSurfaceData xrsd = SurfaceData.convertTo(XRSurfaceData.class,\n+                                                   sg2d.surfaceData);\n","filename":"src\/java.desktop\/unix\/classes\/sun\/java2d\/xr\/XRRenderer.java","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2008, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -31,0 +30,1 @@\n+import sun.java2d.SurfaceData;\n@@ -71,7 +71,2 @@\n-        D3DSurfaceData dstData;\n-        try {\n-            dstData = (D3DSurfaceData) sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" +\n-                                           sg2d.surfaceData);\n-        }\n+        D3DSurfaceData dstData = SurfaceData.convertTo(D3DSurfaceData.class,\n+                                                       sg2d.surfaceData);\n","filename":"src\/java.desktop\/windows\/classes\/sun\/java2d\/d3d\/D3DMaskFill.java","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n-import sun.java2d.InvalidPipeException;\n@@ -32,0 +31,1 @@\n+import sun.java2d.SurfaceData;\n@@ -50,6 +50,2 @@\n-        D3DSurfaceData dstData;\n-        try {\n-            dstData = (D3DSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        D3DSurfaceData dstData = SurfaceData.convertTo(D3DSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -64,6 +60,2 @@\n-        D3DSurfaceData dstData;\n-        try {\n-            dstData = (D3DSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        D3DSurfaceData dstData = SurfaceData.convertTo(D3DSurfaceData.class,\n+                                                       sg2d.surfaceData);\n@@ -83,6 +75,2 @@\n-            D3DSurfaceData dstData;\n-            try {\n-                dstData = (D3DSurfaceData)sg2d.surfaceData;\n-            } catch (ClassCastException e) {\n-                throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-            }\n+            D3DSurfaceData dstData = SurfaceData.convertTo(D3DSurfaceData.class,\n+                                                           sg2d.surfaceData);\n","filename":"src\/java.desktop\/windows\/classes\/sun\/java2d\/d3d\/D3DRenderer.java","additions":8,"deletions":20,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -295,6 +295,2 @@\n-        GDIWindowSurfaceData sd;\n-        try {\n-            sd = (GDIWindowSurfaceData)sg2d.surfaceData;\n-        } catch (ClassCastException e) {\n-            throw new InvalidPipeException(\"wrong surface data type: \" + sg2d.surfaceData);\n-        }\n+        GDIWindowSurfaceData sd = SurfaceData.convertTo(GDIWindowSurfaceData.class,\n+                                                        sg2d.surfaceData);\n","filename":"src\/java.desktop\/windows\/classes\/sun\/java2d\/windows\/GDIRenderer.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2022 Oracle and\/or its affiliates. All rights reserved.\n@@ -44,1 +44,1 @@\n- * @bug 8158072 7172749\n+ * @bug 8158072 7172749 8283794\n","filename":"test\/jdk\/sun\/java2d\/ClassCastExceptionForInvalidSurface.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}