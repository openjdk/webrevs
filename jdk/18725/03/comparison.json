{"files":[{"patch":"@@ -79,14 +79,0 @@\n-class YoungGenScanClosure : public InHeapScanClosure {\n-  template <typename T>\n-  void do_oop_work(T* p) {\n-    assert(SerialHeap::heap()->young_gen()->to()->is_in_reserved(p), \"precondition\");\n-\n-    try_scavenge(p, [] (auto) {});\n-  }\n-public:\n-  YoungGenScanClosure(DefNewGeneration* g) : InHeapScanClosure(g) {}\n-\n-  void do_oop(oop* p)       { do_oop_work(p); }\n-  void do_oop(narrowOop* p) { do_oop_work(p); }\n-};\n-\n@@ -234,4 +220,1 @@\n-    do {\n-      _heap->oop_since_save_marks_iterate(_young_cl, _old_cl);\n-    } while (!_heap->no_allocs_since_save_marks());\n-    guarantee(_heap->young_gen()->promo_failure_scan_is_complete(), \"Failed to finish scan\");\n+    _heap->scan_evacuated_objs(_young_cl, _old_cl);\n","filename":"src\/hotspot\/share\/gc\/serial\/defNewGeneration.cpp","additions":1,"deletions":18,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-#include \"gc\/serial\/serialHeap.hpp\"\n+#include \"gc\/serial\/serialHeap.inline.hpp\"\n@@ -765,0 +765,9 @@\n+void SerialHeap::scan_evacuated_objs(YoungGenScanClosure* young_cl,\n+                                     OldGenScanClosure* old_cl) {\n+  do {\n+    young_gen()->oop_since_save_marks_iterate(young_cl);\n+    old_gen()->oop_since_save_marks_iterate(old_cl);\n+  } while (!no_allocs_since_save_marks());\n+  guarantee(young_gen()->promo_failure_scan_is_complete(), \"Failed to finish scan\");\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialHeap.cpp","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -366,0 +366,3 @@\n+  void scan_evacuated_objs(YoungGenScanClosure* young_cl,\n+                           OldGenScanClosure* old_cl);\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialHeap.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -33,7 +33,0 @@\n-template <typename OopClosureType1, typename OopClosureType2>\n-void SerialHeap::oop_since_save_marks_iterate(OopClosureType1* cur,\n-                                              OopClosureType2* older) {\n-  young_gen()->oop_since_save_marks_iterate(cur);\n-  old_gen()->oop_since_save_marks_iterate(older);\n-}\n-\n@@ -103,0 +96,14 @@\n+class YoungGenScanClosure : public InHeapScanClosure {\n+  template <typename T>\n+  void do_oop_work(T* p) {\n+    assert(SerialHeap::heap()->young_gen()->to()->is_in_reserved(p), \"precondition\");\n+\n+    try_scavenge(p, [] (auto) {});\n+  }\n+public:\n+  YoungGenScanClosure(DefNewGeneration* g) : InHeapScanClosure(g) {}\n+\n+  void do_oop(oop* p)       { do_oop_work(p); }\n+  void do_oop(narrowOop* p) { do_oop_work(p); }\n+};\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialHeap.inline.hpp","additions":14,"deletions":7,"binary":false,"changes":21,"status":"modified"}]}