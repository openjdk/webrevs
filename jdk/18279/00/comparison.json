{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2014, 2023, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -147,0 +147,8 @@\n+  ifneq ($(COMPARE_BUILD), )\n+    DEBUG_CDS_ARCHIVE := true\n+  endif\n+\n+  ifeq ($(DEBUG_CDS_ARCHIVE), true)\n+    $1_$2_CDS_DUMP_FLAGS += -Xlog:cds+map*=trace:file=$$(JDK_IMAGE_DIR)\/$$($1_$2_CDS_ARCHIVE).cdsmap:none:filesize=0\n+  endif\n+\n","filename":"make\/Images.gmk","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -445,1 +445,1 @@\n-\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh -vv $(COMPARE_BUILD_COMP_OPTS) \\\n+\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh --diffs $(COMPARE_BUILD_COMP_OPTS) \\\n@@ -448,1 +448,1 @@\n-\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh -vv $(COMPARE_BUILD_COMP_OPTS) \\\n+\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh --diffs $(COMPARE_BUILD_COMP_OPTS) \\\n","filename":"make\/InitSupport.gmk","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n-# Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2012, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,0 +48,1 @@\n+export ECHO=\"@ECHO@\"\n@@ -53,0 +54,1 @@\n+export HEAD=\"@HEAD@\"\n","filename":"make\/autoconf\/compare.sh.template","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n-    FULLDUMP_CMD=\"$OTOOL -v -V -h -X -d\"\n+    FULLDUMP_CMD=\"$OTOOL -a -C -d -f -G -h -H -I -j -l -L -m -M -o -P -r -R -S -t -T -v -V -X -dyld_info -dyld_opcodes\"\n@@ -120,1 +120,1 @@\n-    TMP=$($DIFF $THIS_FILE $OTHER_FILE)\n+    TMP=$($DIFF -u $THIS_FILE $OTHER_FILE)\n@@ -441,1 +441,1 @@\n-            if [[ \"$ACCEPTED_JARZIP_CONTENTS $EXCEPTIONS\" != *\"$file\"* ]]; then\n+            if [[ \"$ACCEPTED_JARZIP_CONTENTS\" != *\"$file\"* ]]; then\n@@ -457,1 +457,1 @@\n-                        $DIFF ${OTHER_UNZIPDIR}\/$i.javap ${THIS_UNZIPDIR}\/$i.javap\n+                        $DIFF -u ${OTHER_UNZIPDIR}\/$i.javap ${THIS_UNZIPDIR}\/$i.javap\n@@ -459,1 +459,1 @@\n-                        $DIFF ${OTHER_UNZIPDIR}\/$i.cleaned ${THIS_UNZIPDIR}\/$i\n+                        $DIFF -u ${OTHER_UNZIPDIR}\/$i.cleaned ${THIS_UNZIPDIR}\/$i\n@@ -461,1 +461,1 @@\n-                        $DIFF ${OTHER_UNZIPDIR}\/$i ${THIS_UNZIPDIR}\/$i\n+                        $DIFF -u ${OTHER_UNZIPDIR}\/$i ${THIS_UNZIPDIR}\/$i\n@@ -791,1 +791,1 @@\n-    $DIFF $WORK_FILE_BASE.symbols.other $WORK_FILE_BASE.symbols.this > $WORK_FILE_BASE.symbols.diff\n+    $DIFF -u $WORK_FILE_BASE.symbols.other $WORK_FILE_BASE.symbols.this > $WORK_FILE_BASE.symbols.diff\n@@ -831,1 +831,1 @@\n-        $DIFF $WORK_FILE_BASE.deps.other $WORK_FILE_BASE.deps.this \\\n+        $DIFF -u $WORK_FILE_BASE.deps.other $WORK_FILE_BASE.deps.this \\\n@@ -833,1 +833,1 @@\n-        $DIFF $WORK_FILE_BASE.deps.other.uniq $WORK_FILE_BASE.deps.this.uniq \\\n+        $DIFF -u $WORK_FILE_BASE.deps.other.uniq $WORK_FILE_BASE.deps.this.uniq \\\n@@ -883,1 +883,1 @@\n-        $DIFF $WORK_FILE_BASE.fulldump.other $WORK_FILE_BASE.fulldump.this \\\n+        $DIFF -u $WORK_FILE_BASE.fulldump.other $WORK_FILE_BASE.fulldump.this \\\n@@ -930,1 +930,1 @@\n-        $DIFF $WORK_FILE_BASE.dis.other $WORK_FILE_BASE.dis.this > $WORK_FILE_BASE.dis.diff\n+        $DIFF -u $WORK_FILE_BASE.dis.other $WORK_FILE_BASE.dis.this > $WORK_FILE_BASE.dis.diff\n@@ -971,2 +971,2 @@\n-                echo \"Symbols diff:\"\n-                $CAT $WORK_FILE_BASE.symbols.diff\n+                echo \"Symbols diff $SHOW_DIFF_INFO:\"\n+                $SHOW_DIFF_CMD $WORK_FILE_BASE.symbols.diff\n@@ -975,2 +975,2 @@\n-                echo \"Deps diff:\"\n-                $CAT $WORK_FILE_BASE.deps.diff\n+                echo \"Deps diff $SHOW_DIFF_INFO:\"\n+                $SHOW_DIFF_CMD $WORK_FILE_BASE.deps.diff\n@@ -979,2 +979,2 @@\n-                echo \"Fulldump diff:\"\n-                $CAT $WORK_FILE_BASE.fulldump.diff\n+                echo \"Fulldump diff $SHOW_DIFF_INFO:\"\n+                $SHOW_DIFF_CMD $WORK_FILE_BASE.fulldump.diff\n@@ -983,2 +983,2 @@\n-                echo \"Disassembly diff:\"\n-                $CAT $WORK_FILE_BASE.dis.diff\n+                echo \"Disassembly diff $SHOW_DIFF_INFO:\"\n+                $SHOW_DIFF_CMD $WORK_FILE_BASE.dis.diff\n@@ -1080,1 +1080,1 @@\n-              DIFF_OUT=$($DIFF $OTHER_FILE $THIS_FILE 2>&1)\n+              DIFF_OUT=$($DIFF -u $OTHER_FILE $THIS_FILE 2>&1)\n@@ -1111,0 +1111,10 @@\n+\n+        NAME=$(basename $f)\n+        WORK_FILE_BASE=$WORK_DIR\/$f\n+        FILE_WORK_DIR=$(dirname $WORK_FILE_BASE)\n+        $MKDIR -p $FILE_WORK_DIR\n+\n+        # Make soft links to original files from work dir to facilitate debugging\n+        $LN -f -s $THIS_FILE $WORK_FILE_BASE.this\n+        $LN -f -s $OTHER_FILE $WORK_FILE_BASE.other\n+\n@@ -1136,3 +1146,4 @@\n-            DIFF_OUT=$($DIFF $OTHER_FILE $THIS_FILE 2>&1)\n-            if [ -n \"$DIFF_OUT\" ]; then\n-                echo $f\n+\n+            $DIFF -u $OTHER_FILE $THIS_FILE > $WORK_FILE_BASE.diff 2>&1\n+            if [ -s $WORK_FILE_BASE.diff ]; then\n+                echo \"$f (diff size $(ls -n $WORK_FILE_BASE.diff | awk '{print $5}'))\"\n@@ -1141,1 +1152,2 @@\n-                    echo \"$DIFF_OUT\"\n+                echo SHOW DIFF $SHOW_DIFF_INFO: $WORK_FILE_BASE.diff\n+                    $SHOW_DIFF_CMD \"$WORK_FILE_BASE.diff\"\n@@ -1169,0 +1181,2 @@\n+    echo \"--diffs             Shows abridged diff output of all comparisons\"\n+    echo \"--diffs=full        Shows full diff output of all comparisons (Warning! Log can be huge)\"\n@@ -1170,1 +1184,1 @@\n-    echo \"-vv                 More verbose output, shows diff output of all comparisons\"\n+    echo \"-vv                 Alias for -v --diffs\"\n@@ -1208,0 +1222,7 @@\n+        --diffs)\n+            SHOW_DIFFS=true\n+            ;;\n+        --diffs=full)\n+            SHOW_DIFFS=true\n+            SHOW_FULL_DIFFS=true\n+            ;;\n@@ -1369,0 +1390,8 @@\n+if [ \"$SHOW_FULL_DIFFS\" = \"true\" ]; then\n+  SHOW_DIFF_CMD=\"$CAT\"\n+  SHOW_DIFF_INFO=\"(full diff)\"\n+else\n+  SHOW_DIFF_CMD=\"$HEAD -n 500\"\n+  SHOW_DIFF_INFO=\"(first 500 lines)\"\n+fi\n+\n","filename":"make\/scripts\/compare.sh","additions":54,"deletions":25,"binary":false,"changes":79,"status":"modified"},{"patch":"","filename":"make\/scripts\/compare_exceptions.sh.incl","additions":0,"deletions":0,"binary":false,"changes":0,"status":"deleted"}]}