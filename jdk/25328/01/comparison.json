{"files":[{"patch":"@@ -40,0 +40,1 @@\n+import java.nio.charset.StandardCharsets;\n@@ -971,0 +972,3 @@\n+    private static final Charset stdinCharset =\n+            Charset.forName(System.getProperty(\"stdin.encoding\"),\n+                            Charset.defaultCharset());\n@@ -993,1 +997,1 @@\n-            pendingBytes = dataToConvert.toString().getBytes();\n+            pendingBytes = dataToConvert.toString().getBytes(stdinCharset);\n","filename":"src\/jdk.jshell\/share\/classes\/jdk\/internal\/jshell\/tool\/ConsoleIOContext.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -51,0 +51,1 @@\n+import java.time.Duration;\n@@ -52,2 +53,0 @@\n-import java.util.concurrent.TimeUnit;\n-import java.util.stream.Stream;\n@@ -74,1 +73,6 @@\n-    private static final int SHUTDOWN_TIMEOUT = 1; \/\/1 second\n+    private static final Duration SHUTDOWN_TIMEOUT = Duration.ofSeconds(1);\n+    private static final List<String> FORWARD_SYSTEM_PROPERTIES = List.of(\n+        \"stderr.encoding\",\n+        \"stdin.encoding\",\n+        \"stdout.encoding\"\n+    );\n@@ -108,5 +112,8 @@\n-            List<String> augmentedremoteVMOptions =\n-                    Stream.concat(env.extraRemoteVMOptions().stream(),\n-                                  \/\/disable System.console():\n-                                  List.of(\"-Djdk.console=\" + consoleModule).stream())\n-                          .toList();\n+            List<String> augmentedremoteVMOptions = new ArrayList<>();\n+\n+            FORWARD_SYSTEM_PROPERTIES.forEach(\n+                    prop -> augmentedremoteVMOptions.add(\"-D\" + prop + \"=\" +\n+                                                         System.getProperty(prop)));\n+            augmentedremoteVMOptions.addAll(env.extraRemoteVMOptions());\n+            augmentedremoteVMOptions.add(\"-Djdk.console=\" + consoleModule);\n+\n@@ -282,1 +289,1 @@\n-                remoteProcess.waitFor(SHUTDOWN_TIMEOUT, TimeUnit.SECONDS);\n+                remoteProcess.waitFor(SHUTDOWN_TIMEOUT);\n","filename":"src\/jdk.jshell\/share\/classes\/jdk\/jshell\/execution\/JdiDefaultExecutionControl.java","additions":16,"deletions":9,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n- * @run testng InputUITest\n+ * @run testng\/othervm -Dstderr.encoding=UTF-8 -Dstdin.encoding=UTF-8 -Dstdout.encoding=UTF-8 InputUITest\n","filename":"test\/langtools\/jdk\/jshell\/InputUITest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}