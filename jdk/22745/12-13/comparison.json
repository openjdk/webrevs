{"files":[{"patch":"@@ -150,1 +150,3 @@\n-  \/\/ <=1 because during VM init before Thread::add is called, or any other threads are started, it is single threaded.\n+  \/\/ VM initialization is single-threaded until the first NJT (WatcherThread) is created\n+  \/\/ by the main thread, but that thread disappears during VM exit so we can't just\n+  \/\/ check for it. To reduce the overhead we check for > 1 JavaThreads first.\n@@ -152,3 +154,1 @@\n-    int count = number_of_threads();\n-    for (NonJavaThread::Iterator njti; !njti.end(); njti.step()) {\n-      if (++count > 1) {\n+    if (number_of_threads() > 1) {\n@@ -156,1 +156,0 @@\n-      }\n@@ -158,1 +157,2 @@\n-    return count <= 1;\n+    NonJavaThread::Iterator njti;\n+    return njti->current() == nullptr;\n","filename":"src\/hotspot\/share\/runtime\/threads.hpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}