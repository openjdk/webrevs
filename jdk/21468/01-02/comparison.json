{"files":[{"patch":"@@ -1335,4 +1335,1 @@\n-  if (jvf->method()->is_native()) {\n-    return JVMTI_ERROR_OPAQUE_FRAME;\n-  }\n-  if (depth == 0 && state->is_top_frame_is_exiting()) {\n+  if (jvf->method()->is_native() || (depth == 0 && state->top_frame_is_exiting())) {\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.cpp","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -364,1 +364,1 @@\n-  bool is_top_frame_is_exiting()  { return _top_frame_is_exiting;  }\n+  bool top_frame_is_exiting()     { return _top_frame_is_exiting;  }\n","filename":"src\/hotspot\/share\/prims\/jvmtiThreadState.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-        setFramePopNotificationMode(testThread, true);\n+        setFramePopNotificationMode(testThread);\n@@ -117,1 +117,1 @@\n-    private native static void setFramePopNotificationMode(Thread thread, boolean enabled);\n+    private native static void setFramePopNotificationMode(Thread thread);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/NotifyFramePopStressTest\/NotifyFramePopStressTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -134,3 +134,2 @@\n-Java_NotifyFramePopStressTest_setFramePopNotificationMode(JNIEnv *env, jclass cl, jthread thread, jboolean enable) {\n-  jvmtiEventMode mode = enable ? JVMTI_ENABLE : JVMTI_DISABLE;\n-  set_event_notification_mode(jvmti, env, mode, JVMTI_EVENT_FRAME_POP, thread);\n+Java_NotifyFramePopStressTest_setFramePopNotificationMode(JNIEnv *env, jclass cl, jthread thread) {\n+  set_event_notification_mode(jvmti, env, JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, thread);\n@@ -156,1 +155,1 @@\n-  \/\/ to force the thread into interpOnly mode, which seems to help the tests's timing\n+  \/\/ to force the thread into interpOnly mode, which seems to help the test's timing\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/NotifyFramePopStressTest\/libNotifyFramePopStressTest.cpp","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"}]}