{"files":[{"patch":"@@ -34,0 +34,1 @@\n+static jrawMonitorID agent_monitor;\n@@ -62,1 +63,0 @@\n-  char* expected_method = (char*)last_notify_method;\n@@ -79,1 +79,2 @@\n-    if (strcmp(name, (char*)expected_method) != 0) {\n+    RawMonitorLocker rml(jvmti, jni, agent_monitor);\n+    if (strcmp(name, (char*)last_notify_method) != 0) {\n@@ -82,2 +83,0 @@\n-      deallocate(jvmti, jni, csig);\n-      deallocate(jvmti, jni, name);\n@@ -114,0 +113,1 @@\n+  agent_monitor = create_raw_monitor(jvmti, \"Agent raw monitor\");\n@@ -170,1 +170,2 @@\n-    char* old_notify_method = (char*)last_notify_method;\n+    RawMonitorLocker rml(jvmti, jni, agent_monitor);\n+    deallocate(jvmti, jni, last_notify_method);\n@@ -172,1 +173,0 @@\n-    deallocate(jvmti, jni, old_notify_method);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/NotifyFramePopStressTest\/libNotifyFramePopStressTest.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}