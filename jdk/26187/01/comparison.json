{"files":[{"patch":"@@ -80,0 +80,4 @@\n+  if (obj_klass == vmClasses::Class_klass()) {\n+    msg.append(\"  mirrored klass:       \" PTR_FORMAT \"\\n\", p2i(obj->metadata_field(java_lang_Class::klass_offset())));\n+    msg.append(\"  mirrored array klass: \" PTR_FORMAT \"\\n\", p2i(obj->metadata_field(java_lang_Class::array_klass_offset())));\n+  }\n@@ -271,1 +275,3 @@\n-  \/\/ We want to check class loading\/unloading did not corrupt them.\n+  \/\/ We want to check class loading\/unloading did not corrupt them. We can only reasonably\n+  \/\/ trust the forwarded objects, as the from-space object can have the klasses effectively\n+  \/\/ dead.\n@@ -274,1 +280,1 @@\n-    Metadata* klass = obj->metadata_field(java_lang_Class::klass_offset());\n+    const Metadata* klass = fwd->metadata_field(java_lang_Class::klass_offset());\n@@ -277,1 +283,1 @@\n-                    \"Instance class mirror should point to Metaspace\",\n+                    \"Mirrored instance class should point to Metaspace\",\n@@ -281,1 +287,1 @@\n-    Metadata* array_klass = obj->metadata_field(java_lang_Class::array_klass_offset());\n+    const Metadata* array_klass = fwd->metadata_field(java_lang_Class::array_klass_offset());\n@@ -284,1 +290,1 @@\n-                    \"Array class mirror should point to Metaspace\",\n+                    \"Mirrored array class should point to Metaspace\",\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAsserts.cpp","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -247,1 +247,3 @@\n-    \/\/ We want to check class loading\/unloading did not corrupt them.\n+    \/\/ We want to check class loading\/unloading did not corrupt them. We can only reasonably\n+    \/\/ trust the forwarded objects, as the from-space object can have the klasses effectively\n+    \/\/ dead.\n@@ -250,1 +252,1 @@\n-      Metadata* klass = obj->metadata_field(java_lang_Class::klass_offset());\n+      const Metadata* klass = fwd->metadata_field(java_lang_Class::klass_offset());\n@@ -253,1 +255,1 @@\n-            \"Instance class mirror should point to Metaspace\");\n+            \"Mirrored instance class should point to Metaspace\");\n@@ -255,1 +257,1 @@\n-      Metadata* array_klass = obj->metadata_field(java_lang_Class::array_klass_offset());\n+      const Metadata* array_klass = obj->metadata_field(java_lang_Class::array_klass_offset());\n@@ -258,1 +260,1 @@\n-            \"Array class mirror should point to Metaspace\");\n+            \"Mirrored array class should point to Metaspace\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.cpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"}]}