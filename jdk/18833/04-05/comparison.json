{"files":[{"patch":"@@ -286,3 +286,8 @@\n-void inputStream::free_c_heap_buffer() {\n-  FreeHeap(_buffer);\n-  _buffer = nullptr;\n+inputStream::~inputStream() {\n+  if (has_c_heap_buffer()) {\n+    FreeHeap(_buffer);\n+    DEBUG_ONLY(_buffer = (char*)0xdeadbeef); \/\/ sanity\n+  }\n+  if (_input != nullptr)  {\n+    set_input(nullptr);\n+  }\n","filename":"src\/hotspot\/share\/utilities\/istream.cpp","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -111,1 +111,1 @@\n-    return _buffer != nullptr && _buffer != &_small_buffer[0];\n+    return _buffer != &_small_buffer[0];\n@@ -113,1 +113,0 @@\n-  void free_c_heap_buffer();\n@@ -145,1 +144,1 @@\n-    assert((_buffer == nullptr) == (_buffer_size == 0), \"\");\n+    assert(_buffer != nullptr, \"\");\n@@ -245,4 +244,1 @@\n-  virtual ~inputStream() {\n-    if (has_c_heap_buffer()) free_c_heap_buffer();\n-    if (_input != nullptr)  set_input(nullptr);\n-  }\n+  virtual ~inputStream();\n","filename":"src\/hotspot\/share\/utilities\/istream.hpp","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"}]}