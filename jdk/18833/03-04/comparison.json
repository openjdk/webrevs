{"files":[{"patch":"@@ -41,1 +41,1 @@\n-  COV_FN(FIB_L) COV_FN(PFB_X) COV_FN(PFB_C) COV_FN(PFB_P) COV_FN(PFB_A) \\\n+  COV_FN(FIB_L) COV_FN(PFB_C) COV_FN(PFB_P) COV_FN(PFB_A) \\\n@@ -43,1 +43,1 @@\n-  COV_FN(SBC_L) COV_FN(EXB_S) COV_FN(EXB_R) COV_FN(EXB_A)\n+  COV_FN(SBC_L) COV_FN(EXB_R) COV_FN(EXB_A)\n@@ -109,3 +109,0 @@\n-  if (_input != nullptr && _input != input) {\n-    _input->close();\n-  }\n@@ -117,0 +114,1 @@\n+  size_t fill_offset, fill_length;\n@@ -119,1 +117,0 @@\n-    size_t fill_offset, fill_length;\n@@ -168,6 +165,0 @@\n-  if (_buffer_size == 0) {\n-    COV(PFB_X);\n-    expand_buffer(sizeof(_small_buffer));\n-    assert(_buffer_size > 0, \"\");\n-    \/\/ and continue with at least a little buffer\n-  }\n@@ -270,5 +261,2 @@\n-  if (new_length <= sizeof(_small_buffer)) {\n-    COV(EXB_S);\n-    new_buf = &_small_buffer[0];\n-    new_length = sizeof(_small_buffer);\n-  } else if (_buffer == &_small_buffer[0]) {\n+  assert(new_length > sizeof(_small_buffer), \"\");\n+  if (_buffer == &_small_buffer[0]) {\n@@ -278,5 +266,4 @@\n-    if (new_buf != nullptr) {\n-      if (_content_end > 0) {\n-        assert(_content_end <= _buffer_size, \"\");\n-        ::memcpy(new_buf, _buffer, _content_end);  \/\/ copy only the active content\n-      }\n+    assert(new_buf != nullptr, \"would have exited VM if OOM\");\n+    if (_content_end > 0) {\n+      assert(_content_end <= _buffer_size, \"\");\n+      ::memcpy(new_buf, _buffer, _content_end);  \/\/ copy only the active content\n@@ -288,0 +275,1 @@\n+    assert(new_buf != nullptr, \"would have exited VM if OOM\");\n","filename":"src\/hotspot\/share\/utilities\/istream.cpp","additions":10,"deletions":22,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -196,1 +196,1 @@\n-  \/\/ Find some room in the buffer so we call read on it.\n+  \/\/ Find some room in the buffer so we can call read on it.\n@@ -230,2 +230,2 @@\n-    _buffer(nullptr),\n-    _buffer_size(0),\n+    _buffer(&_small_buffer[0]),\n+    _buffer_size(sizeof(_small_buffer)),\n@@ -327,3 +327,0 @@\n-\n-    \/\/ If it is backed by a resource that needs closing, do so.\n-    virtual void close() { }\n@@ -363,3 +360,0 @@\n-  virtual void close() {\n-    _fs.close();\n-  }\n","filename":"src\/hotspot\/share\/utilities\/istream.hpp","additions":3,"deletions":9,"binary":false,"changes":12,"status":"modified"}]}