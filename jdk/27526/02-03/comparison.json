{"files":[{"patch":"@@ -248,0 +248,4 @@\n+        if (UseSVE == 0 && !is_feat_fp16_supported()) {\n+          return false;\n+        }\n+        break;\n@@ -263,1 +267,1 @@\n-        if (UseSVE == 0 && !is_feat_fp16_supported()) {\n+        if (length_in_bytes < 8 || (UseSVE == 0 && !is_feat_fp16_supported())) {\n@@ -391,1 +395,0 @@\n-      case Op_AddReductionVF:\n@@ -393,0 +396,1 @@\n+      case Op_AddReductionVF:\n@@ -3437,1 +3441,1 @@\n-instruct reduce_addHF(vRegF dst, vRegF fsrc, vReg vsrc, vReg tmp) %{\n+instruct reduce_addHF_neon(vRegF dst, vRegF fsrc, vReg vsrc, vReg tmp) %{\n@@ -3452,2 +3456,2 @@\n-\/\/ 1. Non strictly-ordered AddReductionVF when vector size > 128-bits. For example -\n-\/\/    AddReductionVF generated by Vector API. For vector size > 128-bits, it is more\n+\/\/ 1. Non strictly-ordered AddReductionVHF when vector size > 128-bits. For example -\n+\/\/    AddReductionVHF generated by Vector API. For vector size > 128-bits, it is more\n@@ -3456,1 +3460,1 @@\n-\/\/ 2. Strictly-ordered AddReductionVF. For example - AddReductionVF generated by\n+\/\/ 2. Strictly-ordered AddReductionVHF. For example - AddReductionVHF generated by\n@@ -3458,5 +3462,4 @@\n-instruct reduce_addF_sve(vRegF dst_src1, vReg src2) %{\n-  predicate(!VM_Version::use_neon_for_vector(Matcher::vector_length_in_bytes(n->in(2))) ||\n-            n->as_Reduction()->requires_strict_order());\n-  match(Set dst_src1 (AddReductionVF dst_src1 src2));\n-  format %{ \"reduce_addF_sve $dst_src1, $dst_src1, $src2\" %}\n+instruct reduce_addHF_sve(vRegF dst_src1, vReg src2) %{\n+  predicate(UseSVE > 0);\n+  match(Set dst_src1 (AddReductionVHF dst_src1 src2));\n+  format %{ \"reduce_addHF_sve $dst_src1, $dst_src1, $src2\" %}\n@@ -3464,1 +3467,0 @@\n-    assert(UseSVE > 0, \"must be sve\");\n@@ -3467,1 +3469,1 @@\n-    __ sve_fadda($dst_src1$$FloatRegister, __ S, ptrue, $src2$$FloatRegister);\n+    __ sve_fadda($dst_src1$$FloatRegister, __ H, ptrue, $src2$$FloatRegister);\n@@ -3474,2 +3476,2 @@\n-\/\/ 1. Non strictly-ordered AddReductionVHF when vector size > 128-bits. For example -\n-\/\/    AddReductionVHF generated by Vector API. For vector size > 128-bits, it is more\n+\/\/ 1. Non strictly-ordered AddReductionVF when vector size > 128-bits. For example -\n+\/\/    AddReductionVF generated by Vector API. For vector size > 128-bits, it is more\n@@ -3478,1 +3480,1 @@\n-\/\/ 2. Strictly-ordered AddReductionVHF. For example - AddReductionVHF generated by\n+\/\/ 2. Strictly-ordered AddReductionVF. For example - AddReductionVF generated by\n@@ -3480,4 +3482,5 @@\n-instruct reduce_addHF_sve(vRegF dst_src1, vReg src2) %{\n-  predicate(UseSVE > 0);\n-  match(Set dst_src1 (AddReductionVHF dst_src1 src2));\n-  format %{ \"reduce_addHF_sve $dst_src1, $dst_src1, $src2\" %}\n+instruct reduce_addF_sve(vRegF dst_src1, vReg src2) %{\n+  predicate(!VM_Version::use_neon_for_vector(Matcher::vector_length_in_bytes(n->in(2))) ||\n+            n->as_Reduction()->requires_strict_order());\n+  match(Set dst_src1 (AddReductionVF dst_src1 src2));\n+  format %{ \"reduce_addF_sve $dst_src1, $dst_src1, $src2\" %}\n@@ -3485,0 +3488,1 @@\n+    assert(UseSVE > 0, \"must be sve\");\n@@ -3487,1 +3491,1 @@\n-    __ sve_fadda($dst_src1$$FloatRegister, __ H, ptrue, $src2$$FloatRegister);\n+    __ sve_fadda($dst_src1$$FloatRegister, __ S, ptrue, $src2$$FloatRegister);\n@@ -3522,0 +3526,1 @@\n+    assert(UseSVE > 0, \"must be sve\");\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64_vector.ad","additions":26,"deletions":21,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -238,0 +238,4 @@\n+        if (UseSVE == 0 && !is_feat_fp16_supported()) {\n+          return false;\n+        }\n+        break;\n@@ -253,1 +257,1 @@\n-        if (UseSVE == 0 && !is_feat_fp16_supported()) {\n+        if (length_in_bytes < 8 || (UseSVE == 0 && !is_feat_fp16_supported())) {\n@@ -381,1 +385,0 @@\n-      case Op_AddReductionVF:\n@@ -383,0 +386,1 @@\n+      case Op_AddReductionVF:\n@@ -2095,1 +2099,1 @@\n-instruct reduce_addHF(vRegF dst, vRegF fsrc, vReg vsrc, vReg tmp) %{\n+instruct reduce_addHF_neon(vRegF dst, vRegF fsrc, vReg vsrc, vReg tmp) %{\n@@ -2127,1 +2131,1 @@\n-    ifelse($1, F,\n+    ifelse($1, HF, `',\n@@ -2129,1 +2133,1 @@\n-    ',)dnl\n+    ')dnl\n@@ -2137,1 +2141,0 @@\n-REDUCE_ADD_FP_SVE(F,  S)\n@@ -2139,0 +2142,1 @@\n+REDUCE_ADD_FP_SVE(F,  S)\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64_vector_ad.m4","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -323,0 +323,1 @@\n+\n@@ -597,0 +598,1 @@\n+\n","filename":"src\/hotspot\/share\/opto\/vectornode.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}