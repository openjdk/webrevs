{"files":[{"patch":"@@ -282,1 +282,1 @@\n-                        data.remaining() - GCM_TAG_LEN \/ 8);\n+                        c.getOutputSize(data.remaining()));\n@@ -294,1 +294,1 @@\n-                    SSLLogger.fine(\"Decryption failed.\" + e.getMessage());\n+                    SSLLogger.fine(\"Decryption failed.\" + e);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SessionTicketExtension.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @bug 8029661 8325164 8368073\n+ * @bug 8029661 8325164 8368073 8368514\n@@ -34,1 +34,2 @@\n- *      -Djdk.tls.useExtendedMasterSecret=false FipsModeTLS12\n+ *      -Djdk.tls.useExtendedMasterSecret=false\n+ *      -Djdk.tls.client.enableSessionTicketExtension=false FipsModeTLS12\n@@ -104,2 +105,3 @@\n-            \/\/ Self-integrity test (complete TLS 1.2 communication)\n-            new testTLS12SunPKCS11Communication().run();\n+            \/\/ Self-integrity test (complete TLS communication)\n+            testTLS12SunPKCS11Communication.initSslContext();\n+            testTLS12SunPKCS11Communication.run();\n@@ -275,1 +277,1 @@\n-\n+            boolean firstSession = true;\n@@ -280,1 +282,3 @@\n-\n+                \/\/ Check that session resumption works\n+                clientSSLEngine.setEnableSessionCreation(firstSession);\n+                firstSession = false;\n@@ -403,8 +407,0 @@\n-            KeyManagerFactory kmf = KeyManagerFactory.getInstance(\"PKIX\", \"SunJSSE\");\n-            kmf.init(ks, passphrase);\n-\n-            TrustManagerFactory tmf = TrustManagerFactory.getInstance(\"PKIX\", \"SunJSSE\");\n-            tmf.init(ts);\n-\n-            SSLContext sslCtx = SSLContext.getInstance(\"TLS\", \"SunJSSE\");\n-            sslCtx.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null);\n@@ -434,0 +430,12 @@\n+\n+        private static SSLContext sslCtx;\n+        private static void initSslContext() throws Exception {\n+            KeyManagerFactory kmf = KeyManagerFactory.getInstance(\"PKIX\", \"SunJSSE\");\n+            kmf.init(ks, passphrase);\n+\n+            TrustManagerFactory tmf = TrustManagerFactory.getInstance(\"PKIX\", \"SunJSSE\");\n+            tmf.init(ts);\n+\n+            sslCtx = SSLContext.getInstance(\"TLS\", \"SunJSSE\");\n+            sslCtx.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null);\n+        }\n","filename":"test\/jdk\/sun\/security\/pkcs11\/tls\/tls12\/FipsModeTLS12.java","additions":22,"deletions":14,"binary":false,"changes":36,"status":"modified"}]}