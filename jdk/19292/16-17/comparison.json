{"files":[{"patch":"@@ -134,0 +134,5 @@\n+    public void visitModuleImport(JCModuleImport tree) {\n+        tree.module = translate(tree.module);\n+        result = tree;\n+    }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/tree\/TreeTranslator.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -24,0 +24,11 @@\n+\/**\n+ * @test\n+ * @bug 8332497\n+ * @summary error: javac prints an AssertionError when annotation processing runs on program with module imports\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ * @build toolbox.JavacTask toolbox.ToolBox toolbox.Task\n+ * @run main ModuleImportProcessingTest\n+ *\/\n+\n@@ -35,11 +46,2 @@\n-\/**\n- * @test\n- * @bug 8332497\n- * @summary error: javac prints an AssertionError when annotation processing runs on program with module imports\n- * @library \/tools\/lib\n- * @modules jdk.compiler\/com.sun.tools.javac.api\n- *          jdk.compiler\/com.sun.tools.javac.main\n- * @build toolbox.JavacTask toolbox.ToolBox toolbox.Task\n- * @run main ModuleImportProcessingTest\n- *\/\n-public class ModuleImportProcessingTest {\n+\n+public class ModuleImportProcessingTest extends TestRunner {\n@@ -47,1 +49,0 @@\n-    final Path base = Paths.get(\".\");\n@@ -63,0 +64,4 @@\n+    public ModuleImportProcessingTest() {\n+        super(System.err);\n+    }\n+\n@@ -64,1 +69,5 @@\n-        new ModuleImportProcessingTest().test();\n+        new ModuleImportProcessingTest().runTests();\n+    }\n+\n+    protected void runTests() throws Exception {\n+        runTests(m -> new Object[] { Paths.get(m.getName()) });\n@@ -67,1 +76,2 @@\n-    public void test() throws Exception {\n+    @Test\n+    public void test(Path base) throws Exception {\n@@ -76,4 +86,2 @@\n-                .outdir(base.toString())\n-                .files(base.resolve(\"Main.java\"))\n-                .run(Task.Expect.SUCCESS)\n-                .writeAll();\n+                .files(tb.findJavaFiles(base))\n+                .run();\n","filename":"test\/langtools\/tools\/javac\/processing\/ModuleImportProcessingTest.java","additions":26,"deletions":18,"binary":false,"changes":44,"status":"modified"}]}