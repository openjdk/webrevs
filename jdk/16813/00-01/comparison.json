{"files":[{"patch":"@@ -1482,0 +1482,1 @@\n+  bool isExplicitlyDisabled = !FLAG_IS_DEFAULT(UseCompressedOops) && !UseCompressedOops;\n@@ -1484,1 +1485,1 @@\n-  if (ratio > 1 && ratio < 1.02) {\n+  if (!isExplicitlyDisabled && ratio > 1 && ratio < 1.02) {\n@@ -1488,0 +1489,1 @@\n+    \/\/ TODO: print human readable size\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -114,1 +114,3 @@\n-    checkUseCompressedOops(gcflags, maxHeapForCompressedOops + 1, false);\n+    checkUseCompressedOops(gcflags, maxHeapForCompressedOops + 1, true);\n+    checkUseCompressedOops(gcflags, (long) (maxHeapForCompressedOops * 1.02), true);\n+    checkUseCompressedOops(gcflags, (long) (maxHeapForCompressedOops * 1.02) + 1, false);\n@@ -119,1 +121,3 @@\n-    checkUseCompressedOops(join(gcflags, \"-XX:HeapBaseMinAddress=32G\"), maxHeapForCompressedOops + 1, false);\n+    checkUseCompressedOops(join(gcflags, \"-XX:HeapBaseMinAddress=32G\"), maxHeapForCompressedOops + 1, true);\n+    checkUseCompressedOops(join(gcflags, \"-XX:HeapBaseMinAddress=32G\"), (long) (maxHeapForCompressedOops * 1.02), true);\n+    checkUseCompressedOops(join(gcflags, \"-XX:HeapBaseMinAddress=32G\"), (long) (maxHeapForCompressedOops * 1.02) + 1, false);\n@@ -126,1 +130,3 @@\n-    checkUseCompressedOops(join(gcflags, \"-XX:ObjectAlignmentInBytes=16\"), maxHeapForCompressedOops + 1, false);\n+    checkUseCompressedOops(join(gcflags, \"-XX:ObjectAlignmentInBytes=16\"), maxHeapForCompressedOops + 1, true);\n+    checkUseCompressedOops(join(gcflags, \"-XX:ObjectAlignmentInBytes=16\"), (long) (maxHeapForCompressedOops * 1.02), true);\n+    checkUseCompressedOops(join(gcflags, \"-XX:ObjectAlignmentInBytes=16\"), (long) (maxHeapForCompressedOops * 1.02) + 1, false);\n@@ -134,1 +140,3 @@\n-    checkUseCompressedOops(join(gcflags, compressedClassSpaceSizeArg), maxHeapForCompressedOops + 1, false);\n+    checkUseCompressedOops(join(gcflags, compressedClassSpaceSizeArg), maxHeapForCompressedOops + 1, true);\n+    checkUseCompressedOops(join(gcflags, compressedClassSpaceSizeArg), (long) (maxHeapForCompressedOops * 1.02), true);\n+    checkUseCompressedOops(join(gcflags, compressedClassSpaceSizeArg), (long) (maxHeapForCompressedOops * 1.02) + 1, false);\n","filename":"test\/hotspot\/jtreg\/gc\/arguments\/TestUseCompressedOopsErgoTools.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"}]}