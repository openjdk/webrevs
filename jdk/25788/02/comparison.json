{"files":[{"patch":"@@ -47,0 +47,3 @@\n+    private static final boolean NIO_COMPATIBLE_EQUALS =\n+        Boolean.getBoolean(\"jdk.io.File.windowsUseNIOStyleEquals\");\n+\n@@ -638,0 +641,23 @@\n+        \/\/ If property is set, compare pathname strings as in\n+        \/\/ sun.nio.fs.WindowsPath.compareTo\n+        if (NIO_COMPATIBLE_EQUALS) {\n+            String s1 = f1.getPath();\n+            String s2 = f2.getPath();\n+            int n1 = s1.length();\n+            int n2 = s2.length();\n+            int min = Math.min(n1, n2);\n+            for (int i = 0; i < min; i++) {\n+                char c1 = s1.charAt(i);\n+                char c2 = s2.charAt(i);\n+                if (c1 != c2) {\n+                    c1 = Character.toUpperCase(c1);\n+                    c2 = Character.toUpperCase(c2);\n+                    if (c1 != c2) {\n+                        return c1 - c2;\n+                    }\n+                }\n+            }\n+            return n1 - n2;\n+        }\n+\n+        \/\/ If property is not set, use legacy pathname comparison\n","filename":"src\/java.base\/windows\/classes\/java\/io\/WinNTFileSystem.java","additions":26,"deletions":0,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,2 +25,6 @@\n-   @bug 4131169\n-   @summary Test respecified compareTo method\n+ * @bug 4131169 8191963\n+ * @summary Test compareTo and equals methods\n+ * @library .. \/test\/lib\n+ * @build jdk.test.lib.Platform\n+ * @run main CompareTo\n+ * @run main\/othervm -Djdk.io.File.legacyEquals=true CompareTo\n@@ -29,2 +33,2 @@\n-import java.io.*;\n-\n+import java.io.File;\n+import jdk.test.lib.Platform;\n@@ -39,0 +43,26 @@\n+\n+        \/\/ U+0131 = ı 'LATIN SMALL LETTER DOTLESS I'\n+        File smallDotlessI = new File(\"\\u0131\");\n+        File latinLowerI   = new File(\"i\");\n+        \/\/ U+0130 = İ 'LATIN CAPITAL LETTER I WITH DOT ABOVE'\n+        File largeDotfullI = new File(\"\\u0130\");\n+        File latinCapitalI = new File(\"I\");\n+\n+        if (!smallDotlessI.equals(latinCapitalI))\n+            throw new Exception(\"Small dotless \\\"i\\\" does not equal \\\"I\\\"\");\n+        if (!smallDotlessI.equals(latinLowerI))\n+            throw new Exception(\"Small dotless \\\"i\\\" does not equal \\\"i\\\"\");\n+\n+        boolean legacyEquals = !Boolean.getBoolean(\"jdk.io.File.windowsUseNIOStyleEquals\");\n+\n+        boolean shouldNotBeEqualUpper = largeDotfullI.equals(latinCapitalI);\n+        if (shouldNotBeEqualUpper && !legacyEquals)\n+            throw new Exception(\"Large dotted \\\"I\\\" equals \\\"I\\\"\");\n+        else if (!shouldNotBeEqualUpper && legacyEquals)\n+            throw new Exception(\"Large dotted \\\"I\\\" does not equal \\\"I\\\"\");\n+\n+        boolean shouldNotBeEqualLower = largeDotfullI.equals(latinLowerI);\n+        if (shouldNotBeEqualLower && !legacyEquals)\n+            throw new Exception(\"Large dotted \\\"I\\\" equals \\\"i\\\"\");\n+        else if (!shouldNotBeEqualLower && legacyEquals)\n+            throw new Exception(\"Large dotted \\\"I\\\" does not equal \\\"i\\\"\");\n@@ -49,2 +79,4 @@\n-        if (File.separatorChar == '\\\\') testWin32();\n-        if (File.separatorChar == '\/') testUnix();\n+        if (Platform.isWindows())\n+            testWin32();\n+        else\n+            testUnix();\n","filename":"test\/jdk\/java\/io\/File\/CompareTo.java","additions":39,"deletions":7,"binary":false,"changes":46,"status":"modified"}]}