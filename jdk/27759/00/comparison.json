{"files":[{"patch":"@@ -36,0 +36,1 @@\n+#include \"utilities\/deferredStatic.hpp\"\n@@ -42,1 +43,22 @@\n-static PlatformMutex* GlobalChunkPoolMutex = nullptr;\n+class RecursivePlatformMutex : public PlatformMutex {\n+  Thread* _owner;\n+\n+public:\n+  RecursivePlatformMutex()\n+    : PlatformMutex(), _owner(nullptr) {}\n+\n+  void lock() {\n+    Thread* t = Thread::current_or_null_safe();\n+    if (_owner == nullptr || t != _owner) {\n+      PlatformMutex::lock();\n+      _owner = t;\n+    }\n+  }\n+\n+  void unlock() {\n+    _owner = nullptr;\n+    PlatformMutex::unlock();\n+  }\n+};\n+\n+static DeferredStatic<RecursivePlatformMutex> GlobalChunkPoolMutex;\n@@ -45,1 +67,1 @@\n-  GlobalChunkPoolMutex = new PlatformMutex();\n+  GlobalChunkPoolMutex.initialize();\n@@ -49,1 +71,0 @@\n-  assert(GlobalChunkPoolMutex != nullptr, \"must be initialized\");\n@@ -229,1 +250,1 @@\n- public:\n+public:\n","filename":"src\/hotspot\/share\/memory\/arena.cpp","additions":25,"deletions":4,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- public:\n+public:\n","filename":"src\/hotspot\/share\/memory\/arena.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}