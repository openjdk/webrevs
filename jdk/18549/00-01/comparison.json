{"files":[{"patch":"@@ -2270,0 +2270,11 @@\n+jmethodID InstanceKlass::update_jmethod_id(jmethodID* jmeths, Method* method, int idnum) {\n+  if (method->is_old() && !method->is_obsolete()) {\n+    \/\/ If the method passed in is old (but not obsolete), use the current version\n+    method = method_with_idnum((int)idnum);\n+    assert(method != nullptr, \"old and but not obsolete, so should exist\");\n+  }\n+  jmethodID new_id = Method::make_jmethod_id(class_loader_data(), method);\n+  Atomic::release_store(&jmeths[idnum+1], new_id);\n+  return new_id;\n+}\n+\n@@ -2277,1 +2288,1 @@\n-  int idnum = method_h->method_idnum();\n+  int idnum = method->method_idnum();\n@@ -2290,1 +2301,1 @@\n-  \/\/ generally acquired in those two cases.\n+  \/\/ acquired in those two cases.\n@@ -2306,9 +2317,1 @@\n-\n-      \/\/ method_with_idnum\n-      if (method->is_old() && !method->is_obsolete()) {\n-        \/\/ The method passed in is old (but not obsolete), we need to use the current version\n-        method = method_with_idnum((int)idnum);\n-        assert(method != nullptr, \"old and but not obsolete, so should exist\");\n-      }\n-      jmethodID new_id = Method::make_jmethod_id(class_loader_data(), method);\n-      Atomic::release_store(&jmeths[idnum+1], new_id);\n+      jmethodID new_id = update_jmethod_id(jmeths, method, idnum);\n@@ -2328,8 +2331,1 @@\n-      if (method->is_old() && !method->is_obsolete()) {\n-        \/\/ The method passed in is old (but not obsolete), we need to use the current version\n-        method = method_with_idnum((int)idnum);\n-        assert(method != nullptr, \"old and but not obsolete, so should exist\");\n-      }\n-      jmethodID new_id = Method::make_jmethod_id(class_loader_data(), method);\n-      Atomic::release_store(&jmeths[idnum+1], new_id);\n-      return new_id;\n+      return update_jmethod_id(jmeths, method, idnum);\n@@ -2338,1 +2334,0 @@\n-\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":15,"deletions":20,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -1075,0 +1075,1 @@\n+  jmethodID update_jmethod_id(jmethodID* jmeths, Method* method, int idnum);\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}