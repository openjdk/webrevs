{"files":[{"patch":"@@ -697,8 +697,0 @@\n-\n-    \/\/ Verify before mark is done before swapping card tables.\n-    \/\/ Therefore, the write card table will be verified before being taken snapshot.\n-    if (ShenandoahVerify) {\n-      ShenandoahTimingsTracker v(ShenandoahPhaseTimings::init_mark_verify);\n-      heap->verifier()->verify_before_concmark();\n-    }\n-\n@@ -711,1 +703,1 @@\n-  if (ShenandoahVerify && heap->mode()->is_generational()) {\n+  if (ShenandoahVerify) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentGC.cpp","additions":1,"deletions":9,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1060,3 +1060,2 @@\n-      !_heap->old_generation()->is_mark_complete() &&\n-      !_heap->old_generation()->is_parsable()) {\n-    \/\/ Before marking, remembered set can't be verified w\/o complete old marking and parseable old gen.\n+      !_heap->old_generation()->is_mark_complete()) {\n+    \/\/ Before marking in generational mode, remembered set can't be verified w\/o complete old marking.\n@@ -1126,4 +1125,1 @@\n-      !_heap->old_generation()->is_mark_complete() &&\n-      !_heap->old_generation()->is_parsable()) {\n-    \/\/ Before marking, remembered set can't be verified in global GC, because,\n-    \/\/ we don't know whether old gen is parseable or not.\n+      !_heap->old_generation()->is_mark_complete()) {\n@@ -1282,4 +1278,2 @@\n-      oop obj = CompressedOops::decode_raw(o);\n-      assert(is_object_aligned(obj), \"address not aligned: \" PTR_FORMAT, p2i(obj));\n-      ShenandoahHeapRegion* region = _heap->heap_region_containing(obj);\n-      if (region->is_active() && region->is_young() && !_scanner->is_card_dirty((HeapWord*) p)) {\n+      oop obj = CompressedOops::decode_not_null(o);\n+      if (_heap->is_in_young(obj) && !_scanner->is_card_dirty((HeapWord*) p)) {\n@@ -1300,2 +1294,2 @@\n-  ShenandoahMarkingContext* ctx = _heap->old_generation()->is_mark_complete() ?\n-    _heap->old_generation()->complete_marking_context() : nullptr;\n+  ShenandoahOldGeneration* old_gen = _heap->old_generation();\n+  assert(old_gen->is_mark_complete() || old_gen->is_parsable(), \"Sanity\");\n@@ -1303,0 +1297,1 @@\n+  ShenandoahMarkingContext* ctx = old_gen->is_mark_complete() ?old_gen->complete_marking_context() : nullptr;\n@@ -1377,1 +1372,1 @@\n-  ShenandoahWriteTableScanner scanner(ShenandoahGenerationalHeap::heap()->old_generation()->card_scan());\n+  ShenandoahScanRemembered* scanner = ShenandoahGenerationalHeap::heap()->old_generation()->card_scan();\n@@ -1381,1 +1376,1 @@\n-      help_verify_region_rem_set(&scanner, r, r->end(), \"Verify init-mark remembered set violation\");\n+      help_verify_region_rem_set(scanner, r, r->end(), \"Verify init-mark remembered set violation\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.cpp","additions":10,"deletions":15,"binary":false,"changes":25,"status":"modified"}]}