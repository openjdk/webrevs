{"files":[{"patch":"@@ -1792,1 +1792,10 @@\n-static bool _print_ascii_file(const char* filename, outputStream* st, const char* hdr = nullptr) {\n+static unsigned count_newlines(const char* s) {\n+  unsigned n = 0;\n+  for (const char* s2 = strchr(s, '\\n');\n+       s2 != nullptr; s2 = strchr(s2 + 1, '\\n')) {\n+    n++;\n+  }\n+  return n;\n+}\n+\n+static bool _print_ascii_file(const char* filename, outputStream* st, unsigned* num_lines = nullptr, const char* hdr = nullptr) {\n@@ -1805,0 +1814,1 @@\n+  unsigned lines = 0;\n@@ -1807,0 +1817,8 @@\n+    \/\/ count newlines\n+    if (num_lines != nullptr) {\n+      lines += count_newlines(buf);\n+    }\n+  }\n+\n+  if (num_lines != nullptr) {\n+    (*num_lines) = lines;\n@@ -1828,2 +1846,2 @@\n-\n-  if (!_print_ascii_file(fname, st)) {\n+  unsigned num = 0;\n+  if (!_print_ascii_file(fname, st, &num)) {\n@@ -1831,0 +1849,2 @@\n+  } else {\n+    st->print_cr(\"Total number of mappings: %u\", num);\n@@ -2178,1 +2198,1 @@\n-  return _print_ascii_file(\"\/etc\/ld.so.preload\", st, \"\/etc\/ld.so.preload:\");\n+  return _print_ascii_file(\"\/etc\/ld.so.preload\", st, nullptr, \"\/etc\/ld.so.preload:\");\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":24,"deletions":4,"binary":false,"changes":28,"status":"modified"}]}