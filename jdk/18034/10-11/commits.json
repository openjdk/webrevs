[{"commit":{"message":"Merge with master"},"files":[],"sha":"35e6258d9ddf8e72e19c4f8192e2413c5c53905b"},{"commit":{"message":"Make changes in IR rules for JTREG tests"},"files":[],"sha":"db88e3c985857c7866d90a02af7c9db1d68cefae"},{"commit":{"message":"Modify JTREG IR rules and some style\/format changes"},"files":[],"sha":"b8f6cfb50972df49e8ae77759fcd492e2b5b61ec"},{"commit":{"message":"Add dump_spec and JTREG IR tests for Add\/Mul Reduction Nodes"},"files":[],"sha":"3afde82c39eb4506642123ec0bcc4ab19358bedd"},{"commit":{"message":"Merge master"},"files":[],"sha":"bdd0fabf0f342de065b90163327b6cc5ac025b60"},{"commit":{"message":"Adjust format for the backend rules changed in previous commit"},"files":[],"sha":"6d25d78f0bf53638672b2133d3820f8ff56d5205"},{"commit":{"message":"Address some more review comments"},"files":[],"sha":"f38dae2112b3791c5f1ceb503555b6b9fa6504de"},{"commit":{"message":"Revert to previous indentation"},"files":[],"sha":"71a86deb23899f43bf740c335fe254a7c4323628"},{"commit":{"message":"Add comments, revert to requires_strict_order and other minor changes"},"files":[],"sha":"1156ef39570bd599a4e6c3a5679c590a35896e0f"},{"commit":{"message":"Naming changes: replace strict\/non-strict with more technical terms"},"files":[],"sha":"4aed4b504432271215d8950d53757ed0036bf2ed"},{"commit":{"message":"Addressed review comments for changes in backend rules and code style"},"files":[],"sha":"f8f79ac292d6736fd83effcca0eb9b3053fb0cb2"},{"commit":{"message":"8320725: C2: Add \"requires_strict_order\" flag for floating-point add-reduction\n\nFloating-point addition is non-associative, that is adding\nfloating-point elements in arbitrary order may get different value.\nSpecially, Vector API does not define the order of reduction\nintentionally, which allows platforms to generate more efficient codes\n[1]. So that needs a node to represent non strictly-ordered\nadd-reduction for floating-point type in C2.\n\nTo avoid introducing new nodes, this patch adds a bool field in\n`AddReductionVF\/D` to distinguish whether they require strict order. It\nalso removes `UnorderedReductionNode` and adds a virtual function\n`bool requires_strict_order()` in `ReductionNode`. Besides\n`AddReductionVF\/D`, other reduction nodes' `requires_strict_order()`\nhave a fixed value.\n\nWith this patch, Vector API would always generate non strictly-ordered\n`AddReductionVF\/D' on SVE machines with vector length <= 16B as it is\nmore beneficial to generate non-strictly ordered instructions on such\nmachines compared to strictly ordered ones.\n\n[AArch64]\nOn Neon, non strictly-ordered `AddReductionVF\/D` cannot be generated.\nAuto-vectorization has already banned these nodes in JDK-8275275 [2].\n\nThis patch adds matching rules for non strictly-ordered\n`AddReductionVF\/D`.\n\nNo effects on other platforms.\n\n[Performance]\nFloatMaxVector.ADDLanes [3] measures the performance of add reduction\nfor floating-point type. With this patch, it improves ~3x on my SVE\nmachine (128-bit).\n\nADDLanes\nBenchmark                 Before     After      Unit\nFloatMaxVector.ADDLanes   1789.513   5264.226   ops\/ms\n\nFinal code is as below:\n\n```\nBefore:\n        fadda        z17.s, p7\/m, z17.s, z16.s\n\nAfter:\n        faddp        v17.4s, v21.4s, v21.4s\n        faddp        s18, v17.2s\n        fadd         s18, s18, s19\n\n```\n\n[Test]\nFull jtreg passed on AArch64 and x86.\n\n[1] https:\/\/github.com\/openjdk\/jdk\/blob\/master\/src\/jdk.incubator.vector\/share\/classes\/jdk\/incubator\/vector\/FloatVector.java#L2529\n[2] https:\/\/bugs.openjdk.org\/browse\/JDK-8275275\n[3] https:\/\/github.com\/openjdk\/panama-vector\/blob\/vectorIntrinsics\/test\/micro\/org\/openjdk\/bench\/jdk\/incubator\/vector\/operation\/FloatMaxVector.java#L316"},"files":[],"sha":"f8492ece3c58d6ab0894820fe3b0ae51339ca298"}]