{"files":[{"patch":"@@ -64,0 +64,4 @@\n+    void disable_feature() {\n+      _enabled = false;\n+      _value = -1;\n+    }\n@@ -72,7 +76,12 @@\n-  #define UPDATE_DEFAULT(flag)        \\\n-  void update_flag() {                \\\n-      assert(enabled(), \"Must be.\");  \\\n-      if (FLAG_IS_DEFAULT(flag)) {    \\\n-        FLAG_SET_DEFAULT(flag, true); \\\n-      }                               \\\n-  }                                   \\\n+  #define UPDATE_DEFAULT(flag)             \\\n+  void update_flag() {                     \\\n+      assert(enabled(), \"Must be.\");       \\\n+      if (FLAG_IS_DEFAULT(flag)) {         \\\n+        FLAG_SET_DEFAULT(flag, true);      \\\n+      } else {                             \\\n+        \/* Sync CPU features with flags *\/ \\\n+        if (!flag) {                       \\\n+          disable_feature();               \\\n+        }                                  \\\n+      }                                    \\\n+  }                                        \\\n@@ -80,2 +89,2 @@\n-  #define NO_UPDATE_DEFAULT           \\\n-  void update_flag() {}               \\\n+  #define NO_UPDATE_DEFAULT                \\\n+  void update_flag() {}                    \\\n","filename":"src\/hotspot\/cpu\/riscv\/vm_version_riscv.hpp","additions":18,"deletions":9,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -118,0 +118,9 @@\n+      \/\/ Change flag default\n+      _feature_list[i]->update_flag();\n+\n+      \/\/ Feature will be disabled by update_flag() if flag\n+      \/\/ is set to false by the user on the command line.\n+      if (!_feature_list[i]->enabled()) {\n+        continue;\n+      }\n+\n@@ -142,2 +151,0 @@\n-      \/\/ Change flag default\n-      _feature_list[i]->update_flag();\n","filename":"src\/hotspot\/os_cpu\/linux_riscv\/vm_version_linux_riscv.cpp","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"}]}