{"files":[{"patch":"@@ -32,1 +32,0 @@\n-import java.security.spec.AlgorithmParameterSpec;\n@@ -38,1 +37,0 @@\n-import javax.crypto.spec.SecretKeySpec;\n@@ -194,3 +192,3 @@\n-        TlsKey              (\"key\", false),\n-        TlsIv               (\"iv\",  true),\n-        TlsUpdateNplus1     (\"traffic upd\", false);\n+        TlsKey              (\"key\"),\n+        TlsIv               (\"iv\"),\n+        TlsUpdateNplus1     (\"traffic upd\");\n@@ -199,1 +197,0 @@\n-        private final boolean isIv;\n@@ -201,1 +198,1 @@\n-        KeySchedule(String label, boolean isIv) {\n+        KeySchedule(String label) {\n@@ -203,1 +200,0 @@\n-            this.isIv = isIv;\n@@ -207,3 +203,5 @@\n-            if (this == KeySchedule.TlsUpdateNplus1)\n-                return cs.hashAlg.hashLength;\n-            return isIv ? cs.bulkCipher.ivSize : cs.bulkCipher.keySize;\n+            return switch (this) {\n+                case TlsUpdateNplus1 -> cs.hashAlg.hashLength;\n+                case TlsIv -> cs.bulkCipher.ivSize;\n+                case TlsKey -> cs.bulkCipher.keySize;\n+            };\n@@ -213,1 +211,1 @@\n-            return isIv ? algorithm : cs.bulkCipher.algorithm;\n+            return this == TlsKey ? cs.bulkCipher.algorithm : algorithm;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLTrafficKeyDerivation.java","additions":10,"deletions":12,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @bug 8029661 8325164 8368073 8368514\n+ * @bug 8029661 8325164 8368073 8368514 8368520\n@@ -91,0 +91,3 @@\n+        \/\/ reduce the limit to trigger a key update later\n+        Security.setProperty(\"jdk.tls.keyLimits\",\n+                \"AES\/GCM\/NoPadding KeyUpdate 10000\");\n@@ -308,0 +311,1 @@\n+                \/\/ big enough to trigger a key update\n@@ -309,1 +313,1 @@\n-                        \"Hi Server, I'm Client\".getBytes());\n+                        \"a\".repeat(16000).getBytes());\n@@ -311,1 +315,1 @@\n-                        \"Hello Client, I'm Server\".getBytes());\n+                        \"b\".repeat(16000).getBytes());\n","filename":"test\/jdk\/sun\/security\/pkcs11\/tls\/fips\/FipsModeTLS.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"}]}