{"files":[{"patch":"@@ -213,1 +213,3 @@\n-            return isIv ? algorithm : cs.bulkCipher.algorithm;\n+            if (this == TlsKey)\n+                return cs.bulkCipher.algorithm;\n+            return algorithm;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLTrafficKeyDerivation.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @bug 8029661 8325164 8368073 8368514\n+ * @bug 8029661 8325164 8368073 8368514 8368520\n@@ -91,0 +91,3 @@\n+        \/\/ reduce the limit to trigger a key update later\n+        Security.setProperty(\"jdk.tls.keyLimits\",\n+                \"AES\/GCM\/NoPadding KeyUpdate 10000\");\n@@ -308,0 +311,1 @@\n+                \/\/ big enough to trigger a key update\n@@ -309,1 +313,1 @@\n-                        \"Hi Server, I'm Client\".getBytes());\n+                        \"a\".repeat(16000).getBytes());\n@@ -311,1 +315,1 @@\n-                        \"Hello Client, I'm Server\".getBytes());\n+                        \"b\".repeat(16000).getBytes());\n","filename":"test\/jdk\/sun\/security\/pkcs11\/tls\/fips\/FipsModeTLS.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"}]}