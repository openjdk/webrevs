{"files":[{"patch":"@@ -24,4 +24,0 @@\n-import javax.imageio.ImageIO;\n-import javax.swing.JButton;\n-import javax.swing.JFrame;\n-import javax.swing.SwingUtilities;\n@@ -44,0 +40,4 @@\n+import javax.imageio.ImageIO;\n+import javax.swing.JButton;\n+import javax.swing.JFrame;\n+import javax.swing.SwingUtilities;\n@@ -51,2 +51,2 @@\n- * resized back to normal.  The test case simulates this operation using\n- * a JButton.  A file image of the component will be saved before and after\n+ * resized back to normal. The test case simulates this operation using\n+ * a JButton. A file image of the component will be saved before and after\n@@ -98,1 +98,0 @@\n-        frame.setLocationRelativeTo(null);\n@@ -139,3 +138,0 @@\n-            File file1 = new File(\"image1.png\");\n-            saveButtonImage(bimage1, file1);\n-\n@@ -145,1 +141,1 @@\n-                \/\/maximize frame from normal size\n+                \/\/ maximize frame from normal size\n@@ -152,1 +148,1 @@\n-                    \/\/resize from maximum size to normal\n+                    \/\/ resize from maximum size to normal\n@@ -158,2 +154,0 @@\n-                    File file2 = new File(\"image2.png\");\n-                    saveButtonImage(bimage2, file2);\n@@ -163,1 +157,0 @@\n-                    di.compare(bimage1, bimage2);\n@@ -165,4 +158,2 @@\n-                    \/\/ results of image comparison\n-                    int numDiffPixels = di.getNumDiffPixels();\n-                    if (numDiffPixels != 0) {\n-                        throw new RuntimeException(\"Button renderings are different after window resize, num of Diff Pixels=\" + numDiffPixels);\n+                    if (!di.compare(bimage1, bimage2)) {\n+                        throw new RuntimeException(\"Button renderings are different after window resize, num of Diff Pixels=\" + di.getNumDiffPixels());\n@@ -181,1 +172,1 @@\n-            disposeFrame();\n+            SwingUtilities.invokeAndWait(() -> disposeFrame());\n@@ -185,1 +176,1 @@\n-    \/\/Capture button rendering as a BufferedImage\n+    \/\/ Capture button rendering as a BufferedImage\n@@ -203,1 +194,8 @@\n-    \/\/Save BufferedImage to PNG file\n+    private void disposeFrame() {\n+        if (frame != null) {\n+            frame.dispose();\n+            frame = null;\n+        }\n+    }\n+\n+    \/\/ Save BufferedImage to PNG file\n@@ -217,7 +215,0 @@\n-    private void disposeFrame() {\n-        if (frame != null) {\n-            frame.dispose();\n-            frame = null;\n-        }\n-    }\n-\n@@ -242,1 +233,1 @@\n-        public void compare(BufferedImage img1, BufferedImage img2) throws IOException {\n+        public boolean compare(BufferedImage img1, BufferedImage img2) throws IOException {\n@@ -258,1 +249,0 @@\n-            System.out.println(\"Going to compare the images with a threshold of \" + threshold + \" pixels\");\n@@ -302,0 +292,2 @@\n+                saveButtonImage(img1, new File(\"image1.png\"));\n+                saveButtonImage(img2, new File(\"image2.png\"));\n@@ -303,0 +295,1 @@\n+            return nDiff == 0;\n","filename":"test\/jdk\/javax\/swing\/JButton\/SwingButtonResizeTestWithOpenGL.java","additions":24,"deletions":31,"binary":false,"changes":55,"status":"modified"}]}