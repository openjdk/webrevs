{"files":[{"patch":"@@ -28,0 +28,3 @@\n+import java.net.URI;\n+import java.nio.file.Path;\n+import java.security.CodeSource;\n@@ -29,2 +32,0 @@\n-import java.util.regex.Pattern;\n-import java.util.regex.Matcher;\n@@ -83,14 +84,0 @@\n-        String testclasspath = System.getProperty(\"test.class.path\");\n-        String [] testpaths = testclasspath.split(System.getProperty(\"path.separator\"));\n-        String classesDir = \"\";\n-\n-        Pattern pattern = Pattern.compile(\"^(.*)classes(.*)vmTestbase(.*)$\");\n-        for (int i = 0 ; i < testpaths.length; i++) {\n-            if (pattern.matcher(testpaths[i]).matches()) {\n-                classesDir = testpaths[i];\n-            }\n-        }\n-        if (classesDir.equals(\"\")) {\n-            System.err.println(\"TEST BUG: Classes directory not found in test,class.path.\");\n-            return Consts.TEST_FAILED;\n-        }\n@@ -100,1 +87,3 @@\n-        byte[] bloatBytes = fileBytes(classesDir + File.separator + className.replace('.', '\/') + \".class\");\n+        CodeSource classCodeSource = Helper.class.getProtectionDomain().getCodeSource();\n+        Path classFilePath = Path.of(URI.create(classCodeSource.getLocation().toString()));\n+        byte[] bloatBytes = fileBytes(classFilePath.resolve(className.replace('.', '\/') + \".class\").toString());\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/ResourceExhausted\/resexhausted003.java","additions":6,"deletions":17,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Red Hat, Inc.\n+ * Copyright (c) 2022, 2025, Red Hat, Inc.\n@@ -33,0 +33,1 @@\n+import java.net.URI;\n@@ -57,1 +58,0 @@\n-    private static final String TEST_CLASSES = System.getProperty(\"test.classes\", \".\");\n@@ -61,2 +61,0 @@\n-    private static final Path PROVIDER_PARENT = Paths.get(TEST_CLASSES, \"..\");\n-    private static final Path PROVIDER_DIR = PROVIDER_PARENT.resolve(\"provider\");\n@@ -84,1 +82,3 @@\n-            JarUtils.createJarFile(UNSIGNED_JAR, PROVIDER_DIR);\n+            var codeSource = baz.CalendarDataProviderImpl.class.getProtectionDomain().getCodeSource();\n+            var providerDir = Path.of(URI.create(codeSource.getLocation().toString()));\n+            JarUtils.createJarFile(UNSIGNED_JAR, providerDir);\n","filename":"test\/jdk\/java\/security\/SignedJar\/spi-calendar-provider\/TestSPISigned.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"}]}