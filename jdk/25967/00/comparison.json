{"files":[{"patch":"@@ -78,0 +78,1 @@\n+    private static native void nativeInstallOpenURLEventHandler();\n@@ -214,0 +215,1 @@\n+        nativeInstallOpenURLEventHandler();\n","filename":"src\/java.desktop\/macosx\/classes\/com\/apple\/eawt\/Application.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -47,0 +47,1 @@\n+    BOOL fOpenURLHandlerInstalled;\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/ApplicationDelegate.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -246,0 +246,1 @@\n+    fOpenURLHandlerInstalled = NO;\n@@ -247,4 +248,1 @@\n-        [[NSAppleEventManager sharedAppleEventManager] setEventHandler:self\n-                                                           andSelector:@selector(_handleOpenURLEvent:withReplyEvent:)\n-                                                         forEventClass:kInternetEventClass\n-                                                            andEventID:kAEGetURL];\n+        [self _installOpenURLHandler];\n@@ -305,2 +303,11 @@\n-- (void)_handleOpenURLEvent:(NSAppleEventDescriptor *)openURLEvent withReplyEvent:(NSAppleEventDescriptor *)replyEvent {\n-    if (!fHandlesURLTypes) return;\n+- (void)_installOpenURLHandler {\n+AWT_ASSERT_APPKIT_THREAD;\n+    if (fOpenURLHandlerInstalled) return;\n+\n+    [[NSAppleEventManager sharedAppleEventManager] setEventHandler:self\n+                                                       andSelector:@selector(_handleOpenURLEvent:withReplyEvent:)\n+                                                     forEventClass:kInternetEventClass\n+                                                        andEventID:kAEGetURL];\n+\n+    fOpenURLHandlerInstalled = YES;\n+}\n@@ -308,0 +315,1 @@\n+- (void)_handleOpenURLEvent:(NSAppleEventDescriptor *)openURLEvent withReplyEvent:(NSAppleEventDescriptor *)replyEvent {\n@@ -629,0 +637,18 @@\n+\/*\n+ * Class:     com_apple_eawt_Application\n+ * Method:    nativeInstallOpenURLEventHandler\n+ * Signature: ()V\n+ *\/\n+JNIEXPORT void JNICALL Java_com_apple_eawt_Application_nativeInstallOpenURLEventHandler\n+(JNIEnv *env, jclass clz)\n+{\n+JNI_COCOA_ENTER(env);\n+    [ThreadUtilities performOnMainThreadWaiting:YES block:^(){\n+        ApplicationDelegate *delegate = [ApplicationDelegate sharedDelegate];\n+            if (delegate != nil) {\n+                [delegate _installOpenURLHandler];\n+            }\n+    }];\n+JNI_COCOA_EXIT(env);\n+}\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/ApplicationDelegate.m","additions":32,"deletions":6,"binary":false,"changes":38,"status":"modified"}]}