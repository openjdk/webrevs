{"files":[{"patch":"@@ -207,0 +207,5 @@\n+\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/matcher_aarch64.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -196,0 +196,4 @@\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/arm\/matcher_arm.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -206,0 +206,4 @@\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/ppc\/matcher_ppc.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -202,0 +202,4 @@\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/riscv\/matcher_riscv.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -199,0 +199,4 @@\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/s390\/matcher_s390.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -239,0 +239,4 @@\n+  static bool supports_vector_different_use_def_size() {\n+    return false;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/x86\/matcher_x86.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2334,2 +2334,11 @@\n-  \/\/ Default case: input size of use equals output size of def.\n-  return type2aelembytes(use_bt) == type2aelembytes(def_bt);\n+  \/\/ Input size of use equals output size of def\n+  if (type2aelembytes(use_bt) == type2aelembytes(def_bt)) {\n+    return true;\n+  }\n+\n+  \/\/ Allow CMove to have different type for comparision and moving.\n+  if (VectorNode::is_different_use_def_size_supported() && return use->is_CMove() && def->is_Bool()) {\n+    return true;\n+  }\n+\n+  return false;\n","filename":"src\/hotspot\/share\/opto\/superword.cpp","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -409,0 +409,4 @@\n+bool VectorNode::is_different_use_def_size_supported() {\n+  return Matcher::supports_vector_different_use_def_size();\n+}\n+\n@@ -2305,0 +2309,1 @@\n+\n","filename":"src\/hotspot\/share\/opto\/vectornode.cpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -113,0 +113,3 @@\n+  \/\/ Return true if every bit in this vector is 1, e.g. based on the comparison\n+  \/\/ result of 2 floats, set a double result.\n+  static bool is_different_use_def_size_supported();\n","filename":"src\/hotspot\/share\/opto\/vectornode.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1424,2 +1424,3 @@\n-  const BoolTest bt(_test._mask);\n-  tty->print(\" test=\");\n+  BoolTest::mask m = BoolTest::mask(_test._mask & ~BoolTest::unsigned_compare);\n+  const BoolTest bt(m);\n+  tty->print(\" test=%s\", m == _test._mask ? \"\" : \"unsigned \");\n","filename":"src\/hotspot\/share\/opto\/vtransform.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}