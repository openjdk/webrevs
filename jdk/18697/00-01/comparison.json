{"files":[{"patch":"@@ -39,1 +39,3 @@\n-  char* bad_name = nullptr;\n+  \/\/ We need some memory that will SIGSEGV if read to.\n+  \/\/ os::reserve_memory fits the bill, as it does PROT_NONE.\n+  char* res_memory = os::reserve_memory(os::vm_page_size(), false, mtTest);\n@@ -43,2 +45,6 @@\n-    os::free(bad_name);\n-    bad_name = os::strdup(str);\n+    \/\/ Remove old string.\n+    os::uncommit_memory(res_memory, strlen(res_memory) + 1);\n+    \/\/ Write new string.\n+    size_t strsz = strlen(str) + 1;\n+    os::commit_memory(res_memory, strsz , false);\n+    ::memcpy(res_memory, str, strsz);\n@@ -46,1 +52,1 @@\n-    call_parse_kernel_version(&major, &minor, bad_name);\n+    call_parse_kernel_version(&major, &minor, res_memory);\n","filename":"test\/hotspot\/gtest\/os\/linux\/test_os_linux.cpp","additions":10,"deletions":4,"binary":false,"changes":14,"status":"modified"}]}