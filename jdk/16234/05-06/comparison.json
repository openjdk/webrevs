{"files":[{"patch":"@@ -818,2 +818,3 @@\n-Evaluating Elementary Functions<\/a> is required when building\n-libvmath.so on Linux\/aarch64 platforms.<\/p>\n+Evaluating Elementary Functions<\/a> is optional. But it will provide\n+performance enhancement for vector math operations on Linux\/aarch64\n+platforms.<\/p>\n@@ -827,4 +828,1 @@\n-<code>configure<\/code> does not properly locate your libsleef files.\n-This is optional. If libsleef is neither installed nor specified\n-manually, the JDK build will succeed but without libvmath.so and the\n-performance enhancements provided by it.<\/p>\n+<code>configure<\/code> does not properly locate your libsleef files.<\/p>\n","filename":"doc\/building.html","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -639,2 +639,2 @@\n-https:\/\/sleef.org\/) is required when building libvmath.so on Linux\/aarch64\n-platforms.\n+https:\/\/sleef.org\/) is optional. But it will provide performance enhancement\n+for vector math operations on Linux\/aarch64 platforms.\n@@ -648,3 +648,1 @@\n-files. This is optional. If libsleef is neither installed nor specified\n-manually, the JDK build will succeed but without libvmath.so and the\n-performance enhancements provided by it.\n+files.\n","filename":"doc\/building.md","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,0 +35,6 @@\n+  AC_ARG_WITH(libsleef-include, [AS_HELP_STRING([--with-libsleef-include],\n+      [specify directory for the libsleef include files\n+      (should be used together with --with-libsleef-lib)])])\n+  AC_ARG_WITH(libsleef-lib, [AS_HELP_STRING([--with-libsleef-lib],\n+      [specify directory for the libsleef library\n+      (should be used together with --with-libsleef-include)])])\n@@ -40,4 +46,5 @@\n-  if test \"x$NEEDS_LIB_SLEEF\" = xfalse; then\n-    if test \"x${with_libsleef}\" != \"x\" &&\n-       test \"x${with_libsleef}\" != \"xno\"; then\n-      AC_MSG_WARN([[libsleef is not used, so --with-libsleef is ignored]])\n+  if test \"x${NEEDS_LIB_SLEEF}\" = xfalse; then\n+    if (test \"x${with_libsleef}\" != x && test \"x${with_libsleef}\" != xno) || \\\n+       (test \"x${with_libsleef_include}\" != x && test \"x${with_libsleef_include}\" != xno) || \\\n+       (test \"x${with_libsleef_lib}\" != x && test \"x${with_libsleef_lib}\" != xno); then\n+      AC_MSG_WARN([libsleef is not used, so --with-libsleef[-*] is ignored])\n@@ -45,0 +52,10 @@\n+  elif test \"x${with_libsleef}\" = \"xno\" ||\n+       test \"x${with_libsleef_include}\" = \"xno\" ||\n+       test \"x${with_libsleef_lib}\" = \"xno\"; then\n+    AC_MSG_NOTICE([libsleef is disabled])\n+  elif test \"x${with_libsleef_lib}\" = \"xyes\" ||\n+       test \"x${with_libsleef_include}\" = \"xyes\"; then\n+    AC_MSG_ERROR([Must specify a value for --with-libsleef-*])\n+  elif (test \"x${with_libsleef_lib}\" != \"x\" && test \"x${with_libsleef_include}\" = \"x\") ||\n+       (test \"x${with_libsleef_include}\" != \"x\" && test \"x${with_libsleef_lib}\" = \"x\"); then\n+    AC_MSG_ERROR([--with-libsleef-lib and --with-libsleef-include should be specified together])\n@@ -48,17 +65,9 @@\n-    if test \"x${with_libsleef}\" = \"xno\"; then\n-      AC_MSG_NOTICE([libsleef is disabled])\n-    else\n-      if test \"x${with_libsleef}\" != \"x\" &&\n-         test \"x${with_libsleef}\" != \"xyes\"; then\n-        # Check the specified libsleef\n-        AC_MSG_CHECKING([for the specified LIBSLEEF])\n-        if test -e ${with_libsleef}\/lib\/libsleef.so &&\n-           test -e ${with_libsleef}\/include\/sleef.h; then\n-          LIBSLEEF_FOUND=yes\n-          LIBSLEEF_LIBS=\"-L${with_libsleef}\/lib -lsleef\"\n-          LIBSLEEF_CFLAGS=\"-I${with_libsleef}\/include\"\n-          AC_MSG_RESULT([yes])\n-        else\n-          AC_MSG_RESULT([no])\n-          AC_MSG_ERROR([Could not locate libsleef.so or sleef.h in ${with_libsleef}])\n-        fi\n+    # Check the specified libsleef\n+    if test \"x${with_libsleef}\" != \"x\" &&\n+       test \"x${with_libsleef}\" != \"xyes\"; then\n+      AC_MSG_CHECKING([for the specified LIBSLEEF])\n+      if test -e ${with_libsleef}\/lib\/libsleef.so &&\n+         test -e ${with_libsleef}\/include\/sleef.h; then\n+        LIBSLEEF_LIBS=\"-L${with_libsleef}\/lib -lsleef\"\n+        LIBSLEEF_CFLAGS=\"-I${with_libsleef}\/include\"\n+        AC_MSG_RESULT([yes])\n@@ -66,22 +75,2 @@\n-        # Check for the libsleef under system locations\n-        # Do not try pkg-config if we have a sysroot set.\n-        if test \"x$SYSROOT\" = \"x\" &&\n-           test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n-          PKG_CHECK_MODULES([LIBSLEEF], [sleef], [LIBSLEEF_FOUND=yes], [LIBSLEEF_FOUND=no])\n-        fi\n-        if test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n-          AC_CHECK_HEADERS([sleef.h],\n-              [\n-                LIBSLEEF_FOUND=yes\n-                LIBSLEEF_LIBS=\"-lsleef\"\n-              ],\n-              []\n-          )\n-        fi\n-\n-        # Print error if user runs just with \"--with-libsleef\", but libsleef is not installed\n-        if test \"x${with_libsleef}\" = \"xyes\" &&\n-           test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n-          HELP_MSG_MISSING_DEPENDENCY([sleef])\n-          AC_MSG_ERROR([Could not find libsleef! $HELP_MSG])\n-        fi\n+        AC_MSG_RESULT([no])\n+        AC_MSG_ERROR([Could not locate libsleef.so or sleef.h in ${with_libsleef}])\n@@ -89,3 +78,19 @@\n-\n-      if test \"x${LIBSLEEF_FOUND}\" = \"xyes\"; then\n-        ENABLE_LIBSLEEF=true\n+    fi\n+    if test \"x${with_libsleef_lib}\" != \"x\"; then\n+      AC_MSG_CHECKING([for the specified LIBSLEEF lib])\n+      if test -e ${with_libsleef_lib}\/libsleef.so; then\n+        LIBSLEEF_LIBS=\"-L${with_libsleef_lib} -lsleef\"\n+        AC_MSG_RESULT([yes])\n+      else\n+        AC_MSG_RESULT([no])\n+        AC_MSG_ERROR([Could not locate libsleef.so in ${with_libsleef_lib}])\n+      fi\n+    fi\n+    if test \"x${with_libsleef_include}\" != \"x\"; then\n+      AC_MSG_CHECKING([for the specified LIBSLEEF header])\n+      if test -e ${with_libsleef_include}\/sleef.h; then\n+        LIBSLEEF_CFLAGS=\"-I${with_libsleef_include}\"\n+        AC_MSG_RESULT([yes])\n+      else\n+        AC_MSG_RESULT([no])\n+        AC_MSG_ERROR([Could not locate sleef.h in ${with_libsleef_include}])\n@@ -93,0 +98,31 @@\n+    fi\n+\n+    # Check whether LIBSLEEF_CFLAGS and LIBSLEEF_LIBS are both set.\n+    # Set LIBSLEEF_FOUND to \"yes\" if both of them are set.\n+    if test \"x${LIBSLEEF_CFLAGS}\" != \"x\" &&\n+       test \"x${LIBSLEEF_LIBS}\" != \"x\"; then\n+      LIBSLEEF_FOUND=yes\n+    fi\n+\n+    # Check for the libsleef under system locations\n+    # Do not try pkg-config if we have a sysroot set.\n+    if test \"x$SYSROOT\" = \"x\" && test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n+      PKG_CHECK_MODULES([LIBSLEEF], [sleef], [LIBSLEEF_FOUND=yes], [LIBSLEEF_FOUND=no])\n+    fi\n+    if test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n+      AC_CHECK_HEADERS([sleef.h],\n+          [\n+            LIBSLEEF_FOUND=yes\n+            LIBSLEEF_LIBS=\"-lsleef\"\n+          ],\n+          []\n+      )\n+    fi\n+\n+    # Print error if user runs just with \"--with-libsleef\",\n+    # but libsleef is not installed.\n+    if test \"x${with_libsleef}\" = \"xyes\" &&\n+       test \"x${LIBSLEEF_FOUND}\" = \"xno\"; then\n+      HELP_MSG_MISSING_DEPENDENCY([sleef])\n+      AC_MSG_ERROR([Could not find libsleef! $HELP_MSG])\n+    fi\n@@ -94,0 +130,2 @@\n+    if test \"x${LIBSLEEF_FOUND}\" = \"xyes\"; then\n+      ENABLE_LIBSLEEF=true\n","filename":"make\/autoconf\/lib-sleef.m4","additions":84,"deletions":46,"binary":false,"changes":130,"status":"modified"}]}