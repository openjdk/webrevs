{"files":[{"patch":"@@ -467,1 +467,0 @@\n-                && (addModules.isEmpty() || allJrt(cf, addModules))\n@@ -516,12 +515,0 @@\n-    \/**\n-     * Returns true if all modules named in the given set are in the Configuration and\n-     * the run-time image.\n-     *\/\n-    private static boolean allJrt(Configuration cf, Set<String> moduleNames) {\n-        return !moduleNames.stream()\n-                .filter(mn -> !mn.equals(ALL_SYSTEM))\n-                .map(mn -> cf.findModule(mn).orElseThrow())\n-                .map(m -> m.reference().location().orElseThrow())\n-                .anyMatch(uri -> !uri.getScheme().equalsIgnoreCase(\"jrt\"));\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/module\/ModuleBootstrap.java","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -42,0 +42,2 @@\n+        final String allSystem = \"ALL-SYSTEM\";\n+        final String allModulePath = \"ALL-MODULE-PATH\";\n@@ -45,0 +47,1 @@\n+        final String warningIncubator = \"WARNING: Using incubator modules: jdk.incubator.vector\";\n@@ -184,0 +187,43 @@\n+\n+        \/\/ dump an archive with ALL-SYSTEM in -add-modules\n+        archiveName = TestCommon.getNewArchiveName(\"muti-modules\");\n+        TestCommon.setCurrentArchiveName(archiveName);\n+        oa = TestCommon.dumpBaseArchive(\n+            archiveName,\n+            loggingOption,\n+            \"--add-modules\", allSystem,\n+            \"-m\", moduleOption,\n+            \"-version\");\n+        oa.shouldHaveExitValue(0)\n+          .shouldContain(warningIncubator);\n+\n+        \/\/ run with the same ALL-SYSTEM in --add-modules\n+        oa = TestCommon.execCommon(\n+            loggingOption,\n+            \"--add-modules\", allSystem,\n+            \"-m\", moduleOption,\n+            \"-version\");\n+        oa.shouldHaveExitValue(0)\n+          \/\/ the jdk.incubator.vector was specified indirectly via ALL-SYSTEM\n+          .shouldContain(warningIncubator)\n+          .shouldContain(\"full module graph cannot be loaded: archive was created without full module graph\");\n+\n+        \/\/ dump an archive with ALL-MODULE-PATH in -add-modules\n+        archiveName = TestCommon.getNewArchiveName(\"muti-modules\");\n+        TestCommon.setCurrentArchiveName(archiveName);\n+        oa = TestCommon.dumpBaseArchive(\n+            archiveName,\n+            loggingOption,\n+            \"--add-modules\", allModulePath,\n+            \"-m\", moduleOption,\n+            \"-version\");\n+        oa.shouldHaveExitValue(0);\n+\n+        \/\/ run with the same ALL-MODULE-PATH in --add-modules\n+        oa = TestCommon.execCommon(\n+            loggingOption,\n+            \"--add-modules\", allModulePath,\n+            \"-m\", moduleOption,\n+            \"-version\");\n+        oa.shouldHaveExitValue(0)\n+          .shouldMatch(\"cds,module.*Restored from archive: entry.0x.*name jdk.httpserver\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/jigsaw\/addmods\/AddmodsOption.java","additions":46,"deletions":0,"binary":false,"changes":46,"status":"modified"}]}