{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -87,0 +87,3 @@\n+    float[] aF;\n+    float[] bF;\n+\n@@ -136,0 +139,5 @@\n+        testGroups.put(\"dotProductF\", new HashMap<String,TestFunction>());\n+        testGroups.get(\"dotProductF\").put(\"dotProductF_loop\",                           () -> { return dotProductF_loop(aF, bF); });\n+        testGroups.get(\"dotProductF\").put(\"dotProductF_VectorAPI_naive\",                () -> { return dotProductF_VectorAPI_naive(aF, bF); });\n+        testGroups.get(\"dotProductF\").put(\"dotProductF_VectorAPI_reduction_after_loop\", () -> { return dotProductF_VectorAPI_reduction_after_loop(aF, bF); });\n+\n@@ -177,0 +185,3 @@\n+                 \"dotProductF_loop\",\n+                 \"dotProductF_VectorAPI_naive\",\n+                 \"dotProductF_VectorAPI_reduction_after_loop\",\n@@ -220,0 +231,8 @@\n+            \/\/ float inputs. To avoid rounding issues, only use small integers.\n+            aF = new float[size];\n+            bF = new float[size];\n+            for (int i = 0; i < size; i++) {\n+                aF[i] = RANDOM.nextInt(32) - 16;\n+                bF[i] = RANDOM.nextInt(32) - 16;\n+            }\n+\n@@ -362,0 +381,31 @@\n+    @Test\n+    @IR(counts = {IRNode.LOAD_VECTOR_F,   \"> 0\",\n+                  IRNode.ADD_REDUCTION_V, \"> 0\",\n+                  IRNode.MUL_VF,          \"> 0\"},\n+        applyIfCPUFeature = {\"sse4.1\", \"true\"},\n+        applyIf = {\"UseSuperWord\", \"true\"})\n+    \/\/ See also TestReduction.floatAddDotProduct\n+    public float dotProductF_loop(float[] a, float[] b) {\n+        return VectorAlgorithmsImpl.dotProductF_loop(a, b);\n+    }\n+\n+    @Test\n+    @IR(counts = {IRNode.LOAD_VECTOR_F,   \"> 0\",\n+                  IRNode.ADD_REDUCTION_V, \"> 0\",\n+                  IRNode.MUL_VF,          \"> 0\"},\n+        applyIfCPUFeature = {\"sse4.1\", \"true\"},\n+        applyIf = {\"UseSuperWord\", \"true\"})\n+    public float dotProductF_VectorAPI_naive(float[] a, float[] b) {\n+        return VectorAlgorithmsImpl.dotProductF_VectorAPI_naive(a, b);\n+    }\n+\n+    @Test\n+    @IR(counts = {IRNode.LOAD_VECTOR_F,   \"> 0\",\n+                  IRNode.ADD_REDUCTION_V, \"> 0\",\n+                  IRNode.MUL_VF,          \"> 0\"},\n+        applyIfCPUFeature = {\"sse4.1\", \"true\"},\n+        applyIf = {\"UseSuperWord\", \"true\"})\n+    public float dotProductF_VectorAPI_reduction_after_loop(float[] a, float[] b) {\n+        return VectorAlgorithmsImpl.dotProductF_VectorAPI_reduction_after_loop(a, b);\n+    }\n+\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorization\/TestVectorAlgorithms.java","additions":51,"deletions":1,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- *  Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ *  Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,0 +37,1 @@\n+    private static final VectorSpecies<Float> SPECIES_F      = FloatVector.SPECIES_PREFERRED;\n@@ -164,0 +165,37 @@\n+    public static float dotProductF_loop(float[] a, float[] b) {\n+        float sum = 0;\n+        for (int i = 0; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n+    public static float dotProductF_VectorAPI_naive(float[] a, float[] b) {\n+        float sum = 0;\n+        int i;\n+        for (i = 0; i < SPECIES_F.loopBound(a.length); i += SPECIES_F.length()) {\n+            var va = FloatVector.fromArray(SPECIES_F, a, i);\n+            var vb = FloatVector.fromArray(SPECIES_F, b, i);\n+            sum += va.mul(vb).reduceLanes(VectorOperators.ADD);\n+        }\n+        for (; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n+    public static float dotProductF_VectorAPI_reduction_after_loop(float[] a, float[] b) {\n+        var sums = FloatVector.broadcast(SPECIES_F, 0.0f);\n+        int i;\n+        for (i = 0; i < SPECIES_F.loopBound(a.length); i += SPECIES_F.length()) {\n+            var va = FloatVector.fromArray(SPECIES_F, a, i);\n+            var vb = FloatVector.fromArray(SPECIES_F, b, i);\n+            sums = sums.add(va.mul(vb));\n+        }\n+        float sum = sums.reduceLanes(VectorOperators.ADD);\n+        for (; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorization\/VectorAlgorithmsImpl.java","additions":39,"deletions":1,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- *  Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ *  Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -76,0 +76,3 @@\n+    public static float[] aF;\n+    public static float[] bF;\n+\n@@ -87,0 +90,3 @@\n+\n+        aF = new float[SIZE];\n+        bF = new float[SIZE];\n@@ -107,0 +113,5 @@\n+\n+        for (int i = 0; i < aF.length; i++) {\n+            aF[i] = RANDOM.nextFloat();\n+            bF[i] = RANDOM.nextFloat();\n+        }\n@@ -183,0 +194,15 @@\n+    @Benchmark\n+    public float dotProductF_loop() {\n+        return VectorAlgorithmsImpl.dotProductF_loop(aF, bF);\n+    }\n+\n+    @Benchmark\n+    public float dotProductF_VectorAPI_naive() {\n+        return VectorAlgorithmsImpl.dotProductF_VectorAPI_naive(aF, bF);\n+    }\n+\n+    @Benchmark\n+    public float dotProductF_VectorAPI_reduction_after_loop() {\n+        return VectorAlgorithmsImpl.dotProductF_VectorAPI_reduction_after_loop(aF, bF);\n+    }\n+\n","filename":"test\/micro\/org\/openjdk\/bench\/vm\/compiler\/VectorAlgorithms.java","additions":27,"deletions":1,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- *  Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ *  Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,0 +37,1 @@\n+    private static final VectorSpecies<Float> SPECIES_F      = FloatVector.SPECIES_PREFERRED;\n@@ -181,0 +182,37 @@\n+    public static float dotProductF_loop(float[] a, float[] b) {\n+        float sum = 0;\n+        for (int i = 0; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n+    public static float dotProductF_VectorAPI_naive(float[] a, float[] b) {\n+        float sum = 0;\n+        int i;\n+        for (i = 0; i < SPECIES_F.loopBound(a.length); i += SPECIES_F.length()) {\n+            var va = FloatVector.fromArray(SPECIES_F, a, i);\n+            var vb = FloatVector.fromArray(SPECIES_F, b, i);\n+            sum += va.mul(vb).reduceLanes(VectorOperators.ADD);\n+        }\n+        for (; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n+    public static float dotProductF_VectorAPI_reduction_after_loop(float[] a, float[] b) {\n+        var sums = FloatVector.broadcast(SPECIES_F, 0.0f);\n+        int i;\n+        for (i = 0; i < SPECIES_F.loopBound(a.length); i += SPECIES_F.length()) {\n+            var va = FloatVector.fromArray(SPECIES_F, a, i);\n+            var vb = FloatVector.fromArray(SPECIES_F, b, i);\n+            sums = sums.add(va.mul(vb));\n+        }\n+        float sum = sums.reduceLanes(VectorOperators.ADD);\n+        for (; i < a.length; i++) {\n+            sum += a[i] * b[i];\n+        }\n+        return sum;\n+    }\n+\n","filename":"test\/micro\/org\/openjdk\/bench\/vm\/compiler\/VectorAlgorithmsImpl.java","additions":39,"deletions":1,"binary":false,"changes":40,"status":"modified"}]}