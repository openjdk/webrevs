{"files":[{"patch":"@@ -95,0 +95,1 @@\n+import static jdk.internal.util.ModifiedUtf.utfLen;\n@@ -4160,1 +4161,7 @@\n-        return getUtf8Length(name) <= JAVA_CLASSNAME_MAX_LEN;\n+        \/\/ Quick approximation: each char can be at most 3 bytes in Modified UTF-8.\n+        \/\/ If the string is short enough, it definitely fits.\n+        if (name.length() * 3 <= JAVA_CLASSNAME_MAX_LEN) {\n+            return true;\n+        }\n+        \/\/ Compute exact Modified UTF-8 length.\n+        return utfLen(name, 0) <= JAVA_CLASSNAME_MAX_LEN;\n@@ -4171,14 +4178,0 @@\n-    \/\/ Calculates the length of string encoded in Modified UTF-8.\n-    private static int getUtf8Length(String str) {\n-        int slen = str.length();\n-        int extra = 0;\n-        for (int i = 0; i < slen; i++) {\n-            int ch = string.charAt(i);\n-            if (ch > 0x007f || ch == 0x0000) {\n-                extra++;\n-                if (ch > 0x07ff)\n-                    extra++;\n-            }\n-        }\n-        return slen + extra;\n-    }\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Class.java","additions":8,"deletions":15,"binary":false,"changes":23,"status":"modified"}]}