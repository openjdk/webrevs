{"files":[{"patch":"@@ -4163,1 +4163,2 @@\n-        if (name.length() * 3 <= JAVA_CLASSNAME_MAX_LEN) {\n+        int nameLen = name.length();\n+        if (nameLen <= JAVA_CLASSNAME_MAX_LEN \/ 3) {\n@@ -4166,2 +4167,4 @@\n-        \/\/ Compute exact Modified UTF-8 length.\n-        return ModifiedUtf.utfLen(name, 0) <= JAVA_CLASSNAME_MAX_LEN;\n+        \/\/ Check exact Modified UTF-8 length.\n+        \/\/ The check utfLen >= nameLen ensures we don't incorrectly return true in case of int overflow.\n+        int utfLen = ModifiedUtf.utfLen(name, 0);\n+        return utfLen <= JAVA_CLASSNAME_MAX_LEN && utfLen >= nameLen;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Class.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"}]}