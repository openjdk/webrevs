{"files":[{"patch":"@@ -259,0 +259,1 @@\n+    assert(!region->is_active_alloc_region(), \"Must not\");\n@@ -340,0 +341,3 @@\n+          \/\/ Enforce order here,\n+          \/\/ allocate_in must be executed before set the region to active alloc region.\n+          OrderAccess::fence();\n@@ -342,0 +346,1 @@\n+        OrderAccess::fence();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAllocator.cpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -465,0 +465,1 @@\n+  template<bool CHECK_ATOMIC_TOP = true>\n@@ -466,2 +467,5 @@\n-    HeapWord* v_top = atomic_top();\n-    return v_top == nullptr ? AtomicAccess::load(&_top) : v_top;\n+    if (CHECK_ATOMIC_TOP) {\n+      HeapWord* v_top = atomic_top();\n+      return v_top == nullptr ? AtomicAccess::load(&_top) : v_top;\n+    }\n+    return AtomicAccess::load(&_top);\n@@ -469,0 +473,1 @@\n+\n@@ -561,1 +566,1 @@\n-    AtomicAccess::store(&_atomic_top, _top);\n+    AtomicAccess::store(&_atomic_top, top<false>());\n@@ -580,0 +585,1 @@\n+      OrderAccess::fence();\n@@ -585,1 +591,1 @@\n-    assert(_top == previous_atomic_top, \"Must be\");\n+    assert(top<false>() == previous_atomic_top, \"Must be\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.hpp","additions":10,"deletions":4,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -110,0 +110,1 @@\n+  assert(!is_active_alloc_region(), \"Must not\");\n@@ -112,1 +113,1 @@\n-  HeapWord* obj = top();\n+  HeapWord* obj = top<false>();\n@@ -136,1 +137,1 @@\n-  HeapWord* old_top = top();\n+  HeapWord* old_top = top<false>();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.inline.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}