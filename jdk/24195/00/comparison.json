{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,1 +37,0 @@\n-import org.openjdk.jmh.annotations.TearDown;\n@@ -53,1 +52,1 @@\n-@State(Scope.Benchmark)\n+@State(Scope.Thread)\n@@ -59,1 +58,5 @@\n-    private SSLContext sslc;\n+    \/\/ one global server context\n+    private static final SSLContext sslServerCtx = getServerContext();\n+\n+    \/\/ per-thread client contexts\n+    private SSLContext sslClientCtx;\n@@ -78,0 +81,16 @@\n+    private static SSLContext getServerContext() {\n+        try {\n+            KeyStore ks = TestCertificates.getKeyStore();\n+\n+            KeyManagerFactory kmf = KeyManagerFactory.getInstance(\n+                    KeyManagerFactory.getDefaultAlgorithm());\n+            kmf.init(ks, new char[0]);\n+\n+            SSLContext sslCtx = SSLContext.getInstance(\"TLS\");\n+            sslCtx.init(kmf.getKeyManagers(), null, null);\n+            return sslCtx;\n+        } catch (Exception e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+\n@@ -80,1 +99,0 @@\n-        KeyStore ks = TestCertificates.getKeyStore();\n@@ -83,4 +101,0 @@\n-        KeyManagerFactory kmf = KeyManagerFactory.getInstance(\n-                KeyManagerFactory.getDefaultAlgorithm());\n-        kmf.init(ks, new char[0]);\n-\n@@ -92,2 +106,2 @@\n-        sslCtx.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null);\n-        sslc = sslCtx;\n+        sslCtx.init(null, tmf.getTrustManagers(), null);\n+        sslClientCtx = sslCtx;\n@@ -176,1 +190,1 @@\n-        serverEngine = sslc.createSSLEngine();\n+        serverEngine = sslServerCtx.createSSLEngine();\n@@ -182,1 +196,1 @@\n-        clientEngine = sslc.createSSLEngine(\"client\", 80);\n+        clientEngine = sslClientCtx.createSSLEngine(\"client\", 80);\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/security\/SSLHandshake.java","additions":27,"deletions":13,"binary":false,"changes":40,"status":"modified"}]}