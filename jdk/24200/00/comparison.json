{"files":[{"patch":"@@ -2256,0 +2256,10 @@\n+  if (obj->is_array()) {\n+    \/\/ Disallow reading after the last element of an array\n+    size_t array_length = arrayOop(obj())->length();\n+    int lh = obj->klass()->layout_helper();\n+    size_t size_in_bytes = array_length << Klass::layout_helper_log2_element_size(lh);\n+    size_in_bytes += Klass::layout_helper_header_size(lh);\n+    if ((size_t) displacement + basic_type_elemsize > size_in_bytes) {\n+      JVMCI_THROW_MSG_NULL(IllegalArgumentException, \"reading after last array element\");\n+    }\n+  }\n@@ -2261,3 +2271,0 @@\n-      if (displacement + heapOopSize > arrayOopDesc::base_offset_in_bytes(T_OBJECT) + arrayOop(obj())->length() * heapOopSize) {\n-        JVMCI_THROW_MSG_NULL(IllegalArgumentException, \"reading after last array element\");\n-      }\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompilerToVM.cpp","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"}]}