{"files":[{"patch":"@@ -92,3 +92,1 @@\n-            synchronized (certCache) {\n-                certCache.clear();\n-            }\n+            certCache.clear();\n@@ -120,1 +118,1 @@\n-        return addToCache(certCache, enc, newCert);\n+        return addIfNotPresent(certCache, enc, newCert);\n@@ -181,3 +179,10 @@\n-        X509CertImpl newC = isImpl ? (X509CertImpl) c : new X509CertImpl(encoding);\n-        byte[] enc = isImpl ? encoding : newC.getEncodedInternal();\n-        return addToCache(certCache, enc, newC);\n+        X509CertImpl newC;\n+        byte[] enc;\n+        if (isImpl) {\n+            newC = (X509CertImpl) c;\n+            enc = encoding;\n+        } else {\n+            newC = new X509CertImpl(encoding);\n+            enc = newC.getEncodedInternal();\n+        }\n+        return addIfNotPresent(certCache, enc, newC);\n@@ -213,3 +218,10 @@\n-        X509CRLImpl newC = isImpl ? (X509CRLImpl) c : new X509CRLImpl(encoding);\n-        byte[] enc = isImpl ? encoding : newC.getEncodedInternal();\n-        return addToCache(crlCache, enc, newC);\n+        X509CRLImpl newC;\n+        byte[] enc;\n+        if (isImpl) {\n+            newC = (X509CRLImpl) c;\n+            enc = encoding;\n+        } else {\n+            newC = new X509CRLImpl(encoding);\n+            enc = newC.getEncodedInternal();\n+        }\n+        return addIfNotPresent(crlCache, enc, newC);\n@@ -230,1 +242,1 @@\n-    private static <V> V addToCache(Cache<Object, V> cache, byte[] encoding, V value) {\n+    private static <V> V addIfNotPresent(Cache<Object, V> cache, byte[] encoding, V value) {\n@@ -245,1 +257,0 @@\n-\n@@ -390,3 +401,1 @@\n-            synchronized (crlCache) {\n-                crlCache.clear();\n-            }\n+            crlCache.clear();\n@@ -405,1 +414,1 @@\n-                return addToCache(crlCache, enc, crl);\n+                return addIfNotPresent(crlCache, enc, crl);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/X509Factory.java","additions":25,"deletions":16,"binary":false,"changes":41,"status":"modified"}]}