{"files":[{"patch":"@@ -5962,3 +5962,25 @@\n-  \/\/ preserve the sign bit and exponent.\n-  srai(tmp2, dst, 26);\n-  slli(tmp2, tmp2, 10);\n+  \/\/  Float (32 bits)\n+  \/\/    Bit:     31        30 to 23          22 to 0\n+  \/\/          +---+------------------+-----------------------------+\n+  \/\/          | S |     Exponent     |      Mantissa (Fraction)    |\n+  \/\/          +---+------------------+-----------------------------+\n+  \/\/          1 bit       8 bits                  23 bits\n+  \/\/\n+  \/\/  Float (16 bits)\n+  \/\/    Bit:    15        14 to 10         9 to 0\n+  \/\/          +---+----------------+------------------+\n+  \/\/          | S |    Exponent    |     Mantissa     |\n+  \/\/          +---+----------------+------------------+\n+  \/\/          1 bit      5 bits          10 bits\n+  const int fp_sign_bits = 1;\n+  const int fp32_bits = 32;\n+  const int fp32_exponent_bits = 8;\n+  const int fp32_mantissa_1st_part_bits = 10;\n+  const int fp32_mantissa_2nd_part_bits = 9;\n+  const int fp32_mantissa_3rd_part_bits = 4;\n+  const int fp16_exponent_bits = 5;\n+  const int fp16_mantissa_bits = 10;\n+\n+  \/\/ preserve the sign bit and exponent, clear mantissa.\n+  srai(tmp2, dst, fp32_bits - fp_sign_bits - fp16_exponent_bits);\n+  slli(tmp2, tmp2, fp16_mantissa_bits);\n@@ -5969,0 +5991,3 @@\n+  \/\/   | (doppel & 0x007f_e000) >> 13 \/\/ 10 bits\n+  \/\/   | (doppel & 0x0000_1ff0) >> 4  \/\/  9 bits\n+  \/\/   | (doppel & 0x0000_000f));     \/\/  4 bits\n@@ -5972,2 +5997,4 @@\n-  slli(tmp1, dst, 9+32);\n-  srli(tmp1, tmp1, 9+32+13);\n+  int left_shift = fp_sign_bits + fp32_exponent_bits + 32;\n+  int right_shift = left_shift + fp32_mantissa_2nd_part_bits + fp32_mantissa_3rd_part_bits;\n+  slli(tmp1, dst, left_shift);\n+  srli(tmp1, tmp1, right_shift);\n@@ -5976,2 +6003,4 @@\n-  slli(tmp1, dst, 19+32);\n-  srli(tmp1, tmp1, 19+32+4);\n+  left_shift += fp32_mantissa_1st_part_bits;\n+  right_shift = left_shift + fp32_mantissa_3rd_part_bits;\n+  slli(tmp1, dst, left_shift);\n+  srli(tmp1, tmp1, right_shift);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":36,"deletions":7,"binary":false,"changes":43,"status":"modified"}]}