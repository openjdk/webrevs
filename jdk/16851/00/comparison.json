{"files":[{"patch":"@@ -271,0 +271,3 @@\n+    \/\/ Restore cpu control state after JNI call\n+    __ restore_cpu_control_state_after_jni(rscratch1, tmp1);\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/downcallLinker_aarch64.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -4431,0 +4431,16 @@\n+void MacroAssembler::restore_cpu_control_state_after_jni(Register tmp1, Register tmp2) {\n+  if (RestoreMXCSROnJNICalls) {\n+    Label OK;\n+    get_fpcr(tmp1);\n+    mov(tmp2, tmp1);\n+    \/\/ Set FPCR to the state we need. We do want Round to Nearest. We\n+    \/\/ don't want non-IEEE rounding modes or floating-point traps.\n+    bfi(tmp1, zr, 22, 4); \/\/ Clear DN, FZ, and Rmode\n+    bfi(tmp1, zr, 8, 5);  \/\/ Clear exception-control bits (8-12)\n+    eor(tmp1, tmp1, tmp2);\n+    cbz(tmp1, OK);        \/\/ Only reset FPCR if it's wrong\n+    set_fpcr(tmp1);\n+    bind(OK);\n+  }\n+}\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1050,2 +1050,2 @@\n-  \/\/ only if +VerifyFPU\n-  void verify_FPU(int stack_depth, const char* s = \"illegal FPU state\");\n+  \/\/ Restore cpu control state after JNI call\n+  void restore_cpu_control_state_after_jni(Register tmp1, Register tmp2);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1838,0 +1838,3 @@\n+  \/\/ Verify or restore cpu control state after JNI call\n+  __ restore_cpu_control_state_after_jni(rscratch1, rscratch2);\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/sharedRuntime_aarch64.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1386,0 +1386,3 @@\n+  \/\/ Restore cpu control state after JNI call\n+  __ restore_cpu_control_state_after_jni(rscratch1, rscratch2);\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/templateInterpreterGenerator_aarch64.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}