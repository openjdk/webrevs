{"files":[{"patch":"@@ -55,0 +55,3 @@\n+    static double min_stack_usage_with_pretouch = 1 * MB;\n+    static double max_stack_usage_with_pretouch = 0.75 * threadStackSizeMB * MB;\n+\n@@ -72,0 +75,3 @@\n+        \/\/ Let test threads run as daemons to ensure that they are still running and\n+        \/\/ that their stacks are still allocated when the JVM shuts down and the final\n+        \/\/ NMT report is printed.\n@@ -180,3 +186,1 @@\n-          double estimated_stack_usage = 1 * MB;\n-          double expected_stack_use_with_pretouch = 0.75 * threadStackSizeMB * MB;\n-          if (ratio_with > expected_stack_use_with_pretouch) {\n+          if (ratio_with > max_stack_usage_with_pretouch) {\n@@ -185,3 +189,5 @@\n-          double expected_delta = numThreads * (expected_stack_use_with_pretouch - estimated_stack_usage);\n-          if ((pretouch_result.committed - no_pretouch_result.committed) < expected_delta) {\n-            throw new RuntimeException(\"Expected a higher delta between stack committed of with and without pretouch.\");\n+          double expected_delta = numThreads * (max_stack_usage_with_pretouch - min_stack_usage_with_pretouch);\n+          double actual_delta = pretouch_result.committed - no_pretouch_result.committed;\n+          if (actual_delta < expected_delta) {\n+            throw new RuntimeException(\"Expected a higher delta between stack committed of with and without pretouch.\" +\n+                                       \"Expected: \" + expected_delta + \" Acvtual: \" + actual_delta);\n","filename":"test\/hotspot\/jtreg\/runtime\/Thread\/TestAlwaysPreTouchStacks.java","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"}]}