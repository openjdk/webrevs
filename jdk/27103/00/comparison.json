{"files":[{"patch":"@@ -260,0 +260,1 @@\n+    WORKING_DIR := $(WORKSPACE_ROOT), \\\n","filename":"make\/CreateJmods.gmk","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -84,2 +84,2 @@\n-    COMMAND := cd $(SLEEF_SOURCE_DIR) && $(CMAKE) -S . -B \\\n-        $(SLEEF_NATIVE_BUILD_DIR), \\\n+    WORKING_DIR := $(SLEEF_SOURCE_DIR), \\\n+    COMMAND := $(CMAKE) -S . -B $(SLEEF_NATIVE_BUILD_DIR), \\\n@@ -94,2 +94,2 @@\n-    COMMAND := cd $(SLEEF_SOURCE_DIR) && $(CMAKE) --build \\\n-        $(SLEEF_NATIVE_BUILD_DIR) -j, \\\n+    WORKING_DIR := $(SLEEF_SOURCE_DIR), \\\n+    COMMAND := $(CMAKE) --build $(SLEEF_NATIVE_BUILD_DIR) -j, \\\n@@ -104,2 +104,2 @@\n-    COMMAND := cd $(SLEEF_SOURCE_DIR) && $(CMAKE) -S . -B \\\n-        $(SLEEF_CROSS_BUILD_DIR) \\\n+    WORKING_DIR := $(SLEEF_SOURCE_DIR), \\\n+    COMMAND := $(CMAKE) -S . -B $(SLEEF_CROSS_BUILD_DIR) \\\n@@ -119,2 +119,2 @@\n-    COMMAND := cd $(SLEEF_SOURCE_DIR) && $(CMAKE) --build \\\n-        $(SLEEF_CROSS_BUILD_DIR) -j, \\\n+    WORKING_DIR := $(SLEEF_SOURCE_DIR), \\\n+    COMMAND := $(CMAKE) --build $(SLEEF_CROSS_BUILD_DIR) -j, \\\n","filename":"make\/UpdateSleefSource.gmk","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -48,0 +48,3 @@\n+# Before execution, the current working directory is changed to SUPPORT_DIR.\n+# This can be overridden with WORKING_DIR.\n+#\n@@ -78,0 +81,1 @@\n+#   WORKING_DIR : Directory to cd to before executing the command\n@@ -136,0 +140,4 @@\n+  ifeq ($$($1_WORKING_DIR), )\n+    $1_WORKING_DIR := $$($1_SUPPORT_DIR)\n+  endif\n+\n@@ -150,1 +158,1 @@\n-\t$$(call MakeDir, $$($1_SUPPORT_DIR) $$($1_OUTPUT_DIR))\n+\t$$(call MakeDir, $$(call EncodeSpace, $$($1_WORKING_DIR)) $$(call EncodeSpace, $$($1_SUPPORT_DIR)) $$(call EncodeSpace, $$($1_OUTPUT_DIR)))\n@@ -152,1 +160,1 @@\n-\t    $$($1_PRE_COMMAND))\n+\t    cd $$($1_WORKING_DIR) && $$($1_PRE_COMMAND))\n@@ -157,1 +165,1 @@\n-\t    $$($1_COMMAND))\n+\t    cd $$($1_WORKING_DIR) && $$($1_COMMAND))\n@@ -171,1 +179,1 @@\n-\t$$(call MakeDir, $$(call EncodeSpace, $$($1_SUPPORT_DIR)) $$(call EncodeSpace, $$($1_OUTPUT_DIR)))\n+\t$$(call MakeDir, $$(call EncodeSpace, $$($1_WORKING_DIR)) $$(call EncodeSpace, $$($1_SUPPORT_DIR)) $$(call EncodeSpace, $$($1_OUTPUT_DIR)))\n@@ -173,1 +181,1 @@\n-\t    $$($1_COMMAND))\n+\t    cd $$($1_WORKING_DIR) && $$($1_COMMAND))\n@@ -185,1 +193,1 @@\n-\t    $$($1_POST_COMMAND))\n+\t    cd $$($1_WORKING_DIR) && $$($1_POST_COMMAND))\n","filename":"make\/common\/Execute.gmk","additions":14,"deletions":6,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -0,0 +1,74 @@\n+#\n+# Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+include MakeFileStart.gmk\n+\n+################################################################################\n+\n+include Execute.gmk\n+include UtilsForTests.gmk\n+\n+THIS_FILE := $(TOPDIR)\/test\/make\/TestExecute.gmk\n+DEPS := $(THIS_FILE) \\\n+    $(TOPDIR)\/make\/common\/MakeBase.gmk \\\n+    #\n+\n+OUTPUT_DIR := $(TESTMAKE_OUTPUTDIR)\/execute\n+$(call MakeDir, $(OUTPUT_DIR))\n+\n+################################################################################\n+# Test SetupExecute\n+\n+$(eval $(call SetupExecute, EXEC_1, \\\n+    INFO := Testing that SetupExecute runs from SUPPORT_DIR, \\\n+    OUTPUT_DIR := $(OUTPUT_DIR)\/exec_1, \\\n+    SUPPORT_DIR := $(OUTPUT_DIR)\/exec_1\/support, \\\n+    COMMAND := $(ECHO) \"Generating junk file\" > .\/junkfile, \\\n+))\n+\n+run-test1: $(EXEC_1)\n+\ttest -f $(OUTPUT_DIR)\/exec_1\/support\/junkfile\n+\n+$(eval $(call SetupExecute, EXEC_2, \\\n+    INFO := Testing that SetupExecute runs from SUPPORT_DIR, \\\n+    OUTPUT_DIR := $(OUTPUT_DIR)\/exec_2, \\\n+    SUPPORT_DIR := $(OUTPUT_DIR)\/exec_2\/support, \\\n+    WORKING_DIR := $(OUTPUT_DIR)\/exec_2\/special, \\\n+    COMMAND := $(ECHO) \"Generating special file\" > .\/specialfile, \\\n+))\n+\n+run-test2: $(EXEC_2)\n+\ttest -f $(OUTPUT_DIR)\/exec_2\/special\/specialfile\n+\n+\n+TEST_TARGETS += run-test1 run-test2\n+\n+.PHONY: run-test1 run-test2\n+\n+################################################################################\n+\n+all: $(TEST_TARGETS)\n+\n+################################################################################\n+\n+include MakeFileEnd.gmk\n","filename":"test\/make\/TestExecute.gmk","additions":74,"deletions":0,"binary":false,"changes":74,"status":"added"},{"patch":"@@ -37,0 +37,3 @@\n+execute:\n+\t+$(MAKE) -f TestExecute.gmk $(TEST_SUBTARGET)\n+\n@@ -50,1 +53,1 @@\n-TARGETS += make-base java-compilation copy-files fix-deps-file idea \\\n+TARGETS += make-base java-compilation copy-files execute fix-deps-file idea \\\n","filename":"test\/make\/TestMake.gmk","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"}]}