{"files":[{"patch":"@@ -167,1 +167,1 @@\n-  blob->purge();\n+  blob->purge(true \/* free_code_cache_data *\/, true \/* unregister_nmethod *\/);\n@@ -176,1 +176,1 @@\n-void CodeBlob::purge(bool free_code_cache_data, bool unregister_nmethods) {\n+void CodeBlob::purge(bool free_code_cache_data, bool unregister_nmethod) {\n","filename":"src\/hotspot\/share\/code\/codeBlob.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -146,1 +146,1 @@\n-  virtual void purge(bool free_code_cache_data = true, bool unregister_nmethods = true);\n+  virtual void purge(bool free_code_cache_data, bool unregister_nmethod);\n","filename":"src\/hotspot\/share\/code\/codeBlob.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -177,1 +177,1 @@\n-  virtual void purge(bool free_code_cache_data = true, bool unregister_nmethods = true) = 0;\n+  virtual void purge(bool free_code_cache_data, bool unregister_nmethod) = 0;\n","filename":"src\/hotspot\/share\/code\/compiledMethod.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1447,1 +1447,1 @@\n-void nmethod::purge(bool free_code_cache_data, bool unregister_nmethods) {\n+void nmethod::purge(bool free_code_cache_data, bool unregister_nmethod) {\n@@ -1467,1 +1467,1 @@\n-  if (unregister_nmethods) {\n+  if (unregister_nmethod) {\n@@ -1473,1 +1473,1 @@\n-  CodeBlob::purge();\n+  CodeBlob::purge(free_code_cache_data, unregister_nmethod);\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -525,1 +525,1 @@\n-  void purge(bool free_code_cache_data = true, bool unregister_nmethods = true);\n+  void purge(bool free_code_cache_data, bool unregister_nmethod);\n","filename":"src\/hotspot\/share\/code\/nmethod.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1791,1 +1791,1 @@\n-    blob->purge();\n+    blob->purge(true \/* free_code_cache_data *\/, true \/* unregister_nmethod *\/);\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2492,0 +2492,1 @@\n+                            false \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1772,0 +1772,1 @@\n+                              false \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -35,1 +35,3 @@\n-ClassUnloadingContext::ClassUnloadingContext(uint num_workers, bool lock_codeblob_free_separately) :\n+ClassUnloadingContext::ClassUnloadingContext(uint num_workers,\n+                                             bool unregister_nmethods_during_purge,\n+                                             bool lock_codeblob_free_separately) :\n@@ -39,0 +41,1 @@\n+  _unregister_nmethods_during_purge(unregister_nmethods_during_purge),\n@@ -116,1 +119,1 @@\n-      nm->purge(false \/* free_code_cache_data *\/);\n+      nm->purge(false \/* free_code_cache_data *\/, _unregister_nmethods_during_purge);\n","filename":"src\/hotspot\/share\/gc\/shared\/classUnloadingContext.cpp","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+  bool _unregister_nmethods_during_purge;\n@@ -52,0 +53,3 @@\n+  \/\/ unregister_nmethods_during_purge determines whether unloaded nmethods should\n+  \/\/     be unregistered from the garbage collector during purge. If not, ,the caller\n+  \/\/     is responsible to do that later.\n@@ -56,0 +60,1 @@\n+                        bool unregister_nmethods_during_purge,\n","filename":"src\/hotspot\/share\/gc\/shared\/classUnloadingContext.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -527,0 +527,1 @@\n+                              false \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1825,0 +1825,1 @@\n+                            true \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -143,0 +143,1 @@\n+                            true \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahUnload.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -325,0 +325,1 @@\n+                            true \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/x\/xHeap.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1321,0 +1321,1 @@\n+                            true \/* unregister_nmethods_during_purge *\/,\n","filename":"src\/hotspot\/share\/gc\/z\/zGeneration.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}