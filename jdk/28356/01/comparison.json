{"files":[{"patch":"@@ -45,27 +45,27 @@\n-        \/\/ the BASE64 string between -----BEGIN RSA PRIVATE KEY-----\n-        \/\/ and -----END RSA PRIVATE KEY-----\n-        \"MIIEowIBAAKCAQEA0OIArlYES4X1XMTLDordtN\/XIWFE1wvhl40RsHWM2n99+Stp\" +\n-        \"CCJCcUb5FJ2\/kefj\/XRwB6p5IMpIZrHZqC8XXzlX5fpiFaSu2xnk17oWUKoErW27\" +\n-        \"Stm098pU2RoUxWPKVl+42a8iVp8tijNElBNFALCGi0zXOhcTxMh0q1Wk0UhMJqam\" +\n-        \"v5YnCKmT4THwwGYn\/KeK3M7Qa+o5MoVBHLbeT9LJgEmSluVzIh44Lh6weX0bw72P\" +\n-        \"8X2praOhbzg2B343MqS\/rMLw6On+0i7ccEgp23vX9G5w85q4A5FSIrk4S\/pyv5sO\" +\n-        \"rwjCQKBW1TS0\/2iB9zNkFMj5\/+h7l2oqTT7sSQIDAQABAoIBADn6sXOynoiUC1IP\" +\n-        \"sck8lGOTSjSSujfyrVCSsJlJV6qCfuX9va6rS8QDjjnBu531PtxoSHxoPizy2Pvg\" +\n-        \"W+kKATPGR\/am9DjLuFlKq7GRjoYfWyMEdVtGaKvq9ng4fBF6LHyjHz0VFrPyhQJ6\" +\n-        \"TovHeXzCguYBkzAlnbAeb\/vqzs\/kABbOuSHVi7DsaixCoEX9zOptFYQw\/l8rh68+\" +\n-        \"UF2bpNNH3jOC1uN3vZtuSwCupqtN+2Mpkx2h04Rk75vWIhrnPeMgmcd3yP4LNZMR\" +\n-        \"mfaynb63RRzVkNis7+NVk016SQ1oL79mrBvy5rBg3HeCeArwvqZAmOaWsLSWHzCy\" +\n-        \"zlVlMTECgYEA6JlnMpC956Qi8HX5ye4Hu2ovBdbNGtH\/TMkZmColJz9P7CvNkNIb\" +\n-        \"Od6mvLMydbPHkhdBUDWD4rhiCKHrf5zKju1i24YqWcvuSGotWj4\/KQ3+87mLZM+7\" +\n-        \"daBsJBmSEVB80sgA9ItqSgOyNoNFpiDgFnlszAfb0n9XXEzB\/pwSw1UCgYEA5eXI\" +\n-        \"d+eKugugP+n6CluQfyxfN6WWCzfqWToCTTxPn2i12AiEssXy+kyLjupJVLWSivdo\" +\n-        \"83wD5LuxFRGc9P+aKQERPhb0AFaxf1llUCXla65\/x2So5xjMvtuzgQ0OktPJqJXq\" +\n-        \"hYGunctsr5rje33+7vlx4xWkrL2PrQWzJabn7SUCgYEAqw3FesY\/Ik7u8u+P1xSZ\" +\n-        \"0xXvptek1oiAu7NYgzLbR9WjrQc5kbsyEojPDg6qmSyxI5q+iYIRj3YRgk+xpJNl\" +\n-        \"0154SQCNvKPghJiw6aDFSifkytA01tp9\/a8QWCwF433RjiFPsoekjvHQ6Y34dofO\" +\n-        \"xDhf7lwJKPBFCrfYIqocklECgYAIPI9OHHGP8NKw94UJ0fX\/WGug5sHVbQ9sWvOy\" +\n-        \"KLMBlxLMxqFadlUaOpvVZvdxnX++ktajwpGxJDhX9OWWsYGobm1buB7N1E1Prrg+\" +\n-        \"gt0RWpMhZa3Xeb\/8Jorr2Lfo8sWK0LQyTE8hQCSIthfoWL9FeJJn\/GKF\/dSj8kxU\" +\n-        \"0QIGMQKBgG\/8U\/zZ87DzfXS81P1p+CmH474wmou4KD2\/zXp\/lDR9+dlIUeijlIbU\" +\n-        \"P6Y5xJvT33Y40giW9irShgDHjZgw0ap11K3b2HzLImdPEaBiENo735rpLs8WLK9H\" +\n-        \"+yeRbiP2y9To7sTihm9Jrkctzp6sqFtKyye1+S21X1tMz8NGfXen\";\n+            \/\/ the BASE64 string between -----BEGIN RSA PRIVATE KEY-----\n+            \/\/ and -----END RSA PRIVATE KEY-----\n+            \"MIIEowIBAAKCAQEA0OIArlYES4X1XMTLDordtN\/XIWFE1wvhl40RsHWM2n99+Stp\" +\n+            \"CCJCcUb5FJ2\/kefj\/XRwB6p5IMpIZrHZqC8XXzlX5fpiFaSu2xnk17oWUKoErW27\" +\n+            \"Stm098pU2RoUxWPKVl+42a8iVp8tijNElBNFALCGi0zXOhcTxMh0q1Wk0UhMJqam\" +\n+            \"v5YnCKmT4THwwGYn\/KeK3M7Qa+o5MoVBHLbeT9LJgEmSluVzIh44Lh6weX0bw72P\" +\n+            \"8X2praOhbzg2B343MqS\/rMLw6On+0i7ccEgp23vX9G5w85q4A5FSIrk4S\/pyv5sO\" +\n+            \"rwjCQKBW1TS0\/2iB9zNkFMj5\/+h7l2oqTT7sSQIDAQABAoIBADn6sXOynoiUC1IP\" +\n+            \"sck8lGOTSjSSujfyrVCSsJlJV6qCfuX9va6rS8QDjjnBu531PtxoSHxoPizy2Pvg\" +\n+            \"W+kKATPGR\/am9DjLuFlKq7GRjoYfWyMEdVtGaKvq9ng4fBF6LHyjHz0VFrPyhQJ6\" +\n+            \"TovHeXzCguYBkzAlnbAeb\/vqzs\/kABbOuSHVi7DsaixCoEX9zOptFYQw\/l8rh68+\" +\n+            \"UF2bpNNH3jOC1uN3vZtuSwCupqtN+2Mpkx2h04Rk75vWIhrnPeMgmcd3yP4LNZMR\" +\n+            \"mfaynb63RRzVkNis7+NVk016SQ1oL79mrBvy5rBg3HeCeArwvqZAmOaWsLSWHzCy\" +\n+            \"zlVlMTECgYEA6JlnMpC956Qi8HX5ye4Hu2ovBdbNGtH\/TMkZmColJz9P7CvNkNIb\" +\n+            \"Od6mvLMydbPHkhdBUDWD4rhiCKHrf5zKju1i24YqWcvuSGotWj4\/KQ3+87mLZM+7\" +\n+            \"daBsJBmSEVB80sgA9ItqSgOyNoNFpiDgFnlszAfb0n9XXEzB\/pwSw1UCgYEA5eXI\" +\n+            \"d+eKugugP+n6CluQfyxfN6WWCzfqWToCTTxPn2i12AiEssXy+kyLjupJVLWSivdo\" +\n+            \"83wD5LuxFRGc9P+aKQERPhb0AFaxf1llUCXla65\/x2So5xjMvtuzgQ0OktPJqJXq\" +\n+            \"hYGunctsr5rje33+7vlx4xWkrL2PrQWzJabn7SUCgYEAqw3FesY\/Ik7u8u+P1xSZ\" +\n+            \"0xXvptek1oiAu7NYgzLbR9WjrQc5kbsyEojPDg6qmSyxI5q+iYIRj3YRgk+xpJNl\" +\n+            \"0154SQCNvKPghJiw6aDFSifkytA01tp9\/a8QWCwF433RjiFPsoekjvHQ6Y34dofO\" +\n+            \"xDhf7lwJKPBFCrfYIqocklECgYAIPI9OHHGP8NKw94UJ0fX\/WGug5sHVbQ9sWvOy\" +\n+            \"KLMBlxLMxqFadlUaOpvVZvdxnX++ktajwpGxJDhX9OWWsYGobm1buB7N1E1Prrg+\" +\n+            \"gt0RWpMhZa3Xeb\/8Jorr2Lfo8sWK0LQyTE8hQCSIthfoWL9FeJJn\/GKF\/dSj8kxU\" +\n+            \"0QIGMQKBgG\/8U\/zZ87DzfXS81P1p+CmH474wmou4KD2\/zXp\/lDR9+dlIUeijlIbU\" +\n+            \"P6Y5xJvT33Y40giW9irShgDHjZgw0ap11K3b2HzLImdPEaBiENo735rpLs8WLK9H\" +\n+            \"+yeRbiP2y9To7sTihm9Jrkctzp6sqFtKyye1+S21X1tMz8NGfXen\";\n@@ -74,8 +74,8 @@\n-        \/\/ the BASE64 string between -----BEGIN RSA PUBLIC KEY-----\n-        \/\/ and -----END RSA PUBLIC KEY-----\n-        \"MIIBCgKCAQEA0OIArlYES4X1XMTLDordtN\/XIWFE1wvhl40RsHWM2n99+StpCCJC\" +\n-        \"cUb5FJ2\/kefj\/XRwB6p5IMpIZrHZqC8XXzlX5fpiFaSu2xnk17oWUKoErW27Stm0\" +\n-        \"98pU2RoUxWPKVl+42a8iVp8tijNElBNFALCGi0zXOhcTxMh0q1Wk0UhMJqamv5Yn\" +\n-        \"CKmT4THwwGYn\/KeK3M7Qa+o5MoVBHLbeT9LJgEmSluVzIh44Lh6weX0bw72P8X2p\" +\n-        \"raOhbzg2B343MqS\/rMLw6On+0i7ccEgp23vX9G5w85q4A5FSIrk4S\/pyv5sOrwjC\" +\n-        \"QKBW1TS0\/2iB9zNkFMj5\/+h7l2oqTT7sSQIDAQAB\";\n+            \/\/ the BASE64 string between -----BEGIN RSA PUBLIC KEY-----\n+            \/\/ and -----END RSA PUBLIC KEY-----\n+            \"MIIBCgKCAQEA0OIArlYES4X1XMTLDordtN\/XIWFE1wvhl40RsHWM2n99+StpCCJC\" +\n+            \"cUb5FJ2\/kefj\/XRwB6p5IMpIZrHZqC8XXzlX5fpiFaSu2xnk17oWUKoErW27Stm0\" +\n+            \"98pU2RoUxWPKVl+42a8iVp8tijNElBNFALCGi0zXOhcTxMh0q1Wk0UhMJqamv5Yn\" +\n+            \"CKmT4THwwGYn\/KeK3M7Qa+o5MoVBHLbeT9LJgEmSluVzIh44Lh6weX0bw72P8X2p\" +\n+            \"raOhbzg2B343MqS\/rMLw6On+0i7ccEgp23vX9G5w85q4A5FSIrk4S\/pyv5sOrwjC\" +\n+            \"QKBW1TS0\/2iB9zNkFMj5\/+h7l2oqTT7sSQIDAQAB\";\n@@ -162,1 +162,1 @@\n-            \" public key...\");\n+                           \" public key...\");\n@@ -186,1 +186,1 @@\n-            \" private key...\");\n+                           \" private key...\");\n@@ -248,1 +248,1 @@\n-}\n+}\n\\ No newline at end of file\n","filename":"test\/jdk\/sun\/security\/rsa\/TestKeyFactory.java","additions":38,"deletions":38,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,0 @@\n-import java.io.ByteArrayInputStream;\n@@ -29,0 +28,2 @@\n+import java.security.PEMDecoder;\n+import java.security.PEMEncoder;\n@@ -31,0 +32,1 @@\n+import java.security.Security;\n@@ -32,2 +34,1 @@\n-import java.security.cert.CertificateException;\n-import java.security.cert.CertificateFactory;\n+import java.security.cert.X509Certificate;\n@@ -37,1 +38,0 @@\n-import java.security.spec.PKCS8EncodedKeySpec;\n@@ -42,1 +42,0 @@\n-import java.util.Base64;\n@@ -48,0 +47,1 @@\n+ * @enablePreview\n@@ -50,0 +50,1 @@\n+\n@@ -77,18 +78,26 @@\n-            KeyFactory kf = KeyFactory.getInstance(algorithm, provider);\n-            PKCS8EncodedKeySpec privSpec = new PKCS8EncodedKeySpec(\n-                    Base64.getMimeDecoder().decode(type));\n-            PrivateKey priv = kf.generatePrivate(privSpec);\n-\n-            RSAPrivateCrtKey crtKey = (RSAPrivateCrtKey) priv;\n-            PrivateKey priv1 = kf.generatePrivate(new RSAPrivateCrtKeySpec(\n-                    crtKey.getModulus(),\n-                    crtKey.getPublicExponent(),\n-                    crtKey.getPrivateExponent(),\n-                    crtKey.getPrimeP(),\n-                    crtKey.getPrimeQ(),\n-                    crtKey.getPrimeExponentP(),\n-                    crtKey.getPrimeExponentQ(),\n-                    crtKey.getCrtCoefficient(),\n-                    crtKey.getParams()\n-            ));\n-            equals(priv, priv1);\n+            final PEMDecoder decoder = PEMDecoder.of()\n+                    .withFactory(Security.getProvider(provider));\n+            final PrivateKey priv = decoder.decode(\n+                    type,\n+                    PrivateKey.class\n+            );\n+\n+            if (priv instanceof RSAPrivateCrtKey crtKey) {\n+                final KeyFactory kf = KeyFactory.getInstance(algorithm, provider);\n+                final PrivateKey priv1 =\n+                        kf.generatePrivate(new RSAPrivateCrtKeySpec(\n+                                crtKey.getModulus(),\n+                                crtKey.getPublicExponent(),\n+                                crtKey.getPrivateExponent(),\n+                                crtKey.getPrimeP(),\n+                                crtKey.getPrimeQ(),\n+                                crtKey.getPrimeExponentP(),\n+                                crtKey.getPrimeExponentQ(),\n+                                crtKey.getCrtCoefficient(),\n+                                crtKey.getParams()\n+                        ));\n+                equals(priv, priv1);\n+            } else {\n+                throw new RuntimeException(\n+                        \"Private key is not RSAPrivateCrtKey\");\n+            }\n@@ -96,1 +105,1 @@\n-                | NoSuchProviderException e) {\n+                 | NoSuchProviderException e) {\n@@ -108,3 +117,2 @@\n-            CertificateFactory cf = CertificateFactory.getInstance(\"X.509\");\n-            Certificate cert = cf.generateCertificate(\n-                    new ByteArrayInputStream(type.getBytes()));\n+            final Certificate cert = PEMDecoder.of()\n+                    .decode(type, X509Certificate.class);\n@@ -112,8 +120,15 @@\n-            KeyFactory kf = KeyFactory.getInstance(algorithm, provider);\n-            X509EncodedKeySpec pubSpec = kf.getKeySpec(\n-                    cert.getPublicKey(), X509EncodedKeySpec.class);\n-            PublicKey pub = kf.generatePublic(pubSpec);\n-            PublicKey pub1 = kf.generatePublic(new RSAPublicKeySpec(\n-                    ((RSAPublicKey) pub).getModulus(),\n-                    ((RSAPublicKey) pub).getPublicExponent(),\n-                    ((RSAPublicKey) pub).getParams()));\n+\n+            final PEMDecoder decoder = PEMDecoder.of()\n+                    .withFactory(Security.getProvider(provider));\n+            final RSAPublicKey pub = decoder.decode(\n+                    PEMEncoder.of().encodeToString(\n+                            new X509EncodedKeySpec(\n+                                    cert.getPublicKey().getEncoded())\n+                    ),\n+                    RSAPublicKey.class);\n+\n+            final KeyFactory kf = KeyFactory.getInstance(algorithm, provider);\n+            final PublicKey pub1 = kf.generatePublic(new RSAPublicKeySpec(\n+                    pub.getModulus(),\n+                    pub.getPublicExponent(),\n+                    pub.getParams()));\n@@ -122,2 +137,2 @@\n-        } catch (CertificateException | NoSuchAlgorithmException\n-                | InvalidKeySpecException | NoSuchProviderException e) {\n+        } catch (NoSuchAlgorithmException\n+                 | InvalidKeySpecException | NoSuchProviderException e) {\n@@ -140,1 +155,2 @@\n-            = \"MIIEvAIBADALBgkqhkiG9w0BAQoEggSoMIIEpAIBAAKCAQEAu1qb8PZ8vMrX08Gf\\n\"\n+            = \"-----BEGIN PRIVATE KEY-----\\n\"\n+            + \"MIIEvAIBADALBgkqhkiG9w0BAQoEggSoMIIEpAIBAAKCAQEAu1qb8PZ8vMrX08Gf\\n\"\n@@ -165,1 +181,2 @@\n-            + \"j4FaKzM\/ieY3WSapIbjf3w==\";\n+            + \"j4FaKzM\/ieY3WSapIbjf3w==\\n\"\n+            + \"-----END PRIVATE KEY-----\";\n","filename":"test\/jdk\/sun\/security\/rsa\/pss\/PSSKeyCompatibility.java","additions":57,"deletions":40,"binary":false,"changes":97,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,1 @@\n+ * @enablePreview\n@@ -35,2 +36,2 @@\n-import java.io.ByteArrayInputStream;\n-import java.io.UnsupportedEncodingException;\n+import java.security.PEM;\n+import java.security.PEMDecoder;\n@@ -46,1 +47,0 @@\n-import java.util.Base64;\n@@ -352,1 +352,2 @@\n-        CertificateFactory certFac = CertificateFactory.getInstance(\"X.509\");\n+        CertificateFactory certFac =\n+                CertificateFactory.getInstance(\"X.509\");\n@@ -354,7 +355,15 @@\n-        X509Certificate goodGuyCert = getCert(certFac, GOOD_SERVER_PEM);\n-        X509Certificate badGuyCert = getCert(certFac, BAD_SERVER_PEM);\n-        X509Certificate intCACert = getCert(certFac, INT_CA_PEM);\n-        X509Certificate rootCACert = getCert(certFac, ROOT_CA_PEM);\n-        byte[] goodOcspDer = pemToDer(GOOD_GUY_OCSP_PEM);\n-        byte[] badOcspDer = pemToDer(BAD_GUY_OCSP_PEM);\n-        byte[] intCAOcspDer = pemToDer(INT_CA_OCSP_PEM);\n+        final PEMDecoder decoder = PEMDecoder.of();\n+        X509Certificate goodGuyCert =\n+                decoder.decode(GOOD_SERVER_PEM, X509Certificate.class);\n+        X509Certificate badGuyCert =\n+                decoder.decode(BAD_SERVER_PEM, X509Certificate.class);\n+        X509Certificate intCACert =\n+                decoder.decode(INT_CA_PEM, X509Certificate.class);\n+        X509Certificate rootCACert =\n+                decoder.decode(ROOT_CA_PEM, X509Certificate.class);\n+        byte[] goodOcspDer =\n+                new PEM(\"OCSP RESPONSE\", GOOD_GUY_OCSP_PEM).decode();\n+        byte[] badOcspDer =\n+                new PEM(\"OCSP RESPONSE\", BAD_GUY_OCSP_PEM).decode();\n+        byte[] intCAOcspDer =\n+                new PEM(\"OCSP RESPONSE\",INT_CA_OCSP_PEM).decode();\n@@ -482,15 +491,0 @@\n-\n-    static X509Certificate getCert(CertificateFactory fac, String pemCert) {\n-        try {\n-            ByteArrayInputStream bais =\n-                    new ByteArrayInputStream(pemCert.getBytes(\"UTF-8\"));\n-            return (X509Certificate)fac.generateCertificate(bais);\n-        } catch (UnsupportedEncodingException | CertificateException exc) {\n-            throw new RuntimeException(exc);\n-        }\n-    }\n-\n-    static byte[] pemToDer(String pemData) {\n-        Base64.Decoder b64Dec = Base64.getMimeDecoder();\n-        return b64Dec.decode(pemData);\n-    }\n","filename":"test\/jdk\/sun\/security\/validator\/PKIXValAndRevCheckTests.java","additions":21,"deletions":27,"binary":false,"changes":48,"status":"modified"}]}