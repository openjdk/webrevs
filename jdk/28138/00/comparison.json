{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,2 @@\n+import jtreg.SkippedException;\n+\n@@ -35,2 +37,5 @@\n-import javax.crypto.*;\n-import javax.crypto.spec.*;\n+import javax.crypto.Cipher;\n+import javax.crypto.SecretKey;\n+import javax.crypto.spec.IvParameterSpec;\n+import javax.crypto.spec.SecretKeySpec;\n+import java.util.ArrayList;\n@@ -39,0 +44,1 @@\n+import java.util.List;\n@@ -76,2 +82,5 @@\n-     \/\/ from RFC 5649 sec6\n-     private static String KEK2 = \"5840DF6E29B02AF1AB493B705BF16EA1AE8338F4DCC176A8\";\n+    \/\/ from RFC 5649 sec6\n+    private static String KEK2 =\n+            \"5840DF6E29B02AF1AB493B705BF16EA1AE8338F4DCC176A8\";\n+\n+    private static final List<String> skippedList = new ArrayList <>();\n@@ -94,1 +103,5 @@\n-                System.arraycopy(val, 0, out, outLen - val.length, val.length);\n+                System.arraycopy(val,\n+                        0,\n+                        out,\n+                        outLen - val.length,\n+                        val.length);\n@@ -97,1 +110,5 @@\n-                System.arraycopy(val, val.length - outLen, out, 0, outLen);\n+                System.arraycopy(val,\n+                        val.length - outLen,\n+                        out,\n+                        0,\n+                        outLen);\n@@ -146,1 +163,2 @@\n-              \"138BDEAA9B8FA7FC61F97742E72248EE5AE6AE5360D1AE6A5F54F373FA543B6A\" },\n+              \"138BDEAA9B8FA7FC61F97742E72248EE5AE6AE5360D1AE6A5F54F373FA543B6A\"\n+            },\n@@ -260,0 +278,3 @@\n+            skippedList.add(algo + \" Cipher with wrapping \" +\n+                            dataLen + \"-byte key with \" + 8 * keyLen +\n+                            \"-bit KEK exceeds max allowed size \" + allowed);\n@@ -278,1 +299,2 @@\n-        AlgorithmParameters params = AlgorithmParameters.getInstance(\"AES\");\n+        AlgorithmParameters params =\n+                AlgorithmParameters.getInstance(\"AES\");\n@@ -303,3 +325,6 @@\n-        Key unwrapped = c1.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n-        Key unwrapped2 = c2.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n-        Key unwrapped3 = c3.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n+        Key unwrapped =\n+                c1.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n+        Key unwrapped2 =\n+                c2.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n+        Key unwrapped3 =\n+                c3.unwrap(wrapped, \"AES\", Cipher.SECRET_KEY);\n@@ -323,0 +348,3 @@\n+            skippedList.add(algo + \" Cipher with enc \" +\n+                            dataLen + \"-byte data with \" + 8 * keyLen +\n+                            \"-bit KEK exceeds max allowed size \" + allowed);\n@@ -339,1 +367,2 @@\n-        AlgorithmParameters params = AlgorithmParameters.getInstance(\"AES\");\n+        AlgorithmParameters params =\n+                AlgorithmParameters.getInstance(\"AES\");\n@@ -387,2 +416,1 @@\n-        for (int i = 0; i < testDatum.length; i++) {\n-            Object[] td = testDatum[i];\n+        for (Object[] td : testDatum) {\n@@ -391,2 +419,1 @@\n-                System.out.println(\"Skip, due to no support:  \" + algo);\n-                continue;\n+                skippedList.add(\"No support for \" + algo);\n@@ -394,4 +421,11 @@\n-            testKeyWrap(algo, (String)td[1], (int)td[2], (String)td[3],\n-                    (int)td[4], (String)td[5], p);\n-            testEnc(algo, (String)td[1], (int)td[2], (String)td[3],\n-                    (int)td[4], (String)td[5], p);\n+            testKeyWrap(algo, (String) td[1], (int) td[2], (String) td[3],\n+                    (int) td[4], (String) td[5], p);\n+            testEnc(algo, (String) td[1], (int) td[2], (String) td[3],\n+                    (int) td[4], (String) td[5], p);\n+        }\n+\n+        if (!skippedList.isEmpty()) {\n+            throw new SkippedException(\"One or more tests skipped \"\n+                                       + skippedList);\n+        } else {\n+            System.out.println(\"All Tests Passed\");\n@@ -399,1 +433,0 @@\n-        System.out.println(\"Test Passed\");\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/KeyWrap\/NISTWrapKAT.java","additions":55,"deletions":22,"binary":false,"changes":77,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,2 @@\n+import jtreg.SkippedException;\n+\n@@ -33,0 +35,7 @@\n+import java.security.AlgorithmParameters;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.Key;\n+import java.security.KeyPairGenerator;\n+import java.security.PrivateKey;\n+import java.security.Provider;\n+import java.util.ArrayList;\n@@ -35,3 +44,5 @@\n-import java.security.*;\n-import javax.crypto.*;\n-import javax.crypto.spec.*;\n+import java.util.List;\n+import javax.crypto.Cipher;\n+import javax.crypto.SecretKey;\n+import javax.crypto.spec.IvParameterSpec;\n+import javax.crypto.spec.SecretKeySpec;\n@@ -43,1 +54,2 @@\n-            Arrays.copyOf(\"1234567890123456789012345678901234\".getBytes(), 32);\n+            Arrays.copyOf(\"1234567890123456789012345678901234\".getBytes(),\n+                    32);\n@@ -52,1 +64,2 @@\n-            IvParameterSpec[] ivs, int maxPadLen) throws Exception {\n+                               IvParameterSpec[] ivs, int maxPadLen)\n+            throws Exception {\n@@ -99,1 +112,1 @@\n-            String expectedStr) throws Exception {\n+                               String expectedStr) throws Exception {\n@@ -248,1 +261,4 @@\n-                (\"RSA\", System.getProperty(\"test.provider.name\",\"SunRsaSign\"))\n+                (\"RSA\",\n+                        System.getProperty(\n+                                \"test.provider.name\",\n+                                \"SunRsaSign\"))\n@@ -254,0 +270,3 @@\n+\n+        final List<String> skippedList  = new ArrayList<>();\n+\n@@ -256,2 +275,1 @@\n-                System.out.println(\"Skip, due to no support:  \" + a);\n-                continue;\n+                skippedList.add(a);\n@@ -332,1 +350,7 @@\n-        System.out.println(\"All Tests Passed\");\n+\n+        if (!skippedList.isEmpty()) {\n+            throw new SkippedException(\"One or more tests skipped \" +\n+                                       \"due to no support \" + skippedList);\n+        } else {\n+            System.out.println(\"All Tests Passed\");\n+        }\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/KeyWrap\/TestGeneral.java","additions":35,"deletions":11,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,2 @@\n+import jtreg.SkippedException;\n+\n@@ -33,1 +35,0 @@\n-import java.security.AlgorithmParameters;\n@@ -35,2 +36,4 @@\n-import javax.crypto.*;\n-import javax.crypto.spec.*;\n+import javax.crypto.Cipher;\n+import javax.crypto.SecretKey;\n+import javax.crypto.spec.IvParameterSpec;\n+import javax.crypto.spec.SecretKeySpec;\n@@ -38,1 +41,0 @@\n-import java.io.IOException;\n@@ -108,1 +110,3 @@\n-            key[i] = c.unwrap(wrappedKey, \"AES\", Cipher.SECRET_KEY);\n+            key[i] = c.unwrap(wrappedKey,\n+                    \"AES\",\n+                    Cipher.SECRET_KEY);\n@@ -134,2 +138,1 @@\n-            System.out.println(\"Skip, due to no support:  \" + wrapAlg);\n-            return;\n+            throw new SkippedException(\"No support \" + wrapAlg);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/KeyWrap\/XMLEncKAT.java","additions":11,"deletions":8,"binary":false,"changes":19,"status":"modified"}]}