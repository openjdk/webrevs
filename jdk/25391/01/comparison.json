{"files":[{"patch":"@@ -32,4 +32,0 @@\n-import org.junit.jupiter.params.ParameterizedTest;\n-import org.junit.jupiter.params.provider.Arguments;\n-import org.junit.jupiter.params.provider.MethodSource;\n-\n@@ -38,0 +34,7 @@\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.concurrent.Callable;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.Future;\n@@ -42,0 +45,1 @@\n+import org.junit.jupiter.api.Test;\n@@ -56,2 +60,1 @@\n-    private static Stream<Arguments> patternMatches() {\n-        return Stream.of(\n+    private static final Stream<String[]> patternMatches = Stream.of(\n@@ -59,1 +62,1 @@\n-                Arguments.of(\"properties\",\n+            new String[]{\"properties\",\n@@ -61,1 +64,1 @@\n-                        \"properties:\"),\n+                        \"properties:\"},\n@@ -63,1 +66,1 @@\n-                Arguments.of(\"properties+thread\",\n+                new String[]{\"properties+thread\",\n@@ -65,1 +68,1 @@\n-                        \"properties:\"),\n+                        \"properties:\"},\n@@ -67,1 +70,1 @@\n-                Arguments.of(\"properties+thread+timestamp\",\n+        new String[]{\"properties+thread+timestamp\",\n@@ -69,1 +72,1 @@\n-                        \"properties:\"),\n+                        \"properties:\"},\n@@ -71,1 +74,1 @@\n-                Arguments.of(\"keystore,properties\",\n+        new String[]{\"keystore,properties\",\n@@ -73,1 +76,1 @@\n-                        \"properties:\"),\n+                        \"properties:\"},\n@@ -75,1 +78,1 @@\n-                Arguments.of(\"all\",\n+        new String[]{\"all\",\n@@ -77,1 +80,1 @@\n-                        \"properties:\"),\n+                        \"properties:\"},\n@@ -79,1 +82,1 @@\n-                Arguments.of(\"all+thread\",\n+        new String[]{\"all+thread\",\n@@ -81,1 +84,1 @@\n-                        \"properties:\")\n+                        \"properties:\"}\n@@ -83,0 +86,26 @@\n+\n+    \/**\n+     * This will execute the test logic without any param manipulation\n+     *\n+     * @param paramName   name of the parameter e.g. -Djava.security.debug=\n+     * @param paramVal    value of the parameter\n+     * @param expected    expected output\n+     * @param notExpected not expected output\n+     *\/\n+    public void testParameter(String paramName,\n+                              String paramVal,\n+                              String expected,\n+                              String notExpected) throws Exception {\n+\n+        System.out.printf(\"Executing: {%s%s%s}%n\",\n+                paramName,\n+                paramVal,\n+                \"DebugOptions\");\n+\n+\n+        final OutputAnalyzer outputAnalyzer = ProcessTools.executeTestJava(\n+                paramName + paramVal,\n+                \"DebugOptions\");\n+        outputAnalyzer.shouldHaveExitValue(0)\n+                .shouldMatch(expected)\n+                .shouldNotMatch(notExpected);\n@@ -85,7 +114,23 @@\n-    @ParameterizedTest\n-    @MethodSource(\"patternMatches\")\n-    public void shouldContain(String params, String expected, String notExpected) throws Exception {\n-        OutputAnalyzer outputAnalyzer = ProcessTools.executeTestJava(\n-                \"-Djava.security.debug=\" + params,\n-                \"DebugOptions\"\n-        );\n+    \/**\n+     * This will execute the test logic, but first change the param\n+     * to be mixed case\n+     *\n+     * @param paramName   name of the parameter e.g. -Djava.security.debug=\n+     * @param paramVal    value of the parameter\n+     * @param expected    expected output\n+     * @param notExpected not expected output\n+     *\/\n+    public void testMixedCaseParameter(String paramName,\n+                                       String paramVal,\n+                                       String expected,\n+                                       String notExpected) throws Exception {\n+\n+        final String formattedParam = makeFirstAndLastLetterUppercase(paramVal);\n+        System.out.printf(\"Executing: {%s%s%s}%n\",\n+                paramName,\n+                formattedParam,\n+                \"DebugOptions\");\n+\n+        final OutputAnalyzer outputAnalyzer = ProcessTools.executeTestJava(\n+                paramName + formattedParam,\n+                \"DebugOptions\");\n@@ -97,0 +142,80 @@\n+    \/**\n+     * This method will change the input string to have the first\n+     * and last letters uppercase\n+     * <p>\n+     * e.g.:\n+     * hello -> HellO\n+     *\n+     * @param paramString string to change\n+     * @return resulting string\n+     *\/\n+    private String makeFirstAndLastLetterUppercase(final String paramString) {\n+        final int length = paramString.length();\n+        final String firstLetter = paramString.substring(0, 1);\n+        final String lastLetter = paramString.substring((length - 1),\n+                length);\n+\n+        return firstLetter.toUpperCase()\n+               + paramString.substring(1, length - 1)\n+               + lastLetter.toUpperCase();\n+    }\n+\n+    \/**\n+     * This test will run all options in parallel with all param names\n+     * in both mixed and lowercase\n+     *\/\n+    @Test\n+    public void debugOptionsTest() throws Exception {\n+\n+        try (final ExecutorService executorService = Executors.newVirtualThreadPerTaskExecutor()) {\n+            final List<Callable<Void>> testsCallables = new ArrayList<>();\n+\n+            patternMatches.forEach(params -> {\n+                testsCallables.add(() -> {\n+                    testParameter(\n+                            \"-Djava.security.debug=\",\n+                            params[0],\n+                            params[1],\n+                            params[2]);\n+                    return null;\n+                });\n+                testsCallables.add(() -> {\n+                    testMixedCaseParameter(\n+                            \"-Djava.security.debug=\",\n+                            params[0],\n+                            params[1],\n+                            params[2]);\n+                    return null;\n+                });\n+\n+                testsCallables.add(() -> {\n+                    testParameter(\n+                            \"-Djava.security.auth.debug=\",\n+                            params[0],\n+                            params[1],\n+                            params[2]);\n+                    return null;\n+                });\n+                testsCallables.add(() -> {\n+                    testMixedCaseParameter(\n+                            \"-Djava.security.auth.debug=\",\n+                            params[0],\n+                            params[1],\n+                            params[2]);\n+                    return null;\n+                });\n+\n+                System.out.println(\"option added to all tests \" + Arrays.toString(params));\n+            });\n+\n+            System.out.println(\"Starting all the threads\");\n+            final List<Future<Void>> res = executorService.invokeAll(testsCallables);\n+            for (final Future<Void> future : res) {\n+                future.get();\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * This is used for the test logic itself\n+     *\/\n@@ -98,0 +223,1 @@\n+\n","filename":"test\/jdk\/sun\/security\/util\/Debug\/DebugOptions.java","additions":151,"deletions":25,"binary":false,"changes":176,"status":"modified"}]}