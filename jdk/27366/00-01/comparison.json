{"files":[{"patch":"@@ -817,1 +817,0 @@\n-java\/awt\/Frame\/SizeMinimizedTest.java 8305915 linux-x64\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -32,0 +32,2 @@\n+import javax.imageio.ImageIO;\n+import java.awt.Dimension;\n@@ -34,0 +36,4 @@\n+import java.awt.Rectangle;\n+import java.awt.Robot;\n+import java.awt.Toolkit;\n+import java.io.File;\n@@ -43,13 +49,2 @@\n-        EventQueue.invokeAndWait(() -> {\n-            f = new Frame(\"Frame Location Test\");\n-            f.setBounds(X, Y, 250, 250); \/\/ the size doesn't matter\n-            f.setVisible(true);\n-        });\n-\n-        for (int i = 0; i < 10; i++) {\n-            \/\/ 2 seconds must be enough for the WM to show the window\n-            try {\n-                Thread.sleep(2000);\n-            } catch (InterruptedException _) {\n-            }\n-\n+        Robot robot = new Robot();\n+        try {\n@@ -57,3 +52,3 @@\n-                \/\/ Check the location\n-                xPos = f.getX();\n-                yPos = f.getY();\n+                f = new Frame(\"Frame Location Test\");\n+                f.setBounds(X, Y, 250, 250); \/\/ the size doesn't matter\n+                f.setVisible(true);\n@@ -62,4 +57,4 @@\n-            if (xPos != X || yPos != Y) {\n-                throw new RuntimeException(\"The frame location is wrong! Current: \" +\n-                        xPos + \", \" + yPos + \";  expected: \" + X + \", \" + Y);\n-            }\n+            for (int i = 0; i < 10; i++) {\n+                \/\/ 2 seconds must be enough for the WM to show the window\n+                robot.waitForIdle();\n+                robot.delay(2000);\n@@ -67,6 +62,5 @@\n-            \/\/ Emulate what happens when setGraphicsConfiguration() is called\n-            synchronized (f.getTreeLock()) {\n-                f.removeNotify();\n-                f.addNotify();\n-            }\n-        }\n+                EventQueue.invokeAndWait(() -> {\n+                    \/\/ Check the location\n+                    xPos = f.getX();\n+                    yPos = f.getY();\n+                });\n@@ -74,3 +68,14 @@\n-        EventQueue.invokeAndWait(() -> {\n-            if (f != null) {\n-                f.dispose();\n+                if (xPos != X || yPos != Y) {\n+                    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();\n+                    ImageIO.write(robot.createScreenCapture(\n+                                    new Rectangle(0, 0, screenSize.width, screenSize.height)),\n+                            \"png\", new File(\"FailureImage.png\"));\n+                    throw new RuntimeException(\"The frame location is wrong! Current: \" +\n+                            xPos + \", \" + yPos + \";  expected: \" + X + \", \" + Y);\n+                }\n+\n+                \/\/ Emulate what happens when setGraphicsConfiguration() is called\n+                synchronized (f.getTreeLock()) {\n+                    f.removeNotify();\n+                    f.addNotify();\n+                }\n@@ -78,1 +83,7 @@\n-        });\n+        } finally {\n+            EventQueue.invokeAndWait(() -> {\n+                if (f != null) {\n+                    f.dispose();\n+                }\n+            });\n+        }\n@@ -81,1 +92,0 @@\n-\n","filename":"test\/jdk\/java\/awt\/Frame\/FrameLocation\/FrameLocation.java","additions":41,"deletions":31,"binary":false,"changes":72,"status":"modified"}]}