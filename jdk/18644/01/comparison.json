{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,7 +24,0 @@\n-\/*\n- * @test\n- * @bug 7093691\n- * @summary Tests if JComboBox has correct font color when disabled\/enabled\n- * @run main\/othervm -Dsun.java2d.uiScale=1 DisabledComboBoxFontTestAuto\n- *\/\n-\n@@ -47,0 +40,8 @@\n+\/*\n+ * @test\n+ * @bug 7093691 8310072\n+ * @summary Tests if JComboBox has correct font color when disabled\/enabled\n+ * @key headful\n+ * @run main\/othervm -Dsun.java2d.uiScale=1 DisabledComboBoxFontTestAuto\n+ *\/\n+\n@@ -54,0 +55,1 @@\n+    private static final int TOLERANCE = 20;\n@@ -102,1 +104,0 @@\n-        boolean isIdentical = true;\n@@ -106,1 +107,1 @@\n-        int y = 10;\n+        int y = enabledImage.getHeight() \/ 2;\n@@ -116,0 +117,14 @@\n+            } else if (lafName.equals(\"Windows\")) {\n+                \/\/ In Windows LAF, the ComboBox sizes are different and\n+                \/\/ that results in pixel offset of 1px for width and 1px for height.\n+                eColor1 = new Color(enabledImage.getRGB(x, y));\n+                eColor2 = new Color(enabledImage2.getRGB(x + 1, y - 1));\n+                dColor1 = new Color(disabledImage.getRGB(x, y));\n+                dColor2 = new Color(disabledImage2.getRGB(x + 1, y - 1));\n+            } else if (lafName.equals(\"GTK+\")) {\n+                \/\/ In GTK LAF, the ComboBox sizes are different and\n+                \/\/ that results in pixel offset of 10px for width and 2px for height.\n+                eColor1 = new Color(enabledImage.getRGB(x, y));\n+                eColor2 = new Color(enabledImage2.getRGB(x + 10, y + 2));\n+                dColor1 = new Color(disabledImage.getRGB(x, y));\n+                dColor2 = new Color(disabledImage2.getRGB(x + 10, y + 2));\n@@ -123,2 +138,2 @@\n-                isIdentical = false;\n-                break;\n+                failingLafs.append(lafName + \", \");\n+                return;\n@@ -127,6 +142,1 @@\n-\n-        if (isIdentical) {\n-            System.out.println(\"PASSED\");\n-        } else {\n-            failingLafs.append(lafName + \", \");\n-        }\n+        System.out.println(\"Test Passed: \" + lafName);\n@@ -136,3 +146,3 @@\n-        if ((c1.getRed() != c2.getRed())\n-                || (c1.getBlue() != c2.getBlue())\n-                || (c1.getGreen() != c2.getGreen())) {\n+        int redDiff = Math.abs(c1.getRed() - c2.getRed());\n+        int blueDiff = Math.abs(c1.getBlue() - c2.getBlue());\n+        int greenDiff = Math.abs(c1.getGreen() - c2.getGreen());\n@@ -140,0 +150,4 @@\n+        \/\/ Added TOLERANCE for pixel color difference. In Windows LAF the\n+        \/\/ background color between disabled and disabled DLCR image is slightly\n+        \/\/ different (240, 240, 240 vs 255, 255, 255).\n+        if ((redDiff > TOLERANCE) || (blueDiff > TOLERANCE) || (greenDiff > TOLERANCE)) {\n","filename":"test\/jdk\/javax\/swing\/JComboBox\/DisabledComboBoxFontTestAuto.java","additions":35,"deletions":21,"binary":false,"changes":56,"status":"modified"}]}