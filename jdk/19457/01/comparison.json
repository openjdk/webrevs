{"files":[{"patch":"@@ -99,1 +99,2 @@\n-    if (_current_method != method()) {\n+    bool method_changed = _current_method != method();\n+    if (method_changed) {\n@@ -122,9 +123,0 @@\n-     int bci = (int)(bcp - method->code_base());\n-    st->print(\"[%ld] \", (long) Thread::current()->osthread()->thread_id());\n-    if (Verbose) {\n-      st->print(\"%8d  %4d  \" INTPTR_FORMAT \" \" INTPTR_FORMAT \" %s\",\n-           BytecodeCounter::counter_value(), bci, tos, tos2, Bytecodes::name(code));\n-    } else {\n-      st->print(\"%8d  %4d  %s\",\n-           BytecodeCounter::counter_value(), bci, Bytecodes::name(code));\n-    }\n@@ -132,1 +124,17 @@\n-    print_attributes(bci, st);\n+    \/\/ Trace each bytecode unless we're truncating the tracing output, then only print the first\n+    \/\/ bytecode in every method as well as returns\/throws that pop control flow\n+    if (!TraceBytecodesTruncated || method_changed ||\n+        code == Bytecodes::_athrow ||\n+        code == Bytecodes::_return_register_finalizer ||\n+        (code >= Bytecodes::_ireturn && code <= Bytecodes::_return)) {\n+      int bci = (int)(bcp - method->code_base());\n+      st->print(\"[%ld] \", (long) Thread::current()->osthread()->thread_id());\n+      if (Verbose) {\n+        st->print(\"%8d  %4d  \" INTPTR_FORMAT \" \" INTPTR_FORMAT \" %s\",\n+            BytecodeCounter::counter_value(), bci, tos, tos2, Bytecodes::name(code));\n+      } else {\n+        st->print(\"%8d  %4d  %s\",\n+            BytecodeCounter::counter_value(), bci, Bytecodes::name(code));\n+      }\n+      print_attributes(bci, st);\n+    }\n@@ -339,1 +347,2 @@\n-  if (Bytecodes::length_for(code) == 1) {\n+  \/\/ Also skip this if we're truncating bytecode output\n+  if (TraceBytecodesTruncated || Bytecodes::length_for(code) == 1) {\n","filename":"src\/hotspot\/share\/interpreter\/bytecodeTracer.cpp","additions":21,"deletions":12,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -872,0 +872,3 @@\n+  develop(bool, TraceBytecodesTruncated, false,                             \\\n+          \"Truncate non control-flow bytecode when tracing bytecode\")       \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"}]}