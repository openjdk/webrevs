{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import javax.swing.SwingUtilities;\n@@ -34,3 +35,0 @@\n- * @author Alexandr Scherbatiy\n- * @library \/lib\/client\n- * @build ExtendedRobot\n@@ -39,1 +37,0 @@\n-public class ExtendedKeyCodeTest {\n@@ -41,2 +38,4 @@\n-    private static volatile boolean setExtendedKeyCode = true;\n-    private static volatile int eventsCount = 0;\n+public class ExtendedKeyCodeTest {\n+    private static Frame frame;\n+    private static volatile boolean setExtendedKeyCode;\n+    private static volatile int eventsCount;\n@@ -45,1 +44,1 @@\n-        ExtendedRobot robot = new ExtendedRobot();\n+        Robot robot = new Robot();\n@@ -48,2 +47,4 @@\n-        Frame frame = new Frame();\n-        frame.setSize(300, 300);\n+        try {\n+            SwingUtilities.invokeAndWait(() -> createTestGUI());\n+            robot.waitForIdle();\n+            robot.delay(1000);\n@@ -51,1 +52,10 @@\n-        frame.addKeyListener(new KeyAdapter() {\n+            robot.keyPress(KeyEvent.VK_D);\n+            robot.keyRelease(KeyEvent.VK_D);\n+            robot.waitForIdle();\n+\n+            if (!setExtendedKeyCode) {\n+                throw new RuntimeException(\"Wrong extended key code!\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> frame.dispose());\n+        }\n@@ -53,0 +63,22 @@\n+        try {\n+            SwingUtilities.invokeAndWait(() -> createTestGUI2());\n+            robot.waitForIdle();\n+            robot.delay(1000);\n+\n+            robot.keyPress(KeyEvent.VK_LEFT);\n+            robot.keyRelease(KeyEvent.VK_LEFT);\n+            robot.waitForIdle();\n+\n+            if (eventsCount != 2 || !setExtendedKeyCode) {\n+                throw new RuntimeException(\"Wrong extended key code\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> frame.dispose());\n+        }\n+    }\n+\n+    public static void createTestGUI() {\n+        eventsCount = 0;\n+        setExtendedKeyCode = true;\n+        frame = new Frame(\"ExtendedKeyCodeTest1\");\n+        frame.addKeyListener(new KeyAdapter() {\n@@ -68,0 +100,2 @@\n+        frame.setLocationRelativeTo(null);\n+        frame.setSize(300, 300);\n@@ -69,11 +103,1 @@\n-        robot.waitForIdle();\n-\n-        robot.keyPress(KeyEvent.VK_D);\n-        robot.keyRelease(KeyEvent.VK_D);\n-        robot.waitForIdle();\n-\n-        frame.dispose();\n-\n-        if (eventsCount != 2 || !setExtendedKeyCode) {\n-            throw new RuntimeException(\"Wrong extended key code\");\n-        }\n+    }\n@@ -81,2 +105,1 @@\n-        frame = new Frame();\n-        frame.setSize(300, 300);\n+    public static void createTestGUI2() {\n@@ -84,1 +107,1 @@\n-\n+        frame = new Frame(\"ExtendedKeyCodeTest2\");\n@@ -86,1 +109,0 @@\n-\n@@ -93,0 +115,2 @@\n+        frame.setLocationRelativeTo(null);\n+        frame.setSize(300, 300);\n@@ -94,10 +118,0 @@\n-        robot.waitForIdle();\n-\n-        robot.keyPress(KeyEvent.VK_LEFT);\n-        robot.keyRelease(KeyEvent.VK_LEFT);\n-        robot.waitForIdle();\n-        frame.dispose();\n-\n-        if (!setExtendedKeyCode) {\n-            throw new RuntimeException(\"Wrong extended key code!\");\n-        }\n","filename":"test\/jdk\/java\/awt\/event\/KeyEvent\/ExtendedKeyCode\/ExtendedKeyCodeTest.java","additions":49,"deletions":35,"binary":false,"changes":84,"status":"modified"}]}