{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import java.nio.channels.Channels;\n@@ -31,0 +32,2 @@\n+import java.nio.file.StandardOpenOption;\n+import java.util.EnumSet;\n@@ -95,1 +98,8 @@\n-        try (OutputStream fos = new SparseOutputStream(new FileOutputStream(ZIP_FILE_NAME));\n+        \/\/ NTFS requires sparse files to be created explicitly\n+        EnumSet<StandardOpenOption> options = EnumSet.of(StandardOpenOption.CREATE_NEW,\n+                StandardOpenOption.WRITE,\n+                StandardOpenOption.SPARSE);\n+\n+        try (FileChannel channel = FileChannel.open(Path.of(ZIP_FILE_NAME), options);\n+             OutputStream outputStream = Channels.newOutputStream(channel);\n+             OutputStream fos = new SparseOutputStream(outputStream, channel);\n@@ -171,3 +181,3 @@\n-        public SparseOutputStream(FileOutputStream fileOutputStream) {\n-            super(fileOutputStream);\n-            this.channel = fileOutputStream.getChannel();\n+        public SparseOutputStream(OutputStream out, FileChannel channel) {\n+            super(out);\n+            this.channel = channel;\n","filename":"test\/jdk\/java\/util\/zip\/ZipFile\/Zip64SizeTest.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"}]}