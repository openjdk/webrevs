{"files":[{"patch":"@@ -276,1 +276,1 @@\n-    return AtomicAccess::cmpxchg(value_ptr(), compare_value, new_value);\n+    return AtomicAccess::cmpxchg(value_ptr(), compare_value, new_value, order);\n@@ -282,2 +282,0 @@\n-  using Base = CommonCore<T>;\n-\n@@ -285,1 +283,1 @@\n-  explicit SupportsExchange(T value) : Base(value) {}\n+  explicit SupportsExchange(T value) : CommonCore<T>(value) {}\n@@ -291,1 +289,1 @@\n-    return AtomicAccess::xchg(this->value_ptr(), new_value);\n+    return AtomicAccess::xchg(this->value_ptr(), new_value, order);\n@@ -297,3 +295,1 @@\n-  using Base = SupportsExchange<T>;\n-\n-  \/\/ Guarding the AtomicAccess calls with constexpr checking of I produces\n+  \/\/ Guarding the AtomicAccess calls with constexpr checking of Offset produces\n@@ -301,3 +297,4 @@\n-  template<typename I>\n-  static constexpr bool check_i() {\n-    static_assert(sizeof(I) <= sizeof(T), \"offset size exceeds value size\");\n+  template<typename Offset>\n+  static constexpr bool check_offset_type() {\n+    static_assert(std::is_integral_v<Offset>, \"offset must be integral\");\n+    static_assert(sizeof(Offset) <= sizeof(T), \"offset size exceeds value size\");\n@@ -307,1 +304,2 @@\n-      static_assert(std::is_signed_v<I>, \"value is signed but offset is unsigned\");\n+      static_assert(std::is_signed_v<Offset>,\n+                    \"value is signed but offset is unsigned\");\n@@ -309,1 +307,2 @@\n-      static_assert(std::is_unsigned_v<I>, \"value is unsigned but offset is signed\");\n+      static_assert(std::is_unsigned_v<Offset>,\n+                    \"value is unsigned but offset is signed\");\n@@ -315,1 +314,1 @@\n-  explicit SupportsArithmetic(T value) : Base(value) {}\n+  explicit SupportsArithmetic(T value) : SupportsExchange<T>(value) {}\n@@ -319,2 +318,2 @@\n-  template<typename I>\n-  T add_then_fetch(I add_value,\n+  template<typename Offset>\n+  T add_then_fetch(Offset add_value,\n@@ -322,1 +321,1 @@\n-    if constexpr (check_i<I>()) {\n+    if constexpr (check_offset_type<Offset>()) {\n@@ -327,2 +326,2 @@\n-  template<typename I>\n-  T fetch_then_add(I add_value,\n+  template<typename Offset>\n+  T fetch_then_add(Offset add_value,\n@@ -330,1 +329,1 @@\n-    if constexpr (check_i<I>()) {\n+    if constexpr (check_offset_type<Offset>()) {\n@@ -335,2 +334,2 @@\n-  template<typename I>\n-  T sub_then_fetch(I sub_value,\n+  template<typename Offset>\n+  T sub_then_fetch(Offset sub_value,\n@@ -338,1 +337,1 @@\n-    if constexpr (check_i<I>()) {\n+    if constexpr (check_offset_type<Offset>()) {\n@@ -343,2 +342,2 @@\n-  template<typename I>\n-  T fetch_then_sub(I sub_value,\n+  template<typename Offset>\n+  T fetch_then_sub(Offset sub_value,\n@@ -346,1 +345,1 @@\n-    if constexpr (check_i<I>()) {\n+    if constexpr (check_offset_type<Offset>()) {\n@@ -357,2 +356,0 @@\n-  using Base = SupportsArithmetic<T>;\n-\n@@ -360,1 +357,1 @@\n-  explicit Atomic(T value = 0) : Base(value) {}\n+  explicit Atomic(T value = 0) : SupportsArithmetic<T>(value) {}\n@@ -399,2 +396,0 @@\n-  using Base = CommonCore<T>;\n-\n@@ -402,1 +397,1 @@\n-  explicit Atomic(T value = 0) : Base(value) {}\n+  explicit Atomic(T value = 0) : CommonCore<T>(value) {}\n@@ -417,2 +412,0 @@\n-  using Base = SupportsArithmetic<T>;\n-\n@@ -420,1 +413,1 @@\n-  explicit Atomic(T value = nullptr) : Base(value) {}\n+  explicit Atomic(T value = nullptr) : SupportsArithmetic<T>(value) {}\n@@ -437,2 +430,2 @@\n-  template<typename Check> static char* test(decltype(&Check::exchange));\n-  template<typename> static char test(...);\n+  template<typename Check> static void* test(decltype(&Check::exchange));\n+  template<typename> static int test(...);\n","filename":"src\/hotspot\/share\/runtime\/atomic.hpp","additions":30,"deletions":37,"binary":false,"changes":67,"status":"modified"}]}