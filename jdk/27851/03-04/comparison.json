{"files":[{"patch":"@@ -225,3 +225,10 @@\n-        int secondDot = alias.indexOf('.', firstDot + 1);\n-        if ((firstDot == -1) || (secondDot == -1)) {\n-            \/\/ invalid alias\n+        int secondDot = -1;\n+\n+        if (firstDot > 0 && alias.length() - firstDot > 3) {\n+            secondDot = alias.indexOf('.', firstDot + 1);\n+        }\n+\n+        if (secondDot - firstDot < 2 || alias.length() - secondDot < 2) {\n+            if (SSLLogger.isOn && SSLLogger.isOn(\"keymanager\")) {\n+                SSLLogger.warning(\"Invalid alias format: \" + alias);\n+            }\n@@ -230,0 +237,1 @@\n+\n@@ -252,1 +260,1 @@\n-                SSLLogger.warning(\"Exception triggered: \" + e);\n+                SSLLogger.warning(\"Exception thrown while getting an alias \" + alias + \": \" + e);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/X509KeyManagerImpl.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -68,1 +68,1 @@\n-    private static final String KEY_MGR_EXCEPTION_MESSAGE = \"Exception triggered:\";\n+    private static final String KEY_MGR_EXCEPTION_MESSAGE = \"Exception thrown while getting an alias\";\n@@ -198,0 +198,18 @@\n+    @Test\n+    public void wrongNumberFormatTest() {\n+        \/\/ recording logs to the output stream\n+        final ByteArrayOutputStream outputStream = replaceSystemError();\n+        final X509Certificate[] certs = km.getCertificateChain(\"RSA.not.exist\");\n+        final PrivateKey priv = km.getPrivateKey(\"RSA.not.exist\");\n+\n+        Asserts.assertNull(certs, \"Should return null if the alias can't be found\");\n+        Asserts.assertNull(priv, \"Should return null if the alias can't be found\");\n+\n+        System.setErr(initialErrStream);\n+        System.err.println(\" => wrongNumberFormatTest: \\n\" + outputStream);\n+\n+        Asserts.assertFalse(isDebugLogging && !outputStream.toString().contains(KEY_MGR_EXCEPTION_MESSAGE),\n+                \"No log triggered\");\n+\n+    }\n+\n@@ -199,2 +217,2 @@\n-    @ValueSource(strings = {\"RSA.not.exist\", \"..1\"})\n-    public void wrongNumberFormatTest(final String alias) {\n+    @ValueSource(strings = {\"..1\", \".9.123456789\"})\n+    public void invalidAliasTest(final String alias) {\n@@ -203,2 +221,2 @@\n-        X509Certificate[] certs = km.getCertificateChain(alias);\n-        PrivateKey priv = km.getPrivateKey(alias);\n+        final X509Certificate[] certs = km.getCertificateChain(alias);\n+        final PrivateKey priv = km.getPrivateKey(alias);\n@@ -212,1 +230,1 @@\n-        Asserts.assertFalse(isDebugLogging && !outputStream.toString().contains(KEY_MGR_EXCEPTION_MESSAGE),\n+        Asserts.assertFalse(isDebugLogging && !outputStream.toString().contains(\"Invalid alias format:\"),\n","filename":"test\/jdk\/sun\/security\/ssl\/X509KeyManager\/NullCases.java","additions":24,"deletions":6,"binary":false,"changes":30,"status":"modified"}]}