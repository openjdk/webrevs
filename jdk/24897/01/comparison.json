{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -398,1 +398,3 @@\n-            buffer[bp++] = b;\n+            \/\/ Can be negative because widening from byte in write(byte[], int, int).\n+            \/\/ java.io.OutputStream.write(int b) stipulates \"The 24 high-order bits of b are ignored.\"\n+            buffer[bp++] = b & 0xff;\n@@ -415,1 +417,1 @@\n-                        int len = readInt(b);\n+                        int len = readInt(1);\n","filename":"src\/jdk.jshell\/share\/classes\/jdk\/jshell\/execution\/impl\/ConsoleImpl.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -160,0 +160,25 @@\n+    @Test\n+    public void testConsoleUnicodeWritingTest() {\n+        StringBuilder sb = new StringBuilder();\n+        console = new ThrowingJShellConsole() {\n+            @Override\n+            public PrintWriter writer() {\n+                return new PrintWriter(new Writer() {\n+                    @Override\n+                    public void write(char[] cbuf, int off, int len) throws IOException {\n+                        sb.append(cbuf, off, len);\n+                    }\n+                    @Override\n+                    public void flush() throws IOException {}\n+                    @Override\n+                    public void close() throws IOException {}\n+                });\n+            }\n+        };\n+        int count = 384; \/\/ 128-255, 384-511, 640-767, ... (JDK-8355371)\n+        String testStr = \"\\u30A2\"; \/\/ Japanese katakana (A2 >= 80) (JDK-8354910)\n+        assertEval(\"System.console().writer().write(\\\"\" + testStr + \"\\\".repeat(\" + count + \"))\");\n+        String expected = testStr.repeat(count);\n+        assertEquals(sb.toString(), expected);\n+    }\n+\n","filename":"test\/langtools\/jdk\/jshell\/ConsoleTest.java","additions":26,"deletions":1,"binary":false,"changes":27,"status":"modified"}]}