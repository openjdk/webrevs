{"files":[{"patch":"@@ -34,0 +34,1 @@\n+import org.junit.jupiter.api.Test;\n@@ -65,0 +66,24 @@\n+    \/**\n+     * Validate an IllegalArgumentException is thrown when the\n+     * combined length of the entry name, entry comment, entry extra data,\n+     * and CEN Header size exceeds 65,535 bytes.\n+     *\/\n+    @ParameterizedTest\n+    @ValueSource(ints = {30000, 35000})\n+    void combinedLengthTest(int length) {\n+        String comment = \"a\".repeat(length);\n+        byte[] bytes = creatExtraData(length);\n+        int combinedLength = ENTRY_NAME.length() + comment.length() + bytes.length;\n+        boolean expectException = combinedLength > MAX_COMBINED_CEN_HEADER_SIZE;\n+        System.out.printf(\"Combined Len= %s, exception: %s%n\", combinedLength, expectException);\n+        ZipEntry zipEntry = new ZipEntry(ENTRY_NAME);\n+        zipEntry.setComment(comment);\n+        \/\/ The extra data length will trigger the IllegalArgumentException\n+        if (expectException) {\n+            assertThrows(IllegalArgumentException.class, () ->\n+                    zipEntry.setExtra(bytes));\n+        } else {\n+            zipEntry.setExtra(bytes);\n+        }\n+    }\n+\n","filename":"test\/jdk\/java\/util\/zip\/ZipEntry\/MaxZipEntryFieldSizeTest.java","additions":25,"deletions":0,"binary":false,"changes":25,"status":"modified"}]}