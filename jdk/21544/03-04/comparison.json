{"files":[{"patch":"@@ -106,1 +106,1 @@\n-     * and {@linkplain #CENHDR CEN Header size} exceeds 65,535 bytes.\n+     * and the {@linkplain #CENHDR CEN Header size} exceeds 65,535 bytes.\n@@ -527,1 +527,1 @@\n-     * the {@linkplain #getComment() entry comment}, and\n+     * the {@linkplain #getComment() entry comment}, and the\n@@ -652,2 +652,2 @@\n-     * of the specified entry comment, {@linkplain #getName() entry name},\n-     * the {@linkplain #getExtra() extra field data}, and\n+     * of the specified entry comment, the {@linkplain #getName() entry name},\n+     * the {@linkplain #getExtra() extra field data}, and the\n@@ -723,1 +723,1 @@\n-    private static  boolean isCENHeaderValid(String name, byte[] extra, String comment) {\n+     static boolean isCENHeaderValid(String name, byte[] extra, String comment) {\n@@ -726,2 +726,2 @@\n-        int headerSize = CENHDR + name.length() + clen + elen;\n-        return headerSize <= MAX_COMBINED_CEN_HEADER_SIZE ? true : false;\n+        long headerSize = (long)CENHDR + name.length() + clen + elen;\n+        return headerSize <= MAX_COMBINED_CEN_HEADER_SIZE;\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipEntry.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+import static java.util.zip.ZipEntry.isCENHeaderValid;\n@@ -268,4 +269,1 @@\n-        int clen = e.comment == null ? 0 : e.comment.length();\n-        int elen = e.extra == null ? 0 : e.extra.length;\n-        int headerSize = CENHDR + e.name.length() + clen + elen;\n-        if (headerSize > 0xFFFF ) {\n+        if (!isCENHeaderValid(e.name, e.extra, e.comment) ) {\n@@ -625,1 +623,1 @@\n-        int headerSize = CENHDR + nlen + clen + elen;\n+        long headerSize = (long)CENHDR + nlen + clen + elen;\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipOutputStream.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"}]}