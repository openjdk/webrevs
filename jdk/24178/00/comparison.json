{"files":[{"patch":"@@ -432,0 +432,8 @@\n+\n+NO_TRANSITION(jboolean, jfr_is_product(JNIEnv* env, jclass jvm))\n+#ifdef PRODUCT\n+  return true;\n+#else\n+  return false;\n+#endif\n+NO_TRANSITION_END\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethod.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -170,0 +170,2 @@\n+jboolean JNICALL jfr_is_product(JNIEnv* env, jclass jvm);\n+\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethod.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -103,1 +103,2 @@\n-      (char*)\"nanosNow\", (char*)\"()J\", (void*)jfr_nanos_now\n+      (char*)\"nanosNow\", (char*)\"()J\", (void*)jfr_nanos_now,\n+      (char*)\"isProduct\", (char*)\"()Z\", (void*)jfr_is_product\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethodRegistration.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -678,0 +678,7 @@\n+\n+    \/**\n+     * Returns whether the current build is a product build.\n+     *\n+     * @return {@code true} if this is a product build, {@code false} otherwise.\n+     *\/\n+    public static native boolean isProduct();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/JVM.java","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+import jdk.jfr.internal.JVM;\n@@ -54,2 +55,3 @@\n-        \/\/ Uncomment when developing new queries for the view command\n-        commands.add(new Query());\n+        if (!JVM.isProduct()) {\n+            commands.add(new Query());\n+        }\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/Command.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -97,0 +97,6 @@\n+        p.println();\n+        p.println(\"************************************ WARNING ******************************************\");\n+        p.println(\"The query command is only available in debug builds and is targeted towards OpenJDK\");\n+        p.println(\"developers. The tool may be removed or its syntax changed at any time.\");\n+        p.println(\"***************************************************************************************\");\n+        p.println();\n@@ -102,1 +108,1 @@\n-        list.add(\"[--verbose] [--width <integer>] <query> <file>\");\n+        list.add(\"[--verbose] [--width <integer>] <query> <file> (in debug builds)\");\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/Query.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"}]}