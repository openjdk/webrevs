{"files":[{"patch":"@@ -713,0 +713,3 @@\n+    if (!THREAD->has_last_Java_frame()) {\n+        JVMCI_THROW_MSG_0(IllegalStateException, err_msg(\"Cannot call getJObjectValue without Java frame anchor\"));\n+    }\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompilerToVM.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -928,5 +928,7 @@\n-     * Gets the {@code jobject} value wrapped by {@code peerObject}. The returned \"naked\" value is\n-     * a JNI local reference, which is valid for the duration of a JVMCI shared library call. This\n-     * method must only be called from within the JVMCI shared library.\n-     * @param peerObject a reference to an object in the peer runtime\n-     * @return the {@code jobject} value wrapped by {@code peerObject}\n+     * Gets the {@code jobject} value wrapped by {@code peerObject}. The returned value is\n+     * a JNI local reference whose lifetime is scoped by the nearest Java caller (from\n+     * HotSpot's perspective). The current thread's state must be {@code _thread_in_native}.\n+     * A call from the JVMCI shared library (e.g. libgraal) is in such a state.\n+     *\n+     * @param peerObject a reference to an object in the HotSpot heap\n+     * @return the {@code jobject} value unpacked from {@code peerObject}\n@@ -934,1 +936,1 @@\n-     *             {@code peerObject} is not a peer object reference\n+     *             {@code peerObject} is not a HotSpot heap object reference\n@@ -936,0 +938,2 @@\n+     *         or if there is no Java caller frame on the stack\n+     *         (i.e., JavaThread::has_last_Java_frame returns false)\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk\/vm\/ci\/hotspot\/HotSpotJVMCIRuntime.java","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"}]}