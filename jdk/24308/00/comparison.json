{"files":[{"patch":"@@ -2134,0 +2134,9 @@\n+WB_ENTRY(jint, WB_GetArchiveRelocationMode(JNIEnv* env, jobject wb))\n+#if INCLUDE_CDS\n+  return (jint)ArchiveRelocationMode;\n+#else\n+  ShouldNotReachHere();\n+  return (jint)-1;\n+#endif\n+WB_END\n+\n@@ -2926,0 +2935,1 @@\n+  {CC\"getArchiveRelocationMode\",          CC\"()I\",    (void*)&WB_GetArchiveRelocationMode},\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -33,0 +33,1 @@\n+ * @build jdk.test.whitebox.WhiteBox\n@@ -34,1 +35,2 @@\n- * @run driver ArchiveRelocationTest\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller -jar WhiteBox.jar jdk.test.whitebox.WhiteBox\n+ * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI -Xbootclasspath\/a:.\/WhiteBox.jar ArchiveRelocationTest\n@@ -39,0 +41,1 @@\n+import jdk.test.whitebox.WhiteBox;\n@@ -42,0 +45,1 @@\n+    static int relocationMode = -1;\n@@ -43,0 +47,2 @@\n+        WhiteBox wb = WhiteBox.getWhiteBox();\n+        relocationMode = wb.getArchiveRelocationMode();\n@@ -77,3 +83,2 @@\n-                    if (run_reloc) {\n-                        output.shouldContain(\"ArchiveRelocationMode == 1: always map archive(s) at an alternative address\")\n-                              .shouldContain(\"Try to map archive(s) at an alternative address\");\n+                    if (run_reloc && relocationMode != 0 \/* ArchiveRelocationMode could be set via -javaoptions *\/) {\n+                        output.shouldContain(\"Try to map archive(s) at an alternative address\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/ArchiveRelocationTest.java","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+import jdk.test.whitebox.WhiteBox;\n@@ -45,0 +46,1 @@\n+    static int relocationMode = -1;\n@@ -46,0 +48,2 @@\n+        WhiteBox wb = WhiteBox.getWhiteBox();\n+        relocationMode = wb.getArchiveRelocationMode();\n@@ -107,1 +111,1 @@\n-                    if (dump_top_reloc) {\n+                    if (dump_top_reloc && relocationMode != 0 \/* ArchiveRelocationMode could be set via -javaoptions *\/) {\n@@ -120,1 +124,1 @@\n-                    if (run_reloc) {\n+                    if (run_reloc && relocationMode != 0 \/* ArchiveRelocationMode could be set via -javaoptions *\/) {\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/DynamicArchiveRelocationTest.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -731,0 +731,1 @@\n+  public native int     getArchiveRelocationMode();\n","filename":"test\/lib\/jdk\/test\/whitebox\/WhiteBox.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}