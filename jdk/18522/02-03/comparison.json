{"files":[{"patch":"@@ -1122,0 +1122,10 @@\n+        @Override\n+        public Set<K> keySet() {\n+            return Set.of(k0);\n+        }\n+\n+        @Override\n+        public Collection<V> values() {\n+            return List.of(v0);\n+        }\n+\n@@ -1330,0 +1340,53 @@\n+        @Override\n+        public Set<K> keySet() {\n+            Set<K> ks = keySet;\n+            if (ks == null) {\n+                ks = new AbstractImmutableSet<>() {\n+                    @Override\n+                    public int size() {\n+                        return MapN.this.size;\n+                    }\n+\n+                    @Override\n+                    public Iterator<K> iterator() {\n+                        return new KeyIterator();\n+                    }\n+\n+                    @Override\n+                    public int hashCode() {\n+                        int hash = 0;\n+                        for (int i = 0; i < table.length; i += 2) {\n+                            Object k = table[i];\n+                            if (k != null) {\n+                                hash += k.hashCode();\n+                            }\n+                        }\n+                        return hash;\n+                    }\n+                };\n+                keySet = ks;\n+            }\n+            return ks;\n+        }\n+\n+        @Override\n+        public Collection<V> values() {\n+            Collection<V> vals = values;\n+            if (vals == null) {\n+                vals = new AbstractImmutableCollection<>() {\n+                    @Override\n+                    public int size() {\n+                        return MapN.this.size;\n+                    }\n+\n+                    @Override\n+                    public Iterator<V> iterator() {\n+                        return new ValueIterator();\n+                    }\n+                };\n+                values = vals;\n+            }\n+            return vals;\n+        }\n+\n+\n","filename":"src\/java.base\/share\/classes\/java\/util\/ImmutableCollections.java","additions":63,"deletions":0,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -357,0 +357,3 @@\n+        testEmptyCollMutatorsAlwaysThrow(Map.of().entrySet());\n+        testEmptyCollMutatorsAlwaysThrow(Map.of().keySet());\n+        testEmptyCollMutatorsAlwaysThrow(Map.of().values());\n@@ -373,0 +376,3 @@\n+            testCollMutatorsAlwaysThrow(map.entrySet(), Map.entry(42, 43));\n+            testCollMutatorsAlwaysThrow(map.keySet());\n+            testCollMutatorsAlwaysThrow(map.values());\n@@ -535,0 +541,4 @@\n+      testCollMutatorsAlwaysThrow(c, ABSENT_VALUE);\n+    }\n+\n+    private static <T> void testCollMutatorsAlwaysThrow(Collection<T> c, T t) {\n@@ -537,1 +547,1 @@\n-                () -> c.remove(ABSENT_VALUE),\n+                () -> c.remove(t),\n@@ -549,1 +559,1 @@\n-    private static void testEmptyCollMutatorsAlwaysThrow(Collection<Integer> c) {\n+    private static void testEmptyCollMutatorsAlwaysThrow(Collection<?> c) {\n@@ -1331,0 +1341,1 @@\n+        check(Set.copyOf(m.keySet()).hashCode() == m.keySet().hashCode());\n","filename":"test\/jdk\/java\/util\/Collection\/MOAT.java","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -504,30 +504,0 @@\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetAddAllDisallowed() {\n-        Map.of().entrySet().addAll(List.of());\n-    }\n-\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetClearDisallowed() {\n-        Map.of().entrySet().clear();\n-    }\n-\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetRemoveDisallowed() {\n-        Map.of().entrySet().remove(\"x\");\n-    }\n-\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetRemoveIfDisallowed() {\n-        Map.of().entrySet().removeIf(x -> false);\n-    }\n-\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetRemoveAllDisallowed() {\n-        Map.of().entrySet().removeAll(List.of());\n-    }\n-\n-    @Test(expectedExceptions=UnsupportedOperationException.class)\n-    public void immutableEntrySetRetainAllDisallowed() {\n-        Map.of().entrySet().retainAll(List.of());\n-    }\n-\n","filename":"test\/jdk\/java\/util\/Map\/MapFactories.java","additions":0,"deletions":30,"binary":false,"changes":30,"status":"modified"}]}