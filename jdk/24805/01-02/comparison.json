{"files":[{"patch":"@@ -75,0 +75,1 @@\n+import javax.swing.event.HyperlinkListener;\n@@ -101,1 +102,2 @@\n- * provides richer formatting options.\n+ * provides richer formatting options. {@link Builder#addHyperlinkListener}\n+ * can be called to add a listener to hyperlinks inside the HTML.\n@@ -129,5 +131,0 @@\n- * <p id=\"addButton\">\n- * If you call {@link Builder#addButton(JButton)}, a new button will be added\n- * to the left side of the <i>Pass<\/i> button. This allows some customized\n- * actions to be performed. The method can be called multiple times.\n- *\n@@ -608,1 +605,1 @@\n-                                         builder.moreButtons,\n+                                         builder.hyperlinkListener,\n@@ -630,1 +627,1 @@\n-                                                       List<JButton> moreButtons,\n+                                                       HyperlinkListener hyperlinkListener,\n@@ -643,0 +640,3 @@\n+        if (hyperlinkListener != null && text instanceof JEditorPane ep) {\n+            ep.addHyperlinkListener(hyperlinkListener);\n+        }\n@@ -646,0 +646,1 @@\n+        text.getCaret().setVisible(false);\n@@ -667,6 +668,0 @@\n-        if (moreButtons != null) {\n-            for (JButton title : moreButtons) {\n-                buttonsPanel.add(title);\n-            }\n-        }\n-\n@@ -1382,1 +1377,1 @@\n-        private List<JButton> moreButtons;\n+        HyperlinkListener hyperlinkListener;\n@@ -1464,1 +1459,1 @@\n-         * Adds one more button to the left of the \"pass\" button.\n+         * Set the HyperlinkListener of links inside the instructions pane.\n@@ -1466,1 +1461,1 @@\n-         * @param button the new button\n+         * @param hyperlinkListener the listener\n@@ -1469,3 +1464,2 @@\n-        public Builder addButton(JButton button) {\n-            if (moreButtons == null) moreButtons = new ArrayList<>();\n-            moreButtons.add(button);\n+        public Builder addHyperlinkListener(HyperlinkListener hyperlinkListener) {\n+            this.hyperlinkListener = hyperlinkListener;\n","filename":"test\/jdk\/java\/awt\/regtesthelpers\/PassFailJFrame.java","additions":14,"deletions":20,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+import javax.swing.event.HyperlinkEvent;\n@@ -41,1 +42,1 @@\n-    static int counter = 0;\n+    static JLabel label;\n@@ -44,0 +45,1 @@\n+\n@@ -47,35 +49,33 @@\n-        final String[] titles = {\n-                \"Copy first command\",\n-                \"Copy second command\",\n-                \"Copy third command\"\n-        };\n-\n-        final String[] commands = {\n-                keytool + \" -genkeypair\",\n-                keytool + \" -genkeypair | type\",\n-                \"(echo changeit & echo changeit ) | \" + keytool + \" -genkeypair\"\n-        };\n-\n-        final String message = \"\"\"\n-                Perform the following steps and record the final result:\n-\n-                1. Open a terminal or Windows Command Prompt window.\n-\n-                2. Press \"Copy First Command\" to copy the first command into the system clipboard.\n-                   Paste it into the terminal window and execute the command.\n-\n-                   When prompted, enter some characters and press Enter. Verify that the input is\n-                   hidden, and no warning about password echoing appears. Press Ctrl-C to exit.\n-\n-                3. Press \"Copy Second Command\" to copy the second command into the system clipboard.\n-                   Paste it into the terminal window and execute the command.\n-\n-                   When prompted, enter some characters and press Enter. Verify that the input is\n-                   echoed, and a warning about password echoing is shown. Press Ctrl-C to exit.\n-\n-                4. Press \"Copy Third Command\" to copy the third command into the system clipboard.\n-                   Paste it into the terminal window and execute the command.\n-\n-                   Verify that the password \"changeit\" is not shown in the command output, and\n-                   no warning about password echoing appears. It's OK to see an exception.\n-\n+        final String firstCommand = keytool + \" -genkeypair\";\n+        final String secondCommand = keytool + \" -genkeypair | type\";\n+        final String thirdCommand = \"(echo changeit & echo changeit ) | \" + keytool + \" -genkeypair\";\n+\n+        final String message = String.format(\"\"\"\n+                <html>Perform the following steps and record the final result:\n+                <ol>\n+                <li>Open a terminal or Windows Command Prompt window.\n+\n+                <li>Click <a href='First'>Copy First Command<\/a> to copy the following command into\n+                the system clipboard. Paste it into the terminal window and execute the command.\n+                <pre>\n+                %s\n+                <\/pre>\n+                When prompted, enter some characters and press Enter. Verify that the input is\n+                hidden, and no warning about password echoing appears. Press Ctrl-C to exit.\n+\n+                <li>Click <a href='Second'>Copy Second Command<\/a> to copy the following command into\n+                the system clipboard. Paste it into the terminal window and execute the command.\n+                <pre>\n+                %s\n+                <\/pre>\n+                When prompted, enter some characters and press Enter. Verify that the input is\n+                echoed, and a warning about password echoing is shown. Press Ctrl-C to exit.\n+\n+                <li>Click <a href='Third'>Copy Third Command<\/a> to copy the following command into\n+                the system clipboard. Paste it into the terminal window and execute the command.\n+                <pre>\n+                %s\n+                <\/pre>\n+                Verify that the password \"changeit\" is not shown in the command output, and\n+                no warning about password echoing appears. It's OK to see an exception.\n+                <\/ol>\n@@ -83,9 +83,1 @@\n-                \"\"\";\n-\n-        var copyButton = new JButton(\"Copy First Command\");\n-        copyButton.addActionListener(_ -> {\n-            Toolkit.getDefaultToolkit().getSystemClipboard().setContents(\n-                    new StringSelection(commands[counter]), null);\n-            counter = (counter + 1) % titles.length;\n-            copyButton.setText(titles[counter]);\n-        });\n+                \"\"\", firstCommand, secondCommand, thirdCommand);\n@@ -95,2 +87,19 @@\n-                .columns(60)\n-                .addButton(copyButton)\n+                .addHyperlinkListener(e -> {\n+                    if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {\n+                        Toolkit.getDefaultToolkit().getSystemClipboard().setContents(\n+                                new StringSelection(switch (e.getDescription()) {\n+                                    case \"First\" -> firstCommand;\n+                                    case \"Second\" -> secondCommand;\n+                                    default -> thirdCommand;\n+                                }), null);\n+                        label.setText(e.getDescription() + \" command copied\");\n+                        if (e.getSource() instanceof JEditorPane ep) {\n+                            ep.getCaret().setVisible(false);\n+                        }\n+                    }\n+                })\n+                .columns(100)\n+                .splitUIBottom(() -> {\n+                    label = new JLabel(\"Status\");\n+                    return label;\n+                })\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/EchoPassword.java","additions":56,"deletions":47,"binary":false,"changes":103,"status":"modified"}]}