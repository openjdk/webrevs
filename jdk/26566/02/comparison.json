{"files":[{"patch":"@@ -688,2 +688,0 @@\n-                    \/\/ 8313657 socket is not closed until GC is run\n-                    closeOpenedSocket(sock);\n@@ -708,1 +706,0 @@\n-                    sock = null;\n@@ -735,6 +732,0 @@\n-        try {\n-            outStream.close();\n-        } catch (IOException ioEx) {\n-            if (debug)\n-                System.err.println(\"Connection.closeOutputStream: OutputStream close problem \" + ioEx);\n-        }\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/Connection.java","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -464,0 +464,1 @@\n+                    closeOpenedResource();\n@@ -469,0 +470,1 @@\n+                        closeOpenedResource();\n@@ -480,0 +482,17 @@\n+    \/\/ 8313657 socket is not closed until GC is run\n+    private void closeOpenedResource() {\n+        try {\n+            if (conn != null) {\n+                if (conn.outStream != null) {\n+                    conn.outStream.close();\n+                }\n+\n+                if (conn.sock != null && !conn.sock.isClosed()) {\n+                    conn.sock.close();\n+                }\n+            }\n+        } catch (IOException ioEx) {\n+            \/\/ignore the error;\n+        }\n+    }\n+\n@@ -492,0 +511,1 @@\n+        closeOpenedResource();\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/LdapClient.java","additions":20,"deletions":0,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -68,0 +68,1 @@\n+        props.put(\"com.sun.jndi.ldap.connect.timeout\", 100+\"\");\n@@ -144,13 +145,0 @@\n-        private LdapOutputStream output = new LdapOutputStream();\n-        private LdapInputStream input = new LdapInputStream();\n-\n-        public void connect(SocketAddress address, int timeout) {\n-        }\n-\n-        public InputStream getInputStream() {\n-            return input;\n-        }\n-\n-        public OutputStream getOutputStream() {\n-            return output;\n-        }\n","filename":"test\/jdk\/com\/sun\/jndi\/ldap\/SocketCloseTest.java","additions":1,"deletions":13,"binary":false,"changes":14,"status":"modified"}]}