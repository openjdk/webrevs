{"files":[{"patch":"@@ -200,1 +200,0 @@\n-java\/awt\/event\/MouseEvent\/SpuriousExitEnter\/SpuriousExitEnter_3.java 6854300 generic-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2010, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,2 +52,12 @@\n-import java.awt.*;\n-import java.awt.event.*;\n+import java.awt.BorderLayout;\n+import java.awt.Button;\n+import java.awt.Component;\n+import java.awt.EventQueue;\n+import java.awt.Frame;\n+import java.awt.Point;\n+import java.awt.Robot;\n+import java.awt.Window;\n+import java.awt.event.MouseAdapter;\n+import java.awt.event.MouseEvent;\n+import java.lang.reflect.InvocationTargetException;\n+\n@@ -55,1 +65,3 @@\n-import javax.swing.*;\n+\n+import javax.swing.JButton;\n+import javax.swing.JFrame;\n@@ -58,32 +70,46 @@\n-    static JFrame frame = new JFrame(\"SpuriousExitEnter_3_LW\");\n-    static JButton jbutton = new JButton(\"jbutton\");\n-    static Frame frame1 = new Frame(\"SpuriousExitEnter_3_HW\");\n-    static Button button1 = new Button(\"button\");\n-\n-    static EnterExitAdapter frameAdapter;\n-    static EnterExitAdapter buttonAdapter;\n-    static Robot r = Util.createRobot();\n-\n-    public static void testCase(Window w, Component comp) {\n-        frameAdapter = new EnterExitAdapter(w);\n-        buttonAdapter = new EnterExitAdapter(comp);\n-\n-        w.addMouseListener(frameAdapter);\n-        comp.addMouseListener(buttonAdapter);\n-\n-        w.setSize(200, 200);\n-        w.add(comp, BorderLayout.NORTH);\n-        w.setLocationRelativeTo(null);\n-        w.setVisible(true);\n-\n-        Point centerA = new Point(comp.getLocationOnScreen().x + comp.getWidth() \/ 2,\n-                                  comp.getLocationOnScreen().y + comp.getHeight() \/ 2);\n-        Point centerB = new Point(w.getLocationOnScreen().x + w.getWidth() \/ 2,\n-                                  w.getLocationOnScreen().y + w.getHeight() \/ 2);\n-        \/\/for moving from A outside: don't cross the A area. Move straight to the right.\n-        Point centerC_1 = new Point(w.getLocationOnScreen().x + w.getWidth() + 20,  \/\/go right off the border\n-                                    comp.getLocationOnScreen().y + comp.getHeight() \/ 2); \/\/don't cross the A area!\n-\n-        \/\/for moving from B outside: don't cross the B area. Move straight to the bottom.\n-        Point centerC_2 = new Point(w.getLocationOnScreen().x + w.getWidth() \/ 2,\n-                                    w.getLocationOnScreen().y + w.getHeight() + 20); \/\/go below the bottom border\n+    static JFrame frame;\n+    static JButton jbutton;\n+\n+    static Frame frame1;\n+    static Button button1;\n+\n+    static final Robot r = Util.createRobot();\n+\n+    static volatile EnterExitAdapter frameAdapter;\n+    static volatile EnterExitAdapter buttonAdapter;\n+    static volatile Point centerA;\n+    static volatile Point centerB;\n+    static volatile Point centerC_1 ;\n+    static volatile Point centerC_2;\n+\n+    public static void testCase(Window w, Component comp) throws InterruptedException, InvocationTargetException {\n+        EventQueue.invokeAndWait(()-> {\n+            frameAdapter = new EnterExitAdapter(w);\n+            buttonAdapter = new EnterExitAdapter(comp);\n+\n+            w.addMouseListener(frameAdapter);\n+            comp.addMouseListener(buttonAdapter);\n+\n+            w.setSize(200, 200);\n+            w.add(comp, BorderLayout.NORTH);\n+            w.setLocationRelativeTo(null);\n+            w.setVisible(true);\n+        });\n+\n+        r.waitForIdle();\n+        r.delay(1000);\n+\n+        EventQueue.invokeAndWait(()-> {\n+            centerA = new Point(comp.getLocationOnScreen().x + comp.getWidth() \/ 2,\n+                    comp.getLocationOnScreen().y + comp.getHeight() \/ 2);\n+            centerB = new Point(w.getLocationOnScreen().x + w.getWidth() \/ 2,\n+                    w.getLocationOnScreen().y + w.getHeight() \/ 2);\n+            \/\/for moving from A outside: don't cross the A area. Move straight to the right.\n+            centerC_1 = new Point(w.getLocationOnScreen().x + w.getWidth() + 20,  \/\/go right off the border\n+                    comp.getLocationOnScreen().y + comp.getHeight() \/ 2); \/\/don't cross the A area!\n+\n+            \/\/for moving from B outside: don't cross the B area. Move straight to the bottom.\n+            centerC_2 = new Point(w.getLocationOnScreen().x + w.getWidth() \/ 2,\n+                    w.getLocationOnScreen().y + w.getHeight() + 20); \/\/go below the bottom border\n+        });\n+\n@@ -121,6 +147,17 @@\n-    public static void main(String []s)\n-    {\n-        \/\/LW case:\n-        testCase(frame, jbutton);\n-        \/\/HW case\n-        testCase(frame1, button1);\n+\n+    public static void main(String []s) throws InterruptedException, InvocationTargetException {\n+        EventQueue.invokeAndWait(() -> {\n+            frame = new JFrame(\"SpuriousExitEnter_3_LW\");\n+            jbutton = new JButton(\"jbutton\");\n+\n+            frame1 = new Frame(\"SpuriousExitEnter_3_HW\");\n+            button1  = new Button(\"button\");\n+        });\n+\n+        try {\n+            testCase(frame,  jbutton); \/\/LW case\n+            testCase(frame1, button1); \/\/HW case\n+        } finally {\n+            EventQueue.invokeLater(frame::dispose);\n+            EventQueue.invokeLater(frame1::dispose);\n+        }\n@@ -153,3 +190,3 @@\n-    private Component target;\n-    private int enteredEventCount = 0;\n-    private int exitedEventCount = 0;\n+    private final Component target;\n+    private volatile int enteredEventCount = 0;\n+    private volatile int exitedEventCount = 0;\n@@ -173,1 +210,1 @@\n-        System.out.println(\"Zeroeing on \" +target.getClass().getName());\n+        System.out.println(\"Zeroing on \" +target.getClass().getName());\n","filename":"test\/jdk\/java\/awt\/event\/MouseEvent\/SpuriousExitEnter\/SpuriousExitEnter_3.java","additions":83,"deletions":46,"binary":false,"changes":129,"status":"modified"}]}