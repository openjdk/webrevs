{"files":[{"patch":"@@ -215,1 +215,3 @@\n-            allocationSize = alignedSize;\n+            \/\/ always allocate at least 'byteAlignment' bytes, so that malloc is guaranteed to \n+            \/\/ return a pointer aligned to that alignment, for cases where byteAlignment > alignedSize\n+            allocationSize = Math.max(alignedSize, byteAlignment);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/SegmentFactories.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -63,1 +63,1 @@\n-            MemorySegment segment = arena.allocate(aligned);;\n+            MemorySegment segment = arena.allocate(aligned);\n@@ -65,0 +65,6 @@\n+\n+            \/\/ Allocate another segment and fill it with data to\n+            \/\/ check that the first segment is not overwritten\n+            MemorySegment nextSegment = arena.allocate(aligned);\n+            vh.set(nextSegment, 0L, 0xffffff);\n+\n","filename":"test\/jdk\/java\/foreign\/TestMemoryAlignment.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"}]}