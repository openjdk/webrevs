{"files":[{"patch":"@@ -206,2 +206,2 @@\n-        if (byteAlignment > MAX_MALLOC_ALIGN) {\n-            allocationSize = alignedSize + byteAlignment - MAX_MALLOC_ALIGN;\n+        if (byteAlignment > MAX_MALLOC_ALIGN || alignedSize % byteAlignment != 0) {\n+            allocationSize = alignedSize + byteAlignment - Math.min(MAX_MALLOC_ALIGN, alignedSize);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/SegmentFactories.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -63,1 +63,1 @@\n-            MemorySegment segment = arena.allocate(aligned);;\n+            MemorySegment segment = arena.allocate(aligned);\n@@ -65,0 +65,6 @@\n+\n+            \/\/ Allocate another segment and fill it with data to\n+            \/\/ check that the first segment is not overwritten\n+            MemorySegment nextSegment = arena.allocate(aligned);\n+            vh.set(nextSegment, 0L, 0xffffff);\n+\n","filename":"test\/jdk\/java\/foreign\/TestMemoryAlignment.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"}]}