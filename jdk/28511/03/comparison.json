{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,0 +34,1 @@\n+import java.util.stream.Collectors;\n@@ -368,0 +369,8 @@\n+        List<String> disabledSuites = null;\n+        List<String> unAvailableSuites = null;\n+\n+        if (SSLLogger.isOn() && SSLLogger.isOn(\"ssl,sslctx\")) {\n+            disabledSuites = new ArrayList<>();\n+            unAvailableSuites = new ArrayList<>();\n+        }\n+\n@@ -371,0 +380,4 @@\n+                    if (SSLLogger.isOn() &&\n+                            SSLLogger.isOn(\"ssl,sslctx\")) {\n+                        unAvailableSuites.add(suite.name);\n+                    }\n@@ -373,2 +386,0 @@\n-\n-                boolean isSupported = false;\n@@ -385,1 +396,1 @@\n-                        isSupported = true;\n+\n@@ -387,3 +398,2 @@\n-                            SSLLogger.isOn(\"ssl,sslctx,verbose\")) {\n-                        SSLLogger.fine(\n-                                \"Ignore disabled cipher suite: \" + suite.name);\n+                            SSLLogger.isOn(\"ssl,sslctx\")) {\n+                        disabledSuites.add(suite.name);\n@@ -391,1 +401,0 @@\n-\n@@ -394,6 +403,0 @@\n-\n-                if (!isSupported && SSLLogger.isOn() &&\n-                        SSLLogger.isOn(\"ssl,sslctx,verbose\")) {\n-                    SSLLogger.finest(\n-                            \"Ignore unsupported cipher suite: \" + suite);\n-                }\n@@ -403,0 +406,9 @@\n+        if(SSLLogger.isOn() && SSLLogger.isOn(\"ssl,sslctx\")) {\n+            logSuites(\"Ignore disabled cipher suites for protocols: \",\n+                    protocols, disabledSuites);\n+            logSuites(\"Ignore unavailable cipher suites for protocols: \",\n+                    protocols, unAvailableSuites);\n+            logSuites(\"Available cipher suites for protocols: \",\n+                    protocols, suites);\n+\n+        }\n@@ -406,0 +418,15 @@\n+    private static void logSuites(String message,\n+                                  List<ProtocolVersion> protocols,\n+                                  Collection<?> suites) {\n+        if (suites.isEmpty()) {\n+            return;\n+        }\n+        String protocolStr = protocols.stream()\n+                .map(pv -> pv.name)\n+                .collect(Collectors.joining(\", \", \"[\", \"]\"));\n+        String suiteStr = String.join(\", \",\n+            suites.stream().map(Object::toString).collect(Collectors.toList()));\n+        SSLLogger.finest(message + protocolStr + System.lineSeparator() +\n+                Utilities.wrapText(\"[\" + suiteStr + \"]\", 140));\n+    }\n+\n@@ -459,1 +486,6 @@\n-\n+            if (cipherSuites.isEmpty() && SSLLogger.isOn()\n+                    && SSLLogger.isOn(\"ssl,sslctx\")) {\n+                SSLLogger.fine(\n+                        \"No cipher suites satisfy property: \" + propertyName +\n+                                \". Returning empty list\");\n+            }\n@@ -462,1 +494,0 @@\n-\n@@ -530,3 +561,0 @@\n-        private static final List<CipherSuite> supportedCipherSuites;\n-        private static final List<CipherSuite> serverDefaultCipherSuites;\n-\n@@ -550,5 +578,0 @@\n-\n-            supportedCipherSuites = getApplicableSupportedCipherSuites(\n-                    supportedProtocols);\n-            serverDefaultCipherSuites = getApplicableEnabledCipherSuites(\n-                    serverDefaultProtocols, false);\n@@ -557,0 +580,7 @@\n+        private static final LazyConstant<List<CipherSuite>>\n+                supportedCipherSuites = LazyConstant.of(() ->\n+                getApplicableSupportedCipherSuites(supportedProtocols));\n+        private static final LazyConstant<List<CipherSuite>>\n+                serverDefaultCipherSuites = LazyConstant.of(() ->\n+                getApplicableEnabledCipherSuites(serverDefaultProtocols, false));\n+\n@@ -564,1 +594,1 @@\n-            return supportedCipherSuites;\n+            return supportedCipherSuites.get();\n@@ -574,1 +604,1 @@\n-            return serverDefaultCipherSuites;\n+            return serverDefaultCipherSuites.get();\n@@ -814,4 +844,12 @@\n-                serverDefaultCipherSuites =\n-                        getApplicableEnabledCipherSuites(\n-                                serverDefaultProtocols, false);\n-\n+                \/\/ getApplicableEnabledCipherSuites returns same CS List if\n+                \/\/ no customized CS in use and protocols are same. Can avoid\n+                \/\/ the getApplicableEnabledCipherSuites call\n+                if (clientCustomizedCipherSuites.isEmpty() &&\n+                        serverCustomizedCipherSuites.isEmpty() &&\n+                        clientDefaultProtocols.equals(serverDefaultProtocols)) {\n+                    serverDefaultCipherSuites = clientDefaultCipherSuites;\n+                } else {\n+                    serverDefaultCipherSuites =\n+                            getApplicableEnabledCipherSuites(\n+                                    serverDefaultProtocols, false);\n+                }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLContextImpl.java","additions":68,"deletions":30,"binary":false,"changes":98,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -171,0 +171,29 @@\n+    static String wrapText(String text, int maxWidth) {\n+        if (text == null || text.isEmpty() || maxWidth <= 0) {\n+            return \"\";\n+        }\n+        StringBuilder result = new StringBuilder();\n+        String[] values = text.split(\",\\\\s*\");\n+        StringBuilder line = new StringBuilder();\n+\n+        for (int i = 0; i < values.length; i++) {\n+            String value = values[i];\n+            \/\/ If adding this value would exceed maxWidth\n+            if (line.length() > 0) {\n+                \/\/ +1 for the comma\n+                if (line.length() + 1 + value.length() > maxWidth) {\n+                    result.append(line).append(LINE_SEP);\n+                    line.setLength(0);\n+                } else {\n+                    line.append(\",\");\n+                }\n+            }\n+            line.append(value);\n+        }\n+        \/\/ Append any remaining line\n+        if (line.length() > 0) {\n+            result.append(line);\n+        }\n+        return result.toString();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/Utilities.java","additions":30,"deletions":1,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2025, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8350582 8340312 8369995 8372004\n+ * @bug 8350582 8340312 8369995 8372004 8371333\n@@ -68,1 +68,5 @@\n-                List.of(\"trigger seeding of SecureRandom\"));\n+                List.of(\"trigger seeding of SecureRandom\",\n+                \/\/ Available list should finish with this style\n+                \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV]\",\n+                \"Ignore disabled cipher suites for protocols: \" +\n+                        \"\\\\[TLSv1.3, TLSv1.2\\\\]\"));\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLLogger\/DebugPropertyValuesTest.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"}]}