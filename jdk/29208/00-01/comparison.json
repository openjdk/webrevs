{"files":[{"patch":"@@ -177,0 +177,24 @@\n+    \/**\n+     * Returns 3 int values.\n+     * xres, yres, resolution as either dpi or dpcm\n+     * The resolution is just a single byte of data.\n+     *\/\n+    public int[] getIntResolutionValue() {\n+        int[] res = {0, 0, 0};\n+        byte[] bufArray = (byte[])myValue;\n+        if (bufArray != null) {\n+            int nBytes = 4; \/\/ 32-bit signed integer\n+            for (int j=0; j<2; j++) { \/\/ 2 set of integers\n+                byte[] intBytes = new byte[nBytes];\n+                \/\/ REMIND: # bytes should be 8\n+                for (int i=0; i< nBytes; i++) {\n+                    \/\/+ 1 because the 1st byte is length\n+                    intBytes[i] = bufArray[i+(4*j)+1];\n+                }\n+                res[j] = convertToInt(intBytes);\n+            }\n+            res[2] = (int)bufArray[9];\n+        }\n+        return res;\n+    }\n+\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/AttributeClass.java","additions":24,"deletions":0,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -1699,1 +1699,1 @@\n-                rawResolutions = attribClass.getIntRangeValue();\n+                rawResolutions = attribClass.getIntResolutionValue();\n@@ -1705,1 +1705,1 @@\n-               rawResolutions = new int[] { 300, 300 } ;\n+               rawResolutions = new int[] { 300, 300, 3 } ;\n@@ -1707,1 +1707,1 @@\n-            int numRes = rawResolutions.length \/ 2;\n+            int numRes = rawResolutions.length \/ 3;\n@@ -1709,4 +1709,5 @@\n-            for (int i=0; i < numRes; i++) {\n-                pres[i] =  new PrinterResolution(rawResolutions[i*2],\n-                                                 rawResolutions[i*2+1],\n-                                                 PrinterResolution.DPI);\n+            for (int i = 0; i < numRes; i++) {\n+                int units = (rawResolutions[i*3+2] == 4) ? PrinterResolution.DPCM : PrinterResolution.DPI;\n+                pres[i] =  new PrinterResolution(rawResolutions[i*3],\n+                                                 rawResolutions[i*3+1],\n+                                                 units);\n@@ -1716,3 +1717,1 @@\n-        PrinterResolution []arr = new PrinterResolution[printerResolutions.length];\n-        System.arraycopy(printerResolutions, 0, arr, 0, printerResolutions.length);\n-        return arr;\n+        return printerResolutions.clone();\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/IPPPrintService.java","additions":9,"deletions":10,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -655,0 +655,3 @@\n+    \/\/ IPP value of 3 means DPI, 4 means dpcm\n+    jobject dpi = (*env)->NewObject(env, intCls, intCtr, 3);\n+    CHECK_NULL(dpi);\n@@ -691,0 +694,1 @@\n+          (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n@@ -719,0 +723,1 @@\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n@@ -752,0 +757,1 @@\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n","filename":"src\/java.desktop\/unix\/native\/common\/awt\/CUPSfuncs.c","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"}]}