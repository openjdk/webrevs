{"files":[{"patch":"@@ -177,0 +177,24 @@\n+    \/**\n+     * Returns 3 int values.\n+     * xres, yres, resolution as either dpi or dpcm\n+     * The resolution is just a single byte of data.\n+     *\/\n+    public int[] getIntResolutionValue() {\n+        int[] res = {0, 0, 0};\n+        byte[] bufArray = (byte[])myValue;\n+        if (bufArray != null) {\n+            int nBytes = 4; \/\/ 32-bit signed integer\n+            for (int j=0; j<2; j++) { \/\/ 2 set of integers\n+                byte[] intBytes = new byte[nBytes];\n+                \/\/ REMIND: # bytes should be 8\n+                for (int i=0; i< nBytes; i++) {\n+                    \/\/+ 1 because the 1st byte is length\n+                    intBytes[i] = bufArray[i+(4*j)+1];\n+                }\n+                res[j] = convertToInt(intBytes);\n+            }\n+            res[2] = (int)bufArray[9];\n+        }\n+        return res;\n+    }\n+\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/AttributeClass.java","additions":24,"deletions":0,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -144,1 +144,1 @@\n-    private int[] rawResolutions = null;\n+    private int[] ppdResolutions = null;\n@@ -208,2 +208,1 @@\n-                 \/\/ CUPS does not supply printer-resolution attribute\n-        \/\/new PrinterResolution(300, 300, PrinterResolution.DPI),\n+        new PrinterResolution(300, 300, PrinterResolution.DPI),\n@@ -470,1 +469,3 @@\n-                        rawResolutions = cps.getRawResolutions();\n+                        if (ppdResolutions == null) {\n+                            ppdResolutions = cps.getRawResolutions();\n+                        }\n@@ -824,8 +825,1 @@\n-            PrinterResolution[] supportedRes = getPrintResolutions();\n-            if (supportedRes == null) {\n-                return null;\n-            }\n-            PrinterResolution []arr =\n-                new PrinterResolution[supportedRes.length];\n-            System.arraycopy(supportedRes, 0, arr, 0, supportedRes.length);\n-            return arr;\n+            return getPrintResolutions();\n@@ -1140,2 +1134,0 @@\n-        \/\/ CUPS does not report printer resolution via IPP but it\n-        \/\/ may be gleaned from the PPD.\n@@ -1267,1 +1259,0 @@\n-\n@@ -1687,3 +1678,1 @@\n-                return supportedRes[0];\n-             } else {\n-                 return new PrinterResolution(300, 300, PrinterResolution.DPI);\n+                 return supportedRes[0];\n@@ -1700,0 +1689,3 @@\n+    \/* Called only from contexts that have called initAttributes().\n+     * Try IPP first, and if that produces nothing, fall back to the PPD\n+    *\/\n@@ -1701,0 +1693,1 @@\n+        int[] rawResolutions = null;\n@@ -1702,0 +1695,6 @@\n+            AttributeClass attribClass = (getAttMap != null) ?\n+                getAttMap.get(\"printer-resolution-supported\")\n+                : null;\n+            if (attribClass != null) {\n+                rawResolutions = attribClass.getIntResolutionValue();\n+            }\n@@ -1703,10 +1702,1 @@\n-              printerResolutions = new PrinterResolution[0];\n-            } else {\n-                int numRes = rawResolutions.length \/ 2;\n-                PrinterResolution[] pres = new PrinterResolution[numRes];\n-                for (int i=0; i < numRes; i++) {\n-                    pres[i] =  new PrinterResolution(rawResolutions[i*2],\n-                                                     rawResolutions[i*2+1],\n-                                                     PrinterResolution.DPI);\n-                }\n-                printerResolutions = pres;\n+                rawResolutions = ppdResolutions;\n@@ -1714,0 +1704,12 @@\n+            if (rawResolutions == null) {\n+               rawResolutions = new int[] { 300, 300, 3 } ;\n+            }\n+            int numRes = rawResolutions.length \/ 3;\n+            PrinterResolution[] pres = new PrinterResolution[numRes];\n+            for (int i = 0; i < numRes; i++) {\n+                int units = (rawResolutions[i*3+2] == 4) ? PrinterResolution.DPCM : PrinterResolution.DPI;\n+                pres[i] = new PrinterResolution(rawResolutions[i*3],\n+                                                rawResolutions[i*3+1],\n+                                                units);\n+            }\n+            printerResolutions = pres;\n@@ -1715,1 +1717,1 @@\n-        return printerResolutions;\n+        return printerResolutions.clone();\n@@ -1719,1 +1721,2 @@\n-        PrinterResolution[] supportedRes = getPrintResolutions();\n+        PrinterResolution[] supportedRes =\n+            (PrinterResolution[])getSupportedAttributeValues(PrinterResolution.class, null, null);\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/IPPPrintService.java","additions":34,"deletions":31,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -55,0 +55,2 @@\n+typedef ppd_attr_t* (*fn_ppdFindAttr)(ppd_file_t *, const char *name, const char *spec);\n+typedef ppd_attr_t* (*fn_ppdFindNextAttr)(ppd_file_t *, const char *name, const char *spec);\n@@ -67,0 +69,2 @@\n+fn_ppdFindAttr j2d_ppdFindAttr;\n+fn_ppdFindNextAttr j2d_ppdFindNextAttr;\n@@ -155,0 +159,12 @@\n+  j2d_ppdFindAttr = (fn_ppdFindAttr)dlsym(handle, \"ppdFindAttr\");\n+  if (j2d_ppdFindAttr == NULL) {\n+    dlclose(handle);\n+    return JNI_FALSE;\n+  }\n+\n+  j2d_ppdFindNextAttr = (fn_ppdFindNextAttr)dlsym(handle, \"ppdFindNextAttr\");\n+  if (j2d_ppdFindNextAttr == NULL) {\n+    dlclose(handle);\n+    return JNI_FALSE;\n+  }\n+\n@@ -639,0 +655,3 @@\n+    \/\/ IPP value of 3 means DPI, 4 means dpcm\n+    jobject dpi = (*env)->NewObject(env, intCls, intCtr, 3);\n+    CHECK_NULL(dpi);\n@@ -675,0 +694,1 @@\n+          (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n@@ -703,0 +723,35 @@\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n+            }\n+        }\n+\n+    } else {\n+        ppd_attr_t *defresolution = j2d_ppdFindAttr(ppd, \"DefaultResolution\", NULL);\n+        if (defresolution == NULL) {\n+            defresolution = j2d_ppdFindAttr(ppd, \"Resolution\", NULL);\n+        }\n+        if (defresolution != NULL) {\n+            int matches = sscanf(defresolution->value, \"%dx%ddpi\", &defx, &defy);\n+            if (matches == 2) {\n+                if (defx <= 0 || defy <= 0) {\n+                    defx = 0;\n+                    defy = 0;\n+                }\n+            } else {\n+                matches = sscanf(defresolution->value, \"%ddpi\", &defx);\n+                if (matches == 1) {\n+                    if (defx <= 0) {\n+                       defx = 0;\n+                    } else {\n+                       defy = defx;\n+                    }\n+                }\n+            }\n+            if (defx > 0) {\n+              jobject rxObj, ryObj;\n+              rxObj = (*env)->NewObject(env, intCls, intCtr, defx);\n+              CHECK_NULL(rxObj);\n+              ryObj = (*env)->NewObject(env, intCls, intCtr, defy);\n+              CHECK_NULL(ryObj);\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, rxObj);\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, ryObj);\n+              (*env)->CallBooleanMethod(env, arrayList, arrListAddMID, dpi);\n","filename":"src\/java.desktop\/unix\/native\/common\/awt\/CUPSfuncs.c","additions":56,"deletions":1,"binary":false,"changes":57,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2025, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,1 +57,1 @@\n- * @bug 8251928\n+ * @bug 8251928 8375221\n@@ -204,1 +204,3 @@\n-            job.print(attributeSet);\n+            if (job.printDialog(attributeSet)) {\n+                job.print(attributeSet);\n+            }\n","filename":"test\/jdk\/javax\/print\/PrintablePrintDPI.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}