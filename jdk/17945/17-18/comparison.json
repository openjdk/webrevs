{"files":[{"patch":"@@ -32,0 +32,1 @@\n+import java.lang.Object.*;\n@@ -34,8 +35,19 @@\n-        String libraryName = \"awt\";\n-        File awtSharedObjectPathCopy = new File(\"\/test\/lib\/libawt.so\");\n-        File awtSharedObjectPath = new File(\"\/test\/lib\/libawt.so\");\n-        File awtArchivePath = new File(\"\/test\/lib\/libawt.a\");\n-        awtSharedObjectPath.renameTo(awtArchivePath);\n-        if (awtSharedObjectPath.exists()) {\n-            awtSharedObjectPath.renameTo(awtSharedObjectPathCopy);\n-            throw new RuntimeException(\"LoadAIXLibraryFromArchiveObject: .so should not exist.\");\n+        String libraryName = \"dummyarchive\";\n+        String javaHome = System.getProperty(\"java.home\");\n+        File awtSharedObjectPath = new File(javaHome+\"\/lib\/libawt.so\");\n+        File awtArchivePath = new File(javaHome+\"\/lib\/libdummyarchive.a\");\n+        FileInputStream sourceFile = new FileInputStream(awtSharedObjectPath); \n+        FileOutputStream destinationFile = new FileOutputStream(awtArchivePath); \n+        try {\n+            int currentByteToRead;\n+            while ((currentByteToRead = sourceFile.read()) != -1) {\n+                destinationFile.write(currentByteToRead);\n+            }\n+        }\n+        finally {\n+            if (sourceFile != null) {\n+                sourceFile.close();\n+            }\n+            if (destinationFile != null) {\n+                destinationFile.close();\n+            }\n@@ -44,1 +56,3 @@\n-        awtSharedObjectPath.renameTo(awtSharedObjectPathCopy);\n+        if (!awtArchivePath.delete())\n+            throw new RuntimeException(\"LoadLibraryFromArchiveObject: Failed to delete dummy archive file.\");\n+\n","filename":"test\/jdk\/java\/lang\/RuntimeTests\/loadLibrary\/aix\/LoadAIXLibraryFromArchiveObject.java","additions":23,"deletions":9,"binary":false,"changes":32,"status":"modified"}]}