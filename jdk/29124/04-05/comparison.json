{"files":[{"patch":"@@ -308,6 +308,0 @@\n-\/\/ Implementation of \"properties -security\" command.\n-\/\/ See also: PrintSecurityPropertiesDCmd class\n-static jint get_security_properties(AttachOperation* op, attachStream* out) {\n-  return get_properties(op, out, vmSymbols::serializeSecurityPropertiesToByteArray_name());\n-}\n-\n","filename":"src\/hotspot\/share\/services\/attachListener.cpp","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -101,2 +101,2 @@\n-  DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl<PrintSystemPropertiesDCmd>(full_export, true));\n-  DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl<PrintPropertiesDCmd>(full_export));\n+  DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl<PrintSystemPropertiesDCmd>(full_export));\n+  DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl<PrintSecurityPropertiesDCmd>(full_export));\n@@ -340,29 +340,29 @@\n-    Symbol* klass = vmSymbols::jdk_internal_vm_VMSupport();\n-    Klass* k = SystemDictionary::resolve_or_fail(klass, true, CHECK);\n-    InstanceKlass* ik = InstanceKlass::cast(k);\n-    if (ik->should_be_initialized()) {\n-        ik->initialize(THREAD);\n-    }\n-    if (HAS_PENDING_EXCEPTION) {\n-        java_lang_Throwable::print(PENDING_EXCEPTION, out);\n-        out->cr();\n-        CLEAR_PENDING_EXCEPTION;\n-        return;\n-    }\n-    JavaValue result(T_OBJECT);\n-    JavaCallArguments args;\n-    Symbol* signature = vmSymbols::void_byte_array_signature();\n-    JavaCalls::call_static(&result, ik, method_name, signature, &args, THREAD);\n-\n-    if (HAS_PENDING_EXCEPTION) {\n-        java_lang_Throwable::print(PENDING_EXCEPTION, out);\n-        out->cr();\n-        CLEAR_PENDING_EXCEPTION;\n-        return;\n-    }\n-    oop res = result.get_oop();\n-    assert(res->is_typeArray(), \"should be a byte array\");\n-    assert(TypeArrayKlass::cast(res->klass())->element_type() == T_BYTE, \"should be a byte array\");\n-    typeArrayOop ba = typeArrayOop(res);\n-    jbyte* addr = ba->byte_at_addr(0);\n-    out->print_raw((const char*)addr, ba->length());\n+  Symbol* klass = vmSymbols::jdk_internal_vm_VMSupport();\n+  Klass* k = SystemDictionary::resolve_or_fail(klass, true, CHECK);\n+  InstanceKlass* ik = InstanceKlass::cast(k);\n+  if (ik->should_be_initialized()) {\n+      ik->initialize(THREAD);\n+  }\n+  if (HAS_PENDING_EXCEPTION) {\n+      java_lang_Throwable::print(PENDING_EXCEPTION, out);\n+      out->cr();\n+      CLEAR_PENDING_EXCEPTION;\n+      return;\n+  }\n+  JavaValue result(T_OBJECT);\n+  JavaCallArguments args;\n+  Symbol* signature = vmSymbols::void_byte_array_signature();\n+  JavaCalls::call_static(&result, ik, method_name, signature, &args, THREAD);\n+\n+  if (HAS_PENDING_EXCEPTION) {\n+      java_lang_Throwable::print(PENDING_EXCEPTION, out);\n+      out->cr();\n+      CLEAR_PENDING_EXCEPTION;\n+      return;\n+  }\n+  oop res = result.get_oop();\n+  assert(res->is_typeArray(), \"should be a byte array\");\n+  assert(TypeArrayKlass::cast(res->klass())->element_type() == T_BYTE, \"should be a byte array\");\n+  typeArrayOop ba = typeArrayOop(res);\n+  jbyte* addr = ba->byte_at_addr(0);\n+  out->print_raw((const char*)addr, ba->length());\n@@ -375,19 +375,2 @@\n-PrintPropertiesDCmd::PrintPropertiesDCmd(outputStream* output, bool heap) :\n-                                          DCmdWithParser(output, heap),\n-  _system(\"-system\", \"print system properties\", \"BOOLEAN\", false, \"false\"),\n-  _security(\"-security\", \"print security properties\", \"BOOLEAN\", false, \"false\") {\n-  _dcmdparser.add_dcmd_option(&_system);\n-  _dcmdparser.add_dcmd_option(&_security);\n-}\n-\n-void PrintPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n-    if (_system.value() && _security.value()) {\n-      output()->print_cr(\"Enter one argument for VM.properties\");\n-      return;\n-    } else if (_system.value()) {\n-      print_properties(vmSymbols::serializePropertiesToByteArray_name(), output(), THREAD);\n-    } else if (_security.value()){\n-      print_properties(vmSymbols::serializeSecurityPropertiesToByteArray_name(), output(), THREAD);\n-    } else {\n-      output()->print_cr(\"Invalid argument to VM.properties, (-system, -security)\");\n-    }\n+void PrintSecurityPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n+  print_properties(vmSymbols::serializeSecurityPropertiesToByteArray_name(), output(), THREAD);\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":33,"deletions":50,"binary":false,"changes":83,"status":"modified"},{"patch":"@@ -97,4 +97,1 @@\n-class PrintPropertiesDCmd : public DCmdWithParser {\n-protected:\n-  DCmdArgument<bool> _system;\n-  DCmdArgument<bool> _security;\n+class PrintSecurityPropertiesDCmd : public DCmd {\n@@ -102,3 +99,3 @@\n-    PrintPropertiesDCmd(outputStream* output, bool heap);\n-    static const char* name() { return \"VM.properties\"; }\n-    static const char* description() { return \"Print -system or -security properties. (VM.properties -arg)\"; }\n+    PrintSecurityPropertiesDCmd(outputStream* output, bool heap) : DCmd(output, heap) { }\n+    static const char* name() { return \"VM.security_properties\"; }\n+    static const char* description() { return \"Print security properties.\"; }\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.hpp","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"}]}