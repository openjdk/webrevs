{"files":[{"patch":"@@ -707,0 +707,1 @@\n+  template(serializeSecurityPropertiesToByteArray_name, \"serializeSecurityPropertiesToByteArray\")                 \\\n","filename":"src\/hotspot\/share\/classfile\/vmSymbols.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -102,0 +102,1 @@\n+  DCmdFactory::register_DCmdFactory(new DCmdFactoryImpl<PrintSecurityPropertiesDCmd>(full_export));\n@@ -337,2 +338,2 @@\n-void PrintSystemPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n-  \/\/ load VMSupport\n+\/\/ helper method for printing system and security properties\n+static void print_properties(Symbol* method_name, outputStream* out, TRAPS) {\n@@ -343,1 +344,1 @@\n-    ik->initialize(THREAD);\n+      ik->initialize(THREAD);\n@@ -346,4 +347,4 @@\n-    java_lang_Throwable::print(PENDING_EXCEPTION, output());\n-    output()->cr();\n-    CLEAR_PENDING_EXCEPTION;\n-    return;\n+      java_lang_Throwable::print(PENDING_EXCEPTION, out);\n+      out->cr();\n+      CLEAR_PENDING_EXCEPTION;\n+      return;\n@@ -351,2 +352,0 @@\n-\n-  \/\/ invoke the serializePropertiesToByteArray method\n@@ -355,1 +354,0 @@\n-\n@@ -357,6 +355,2 @@\n-  JavaCalls::call_static(&result,\n-                         ik,\n-                         vmSymbols::serializePropertiesToByteArray_name(),\n-                         signature,\n-                         &args,\n-                         THREAD);\n+  JavaCalls::call_static(&result, ik, method_name, signature, &args, THREAD);\n+\n@@ -364,4 +358,4 @@\n-    java_lang_Throwable::print(PENDING_EXCEPTION, output());\n-    output()->cr();\n-    CLEAR_PENDING_EXCEPTION;\n-    return;\n+      java_lang_Throwable::print(PENDING_EXCEPTION, out);\n+      out->cr();\n+      CLEAR_PENDING_EXCEPTION;\n+      return;\n@@ -369,2 +363,0 @@\n-\n-  \/\/ The result should be a [B\n@@ -372,4 +364,2 @@\n-  assert(res->is_typeArray(), \"just checking\");\n-  assert(TypeArrayKlass::cast(res->klass())->element_type() == T_BYTE, \"just checking\");\n-\n-  \/\/ copy the bytes to the output stream\n+  assert(res->is_typeArray(), \"should be a byte array\");\n+  assert(TypeArrayKlass::cast(res->klass())->element_type() == T_BYTE, \"should be a byte array\");\n@@ -377,2 +367,10 @@\n-  jbyte* addr = typeArrayOop(res)->byte_at_addr(0);\n-  output()->print_raw((const char*)addr, ba->length());\n+  jbyte* addr = ba->byte_at_addr(0);\n+  out->print_raw((const char*)addr, ba->length());\n+}\n+\n+void PrintSystemPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n+  print_properties(vmSymbols::serializePropertiesToByteArray_name(), output(), THREAD);\n+}\n+\n+void PrintSecurityPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n+  print_properties(vmSymbols::serializeSecurityPropertiesToByteArray_name(), output(), THREAD);\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":26,"deletions":28,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -97,0 +97,9 @@\n+class PrintSecurityPropertiesDCmd : public DCmd {\n+public:\n+    PrintSecurityPropertiesDCmd(outputStream* output, bool heap) : DCmd(output, heap) { }\n+    static const char* name() { return \"VM.security_properties\"; }\n+    static const char* description() { return \"Print java.security.Security properties.\"; }\n+    static const char* impact() { return \"Low\"; }\n+    virtual void execute(DCmdSource source, TRAPS);\n+};\n+\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.hpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -333,0 +333,4 @@\n+            @Override\n+            public Properties getCurrentProperties() {\n+                return (Properties) props.clone();\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/security\/Security.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+    Properties getCurrentProperties();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaSecurityPropertiesAccess.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -101,0 +101,5 @@\n+    public static byte[] serializeSecurityPropertiesToByteArray() throws IOException {\n+        Properties p = SharedSecrets.getJavaSecurityPropertiesAccess().getCurrentProperties();\n+        return serializePropertiesToByteArray(onlyStrings(p));\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/vm\/VMSupport.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -0,0 +1,57 @@\n+\/*\n+ * Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import org.testng.annotations.Test;\n+\n+import java.security.Security;\n+import jdk.test.lib.process.OutputAnalyzer;\n+import jdk.test.lib.dcmd.CommandExecutor;\n+import jdk.test.lib.dcmd.JMXExecutor;\n+\n+\n+\/*\n+ * @test\n+ * @summary Test of diagnostic command VM.security_properties\n+ * @library \/test\/lib\n+ * @modules java.base\/jdk.internal.misc\n+ *          java.compiler\n+ *          java.management\n+ *          jdk.internal.jvmstat\/sun.jvmstat.monitor\n+ * @run testng SecurityPropertiesTest\n+ *\/\n+public class SecurityPropertiesTest {\n+    private final static String PROPERTY_NAME  = \"SecurityPropertiesTestPropertyName\";\n+    private final static String PROPERTY_VALUE = \"SecurityPropertiesTestPropertyValue\";\n+\n+    public void run(CommandExecutor executor) {\n+        Security.setProperty(PROPERTY_NAME, PROPERTY_VALUE);\n+\n+        OutputAnalyzer output = executor.execute(\"VM.security_properties\");\n+        output.shouldContain(PROPERTY_NAME + \"=\" + PROPERTY_VALUE);\n+    }\n+\n+    @Test\n+    public void jmx() {\n+        run(new JMXExecutor());\n+    }\n+}\n\\ No newline at end of file\n","filename":"test\/hotspot\/jtreg\/serviceability\/dcmd\/vm\/SecurityPropertiesTest.java","additions":57,"deletions":0,"binary":false,"changes":57,"status":"added"}]}