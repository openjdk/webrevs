{"files":[{"patch":"@@ -1522,2 +1522,0 @@\n-  assert_lock_strong(CompiledIC_lock);\n-  assert_lock_strong(Compile_lock);\n@@ -1525,0 +1523,2 @@\n+  assert_lock_strong(Compile_lock);\n+  assert(CompiledICLocker::is_safe(this), \"mt unsafe call\");\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+#include \"code\/compiledIC.hpp\"\n@@ -1650,3 +1651,0 @@\n-  MutexLocker ml_Compile_lock(Compile_lock);\n-  MutexLocker ml_CompiledIC_lock(CompiledIC_lock, Mutex::_no_safepoint_check_flag);\n-  MutexLocker ml_CodeCache_lock(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n@@ -1656,0 +1654,3 @@\n+    MutexLocker ml_Compile_lock(Compile_lock);\n+    CompiledICLocker ic_locker(code);\n+    MutexLocker ml_CodeCache_lock(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n@@ -1663,3 +1664,0 @@\n-  MutexLocker ml_Compile_lock(Compile_lock);\n-  MutexLocker ml_CompiledIC_lock(CompiledIC_lock, Mutex::_no_safepoint_check_flag);\n-  MutexLocker ml_CodeCache_lock(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n@@ -1668,0 +1666,3 @@\n+    MutexLocker ml_Compile_lock(Compile_lock);\n+    CompiledICLocker ic_locker(code);\n+    MutexLocker ml_CodeCache_lock(CodeCache_lock, Mutex::_no_safepoint_check_flag);\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -33,2 +33,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions\n- *                   -XX:+WhiteBoxAPI -XX:+SegmentedCodeCache\n+ * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ *                   -XX:+SegmentedCodeCache -XX:-UseCodeCacheFlushing -XX:-MethodFlushing\n","filename":"test\/hotspot\/jtreg\/compiler\/whitebox\/StressNMethodRelocation.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}