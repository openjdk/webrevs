{"files":[{"patch":"@@ -36,0 +36,2 @@\n+import static compiler.whitebox.CompilerWhiteBoxTest.COMP_LEVEL_FULL_OPTIMIZATION;\n+\n@@ -55,1 +57,1 @@\n-                \"-XX:+UseG1GC\",\n+                \"-XX:+UseSerialGC\",\n@@ -60,1 +62,0 @@\n-                \"-Xbatch\",\n@@ -96,4 +97,0 @@\n-    \/** Value of {@code -XX:CompileThreshold} *\/\n-    protected static final int COMPILE_THRESHOLD\n-        = Integer.parseInt(getVMOption(\"CompileThreshold\", \"10000\"));\n-\n@@ -146,1 +143,4 @@\n-        compile();\n+        WHITE_BOX.enqueueMethodForCompilation(method, COMP_LEVEL_FULL_OPTIMIZATION);\n+        while (WHITE_BOX.isMethodQueuedForCompilation(method)) {\n+            Thread.onSpinWait();\n+        }\n@@ -169,0 +169,2 @@\n+        WHITE_BOX.lockCompilation();\n+\n@@ -173,6 +175,0 @@\n-    private static void compile() {\n-        for (int i = 0; i < COMPILE_THRESHOLD; i++) {\n-            compiledMethod();\n-        }\n-    }\n-\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/NMethodRelocation\/NMethodRelocationTest.java","additions":9,"deletions":13,"binary":false,"changes":22,"status":"modified"}]}