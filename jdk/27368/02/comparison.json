{"files":[{"patch":"@@ -35,1 +35,1 @@\n-void MallocInfoDcmd::execute(DCmdSource source, TRAPS) {\n+void MallocInfoDcmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/os\/linux\/mallocInfoDcmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,1 +44,1 @@\n-  void execute(DCmdSource source, TRAPS) override;\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/os\/linux\/mallocInfoDcmd.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-void TrimCLibcHeapDCmd::execute(DCmdSource source, TRAPS) {\n+void TrimCLibcHeapDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/os\/linux\/trimCHeapDCmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -45,1 +45,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/os\/linux\/trimCHeapDCmd.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -550,1 +550,1 @@\n-void ClassLoaderHierarchyDCmd::execute(DCmdSource source, TRAPS) {\n+void ClassLoaderHierarchyDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/classLoaderHierarchyDCmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/classfile\/classLoaderHierarchyDCmd.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -172,1 +172,1 @@\n-void ClassLoaderStatsDCmd::execute(DCmdSource source, TRAPS) {\n+void ClassLoaderStatsDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/classLoaderStats.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -54,1 +54,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/classfile\/classLoaderStats.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -928,1 +928,1 @@\n-void StringtableDCmd::execute(DCmdSource source, TRAPS) {\n+void StringtableDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/stringTable.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -960,1 +960,1 @@\n-void SymboltableDCmd::execute(DCmdSource source, TRAPS) {\n+void SymboltableDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/symbolTable.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2497,1 +2497,1 @@\n-void SystemDictionaryDCmd::execute(DCmdSource source, TRAPS) {\n+void SystemDictionaryDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -218,1 +218,1 @@\n-void JfrDCmd::execute(DCmdSource source, TRAPS) {\n+void JfrDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -466,1 +466,1 @@\n-void JfrConfigureFlightRecorderDCmd::execute(DCmdSource source, TRAPS) {\n+void JfrConfigureFlightRecorderDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/jfr\/dcmd\/jfrDcmds.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -42,5 +42,5 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n-  virtual void print_help(const char* name) const;\n-  virtual GrowableArray<const char*>* argument_name_array() const;\n-  virtual GrowableArray<DCmdArgumentInfo*>* argument_info_array() const;\n-  virtual void parse(CmdLine* line, char delim, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n+  void print_help(const char* name) const override;\n+  GrowableArray<const char*>* argument_name_array() const override;\n+  GrowableArray<DCmdArgumentInfo*>* argument_info_array() const override;\n+  void parse(CmdLine* line, char delim, TRAPS) override;\n@@ -205,2 +205,2 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n-  virtual void print_help(const char* name) const;\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n+  void print_help(const char* name) const override;\n","filename":"src\/hotspot\/share\/jfr\/dcmd\/jfrDcmds.hpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -167,1 +167,1 @@\n-  dcmd_recording->execute(DCmd_Source_Internal, THREAD);\n+  dcmd_recording->execute(DCmd_Source_Internal, {}\/*commonOptions*\/, THREAD);\n","filename":"src\/hotspot\/share\/jfr\/recorder\/jfrRecorder.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -395,1 +395,1 @@\n-  configure.execute(DCmd_Source_Internal, THREAD);\n+  configure.execute(DCmd_Source_Internal, {} \/*options*\/, THREAD);\n","filename":"src\/hotspot\/share\/jfr\/recorder\/service\/jfrOptionSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -52,1 +52,1 @@\n-void LogDiagnosticCommand::execute(DCmdSource source, TRAPS) {\n+void LogDiagnosticCommand::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/logging\/logDiagnosticCommand.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/logging\/logDiagnosticCommand.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-void MetaspaceDCmd::execute(DCmdSource source, TRAPS) {\n+void MetaspaceDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/memory\/metaspace\/metaspaceDCmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/memory\/metaspace\/metaspaceDCmd.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -71,1 +71,1 @@\n-void NMTDCmd::execute(DCmdSource source, TRAPS) {\n+void NMTDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/nmt\/nmtDCmd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/nmt\/nmtDCmd.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1368,3 +1368,0 @@\n-  char buf[32];\n-  st->print_raw_cr(os::local_time_string(buf, sizeof(buf)));\n-\n@@ -1375,0 +1372,1 @@\n+  char buf[32];\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -390,1 +390,1 @@\n-    virtual void execute(DCmd* command, TRAPS) override {\n+    void execute(DCmd* command, const JcmdOptions& commonOptions, TRAPS) override {\n@@ -394,1 +394,1 @@\n-      DCmd::Executor::execute(command, CHECK);\n+      DCmd::Executor::execute(command, commonOptions, CHECK);\n","filename":"src\/hotspot\/share\/services\/attachListener.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -185,1 +185,1 @@\n-void HelpDCmd::execute(DCmdSource source, TRAPS) {\n+void HelpDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -228,1 +228,1 @@\n-void VersionDCmd::execute(DCmdSource source, TRAPS) {\n+void VersionDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -248,1 +248,1 @@\n-void PrintVMFlagsDCmd::execute(DCmdSource source, TRAPS) {\n+void PrintVMFlagsDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -265,1 +265,1 @@\n-void SetVMFlagDCmd::execute(DCmdSource source, TRAPS) {\n+void SetVMFlagDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -279,1 +279,1 @@\n-void JVMTIDataDumpDCmd::execute(DCmdSource source, TRAPS) {\n+void JVMTIDataDumpDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -296,1 +296,1 @@\n-void JVMTIAgentLoadDCmd::execute(DCmdSource source, TRAPS) {\n+void JVMTIAgentLoadDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -337,1 +337,1 @@\n-void PrintSystemPropertiesDCmd::execute(DCmdSource source, TRAPS) {\n+void PrintSystemPropertiesDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -387,1 +387,1 @@\n-void VMUptimeDCmd::execute(DCmdSource source, TRAPS) {\n+void VMUptimeDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -396,1 +396,1 @@\n-void VMInfoDCmd::execute(DCmdSource source, TRAPS) {\n+void VMInfoDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -400,1 +400,1 @@\n-void SystemGCDCmd::execute(DCmdSource source, TRAPS) {\n+void SystemGCDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -404,1 +404,1 @@\n-void RunFinalizationDCmd::execute(DCmdSource source, TRAPS) {\n+void RunFinalizationDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -412,1 +412,1 @@\n-void HeapInfoDCmd::execute(DCmdSource source, TRAPS) {\n+void HeapInfoDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -417,1 +417,1 @@\n-void FinalizerInfoDCmd::execute(DCmdSource source, TRAPS) {\n+void FinalizerInfoDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -490,1 +490,1 @@\n-void HeapDumpDCmd::execute(DCmdSource source, TRAPS) {\n+void HeapDumpDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -537,1 +537,1 @@\n-void ClassHistogramDCmd::execute(DCmdSource source, TRAPS) {\n+void ClassHistogramDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -562,1 +562,13 @@\n-void ThreadDumpDCmd::execute(DCmdSource source, TRAPS) {\n+static void print_local_time(outputStream* output) {\n+  char buf[32];\n+  output->print_cr(\"%s\", os::local_time_string(buf, sizeof(buf)));\n+}\n+\n+\n+void ThreadDumpDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n+  \/\/ Timestamping is handled by the calle.\n+  \/\/ Stay backwards compatible in cases where timestamp is not requested explicitly.\n+  if (JcmdOptions::TimeStamp::Default == commonOptions.timestamp) {\n+    print_local_time(output());\n+  }\n+\n@@ -687,1 +699,1 @@\n-void JMXStartRemoteDCmd::execute(DCmdSource source, TRAPS) {\n+void JMXStartRemoteDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -760,1 +772,1 @@\n-void JMXStartLocalDCmd::execute(DCmdSource source, TRAPS) {\n+void JMXStartLocalDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -777,1 +789,1 @@\n-void JMXStopRemoteDCmd::execute(DCmdSource source, TRAPS) {\n+void JMXStopRemoteDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -799,1 +811,1 @@\n-void JMXStatusDCmd::execute(DCmdSource source, TRAPS) {\n+void JMXStatusDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -832,1 +844,1 @@\n-void VMDynamicLibrariesDCmd::execute(DCmdSource source, TRAPS) {\n+void VMDynamicLibrariesDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -837,1 +849,1 @@\n-void CompileQueueDCmd::execute(DCmdSource source, TRAPS) {\n+void CompileQueueDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -842,1 +854,1 @@\n-void CodeListDCmd::execute(DCmdSource source, TRAPS) {\n+void CodeListDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -846,1 +858,1 @@\n-void CodeCacheDCmd::execute(DCmdSource source, TRAPS) {\n+void CodeCacheDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -858,1 +870,1 @@\n-void PerfMapDCmd::execute(DCmdSource source, TRAPS) {\n+void PerfMapDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -872,1 +884,1 @@\n-void CodeHeapAnalyticsDCmd::execute(DCmdSource source, TRAPS) {\n+void CodeHeapAnalyticsDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -893,1 +905,1 @@\n-void EventLogDCmd::execute(DCmdSource source, TRAPS) {\n+void EventLogDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -907,1 +919,1 @@\n-void CompilerDirectivesPrintDCmd::execute(DCmdSource source, TRAPS) {\n+void CompilerDirectivesPrintDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -917,1 +929,1 @@\n-void CompilerDirectivesAddDCmd::execute(DCmdSource source, TRAPS) {\n+void CompilerDirectivesAddDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -921,1 +933,1 @@\n-void CompilerDirectivesRemoveDCmd::execute(DCmdSource source, TRAPS) {\n+void CompilerDirectivesRemoveDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -925,1 +937,1 @@\n-void CompilerDirectivesClearDCmd::execute(DCmdSource source, TRAPS) {\n+void CompilerDirectivesClearDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -928,0 +940,1 @@\n+\n@@ -943,1 +956,1 @@\n-void ClassHierarchyDCmd::execute(DCmdSource source, TRAPS) {\n+void ClassHierarchyDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -980,1 +993,1 @@\n-void ClassesDCmd::execute(DCmdSource source, TRAPS) {\n+void ClassesDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -986,1 +999,1 @@\n-void AOTEndRecordingDCmd::execute(DCmdSource source, TRAPS) {\n+void AOTEndRecordingDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1020,1 +1033,1 @@\n-void DumpSharedArchiveDCmd::execute(DCmdSource source, TRAPS) {\n+void DumpSharedArchiveDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1083,1 +1096,1 @@\n-void ThreadDumpToFileDCmd::execute(DCmdSource source, TRAPS) {\n+void ThreadDumpToFileDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1160,1 +1173,1 @@\n-void VThreadSchedulerDCmd::execute(DCmdSource source, TRAPS) {\n+void VThreadSchedulerDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1164,1 +1177,1 @@\n-void VThreadPollersDCmd::execute(DCmdSource source, TRAPS) {\n+void VThreadPollersDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1178,1 +1191,1 @@\n-void CompilationMemoryStatisticDCmd::execute(DCmdSource source, TRAPS) {\n+void CompilationMemoryStatisticDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1187,1 +1200,1 @@\n-void SystemMapDCmd::execute(DCmdSource source, TRAPS) {\n+void SystemMapDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n@@ -1199,1 +1212,1 @@\n-void SystemDumpMapDCmd::execute(DCmdSource source, TRAPS) {\n+void SystemDumpMapDCmd::execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) {\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":54,"deletions":41,"binary":false,"changes":95,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -67,1 +67,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -78,1 +78,1 @@\n-  virtual void execute(DCmdSource source, TRAPS) {\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override {\n@@ -94,1 +94,1 @@\n-    virtual void execute(DCmdSource source, TRAPS);\n+    void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -111,1 +111,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -129,1 +129,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -142,1 +142,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -159,1 +159,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -176,1 +176,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -192,1 +192,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -203,1 +203,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -216,1 +216,1 @@\n-    virtual void execute(DCmdSource source, TRAPS);\n+    void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -229,1 +229,1 @@\n-    virtual void execute(DCmdSource source, TRAPS);\n+    void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -243,1 +243,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -257,1 +257,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -282,1 +282,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -303,1 +303,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -325,1 +325,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -339,1 +339,1 @@\n-    virtual void execute(DCmdSource source, TRAPS);\n+    void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -360,1 +360,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -381,1 +381,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -431,1 +431,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -451,1 +451,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -470,1 +470,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -486,1 +486,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -502,1 +502,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -521,1 +521,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -537,1 +537,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -552,1 +552,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -573,1 +573,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -589,1 +589,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -604,1 +604,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -622,1 +622,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -637,1 +637,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -698,1 +698,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -716,1 +716,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -734,1 +734,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -752,1 +752,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -771,1 +771,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -794,1 +794,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -808,1 +808,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -821,1 +821,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -841,1 +841,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -854,1 +854,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n@@ -867,1 +867,1 @@\n-  virtual void execute(DCmdSource source, TRAPS);\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override;\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.hpp","additions":45,"deletions":45,"binary":false,"changes":90,"status":"modified"},{"patch":"@@ -382,0 +382,38 @@\n+\n+\/**\n+ * parse jcmd common option\n+ * @param line - a command line with leading common options \"[options] <cmd>\"\n+ * @param updated_line - return value with \"<cmd>\"\n+ *\/\n+static JcmdOptions parse_common_options(const CmdLine& line, stringStream *updated_line) {\n+  JcmdOptions options;\n+\n+  \/\/ there is only TIMESTAMP option so far\n+  const char TIMESTAMP[] = \"-T\";\n+\n+  const char* line_str = line.cmd_addr();\n+\n+  stringStream cmd;\n+  cmd.print(\"%s\", line.cmd_addr());\n+  char* rest = cmd.as_string();\n+  for (char* token = strtok_r(rest, \" \", &rest);\n+      token != nullptr;\n+      token = strtok_r(nullptr, \" \", &rest)) {\n+\n+    \/\/ there only one option for now.\n+    if (strcmp(token, TIMESTAMP) == 0) {\n+      options.timestamp = JcmdOptions::TimeStamp::Yes;\n+\n+      \/\/ save the remainder before\n+      line_str = strstr(line_str, rest);\n+    } else {\n+      break;\n+    }\n+  }\n+\n+  updated_line->write(line_str, strlen(line_str));\n+\n+  return options;\n+}\n+\n+\n@@ -396,1 +434,13 @@\n-    CmdLine line = iter.next();\n+\n+    \/\/ > jcmd [options] <command> [args]\n+    \/\/        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n+    const CmdLine line_optioned = iter.next();\n+\n+    \/\/ parse options\n+    stringStream ss_line_naked;\n+    const JcmdOptions options = parse_common_options(line_optioned, &ss_line_naked);\n+\n+    \/\/ > jcmd [options] <command> [args]\n+    \/\/                  ^^^^^^^^^^^^^^^^\n+    CmdLine line(ss_line_naked.base(), ss_line_naked.size(), false);\n+\n@@ -400,0 +450,1 @@\n+\n@@ -401,2 +452,0 @@\n-      \/\/ Allow for \"<cmd> -h|-help|--help\" to enable the help diagnostic command.\n-      \/\/ Ignores any additional arguments.\n@@ -404,0 +453,3 @@\n+\n+      \/\/ treat trailing {-h,-help,--help} as help command\n+      \/\/ Ignores any additional arguments.\n@@ -414,1 +466,6 @@\n-      execute(command, CHECK);\n+\n+      if (options.timestamp == JcmdOptions::TimeStamp::Yes){\n+        _out->date_stamp(true, \"\", \"\\n\");\n+      }\n+\n+      execute(command, options, CHECK);\n@@ -420,2 +477,2 @@\n-void DCmd::Executor::execute(DCmd* command, TRAPS) {\n-  command->execute(_source, CHECK);\n+void DCmd::Executor::execute(DCmd* command, const JcmdOptions& commonOptions, TRAPS) {\n+  command->execute(_source, commonOptions, CHECK);\n@@ -429,0 +486,1 @@\n+\n","filename":"src\/hotspot\/share\/services\/diagnosticFramework.cpp","additions":64,"deletions":6,"binary":false,"changes":70,"status":"modified"},{"patch":"@@ -167,0 +167,10 @@\n+\n+struct JcmdOptions {\n+  enum class TimeStamp {\n+    Default,\n+    Yes \/\/ timestamp was explicitly requeted with -T flag\n+  };\n+\n+  TimeStamp timestamp = TimeStamp::Default;\n+};\n+\n@@ -261,1 +271,1 @@\n-  virtual void execute(DCmdSource source, TRAPS) { }\n+  virtual void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) { }\n@@ -285,1 +295,1 @@\n-    virtual void execute(DCmd* command, TRAPS);\n+    virtual void execute(DCmd* command, const JcmdOptions& commonOptions, TRAPS);\n@@ -308,7 +318,7 @@\n-  virtual void parse(CmdLine *line, char delim, TRAPS);\n-  virtual void execute(DCmdSource source, TRAPS) { }\n-  virtual void reset(TRAPS);\n-  virtual void cleanup();\n-  virtual void print_help(const char* name) const;\n-  virtual GrowableArray<const char*>* argument_name_array() const;\n-  virtual GrowableArray<DCmdArgumentInfo*>* argument_info_array() const;\n+  void parse(CmdLine *line, char delim, TRAPS) override;\n+  void execute(DCmdSource source, const JcmdOptions& commonOptions, TRAPS) override { }\n+  void reset(TRAPS) override;\n+  void cleanup() override;\n+  void print_help(const char* name) const override;\n+  GrowableArray<const char*>* argument_name_array() const override;\n+  GrowableArray<DCmdArgumentInfo*>* argument_info_array() const override;\n","filename":"src\/hotspot\/share\/services\/diagnosticFramework.hpp","additions":19,"deletions":9,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -53,5 +53,4 @@\n-        if (args[0].equals(\"-?\") ||\n-            args[0].equals(\"-h\") ||\n-            args[0].equals(\"--help\") ||\n-            \/\/ -help: legacy.\n-            args[0].equals(\"-help\")) {\n+        if (args[0].equals(\"-?\")\n+                || args[0].equals(\"-h\")\n+                || args[0].equals(\"--help\")\n+                || args[0].equals(\"-help\")) { \/\/ -help: legacy.\n@@ -62,2 +61,1 @@\n-        processString = args[0];\n-\n+        int argsCounter = 0;\n@@ -65,1 +63,18 @@\n-        for (int i = 1; i < args.length; i++) {\n+\n+        \/\/ {<PID>, <main class>}\n+        processString = args[argsCounter];\n+        argsCounter++;\n+\n+        \/\/ common flags: [-T]\n+        if (argsCounter < args.length           \/\/ \"jcmd <PID>\" is not an error and acts as \"jcmd <PID> help\"\n+                && args[argsCounter].equals(\"-T\")) {\n+            sb.append(args[argsCounter]).append(\" \");\n+            argsCounter++;\n+\n+            if (argsCounter == args.length) {\n+                \/\/ common flag followed by nothing\n+                throw new IllegalArgumentException(\"Not enough arguments\");\n+            }\n+        }\n+\n+        for (int i = argsCounter; i < args.length; i++) {\n@@ -111,1 +126,1 @@\n-        System.out.println(\"Usage: jcmd <pid | main class> <command ...|PerfCounter.print|-f file>\");\n+        System.out.println(\"Usage: jcmd <pid | main class> [-T] <command ...|PerfCounter.print|-f file>\");\n@@ -113,1 +128,3 @@\n-        System.out.println(\"   or: jcmd -h                                                    \");\n+        System.out.println(\"   or: jcmd <-h | --help>                                         \");\n+        System.out.println(\"                                                                  \");\n+        System.out.println(\"  -T flag ensures the dignostic command begins with a timestamp   \");\n@@ -115,1 +132,1 @@\n-        System.out.println(\"  command must be a valid jcmd command for the selected jvm.      \");\n+        System.out.println(\"  command must be a valid jcmd command for the selected JVM.      \");\n@@ -125,1 +142,1 @@\n-        System.out.println(\"  -? -h --help print this help message                            \");\n+        System.out.println(\"  -? -h --help  print this help message                           \");\n","filename":"src\/jdk.jcmd\/share\/classes\/sun\/tools\/jcmd\/Arguments.java","additions":29,"deletions":12,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n-`jcmd` \\[*pid* \\| *main-class*\\] *command*... \\| `PerfCounter.print` \\| `-f`\n+`jcmd` \\[*pid* \\| *main-class*\\] [`-T`] *command*... \\| `PerfCounter.print` \\| `-f`\n@@ -51,0 +51,3 @@\n+`-T`\n+:   When used, the diagnostic commands output starts with a timestamp.\n+\n","filename":"src\/jdk.jcmd\/share\/man\/jcmd.md","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -0,0 +1,77 @@\n+\/*\n+ * Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.time.LocalDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.time.Duration;\n+\n+import jdk.test.lib.Asserts;\n+import jdk.test.lib.dcmd.FileJcmdExecutor;\n+import jdk.test.lib.dcmd.PidJcmdExecutor;\n+import jdk.test.lib.dcmd.JcmdExecutor;\n+import jdk.test.lib.process.OutputAnalyzer;\n+\n+\/*\n+ * @test\n+ * @summary test jcmd generic flag \"-T\" to make sure dignostic coommand is timestamped\n+ * @library \/test\/lib\n+ * @run main\/othervm TestJcmdTimestamp\n+ *\/\n+public class TestJcmdTimestamp {\n+\n+    public static void main(String[] args) throws Exception {\n+        TestJcmdTimestamp(new PidJcmdExecutor(), \"-T VM.version\", true \/* expectTimestamp *\/);\n+        TestJcmdTimestamp(new PidJcmdExecutor(), \"VM.version\", false \/* expectTimestamp *\/);\n+        TestJcmdTimestamp(new FileJcmdExecutor(), \"-T VM.version\", true \/* expectTimestamp *\/);\n+        TestJcmdTimestamp(new FileJcmdExecutor(), \"VM.version\", false \/* expectTimestamp *\/);\n+    }\n+\n+    \/\/ timestamp should be there and it should be recent\n+    public static void assertTimestamp(final String line) throws java.time.format.DateTimeParseException {\n+        \/\/ ISO 8601. Example \"2026-01-21T16:58:49.518+0100\"\n+        final String timePattern = \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\";\n+        final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(timePattern);\n+        final LocalDateTime parsedDateTime = LocalDateTime.parse(line, formatter);\n+\n+        final Duration duration = Duration.between(parsedDateTime, LocalDateTime.now());\n+        Asserts.assertLessThan(duration.getSeconds(), 5L, \"the timestamp is not recent\");\n+    }\n+\n+\n+    private static void TestJcmdTimestamp(final JcmdExecutor executor,\n+            final String command,\n+            final boolean expectTimestamp) throws Exception {\n+\n+        OutputAnalyzer output = executor.execute(command);\n+        output.shouldHaveExitValue(0);\n+\n+        final String secondLine = output.getOutput().split(\"\\\\r?\\\\n\")[1];\n+\n+        if (expectTimestamp) {\n+            assertTimestamp(secondLine);\n+        }\n+        else {\n+            Asserts.assertThrows(java.time.format.DateTimeParseException.class, () -> assertTimestamp(secondLine));\n+        }\n+    }\n+}\n","filename":"test\/jdk\/sun\/tools\/jcmd\/TestJcmdTimestamp.java","additions":77,"deletions":0,"binary":false,"changes":77,"status":"added"},{"patch":"@@ -1,1 +1,1 @@\n-Usage: jcmd <pid | main class> <command ...|PerfCounter.print|-f file>\n+Usage: jcmd <pid | main class> [-T] <command ...|PerfCounter.print|-f file>\n@@ -3,1 +3,1 @@\n-   or: jcmd -h                                                    \n+   or: jcmd <-h | --help>                                         \n@@ -5,1 +5,3 @@\n-  command must be a valid jcmd command for the selected jvm.      \n+  -T flag ensures the dignostic command begins with a timestamp   \n+                                                                  \n+  command must be a valid jcmd command for the selected JVM.      \n@@ -15,1 +17,1 @@\n-  -? -h --help print this help message                            \n+  -? -h --help  print this help message                           \n","filename":"test\/jdk\/sun\/tools\/jcmd\/usage.out","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"}]}