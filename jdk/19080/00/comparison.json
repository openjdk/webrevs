{"files":[{"patch":"@@ -72,1 +72,1 @@\n-    result = os::attempt_reserve_memory_at((char*)immediate, size, !ExecMem, mtClass);\n+    result = os::attempt_reserve_memory_at((char*)immediate, size, false);\n@@ -115,1 +115,1 @@\n-    result = os::reserve_memory_aligned(size, alignment, !ExecMem, mtClass);\n+    result = os::reserve_memory_aligned(size, alignment, false);\n","filename":"src\/hotspot\/cpu\/aarch64\/compressedKlass_aarch64.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1808,1 +1808,1 @@\n-void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag) {\n+void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint) {\n@@ -1850,1 +1850,1 @@\n-char* os::pd_reserve_memory(size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_reserve_memory(size_t bytes, bool exec) {\n@@ -1999,1 +1999,1 @@\n-char* os::pd_reserve_memory_special(size_t bytes, size_t alignment, size_t page_size, char* req_addr, bool exec, MEMFLAGS flag) {\n+char* os::pd_reserve_memory_special(size_t bytes, size_t alignment, size_t page_size, char* req_addr, bool exec) {\n@@ -2018,1 +2018,1 @@\n-char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc, MEMFLAGS flag) {\n+char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc) {\n@@ -2036,1 +2036,1 @@\n-char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec) {\n","filename":"src\/hotspot\/os\/aix\/os_aix.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -81,1 +81,1 @@\n-  _base = (uintptr_t)os::reserve_memory(max_capacity, !ExecMem, mtJavaHeap);\n+  _base = (uintptr_t)os::reserve_memory(max_capacity);\n","filename":"src\/hotspot\/os\/bsd\/gc\/x\/xPhysicalMemoryBacking_bsd.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -82,1 +82,1 @@\n-  _base = (uintptr_t)os::reserve_memory(max_capacity, !ExecMem, mtJavaHeap);\n+  _base = (uintptr_t)os::reserve_memory(max_capacity);\n","filename":"src\/hotspot\/os\/bsd\/gc\/z\/zPhysicalMemoryBacking_bsd.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1671,1 +1671,1 @@\n-void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag) {\n+void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint) {\n@@ -1769,1 +1769,1 @@\n-  return os::commit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::commit_memory(addr, size, !ExecMem);\n@@ -1775,1 +1775,1 @@\n-  return os::uncommit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::uncommit_memory(addr, size);\n@@ -1812,1 +1812,1 @@\n-char* os::pd_reserve_memory(size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_reserve_memory(size_t bytes, bool exec) {\n@@ -1872,1 +1872,1 @@\n-char* os::pd_reserve_memory_special(size_t bytes, size_t alignment, size_t page_size, char* req_addr, bool exec, MEMFLAGS flag) {\n+char* os::pd_reserve_memory_special(size_t bytes, size_t alignment, size_t page_size, char* req_addr, bool exec) {\n@@ -1891,1 +1891,1 @@\n-char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc, MEMFLAGS flag) {\n+char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc) {\n@@ -1893,1 +1893,1 @@\n-  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem, flag);\n+  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem);\n@@ -1905,1 +1905,1 @@\n-char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec) {\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -3026,1 +3026,1 @@\n-void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag) {\n+void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint) {\n@@ -3033,1 +3033,1 @@\n-    commit_memory(addr, bytes, alignment_hint, !ExecMem, flag);\n+    commit_memory(addr, bytes, alignment_hint, !ExecMem);\n@@ -3640,1 +3640,1 @@\n-  return os::commit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::commit_memory(addr, size, !ExecMem);\n@@ -3656,1 +3656,1 @@\n-  return os::uncommit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::uncommit_memory(addr, size);\n@@ -3760,1 +3760,1 @@\n-char* os::pd_reserve_memory(size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_reserve_memory(size_t bytes, bool exec) {\n@@ -4217,1 +4217,1 @@\n-                                    char* req_addr, bool exec, MEMFLAGS flag) {\n+                                    char* req_addr, bool exec) {\n@@ -4252,1 +4252,1 @@\n-char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc, MEMFLAGS flag) {\n+char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc) {\n@@ -4254,1 +4254,1 @@\n-  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem, flag);\n+  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem);\n@@ -4266,1 +4266,1 @@\n-char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_attempt_reserve_memory_at(char* requested_addr, size_t bytes, bool exec) {\n@@ -4658,1 +4658,1 @@\n-  char* codebuf = os::attempt_reserve_memory_at(hint, page_size, !ExecMem, mtInternal);\n+  char* codebuf = os::attempt_reserve_memory_at(hint, page_size);\n@@ -4666,1 +4666,1 @@\n-    codebuf = os::attempt_reserve_memory_at(hint, page_size, !ExecMem, mtInternal);\n+    codebuf = os::attempt_reserve_memory_at(hint, page_size);\n@@ -4669,1 +4669,1 @@\n-  if ((codebuf == nullptr) || (!os::commit_memory(codebuf, page_size, ExecMem, mtInternal))) {\n+  if ((codebuf == nullptr) || (!os::commit_memory(codebuf, page_size, true))) {\n@@ -4673,0 +4673,2 @@\n+  MemTracker::record_virtual_memory_type((address)codebuf, mtInternal);\n+\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":14,"deletions":12,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -398,1 +398,1 @@\n-char* os::reserve_memory_aligned(size_t size, size_t alignment, bool exec, MEMFLAGS flag) {\n+char* os::reserve_memory_aligned(size_t size, size_t alignment, bool exec) {\n@@ -400,1 +400,1 @@\n-  char* extra_base = os::reserve_memory(extra_size, exec, flag);\n+  char* extra_base = os::reserve_memory(extra_size, exec);\n@@ -424,1 +424,1 @@\n-  MemTracker::record_virtual_memory_commit((address)aligned_base, size, CALLER_PC, flag);\n+  MemTracker::record_virtual_memory_commit((address)aligned_base, size, CALLER_PC);\n","filename":"src\/hotspot\/os\/posix\/os_posix.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -68,1 +68,1 @@\n-  char* mapAddress = os::reserve_memory(size, !ExecMem, mtInternal);\n+  char* mapAddress = os::reserve_memory(size);\n@@ -75,1 +75,1 @@\n-  if (!os::commit_memory(mapAddress, size, !ExecMem, mtInternal)) {\n+  if (!os::commit_memory(mapAddress, size, !ExecMem)) {\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2758,1 +2758,1 @@\n-                            !ExecMem, mtThreadStack);\n+                            !ExecMem);\n@@ -3120,1 +3120,1 @@\n-static char* allocate_pages_individually(size_t bytes, char* addr, DWORD alloc_type,\n+static char* allocate_pages_individually(size_t bytes, char* addr, DWORD flags,\n@@ -3122,1 +3122,0 @@\n-                                         MEMFLAGS flag,\n@@ -3146,1 +3145,1 @@\n-  MemTracker::record_virtual_memory_reserve((address)p_buf, size_of_reserve, CALLER_PC, flag);\n+  MemTracker::record_virtual_memory_reserve((address)p_buf, size_of_reserve, CALLER_PC);\n@@ -3188,1 +3187,1 @@\n-                                      alloc_type,\n+                                      flags,\n@@ -3194,1 +3193,1 @@\n-        p_new = (char *)virtualAllocExNuma(hProc, next_alloc_addr, bytes_to_rq, alloc_type, prot, node);\n+        p_new = (char *)virtualAllocExNuma(hProc, next_alloc_addr, bytes_to_rq, flags, prot, node);\n@@ -3207,1 +3206,1 @@\n-                                                  bytes_to_release, CALLER_PC, flag);\n+                                                  bytes_to_release, CALLER_PC);\n@@ -3224,2 +3223,2 @@\n-  if ((alloc_type & MEM_COMMIT) != 0) {\n-    MemTracker::record_virtual_memory_reserve_and_commit((address)p_buf, bytes, CALLER_PC, flag);\n+  if ((flags & MEM_COMMIT) != 0) {\n+    MemTracker::record_virtual_memory_reserve_and_commit((address)p_buf, bytes, CALLER_PC);\n@@ -3227,1 +3226,1 @@\n-    MemTracker::record_virtual_memory_reserve((address)p_buf, bytes, CALLER_PC, flag);\n+    MemTracker::record_virtual_memory_reserve((address)p_buf, bytes, CALLER_PC);\n@@ -3355,1 +3354,1 @@\n-static char* map_or_reserve_memory_aligned(size_t size, size_t alignment, int file_desc, MEMFLAGS flag) {\n+static char* map_or_reserve_memory_aligned(size_t size, size_t alignment, int file_desc, MEMFLAGS flag = mtNone) {\n@@ -3369,1 +3368,1 @@\n-                                         os::reserve_memory(extra_size, !ExecMem, flag);\n+                                         os::reserve_memory(extra_size, false, flag);\n@@ -3386,1 +3385,1 @@\n-                                     os::attempt_reserve_memory_at(aligned_base, size, !ExecMem, flag);\n+                                     os::attempt_reserve_memory_at(aligned_base, size, false, flag);\n@@ -3394,1 +3393,1 @@\n-char* os::reserve_memory_aligned(size_t size, size_t alignment, bool exec, MEMFLAGS flag) {\n+char* os::reserve_memory_aligned(size_t size, size_t alignment, bool exec) {\n@@ -3396,1 +3395,1 @@\n-  return map_or_reserve_memory_aligned(size, alignment, -1 \/* file_desc *\/, flag);\n+  return map_or_reserve_memory_aligned(size, alignment, -1 \/* file_desc *\/);\n@@ -3403,2 +3402,2 @@\n-char* os::pd_reserve_memory(size_t bytes, bool exec, MEMFLAGS flag) {\n-  return pd_attempt_reserve_memory_at(nullptr \/* addr *\/, bytes, exec, flag);\n+char* os::pd_reserve_memory(size_t bytes, bool exec) {\n+  return pd_attempt_reserve_memory_at(nullptr \/* addr *\/, bytes, exec);\n@@ -3409,1 +3408,1 @@\n-char* os::pd_attempt_reserve_memory_at(char* addr, size_t bytes, bool exec, MEMFLAGS flag) {\n+char* os::pd_attempt_reserve_memory_at(char* addr, size_t bytes, bool exec) {\n@@ -3424,1 +3423,1 @@\n-    res = allocate_pages_individually(bytes, addr, MEM_RESERVE, PAGE_READWRITE, flag);\n+    res = allocate_pages_individually(bytes, addr, MEM_RESERVE, PAGE_READWRITE);\n@@ -3445,1 +3444,1 @@\n-char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc, MEMFLAGS flag) {\n+char* os::pd_attempt_map_memory_to_file_at(char* requested_addr, size_t bytes, int file_desc) {\n@@ -3461,1 +3460,1 @@\n-static char* reserve_large_pages_individually(size_t size, char* req_addr, bool exec, MEMFLAGS flag) {\n+static char* reserve_large_pages_individually(size_t size, char* req_addr, bool exec) {\n@@ -3465,1 +3464,1 @@\n-  const DWORD alloc_type = MEM_RESERVE | MEM_COMMIT | MEM_LARGE_PAGES;\n+  const DWORD flags = MEM_RESERVE | MEM_COMMIT | MEM_LARGE_PAGES;\n@@ -3467,1 +3466,1 @@\n-  char * p_buf = allocate_pages_individually(size, req_addr, alloc_type, prot, flag, LargePagesIndividualAllocationInjectError);\n+  char * p_buf = allocate_pages_individually(size, req_addr, flags, prot, LargePagesIndividualAllocationInjectError);\n@@ -3491,1 +3490,1 @@\n-static char* reserve_large_pages(size_t size, char* req_addr, bool exec, MEMFLAGS flag) {\n+static char* reserve_large_pages(size_t size, char* req_addr, bool exec) {\n@@ -3496,1 +3495,1 @@\n-    return reserve_large_pages_individually(size, req_addr, exec, flag);\n+    return reserve_large_pages_individually(size, req_addr, exec);\n@@ -3513,1 +3512,1 @@\n-static char* reserve_large_pages_aligned(size_t size, size_t alignment, bool exec, MEMFLAGS flag) {\n+static char* reserve_large_pages_aligned(size_t size, size_t alignment, bool exec) {\n@@ -3526,1 +3525,1 @@\n-    aligned_address = reserve_large_pages(size, aligned_address, exec, flag);\n+    aligned_address = reserve_large_pages(size, aligned_address, exec);\n@@ -3539,1 +3538,1 @@\n-                                    bool exec, MEMFLAGS flag) {\n+                                    bool exec) {\n@@ -3555,1 +3554,1 @@\n-    return reserve_large_pages_aligned(bytes, alignment, exec, flag);\n+    return reserve_large_pages_aligned(bytes, alignment, exec);\n@@ -3559,1 +3558,1 @@\n-  return reserve_large_pages(bytes, addr, exec, flag);\n+  return reserve_large_pages(bytes, addr, exec);\n@@ -3725,1 +3724,1 @@\n-  return os::commit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::commit_memory(addr, size, !ExecMem);\n@@ -3729,1 +3728,1 @@\n-  return os::uncommit_memory(addr, size, !ExecMem, mtThreadStack);\n+  return os::uncommit_memory(addr, size);\n@@ -3780,1 +3779,1 @@\n-                          mtInternal, \"cannot commit protection page\");\n+                          \"cannot commit protection page\");\n@@ -3820,1 +3819,1 @@\n-void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag) { }\n+void os::pd_free_memory(char *addr, size_t bytes, size_t alignment_hint) { }\n@@ -5108,0 +5107,3 @@\n+    \/\/ Record virtual memory allocation\n+    MemTracker::record_virtual_memory_reserve_and_commit((address)addr, bytes, CALLER_PC);\n+\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":36,"deletions":34,"binary":false,"changes":70,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -58,1 +58,1 @@\n-  char* mapAddress = os::reserve_memory(size, !ExecMem, mtInternal);\n+  char* mapAddress = os::reserve_memory(size);\n@@ -65,1 +65,1 @@\n-  if (!os::commit_memory(mapAddress, size, !ExecMem, mtInternal)) {\n+  if (!os::commit_memory(mapAddress, size, !ExecMem)) {\n","filename":"src\/hotspot\/os\/windows\/perfMemory_windows.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -329,1 +329,1 @@\n-  ReservedSpace rs(buffer_size, MetaspaceShared::core_region_alignment(), os::vm_page_size(), mtClassShared);\n+  ReservedSpace rs(buffer_size, MetaspaceShared::core_region_alignment(), os::vm_page_size());\n","filename":"src\/hotspot\/share\/cds\/archiveBuilder.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1713,3 +1713,3 @@\n-static char* map_and_pretouch_memory(int fd, const char* file_name, size_t file_offset,\n-                                     char *addr, size_t bytes, bool read_only,\n-                                     bool allow_exec, MEMFLAGS flags) {\n+static char* map_memory(int fd, const char* file_name, size_t file_offset,\n+                        char *addr, size_t bytes, bool read_only,\n+                        bool allow_exec, MEMFLAGS flags = mtNone) {\n@@ -1744,1 +1744,1 @@\n-                              r->allow_exec(), mtClassShared);\n+                              r->allow_exec());\n@@ -1803,1 +1803,1 @@\n-    if (!os::commit_memory(base, size, r->allow_exec(), mtClassShared)) {\n+    if (!os::commit_memory(base, size, r->allow_exec())) {\n@@ -1863,3 +1863,3 @@\n-    char* base = map_and_pretouch_memory(_fd, _full_path, r->file_offset(),\n-                                         requested_addr, size, r->read_only(),\n-                                         r->allow_exec(), mtClassShared);\n+    char* base = map_memory(_fd, _full_path, r->file_offset(),\n+                            requested_addr, size, r->read_only(),\n+                            r->allow_exec(), mtClassShared);\n@@ -1892,2 +1892,2 @@\n-  char* bitmap_base = map_and_pretouch_memory(_fd, _full_path, r->file_offset(),\n-                                              requested_addr, r->used_aligned(), read_only, allow_exec, mtClassShared);\n+  char* bitmap_base = map_memory(_fd, _full_path, r->file_offset(),\n+                                 requested_addr, r->used_aligned(), read_only, allow_exec, mtClassShared);\n@@ -2179,1 +2179,0 @@\n-  \/\/ So we pass the mtJavaHeap to tell MemTracker the type of the already tracked memory.\n@@ -2181,3 +2180,3 @@\n-  char* base = map_and_pretouch_memory(_fd, _full_path, r->file_offset(),\n-                                       addr, _mapped_heap_memregion.byte_size(), r->read_only(),\n-                                       r->allow_exec(), mtJavaHeap);\n+  char* base = map_memory(_fd, _full_path, r->file_offset(),\n+                          addr, _mapped_heap_memregion.byte_size(), r->read_only(),\n+                          r->allow_exec());\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":13,"deletions":14,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -272,1 +272,1 @@\n-  _symbol_rs = ReservedSpace(symbol_rs_size, mtClassShared);\n+  _symbol_rs = ReservedSpace(symbol_rs_size);\n@@ -1273,1 +1273,1 @@\n-                                     os::vm_page_size(), mtClassShared, (char*)base_address);\n+                                     os::vm_page_size(), (char*)base_address);\n@@ -1277,0 +1277,2 @@\n+      \/\/ Register archive space with NMT.\n+      MemTracker::record_virtual_memory_type(archive_space_rs.base(), mtClassShared);\n@@ -1320,1 +1322,1 @@\n-                                       os::vm_page_size(), mtClassShared, (char*)base_address);\n+                                       os::vm_page_size(), (char*)base_address);\n@@ -1322,1 +1324,1 @@\n-                                       os::vm_page_size(), mtClass, (char*)ccs_base);\n+                                       os::vm_page_size(), (char*)ccs_base);\n@@ -1328,0 +1330,3 @@\n+    \/\/ NMT: fix up the space tags\n+    MemTracker::record_virtual_memory_type(archive_space_rs.base(), mtClassShared);\n+    MemTracker::record_virtual_memory_type(class_space_rs.base(), mtClass);\n@@ -1331,1 +1336,1 @@\n-                                     os::vm_page_size(), mtClassShared, (char*) base_address);\n+                                     os::vm_page_size(), (char*) base_address);\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -243,1 +243,1 @@\n-  _base = os::map_memory(_fd, filename, 0, nullptr, _size, true, false, mtClassShared);\n+  _base = os::map_memory(_fd, filename, 0, nullptr, _size, true, false);\n","filename":"src\/hotspot\/share\/classfile\/compactHashtable.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1216,1 +1216,1 @@\n-  ReservedSpace rs(size, preferred_page_size, mtGC);\n+  ReservedSpace rs(size, preferred_page_size);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -138,1 +138,1 @@\n-  os::commit_memory_or_exit(start_addr, size, _page_size, !ExecMem, mtGC, \"G1 virtual space\");\n+  os::commit_memory_or_exit(start_addr, size, _page_size, false, \"G1 virtual space\");\n@@ -145,1 +145,1 @@\n-  os::commit_memory_or_exit(aligned_end_address, _tail_size, os::vm_page_size(), !ExecMem, mtGC, \"G1 virtual space\");\n+  os::commit_memory_or_exit(aligned_end_address, _tail_size, os::vm_page_size(), false, \"G1 virtual space\");\n@@ -204,1 +204,1 @@\n-  os::uncommit_memory(start_addr, pointer_delta(bounded_end_addr(end_page), start_addr, sizeof(char)), !ExecMem, mtGC);\n+  os::uncommit_memory(start_addr, pointer_delta(bounded_end_addr(end_page), start_addr, sizeof(char)));\n","filename":"src\/hotspot\/share\/gc\/g1\/g1PageBasedVirtualSpace.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -46,1 +46,1 @@\n-  _region_commit_map(rs.size() * commit_factor \/ region_granularity, type),\n+  _region_commit_map(rs.size() * commit_factor \/ region_granularity, mtGC),\n@@ -50,0 +50,2 @@\n+\n+  MemTracker::record_virtual_memory_type((address)rs.base(), type);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RegionToSpaceMapper.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2006, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2006, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -230,1 +230,1 @@\n-    os::free_memory((char*)aligned_region.start(), aligned_region.byte_size(), os_align, mtGC);\n+    os::free_memory((char*)aligned_region.start(), aligned_region.byte_size(), os_align);\n","filename":"src\/hotspot\/share\/gc\/parallel\/mutableNUMASpace.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -63,1 +63,1 @@\n-        os::free_memory((char*)start, size, page_size, mtJavaHeap);\n+        os::free_memory((char*)start, size, page_size);\n","filename":"src\/hotspot\/share\/gc\/parallel\/mutableSpace.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  ReservedSpace backing_store(bytes_to_reserve, mtGC);\n+  ReservedSpace backing_store(bytes_to_reserve);\n@@ -54,0 +54,1 @@\n+  MemTracker::record_virtual_memory_type(backing_store.base(), mtGC);\n","filename":"src\/hotspot\/share\/gc\/parallel\/objectStartArray.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,1 +52,1 @@\n-  ReservedSpace rs(_reserved_byte_size, rs_align, page_sz, mtGC);\n+  ReservedSpace rs(_reserved_byte_size, rs_align, page_sz);\n@@ -57,0 +57,2 @@\n+  MemTracker::record_virtual_memory_type((address)rs.base(), mtGC);\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/parMarkBitMap.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -443,1 +443,1 @@\n-  ReservedSpace rs(_reserved_byte_size, rs_align, page_sz, mtGC);\n+  ReservedSpace rs(_reserved_byte_size, rs_align, page_sz);\n@@ -447,0 +447,2 @@\n+  MemTracker::record_virtual_memory_type((address)rs.base(), mtGC);\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -81,1 +81,1 @@\n-         os::commit_memory(base_addr, bytes, alignment(), !ExecMem, mtGC);\n+         os::commit_memory(base_addr, bytes, alignment(), !ExecMem);\n@@ -98,1 +98,1 @@\n-  bool result = special() || os::uncommit_memory(base_addr, bytes, !ExecMem, mtGC);\n+  bool result = special() || os::uncommit_memory(base_addr, bytes);\n","filename":"src\/hotspot\/share\/gc\/parallel\/psVirtualspace.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n-  ReservedSpace rs(size, mtGC);\n+  ReservedSpace rs(size);\n@@ -45,0 +45,2 @@\n+  MemTracker::record_virtual_memory_type((address)rs.base(), mtGC);\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialBlockOffsetTable.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -85,1 +85,3 @@\n-  ReservedSpace heap_rs(_byte_map_size, rs_align, _page_size, mtGC);\n+  ReservedSpace heap_rs(_byte_map_size, rs_align, _page_size);\n+\n+  MemTracker::record_virtual_memory_type((address)heap_rs.base(), mtGC);\n@@ -167,1 +169,0 @@\n-                              mtGCCardSet,\n@@ -176,3 +177,1 @@\n-                                   delta.byte_size(),\n-                                   !ExecMem,\n-                                   mtGCCardSet);\n+                                   delta.byte_size());\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTable.cpp","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -60,0 +60,2 @@\n+  MemTracker::record_virtual_memory_type(_map_space.base(), mtGC);\n+\n@@ -66,2 +68,2 @@\n-    os::commit_memory_or_exit(bot_addr, pointer_delta(top_addr, bot_addr, 1), !ExecMem,\n-                              mtGC, \"Unable to commit collection set bitmap: heap\");\n+    os::commit_memory_or_exit(bot_addr, pointer_delta(top_addr, bot_addr, 1), false,\n+                              \"Unable to commit collection set bitmap: heap\");\n@@ -71,2 +73,2 @@\n-      os::commit_memory_or_exit(_biased_cset_map, page_size, !ExecMem,\n-                                mtGC, \"Unable to commit collection set bitmap: zero page\");\n+      os::commit_memory_or_exit(_biased_cset_map, page_size, false,\n+                                \"Unable to commit collection set bitmap: zero page\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCollectionSet.cpp","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -216,2 +216,2 @@\n-    os::commit_memory_or_exit(sh_rs.base(), _initial_size, heap_alignment, !ExecMem,\n-                              mtGC, \"Cannot commit heap memory\");\n+    os::commit_memory_or_exit(sh_rs.base(), _initial_size, heap_alignment, false,\n+                              \"Cannot commit heap memory\");\n@@ -250,1 +250,1 @@\n-  ReservedSpace bitmap(_bitmap_size, bitmap_page_size, mtGC);\n+  ReservedSpace bitmap(_bitmap_size, bitmap_page_size);\n@@ -255,0 +255,1 @@\n+  MemTracker::record_virtual_memory_type(bitmap.base(), mtGC);\n@@ -262,2 +263,2 @@\n-    os::commit_memory_or_exit((char *) _bitmap_region.start(), bitmap_init_commit, bitmap_page_size, !ExecMem,\n-                              mtGC, \"Cannot commit bitmap memory\");\n+    os::commit_memory_or_exit((char *) _bitmap_region.start(), bitmap_init_commit, bitmap_page_size, false,\n+                              \"Cannot commit bitmap memory\");\n@@ -269,1 +270,1 @@\n-    ReservedSpace verify_bitmap(_bitmap_size, bitmap_page_size, mtGC);\n+    ReservedSpace verify_bitmap(_bitmap_size, bitmap_page_size);\n@@ -275,2 +276,2 @@\n-      os::commit_memory_or_exit(verify_bitmap.base(), verify_bitmap.size(), bitmap_page_size, !ExecMem,\n-                                mtGC, \"Cannot commit verification bitmap memory\");\n+      os::commit_memory_or_exit(verify_bitmap.base(), verify_bitmap.size(), bitmap_page_size, false,\n+                                \"Cannot commit verification bitmap memory\");\n@@ -278,0 +279,1 @@\n+    MemTracker::record_virtual_memory_type(verify_bitmap.base(), mtGC);\n@@ -293,1 +295,1 @@\n-  ReservedSpace aux_bitmap(_bitmap_size, aux_bitmap_page_size, mtGC);\n+  ReservedSpace aux_bitmap(_bitmap_size, aux_bitmap_page_size);\n@@ -298,0 +300,1 @@\n+  MemTracker::record_virtual_memory_type(aux_bitmap.base(), mtGC);\n@@ -310,1 +313,1 @@\n-  ReservedSpace region_storage(region_storage_size, region_page_size, mtGC);\n+  ReservedSpace region_storage(region_storage_size, region_page_size);\n@@ -315,0 +318,1 @@\n+  MemTracker::record_virtual_memory_type(region_storage.base(), mtGC);\n@@ -316,2 +320,2 @@\n-    os::commit_memory_or_exit(region_storage.base(), region_storage_size, region_page_size, !ExecMem,\n-                              mtGC, \"Cannot commit region memory\");\n+    os::commit_memory_or_exit(region_storage.base(), region_storage_size, region_page_size, false,\n+                              \"Cannot commit region memory\");\n@@ -335,1 +339,1 @@\n-      cset_rs = ReservedSpace(cset_size, cset_align, cset_page_size, mtGC, req_addr);\n+      cset_rs = ReservedSpace(cset_size, cset_align, cset_page_size, req_addr);\n@@ -344,1 +348,1 @@\n-      cset_rs = ReservedSpace(cset_size, cset_align, os::vm_page_size(), mtGC);\n+      cset_rs = ReservedSpace(cset_size, cset_align, os::vm_page_size());\n@@ -1413,1 +1417,1 @@\n-  if (!_aux_bitmap_region_special && !os::commit_memory((char*)_aux_bitmap_region.start(), _aux_bitmap_region.byte_size(), !ExecMem, mtGC)) {\n+  if (!_aux_bitmap_region_special && !os::commit_memory((char*)_aux_bitmap_region.start(), _aux_bitmap_region.byte_size(), false)) {\n@@ -1433,1 +1437,1 @@\n-  if (!_aux_bitmap_region_special && !os::uncommit_memory((char*)_aux_bitmap_region.start(), _aux_bitmap_region.byte_size(), !ExecMem, mtGC)) {\n+  if (!_aux_bitmap_region_special && !os::uncommit_memory((char*)_aux_bitmap_region.start(), _aux_bitmap_region.byte_size())) {\n@@ -2263,1 +2267,1 @@\n-  if (!os::commit_memory(start, len, !ExecMem, mtGC)) {\n+  if (!os::commit_memory(start, len, false)) {\n@@ -2292,1 +2296,1 @@\n-  if (!os::uncommit_memory((char*)_bitmap_region.start() + off, len, !ExecMem, mtGC)) {\n+  if (!os::uncommit_memory((char*)_bitmap_region.start() + off, len)) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":22,"deletions":18,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -623,1 +623,1 @@\n-  if (!heap->is_heap_region_special() && !os::commit_memory((char *) bottom(), RegionSizeBytes, !ExecMem, mtJavaHeap)) {\n+  if (!heap->is_heap_region_special() && !os::commit_memory((char *) bottom(), RegionSizeBytes, false)) {\n@@ -637,1 +637,1 @@\n-  if (!heap->is_heap_region_special() && !os::uncommit_memory((char *) bottom(), RegionSizeBytes, !ExecMem, mtJavaHeap)) {\n+  if (!heap->is_heap_region_special() && !os::uncommit_memory((char *) bottom(), RegionSizeBytes)) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -91,1 +91,1 @@\n-  os::commit_memory_or_exit((char*)_end, expand_size, !ExecMem, mtGC, \"Mark stack space\");\n+  os::commit_memory_or_exit((char*)_end, expand_size, false \/* executable *\/, \"Mark stack space\");\n@@ -108,1 +108,1 @@\n-    os::uncommit_memory((char*)shrink_start, shrink_size, !ExecMem, mtGC);\n+    os::uncommit_memory((char*)shrink_start, shrink_size, false \/* executable *\/);\n","filename":"src\/hotspot\/share\/gc\/x\/xMarkStackAllocator.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -282,1 +282,1 @@\n-  MemTracker::record_virtual_memory_commit((void*)addr, size, CALLER_PC, mtGC);\n+  MemTracker::record_virtual_memory_commit((void*)addr, size, CALLER_PC);\n@@ -288,1 +288,1 @@\n-  MemTracker::record_virtual_memory_uncommit((address)addr, size, mtGC);\n+  MemTracker::record_virtual_memory_uncommit((address)addr, size);\n","filename":"src\/hotspot\/share\/gc\/x\/xPhysicalMemory.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -184,1 +184,2 @@\n-  MemTracker::record_virtual_memory_reserve((void*)start, size, CALLER_PC, mtJavaHeap);\n+  MemTracker::record_virtual_memory_reserve((void*)start, size, CALLER_PC);\n+  MemTracker::record_virtual_memory_type((void*)start, mtJavaHeap);\n","filename":"src\/hotspot\/share\/gc\/x\/xVirtualMemory.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -90,1 +90,1 @@\n-  os::commit_memory_or_exit((char*)_end, expand_size, !ExecMem, mtGC, \"Mark stack space\");\n+  os::commit_memory_or_exit((char*)_end, expand_size, false \/* executable *\/, \"Mark stack space\");\n@@ -107,1 +107,1 @@\n-    os::uncommit_memory((char*)shrink_start, shrink_size, !ExecMem, mtGC);\n+    os::uncommit_memory((char*)shrink_start, shrink_size, false \/* executable *\/);\n","filename":"src\/hotspot\/share\/gc\/z\/zMarkStackAllocator.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -74,1 +74,1 @@\n-      MemTracker::record_virtual_memory_commit((void*)sub_range_addr, sub_range_size, CALLER_PC, mtGC);\n+      MemTracker::record_virtual_memory_commit((void*)sub_range_addr, sub_range_size, CALLER_PC);\n@@ -77,1 +77,1 @@\n-      MemTracker::record_virtual_memory_uncommit((address)sub_range_addr, sub_range_size, mtGC);\n+      MemTracker::record_virtual_memory_uncommit((address)sub_range_addr, sub_range_size);\n","filename":"src\/hotspot\/share\/gc\/z\/zNMT.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -107,2 +107,1 @@\n-                      os::vm_page_size(),\n-                      mtTracing);\n+                      os::vm_page_size());\n@@ -121,0 +120,1 @@\n+  MemTracker::record_virtual_memory_type((address)_rs.base(), mtTracing);\n","filename":"src\/hotspot\/share\/jfr\/recorder\/storage\/jfrVirtualMemory.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,1 @@\n-  if (os::commit_memory(addr, size, !ExecMem, flags)) {\n+  if (os::commit_memory(addr, size, !ExecMem)) {\n@@ -83,1 +83,1 @@\n-  os::commit_memory_or_exit(addr, size, !ExecMem, flags, \"Allocator (commit)\");\n+  os::commit_memory_or_exit(addr, size, !ExecMem, \"Allocator (commit)\");\n","filename":"src\/hotspot\/share\/memory\/allocation.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -230,1 +230,1 @@\n-  ReservedSpace seg_rs(reserved_segments_size, mtCode);\n+  ReservedSpace seg_rs(reserved_segments_size);\n@@ -235,0 +235,2 @@\n+  MemTracker::record_virtual_memory_type((address)_segmap.low_boundary(), mtCode);\n+\n","filename":"src\/hotspot\/share\/memory\/heap.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -592,1 +592,1 @@\n-    result = os::reserve_memory_aligned(size, Metaspace::reserve_alignment(), !ExecMem, mtClass);\n+    result = os::reserve_memory_aligned(size, Metaspace::reserve_alignment(), false);\n@@ -601,1 +601,1 @@\n-                                                      os::vm_page_size(), false, false, mtClass);\n+                                                      os::vm_page_size(), false, false);\n@@ -742,1 +742,1 @@\n-                         os::vm_page_size() \/* large *\/, mtClass, (char*)base);\n+                         os::vm_page_size() \/* large *\/, (char*)base);\n@@ -770,0 +770,3 @@\n+    \/\/ Mark class space as such\n+    MemTracker::record_virtual_memory_type((address)rs.base(), mtClass);\n+\n","filename":"src\/hotspot\/share\/memory\/metaspace.cpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -81,1 +81,1 @@\n-    _rs = ReservedSpace(reserve_limit * BytesPerWord, Metaspace::reserve_alignment(), os::vm_page_size(), mtMetaspace);\n+    _rs = ReservedSpace(reserve_limit * BytesPerWord, Metaspace::reserve_alignment(), os::vm_page_size());\n","filename":"src\/hotspot\/share\/memory\/metaspace\/testHelpers.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -112,1 +112,1 @@\n-  if (os::commit_memory((char*)p, word_size * BytesPerWord, !ExecMem, _rs.nmt_flag()) == false) {\n+  if (os::commit_memory((char*)p, word_size * BytesPerWord, false) == false) {\n@@ -191,1 +191,1 @@\n-  if (os::uncommit_memory((char*)p, word_size * BytesPerWord, !ExecMem, _rs.nmt_flag()) == false) {\n+  if (os::uncommit_memory((char*)p, word_size * BytesPerWord) == false) {\n@@ -258,1 +258,1 @@\n-                   os::vm_page_size(), mtMetaspace);\n+                   os::vm_page_size());\n@@ -262,0 +262,1 @@\n+  MemTracker::record_virtual_memory_type(rs.base(), mtMetaspace);\n","filename":"src\/hotspot\/share\/memory\/metaspace\/virtualSpaceNode.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -45,1 +45,1 @@\n-    _alignment(0), _fd_for_heap(-1), _special(false), _executable(false), _flag(mtNone) {\n+    _alignment(0), _special(false), _fd_for_heap(-1), _executable(false) {\n@@ -48,1 +48,1 @@\n-ReservedSpace::ReservedSpace(size_t size, MEMFLAGS flag) : _fd_for_heap(-1), _flag(flag) {\n+ReservedSpace::ReservedSpace(size_t size) : _fd_for_heap(-1) {\n@@ -54,1 +54,1 @@\n-  initialize(size, alignment, page_size, nullptr, false, flag);\n+  initialize(size, alignment, page_size, nullptr, false);\n@@ -57,1 +57,1 @@\n-ReservedSpace::ReservedSpace(size_t size, size_t preferred_page_size, MEMFLAGS flag) : _fd_for_heap(-1), _flag(flag) {\n+ReservedSpace::ReservedSpace(size_t size, size_t preferred_page_size) : _fd_for_heap(-1) {\n@@ -66,1 +66,1 @@\n-  initialize(size, alignment, preferred_page_size, nullptr, false, flag);\n+  initialize(size, alignment, preferred_page_size, nullptr, false);\n@@ -72,3 +72,2 @@\n-                             MEMFLAGS flag,\n-                             char* requested_address) : _fd_for_heap(-1), _flag(flag) {\n-  initialize(size, alignment, page_size, requested_address, false, flag);\n+                             char* requested_address) : _fd_for_heap(-1) {\n+  initialize(size, alignment, page_size, requested_address, false);\n@@ -78,1 +77,1 @@\n-                             bool special, bool executable, MEMFLAGS flag) : _fd_for_heap(-1), _flag(flag) {\n+                             bool special, bool executable) : _fd_for_heap(-1) {\n@@ -81,1 +80,1 @@\n-  initialize_members(base, size, alignment, page_size, special, executable, flag);\n+  initialize_members(base, size, alignment, page_size, special, executable);\n@@ -85,1 +84,1 @@\n-static char* attempt_map_or_reserve_memory_at(char* base, size_t size, int fd, bool executable, MEMFLAGS flag) {\n+static char* attempt_map_or_reserve_memory_at(char* base, size_t size, int fd, bool executable) {\n@@ -87,1 +86,1 @@\n-    return os::attempt_map_memory_to_file_at(base, size, fd, flag);\n+    return os::attempt_map_memory_to_file_at(base, size, fd);\n@@ -89,1 +88,1 @@\n-  return os::attempt_reserve_memory_at(base, size, executable, flag);\n+  return os::attempt_reserve_memory_at(base, size, executable);\n@@ -93,1 +92,1 @@\n-static char* map_or_reserve_memory(size_t size, int fd, bool executable, MEMFLAGS flag) {\n+static char* map_or_reserve_memory(size_t size, int fd, bool executable) {\n@@ -95,1 +94,1 @@\n-    return os::map_memory_to_file(size, fd, flag);\n+    return os::map_memory_to_file(size, fd);\n@@ -97,1 +96,1 @@\n-  return os::reserve_memory(size, executable, flag);\n+  return os::reserve_memory(size, executable);\n@@ -101,1 +100,1 @@\n-static char* map_or_reserve_memory_aligned(size_t size, size_t alignment, int fd, bool executable, MEMFLAGS flag) {\n+static char* map_or_reserve_memory_aligned(size_t size, size_t alignment, int fd, bool executable) {\n@@ -103,1 +102,1 @@\n-    return os::map_memory_to_file_aligned(size, alignment, fd, flag);\n+    return os::map_memory_to_file_aligned(size, alignment, fd);\n@@ -105,1 +104,1 @@\n-  return os::reserve_memory_aligned(size, alignment, executable, flag);\n+  return os::reserve_memory_aligned(size, alignment, executable);\n@@ -158,1 +157,1 @@\n-                            const size_t alignment, int fd, bool exec, MEMFLAGS flag) {\n+                            const size_t alignment, int fd, bool exec) {\n@@ -167,1 +166,1 @@\n-    base = attempt_map_or_reserve_memory_at(requested_address, size, fd, exec, flag);\n+    base = attempt_map_or_reserve_memory_at(requested_address, size, fd, exec);\n@@ -172,1 +171,1 @@\n-    base = map_or_reserve_memory(size, fd, exec, flag);\n+    base = map_or_reserve_memory(size, fd, exec);\n@@ -179,1 +178,1 @@\n-      base = map_or_reserve_memory_aligned(size, alignment, fd, exec, flag);\n+      base = map_or_reserve_memory_aligned(size, alignment, fd, exec);\n@@ -187,1 +186,1 @@\n-                                    const size_t alignment, const size_t page_size, bool exec, MEMFLAGS flag) {\n+                                    const size_t alignment, const size_t page_size, bool exec) {\n@@ -194,1 +193,1 @@\n-  char* base = os::reserve_memory_special(size, alignment, page_size, requested_address, exec, flag);\n+  char* base = os::reserve_memory_special(size, alignment, page_size, requested_address, exec);\n@@ -206,1 +205,1 @@\n-  initialize_members(nullptr, 0, 0, 0, false, false, mtNone);\n+  initialize_members(nullptr, 0, 0, 0, false, false);\n@@ -210,1 +209,1 @@\n-                                       size_t page_size, bool special, bool executable, MEMFLAGS flag) {\n+                                       size_t page_size, bool special, bool executable) {\n@@ -213,1 +212,0 @@\n-  _noaccess_prefix = 0;\n@@ -218,1 +216,1 @@\n-  _flag = flag;\n+  _noaccess_prefix = 0;\n@@ -240,1 +238,1 @@\n-    char* base = reserve_memory(requested_address, size, alignment, _fd_for_heap, executable, _flag);\n+    char* base = reserve_memory(requested_address, size, alignment, _fd_for_heap, executable);\n@@ -242,1 +240,1 @@\n-      initialize_members(base, size, alignment, os::vm_page_size(), true, executable, _flag);\n+      initialize_members(base, size, alignment, os::vm_page_size(), true, executable);\n@@ -255,1 +253,1 @@\n-      char* base = reserve_memory_special(requested_address, size, alignment, page_size, executable, _flag);\n+      char* base = reserve_memory_special(requested_address, size, alignment, page_size, executable);\n@@ -258,1 +256,1 @@\n-        initialize_members(base, size, alignment, page_size, true, executable, _flag);\n+        initialize_members(base, size, alignment, page_size, true, executable);\n@@ -271,1 +269,1 @@\n-  char* base = reserve_memory(requested_address, size, alignment, -1, executable, _flag);\n+  char* base = reserve_memory(requested_address, size, alignment, -1, executable);\n@@ -274,1 +272,1 @@\n-    initialize_members(base, size, alignment, page_size, false, executable, _flag);\n+    initialize_members(base, size, alignment, page_size, false, executable);\n@@ -282,2 +280,1 @@\n-                               bool executable,\n-                               MEMFLAGS flag) {\n+                               bool executable) {\n@@ -296,3 +293,0 @@\n-  \/\/ _flag is cleared in clear_members in above call\n-  _flag = flag;\n-\n@@ -319,1 +313,1 @@\n-  ReservedSpace result(base(), partition_size, alignment, page_size(), special(), executable(), nmt_flag());\n+  ReservedSpace result(base(), partition_size, alignment, page_size(), special(), executable());\n@@ -326,1 +320,1 @@\n-                       alignment, page_size(), special(), executable(), nmt_flag());\n+                       alignment, page_size(), special(), executable());\n@@ -369,1 +363,1 @@\n-                                             size_t page_size, bool special, bool executable, MEMFLAGS flag) {\n+                                             size_t page_size, bool special, bool executable) {\n@@ -374,1 +368,1 @@\n-  space.initialize_members(base, size, alignment, page_size, special, executable, flag);\n+  space.initialize_members(base, size, alignment, page_size, special, executable);\n@@ -616,1 +610,1 @@\n-      initialize(size + noaccess_prefix, alignment, page_size, nullptr, !ExecMem, nmt_flag());\n+      initialize(size + noaccess_prefix, alignment, page_size, nullptr, false);\n@@ -622,0 +616,1 @@\n+\n@@ -625,2 +620,0 @@\n-  \/\/ _flag is used internally by initialize_compressed_heap\n-  _flag = mtJavaHeap;\n@@ -654,1 +647,1 @@\n-    initialize(size, alignment, page_size, nullptr, false, nmt_flag());\n+    initialize(size, alignment, page_size, nullptr, false);\n@@ -662,0 +655,3 @@\n+  if (base() != nullptr) {\n+    MemTracker::record_virtual_memory_type((address)base(), mtJavaHeap);\n+  }\n@@ -677,1 +673,2 @@\n-  initialize(r_size, rs_align, rs_page_size, \/*requested address*\/ nullptr, \/*executable*\/ true, mtCode);\n+  initialize(r_size, rs_align, rs_page_size, \/*requested address*\/ nullptr, \/*executable*\/ true);\n+  MemTracker::record_virtual_memory_type((address)base(), mtCode);\n@@ -698,1 +695,0 @@\n-  _flag                   = mtNone;\n@@ -720,1 +716,0 @@\n-  _flag = rs.nmt_flag();\n@@ -779,1 +774,0 @@\n-  _flag                   = mtNone;\n@@ -845,2 +839,2 @@\n-static bool commit_expanded(char* start, size_t size, size_t alignment, bool pre_touch, bool executable, MEMFLAGS flag) {\n-  if (os::commit_memory(start, size, alignment, executable, flag)) {\n+static bool commit_expanded(char* start, size_t size, size_t alignment, bool pre_touch, bool executable) {\n+  if (os::commit_memory(start, size, alignment, executable)) {\n@@ -935,1 +929,1 @@\n-    if (!commit_expanded(lower_high(), lower_needs, _lower_alignment, pre_touch, _executable, _flag)) {\n+    if (!commit_expanded(lower_high(), lower_needs, _lower_alignment, pre_touch, _executable)) {\n@@ -943,1 +937,1 @@\n-    if (!commit_expanded(middle_high(), middle_needs, _middle_alignment, pre_touch, _executable, _flag)) {\n+    if (!commit_expanded(middle_high(), middle_needs, _middle_alignment, pre_touch, _executable)) {\n@@ -951,1 +945,1 @@\n-    if (!commit_expanded(upper_high(), upper_needs, _upper_alignment, pre_touch, _executable, _flag)) {\n+    if (!commit_expanded(upper_high(), upper_needs, _upper_alignment, pre_touch, _executable)) {\n@@ -1023,1 +1017,1 @@\n-    if (!os::uncommit_memory(aligned_upper_new_high, upper_needs, _executable, _flag)) {\n+    if (!os::uncommit_memory(aligned_upper_new_high, upper_needs, _executable)) {\n@@ -1034,1 +1028,1 @@\n-    if (!os::uncommit_memory(aligned_middle_new_high, middle_needs, _executable, _flag)) {\n+    if (!os::uncommit_memory(aligned_middle_new_high, middle_needs, _executable)) {\n@@ -1045,1 +1039,1 @@\n-    if (!os::uncommit_memory(aligned_lower_new_high, lower_needs, _executable, _flag)) {\n+    if (!os::uncommit_memory(aligned_lower_new_high, lower_needs, _executable)) {\n","filename":"src\/hotspot\/share\/memory\/virtualspace.cpp","additions":54,"deletions":60,"binary":false,"changes":114,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -38,9 +38,7 @@\n-  char*    _base;\n-  size_t   _size;\n-  size_t   _noaccess_prefix;\n-  size_t   _alignment;\n-  size_t   _page_size;\n-  int      _fd_for_heap;\n-  bool     _special;\n-  bool     _executable;\n-  MEMFLAGS _flag;\n+  char*  _base;\n+  size_t _size;\n+  size_t _noaccess_prefix;\n+  size_t _alignment;\n+  size_t _page_size;\n+  bool   _special;\n+  int    _fd_for_heap;\n@@ -48,0 +46,1 @@\n+  bool   _executable;\n@@ -51,1 +50,1 @@\n-                size_t page_size, bool special, bool executable, MEMFLAGS flag);\n+                size_t page_size, bool special, bool executable);\n@@ -62,1 +61,1 @@\n-                          size_t page_size, bool special, bool executable, MEMFLAGS flag);\n+                          size_t page_size, bool special, bool executable);\n@@ -65,1 +64,1 @@\n-                  char* requested_address, bool executable, MEMFLAGS flag);\n+                  char* requested_address, bool executable);\n@@ -70,3 +69,0 @@\n-\n-  MEMFLAGS nmt_flag() const { return _flag; }\n-\n@@ -77,1 +73,1 @@\n-  explicit ReservedSpace(size_t size, MEMFLAGS flag);\n+  explicit ReservedSpace(size_t size);\n@@ -82,2 +78,2 @@\n-  ReservedSpace(size_t size, size_t preferred_page_size, MEMFLAGS flag);\n-  ReservedSpace(size_t size, size_t alignment, size_t page_size, MEMFLAGS flag,\n+  ReservedSpace(size_t size, size_t preferred_page_size);\n+  ReservedSpace(size_t size, size_t alignment, size_t page_size,\n@@ -119,1 +115,1 @@\n-                                       size_t page_size, bool special, bool executable, MEMFLAGS flag);\n+                                       size_t page_size, bool special, bool executable);\n@@ -186,2 +182,0 @@\n-  MEMFLAGS _flag;\n-\n","filename":"src\/hotspot\/share\/memory\/virtualspace.hpp","additions":16,"deletions":22,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -123,1 +123,1 @@\n-    MEMFLAGS flag) {\n+    MEMFLAGS flag = mtNone) {\n@@ -140,1 +140,1 @@\n-  static inline void record_virtual_memory_uncommit(address addr, size_t size, MEMFLAGS flag) {\n+  static inline void record_virtual_memory_uncommit(address addr, size_t size) {\n@@ -144,1 +144,1 @@\n-      VirtualMemoryTracker::remove_uncommitted_region((address)addr, size, flag);\n+      VirtualMemoryTracker::remove_uncommitted_region((address)addr, size);\n@@ -149,1 +149,1 @@\n-    const NativeCallStack& stack, MEMFLAGS flag) {\n+    const NativeCallStack& stack, MEMFLAGS flag = mtNone) {\n@@ -155,1 +155,1 @@\n-      VirtualMemoryTracker::add_committed_region((address)addr, size, stack, flag);\n+      VirtualMemoryTracker::add_committed_region((address)addr, size, stack);\n@@ -160,1 +160,1 @@\n-    const NativeCallStack& stack, MEMFLAGS flag) {\n+    const NativeCallStack& stack) {\n@@ -165,1 +165,1 @@\n-      VirtualMemoryTracker::add_committed_region((address)addr, size, stack, flag);\n+      VirtualMemoryTracker::add_committed_region((address)addr, size, stack);\n","filename":"src\/hotspot\/share\/nmt\/memTracker.hpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -427,2 +427,2 @@\n-      assert(reserved_rgn->flag() == mtNone, \"Overwrite memory type (should be mtNone, is: \\\"%s\\\") wants to change to \\\"%s\\\"\",\n-             NMTUtil::flag_to_name(reserved_rgn->flag()), NMTUtil::flag_to_name(flag));\n+      assert(reserved_rgn->flag() == mtNone, \"Overwrite memory type (should be mtNone, is: \\\"%s\\\")\",\n+             NMTUtil::flag_to_name(reserved_rgn->flag()));\n@@ -435,1 +435,1 @@\n-  const NativeCallStack& stack, MEMFLAGS flag) {\n+  const NativeCallStack& stack) {\n@@ -440,1 +440,1 @@\n-  ReservedMemoryRegion  rgn(addr, size, stack, flag);\n+  ReservedMemoryRegion  rgn(addr, size);\n@@ -455,1 +455,1 @@\n-bool VirtualMemoryTracker::remove_uncommitted_region(address addr, size_t size, MEMFLAGS flag) {\n+bool VirtualMemoryTracker::remove_uncommitted_region(address addr, size_t size) {\n","filename":"src\/hotspot\/share\/nmt\/virtualMemoryTracker.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -299,1 +299,1 @@\n-    MEMFLAGS flag) :\n+    MEMFLAGS flag = mtNone) :\n@@ -306,3 +306,0 @@\n-  ReservedMemoryRegion(address base, size_t size, MEMFLAGS flag) :\n-    VirtualMemoryRegion(base, size), _stack(NativeCallStack::empty_stack()), _flag(flag) { }\n-\n@@ -385,1 +382,1 @@\n-  static bool add_reserved_region (address base_addr, size_t size, const NativeCallStack& stack, MEMFLAGS flag);\n+  static bool add_reserved_region (address base_addr, size_t size, const NativeCallStack& stack, MEMFLAGS flag = mtNone);\n@@ -387,2 +384,2 @@\n-  static bool add_committed_region      (address base_addr, size_t size, const NativeCallStack& stack, MEMFLAGS flag);\n-  static bool remove_uncommitted_region (address base_addr, size_t size, MEMFLAGS flag);\n+  static bool add_committed_region      (address base_addr, size_t size, const NativeCallStack& stack);\n+  static bool remove_uncommitted_region (address base_addr, size_t size);\n","filename":"src\/hotspot\/share\/nmt\/virtualMemoryTracker.hpp","additions":5,"deletions":8,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -72,1 +72,1 @@\n-  return os::attempt_reserve_memory_between((char*)from, (char*)to, size, alignment, aslr, mtMetaspace);\n+  return os::attempt_reserve_memory_between((char*)from, (char*)to, size, alignment, aslr);\n","filename":"src\/hotspot\/share\/oops\/compressedKlass.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -2399,1 +2399,1 @@\n-    bad_address = os::reserve_memory(size, !ExecMem, mtInternal);\n+    bad_address = os::reserve_memory(size);\n@@ -2403,0 +2403,1 @@\n+      MemTracker::record_virtual_memory_type((void*)bad_address, mtInternal);\n","filename":"src\/hotspot\/share\/prims\/jni.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -700,1 +700,4 @@\n-  addr = (jlong)(uintptr_t)os::reserve_memory(size, !ExecMem, mtTest);\n+\n+  addr = (jlong)(uintptr_t)os::reserve_memory(size);\n+  MemTracker::record_virtual_memory_type((address)addr, mtTest);\n+\n@@ -705,1 +708,3 @@\n-  addr = (jlong)(uintptr_t)os::attempt_reserve_memory_at((char*)(uintptr_t)addr, (size_t)size, !ExecMem, mtTest);\n+  addr = (jlong)(uintptr_t)os::attempt_reserve_memory_at((char*)(uintptr_t)addr, (size_t)size);\n+  MemTracker::record_virtual_memory_type((address)addr, mtTest);\n+\n@@ -710,1 +715,2 @@\n-  os::commit_memory((char *)(uintptr_t)addr, size, !ExecMem, mtTest);\n+  os::commit_memory((char *)(uintptr_t)addr, size, !ExecMem);\n+  MemTracker::record_virtual_memory_type((address)(uintptr_t)addr, mtTest);\n@@ -714,1 +720,1 @@\n-  os::uncommit_memory((char *)(uintptr_t)addr, size, !ExecMem, mtTest);\n+  os::uncommit_memory((char *)(uintptr_t)addr, size);\n@@ -1483,1 +1489,1 @@\n-  p = os::reserve_memory(os::vm_allocation_granularity(), !ExecMem, mtTest);\n+  p = os::reserve_memory(os::vm_allocation_granularity());\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1824,1 +1824,1 @@\n-  char* result = pd_reserve_memory(bytes, executable, flags);\n+  char* result = pd_reserve_memory(bytes, executable);\n@@ -1835,1 +1835,1 @@\n-  char* result = SimulateFullAddressSpace ? nullptr : pd_attempt_reserve_memory_at(addr, bytes, executable, flag);\n+  char* result = SimulateFullAddressSpace ? nullptr : pd_attempt_reserve_memory_at(addr, bytes, executable);\n@@ -1882,1 +1882,1 @@\n-char* os::attempt_reserve_memory_between(char* min, char* max, size_t bytes, size_t alignment, bool randomize, MEMFLAGS flag) {\n+char* os::attempt_reserve_memory_between(char* min, char* max, size_t bytes, size_t alignment, bool randomize) {\n@@ -2020,1 +2020,1 @@\n-    result = SimulateFullAddressSpace ? nullptr : os::pd_attempt_reserve_memory_at(candidate, bytes, !ExecMem, flag);\n+    result = SimulateFullAddressSpace ? nullptr : os::pd_attempt_reserve_memory_at(candidate, bytes, false);\n@@ -2037,1 +2037,1 @@\n-    MemTracker::record_virtual_memory_reserve((address)result, bytes, CALLER_PC, flag);\n+    MemTracker::record_virtual_memory_reserve((address)result, bytes, CALLER_PC);\n@@ -2053,1 +2053,1 @@\n-bool os::commit_memory(char* addr, size_t bytes, bool executable, MEMFLAGS flag) {\n+bool os::commit_memory(char* addr, size_t bytes, bool executable) {\n@@ -2057,1 +2057,1 @@\n-    MemTracker::record_virtual_memory_commit((address)addr, bytes, CALLER_PC, flag);\n+    MemTracker::record_virtual_memory_commit((address)addr, bytes, CALLER_PC);\n@@ -2066,1 +2066,1 @@\n-                              bool executable, MEMFLAGS flag) {\n+                              bool executable) {\n@@ -2070,1 +2070,1 @@\n-    MemTracker::record_virtual_memory_commit((address)addr, size, CALLER_PC, flag);\n+    MemTracker::record_virtual_memory_commit((address)addr, size, CALLER_PC);\n@@ -2079,1 +2079,1 @@\n-                               MEMFLAGS flag, const char* mesg) {\n+                               const char* mesg) {\n@@ -2082,1 +2082,1 @@\n-  MemTracker::record_virtual_memory_commit((address)addr, bytes, CALLER_PC, flag);\n+  MemTracker::record_virtual_memory_commit((address)addr, bytes, CALLER_PC);\n@@ -2086,1 +2086,1 @@\n-                               bool executable, MEMFLAGS flag, const char* mesg) {\n+                               bool executable, const char* mesg) {\n@@ -2089,1 +2089,1 @@\n-  MemTracker::record_virtual_memory_commit((address)addr, size, CALLER_PC, flag);\n+  MemTracker::record_virtual_memory_commit((address)addr, size, CALLER_PC);\n@@ -2092,1 +2092,1 @@\n-bool os::uncommit_memory(char* addr, size_t bytes, bool executable, MEMFLAGS flag) {\n+bool os::uncommit_memory(char* addr, size_t bytes, bool executable) {\n@@ -2099,1 +2099,1 @@\n-      MemTracker::record_virtual_memory_uncommit((address)addr, bytes, flag);\n+      MemTracker::record_virtual_memory_uncommit((address)addr, bytes);\n@@ -2183,1 +2183,1 @@\n-  char* result = pd_attempt_map_memory_to_file_at(addr, bytes, file_desc, flag);\n+  char* result = pd_attempt_map_memory_to_file_at(addr, bytes, file_desc);\n@@ -2191,2 +2191,2 @@\n-                     char *addr, size_t bytes, bool read_only,\n-                     bool allow_exec, MEMFLAGS flags) {\n+                           char *addr, size_t bytes, bool read_only,\n+                           bool allow_exec, MEMFLAGS flags) {\n@@ -2214,2 +2214,2 @@\n-void os::free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag) {\n-  pd_free_memory(addr, bytes, alignment_hint, flag);\n+void os::free_memory(char *addr, size_t bytes, size_t alignment_hint) {\n+  pd_free_memory(addr, bytes, alignment_hint);\n@@ -2223,1 +2223,1 @@\n-                                 char* addr, bool executable, MEMFLAGS flag) {\n+                                 char* addr, bool executable) {\n@@ -2227,1 +2227,1 @@\n-  char* result = pd_reserve_memory_special(size, alignment, page_size, addr, executable, flag);\n+  char* result = pd_reserve_memory_special(size, alignment, page_size, addr, executable);\n@@ -2230,1 +2230,1 @@\n-    MemTracker::record_virtual_memory_reserve_and_commit((address)result, size, CALLER_PC, flag);\n+    MemTracker::record_virtual_memory_reserve_and_commit((address)result, size, CALLER_PC);\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":23,"deletions":23,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -211,1 +211,1 @@\n-  static char*  pd_reserve_memory(size_t bytes, bool executable, MEMFLAGS flag);\n+  static char*  pd_reserve_memory(size_t bytes, bool executable);\n@@ -213,1 +213,1 @@\n-  static char*  pd_attempt_reserve_memory_at(char* addr, size_t bytes, bool executable, MEMFLAGS flag);\n+  static char*  pd_attempt_reserve_memory_at(char* addr, size_t bytes, bool executable);\n@@ -228,1 +228,1 @@\n-  static char*  pd_attempt_map_memory_to_file_at(char* addr, size_t bytes, int file_desc, MEMFLAGS flag);\n+  static char*  pd_attempt_map_memory_to_file_at(char* addr, size_t bytes, int file_desc);\n@@ -231,2 +231,2 @@\n-                              char *addr, size_t bytes, bool read_only = false,\n-                              bool allow_exec = false);\n+                           char *addr, size_t bytes, bool read_only = false,\n+                           bool allow_exec = false);\n@@ -234,1 +234,1 @@\n-  static void   pd_free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag);\n+  static void   pd_free_memory(char *addr, size_t bytes, size_t alignment_hint);\n@@ -242,1 +242,2 @@\n-                                          char* addr, bool executable, MEMFLAGS flag);\n+\n+                                          char* addr, bool executable);\n@@ -450,1 +451,1 @@\n-  static char*  reserve_memory(size_t bytes, bool executable, MEMFLAGS flags);\n+  static char*  reserve_memory(size_t bytes, bool executable = false, MEMFLAGS flags = mtNone);\n@@ -453,1 +454,1 @@\n-  static char*  reserve_memory_aligned(size_t size, size_t alignment, bool executable, MEMFLAGS flag);\n+  static char*  reserve_memory_aligned(size_t size, size_t alignment, bool executable = false);\n@@ -457,1 +458,1 @@\n-  static char*  attempt_reserve_memory_at(char* addr, size_t bytes, bool executable, MEMFLAGS flag);\n+  static char*  attempt_reserve_memory_at(char* addr, size_t bytes, bool executable = false, MEMFLAGS flag = mtNone);\n@@ -461,1 +462,1 @@\n-  static char* attempt_reserve_memory_between(char* min, char* max, size_t bytes, size_t alignment, bool randomize, MEMFLAGS flag);\n+  static char* attempt_reserve_memory_between(char* min, char* max, size_t bytes, size_t alignment, bool randomize);\n@@ -463,1 +464,1 @@\n-  static bool   commit_memory(char* addr, size_t bytes, bool executable, MEMFLAGS flag);\n+  static bool   commit_memory(char* addr, size_t bytes, bool executable);\n@@ -465,1 +466,1 @@\n-                              bool executable, MEMFLAGS flag);\n+                              bool executable);\n@@ -469,1 +470,1 @@\n-                                      bool executable, MEMFLAGS flag, const char* mesg);\n+                                      bool executable, const char* mesg);\n@@ -472,2 +473,2 @@\n-                                      bool executable, MEMFLAGS flag, const char* mesg);\n-  static bool   uncommit_memory(char* addr, size_t bytes, bool executable, MEMFLAGS flag);\n+                                      bool executable, const char* mesg);\n+  static bool   uncommit_memory(char* addr, size_t bytes, bool executable = false);\n@@ -509,2 +510,2 @@\n-  static char* map_memory_to_file(size_t size, int fd, MEMFLAGS flag);\n-  static char* map_memory_to_file_aligned(size_t size, size_t alignment, int fd, MEMFLAGS flag);\n+  static char* map_memory_to_file(size_t size, int fd, MEMFLAGS flag = mtNone);\n+  static char* map_memory_to_file_aligned(size_t size, size_t alignment, int fd, MEMFLAGS flag = mtNone);\n@@ -512,1 +513,1 @@\n-  static char* attempt_map_memory_to_file_at(char* base, size_t size, int fd, MEMFLAGS flag);\n+  static char* attempt_map_memory_to_file_at(char* base, size_t size, int fd, MEMFLAGS flag = mtNone);\n@@ -517,2 +518,2 @@\n-                           char *addr, size_t bytes, bool read_only,\n-                           bool allow_exec, MEMFLAGS flag);\n+                           char *addr, size_t bytes, bool read_only = false,\n+                           bool allow_exec = false, MEMFLAGS flags = mtNone);\n@@ -520,1 +521,1 @@\n-  static void   free_memory(char *addr, size_t bytes, size_t alignment_hint, MEMFLAGS flag);\n+  static void   free_memory(char *addr, size_t bytes, size_t alignment_hint);\n@@ -542,1 +543,1 @@\n-                                       char* addr, bool executable, MEMFLAGS flag);\n+                                       char* addr, bool executable);\n","filename":"src\/hotspot\/share\/runtime\/os.hpp","additions":24,"deletions":23,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -61,2 +61,3 @@\n-    char* polling_page = os::reserve_memory(allocation_size, !ExecMem, mtSafepoint);\n-    os::commit_memory_or_exit(polling_page, allocation_size, !ExecMem, mtSafepoint, \"Unable to commit Safepoint polling page\");\n+    char* polling_page = os::reserve_memory(allocation_size);\n+    os::commit_memory_or_exit(polling_page, allocation_size, false, \"Unable to commit Safepoint polling page\");\n+    MemTracker::record_virtual_memory_type((address)polling_page, mtSafepoint);\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -712,1 +712,1 @@\n-  char* page = os::reserve_memory(os::vm_page_size(), !ExecMem, mtInternal);\n+  char* page = os::reserve_memory(os::vm_page_size());\n@@ -714,1 +714,2 @@\n-    if (os::commit_memory(page, os::vm_page_size(), !ExecMem, mtInternal) &&\n+    MemTracker::record_virtual_memory_type(page, mtInternal);\n+    if (os::commit_memory(page, os::vm_page_size(), false) &&\n","filename":"src\/hotspot\/share\/utilities\/debug.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n-  ReservedSpace bot_rs(G1BlockOffsetTable::compute_size(heap.word_size()), mtTest);\n+  ReservedSpace bot_rs(G1BlockOffsetTable::compute_size(heap.word_size()));\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_freeRegionList.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -84,1 +84,1 @@\n-  ReservedSpace rs(size, os::vm_page_size(), mtTest);\n+  ReservedSpace rs(size, os::vm_page_size());\n@@ -108,1 +108,1 @@\n-  ReservedSpace rs(size, page_size, mtTest);\n+  ReservedSpace rs(size, page_size);\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_stressCommitUncommit.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,1 +59,1 @@\n-      char* const reserved = os::attempt_reserve_memory_at((char*)ZAddressHeapBase + start, ZGranuleSize, !ExecMem \/* executable *\/, mtTest);\n+      char* const reserved = os::attempt_reserve_memory_at((char*)ZAddressHeapBase + start, ZGranuleSize, false \/* executable *\/);\n@@ -103,1 +103,1 @@\n-    os::commit_memory((char*)_reserved, ZGranuleSize, !ExecMem \/* executable *\/, mtTest);\n+    os::commit_memory((char*)_reserved, ZGranuleSize, false \/* executable *\/);\n@@ -114,1 +114,1 @@\n-      os::uncommit_memory((char*)_reserved, ZGranuleSize, !ExecMem, mtTest);\n+      os::uncommit_memory((char*)_reserved, ZGranuleSize, false \/* executable *\/);\n","filename":"test\/hotspot\/gtest\/gc\/z\/test_zForwarding.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -67,1 +67,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n@@ -81,1 +81,1 @@\n-    ReservedSpace rs(size, alignment, page_size, mtTest, (char *) nullptr);\n+    ReservedSpace rs(size, alignment, page_size, (char *) nullptr);\n@@ -109,1 +109,1 @@\n-    ReservedSpace rs(size, alignment, page_size, mtTest);\n+    ReservedSpace rs(size, alignment, page_size);\n@@ -218,1 +218,1 @@\n-        return ReservedSpace(reserve_size_aligned, mtTest);\n+        return ReservedSpace(reserve_size_aligned);\n@@ -223,2 +223,1 @@\n-                             os::vm_page_size(),\n-                             mtTest);\n+                             os::vm_page_size());\n@@ -303,1 +302,1 @@\n-  ReservedSpace reserved(large_page_size, large_page_size, large_page_size, mtTest);\n+  ReservedSpace reserved(large_page_size, large_page_size, large_page_size);\n@@ -373,1 +372,0 @@\n-                     mtTest, \/\/ NMT MEM Flag\n@@ -392,1 +390,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n@@ -417,1 +415,1 @@\n-    ReservedSpace rs(size, alignment, page_size, mtTest);\n+    ReservedSpace rs(size, alignment, page_size);\n@@ -521,1 +519,1 @@\n-      return ReservedSpace(reserve_size_aligned, mtTest);\n+      return ReservedSpace(reserve_size_aligned);\n@@ -526,1 +524,1 @@\n-                           os::vm_page_size(), mtTest);\n+                           os::vm_page_size());\n@@ -581,1 +579,1 @@\n-    ReservedSpace reserved(large_page_size, large_page_size, large_page_size, mtTest);\n+    ReservedSpace reserved(large_page_size, large_page_size, large_page_size);\n","filename":"test\/hotspot\/gtest\/memory\/test_virtualspace.cpp","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -117,1 +117,1 @@\n-  char* addr = os::reserve_memory(sz, !ExecMem, mtTest);\n+  char* addr = os::reserve_memory(sz, false, mtTest);\n","filename":"test\/hotspot\/gtest\/nmt\/test_nmt_locationprinting.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -96,1 +96,1 @@\n-    bool result = os::commit_memory(base, size, !ExecMem, mtThreadStack);\n+    bool result = os::commit_memory(base, size, !ExecMem);\n@@ -135,1 +135,1 @@\n-    os::free_memory(base, size, page_sz, mtThreadStack);\n+    os::free_memory(base, size, page_sz);\n@@ -165,1 +165,1 @@\n-    result = os::commit_memory(base, size, !ExecMem, mtTest);\n+    result = os::commit_memory(base, size, !ExecMem);\n","filename":"test\/hotspot\/gtest\/runtime\/test_committed_virtualmemory.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -370,1 +370,1 @@\n-  char* p = os::reserve_memory(len, executable, mtTest);\n+  char* p = os::reserve_memory(len, executable);\n@@ -408,1 +408,1 @@\n-    p = (address)os::reserve_memory(total_range_len, !ExecMem, mtTest);\n+    p = (address)os::reserve_memory(total_range_len);\n@@ -422,1 +422,1 @@\n-      q = (address)os::attempt_reserve_memory_at((char*)q, stripe_len, executable, mtTest);\n+      q = (address)os::attempt_reserve_memory_at((char*)q, stripe_len, executable);\n@@ -429,1 +429,1 @@\n-        EXPECT_TRUE(os::commit_memory((char*)q, stripe_len, executable, mtTest));\n+        EXPECT_TRUE(os::commit_memory((char*)q, stripe_len, executable));\n@@ -442,1 +442,1 @@\n-  address p = (address)os::reserve_memory(total_range_len, !ExecMem, mtTest);\n+  address p = (address)os::reserve_memory(total_range_len);\n@@ -447,1 +447,1 @@\n-      EXPECT_TRUE(os::commit_memory((char*)q, stripe_len, !ExecMem, mtTest));\n+      EXPECT_TRUE(os::commit_memory((char*)q, stripe_len, false));\n@@ -509,1 +509,1 @@\n-  address p2 = (address)os::attempt_reserve_memory_at((char*)p_middle_stripes, middle_stripe_len, !ExecMem, mtTest);\n+  address p2 = (address)os::attempt_reserve_memory_at((char*)p_middle_stripes, middle_stripe_len);\n@@ -532,1 +532,1 @@\n-  char* p = os::reserve_memory(4 * M, !ExecMem, mtTest);\n+  char* p = os::reserve_memory(4 * M);\n@@ -567,1 +567,1 @@\n-  address p2 = (address)os::attempt_reserve_memory_at((char*)border, stripe_len, !ExecMem, mtTest);\n+  address p2 = (address)os::attempt_reserve_memory_at((char*)border, stripe_len);\n@@ -608,1 +608,1 @@\n-  char* p = os::reserve_memory(1 * M, !ExecMem, mtInternal);\n+  char* p = os::reserve_memory(1 * M, false, mtInternal);\n@@ -610,1 +610,1 @@\n-    if (os::commit_memory(p, 1 * M, !ExecMem, mtTest)) {\n+    if (os::commit_memory(p, 1 * M, false)) {\n@@ -632,1 +632,1 @@\n-    address p = (address)os::reserve_memory(total_range_len, !ExecMem, mtTest);\n+    address p = (address)os::reserve_memory(total_range_len);\n@@ -937,1 +937,1 @@\n-  char* p1 = os::reserve_memory(M, !ExecMem, mtTest);\n+  char* p1 = os::reserve_memory(M, false, mtTest);\n@@ -939,1 +939,1 @@\n-  char* p2 = os::attempt_reserve_memory_at(p1, M, !ExecMem, mtTest);\n+  char* p2 = os::attempt_reserve_memory_at(p1, M);\n@@ -947,1 +947,1 @@\n-    char* p1 = os::reserve_memory_aligned(lpsz, lpsz, !ExecMem, mtTest);\n+    char* p1 = os::reserve_memory_aligned(lpsz, lpsz, false);\n@@ -949,1 +949,1 @@\n-    char* p2 = os::reserve_memory_special(lpsz, lpsz, lpsz, p1, !ExecMem, mtTest);\n+    char* p2 = os::reserve_memory_special(lpsz, lpsz, lpsz, p1, false);\n@@ -961,1 +961,1 @@\n-    char* p = os::attempt_reserve_memory_at((char*)0x1f00000, M, !ExecMem, mtTest);\n+    char* p = os::attempt_reserve_memory_at((char*)0x1f00000, M);\n@@ -963,1 +963,1 @@\n-    p = os::attempt_reserve_memory_at((char*)((64 * G) + M), M, !ExecMem, mtTest);\n+    p = os::attempt_reserve_memory_at((char*)((64 * G) + M), M);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os.cpp","additions":18,"deletions":18,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-      return os::reserve_memory_special(bytes, alignment, page_size, req_addr, exec, mtTest);\n+      return os::reserve_memory_special(bytes, alignment, page_size, req_addr, exec);\n@@ -227,1 +227,1 @@\n-    char* addr = os::reserve_memory_special(size, alignment, page_size, nullptr, !ExecMem, mtTest);\n+    char* addr = os::reserve_memory_special(size, alignment, page_size, nullptr, false);\n@@ -284,1 +284,1 @@\n-        char* p = os::reserve_memory_special(size, alignment, lp, nullptr, !ExecMem, mtTest);\n+        char* p = os::reserve_memory_special(size, alignment, lp, nullptr, false);\n@@ -299,1 +299,1 @@\n-        char* p = os::reserve_memory_special(size, alignment, lp, req_addr, !ExecMem, mtTest);\n+        char* p = os::reserve_memory_special(size, alignment, lp, req_addr, false);\n@@ -314,1 +314,1 @@\n-        char* p = os::reserve_memory_special(size, alignment, lp, req_addr, !ExecMem, mtTest);\n+        char* p = os::reserve_memory_special(size, alignment, lp, req_addr, false);\n@@ -358,1 +358,1 @@\n-  char* const heap = os::reserve_memory(size, !ExecMem, mtInternal);\n+  char* const heap = os::reserve_memory(size, false, mtInternal);\n@@ -360,1 +360,1 @@\n-  EXPECT_TRUE(os::commit_memory(heap, size, !ExecMem, mtInternal));\n+  EXPECT_TRUE(os::commit_memory(heap, size, false));\n@@ -382,1 +382,1 @@\n-  EXPECT_TRUE(os::uncommit_memory(heap, size, !ExecMem, mtInternal));\n+  EXPECT_TRUE(os::uncommit_memory(heap, size, false));\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_linux.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -69,1 +69,1 @@\n-  char* const  addr = os::attempt_reserve_memory_between(min, max, bytes, alignment, randomized, mtTest);\n+  char* const  addr = os::attempt_reserve_memory_between(min, max, bytes, alignment, randomized);\n@@ -161,1 +161,1 @@\n-        _base = os::attempt_reserve_memory_at((char*)candidate, _len, !ExecMem, mtTest);\n+        _base = os::attempt_reserve_memory_at((char*)candidate, _len);\n@@ -169,2 +169,2 @@\n-    _p1 = os::attempt_reserve_memory_at(_base + _p1_offset, _p1_size, !ExecMem, mtTest);\n-    _p2 = os::attempt_reserve_memory_at(_base + _p2_offset, _p2_size, !ExecMem, mtTest);\n+    _p1 = os::attempt_reserve_memory_at(_base + _p1_offset, _p1_size);\n+    _p2 = os::attempt_reserve_memory_at(_base + _p2_offset, _p2_size);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_reserve_between.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -70,1 +70,1 @@\n-  char* result = os::reserve_memory_special(large_allocation_size, os::large_page_size(), os::large_page_size(), nullptr, !ExecMem, mtTest);\n+  char* result = os::reserve_memory_special(large_allocation_size, os::large_page_size(), os::large_page_size(), nullptr, false);\n@@ -80,1 +80,1 @@\n-  char* actual_location = os::reserve_memory_special(expected_allocation_size, os::large_page_size(), os::large_page_size(), expected_location, !ExecMem, mtTest);\n+  char* actual_location = os::reserve_memory_special(expected_allocation_size, os::large_page_size(), os::large_page_size(), expected_location, false);\n@@ -85,1 +85,1 @@\n-  actual_location = os::reserve_memory_special(expected_allocation_size, os::large_page_size(), os::large_page_size(), expected_location, !ExecMem, mtTest);\n+  actual_location = os::reserve_memory_special(expected_allocation_size, os::large_page_size(), os::large_page_size(), expected_location, false);\n@@ -93,1 +93,1 @@\n-  char* aligned_request = os::reserve_memory_special(new_large_size, alignment, os::large_page_size(), nullptr, !ExecMem, mtTest);\n+  char* aligned_request = os::reserve_memory_special(new_large_size, alignment, os::large_page_size(), nullptr, false);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_windows.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -96,1 +96,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n@@ -170,1 +170,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n@@ -257,1 +257,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n@@ -428,1 +428,1 @@\n-    ReservedSpace rs(size, mtTest);\n+    ReservedSpace rs(size);\n","filename":"test\/hotspot\/gtest\/runtime\/test_virtualMemoryTracker.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}