{"files":[{"patch":"@@ -151,0 +151,1 @@\n+    unsigned int valueLenAttributePosition = (unsigned int)-1;\n@@ -220,0 +221,2 @@\n+            } else if ((ckpAttributes+i)->type == CKA_VALUE_LEN) {\n+                valueLenAttributePosition = attributesCount;\n@@ -299,0 +302,8 @@\n+    if (class == CKO_SECRET_KEY && (valueLenAttributePosition != (unsigned int)-1) &&\n+            *(CK_ULONG*)(((CK_ATTRIBUTE_PTR)(((CK_ATTRIBUTE_PTR)nativeKeyInfoArrayRawCkAttributes)\n+                    +valueLenAttributePosition))->pValue) > 256UL) {\n+        \/\/ NSS' NSC_UnwrapKey does not accept CKO_SECRET_KEY keys with length greater\n+        \/\/ than 256 (MAX_KEY_LEN - pkcs11i.h). Handle these keys as non-extractable.\n+        goto cleanup;\n+    }\n+\n","filename":"src\/jdk.crypto.cryptoki\/share\/native\/libj2pkcs11\/p11_keymgmt.c","additions":11,"deletions":0,"binary":false,"changes":11,"status":"modified"}]}