{"files":[{"patch":"@@ -256,12 +256,0 @@\n-TEST_VM_F(AsyncLogTest, StallingModePreventsDroppedMessages) {\n-  if (AsyncLogWriter::instance() == nullptr) {\n-    return;\n-  }\n-  set_log_config(TestLogFileName, \"logging=debug\");\n-  LogConfiguration::AsyncMode prev_mode = LogConfiguration::async_mode();\n-  LogConfiguration::set_async_mode(LogConfiguration::AsyncMode::Off);\n-  test_asynclog_drop_messages();\n-  EXPECT_FALSE(file_contains_substring(TestLogFileName, \"messages dropped due to async logging\"));\n-  LogConfiguration::set_async_mode(prev_mode);\n-}\n-\n@@ -275,1 +263,2 @@\n-  bool async = AsyncLogWriter::instance() != nullptr;\n+  bool async = AsyncLogWriter::instance() != nullptr\n+               && LogConfiguration::async_mode() == LogConfiguration::AsyncMode::Drop;\n@@ -304,1 +293,2 @@\n-  bool async = AsyncLogWriter::instance() != nullptr;\n+  bool async = AsyncLogWriter::instance() != nullptr\n+               && LogConfiguration::async_mode() == LogConfiguration::AsyncMode::Drop;\n","filename":"test\/hotspot\/gtest\/logging\/test_asynclog.cpp","additions":4,"deletions":14,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-    static void analyze_output(String... args) throws Exception {\n+    static void analyze_output(bool stalling_mode, String... args) throws Exception {\n@@ -43,0 +43,3 @@\n+        if (stalling_mode) {\n+            output.shouldNotContain(\"messages dropped due to async logging\");\n+        }\n@@ -45,2 +48,2 @@\n-        analyze_output(\"-Xlog:async:drop\", \"-Xlog:all=trace\", InnerClass.class.getName());\n-        analyze_output(\"-Xlog:async:stall\", \"-Xlog:all=trace\", InnerClass.class.getName());\n+        analyze_output(false, \"-Xlog:async:drop\", \"-Xlog:all=trace\", InnerClass.class.getName());\n+        analyze_output(true, \"-Xlog:async:stall\", \"-Xlog:all=trace\", InnerClass.class.getName());\n@@ -49,2 +52,2 @@\n-        analyze_output(\"-Xlog:async:drop\", \"-Xlog:all=trace\", \"-XX:AsyncLogBufferSize=192\", InnerClass.class.getName());\n-        analyze_output(\"-Xlog:async:stall\", \"-Xlog:all=trace\", \"-XX:AsyncLogBufferSize=192\", InnerClass.class.getName());\n+        analyze_output(false, \"-Xlog:async:drop\", \"-Xlog:all=trace\", \"-XX:AsyncLogBufferSize=192\", InnerClass.class.getName());\n+        analyze_output(true, \"-Xlog:async:stall\", \"-Xlog:all=trace\", \"-XX:AsyncLogBufferSize=192\", InnerClass.class.getName());\n","filename":"test\/hotspot\/jtreg\/runtime\/logging\/StressAsyncUL.java","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"}]}