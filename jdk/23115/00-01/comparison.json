{"files":[{"patch":"@@ -27,1 +27,1 @@\n-\/\/ .\/build\/macosx-aarch64-server-release\/xcode\/build\/jdk\/bin\/java -XX:+UnlockDiagnosticVMOptions -XX:NMTRecordMemoryAllocations=0x7FFFFFFF -jar build\/macosx-aarch64-server-release\/images\/jdk\/demo\/jfc\/J2Ddemo\/J2Ddemo.jar\n+\/\/ .\/build\/macosx-aarch64-server-release\/xcode\/build\/jdk\/bin\/java -XX:+UnlockDiagnosticVMOptions -XX:NativeMemoryTracking=summary -XX:NMTRecordMemoryAllocations=0x7FFFFFFF -jar build\/macosx-aarch64-server-release\/images\/jdk\/demo\/jfc\/J2Ddemo\/J2Ddemo.jar\n@@ -43,1 +43,1 @@\n-\/\/ .\/build\/macosx-aarch64-server-release\/xcode\/build\/jdk\/bin\/java -XX:+UnlockDiagnosticVMOptions -XX:NMTBenchmarkRecordedPID=43100 -XX:NMTBenchmarkRecordedLoops=10\n+\/\/ .\/build\/macosx-aarch64-server-release\/xcode\/build\/jdk\/bin\/java -XX:+UnlockDiagnosticVMOptions -XX:NativeMemoryTracking=summary -XX:NMTBenchmarkRecordedPID=43100 -XX:NMTBenchmarkRecordedLoops=10\n@@ -83,2 +83,6 @@\n-  NMT_MemoryLogRecorder::instance()->finish();\n-  NMT_VirtualMemoryLogRecorder::instance()->finish();\n+  if (!NMT_MemoryLogRecorder::instance()->done()) {\n+    NMT_MemoryLogRecorder::instance()->finish();\n+  }\n+  if (!NMT_VirtualMemoryLogRecorder::instance()->done()) {\n+    NMT_VirtualMemoryLogRecorder::instance()->finish();\n+  }\n@@ -498,1 +502,0 @@\n-  volatile intx count = recorder->_count++;\n@@ -500,0 +503,1 @@\n+    volatile intx count = recorder->_count++;\n@@ -737,1 +741,1 @@\n-    fprintf(stderr, \"time:%ld[ns] [samples:%ld] [loops:ld]\\n\", total, count, NMTBenchmarkRecordedLoops);\n+    fprintf(stderr, \"time:%ld[ns] [samples:%ld] [loops:%ld]\\n\", total, count, NMTBenchmarkRecordedLoops);\n@@ -759,2 +763,2 @@\n-  fprintf(stderr, \"NMT_VirtualMemoryLogRecorder::log (%s, %hhu, %hhu, %zu, %zu, %p, %p)\\n\",\n-          type_to_name(type), mem_tag, mem_tag_split, size, size_split, ptr, stack);fflush(stderr);\n+  \/\/fprintf(stderr, \"NMT_VirtualMemoryLogRecorder::log (%s, %hhu, %hhu, %zu, %zu, %p, %p)\\n\",\n+  \/\/        type_to_name(type), mem_tag, mem_tag_split, size, size_split, ptr, stack);fflush(stderr);\n@@ -762,1 +766,0 @@\n-  volatile intx count = recorder->_count++;\n@@ -764,0 +767,1 @@\n+    volatile intx count = recorder->_count++;\n","filename":"src\/hotspot\/share\/nmt\/memLogRecorder.cpp","additions":13,"deletions":9,"binary":false,"changes":22,"status":"modified"}]}