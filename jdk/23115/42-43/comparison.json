{"files":[{"patch":"@@ -81,5 +81,5 @@\n-#define PROT_READ\n-#define PROT_WRITE\n-#define MAP_PRIVATE\n-#define STDERR_FILENO\n-#define STDOUT_FILENO\n+#define PROT_READ 0x01\n+#define PROT_WRITE 0x02\n+#define MAP_PRIVATE 0x0002\n+#define STDERR_FILENO 1\n+#define STDOUT_FILENO 1\n@@ -134,1 +134,1 @@\n- \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::init\n@@ -155,1 +155,1 @@\n- \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::lock\n@@ -163,1 +163,1 @@\n-  \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::unlock\n@@ -171,1 +171,1 @@\n-  \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::thread_id\n@@ -186,1 +186,1 @@\n-  \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::thread_name\n@@ -211,1 +211,1 @@\n-  \/\/ TODO\n+  \/\/ TODO: NMT_LogRecorder::mmap\n@@ -266,1 +266,1 @@\n-  ssize_t written = ::write(fd, buf, count);\n+  ssize_t written = (ssize_t)::write(fd, buf, count);\n@@ -483,2 +483,2 @@\n-        requested = e->requested;\n-        actual = e->actual;\n+        requested = (long int)e->requested;\n+        actual = (long int)e->actual;\n@@ -496,2 +496,2 @@\n-            requested -= p->requested;\n-            actual -= p->actual;\n+            requested -= (long int)p->requested;\n+            actual -= (long int)p->actual;\n@@ -503,2 +503,2 @@\n-            requested += e->requested;\n-            actual += e->actual;\n+            requested += (long int)e->requested;\n+            actual += (long int)e->actual;\n@@ -521,2 +521,2 @@\n-            requested -= p->requested;\n-            actual -= p->actual;\n+            requested -= (long int)p->requested;\n+            actual -= (long int)p->actual;\n@@ -574,1 +574,1 @@\n-  long int overhead_NMT = headers * MemTracker::overhead_per_malloc();\n+  long int overhead_NMT = (long int)(headers * MemTracker::overhead_per_malloc());\n@@ -578,1 +578,5 @@\n-  fprintf(stderr, \"time:%'ld[ns] [samples:%'ld] [NMT headers:%ld]\\n\", nanoseconds, count, headers);\n+#if defined(_WIN64)\n+  fprintf(stderr, \"time:%ld[ns] [samples:%ld] [NMT headers:%ld]\\n\", nanoseconds, count, headers);\n+  fprintf(stderr, \"memory requested:%ld bytes, allocated:%ld bytes\\n\", requestedTotal, actualTotal);\n+#else\n+  fprintf(stderr, \"time:%'ld[ns] [samples:%'ld] [NMT headers:%'ld]\\n\", nanoseconds, count, headers);\n@@ -580,0 +584,1 @@\n+#endif\n@@ -581,0 +586,4 @@\n+#if defined(_WIN64)\n+  fprintf(stderr, \"malloc overhead=%ld bytes [%2.2f%%], NMT headers overhead=%ld bytes [%2.2f%%]\\n\", overhead_malloc, overheadPercentage_malloc, overhead_NMT, overheadPercentage_NMT);\n+  fprintf(stderr, \"\\n\");\n+#else\n@@ -583,1 +592,1 @@\n-\n+#endif\n","filename":"src\/hotspot\/share\/nmt\/memLogRecorder.cpp","additions":32,"deletions":23,"binary":false,"changes":55,"status":"modified"}]}