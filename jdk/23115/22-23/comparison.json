{"files":[{"patch":"@@ -328,1 +328,1 @@\n-  fprintf(stderr, \"> NMT_MemoryLogRecorder::initialize(%ld, %zu)\\n\", limit, sizeof(Entry));\n+  \/\/fprintf(stderr, \"> NMT_MemoryLogRecorder::initialize(%ld, %zu)\\n\", limit, sizeof(Entry));\n@@ -424,0 +424,1 @@\n+  jlong timeByCategory[mt_number_of_tags] = {0};\n@@ -522,0 +523,1 @@\n+    timeByCategory[NMTUtil::tag_to_index(mem_tag)] += duration;\n@@ -541,2 +543,3 @@\n-  fprintf(stderr, \"%22s: %12s: %12s: %12s:\\n\", \"NMT category\", \"objects\", \"bytes\", \"overhead\");\n-  fprintf(stderr, \"-----------------------------------------------------------------\\n\");\n+\n+  fprintf(stderr, \"%22s: %12s: %12s: %12s: %12s: %12s: %12s: %12s:\\n\", \"NMT type\", \"objects\", \"bytes\", \"time\", \"count%\", \"bytes%\", \"time%\", \"overhead\");\n+  fprintf(stderr, \"-------------------------------------------------------------------------------------------------------------------------\\n\");\n@@ -548,1 +551,25 @@\n-    fprintf(stderr, \"%22s: %'12ld %'12ld         [%.2f%%]\\n\", NMTUtil::tag_to_name(NMTUtil::index_to_tag(i)), nmtObjectsByCategory[i], allocatedByCategory[i], overhead);\n+    fprintf(stderr, \"%22s: %'12ld  %'12ld   %'12ld\", NMTUtil::tag_to_name(NMTUtil::index_to_tag(i)), nmtObjectsByCategory[i], allocatedByCategory[i], timeByCategory[i]);\n+    double countPercentage = 100.0 * ((double)nmtObjectsByCategory[i] \/ (double)count);\n+    if (countPercentage > 10.0) {\n+      fprintf(stderr, \"        %.1f%%\", countPercentage);\n+    } else {\n+      fprintf(stderr, \"         %.1f%%\", countPercentage);\n+    }\n+    double bytesPercentage = 100.0 * ((double)allocatedByCategory[i] \/ (double)actualTotal);\n+    if (bytesPercentage > 10.0) {\n+      fprintf(stderr, \"         %.1f%%\", bytesPercentage);\n+    } else {\n+      fprintf(stderr, \"          %.1f%%\", bytesPercentage);\n+    }\n+    double timePercentage = 100.0 * ((double)timeByCategory[i] \/ (double)nanoseconds);\n+    if (timePercentage > 10.0) {\n+      fprintf(stderr, \"          %.1f%%\", timePercentage);\n+    } else {\n+      fprintf(stderr, \"           %.1f%%\", timePercentage);\n+    }\n+    if (overhead > 10.0) {\n+      fprintf(stderr, \"        %.1f%%\", overhead);\n+    } else {\n+      fprintf(stderr, \"         %.1f%%\", overhead);\n+    }\n+    fprintf(stderr, \"\\n\");\n@@ -550,0 +577,1 @@\n+\n@@ -651,1 +679,1 @@\n-  fprintf(stderr, \"> NMT_VirtualMemoryLogRecorder::initialize(%ld, %zu)\\n\", limit, sizeof(Entry));\n+  \/\/fprintf(stderr, \"> NMT_VirtualMemoryLogRecorder::initialize(%ld, %zu)\\n\", limit, sizeof(Entry));\n","filename":"src\/hotspot\/share\/nmt\/memLogRecorder.cpp","additions":33,"deletions":5,"binary":false,"changes":38,"status":"modified"}]}