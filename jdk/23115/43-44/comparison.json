{"files":[{"patch":"@@ -81,4 +81,1 @@\n-#define PROT_READ 0x01\n-#define PROT_WRITE 0x02\n-#define MAP_PRIVATE 0x0002\n-#define STDERR_FILENO 1\n+#define STDERR_FILENO 2\n@@ -206,10 +203,0 @@\n-void *NMT_LogRecorder::mmap(void *addr, size_t len, int prot, int flags, int fd)\n-{\n-#if defined(LINUX) || defined(__APPLE__)\n-  return ::mmap(addr, len, prot, flags, fd, 0);\n-#elif defined(_WIN64)\n-  \/\/ TODO: NMT_LogRecorder::mmap\n-  return nullptr;\n-#endif\n-}\n-\n@@ -337,1 +324,2 @@\n-  info.ptr = NMT_LogRecorder::mmap(NULL, info.size, PROT_READ, MAP_PRIVATE, info.fd);\n+#if !defined(_WIN64)\n+  info.ptr = ::mmap(NULL, info.size, PROT_READ, MAP_PRIVATE, info.fd, 0);\n@@ -339,1 +327,2 @@\n-\n+#endif\n+  \n@@ -433,1 +422,2 @@\n-  address *pointers = (address*)NMT_LogRecorder::mmap(NULL, size_pointers, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_NORESERVE|MAP_ANONYMOUS, -1);\n+#if !defined(_WIN64)\n+  address *pointers = (address*)::mmap(NULL, size_pointers, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_NORESERVE|MAP_ANONYMOUS, -1, 0);\n@@ -435,0 +425,1 @@\n+#endif\n@@ -600,0 +591,3 @@\n+#if defined(_WIN64)\n+    fprintf(stderr, \"%22s: %12ld  %12ld   %12ld\", NMTUtil::tag_to_name(NMTUtil::index_to_tag(i)), nmtObjectsByCategory[i], allocatedByCategory[i], timeByCategory[i]);\n+#else\n@@ -601,0 +595,1 @@\n+#endif\n@@ -653,0 +648,1 @@\n+#if !defined(_WIN64)\n@@ -654,1 +650,2 @@\n-\n+#endif\n+  \n@@ -868,0 +865,1 @@\n+#if defined(_WIN64)\n@@ -869,1 +867,3 @@\n-\n+#else\n+  fprintf(stderr, \"time:%ld[ns] [samples:%ld]\\n\", total, count);\n+#endif\n","filename":"src\/hotspot\/share\/nmt\/memLogRecorder.cpp","additions":19,"deletions":19,"binary":false,"changes":38,"status":"modified"}]}