{"files":[{"patch":"@@ -2180,1 +2180,0 @@\n-static int _compact; \/\/ number of equals calls with compact signature\n@@ -2191,1 +2190,0 @@\n-    _compact_int_count = 3\n@@ -2197,1 +2195,5 @@\n-  int _value[_compact_int_count];\n+\n+  static int data_offset() { return sizeof(AdapterFingerPrint); }\n+  int* data_pointer() {\n+    return (int*)((address)this + data_offset());\n+  }\n@@ -2201,0 +2203,1 @@\n+    int* data = data_pointer();\n@@ -2202,1 +2205,1 @@\n-    _length = (total_args_passed + (_basic_types_per_int-1)) \/ _basic_types_per_int;\n+    _length = length(total_args_passed);\n@@ -2211,1 +2214,1 @@\n-      _value[index] = value;\n+      data[index] = value;\n@@ -2220,0 +2223,9 @@\n+  static int length(int total_args) {\n+    return (total_args + (_basic_types_per_int-1)) \/ _basic_types_per_int;\n+  }\n+\n+  static int compute_size(int total_args_passed, BasicType* sig_bt) {\n+    int len = length(total_args_passed);\n+    return sizeof(AdapterFingerPrint) + (len * sizeof(int));\n+  }\n+\n@@ -2279,5 +2291,0 @@\n-  static int allocation_size(int total_args_passed, BasicType* sig_bt) {\n-    int len = (total_args_passed + (_basic_types_per_int-1)) \/ _basic_types_per_int;\n-    return sizeof(AdapterFingerPrint) + (len > _compact_int_count ? (len - _compact_int_count) * sizeof(int) : 0);\n-  }\n-\n@@ -2285,1 +2292,1 @@\n-    int size_in_bytes = allocation_size(total_args_passed, sig_bt);\n+    int size_in_bytes = compute_size(total_args_passed, sig_bt);\n@@ -2294,1 +2301,2 @@\n-    return _value[index];\n+    int* data = data_pointer();\n+    return data[index];\n@@ -2298,1 +2306,0 @@\n-    if (_length < 0) return -_length;\n@@ -2302,4 +2309,0 @@\n-  bool is_compact() {\n-    return _length <= _compact_int_count;\n-  }\n-\n@@ -2408,1 +2411,1 @@\n-        if (_value[i] != other->_value[i]) {\n+        if (value(i) != other->value(i)) {\n@@ -2418,1 +2421,1 @@\n-  int size() const { return (int)heap_word_size(sizeof(AdapterFingerPrint) + (_length > _compact_int_count ? (_length - _compact_int_count) * sizeof(int) : 0)); }\n+  int size() const { return (int)heap_word_size(sizeof(AdapterFingerPrint) + (_length * sizeof(int))); }\n@@ -2462,1 +2465,0 @@\n-    if (entry != nullptr) {\n@@ -2464,3 +2466,1 @@\n-      if (fp->is_compact()) {\n-        _compact++;\n-      }\n+    if (entry != nullptr) {\n@@ -2468,1 +2468,0 @@\n-#endif\n@@ -2470,0 +2469,1 @@\n+#endif\n@@ -2481,1 +2481,0 @@\n-      if (fp->is_compact()) _compact++;\n@@ -2500,2 +2499,2 @@\n-  tty->print_cr(\"AdapterHandlerTable: lookups %d equals %d hits %d (archived=%d+runtime=%d) compact %d\",\n-                _lookups, _equals, total_hits, _archived_hits, _runtime_hits, _compact);\n+  tty->print_cr(\"AdapterHandlerTable: lookups %d equals %d hits %d (archived=%d+runtime=%d)\",\n+                _lookups, _equals, total_hits, _archived_hits, _runtime_hits);\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":26,"deletions":27,"binary":false,"changes":53,"status":"modified"}]}