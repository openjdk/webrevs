{"files":[{"patch":"@@ -165,0 +165,1 @@\n+#if 0\n@@ -219,0 +220,1 @@\n+#endif\n@@ -457,0 +459,1 @@\n+#if 0\n@@ -485,0 +488,1 @@\n+#endif\n@@ -619,0 +623,1 @@\n+#if 0\n@@ -674,0 +679,1 @@\n+#endif\n","filename":"src\/hotspot\/cpu\/s390\/c2_MacroAssembler_s390.cpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -51,0 +51,1 @@\n+  static int calculate_vregstosave_num();\n","filename":"src\/hotspot\/cpu\/s390\/registerSaver_s390.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1198,1 +1198,1 @@\n-  \/\/ we have 32 vector register\n+  \/\/ we have 128 vector register halves at index 64\n@@ -11172,0 +11172,11 @@\n+instruct vadd2L_reg(vecX dst, vecX src1, vecX src2) %{\n+  match(Set dst (AddVL src1 src2));\n+  predicate(n->as_Vector()->length() == 2);\n+  format %{ \"VAG  $dst,$src1,$src2\\t\/\/ add packed2L\" %}\n+  size(6);\n+  ins_encode %{\n+    __ z_vag($dst$$VectorRegister, $src1$$VectorRegister, $src2$$VectorRegister);\n+  %}\n+  ins_pipe(pipe_class_dummy);\n+%}\n+\n@@ -11205,12 +11216,1 @@\n-instruct vadd2L_reg(vecX dst, vecX src1, vecX src2) %{\n-  match(Set dst (AddVL src1 src2));\n-  predicate(n->as_Vector()->length() == 2);\n-  format %{ \"VAG  $dst,$src1,$src2\\t\/\/ add packed2L\" %}\n-  size(6);\n-  ins_encode %{\n-    __ z_vag($dst$$VectorRegister, $src1$$VectorRegister, $src2$$VectorRegister);\n-  %}\n-  ins_pipe(pipe_class_dummy);\n-%}\n-\n-instruct vsub416B_reg(vecX dst, vecX src1, vecX src2) %{\n+instruct vsub16B_reg(vecX dst, vecX src1, vecX src2) %{\n","filename":"src\/hotspot\/cpu\/s390\/s390.ad","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -296,4 +296,3 @@\n-int RegisterSaver::live_reg_frame_size(RegisterSet reg_set, bool save_vectors) {\n-  const int vregstosave_num = save_vectors ? (sizeof(RegisterSaver_LiveVRegs) \/\n-                                              sizeof(RegisterSaver::LiveRegType))\n-                                            : 0;\n+int RegisterSaver::calculate_vregstosave_num() {\n+  return (sizeof(RegisterSaver_LiveVRegs) \/ sizeof(RegisterSaver::LiveRegType));\n+}\n@@ -301,0 +300,2 @@\n+int RegisterSaver::live_reg_frame_size(RegisterSet reg_set, bool save_vectors) {\n+  const int vregstosave_num = save_vectors ? calculate_vregstosave_num() : 0;\n@@ -313,5 +314,1 @@\n-  const int vregstosave_num     = save_vectors ? (sizeof(RegisterSaver_LiveVRegs) \/\n-                                                  sizeof(RegisterSaver::LiveRegType))\n-                                                  : 0;\n-  const int register_save_size   = live_reg_save_size(reg_set) + vregstosave_num * v_reg_size;\n-  const int frame_size_in_bytes  = frame::z_abi_160_size + register_save_size;\n+  const int frame_size_in_bytes  = live_reg_frame_size(reg_set, save_vectors);\n@@ -319,1 +316,2 @@\n-  const int register_save_offset = frame_size_in_bytes - register_save_size;\n+  const int vregstosave_num = save_vectors ? calculate_vregstosave_num() : 0;\n+  const int register_save_offset = frame_size_in_bytes - (live_reg_save_size(reg_set) + vregstosave_num * v_reg_size);\n@@ -492,7 +490,2 @@\n-  \/\/ Calculate frame size.\n-  const int vregstosave_num     = save_vectors ? (sizeof(RegisterSaver_LiveVRegs) \/\n-                                                  sizeof(RegisterSaver::LiveRegType))\n-                                                  : 0;\n-  const int register_save_size   = live_reg_save_size(reg_set) + vregstosave_num * v_reg_size;\n-  const int frame_size_in_bytes  = frame::z_abi_160_size + register_save_size;\n-  const int register_save_offset = frame_size_in_bytes - register_save_size;\n+  const int vregstosave_num = save_vectors ? calculate_vregstosave_num() : 0;\n+  const int register_save_offset = live_reg_frame_size(reg_set, save_vectors) - (live_reg_save_size(reg_set) + vregstosave_num * v_reg_size);\n@@ -581,1 +574,0 @@\n-  assert(offset == frame_size_in_bytes, \"consistency check\");\n","filename":"src\/hotspot\/cpu\/s390\/sharedRuntime_s390.cpp","additions":10,"deletions":18,"binary":false,"changes":28,"status":"modified"}]}