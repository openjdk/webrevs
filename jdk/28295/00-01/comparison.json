{"files":[{"patch":"@@ -1091,2 +1091,1 @@\n-        bool failure = verify_Value_for(n);\n-        assert(!failure, \"Missed Value optimization opportunity in PhaseIterGVN for %s\", n->Name());\n+        verify_Value_for(n);\n@@ -1095,2 +1094,2 @@\n-        bool failure = verify_Ideal_for(n, false) || verify_Ideal_for(n, true);\n-        assert(!failure, \"Missed Ideal optimization opportunity in PhaseIterGVN for %s\", n->Name());\n+        verify_Ideal_for(n, false);\n+        verify_Ideal_for(n, true);\n@@ -1099,2 +1098,1 @@\n-        bool failure = verify_Identity_for(n);\n-        assert(!failure, \"Missed Identity optimization opportunity in PhaseIterGVN for %s\", n->Name());\n+        verify_Identity_for(n);\n@@ -1136,1 +1134,1 @@\n-\/\/ Check that type(n) == n->Value(), return true if we have a failure.\n+\/\/ Check that type(n) == n->Value(), asserts if we have a failure.\n@@ -1141,1 +1139,1 @@\n-bool PhaseIterGVN::verify_Value_for(Node* n) {\n+void PhaseIterGVN::verify_Value_for(Node *n) {\n@@ -1147,1 +1145,1 @@\n-    return false;\n+    return;\n@@ -1156,1 +1154,1 @@\n-      return false; \/\/ ignore integer widen\n+      return; \/\/ ignore integer widen\n@@ -1165,1 +1163,1 @@\n-    return false;\n+    return;\n@@ -1184,1 +1182,1 @@\n-    return false;\n+    return;\n@@ -1198,1 +1196,2 @@\n-  return true;\n+\n+  assert(false, \"Missed Value optimization opportunity in PhaseIterGVN for %s\", n->Name());\n@@ -1202,3 +1201,3 @@\n-\/\/ Returns true if it found missed optimization opportunities and\n-\/\/         false otherwise (no missed optimization, or skipped verification).\n-bool PhaseIterGVN::verify_Ideal_for(Node* n, bool can_reshape) {\n+\/\/ Asserts if it found missed optimization opportunities or encountered unexpected changes, and\n+\/\/         returns normally otherwise (no missed optimization, or skipped verification).\n+void PhaseIterGVN::verify_Ideal_for(Node *n, bool can_reshape) {\n@@ -1218,1 +1217,1 @@\n-      return false;\n+      return;\n@@ -1229,1 +1228,1 @@\n-      return false;\n+      return;\n@@ -1239,1 +1238,1 @@\n-      return false;\n+      return;\n@@ -1248,1 +1247,1 @@\n-      return false;\n+      return;\n@@ -1267,1 +1266,1 @@\n-      return false;\n+      return;\n@@ -1346,1 +1345,1 @@\n-      return false;\n+      return;\n@@ -1370,1 +1369,1 @@\n-      return false;\n+      return;\n@@ -1402,1 +1401,1 @@\n-      return false;\n+      return;\n@@ -1414,1 +1413,1 @@\n-      return false;\n+      return;\n@@ -1443,1 +1442,1 @@\n-      return false;\n+      return;\n@@ -1468,1 +1467,1 @@\n-      return false;\n+      return;\n@@ -1488,1 +1487,1 @@\n-      return false;\n+      return;\n@@ -1511,1 +1510,1 @@\n-      return false;\n+      return;\n@@ -1524,1 +1523,1 @@\n-      return false;\n+      return;\n@@ -1540,1 +1539,1 @@\n-      return false;\n+      return;\n@@ -1554,1 +1553,1 @@\n-      return false;\n+      return;\n@@ -1580,1 +1579,1 @@\n-      return false;\n+      return;\n@@ -1592,1 +1591,1 @@\n-      return false;\n+      return;\n@@ -1600,1 +1599,1 @@\n-      return false;\n+      return;\n@@ -1615,1 +1614,1 @@\n-      return false;\n+      return;\n@@ -1629,1 +1628,1 @@\n-      return false;\n+      return;\n@@ -1638,1 +1637,1 @@\n-      return false;\n+      return;\n@@ -1648,1 +1647,1 @@\n-      return false;\n+      return;\n@@ -1661,1 +1660,1 @@\n-      return false;\n+      return;\n@@ -1666,1 +1665,1 @@\n-      return false;\n+      return;\n@@ -1672,1 +1671,1 @@\n-      return false;\n+      return;\n@@ -1681,1 +1680,1 @@\n-      return false;\n+      return;\n@@ -1690,1 +1689,1 @@\n-      return false;\n+      return;\n@@ -1695,1 +1694,1 @@\n-      return false;\n+      return;\n@@ -1700,1 +1699,1 @@\n-      return false;\n+      return;\n@@ -1705,1 +1704,1 @@\n-      return false;\n+      return;\n@@ -1716,1 +1715,1 @@\n-      return false;\n+      return;\n@@ -1723,1 +1722,1 @@\n-      return false;\n+      return;\n@@ -1739,1 +1738,1 @@\n-    return false;\n+    return;\n@@ -1753,1 +1752,1 @@\n-    return false;\n+    return;\n@@ -1772,1 +1771,1 @@\n-    return false;\n+    return;\n@@ -1791,1 +1790,1 @@\n-    return false;\n+    return;\n@@ -1823,1 +1822,1 @@\n-    return false;\n+    return;\n@@ -1846,1 +1845,1 @@\n-      return true;\n+      assert(false, \"Unexpected new unused nodes from applying Ideal optimization on %s\", n->Name());\n@@ -1856,1 +1855,1 @@\n-      return true;\n+      assert(false, \"Unexpected hash change from applying Ideal optimization on %s\", n->Name());\n@@ -1863,1 +1862,1 @@\n-    return false;\n+    return;\n@@ -1880,1 +1879,2 @@\n-  return true;\n+\n+  assert(false, \"Missed Ideal optimization opportunity in PhaseIterGVN for %s\", n->Name());\n@@ -1884,3 +1884,3 @@\n-\/\/ Returns true if it found missed optimization opportunities and\n-\/\/         false otherwise (no missed optimization, or skipped verification).\n-bool PhaseIterGVN::verify_Identity_for(Node* n) {\n+\/\/ Asserts if it found missed optimization opportunities, and\n+\/\/         returns normally otherwise (no missed optimization, or skipped verification).\n+void PhaseIterGVN::verify_Identity_for(Node *n) {\n@@ -1905,1 +1905,1 @@\n-      return false;\n+      return;\n@@ -1916,1 +1916,1 @@\n-      return false;\n+      return;\n@@ -1930,1 +1930,1 @@\n-      return false;\n+      return;\n@@ -1940,1 +1940,1 @@\n-      return false;\n+      return;\n@@ -1958,1 +1958,1 @@\n-      return false;\n+      return;\n@@ -1972,1 +1972,1 @@\n-      return false;\n+      return;\n@@ -1983,1 +1983,1 @@\n-      return false;\n+      return;\n@@ -2003,1 +2003,1 @@\n-      return false;\n+      return;\n@@ -2017,1 +2017,1 @@\n-      return false;\n+      return;\n@@ -2022,1 +2022,1 @@\n-      return false;\n+      return;\n@@ -2036,1 +2036,1 @@\n-    return false;\n+    return;\n@@ -2047,1 +2047,1 @@\n-    return false;\n+    return;\n@@ -2053,1 +2053,1 @@\n-    return false;\n+    return;\n@@ -2060,1 +2060,1 @@\n-    return false;\n+    return;\n@@ -2072,1 +2072,2 @@\n-  return true;\n+\n+  assert(false, \"Missed Identity optimization opportunity in PhaseIterGVN for %s\", n->Name());\n@@ -2845,1 +2846,8 @@\n-    failure |= verify_Value_for(n);\n+\n+    \/\/ If we get an assert in verify_Value_for, it means that PhaseCCP is not at fixpoint\n+    \/\/ and that the analysis result may be unsound.\n+    \/\/ Check why the reported nodes were not processed again in CCP.\n+    \/\/ We should either make sure that these nodes are properly added back to the CCP worklist\n+    \/\/ in PhaseCCP::push_child_nodes_to_worklist() to update their type or add an exception\n+    \/\/ in the verification code above if that is not possible for some reason (like Load nodes).\n+    verify_Value_for(n);\n@@ -2847,5 +2855,0 @@\n-  \/\/ If we get this assert, check why the reported nodes were not processed again in CCP.\n-  \/\/ We should either make sure that these nodes are properly added back to the CCP worklist\n-  \/\/ in PhaseCCP::push_child_nodes_to_worklist() to update their type or add an exception\n-  \/\/ in the verification code above if that is not possible for some reason (like Load nodes).\n-  assert(!failure, \"PhaseCCP not at fixpoint: analysis result may be unsound.\");\n","filename":"src\/hotspot\/share\/opto\/phaseX.cpp","additions":85,"deletions":82,"binary":false,"changes":167,"status":"modified"},{"patch":"@@ -493,3 +493,4 @@\n-  bool verify_Value_for(Node* n);\n-  bool verify_Ideal_for(Node* n, bool can_reshape);\n-  bool verify_Identity_for(Node* n);\n+\n+  void verify_Value_for(Node *n);\n+  void verify_Ideal_for(Node *n, bool can_reshape);\n+  void verify_Identity_for(Node *n);\n","filename":"src\/hotspot\/share\/opto\/phaseX.hpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}