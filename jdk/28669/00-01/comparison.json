{"files":[{"patch":"@@ -451,14 +451,16 @@\n-#ifdef ASSERT\n-      if (_heap->heap_region_containing(dst)->is_old()) {\n-        ShenandoahScanRemembered* card_scan = ShenandoahGenerationalHeap::heap()->old_generation()->card_scan();\n-        T* end = dst + count;\n-        for (T* elem_ptr = dst; elem_ptr < end; elem_ptr++) {\n-          T o = RawAccess<>::oop_load(elem_ptr);\n-          if (!CompressedOops::is_null(o)) {\n-            oop obj = CompressedOops::decode_not_null(o);\n-            assert(!_heap->is_in_young(obj) || card_scan->is_card_dirty(reinterpret_cast<HeapWord*>(elem_ptr)),\n-              \"Card should be dirty if the array element points to obj in young. Array element: \" PTR_FORMAT \", young object: \" PTR_FORMAT \"\", p2i(elem_ptr), p2i(obj));\n-          }\n-        }\n-      }\n-#endif \/\/ ASSERT\n+\/\/ The assert intended to add should be correct, the remembered set is not right due to bug,\n+\/\/ this block should be uncommented once the bug is located and fixed.\n+\/\/ #ifdef ASSERT\n+\/\/       if (_heap->heap_region_containing(dst)->is_old()) {\n+\/\/         ShenandoahScanRemembered* card_scan = ShenandoahGenerationalHeap::heap()->old_generation()->card_scan();\n+\/\/         T* end = dst + count;\n+\/\/         for (T* elem_ptr = dst; elem_ptr < end; elem_ptr++) {\n+\/\/           T o = RawAccess<>::oop_load(elem_ptr);\n+\/\/           if (!CompressedOops::is_null(o)) {\n+\/\/             oop obj = CompressedOops::decode_not_null(o);\n+\/\/             assert(!_heap->is_in_young(obj) || card_scan->is_card_dirty(reinterpret_cast<HeapWord*>(elem_ptr)),\n+\/\/               \"Card should be dirty if the array element points to obj in young. Array element: \" PTR_FORMAT \", young object: \" PTR_FORMAT \"\", p2i(elem_ptr), p2i(obj));\n+\/\/           }\n+\/\/         }\n+\/\/       }\n+\/\/ #endif \/\/ ASSERT\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.inline.hpp","additions":16,"deletions":14,"binary":false,"changes":30,"status":"modified"}]}