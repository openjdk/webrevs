{"files":[{"patch":"@@ -45,0 +45,1 @@\n+import jdk.test.lib.Platform;\n@@ -53,1 +54,8 @@\n-        int iterations = args.length > 0 ? Integer.parseInt(args[0]) : 100_000;\n+        int iterations;\n+        int value = Integer.parseInt(args[0]);\n+        if (Platform.isOSX() && Platform.isX64()) {\n+            \/\/ reduced iterations on macosx-x64\n+            iterations = Math.max(value \/ 4, 1);\n+        } else {\n+            iterations = value;\n+        }\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/GetStackTraceALotWhenBlocking.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+import jdk.test.lib.Platform;\n@@ -56,1 +57,9 @@\n-        int iterations = Integer.parseInt(args[0]);\n+        int iterations;\n+        int value = Integer.parseInt(args[0]);\n+        if (Platform.isOSX() && Platform.isX64()) {\n+            \/\/ reduced iterations on macosx-x64\n+            iterations = Math.max(value \/ 4, 1);\n+        } else {\n+            iterations = value;\n+        }\n+\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/GetStackTraceALotWhenPinned.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm GetStackTraceALotWithTimedWait 100000\n+ * @run main GetStackTraceALotWithTimedWait 100000\n@@ -34,1 +34,1 @@\n- * @run main\/othervm GetStackTraceALotWithTimedWait 50000\n+ * @run main GetStackTraceALotWithTimedWait 50000\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/GetStackTraceALotWithTimedWait.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm LotsOfContendedMonitorEnter\n+ * @run main LotsOfContendedMonitorEnter\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/LotsOfContendedMonitorEnter.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm LotsOfUncontendedMonitorEnter\n+ * @run main LotsOfUncontendedMonitorEnter\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/LotsOfUncontendedMonitorEnter.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n- * @run main\/othervm ParkALot 500000\n+ * @library \/test\/lib\n+ * @run main\/othervm\/timeout=300 ParkALot 300000\n@@ -34,1 +35,2 @@\n- * @run main\/othervm ParkALot 100000\n+ * @library \/test\/lib\n+ * @run main\/othervm\/timeout=300 ParkALot 100000\n@@ -40,0 +42,2 @@\n+import java.util.concurrent.TimeUnit;\n+import java.util.concurrent.atomic.AtomicInteger;\n@@ -41,0 +45,1 @@\n+import jdk.test.lib.Platform;\n@@ -43,1 +48,0 @@\n-    private static final int ITERATIONS = 1_000_000;\n@@ -45,1 +49,1 @@\n-    public static void main(String[] args) {\n+    public static void main(String[] args) throws Exception {\n@@ -47,2 +51,4 @@\n-        if (args.length > 0) {\n-            iterations = Integer.parseInt(args[0]);\n+        int value = Integer.parseInt(args[0]);\n+        if (Platform.isOSX() && Platform.isX64()) {\n+            \/\/ reduced iterations on macosx-x64\n+            iterations = Math.max(value \/ 4, 1);\n@@ -50,1 +56,1 @@\n-            iterations = ITERATIONS;\n+            iterations = value;\n@@ -58,0 +64,1 @@\n+                var totalIterations = new AtomicInteger();\n@@ -59,1 +66,10 @@\n-                    executor.submit(() -> parkALot(iterations));\n+                    executor.submit(() -> parkALot(iterations, totalIterations::incrementAndGet));\n+                }\n+\n+                \/\/ shutdown, await for all threads to finish with progress output\n+                executor.shutdown();\n+                boolean terminated = false;\n+                while (!terminated) {\n+                    terminated = executor.awaitTermination(1, TimeUnit.SECONDS);\n+                    System.out.format(\"%s => %d of %d%n\",\n+                            Instant.now(), totalIterations.get(), iterations * nthreads);\n@@ -69,0 +85,2 @@\n+     * @param iterations number of iterations\n+     * @param afterIteration the task to run after each iteration\n@@ -70,1 +88,1 @@\n-    private static void parkALot(int iterations) {\n+    private static void parkALot(int iterations, Runnable afterIteration) {\n@@ -83,0 +101,1 @@\n+                afterIteration.run();\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/ParkALot.java","additions":28,"deletions":9,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm SleepALot 500000\n+ * @run main SleepALot 500000\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/SleepALot.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @run main\/othervm TimedWaitALot 200\n+ * @run main TimedWaitALot 200\n@@ -34,1 +34,1 @@\n- * @run main\/othervm TimedWaitALot 200 true false\n+ * @run main TimedWaitALot 150 true false\n@@ -41,1 +41,1 @@\n- * @run main\/othervm TimedWaitALot 200 false true\n+ * @run main TimedWaitALot 150 false true\n@@ -48,1 +48,1 @@\n- * @run main\/othervm TimedWaitALot 100 true true\n+ * @run main TimedWaitALot 100 true true\n","filename":"test\/jdk\/java\/lang\/Thread\/virtual\/stress\/TimedWaitALot.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}