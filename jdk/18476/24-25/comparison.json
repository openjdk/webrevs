{"files":[{"patch":"@@ -553,3 +553,5 @@\n-  return (reg1->is_valid() && reg1->encoding() >= 16) ||\n-         (reg2->is_valid() && reg2->encoding() >= 16) ||\n-         (reg3->is_valid() && reg3->encoding() >= 16);\n+  bool rex2 = (reg1->is_valid() && reg1->encoding() >= 16) ||\n+              (reg2->is_valid() && reg2->encoding() >= 16) ||\n+              (reg3->is_valid() && reg3->encoding() >= 16);\n+  assert(!rex2 || UseAPX, \"extended gpr use requires UseAPX\");\n+  return rex2;\n@@ -563,1 +565,3 @@\n-  return enc1 >= 16 || enc2 >= 16 || enc3 >=16;\n+  bool eevex = enc1 >= 16 || enc2 >= 16 || enc3 >=16;\n+  assert(!eevex || UseAPX, \"extended gpr use requires UseAPX\");\n+  return eevex;\n@@ -1668,1 +1672,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX\");\n@@ -1676,1 +1679,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1702,1 +1704,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1710,1 +1711,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1721,1 +1721,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1730,1 +1729,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1741,1 +1739,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1749,1 +1746,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -1988,1 +1984,0 @@\n-    assert(UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -2036,1 +2031,0 @@\n-    assert(UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12441,1 +12435,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12456,1 +12449,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12464,1 +12456,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12472,1 +12463,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12480,1 +12470,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12488,1 +12477,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12499,1 +12487,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12510,1 +12497,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12521,1 +12507,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12532,1 +12517,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12540,1 +12524,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12551,1 +12534,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12559,1 +12541,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12570,1 +12551,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12578,1 +12558,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12589,1 +12568,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12597,1 +12575,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12608,1 +12585,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12616,1 +12592,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12627,1 +12602,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -12635,1 +12609,0 @@\n-  assert((!needs_eevex(dst, src1.base(), src1.index()) && !needs_eevex(src2)) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13442,1 +13415,0 @@\n-    assert(UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13459,1 +13431,0 @@\n-    assert(UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13502,1 +13473,0 @@\n-  assert(!needs_eevex(dst, src1, src2) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13510,1 +13480,0 @@\n-  assert((!needs_eevex(dst, src1) && !needs_eevex(src2.base(), src2.index())) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13536,1 +13505,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13544,1 +13512,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13555,1 +13522,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13563,1 +13529,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13574,1 +13539,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -13582,1 +13546,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -14069,1 +14032,0 @@\n-  assert(!needs_eevex(dst1, dst2, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -14343,1 +14305,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -14351,1 +14312,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -14363,1 +14323,0 @@\n-  assert(!needs_eevex(dst, src) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n@@ -14371,1 +14330,0 @@\n-  assert(!needs_eevex(dst, src.base(), src.index()) || UseAPX, \"extended gpr use requires UseAPX and UseAVX > 2\");\n","filename":"src\/hotspot\/cpu\/x86\/assembler_x86.cpp","additions":8,"deletions":50,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -1005,2 +1005,2 @@\n-  \/\/ APX support code currently requires UseAPX > 2. This may change in the future.\n-  if (UseAPX && (UseAVX < 3)) {\n+  \/\/ APX support not enabled yet\n+  if (UseAPX) {\n@@ -1008,1 +1008,1 @@\n-        warning(\"UseAPX is only available when UseAVX > 2. Disabling UseAPX.\");\n+        warning(\"APX is not supported on this CPU.\");\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}