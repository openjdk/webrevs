{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,0 +26,1 @@\n+import java.awt.EventQueue;\n@@ -32,1 +33,0 @@\n-import java.awt.Window;\n@@ -39,1 +39,0 @@\n-import java.io.IOException;\n@@ -45,1 +44,1 @@\n-\/**\n+\/*\n@@ -51,0 +50,1 @@\n+\n@@ -53,10 +53,5 @@\n-    Frame frame = new Frame(\"window owner\");\n-    Window win = new Window(frame);\n-    Choice choice = new Choice();\n-    Button def = new Button(\"default owner\");\n-    CountDownLatch go = new CountDownLatch(1);\n-\n-    public static void main(final String[] args) throws IOException {\n-        AccessibleChoiceTest app = new AccessibleChoiceTest();\n-        app.test();\n-    }\n+    static Frame frame = new Frame(\"Accessible Choice Test Frame\");\n+    static Choice choice = new Choice();\n+    static Button button = new Button(\"default owner\");\n+    static CountDownLatch go = new CountDownLatch(1);\n+    static volatile Point loc;\n@@ -64,1 +59,1 @@\n-    private void test() throws IOException {\n+    public static void main(final String[] args) throws Exception {\n@@ -66,2 +61,5 @@\n-            init();\n-            start();\n+            System.out.println(\"ONE\");\n+            createAndShowUI();\n+            System.out.println(\"TWO\");\n+            test();\n+            System.out.println(\"THREE\");\n@@ -69,2 +67,4 @@\n-            if (frame != null) frame.dispose();\n-            if (win != null) win.dispose();\n+            if (frame != null) {\n+                System.out.println(\"FOUR\");\n+                frame.dispose();\n+            }\n@@ -74,4 +74,6 @@\n-    public void init() {\n-        win.setLayout (new FlowLayout ());\n-        win.add(def);\n-        def.addFocusListener(new FocusAdapter() {\n+    public static void createAndShowUI() throws Exception {\n+        EventQueue.invokeAndWait(() -> {\n+            System.out.println(\"FIVE\");\n+            frame.setLayout(new FlowLayout());\n+            frame.add(button);\n+            button.addFocusListener(new FocusAdapter() {\n@@ -82,3 +84,7 @@\n-        choice.add(\"One\");\n-        choice.add(\"Two\");\n-        win.add(choice);\n+            choice.add(\"One\");\n+            choice.add(\"Two\");\n+            frame.add(choice);\n+            frame.pack();\n+            frame.setLocationRelativeTo(null);\n+            frame.setVisible(true);\n+        });\n@@ -87,7 +93,2 @@\n-    public void start () throws IOException {\n-        frame.setVisible(true);\n-        win.pack();\n-        win.setLocation(100, 200);\n-        win.setVisible(true);\n-\n-        Robot robot = null;\n+    public static void test() throws Exception {\n+        Robot robot;\n@@ -101,1 +102,0 @@\n-        robot.setAutoDelay(150);\n@@ -104,0 +104,2 @@\n+        System.out.println(\"SIX\");\n+\n@@ -105,2 +107,7 @@\n-        Point loc = def.getLocationOnScreen();\n-        robot.mouseMove(loc.x+2, loc.y+2);\n+        EventQueue.invokeAndWait(() -> {\n+            loc = button.getLocationOnScreen();\n+        });\n+        robot.mouseMove(loc.x + button.getWidth() \/ 2, loc.y\n+                + button.getHeight() \/ 2);\n+        robot.delay(500);\n+        System.out.println(\"SEVEN\");\n@@ -109,0 +116,1 @@\n+        System.out.println(\"EIGHT\");\n@@ -116,1 +124,1 @@\n-        if (!def.isFocusOwner()) {\n+        if (!button.isFocusOwner()) {\n@@ -120,0 +128,2 @@\n+        robot.delay(500);\n+\n@@ -126,1 +136,5 @@\n-        \/\/ Press Down key to select next item in the choice(Motif 2.1)\n+        if (!choice.isFocusOwner()) {\n+            throw new RuntimeException(\"Choice doesn't have focus\");\n+        }\n+\n+        \/\/ Press Down key to select next item in the choice\n@@ -131,2 +145,0 @@\n-        robot.delay(500);\n-\n@@ -135,0 +147,1 @@\n+            robot.delay(500);\n@@ -145,1 +158,1 @@\n-        if (choice.getSelectedItem() != choice.getItem(1)) {\n+        if (!choice.getSelectedItem().equals(choice.getItem(1))) {\n","filename":"test\/jdk\/java\/awt\/Focus\/UnaccessibleChoice\/AccessibleChoiceTest.java","additions":54,"deletions":41,"binary":false,"changes":95,"status":"modified"}]}