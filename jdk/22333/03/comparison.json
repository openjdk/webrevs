{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,0 +26,1 @@\n+import java.awt.EventQueue;\n@@ -32,1 +33,0 @@\n-import java.awt.Window;\n@@ -39,1 +39,0 @@\n-import java.io.IOException;\n@@ -45,1 +44,1 @@\n-\/**\n+\/*\n@@ -51,12 +50,0 @@\n-public class AccessibleChoiceTest {\n-    \/\/Declare things used in the test, like buttons and labels here\n-    Frame frame = new Frame(\"window owner\");\n-    Window win = new Window(frame);\n-    Choice choice = new Choice();\n-    Button def = new Button(\"default owner\");\n-    CountDownLatch go = new CountDownLatch(1);\n-\n-    public static void main(final String[] args) throws IOException {\n-        AccessibleChoiceTest app = new AccessibleChoiceTest();\n-        app.test();\n-    }\n@@ -64,1 +51,10 @@\n-    private void test() throws IOException {\n+public class AccessibleChoiceTest {\n+    static Frame frame;\n+    static Choice choice;\n+    static Button button;\n+    static volatile CountDownLatch go;\n+    static volatile Point loc;\n+    static volatile int bWidth;\n+    static volatile int bHeight;\n+\n+    public static void main(final String[] args) throws Exception {\n@@ -66,2 +62,2 @@\n-            init();\n-            start();\n+            createAndShowUI();\n+            test();\n@@ -69,2 +65,3 @@\n-            if (frame != null) frame.dispose();\n-            if (win != null) win.dispose();\n+            if (frame != null) {\n+                EventQueue.invokeAndWait(() -> frame.dispose());\n+            }\n@@ -74,4 +71,9 @@\n-    public void init() {\n-        win.setLayout (new FlowLayout ());\n-        win.add(def);\n-        def.addFocusListener(new FocusAdapter() {\n+    public static void createAndShowUI() throws Exception {\n+        go = new CountDownLatch(1);\n+        EventQueue.invokeAndWait(() -> {\n+            frame = new Frame(\"Accessible Choice Test Frame\");\n+            choice = new Choice();\n+            button = new Button(\"default owner\");\n+            frame.setLayout(new FlowLayout());\n+            frame.add(button);\n+            button.addFocusListener(new FocusAdapter() {\n@@ -82,3 +84,7 @@\n-        choice.add(\"One\");\n-        choice.add(\"Two\");\n-        win.add(choice);\n+            choice.add(\"One\");\n+            choice.add(\"Two\");\n+            frame.add(choice);\n+            frame.pack();\n+            frame.setLocationRelativeTo(null);\n+            frame.setVisible(true);\n+        });\n@@ -87,7 +93,2 @@\n-    public void start () throws IOException {\n-        frame.setVisible(true);\n-        win.pack();\n-        win.setLocation(100, 200);\n-        win.setVisible(true);\n-\n-        Robot robot = null;\n+    public static void test() throws Exception {\n+        Robot robot;\n@@ -101,1 +102,0 @@\n-        robot.setAutoDelay(150);\n@@ -105,2 +105,8 @@\n-        Point loc = def.getLocationOnScreen();\n-        robot.mouseMove(loc.x+2, loc.y+2);\n+        EventQueue.invokeAndWait(() -> {\n+            loc = button.getLocationOnScreen();\n+            bWidth = button.getWidth();\n+            bHeight = button.getHeight();\n+        });\n+        robot.mouseMove(loc.x + bWidth \/ 2,\n+                        loc.y + bHeight \/ 2);\n+        robot.delay(500);\n@@ -116,1 +122,1 @@\n-        if (!def.isFocusOwner()) {\n+        if (!button.isFocusOwner()) {\n@@ -120,0 +126,2 @@\n+        robot.delay(500);\n+\n@@ -126,1 +134,5 @@\n-        \/\/ Press Down key to select next item in the choice(Motif 2.1)\n+        if (!choice.isFocusOwner()) {\n+            throw new RuntimeException(\"Choice doesn't have focus\");\n+        }\n+\n+        \/\/ Press Down key to select next item in the choice\n@@ -131,2 +143,0 @@\n-        robot.delay(500);\n-\n@@ -135,0 +145,1 @@\n+            robot.delay(500);\n@@ -145,1 +156,1 @@\n-        if (choice.getSelectedItem() != choice.getItem(1)) {\n+        if (!choice.getSelectedItem().equals(choice.getItem(1))) {\n","filename":"test\/jdk\/java\/awt\/Focus\/UnaccessibleChoice\/AccessibleChoiceTest.java","additions":54,"deletions":43,"binary":false,"changes":97,"status":"modified"}]}