{"files":[{"patch":"@@ -1816,0 +1816,3 @@\n+            if (uiInputMap == null) {\n+                map.clear();\n+            }\n@@ -1840,0 +1843,3 @@\n+            if (uiActionMap == null) {\n+                map.clear();\n+            }\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/SwingUtilities.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -0,0 +1,90 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 6726690\n+ * @summary Verifies SwingUtilities.replaceUI*Map() methods remove\n+ *          previously installed maps\n+ * @run main UIMapTest\n+ *\/\n+\n+import java.awt.event.ActionEvent;\n+import java.awt.event.KeyEvent;\n+import javax.swing.AbstractAction;\n+import javax.swing.Action;\n+import javax.swing.ActionMap;\n+import javax.swing.ComponentInputMap;\n+import javax.swing.InputMap;\n+import javax.swing.JButton;\n+import javax.swing.JComponent;\n+import javax.swing.JFrame;\n+import javax.swing.KeyStroke;\n+import javax.swing.SwingUtilities;\n+\n+public class UIMapTest {\n+\n+    public static void main(String[] args) {\n+\n+        StringBuilder str = new StringBuilder();\n+\n+        \/\/ Create the test button\n+        JButton button = new JButton(\"Test\");\n+\n+        \/\/ Create an input map that maps ENTER to the button\n+        ComponentInputMap map = new ComponentInputMap(button);\n+        map.put(KeyStroke.getKeyStroke(\"pressed ENTER\"), \"pressed\");\n+        map.put(KeyStroke.getKeyStroke(\"released ENTER\"), \"released\");\n+\n+        \/\/ Add the map\n+        SwingUtilities.replaceUIInputMap(button, JComponent.WHEN_IN_FOCUSED_WINDOW, map);\n+\n+        \/\/ Attempt to remove the map\n+        SwingUtilities.replaceUIInputMap(button, JComponent.WHEN_IN_FOCUSED_WINDOW, null);\n+\n+        if (button.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).\n+            get(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0)) != null) {\n+            str.append(\"\\nSwingUtilities.replaceUIInputMap \" +\n+                       \"didn't remove previously installed input map\");\n+        }\n+\n+        \/\/ Get the InputMap for the button when it has focus\n+        InputMap inputMap = button.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);\n+\n+        \/\/ Map the VK_ENTER key stroke to a specific action name\n+        inputMap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), \"doEnterAction\");\n+        Action enterAction = new AbstractAction() {\n+            @Override\n+            public void actionPerformed(ActionEvent e) { }\n+        };\n+        button.getActionMap().put(\"doEnterAction\",  enterAction);\n+        SwingUtilities.replaceUIActionMap(button, null);\n+        if (button.getActionMap().size() != 0) {\n+            str.append(\"\\nSwingUtilities.replaceUIActionMap \" +\n+                       \"didn't remove previously installed action map\");\n+        }\n+        if (str.length() != 0) {\n+            throw new RuntimeException(str.toString());\n+        }\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/SwingUtilities\/UIMapTest.java","additions":90,"deletions":0,"binary":false,"changes":90,"status":"added"}]}