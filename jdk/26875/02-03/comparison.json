{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test id=AES-ECB\n+ * @test\n@@ -30,19 +30,1 @@\n- * @run main\/othervm TestCipherMode AES\/ECB\/PKCS5Padding\n- *\/\n-\n-\/*\n- * @test id=AES-GCM\n- * @bug 8265500\n- * @summary\n- * @library \/test\/lib ..\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestCipherMode AES\/GCM\/NoPadding\n- *\/\n-\n-\/*\n- * @test id=RSA-ECB\n- * @bug 8265500\n- * @summary\n- * @library \/test\/lib ..\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestCipherMode RSA\/ECB\/PKCS1Padding\n+ * @run main\/othervm TestCipherMode\n@@ -113,0 +95,18 @@\n+        final String[] transformations = {\n+                \"AES\/ECB\/PKCS5Padding\", \"AES\/GCM\/NoPadding\", \"RSA\/ECB\/PKCS1Padding\"\n+        };\n+\n+        boolean skipEncountered = false;\n+        for (final String t : transformations) {\n+            try {\n+                main(new TestCipherMode(t), args);\n+            } catch (SkippedException skippedException) {\n+                \/\/ printing to System.out, so it's easier to see which test it relates to\n+                skippedException.printStackTrace(System.out);\n+                skipEncountered = true;\n+            }\n+        }\n+\n+        if (skipEncountered) {\n+            throw new SkippedException(\"One or more transformations skipped\");\n+        }\n@@ -114,1 +114,0 @@\n-        main(new TestCipherMode(args[0]), args);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestCipherMode.java","additions":21,"deletions":22,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n- * @test id=ARCFOUR-ARCFOUR-400\n+ * @test\n@@ -32,1 +32,1 @@\n- * @run main\/othervm TestSymmCiphers ARCFOUR ARCFOUR 400\n+ * @run main\/othervm TestSymmCiphers\n@@ -35,231 +35,0 @@\n-\/*\n- * @test id=RC4-RC4-401\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers RC4 RC4 401\n- *\/\n-\n-\/*\n- * @test id=DES-CBC-NOPADDING-DES-400\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES\/CBC\/NoPadding DES 400\n- *\/\n-\n-\/*\n- * @test id=DESEDE-CBC-NOPADDING-DESEDE-160\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DESede\/CBC\/NoPadding DESede 160\n- *\/\n-\n-\/*\n- * @test id=AES-CBC-NOPADDING-AES-4800\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/CBC\/NoPadding AES 4800\n- *\/\n-\n-\/*\n- * @test id=BLOWFISH-CBC-NOPADDING-BLOWFISH-24\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers Blowfish\/CBC\/NoPadding Blowfish 24\n- *\/\n-\n-\/*\n- * @test id=DES-CBC-PKCS5PADDING-DES-6401\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES\/cbc\/PKCS5Padding DES 6401\n- *\/\n-\n-\/*\n- * @test id=DESEDE-CBC-PKCS5PADDING-DESEDE-402\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DESede\/CBC\/PKCS5Padding DESede 402\n- *\/\n-\n-\/*\n- * @test id=AES-CBC-PKCS5PADDING-AES-30\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/CBC\/PKCS5Padding AES 30\n- *\/\n-\n-\/*\n- * @test id=BLOWFISH-CBC-PKCS5PADDING-BLOWFISH-19\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers Blowfish\/CBC\/PKCS5Padding Blowfish 19\n- *\/\n-\n-\/*\n- * @test id=DES-ECB-NOPADDING-DES-400\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES\/ECB\/NoPadding DES 400\n- *\/\n-\n-\/*\n- * @test id=DESEDE-ECB-NOPADDING-DESEDE-160\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DESede\/ECB\/NoPadding DESede 160\n- *\/\n-\n-\/*\n- * @test id=AES-ECB-NOPADDING-AES-4800\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/ECB\/NoPadding AES 4800\n- *\/\n-\n-\/*\n- * @test id=DES-ECB-PKCS5PADDING-DES-32\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES\/ECB\/PKCS5Padding DES 32\n- *\/\n-\n-\/*\n- * @test id=DES-ECB-PKCS5PADDING-DES-6400\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES\/ECB\/PKCS5Padding DES 6400\n- *\/\n-\n-\/*\n- * @test id=DESEDE-ECB-PKCS5PADDING-DESEDE-400\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DESede\/ECB\/PKCS5Padding DESede 400\n- *\/\n-\n-\/*\n- * @test id=AES-ECB-PKCS5PADDING-AES-64\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/ECB\/PKCS5Padding AES 64\n- *\/\n-\n-\/*\n- * @test id=DES-DES-6400\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DES DES 6400\n- *\/\n-\n-\/*\n- * @test id=DESEDE-DESEDE-408\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers DESede DESede 408\n- *\/\n-\n-\/*\n- * @test id=AES-AES-128\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES AES 128\n- *\/\n-\n-\/*\n- * @test id=AES-CTR-NOPADDING-AES-3200\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/CTR\/NoPadding AES 3200\n- *\/\n-\n-\/*\n- * @test id=AES-CTS-NOPADDING-AES-3200\n- * @bug 4898461 6604496 8330842\n- * @summary basic test for symmetric ciphers with padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphers AES\/CTS\/NoPadding AES 3200\n- *\/\n-\n@@ -273,0 +42,1 @@\n+import java.util.List;\n@@ -448,1 +218,42 @@\n-        main(new TestSymmCiphers(args[0], args[1], Integer.parseInt(args[2])), args);\n+\n+        final List<String[]> tests = List.of(\n+                new String[]{\"ARCFOUR\", \"ARCFOUR\", \"400\"},\n+                new String[]{\"RC4\", \"RC4\", \"401\"},\n+                new String[]{\"DES\/CBC\/NoPadding\", \"DES\", \"400\"},\n+                new String[]{\"DESede\/CBC\/NoPadding\", \"DESede\", \"160\"},\n+                new String[]{\"AES\/CBC\/NoPadding\", \"AES\", \"4800\"},\n+                new String[]{\"Blowfish\/CBC\/NoPadding\", \"Blowfish\", \"24\"},\n+                new String[]{\"DES\/cbc\/PKCS5Padding\", \"DES\", \"6401\"},\n+                new String[]{\"DESede\/CBC\/PKCS5Padding\", \"DESede\", \"402\"},\n+                new String[]{\"AES\/CBC\/PKCS5Padding\", \"AES\", \"30\"},\n+                new String[]{\"Blowfish\/CBC\/PKCS5Padding\", \"Blowfish\", \"19\"},\n+                new String[]{\"DES\/ECB\/NoPadding\", \"DES\", \"400\"},\n+                new String[]{\"DESede\/ECB\/NoPadding\", \"DESede\", \"160\"},\n+                new String[]{\"AES\/ECB\/NoPadding\", \"AES\", \"4800\"},\n+                new String[]{\"DES\/ECB\/PKCS5Padding\", \"DES\", \"32\"},\n+                new String[]{\"DES\/ECB\/PKCS5Padding\", \"DES\", \"6400\"},\n+                new String[]{\"DESede\/ECB\/PKCS5Padding\", \"DESede\", \"400\"},\n+                new String[]{\"AES\/ECB\/PKCS5Padding\", \"AES\", \"64\"},\n+\n+                new String[]{\"DES\", \"DES\", \"6400\"},\n+                new String[]{\"DESede\", \"DESede\", \"408\"},\n+                new String[]{\"AES\", \"AES\", \"128\"},\n+\n+                new String[]{\"AES\/CTR\/NoPadding\", \"AES\", \"3200\"},\n+                new String[]{\"AES\/CTS\/NoPadding\", \"AES\", \"3200\"}\n+\n+        );\n+\n+        boolean skipEncountered = false;\n+        for (final String[] t : tests) {\n+            try {\n+                main(new TestSymmCiphers(t[0], t[1], Integer.parseInt(t[2])), args);\n+            } catch (SkippedException skippedException) {\n+                skippedException.printStackTrace(System.err);\n+                skipEncountered = true;\n+            }\n+        }\n+\n+        if (skipEncountered) {\n+            throw new SkippedException(\"One or more tests skipped\");\n+        }\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestSymmCiphers.java","additions":45,"deletions":234,"binary":false,"changes":279,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n- * @test id=ARCFOUR-ARCFOUR-400\n+ * @test\n@@ -32,100 +32,1 @@\n- * @run main\/othervm TestSymmCiphersNoPad ARCFOUR ARCFOUR 400\n- *\/\n-\n-\/*\n- * @test id=RC4-RC4-401\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad RC4 RC4 401\n- *\/\n-\n-\/*\n- * @test id=DES-CBC-NOPADDING-DES-400\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad DES\/CBC\/NoPadding DES 400\n- *\/\n-\n-\/*\n- * @test id=DESEDE-CBC-NOPADDING-DESEDE-160\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad DESede\/CBC\/NoPadding DESede 160\n- *\/\n-\n-\/*\n- * @test id=AES-CBC-NOPADDING-AES-4800\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad AES\/CBC\/NoPadding AES 4800\n- *\/\n-\n-\/*\n- * @test id=BLOWFISH-CBC-NOPADDING-BLOWFISH-24\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad Blowfish\/CBC\/NoPadding Blowfish 24\n- *\/\n-\n-\/*\n- * @test id=AES-CTR-NOPADDING-AES-1600\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad AES\/CTR\/NoPadding AES 1600\n- *\/\n-\n-\/*\n- * @test id=AES-CTR-NOPADDING-AES-65\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad AES\/CTR\/NoPadding AES 65\n- *\/\n-\n-\/*\n- * @test id=AES-CTS-NOPADDING-AES-1600\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad AES\/CTS\/NoPadding AES 1600\n- *\/\n-\n-\/*\n- * @test id=AES-CTS-NOPADDING-AES-65\n- * @bug 4898484 6604496 8001284 8330842\n- * @summary basic test for symmetric ciphers with no padding\n- * @author Valerie Peng\n- * @library \/test\/lib ..\n- * @key randomness\n- * @modules jdk.crypto.cryptoki\n- * @run main\/othervm TestSymmCiphersNoPad AES\/CTS\/NoPadding AES 65\n+ * @run main\/othervm TestSymmCiphersNoPad\n@@ -143,0 +44,1 @@\n+import java.util.List;\n@@ -326,1 +228,27 @@\n-        main(new TestSymmCiphersNoPad(args[0], args[1], Integer.parseInt(args[2])), args);\n+\n+        final List<String[]> tests = List.of(\n+                new String[]{\"ARCFOUR\", \"ARCFOUR\", \"400\"},\n+                new String[]{\"RC4\", \"RC4\", \"401\"},\n+                new String[]{\"DES\/CBC\/NoPadding\", \"DES\", \"400\"},\n+                new String[]{\"DESede\/CBC\/NoPadding\", \"DESede\", \"160\"},\n+                new String[]{\"AES\/CBC\/NoPadding\", \"AES\", \"4800\"},\n+                new String[]{\"Blowfish\/CBC\/NoPadding\", \"Blowfish\", \"24\"},\n+                new String[]{\"AES\/CTR\/NoPadding\", \"AES\", \"1600\"},\n+                new String[]{\"AES\/CTR\/NoPadding\", \"AES\", \"65\"},\n+                new String[]{\"AES\/CTS\/NoPadding\", \"AES\", \"1600\"},\n+                new String[]{\"AES\/CTS\/NoPadding\", \"AES\", \"65\"}\n+        );\n+\n+        boolean skipEncountered = false;\n+        for (final String[] t : tests) {\n+            try {\n+                main(new TestSymmCiphersNoPad(t[0], t[1], Integer.parseInt(t[2])), args);\n+            } catch (SkippedException skippedException) {\n+                skippedException.printStackTrace(System.err);\n+                skipEncountered = true;\n+            }\n+        }\n+\n+        if (skipEncountered) {\n+            throw new SkippedException(\"One or more tests skipped\");\n+        }\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestSymmCiphersNoPad.java","additions":30,"deletions":102,"binary":false,"changes":132,"status":"modified"}]}