{"files":[{"patch":"@@ -45,0 +45,1 @@\n+import java.util.ArrayDeque;\n@@ -130,0 +131,2 @@\n+                        \/\/ The checksums are stored in the header so it should be skipped\n+                        \/\/ since we want to see the first meaningful diff between the archives\n@@ -166,0 +169,2 @@\n+        String region = \"\";\n+\n@@ -176,0 +181,4 @@\n+        \/\/ Store lines before and including the diff\n+        ArrayDeque<String> prefix0 = new ArrayDeque<String>();\n+        ArrayDeque<String> prefix1 = new ArrayDeque<String>();\n+\n@@ -181,1 +190,9 @@\n-            \/\/ Skip lines with headers e.g.\n+\n+            if (prefix0.size() >= NUM_LINES \/ 2 + 1) {\n+                prefix0.removeFirst();\n+                prefix1.removeFirst();\n+            }\n+            prefix0.addLast(s0);\n+            prefix1.addLast(s1);\n+\n+            \/\/ Skip lines with headers when counting words e.g.\n@@ -188,0 +205,2 @@\n+            } else if (s0.contains(\"bytes]\")) {\n+                region = s0;\n@@ -191,0 +210,1 @@\n+        \/\/ Print the diff with the region name above it\n@@ -192,1 +212,2 @@\n-        String diff_f0 = print_diff_helper(b0, word_offset, s0);\n+        System.out.println(region);\n+        String diff_f0 = print_diff_helper(b0, word_offset, prefix0);\n@@ -195,1 +216,2 @@\n-        String diff_f1 = print_diff_helper(b1, word_offset, s1);\n+        System.out.println(region);\n+        String diff_f1 = print_diff_helper(b1, word_offset, prefix1);\n@@ -204,2 +226,1 @@\n-    static String print_diff_helper(BufferedReader b, int word_offset, String line) throws Exception {\n-        \/\/ Extract word from line\n+    static String print_diff_helper(BufferedReader b, int word_offset, ArrayDeque<String> prefix) throws Exception {\n@@ -208,0 +229,1 @@\n+        String line = prefix.getLast();\n@@ -210,0 +232,5 @@\n+        \/\/ Print previous lines\n+        for (String s : prefix) {\n+            System.out.println(s);\n+        }\n+\n@@ -211,2 +238,1 @@\n-        System.out.println(line);\n-        for (int i = 0; i < NUM_LINES; i++) {\n+        for (int i = 0; i < NUM_LINES \/ 2; i++) {\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/DeterministicDump.java","additions":33,"deletions":7,"binary":false,"changes":40,"status":"modified"}]}