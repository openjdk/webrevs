{"files":[{"patch":"@@ -533,3 +533,4 @@\n-\t  $$(eval $1_TOTAL := $$(shell $$(AWK) '\/==========.* tests? from .* \\\n-\t      test (cases?|suites?) ran\/ { print $$$$2 }' $$($1_RESULT_FILE))) \\\n-\t  $$(if $$($1_TOTAL), , $$(eval $1_TOTAL := 0)) \\\n+\t  $$(eval $1_RUN := $$(shell $$(AWK) \\\n+\t      '\/==========.* tests? from .* test (cases?|suites?) ran\/ { print $$$$2 }' \\\n+\t      $$($1_RESULT_FILE))) \\\n+\t  $$(if $$($1_RUN), , $$(eval $1_RUN := 0)) \\\n@@ -539,0 +540,9 @@\n+\t  $$(eval $1_SKIPPED := $$(shell $$(AWK) \\\n+\t      '\/YOU HAVE [0-9]+ DISABLED TEST\/ { \\\n+\t          if (match($$$$0, \/[0-9]+\/, arr)) { \\\n+\t            print arr[0]; \\\n+\t            found=1; \\\n+\t          } \\\n+\t          if (!found) { print 0; } \\\n+\t      }' \\\n+\t      $$($1_RESULT_FILE))) \\\n@@ -543,1 +553,3 @@\n-\t      $$(EXPR) $$($1_TOTAL) - $$($1_PASSED) - $$($1_FAILED))) \\\n+\t      $$(EXPR) $$($1_RUN) - $$($1_PASSED) - $$($1_FAILED))) \\\n+\t  $$(eval $1_TOTAL := $$(shell \\\n+\t      $$(EXPR) $$($1_RUN) + $$($1_SKIPPED))) \\\n@@ -548,0 +560,1 @@\n+\t  $$(eval $1_SKIPPED := 0) \\\n@@ -671,0 +684,1 @@\n+\t$$(eval $1_SKIPPED := 0)\n@@ -1038,0 +1052,7 @@\n+\n+\t# Read jtreg documentation to learn on the test stats categories:\n+\t# https:\/\/github.com\/openjdk\/jtreg\/blob\/master\/src\/share\/doc\/javatest\/regtest\/faq.md#what-do-all-those-numbers-in-the-test-results-line-mean\n+\t# In jtreg, \"skipped:\" category accounts for tests that threw jtreg.SkippedException at runtime.\n+\t# At the same time these tests contribute to \"passed:\" tests.\n+\t# In here we don't want that and so we substract number of \"skipped:\" from \"passed:\".\n+\n@@ -1039,1 +1060,1 @@\n-\t  $$(eval $1_PASSED := $$(shell $$(AWK) '{ gsub(\/[,;]\/, \"\"); \\\n+\t  $$(eval $1_PASSED_AND_RUNTIME_SKIPPED := $$(shell $$(AWK) '{ gsub(\/[,;]\/, \"\"); \\\n@@ -1042,1 +1063,1 @@\n-\t  $$(if $$($1_PASSED), , $$(eval $1_PASSED := 0)) \\\n+\t  $$(if $$($1_PASSED_AND_RUNTIME_SKIPPED), , $$(eval $1_PASSED_AND_RUNTIME_SKIPPED := 0)) \\\n@@ -1047,0 +1068,29 @@\n+\t  $$(eval $1_RUNTIME_SKIPPED := $$(shell $$(AWK) '{gsub(\/[,;]\/, \"\"); \\\n+\t      for (i=1; i<=NF; i++) { if ($$$$i == \"skipped:\") \\\n+\t      print $$$$(i+1) } }' $$($1_RESULT_FILE))) \\\n+\t  $$(if $$($1_RUNTIME_SKIPPED), , $$(eval $1_RUNTIME_SKIPPED := 0)) \\\n+\t  $$(eval $1_SKIPPED := $$(shell \\\n+\t      $$(AWK) \\\n+\t        'BEGIN { \\\n+\t          overall_skipped = 0; \\\n+\t          patterns[1] = \"skipped\"; \\\n+\t          patterns[2] = \"excluded\"; \\\n+\t          patterns[3] = \"not in match-list\"; \\\n+\t          patterns[4] = \"did not match keywords\"; \\\n+\t          patterns[5] = \"did not meet module requirements\"; \\\n+\t          patterns[6] = \"did not meet platform requirements\"; \\\n+\t          patterns[7] = \"did not match prior status\"; \\\n+\t          patterns[8] = \"did not meet time-limit requirements\"; \\\n+\t        } { \\\n+\t          split($$$$0, arr, \";\"); \\\n+\t          for (item in arr) { \\\n+\t            for (p in patterns) { \\\n+\t              if (match(arr[item], patterns[p] \": [0-9]+\")) { \\\n+\t                overall_skipped += substr(arr[item], RSTART + length(patterns[p]) + 2, RLENGTH); \\\n+\t              } \\\n+\t            } \\\n+\t          } \\\n+\t          print overall_skipped; \\\n+\t        }' \\\n+\t        $$($1_RESULT_FILE) \\\n+\t  )) \\\n@@ -1051,0 +1101,3 @@\n+\t  \\\n+\t  $$(eval $1_PASSED := $$(shell \\\n+\t      $$(EXPR) $$($1_PASSED_AND_RUNTIME_SKIPPED) - $$($1_RUNTIME_SKIPPED))) \\\n@@ -1052,1 +1105,1 @@\n-\t      $$(EXPR) $$($1_PASSED) + $$($1_FAILED) + $$($1_ERROR))) \\\n+\t      $$(EXPR) $$($1_PASSED) + $$($1_FAILED) + $$($1_ERROR) + $$($1_SKIPPED))) \\\n@@ -1054,1 +1107,3 @@\n-\t  $$(eval $1_PASSED := 0) \\\n+\t  $$(eval $1_PASSED_AND_RUNTIME_SKIPPED := 0) \\\n+\t  $$(eval $1_RUNTIME_SKIPPED := 0) \\\n+\t  $$(eval $1_SKIPPED := 0) \\\n@@ -1113,2 +1168,0 @@\n-  $1_RESULT_FILE := $$($1_TEST_RESULTS_DIR)\/gtest.txt\n-\n@@ -1124,0 +1177,1 @@\n+\t$$(eval $1_SKIPPED := 0)\n@@ -1233,2 +1287,2 @@\n-\t$(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5s %5s %5s %5s %2s\\n\" \"  \" \\\n-\t    TEST TOTAL PASS FAIL ERROR \" \"\n+\t$(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5s %5s %5s %5s %5s %2s\\n\" \"  \" \\\n+\t    TEST TOTAL PASS FAIL ERROR SKIP \" \"\n@@ -1246,6 +1300,2 @@\n-\t  $(if $(filter $($(TEST_ID)_PASSED), $($(TEST_ID)_TOTAL)), \\\n-\t    $(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5d %5d %5d %5d %2s\\n\" \\\n-\t        \"  \" \"$(TEST_NAME)\" $($(TEST_ID)_TOTAL) $($(TEST_ID)_PASSED) \\\n-\t        $($(TEST_ID)_FAILED) $($(TEST_ID)_ERROR) \"  \" $(NEWLINE) \\\n-\t  , \\\n-\t    $(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5d %5d %5d %5d %2s\\n\" \\\n+\t  $(if $(filter-out 0, $($(TEST_ID)_FAILED) $($(TEST_ID)_ERROR)), \\\n+\t    $(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5d %5d %5d %5d %5d %2s\\n\" \\\n@@ -1253,1 +1303,1 @@\n-\t        $($(TEST_ID)_FAILED) $($(TEST_ID)_ERROR) \"<<\" $(NEWLINE) \\\n+\t        $($(TEST_ID)_FAILED) $($(TEST_ID)_ERROR) $($(TEST_ID)_SKIPPED) \"<<\" $(NEWLINE) \\\n@@ -1255,0 +1305,4 @@\n+\t  , \\\n+\t    $(PRINTF) >> $(TEST_SUMMARY) \"%2s %-49s %5d %5d %5d %5d %5d %2s\\n\" \\\n+\t        \"  \" \"$(TEST_NAME)\" $($(TEST_ID)_TOTAL) $($(TEST_ID)_PASSED) \\\n+\t        $($(TEST_ID)_FAILED) $($(TEST_ID)_ERROR) $($(TEST_ID)_SKIPPED) \"  \" $(NEWLINE) \\\n","filename":"make\/RunTests.gmk","additions":73,"deletions":19,"binary":false,"changes":92,"status":"modified"}]}