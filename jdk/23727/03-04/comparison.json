{"files":[{"patch":"@@ -50,1 +50,1 @@\n- * @run main\/othervm CertReplace certreplace.jks certreplace.certs\n+ * @run main CertReplace certreplace.jks certreplace.certs\n@@ -105,14 +105,11 @@\n-        final CertificateFactory certificateFactory = CertificateFactory.getInstance(\"X509\");\n-\n-        final FileInputStream certInputStream = new FileInputStream(\"int.cert\");\n-        final Certificate[] certs = new Certificate[]{\n-                CertUtils.getCertFromStream(\n-                        certInputStream\n-                )\n-        };\n-        certInputStream.close();\n-\n-        final PrivateKey privateKey = (PrivateKey) keyStore.getKey(\"int\", PASSWORD_CHAR_ARR);\n-        keyStore.setKeyEntry(\"int\", privateKey, PASSWORD_CHAR_ARR, certs);\n-        keyStore.store(new FileOutputStream(CERTREPLACE_JKS), PASSWORD_CHAR_ARR);\n-\n+        try (final FileInputStream certInputStream = new FileInputStream(\"int.cert\")) {\n+            final Certificate[] certs = new Certificate[]{\n+                    CertUtils.getCertFromStream(\n+                            certInputStream\n+                    )\n+            };\n+\n+            final PrivateKey privateKey = (PrivateKey) keyStore.getKey(\"int\", PASSWORD_CHAR_ARR);\n+            keyStore.setKeyEntry(\"int\", privateKey, PASSWORD_CHAR_ARR, certs);\n+            keyStore.store(new FileOutputStream(CERTREPLACE_JKS), PASSWORD_CHAR_ARR);\n+        }\n@@ -171,2 +168,0 @@\n-        final KeyStore keyStore = KeyStoreUtils.loadKeyStore(SAMEDN_JKS, PASSWORD);\n-\n@@ -187,0 +182,1 @@\n+        final KeyStore keyStore = KeyStoreUtils.loadKeyStore(SAMEDN_JKS, PASSWORD);\n@@ -205,1 +201,3 @@\n-        ks.load(new FileInputStream(args[0]), \"changeit\".toCharArray());\n+        try (final FileInputStream certInputStream = new FileInputStream(args[0])) {\n+            ks.load(certInputStream, PASSWORD_CHAR_ARR);\n+        }\n","filename":"test\/jdk\/sun\/security\/validator\/CertReplace.java","additions":16,"deletions":18,"binary":false,"changes":34,"status":"modified"}]}