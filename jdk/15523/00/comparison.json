{"files":[{"patch":"@@ -186,32 +186,1 @@\n-            boolean skippedDefault = false;\n-            boolean skippedNSS = false;\n-            boolean skippedDeimos = false;\n-\n-            \/\/ Use separate try-catch for each test to allow all test run\n-            try {\n-                testDefault(test);\n-            } catch (SkippedException se) {\n-                System.out.println(\"testDefault: Skipped\");\n-                skippedDefault = true;\n-                se.printStackTrace(System.out);\n-            }\n-\n-            try {\n-                testNSS(test);\n-            } catch (SkippedException se) {\n-                System.out.println(\"testNSS: Skipped\");\n-                skippedNSS = true;\n-                se.printStackTrace(System.out);\n-            }\n-\n-            try {\n-                testDeimos(test);\n-            } catch (SkippedException se) {\n-                System.out.println(\"testDeimos: Skipped\");\n-                skippedDeimos = true;\n-                se.printStackTrace(System.out);\n-            }\n-\n-            if (skippedDefault && skippedNSS && skippedDeimos) {\n-                throw new SkippedException(\"All tests are skipped, check logs\");\n-            }\n+            testNSS(test);\n@@ -224,1 +193,1 @@\n-            \/\/ Do not restore providers if nothing changed. This is especailly\n+            \/\/ Do not restore providers if nothing changed. This is especially\n@@ -246,45 +215,0 @@\n-    public static void testDeimos(PKCS11Test test) throws Exception {\n-        System.out.println(\"===> testDeimos: Starting test run\");\n-        if (\"true\".equals(System.getProperty(\"NO_DEIMOS\"))) {\n-            System.out.println(\"Skip Deimos software as test configured with NO_DEIMOS\");\n-            return;\n-        }\n-\n-        if (!new File(\"\/opt\/SUNWconn\/lib\/libpkcs11.so\").isFile()) {\n-            throw new SkippedException(\"testDeimos: \\\"\/opt\/SUNWconn\/lib\/libpkcs11.so\\\" \" +\n-                    \"file required for Deimos not found\");\n-        }\n-\n-        String base = getBase();\n-        String p11config = base + SEP + \"nss\" + SEP + \"p11-deimos.txt\";\n-        Provider p = getSunPKCS11(p11config);\n-        test.premain(p);\n-        System.out.println(\"testDeimos: Completed\");\n-    }\n-\n-    \/\/ Run test for default configured PKCS11 providers (if any)\n-    public static void testDefault(PKCS11Test test) throws Exception {\n-        System.out.println(\"===> testDefault: Starting test run\");\n-        boolean foundPKCS11 = false;\n-\n-        if (\"true\".equals(System.getProperty(\"NO_DEFAULT\"))) {\n-            System.out.println(\"Skip default provider as test configured with NO_DEFAULT\");\n-            return;\n-        }\n-\n-        Provider[] providers = Security.getProviders();\n-        for (Provider p : providers) {\n-            if (p.getName().startsWith(\"SunPKCS11-\")) {\n-                foundPKCS11 = true;\n-                test.premain(p);\n-            }\n-        }\n-\n-        if (!foundPKCS11) {\n-            throw new SkippedException(\"testDefault: Skip default test as SunPKCS11 \" +\n-                    \"provider is not configured\");\n-        }\n-\n-        System.out.println(\"testDefault: Completed\");\n-    }\n-\n@@ -976,2 +900,0 @@\n-        System.setProperty(\"NO_DEIMOS\", \"true\");\n-        System.setProperty(\"NO_DEFAULT\", \"true\");\n","filename":"test\/jdk\/sun\/security\/pkcs11\/PKCS11Test.java","additions":2,"deletions":80,"binary":false,"changes":82,"status":"modified"},{"patch":"@@ -123,2 +123,0 @@\n-        -DNO_DEFAULT=true \\\n-        -DNO_DEIMOS=true \\\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Provider\/MultipleLogins.sh","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,14 +0,0 @@\n-#\n-#\n-#\n-# Configuration to run unit tests with the Deimos (SCA1000) software\n-#\n-\n-name = Deimos\n-\n-#showInfo = true\n-\n-library = \/opt\/SUNWconn\/lib\/libpkcs11.so\n-\n-attributes = compatibility\n-\n","filename":"test\/jdk\/sun\/security\/pkcs11\/nss\/p11-deimos.txt","additions":0,"deletions":14,"binary":false,"changes":14,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -42,1 +42,1 @@\n- * @run main\/othervm -DCUSTOM_P11_CONFIG_NAME=p11-nss-sensitive.txt -DNO_DEIMOS=true -DNO_DEFAULT=true TestP11KeyFactoryGetRSAKeySpec\n+ * @run main\/othervm -DCUSTOM_P11_CONFIG_NAME=p11-nss-sensitive.txt TestP11KeyFactoryGetRSAKeySpec\n","filename":"test\/jdk\/sun\/security\/pkcs11\/rsa\/TestP11KeyFactoryGetRSAKeySpec.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}