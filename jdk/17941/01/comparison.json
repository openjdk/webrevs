{"files":[{"patch":"@@ -2,2 +2,2 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2023, Red Hat, Inc. and\/or its affiliates.\n+ * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2024, Red Hat, Inc. and\/or its affiliates.\n@@ -45,0 +45,5 @@\n+int CompilationFailureInfo::current_compile_id_or_0() {\n+  ciEnv* env = ciEnv::current();\n+  return (env != nullptr) ? env->compile_id() : 0;\n+}\n+\n@@ -49,1 +54,1 @@\n-  _compile_id(ciEnv::current()->task()->compile_id())\n+  _compile_id(current_compile_id_or_0())\n","filename":"src\/hotspot\/share\/compiler\/compilationFailureInfo.cpp","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2023, Red Hat, Inc. and\/or its affiliates.\n+ * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2024, Red Hat, Inc. and\/or its affiliates.\n@@ -43,0 +43,1 @@\n+  static int current_compile_id_or_0();\n","filename":"src\/hotspot\/share\/compiler\/compilationFailureInfo.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -58,0 +58,9 @@\n+\n+        pb = ProcessTools.createLimitedTestJavaProcessBuilder(\"-XX:InitialCodeCacheSize=1024K\", \"-XX:ReservedCodeCacheSize=1200k\", \"-version\");\n+        out = new OutputAnalyzer(pb.start());\n+        \/\/ The VM should not crash but will probably fail with a \"CodeCache is full. Compiler has been disabled.\" message\n+        out.stdoutShouldNotContain(\"# A fatal error\");\n+        exitCode = out.getExitValue();\n+        if (exitCode != 1 && exitCode != 0) {\n+            throw new Exception(\"VM crashed with exit code \" + exitCode);\n+        }\n","filename":"test\/hotspot\/jtreg\/compiler\/startup\/StartupOutput.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"}]}