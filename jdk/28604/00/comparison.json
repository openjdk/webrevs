{"files":[{"patch":"@@ -36,0 +36,2 @@\n+import java.util.Collection;\n+import java.util.ArrayList;\n@@ -48,1 +50,0 @@\n-import java.util.TreeSet;\n@@ -326,1 +327,1 @@\n-            StringJoiner sj = new StringJoiner(\", \");\n+            List<String> releases = new ArrayList<>();\n@@ -329,1 +330,1 @@\n-                    sj.add(source.name);\n+                    releases.add(source.name);\n@@ -331,1 +332,2 @@\n-            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, sj.toString()));\n+            String formatted = formatAbbreviatedList(releases);\n+            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, formatted));\n@@ -347,1 +349,1 @@\n-            StringJoiner sj = new StringJoiner(\", \");\n+            List<String> releases = new ArrayList<>();\n@@ -350,1 +352,1 @@\n-                    sj.add(target.name);\n+                    releases.add(target.name);\n@@ -352,1 +354,2 @@\n-            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, sj.toString()));\n+            String formatted = formatAbbreviatedList(releases);\n+            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, formatted));\n@@ -367,9 +370,2 @@\n-            StringBuilder targets = new StringBuilder();\n-            String delim = \"\";\n-            for (String platform : platforms) {\n-                targets.append(delim);\n-                targets.append(platform);\n-                delim = \", \";\n-            }\n-\n-            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, targets.toString()));\n+            String formatted = formatAbbreviatedList(platforms);\n+            super.help(log, log.localize(PrefixKind.JAVAC, descrKey, formatted));\n@@ -1372,0 +1368,35 @@\n+    \/**\n+     * Formats a collection of values as an abbreviated, comma separated list\n+     * for use in javac help output.\n+     *\n+     * This helper assumes that the supported values form a dense sequence\n+     * between the fourth and the (n - 3)rd entries.\n+     * That matches the current policy for these values but is not\n+     * guaranteed, and should be reconsidered if the structure of the values changes.\n+     *\n+     * @param values the values to format\n+     * @return a comma separated representation of the values\n+     *\/\n+    private static String formatAbbreviatedList(Collection<String> values) {\n+        List<String> list = (values instanceof List)\n+                ? (List<String>) values\n+                : new ArrayList<>(values);\n+\n+        int size = list.size();\n+        if (size == 0) {\n+            return \"\";\n+        }\n+        if (size <= 6) {\n+            return String.join(\", \", list);\n+        }\n+        StringJoiner sj = new StringJoiner(\", \");\n+        for (int i = 0; i < 3; i++) {\n+            sj.add(list.get(i));\n+        }\n+        sj.add(\"...\");\n+        for (int i = size - 3; i < size; i++) {\n+            sj.add(list.get(i));\n+        }\n+        return sj.toString();\n+    }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/main\/Option.java","additions":47,"deletions":16,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -103,1 +103,2 @@\n-    separated by comma. Precede a key by ''-'' to exclude the specified category.\\n\\\n+    separated by comma.\\n\\\n+    Precede a key by ''-'' to exclude the specified category.\\n\\\n@@ -361,1 +362,2 @@\n-    Enable preview language features. Also disables the ''preview'' lint category.\\n\\\n+    Enable preview language features.\\n\\\n+    Also disables the ''preview'' lint category.\\n\\\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/javac.properties","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-    public static final int MAX_COLUMNS = 84;\n+    public static final int MAX_COLUMNS = 80;\n","filename":"test\/langtools\/tools\/javac\/options\/HelpOutputColumnWidthTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}