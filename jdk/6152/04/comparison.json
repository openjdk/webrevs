{"files":[{"patch":"@@ -253,1 +253,2 @@\n-      # Default is to calculate a string like this 'adhoc.<username>.<base dir name>'\n+      # Default is to calculate a string like this:\n+      # 'adhoc.<username>.<base dir name>'\n@@ -279,2 +280,0 @@\n-      # FIXME: Until all code can cope with an empty VERSION_BUILD, set it to 0.\n-      VERSION_BUILD=0\n@@ -453,3 +452,12 @@\n-  # The complete version string, with additional build information\n-  if test \"x$VERSION_BUILD$VERSION_OPT\" = x; then\n-    VERSION_STRING=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}\n+  # A build number of \"0\" is interpreted as \"no build number\".\n+  if test \"x$VERSION_BUILD\" = x0; then\n+    VERSION_BUILD=\n+  fi\n+\n+  # Compute the complete version string, with additional build information\n+  version_with_pre=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}\n+  if test \"x$VERSION_BUILD\" != x || \\\n+      ( test \"x$VERSION_OPT\" != x && test \"x$VERSION_PRE\" = x ); then\n+    # As per JEP 223, if build is set, or if opt is set but not pre,\n+    # we need a + separator\n+    version_with_build=$version_with_pre+$VERSION_BUILD\n@@ -457,2 +465,1 @@\n-    # If either build or opt is set, we need a + separator\n-    VERSION_STRING=$VERSION_NUMBER${VERSION_PRE:+-$VERSION_PRE}+$VERSION_BUILD${VERSION_OPT:+-$VERSION_OPT}\n+    version_with_build=$version_with_pre\n@@ -460,0 +467,1 @@\n+  VERSION_STRING=$version_with_build${VERSION_OPT:+-$VERSION_OPT}\n","filename":"make\/autoconf\/jdk-version.m4","additions":16,"deletions":8,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -242,1 +242,1 @@\n-VERSION_CFLAGS := \\\n+VERSION_CFLAGS = \\\n","filename":"make\/autoconf\/spec.gmk.in","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2013, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -64,0 +64,5 @@\n+ifeq ($(VERSION_BUILD), )\n+  # Hotspot cannot handle an empty build number\n+  VERSION_BUILD := 0\n+endif\n+\n","filename":"make\/hotspot\/lib\/CompileJvm.gmk","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -52,1 +52,1 @@\n-        testInfoOpt(\"-fullversion\", \"javac\", specVersion, \"+\");\n+        testInfoOpt(\"-fullversion\", \"javac\", specVersion);\n","filename":"test\/langtools\/tools\/javac\/options\/modes\/InfoOptsTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}