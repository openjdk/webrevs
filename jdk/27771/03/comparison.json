{"files":[{"patch":"@@ -106,11 +106,0 @@\n-  \/\/ Enable vendor specific features\n-\n-  if (mvendorid.enabled()) {\n-    \/\/ Rivos\n-    if (mvendorid.value() == RIVOS) {\n-      if (FLAG_IS_DEFAULT(UseConservativeFence)) {\n-        FLAG_SET_DEFAULT(UseConservativeFence, false);\n-      }\n-    }\n-  }\n-\n@@ -202,1 +191,1 @@\n-  if (UseZicboz && zicboz_block_size.enabled() && zicboz_block_size.value() > 0) {\n+  if (UseZicboz && zicboz_block_size.value() > 0) {\n","filename":"src\/hotspot\/cpu\/riscv\/vm_version_riscv.cpp","additions":1,"deletions":12,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -55,1 +55,4 @@\n-    int64_t           _value;\n+\n+   protected:\n+    static const int64_t DEFAULT_VALUE = -1;\n+\n@@ -58,5 +61,1 @@\n-      _pretty(pretty), _feature_string(fstring), _linux_feature_bit(nth_bit(linux_bit_num)),\n-      _value(-1) {\n-    }\n-    virtual void enable_feature(int64_t value = 0) {\n-      _value = value;\n+      _pretty(pretty), _feature_string(fstring), _linux_feature_bit(nth_bit(linux_bit_num)) {\n@@ -64,7 +63,5 @@\n-    virtual void disable_feature() {\n-      _value = -1;\n-    }\n-    const char* pretty()          { return _pretty; }\n-    uint64_t feature_bit()        { return _linux_feature_bit; }\n-    bool feature_string()         { return _feature_string; }\n-    int64_t value()               { return _value; }\n+    virtual void enable_feature(int64_t value = 0) = 0;\n+    virtual void disable_feature() = 0;\n+    const char* pretty()         { return _pretty; }\n+    uint64_t feature_bit()       { return _linux_feature_bit; }\n+    bool feature_string()        { return _feature_string; }\n@@ -73,0 +70,2 @@\n+    \/\/ Use DEFAULT_VALUE if unset.\n+    virtual int64_t value() = 0;\n@@ -138,1 +137,0 @@\n-      RVFeatureValue::enable_feature(value);\n@@ -142,1 +140,0 @@\n-      RVFeatureValue::disable_feature();\n@@ -145,0 +142,1 @@\n+    int64_t value() { return enabled() ? 1 : DEFAULT_VALUE; }\n@@ -199,1 +197,1 @@\n-    bool _enabled;\n+    int64_t _value;\n@@ -203,6 +201,1 @@\n-      _enabled(false) {\n-    }\n-    bool enabled()               { return _enabled; }\n-    void enable_feature(int64_t value = 0) {\n-      RVFeatureValue::enable_feature(value);\n-      _enabled = true;\n+      _value(DEFAULT_VALUE) {\n@@ -210,3 +203,4 @@\n-    void disable_feature() {\n-      RVFeatureValue::disable_feature();\n-      _enabled = false;\n+    bool enabled() { return _value != DEFAULT_VALUE; }\n+    void enable_feature(int64_t value) {\n+      assert(value != DEFAULT_VALUE, \"Sanity\");\n+      _value = value;\n@@ -214,0 +208,2 @@\n+    void disable_feature() { _value = DEFAULT_VALUE; }\n+    int64_t value() { return _value; }\n","filename":"src\/hotspot\/cpu\/riscv\/vm_version_riscv.hpp","additions":21,"deletions":25,"binary":false,"changes":46,"status":"modified"}]}