{"files":[{"patch":"@@ -544,0 +544,3 @@\n+                        \/\/ escape reserved chars, excluding date\/time patterns, eg, \"{1} {0}\"\n+                        String transPattern = key.endsWith(\"-dateTime\") ? pattern : escapeReservedChars(pattern);\n+\n@@ -546,1 +549,1 @@\n-                        String transPattern = translateDateFormatLetters(calendarType, key, pattern, this::convertDateTimePatternLetter);\n+                        transPattern = translateDateFormatLetters(calendarType, key, transPattern, this::convertDateTimePatternLetter);\n@@ -783,1 +786,1 @@\n-                        (String)e.getValue(),\n+                        escapeReservedChars((String)e.getValue()),\n@@ -847,0 +850,34 @@\n+\n+    \/**\n+     * Escape reserved pattern characters, '#', '{', and '}' in the pattern\n+     * string.\n+     *\n+     * @param pattern original pattern string\n+     * @return escaped pattern string\n+     * @see DateTimeFormatterBuilder#appendPattern\n+     *\/\n+    private static String escapeReservedChars(String pattern) {\n+        StringBuilder out = new StringBuilder();\n+        boolean inQuote = false;\n+\n+        for (int i = 0; i < pattern.length(); i++) {\n+            char c = pattern.charAt(i);\n+            if (c == '\\'') {\n+                if (i + 1 < pattern.length() && pattern.charAt(i + 1) == '\\'') {\n+                    \/\/ single quote literal\n+                    out.append(\"''\");\n+                    i++;\n+                } else {\n+                    inQuote = !inQuote;\n+                    out.append(c);\n+                }\n+            } else if (!inQuote && (c == '#' || c == '{' || c == '}')) {\n+                \/\/ escape the reserved char\n+                out.append('\\'').append(c).append('\\'');\n+            } else {\n+                out.append(c);\n+            }\n+        }\n+\n+        return out.toString();\n+    }\n","filename":"make\/jdk\/src\/classes\/build\/tools\/cldrconverter\/Bundle.java","additions":39,"deletions":2,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -0,0 +1,62 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8354548\n+ * @modules jdk.localedata\n+ * @summary Tests DateTimeFormatter format\/parse round trips; some locale\n+ *      may contain reserved characters, eg '#', which should correctly\n+ *      be escaped\n+ * @run junit DateTimeRoundTripTest\n+ *\/\n+\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.MethodSource;\n+\n+import java.time.Instant;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import java.time.format.FormatStyle;\n+import java.util.Arrays;\n+import java.util.Locale;\n+import java.util.stream.Stream;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n+public class DateTimeRoundTripTest {\n+    private static Stream<Locale> availableLocales() {\n+        return Locale.availableLocales();\n+    }\n+\n+    @ParameterizedTest\n+    @MethodSource(\"availableLocales\")\n+    public void testDateTimeRoundTripTest(Locale locale) {\n+        Arrays.stream(FormatStyle.values()).forEach(style -> {\n+            assertDoesNotThrow(() ->\n+                Instant.parse(\"2018-07-16T23:58:59.000000200Z\")\n+                    .atZone(ZoneId.of(\"UTC\"))\n+                    .format(DateTimeFormatter.ofLocalizedDate(style).withLocale(locale)));\n+        });\n+    }\n+}\n","filename":"test\/jdk\/sun\/util\/resources\/cldr\/DateTimeRoundTripTest.java","additions":62,"deletions":0,"binary":false,"changes":62,"status":"added"}]}