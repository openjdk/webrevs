{"files":[{"patch":"@@ -149,1 +149,1 @@\n-  if (log_is_enabled(Info, cds, aot, load)) {\n+  if (log_is_enabled(Info, cds, aot, link)) {\n@@ -151,1 +151,1 @@\n-    log_info(cds, aot, load)(\"%s %s\", ArchiveUtils::class_category(ik), ik->external_name());\n+    log_info(cds, aot, link)(\"%s %s\", ArchiveUtils::class_category(ik), ik->external_name());\n@@ -212,1 +212,1 @@\n-    log_info(cds, aot, load)(\"written %d class(es) for category %s\", list.length(), category);\n+    log_info(cds, aot, link)(\"written %d class(es) for category %s\", list.length(), category);\n","filename":"src\/hotspot\/share\/cds\/aotClassLinker.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -111,1 +111,1 @@\n-      if (AOTClassLinker::try_add_candidate(ik)) {\n+      if (AOTClassLinker::is_candidate(ik)) {\n","filename":"src\/hotspot\/share\/cds\/aotConstantPoolResolver.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -766,1 +766,1 @@\n-  x ## _a += aotlinked;\n+  x ## _a += aotlinked ? 1 : 0;\n@@ -779,1 +779,1 @@\n-  DECLARE_INSTANCE_KLASS_COUNTER(num_unlinked_klasses);\n+\n@@ -781,0 +781,1 @@\n+  int num_unlinked_klasses = 0;\n@@ -820,1 +821,1 @@\n-      int aotlinked = AOTClassLinker::is_candidate(src_ik);\n+      bool aotlinked = AOTClassLinker::is_candidate(src_ik);\n@@ -861,1 +862,1 @@\n-        ADD_COUNT(num_unlinked_klasses);\n+        num_unlinked_klasses ++;\n@@ -909,2 +910,2 @@\n-  log_info(cds)(\"      (unlinked)       \" STATS_FORMAT \", boot = %d, plat = %d, app = %d, unreg = %d\",\n-                STATS_PARAMS(unlinked_klasses), boot_unlinked, platform_unlinked, app_unlinked, unreg_unlinked);\n+  log_info(cds)(\"      (unlinked)       = %5d, boot = %d, plat = %d, app = %d, unreg = %d\",\n+                num_unlinked_klasses, boot_unlinked, platform_unlinked, app_unlinked, unreg_unlinked);\n","filename":"src\/hotspot\/share\/cds\/archiveBuilder.cpp","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/aotClassLinker.hpp\"\n@@ -117,0 +118,2 @@\n+  msg.info(\"Platform loader initiated classes = %5d\", AOTClassLinker::num_platform_initiated_classes());\n+  msg.info(\"App      loader initiated classes = %5d\", AOTClassLinker::num_app_initiated_classes());\n","filename":"src\/hotspot\/share\/cds\/dumpAllocStats.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1533,5 +1533,11 @@\n-  log_info(cds)(\"Using AOT-linked classes: %s (%s%s)\",\n-                CDSConfig::is_using_aot_linked_classes() ? \"true\" : \"false\",\n-                static_mapinfo->header()->has_aot_linked_classes() ? \"static archive: true\" : \"static archive: false\",\n-                (dynamic_mapinfo == nullptr) ? \"\" :\n-                   (dynamic_mapinfo->header()->has_aot_linked_classes() ? \", dynamic archive: true\" : \", dynamic archive: false\"));\n+  LogStreamHandle(Info, cds) lsh;\n+  if (lsh.is_enabled()) {\n+    lsh.print(\"Using AOT-linked classes: %s (static archive: %s aot-linked classes\",\n+              CDSConfig::is_using_aot_linked_classes() ? \"true\" : \"false\",\n+              static_mapinfo->header()->has_aot_linked_classes() ? \"has\" : \"no\");\n+    if (dynamic_mapinfo != nullptr) {\n+      lsh.print(\", dynamic archive: %s aot-linked classes\",\n+                dynamic_mapinfo->header()->has_aot_linked_classes() ? \"has\" : \"no\");\n+    }\n+    lsh.print_cr(\")\");\n+  }\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -109,2 +109,3 @@\n-        if (out.contains(\"Using AOT-linked classes: false\")) {\n-            \/\/ We are running with VM options that do not support -XX:+AOTClassLinking\n+        if (out.contains(\"Using AOT-linked classes: false (static archive: no aot-linked classes\")) {\n+            \/\/ JTREG is executed with VM options that do not support -XX:+AOTClassLinking, so\n+            \/\/ the static archive was not created with aot-linked classes.\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/jvmti\/ClassFileLoadHookTest.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}