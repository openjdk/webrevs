{"files":[{"patch":"@@ -218,2 +218,6 @@\n-  \/\/ AOTLinkedClassBulkLoader will initiate loading of all public boot classes in the platform loader.\n-  return num_initiated_classes(nullptr, nullptr);\n+  if (CDSConfig::is_dumping_aot_linked_classes()) {\n+    \/\/ AOTLinkedClassBulkLoader will initiate loading of all public boot classes in the platform loader.\n+    return count_public_classes(nullptr);\n+  } else {\n+    return 0;\n+  }\n@@ -223,2 +227,6 @@\n-  \/\/ AOTLinkedClassBulkLoader will initiate loading of all public boot\/platform classes in the app loader.\n-  return num_initiated_classes(nullptr, SystemDictionary::java_platform_loader());\n+  if (CDSConfig::is_dumping_aot_linked_classes()) {\n+    \/\/ AOTLinkedClassBulkLoader will initiate loading of all public boot\/platform classes in the app loader.\n+    return count_public_classes(nullptr) + count_public_classes(SystemDictionary::java_platform_loader());\n+  } else {\n+    return 0;\n+  }\n@@ -227,1 +235,1 @@\n-int AOTClassLinker::num_initiated_classes(oop loader1, oop loader2) {\n+int AOTClassLinker::count_public_classes(oop loader) {\n@@ -231,2 +239,1 @@\n-    if (ik->is_public() && !ik->is_hidden() &&\n-        (ik->class_loader() == loader1 || ik->class_loader() == loader2)) {\n+    if (ik->is_public() && !ik->is_hidden() && ik->class_loader() == loader) {\n","filename":"src\/hotspot\/share\/cds\/aotClassLinker.cpp","additions":14,"deletions":7,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -89,1 +89,1 @@\n-  static int num_initiated_classes(oop loader1, oop loader2);\n+  static int count_public_classes(oop loader);\n","filename":"src\/hotspot\/share\/cds\/aotClassLinker.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -200,0 +200,2 @@\n+    assert(ik->class_loader() == nullptr ||\n+           ik->class_loader() == SystemDictionary::java_platform_loader(), \"must be\");\n","filename":"src\/hotspot\/share\/cds\/aotLinkedClassBulkLoader.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}