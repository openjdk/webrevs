{"files":[{"patch":"@@ -69,3 +69,2 @@\n-        \/\/ Create an ObjectMonitor with a dead object from an\n-        \/\/ attached thread. This used to provoke an assert\n-        \/\/ in DetachCurrentThread.\n+        \/\/ Create an ObjectMonitor with a dead object from an attached thread.\n+        \/\/ This used to provoke an assert in DetachCurrentThread.\n@@ -76,3 +75,2 @@\n-        \/\/ Create an ObjectMonitor with a dead object from an\n-        \/\/ attached thread and perform a thread dump before\n-        \/\/ detaching the thread.\n+        \/\/ Create an ObjectMonitor with a dead object from an attached thread\n+        \/\/ and perform a thread dump before detaching the thread.\n@@ -85,4 +83,4 @@\n-        \/\/ After createMonitorWithDeadObject has been called, there's an \"owned\"\n-        \/\/ monitor with a dead object. The thread dumping code used to not\n-        \/\/ tolerate such a monitor and would assert. Run a thread dump and make\n-        \/\/ sure that it doesn't crash\/assert.\n+        \/\/ The thread dumping code used to not tolerate monitors with dead\n+        \/\/ objects and the detach code used to not unlock these monitors, so\n+        \/\/ test that we don't end up with a bug where these monitors are not\n+        \/\/ unlocked and then passed to the thread dumping code.\n","filename":"test\/hotspot\/jtreg\/runtime\/Monitor\/MonitorWithDeadObjectTest.java","additions":8,"deletions":10,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include <stdlib.h>\n@@ -28,0 +27,1 @@\n+#include <stdlib.h>\n@@ -113,1 +113,1 @@\n-static void* create_monitor_with_dead_object_in_thread() {\n+static void* create_monitor_with_dead_object_in_thread(void* arg) {\n@@ -121,1 +121,1 @@\n-  \/\/ DetachCurrenThread will try to unlock held monitors. This has been a\n+  \/\/ DetachCurrentThread will try to unlock held monitors. This has been a\n@@ -134,1 +134,1 @@\n-static void* create_monitor_with_dead_object_and_dump_threads_in_thread() {\n+static void* create_monitor_with_dead_object_and_dump_threads_in_thread(void* arg) {\n","filename":"test\/hotspot\/jtreg\/runtime\/Monitor\/libMonitorWithDeadObjectTest.c","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -27,2 +27,4 @@\n- * @bug 8185164\n- * @summary Checks that a contended monitor does not show up in the list of owned monitors\n+ * @bug 8185164 8320515\n+ * @summary Checks that a contended monitor does not show up in the list of owned monitors.\n+ *          8320515 piggy-backs on this test and injects an owned monitor with a dead object,\n+            and checks that that monitor isn't exposed to GetOwnedMonitorInfo.\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/GetOwnedMonitorInfo\/GetOwnedMonitorInfoTest.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}