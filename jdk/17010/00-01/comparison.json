{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,0 +43,2 @@\n+import sun.awt.shell.ShellFolder;\n+\n@@ -105,1 +107,2 @@\n-        String errMsg = ShellExecute(file.getAbsolutePath(), verb);\n+        String errMsg = ShellFolder.invoke(\n+                () -> ShellExecute(file.getAbsolutePath(), verb));\n@@ -107,1 +110,2 @@\n-            throw new IOException(\"Failed to \" + verb + \" \" + file + \". Error message: \" + errMsg);\n+            throw new IOException(\"Failed to \" + verb + \" \" + file +\n+                                  \". Error message: \" + errMsg);\n@@ -112,2 +116,2 @@\n-        String errmsg = ShellExecute(uri.toString(), verb);\n-\n+        String errmsg = ShellFolder.invoke(\n+                () -> ShellExecute(uri.toString(), verb));\n@@ -115,2 +119,2 @@\n-            throw new IOException(\"Failed to \" + verb + \" \" + uri\n-                    + \". Error message: \" + errmsg);\n+            throw new IOException(\"Failed to \" + verb + \" \" + uri +\n+                                  \". Error message: \" + errmsg);\n","filename":"src\/java.desktop\/windows\/classes\/sun\/awt\/windows\/WDesktopPeer.java","additions":11,"deletions":7,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -88,12 +88,3 @@\n-    HRESULT hr = ::CoInitializeEx(NULL, COINIT_APARTMENTTHREADED |\n-                                        COINIT_DISABLE_OLE1DDE);\n-    HINSTANCE retval;\n-    DWORD error;\n-    if (SUCCEEDED(hr) || hr == RPC_E_CHANGED_MODE) {\n-        retval = ::ShellExecute(NULL, verb_c, fileOrUri_c, NULL, NULL,\n-                                SW_SHOWNORMAL);\n-        error = ::GetLastError();\n-        if (SUCCEEDED(hr)) {\n-            ::CoUninitialize();\n-        }\n-    }\n+    HINSTANCE retval = ::ShellExecute(NULL, verb_c, fileOrUri_c, NULL, NULL,\n+                                      SW_SHOWNORMAL);\n+    DWORD error = ::GetLastError();\n@@ -105,3 +96,0 @@\n-    if (FAILED(hr) && hr != RPC_E_CHANGED_MODE) {\n-        return JNU_NewStringPlatform(env, L\"CoInitializeEx() failed.\");\n-    }\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Desktop.cpp","additions":4,"deletions":16,"binary":false,"changes":20,"status":"modified"}]}