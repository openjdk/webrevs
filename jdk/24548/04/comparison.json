{"files":[{"patch":"@@ -3346,0 +3346,4 @@\n+                        if (bound.tsym != syms.objectType.tsym || !bound.isInterface() || (bound.tsym.flags() & ANNOTATION) != 0) {\n+                            \/\/ bound must be j.l.Object or an interface, but not an annotation\n+                            reportIntersectionError(that, \"not.an.intf.component\", bound);\n+                        }\n@@ -3369,0 +3373,5 @@\n+        private void reportIntersectionError(DiagnosticPosition pos, String key, Object... args) {\n+             resultInfo.checkContext.report(pos,\n+                 diags.fragment(Fragments.BadIntersectionTargetForFunctionalExpr(diags.fragment(key, args))));\n+        }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -340,1 +340,1 @@\n-    component type {0} is not an interface\n+    component type {0} is not an interface or java.lang.Object\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/compiler.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -147,2 +147,0 @@\n-compiler.misc.bad.intersection.target.for.functional.expr  # currently not generated, should be removed?\n-compiler.misc.not.an.intf.component\n","filename":"test\/langtools\/tools\/javac\/diags\/examples.not-yet.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,2 @@\n-\/\/ key: compiler.misc.not.a.functional.intf.1\n+\/\/ key: compiler.misc.bad.intersection.target.for.functional.expr\n+\/\/ key: compiler.misc.not.an.intf.component\n@@ -26,1 +27,0 @@\n-\/\/ key: compiler.misc.incompatible.abstracts\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/NotAnInterfaceComponent.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -0,0 +1,45 @@\n+\/*\n+ * @test \/nodynamiccopyright\/\n+ * @bug 8322810\n+ * @summary Lambda expressions can implement classes\n+ * @compile\/fail\/ref=ClassInIntersectionTypeTest.out -XDrawDiagnostics ClassInIntersectionTypeTest.java\n+ *\/\n+\n+import java.io.Serializable;\n+import java.lang.annotation.Annotation;\n+\n+public class ClassInIntersectionTypeTest {\n+    \/\/ test 1\n+    void m1() {\n+        ClassInIntersectionTypeTest r1 = (ClassInIntersectionTypeTest & Runnable) () -> System.out.println(\"Hello, World!\");\n+        ClassInIntersectionTypeTest r2 = (ClassInIntersectionTypeTest & Runnable) ClassInIntersectionTypeTest::run1;\n+    }\n+\n+    static void run1() {}\n+\n+    \/\/ test 2\n+    static void foo() {\n+        run2(() -> System.out.println(\"Hello, World!\"));\n+        run2(ClassInIntersectionTypeTest::run1);\n+    }\n+\n+    static <T extends ClassInIntersectionTypeTest & Runnable> void run2(T t) {\n+        t.run();\n+    }\n+\n+    static Class<? extends Annotation> myAnnoType() { return null; }\n+    @interface Anno {}\n+    Anno a = (Anno & Serializable) ()-> null; \/\/ annotations not allowed\n+    Anno b = (Anno & Serializable) ClassInIntersectionTypeTest::myAnnoType; \/\/ annotations not allowed\n+\n+    static void bar() {\n+        annotationType(() -> null);\n+        annotationType(ClassInIntersectionTypeTest::myAnnoType);\n+    }\n+\n+    static <T extends Anno & Serializable> void annotationType(T t) {\n+        t.annotationType();  \/\/ annotations not allowed\n+    }\n+\n+    Anno c = ()-> null; \/\/ annotations are not functional interfaces\n+}\n","filename":"test\/langtools\/tools\/javac\/lambda\/ClassInIntersectionTypeTest.java","additions":45,"deletions":0,"binary":false,"changes":45,"status":"added"},{"patch":"@@ -0,0 +1,10 @@\n+ClassInIntersectionTypeTest.java:14:83: compiler.err.prob.found.req: (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest))\n+ClassInIntersectionTypeTest.java:15:83: compiler.err.prob.found.req: (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest))\n+ClassInIntersectionTypeTest.java:22:13: compiler.err.prob.found.req: (compiler.misc.infer.no.conforming.assignment.exists: T, (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest)))\n+ClassInIntersectionTypeTest.java:23:13: compiler.err.prob.found.req: (compiler.misc.infer.no.conforming.assignment.exists: T, (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest)))\n+ClassInIntersectionTypeTest.java:32:36: compiler.err.prob.found.req: (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest.Anno))\n+ClassInIntersectionTypeTest.java:33:36: compiler.err.prob.found.req: (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest.Anno))\n+ClassInIntersectionTypeTest.java:36:23: compiler.err.prob.found.req: (compiler.misc.infer.no.conforming.assignment.exists: T, (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest.Anno)))\n+ClassInIntersectionTypeTest.java:37:23: compiler.err.prob.found.req: (compiler.misc.infer.no.conforming.assignment.exists: T, (compiler.misc.bad.intersection.target.for.functional.expr: (compiler.misc.not.an.intf.component: ClassInIntersectionTypeTest.Anno)))\n+ClassInIntersectionTypeTest.java:44:14: compiler.err.prob.found.req: (compiler.misc.not.a.functional.intf: ClassInIntersectionTypeTest.Anno)\n+9 errors\n","filename":"test\/langtools\/tools\/javac\/lambda\/ClassInIntersectionTypeTest.out","additions":10,"deletions":0,"binary":false,"changes":10,"status":"added"}]}