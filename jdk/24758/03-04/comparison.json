{"files":[{"patch":"@@ -44,0 +44,1 @@\n+import java.lang.reflect.InvocationTargetException;\n@@ -61,0 +62,1 @@\n+import javax.swing.SwingUtilities;\n@@ -71,0 +73,7 @@\n+    static RTLScrollers rtl;\n+    static volatile boolean retVal;\n+    static volatile JScrollPane jsp;\n+    static volatile JScrollBar hsb;\n+    static volatile JScrollBar sb;\n+    static volatile Point loc;\n+    static volatile Dimension size;\n@@ -243,1 +252,2 @@\n-    public static boolean runTest(int scrollAmount) {\n+    public static boolean runTest(int scrollAmount)\n+            throws InterruptedException, InvocationTargetException {\n@@ -257,2 +267,4 @@\n-        RTLScrollers rtl = new RTLScrollers(scrollAmount);\n-        rtl.setVisible(true);\n+        SwingUtilities.invokeAndWait(() -> {\n+            rtl = new RTLScrollers(scrollAmount);\n+            rtl.setVisible(true);\n+        });\n@@ -261,3 +273,8 @@\n-        boolean retVal = rtl.runTests(scrollAmount);\n-        rtl.setVisible(false);\n-        robot.delay(100);\n+        SwingUtilities.invokeAndWait(() -> {\n+            try {\n+                retVal = rtl.runTests(scrollAmount);\n+                rtl.setVisible(false);\n+            } catch (Exception e) {\n+                e.printStackTrace();\n+            }\n+        });\n@@ -265,0 +282,1 @@\n+        robot.delay(100);\n@@ -269,1 +287,2 @@\n-    private boolean runTests(int scrollAmount) {\n+    private boolean runTests(int scrollAmount)\n+            throws InterruptedException, InvocationTargetException {\n@@ -293,1 +312,3 @@\n-        applyComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);\n+        SwingUtilities.invokeAndWait(() -> {\n+            applyComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);\n+        });\n@@ -305,1 +326,2 @@\n-    public boolean testComp(TestTools comp, int scrollAmount) {\n+    public boolean testComp(TestTools comp, int scrollAmount)\n+            throws InterruptedException, InvocationTargetException {\n@@ -307,3 +329,4 @@\n-        JScrollPane jsp = (JScrollPane)((JComponent)comp).getParent().getParent();\n-        JScrollBar hsb = jsp.getHorizontalScrollBar();\n-        hsb.setValue(hsb.getMinimum());\n+        SwingUtilities.invokeAndWait(() -> {\n+            jsp = (JScrollPane)((JComponent)comp).getParent().getParent();\n+            hsb = jsp.getHorizontalScrollBar();\n+            hsb.setValue(hsb.getMinimum());\n@@ -311,2 +334,3 @@\n-        Point loc = jsp.getLocationOnScreen();\n-        Dimension size = jsp.getSize();\n+            loc = jsp.getLocationOnScreen();\n+            size = jsp.getSize();\n+        });\n@@ -321,1 +345,0 @@\n-\n@@ -336,1 +359,1 @@\n-            hsb.setValue(midVal);\n+            SwingUtilities.invokeAndWait(() -> hsb.setValue(midVal));\n@@ -354,1 +377,1 @@\n-            hsb.setValue(midVal);\n+            SwingUtilities.invokeAndWait(() -> hsb.setValue(midVal));\n@@ -369,1 +392,1 @@\n-            hsb.setValue(startVal);\n+            SwingUtilities.invokeAndWait(() -> hsb.setValue(startVal));\n@@ -388,1 +411,1 @@\n-                comp.checkTopCellIs(leadingCell, (2*scrollAmount));\n+                comp.checkTopCellIs(leadingCell, (2 * scrollAmount));\n@@ -399,1 +422,1 @@\n-                comp.checkTopCellIs(leadingCell, (3*scrollAmount));\n+                comp.checkTopCellIs(leadingCell, (3 * scrollAmount));\n@@ -425,1 +448,1 @@\n-                comp.checkTopCellIs(leadingCell, -(2*scrollAmount));\n+                comp.checkTopCellIs(leadingCell, -(2 * scrollAmount));\n@@ -435,1 +458,1 @@\n-                comp.checkTopCellIs(leadingCell, -(3*scrollAmount));\n+                comp.checkTopCellIs(leadingCell, -(3 * scrollAmount));\n@@ -444,1 +467,3 @@\n-            hsb.setValue(hsb.getMinimum());\n+            SwingUtilities.invokeAndWait(() -> {\n+                hsb.setValue(hsb.getMinimum());\n+            });\n@@ -622,6 +647,7 @@\n-    public void scrollToMiddle(JScrollPane jsp, Robot robot) {\n-        JScrollBar sb = jsp.getHorizontalScrollBar();\n-        Point loc = sb.getLocationOnScreen();\n-        Dimension size = sb.getSize();\n-        int autoDelay = robot.getAutoDelay();\n-\n+    public void scrollToMiddle(JScrollPane jsp, Robot robot)\n+            throws InterruptedException, InvocationTargetException {\n+        SwingUtilities.invokeAndWait(() -> {\n+            sb = jsp.getHorizontalScrollBar();\n+            loc = sb.getLocationOnScreen();\n+            size = sb.getSize();\n+        });\n@@ -637,7 +663,6 @@\n-        \/\/ Work-around bug in JList RTL block increment\n-        if (jsp == listScroller) {\n-            int idx = list.getFirstVisibleIndex();\n-            list.ensureIndexIsVisible(idx);\n-        }\n-\n-        robot.setAutoDelay(autoDelay);\n+        SwingUtilities.invokeAndWait(() -> {\n+            if (jsp == listScroller) {\n+                int idx = list.getFirstVisibleIndex();\n+                list.ensureIndexIsVisible(idx);\n+            }\n+        });\n@@ -646,3 +671,5 @@\n-    public static void main(String[] args) {\n-        RTLScrollers f = new RTLScrollers();\n-        f.setVisible(true);\n+    public static void main(String[] args) throws Exception {\n+        SwingUtilities.invokeAndWait(() -> {\n+            RTLScrollers f = new RTLScrollers();\n+            f.setVisible(true);\n+        });\n","filename":"test\/jdk\/javax\/swing\/JScrollPane\/AcceleratedWheelScrolling\/RTLScrollers.java","additions":66,"deletions":39,"binary":false,"changes":105,"status":"modified"}]}