{"files":[{"patch":"@@ -189,1 +189,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -191,1 +191,1 @@\n-    JvmtiThreadState* state = current_thread->jvmti_thread_state();\n+    JvmtiThreadState* state = current->jvmti_thread_state();\n@@ -201,2 +201,2 @@\n-    ThreadInVMfromNative __tiv(current_thread);\n-    VM_ENTRY_BASE(jvmtiError, JvmtiEnv::GetThreadLocalStorage , current_thread)\n+    ThreadInVMfromNative __tiv(current);\n+    VM_ENTRY_BASE(jvmtiError, JvmtiEnv::GetThreadLocalStorage , current)\n@@ -206,1 +206,1 @@\n-    ThreadsListHandle tlh(current_thread);\n+    ThreadsListHandle tlh(current);\n@@ -210,1 +210,1 @@\n-    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -215,2 +215,2 @@\n-    HandleMark hm(current_thread);\n-    Handle thread_handle(current_thread, thread_obj);\n+    HandleMark hm(current);\n+    Handle thread_handle(current, thread_obj);\n@@ -589,2 +589,2 @@\n-    JavaThread* current_thread = JavaThread::current();\n-    ThreadsListHandle tlh(current_thread);\n+    JavaThread* current = JavaThread::current();\n+    ThreadsListHandle tlh(current);\n@@ -594,1 +594,1 @@\n-    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), event_thread, current_thread, &java_thread, &thread_obj);\n+    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), event_thread, current, &java_thread, &thread_obj);\n@@ -859,1 +859,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -861,1 +861,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -865,1 +865,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n@@ -1079,2 +1079,2 @@\n-  JavaThread* current_thread = JavaThread::current();\n-  ThreadsListHandle tlh(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  ThreadsListHandle tlh(current);\n@@ -1084,1 +1084,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n@@ -1179,1 +1179,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -1182,1 +1182,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -1188,1 +1188,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n@@ -1216,2 +1216,2 @@\n-  JavaThread* current_thread  = JavaThread::current();\n-  HandleMark hm(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  HandleMark hm(current);\n@@ -1220,1 +1220,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -1224,1 +1224,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -1231,1 +1231,1 @@\n-    Handle obj(current_thread, thread_obj);\n+    Handle obj(current, thread_obj);\n@@ -1238,1 +1238,1 @@\n-                            current_thread);\n+                            current);\n@@ -1350,2 +1350,2 @@\n-  JavaThread* calling_thread = JavaThread::current();\n-  HandleMark hm(calling_thread);\n+  JavaThread* current = JavaThread::current();\n+  HandleMark hm(current);\n@@ -1358,1 +1358,1 @@\n-  ThreadsListHandle tlh(calling_thread);\n+  ThreadsListHandle tlh(current);\n@@ -1362,1 +1362,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, calling_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n@@ -1369,2 +1369,2 @@\n-    Handle thread_handle(calling_thread, thread_oop);\n-    EscapeBarrier eb(true, calling_thread, java_thread);\n+    Handle thread_handle(current, thread_oop);\n+    EscapeBarrier eb(true, current, java_thread);\n@@ -1376,1 +1376,1 @@\n-    GetOwnedMonitorInfoClosure op(this, calling_thread, owned_monitors_list);\n+    GetOwnedMonitorInfoClosure op(this, current, owned_monitors_list);\n@@ -1408,2 +1408,2 @@\n-  JavaThread* calling_thread = JavaThread::current();\n-  HandleMark hm(calling_thread);\n+  JavaThread* current = JavaThread::current();\n+  HandleMark hm(current);\n@@ -1416,1 +1416,1 @@\n-  ThreadsListHandle tlh(calling_thread);\n+  ThreadsListHandle tlh(current);\n@@ -1420,1 +1420,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, calling_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n@@ -1427,2 +1427,2 @@\n-    Handle thread_handle(calling_thread, thread_oop);\n-    EscapeBarrier eb(true, calling_thread, java_thread);\n+    Handle thread_handle(current, thread_oop);\n+    EscapeBarrier eb(true, current, java_thread);\n@@ -1434,1 +1434,1 @@\n-    GetOwnedMonitorInfoClosure op(this, calling_thread, owned_monitors_list);\n+    GetOwnedMonitorInfoClosure op(this, current, owned_monitors_list);\n@@ -1724,2 +1724,2 @@\n-  JavaThread* current_thread = JavaThread::current();\n-  HandleMark hm(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  HandleMark hm(current);\n@@ -1731,1 +1731,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -1735,2 +1735,2 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n-  Handle thread_handle(current_thread, thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  Handle thread_handle(current, thread_obj);\n@@ -1741,1 +1741,1 @@\n-  bool self = java_thread == current_thread;\n+  bool self = java_thread == current;\n@@ -1755,1 +1755,1 @@\n-  EscapeBarrier eb(true, current_thread, java_thread);\n+  EscapeBarrier eb(true, current, java_thread);\n@@ -1786,2 +1786,2 @@\n-  JavaThread* current_thread = JavaThread::current();\n-  ThreadsListHandle tlh(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  ThreadsListHandle tlh(current);\n@@ -1791,1 +1791,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -1796,1 +1796,0 @@\n-  JavaThread* current = JavaThread::current();\n@@ -2043,1 +2042,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2046,2 +2045,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2049,1 +2048,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2053,1 +2052,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2060,2 +2059,2 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n-                                     current_thread, depth, slot, self);\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+                                     current, depth, slot, self);\n@@ -2069,1 +2068,1 @@\n-    VM_GetOrSetLocal op(java_thread, current_thread, depth, slot, self);\n+    VM_GetOrSetLocal op(java_thread, current, depth, slot, self);\n@@ -2084,1 +2083,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2087,2 +2086,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2090,1 +2089,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2094,1 +2093,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2101,2 +2100,2 @@\n-    VM_VirtualThreadGetReceiver op(this, Handle(current_thread, thread_obj),\n-                                   current_thread, depth, self);\n+    VM_VirtualThreadGetReceiver op(this, Handle(current, thread_obj),\n+                                   current, depth, self);\n@@ -2110,1 +2109,1 @@\n-    VM_GetReceiver op(java_thread, current_thread, depth, self);\n+    VM_GetReceiver op(java_thread, current, depth, self);\n@@ -2126,1 +2125,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2129,2 +2128,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2132,1 +2131,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2136,1 +2135,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2143,1 +2142,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2168,1 +2167,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2171,2 +2170,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2174,1 +2173,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2178,1 +2177,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2185,1 +2184,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2210,1 +2209,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2213,2 +2212,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2216,1 +2215,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2220,1 +2219,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2227,1 +2226,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2252,1 +2251,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2255,2 +2254,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2258,1 +2257,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2262,1 +2261,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2269,1 +2268,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2293,1 +2292,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2296,2 +2295,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2299,1 +2298,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2303,1 +2302,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2312,1 +2311,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2330,1 +2329,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2333,2 +2332,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2336,1 +2335,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2340,1 +2339,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2349,1 +2348,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2367,1 +2366,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2370,2 +2369,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2373,1 +2372,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2377,1 +2376,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2386,1 +2385,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2404,1 +2403,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2407,2 +2406,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2410,1 +2409,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2414,1 +2413,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2423,1 +2422,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -2441,1 +2440,1 @@\n-  JavaThread* current_thread = JavaThread::current();\n+  JavaThread* current = JavaThread::current();\n@@ -2444,2 +2443,2 @@\n-  ResourceMark rm(current_thread);\n-  HandleMark hm(current_thread);\n+  ResourceMark rm(current);\n+  HandleMark hm(current);\n@@ -2447,1 +2446,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2451,1 +2450,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2460,1 +2459,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n@@ -3715,2 +3714,2 @@\n-  JavaThread* current_thread = JavaThread::current();\n-  ThreadsListHandle tlh(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  ThreadsListHandle tlh(current);\n@@ -3720,1 +3719,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnv.cpp","additions":123,"deletions":124,"binary":false,"changes":247,"status":"modified"},{"patch":"@@ -2164,2 +2164,2 @@\n-  JavaThread* current_thread = JavaThread::current();\n-  HandleMark hm(current_thread);\n+  JavaThread* current = JavaThread::current();\n+  HandleMark hm(current);\n@@ -2168,1 +2168,1 @@\n-  ThreadsListHandle tlh(current_thread);\n+  ThreadsListHandle tlh(current);\n@@ -2172,1 +2172,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n@@ -2177,2 +2177,2 @@\n-  Handle thread_handle(current_thread, thread_obj);\n-  bool self = java_thread == current_thread;\n+  Handle thread_handle(current, thread_obj);\n+  bool self = java_thread == current;\n@@ -2192,1 +2192,1 @@\n-  EscapeBarrier eb(true, current_thread, java_thread);\n+  EscapeBarrier eb(true, current, java_thread);\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}