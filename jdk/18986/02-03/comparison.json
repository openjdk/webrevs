{"files":[{"patch":"@@ -189,1 +189,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -191,1 +191,1 @@\n-    JvmtiThreadState* state = current->jvmti_thread_state();\n+    JvmtiThreadState* state = current_thread->jvmti_thread_state();\n@@ -200,3 +200,3 @@\n-    MACOS_AARCH64_ONLY(ThreadWXEnable __wx(WXWrite, current));\n-    ThreadInVMfromNative __tiv(current);\n-    VM_ENTRY_BASE(jvmtiError, JvmtiEnv::GetThreadLocalStorage , current)\n+    MACOS_AARCH64_ONLY(ThreadWXEnable __wx(WXWrite, current_thread));\n+    ThreadInVMfromNative __tiv(current_thread);\n+    VM_ENTRY_BASE(jvmtiError, JvmtiEnv::GetThreadLocalStorage , current_thread)\n@@ -206,1 +206,1 @@\n-    ThreadsListHandle tlh(current);\n+    ThreadsListHandle tlh(current_thread);\n@@ -210,1 +210,1 @@\n-    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+    jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -215,2 +215,2 @@\n-    HandleMark hm(current);\n-    Handle thread_handle(current, thread_obj);\n+    HandleMark hm(current_thread);\n+    Handle thread_handle(current_thread, thread_obj);\n@@ -859,1 +859,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -861,1 +861,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -865,1 +865,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n@@ -1179,1 +1179,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -1182,1 +1182,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -1188,1 +1188,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n@@ -1216,2 +1216,2 @@\n-  JavaThread* current = JavaThread::current();\n-  HandleMark hm(current);\n+  JavaThread* current_thread  = JavaThread::current();\n+  HandleMark hm(current_thread);\n@@ -1220,1 +1220,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -1224,1 +1224,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -1231,1 +1231,1 @@\n-    Handle obj(current, thread_obj);\n+    Handle obj(current_thread, thread_obj);\n@@ -1238,1 +1238,1 @@\n-                            current);\n+                            current_thread);\n@@ -1350,2 +1350,2 @@\n-  JavaThread* current = JavaThread::current();\n-  HandleMark hm(current);\n+  JavaThread* calling_thread = JavaThread::current();\n+  HandleMark hm(calling_thread);\n@@ -1358,1 +1358,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(calling_thread);\n@@ -1362,1 +1362,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, calling_thread, &java_thread, &thread_oop);\n@@ -1369,2 +1369,2 @@\n-    Handle thread_handle(current, thread_oop);\n-    EscapeBarrier eb(true, current, java_thread);\n+    Handle thread_handle(calling_thread, thread_oop);\n+    EscapeBarrier eb(true, calling_thread, java_thread);\n@@ -1376,1 +1376,1 @@\n-    GetOwnedMonitorInfoClosure op(this, current, owned_monitors_list);\n+    GetOwnedMonitorInfoClosure op(this, calling_thread, owned_monitors_list);\n@@ -1408,2 +1408,2 @@\n-  JavaThread* current = JavaThread::current();\n-  HandleMark hm(current);\n+  JavaThread* calling_thread = JavaThread::current();\n+  HandleMark hm(calling_thread);\n@@ -1416,1 +1416,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(calling_thread);\n@@ -1420,1 +1420,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, calling_thread, &java_thread, &thread_oop);\n@@ -1427,2 +1427,2 @@\n-    Handle thread_handle(current, thread_oop);\n-    EscapeBarrier eb(true, current, java_thread);\n+    Handle thread_handle(calling_thread, thread_oop);\n+    EscapeBarrier eb(true, calling_thread, java_thread);\n@@ -1434,1 +1434,1 @@\n-    GetOwnedMonitorInfoClosure op(this, current, owned_monitors_list);\n+    GetOwnedMonitorInfoClosure op(this, calling_thread, owned_monitors_list);\n@@ -1724,2 +1724,2 @@\n-  JavaThread* current = JavaThread::current();\n-  HandleMark hm(current);\n+  JavaThread* current_thread = JavaThread::current();\n+  HandleMark hm(current_thread);\n@@ -1731,1 +1731,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -1735,2 +1735,2 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n-  Handle thread_handle(current, thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n+  Handle thread_handle(current_thread, thread_obj);\n@@ -1741,1 +1741,1 @@\n-  bool self = java_thread == current;\n+  bool self = java_thread == current_thread;\n@@ -1755,1 +1755,1 @@\n-  EscapeBarrier eb(true, current, java_thread);\n+  EscapeBarrier eb(true, current_thread, java_thread);\n@@ -2042,1 +2042,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2045,2 +2045,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2048,1 +2048,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2052,1 +2052,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2059,2 +2059,2 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n-                                     current, depth, slot, self);\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n+                                     current_thread, depth, slot, self);\n@@ -2068,1 +2068,1 @@\n-    VM_GetOrSetLocal op(java_thread, current, depth, slot, self);\n+    VM_GetOrSetLocal op(java_thread, current_thread, depth, slot, self);\n@@ -2083,1 +2083,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2086,2 +2086,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2089,1 +2089,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2093,1 +2093,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2100,2 +2100,2 @@\n-    VM_VirtualThreadGetReceiver op(this, Handle(current, thread_obj),\n-                                   current, depth, self);\n+    VM_VirtualThreadGetReceiver op(this, Handle(current_thread, thread_obj),\n+                                   current_thread, depth, self);\n@@ -2109,1 +2109,1 @@\n-    VM_GetReceiver op(java_thread, current, depth, self);\n+    VM_GetReceiver op(java_thread, current_thread, depth, self);\n@@ -2125,1 +2125,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2128,2 +2128,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2131,1 +2131,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2135,1 +2135,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2142,1 +2142,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2167,1 +2167,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2170,2 +2170,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2173,1 +2173,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2177,1 +2177,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2184,1 +2184,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2209,1 +2209,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2212,2 +2212,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2215,1 +2215,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2219,1 +2219,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2226,1 +2226,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2251,1 +2251,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2254,2 +2254,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2257,1 +2257,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2261,1 +2261,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2268,1 +2268,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2292,1 +2292,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2295,2 +2295,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2298,1 +2298,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2302,1 +2302,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2311,1 +2311,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2329,1 +2329,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2332,2 +2332,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2335,1 +2335,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2339,1 +2339,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2348,1 +2348,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2366,1 +2366,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2369,2 +2369,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2372,1 +2372,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2376,1 +2376,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2385,1 +2385,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2403,1 +2403,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2406,2 +2406,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2409,1 +2409,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2413,1 +2413,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2422,1 +2422,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -2440,1 +2440,1 @@\n-  JavaThread* current = JavaThread::current();\n+  JavaThread* current_thread = JavaThread::current();\n@@ -2443,2 +2443,2 @@\n-  ResourceMark rm(current);\n-  HandleMark hm(current);\n+  ResourceMark rm(current_thread);\n+  HandleMark hm(current_thread);\n@@ -2446,1 +2446,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2450,1 +2450,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2459,1 +2459,1 @@\n-    VM_VirtualThreadGetOrSetLocal op(this, Handle(current, thread_obj),\n+    VM_VirtualThreadGetOrSetLocal op(this, Handle(current_thread, thread_obj),\n@@ -3714,2 +3714,2 @@\n-  JavaThread* current = JavaThread::current();\n-  ThreadsListHandle tlh(current);\n+  JavaThread* current_thread = JavaThread::current();\n+  ThreadsListHandle tlh(current_thread);\n@@ -3719,1 +3719,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_oop);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_oop);\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnv.cpp","additions":115,"deletions":115,"binary":false,"changes":230,"status":"modified"},{"patch":"@@ -2164,2 +2164,2 @@\n-  JavaThread* current = JavaThread::current();\n-  HandleMark hm(current);\n+  JavaThread* current_thread = JavaThread::current();\n+  HandleMark hm(current_thread);\n@@ -2168,1 +2168,1 @@\n-  ThreadsListHandle tlh(current);\n+  ThreadsListHandle tlh(current_thread);\n@@ -2172,1 +2172,1 @@\n-  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current, &java_thread, &thread_obj);\n+  jvmtiError err = get_threadOop_and_JavaThread(tlh.list(), thread, current_thread, &java_thread, &thread_obj);\n@@ -2177,2 +2177,2 @@\n-  Handle thread_handle(current, thread_obj);\n-  bool self = java_thread == current;\n+  Handle thread_handle(current_thread, thread_obj);\n+  bool self = java_thread == current_thread;\n@@ -2192,1 +2192,1 @@\n-  EscapeBarrier eb(true, current, java_thread);\n+  EscapeBarrier eb(true, current_thread, java_thread);\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}