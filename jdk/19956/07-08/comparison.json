{"files":[{"patch":"@@ -28,1 +28,0 @@\n-import jdk.internal.util.HexDigits;\n@@ -33,0 +32,2 @@\n+import jdk.internal.util.HexDigits;\n+\n@@ -83,0 +84,1 @@\n+        byte coder = format.coder();\n@@ -87,1 +89,3 @@\n-                arg = String.valueOf(arg);\n+                String str = String.valueOf(arg);\n+                coder |= str.coder();\n+                arg = str;\n@@ -95,1 +99,1 @@\n-        return format1(format, off, conv, arg, width, size);\n+        return format1(format, coder, off, conv, arg, width, size);\n@@ -140,1 +144,1 @@\n-                arg1 = str = String.valueOf(arg1);\n+                str = String.valueOf(arg1);\n@@ -142,0 +146,1 @@\n+                arg1 = str;\n@@ -193,5 +198,1 @@\n-    private static String format1(String format, int off, char conv, Object arg, int width, int size) {\n-        byte coder = format.coder();\n-        if (arg instanceof String) {\n-            coder |= ((String) arg).coder();\n-        }\n+    private static String format1(String format, byte coder, int off, char conv, Object arg, int width, int size) {\n@@ -199,2 +200,2 @@\n-        int length = format.length() + Math.max(width, size) - specifierSize;\n-        byte[] bytes = new byte[length << coder];\n+        int strlen = format.length() + Math.max(width, size) - specifierSize;\n+        byte[] bytes = new byte[strlen << coder];\n@@ -217,1 +218,1 @@\n-            String format, int length,\n+            String format, int strlen,\n@@ -221,1 +222,1 @@\n-        byte[] bytes = new byte[length];\n+        byte[] bytes = new byte[strlen];\n@@ -244,1 +245,1 @@\n-            String format, int length,\n+            String format, int strlen,\n@@ -249,1 +250,1 @@\n-        byte[] bytes = new byte[length << coder];\n+        byte[] bytes = new byte[strlen << coder];\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringFormat.java","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"}]}