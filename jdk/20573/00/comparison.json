{"files":[{"patch":"@@ -379,1 +379,1 @@\n-                System.err.println(\"ERROR: cert cannot be verified:\" + e.getMessage());\n+                System.err.println(\"ERROR: \" + alias + \" cert cannot be verified:\" + e.getMessage());\n@@ -388,1 +388,1 @@\n-                    System.err.println(\"ERROR: cert is expired but not in EXPIRY_EXC_ENTRIES\");\n+                    System.err.println(\"ERROR: \" + alias + \" cert is expired but not in EXPIRY_EXC_ENTRIES\");\n@@ -392,1 +392,16 @@\n-                System.err.println(\"ERROR: cert is not yet valid\");\n+                System.err.println(\"ERROR: \" + alias + \" cert is not yet valid\");\n+            }\n+\n+            \/\/ Is it CA certificate?\n+            if (cert.getBasicConstraints() == -1){\n+                \/\/ \"VeriSign Class 3 Public Primary Certification Authority - G3\" is X.509 version 1 certificate\n+                if (!\"verisignclass3g3ca [jdk]\".equals(alias)) {\n+                    atLeastOneFailed = true;\n+                    System.err.println(\"ERROR: \" + alias + \" BasicConstraints is missing or doesn't specify CA:true\");\n+                }\n+            }\n+            boolean[] keyUsageBits = cert.getKeyUsage();\n+            \/\/ check that the KeyUsage extension, if included, asserts the keyCertSign bit\n+            if (keyUsageBits != null && !keyUsageBits[5]){\n+                atLeastOneFailed = true;\n+                System.err.println(\"ERROR: \" + alias + \" KeyUsage doesn't assert Key_CertSign\");\n","filename":"test\/jdk\/sun\/security\/lib\/cacerts\/VerifyCACerts.java","additions":18,"deletions":3,"binary":false,"changes":21,"status":"modified"}]}