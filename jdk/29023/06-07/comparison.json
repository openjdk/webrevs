{"files":[{"patch":"@@ -554,2 +554,9 @@\n-  if (offset == sym->offset) {\n-    \/\/ offset points to the top of the symbol\n+  if (sym->size == 0 && offset == sym->offset) {\n+    \/\/ offset points to the top of the symbol.\n+    \/\/ Some functions have size 0. For example, __restore_rt() (signal trampoline\n+    \/\/ in glibc) would be detected as out of the function incorrectly, even if it\n+    \/\/ points to the top of the instruction address, because the size of\n+    \/\/ __restore_rt() is 0 (you can see this with \"readelf -s libc.so.6\" when\n+    \/\/ debug symbols are available).\n+    \/\/ Hence we need to treat this as a special case if the function size is 0,\n+    \/\/ only the exact symbol address should be treated as inside.\n@@ -557,1 +564,1 @@\n-  } else if (offset > sym->offset && offset < sym->offset + sym->size) {\n+  } else if (offset >= sym->offset && offset < sym->offset + sym->size) {\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/symtab.c","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"}]}