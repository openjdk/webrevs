{"files":[{"patch":"@@ -1522,1 +1522,1 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n@@ -1524,1 +1524,1 @@\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -1593,1 +1593,1 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n@@ -1595,1 +1595,1 @@\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -8335,7 +8335,2 @@\n-    if (UnsafeCopyMemory::_table == nullptr) {\n-      UnsafeCopyMemory::create_table(8);\n-    }\n-\n-    \/\/ Initialize table for fill memory check.\n-    if (UnsafeSetMemory::_table == nullptr) {\n-      UnsafeSetMemory::create_table(8);\n+    if (UnsafeMemoryAccess::_table == nullptr) {\n+      UnsafeMemoryAccess::create_table(18);\n","filename":"src\/hotspot\/cpu\/aarch64\/stubGenerator_aarch64.cpp","additions":6,"deletions":11,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -959,2 +959,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, unsafe_copy, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, unsafe_copy, true);\n@@ -1108,2 +1108,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, unsafe_copy, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, unsafe_copy, true);\n@@ -1764,2 +1764,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, unsafe_copy, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, unsafe_copy, true);\n@@ -1903,2 +1903,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, unsafe_copy, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, unsafe_copy, true);\n@@ -2061,2 +2061,2 @@\n-      \/\/ UnsafeCopyMemoryMark page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryMark page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -2095,1 +2095,1 @@\n-      min_copy = generate_forward_aligned_copy_loop(from, to, count, bytes_per_count, !aligned \/*add UnsafeCopyMemory entry*\/);\n+      min_copy = generate_forward_aligned_copy_loop(from, to, count, bytes_per_count, !aligned \/*add UnsafeMemoryAccess entry*\/);\n@@ -2097,1 +2097,1 @@\n-      min_copy = generate_backward_aligned_copy_loop(from, to, count, bytes_per_count, !aligned \/*add UnsafeCopyMemory entry*\/);\n+      min_copy = generate_backward_aligned_copy_loop(from, to, count, bytes_per_count, !aligned \/*add UnsafeMemoryAccess entry*\/);\n@@ -2108,1 +2108,1 @@\n-      copy_small_array(from, to, count, tmp1, tmp2, bytes_per_count, forward, L_small_array \/* entry *\/, !aligned \/*add UnsafeCopyMemory entry*\/);\n+      copy_small_array(from, to, count, tmp1, tmp2, bytes_per_count, forward, L_small_array \/* entry *\/, !aligned \/*add UnsafeMemoryAccess entry*\/);\n@@ -2119,1 +2119,1 @@\n-      int min_copy_shifted = align_dst_and_generate_shifted_copy_loop(from, to, count, bytes_per_count, forward, !aligned \/*add UnsafeCopyMemory entry*\/);\n+      int min_copy_shifted = align_dst_and_generate_shifted_copy_loop(from, to, count, bytes_per_count, forward, !aligned \/*add UnsafeMemoryAccess entry*\/);\n@@ -2865,1 +2865,1 @@\n-    UnsafeCopyMemory::set_common_exit_stub_pc(ucm_common_error_exit);\n+    UnsafeMemoryAccess::set_common_exit_stub_pc(ucm_common_error_exit);\n@@ -3137,6 +3137,2 @@\n-    if (UnsafeCopyMemory::_table == nullptr) {\n-      UnsafeCopyMemory::create_table(32);\n-    }\n-\n-    if (UnsafeSetMemory::_table == nullptr) {\n-      UnsafeSetMemory::create_table(32);\n+    if (UnsafeMemoryAccess::_table == nullptr) {\n+      UnsafeMemoryAccess::create_table(42);\n","filename":"src\/hotspot\/cpu\/arm\/stubGenerator_arm.cpp","additions":17,"deletions":21,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -964,1 +964,1 @@\n-  \/\/ This is common errorexit stub for UnsafeCopyMemory.\n+  \/\/ This is common errorexit stub for UnsafeMemoryAccess.\n@@ -1016,2 +1016,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1198,2 +1198,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1285,2 +1285,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1469,2 +1469,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1628,2 +1628,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1780,2 +1780,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -1906,2 +1906,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -2037,2 +2037,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue at UnsafeCopyMemory common_error_exit\n-      UnsafeCopyMemoryMark ucmm(this, !aligned, false);\n+      \/\/ UnsafeMemoryAccess page error: continue at UnsafeMemoryAccess common_error_exit\n+      UnsafeMemoryMark ucmm(this, !aligned, false);\n@@ -3132,1 +3132,1 @@\n-    UnsafeCopyMemory::set_common_exit_stub_pc(ucm_common_error_exit);\n+    UnsafeMemoryAccess::set_common_exit_stub_pc(ucm_common_error_exit);\n@@ -4748,6 +4748,2 @@\n-    if (UnsafeCopyMemory::_table == nullptr) {\n-      UnsafeCopyMemory::create_table(8);\n-    }\n-\n-    if (UnsafeSetMemory::_table == nullptr) {\n-      UnsafeSetMemory::create_table(8);\n+    if (UnsafeMemoryAccess::_table == nullptr) {\n+      UnsafeMemoryAccess::create_table(18);\n","filename":"src\/hotspot\/cpu\/ppc\/stubGenerator_ppc.cpp","additions":20,"deletions":24,"binary":false,"changes":44,"status":"modified"},{"patch":"@@ -1118,1 +1118,1 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n@@ -1120,1 +1120,1 @@\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -1194,1 +1194,1 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n@@ -1196,1 +1196,1 @@\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -5482,6 +5482,2 @@\n-    if (UnsafeCopyMemory::_table == nullptr) {\n-      UnsafeCopyMemory::create_table(8);\n-    }\n-\n-    if (UnsafeSetMemory::_table == nullptr) {\n-      UnsafeSetMemory::create_table(8);\n+    if (UnsafeMemoryAccess::_table == nullptr) {\n+      UnsafeMemoryAccess::create_table(18);\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1134,2 +1134,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -1324,2 +1324,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, add_entry, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, add_entry, true);\n@@ -1453,2 +1453,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, true, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, true, true);\n@@ -1508,2 +1508,2 @@\n-      \/\/ UnsafeCopyMemory page error: continue after ucm\n-      UnsafeCopyMemoryMark ucmm(this, true, true);\n+      \/\/ UnsafeMemoryAccess page error: continue after ucm\n+      UnsafeMemoryMark ucmm(this, true, true);\n@@ -4124,7 +4124,2 @@\n-    if (UnsafeCopyMemory::_table == nullptr) {\n-      UnsafeCopyMemory::create_table(16);\n-    }\n-\n-    \/\/ Initialize table for fill memory check.\n-    if (UnsafeSetMemory::_table == nullptr) {\n-      UnsafeSetMemory::create_table(22);\n+    if (UnsafeMemoryAccess::_table == nullptr) {\n+      UnsafeMemoryAccess::create_table(26);\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_32.cpp","additions":10,"deletions":15,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -4012,7 +4012,2 @@\n-  if (UnsafeCopyMemory::_table == nullptr) {\n-    UnsafeCopyMemory::create_table(16);\n-  }\n-\n-  \/\/ Initialize table for unsafe set memeory check.\n-  if (UnsafeSetMemory::_table == nullptr) {\n-    UnsafeSetMemory::create_table(22);\n+  if (UnsafeMemoryAccess::_table == nullptr) {\n+    UnsafeMemoryAccess::create_table(26);\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64.cpp","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -563,2 +563,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -861,2 +861,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -1320,2 +1320,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1376,1 +1376,1 @@\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, false, ucme_exit_pc);\n+    UnsafeMemoryMark ucmm(this, !aligned, false, ucme_exit_pc);\n@@ -1434,2 +1434,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1479,2 +1479,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1551,2 +1551,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1600,1 +1600,1 @@\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, false, ucme_exit_pc);\n+    UnsafeMemoryMark ucmm(this, !aligned, false, ucme_exit_pc);\n@@ -1626,1 +1626,1 @@\n-    UnsafeSetMemoryMark(this, true, true);\n+    UnsafeMemoryMark(this, true, true);\n@@ -1687,2 +1687,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1724,2 +1724,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !aligned, true);\n@@ -1808,2 +1808,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -1845,1 +1845,1 @@\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, false, ucme_exit_pc);\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, false, ucme_exit_pc);\n@@ -1918,2 +1918,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -1951,2 +1951,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -2033,2 +2033,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -2065,2 +2065,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -2142,2 +2142,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -2169,2 +2169,2 @@\n-    \/\/ UnsafeCopyMemory page error: continue after ucm\n-    UnsafeCopyMemoryMark ucmm(this, !is_oop && !aligned, true);\n+    \/\/ UnsafeMemoryAccess page error: continue after ucm\n+    UnsafeMemoryMark ucmm(this, !is_oop && !aligned, true);\n@@ -2637,1 +2637,1 @@\n-      UnsafeSetMemoryMark usmm(this, true, true);\n+      UnsafeMemoryMark usmm(this, true, true);\n@@ -2651,1 +2651,1 @@\n-      UnsafeSetMemoryMark usmm(this, true, true);\n+      UnsafeMemoryMark usmm(this, true, true);\n@@ -2668,1 +2668,1 @@\n-      UnsafeSetMemoryMark usmm(this, true, true);\n+      UnsafeMemoryMark usmm(this, true, true);\n@@ -2685,1 +2685,1 @@\n-      UnsafeSetMemoryMark usmm(this, true, true);\n+      UnsafeMemoryMark usmm(this, true, true);\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64_arraycopy.cpp","additions":38,"deletions":38,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -2798,3 +2798,2 @@\n-      bool is_unsafe_arraycopy = (in_native || in_java) && UnsafeCopyMemory::contains_pc(pc);\n-      bool is_unsafe_setmemory = (in_native || in_java) && UnsafeSetMemory::contains_pc(pc);\n-      if (((in_vm || in_native || is_unsafe_arraycopy || is_unsafe_setmemory) && thread->doing_unsafe_access()) ||\n+      bool is_unsafe_memory_access = (in_native || in_java) && UnsafeMemoryAccess::contains_pc(pc);\n+      if (((in_vm || in_native || is_unsafe_memory_access) && thread->doing_unsafe_access()) ||\n@@ -2803,5 +2802,2 @@\n-        if (is_unsafe_arraycopy) {\n-          next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-        }\n-        if (is_unsafe_setmemory) {\n-          next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+        if (is_unsafe_memory_access) {\n+          next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -343,3 +343,2 @@\n-        bool is_unsafe_arraycopy = (thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc));\n-        bool is_unsafe_setmemory = (thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc));\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy || is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = (thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc));\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -347,5 +346,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -375,5 +371,2 @@\n-        if (UnsafeCopyMemory::contains_pc(pc)) {\n-          next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-        }\n-        if (UnsafeSetMemory::contains_pc(pc)) {\n-          next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+        if (UnsafeMemoryAccess::contains_pc(pc)) {\n+          next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/aix_ppc\/os_aix_ppc.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -260,3 +260,2 @@\n-        bool is_unsafe_arraycopy = (thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc));\n-        bool is_unsafe_setmemory = (thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc));\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy || is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = (thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc));\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -264,5 +263,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -306,5 +302,2 @@\n-      if (UnsafeCopyMemory::contains_pc(pc)) {\n-        next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-      }\n-      if (UnsafeSetMemory::contains_pc(pc)) {\n-        next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+      if (UnsafeMemoryAccess::contains_pc(pc)) {\n+        next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/bsd_aarch64\/os_bsd_aarch64.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -444,4 +444,2 @@\n-        bool is_unsafe_arraycopy = thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc);\n-        bool is_unsafe_setmemory = thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc);\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy ||\n-            is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc);\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -449,5 +447,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -529,5 +524,2 @@\n-        if (UnsafeCopyMemory::contains_pc(pc)) {\n-          next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-        }\n-        if (UnsafeSetMemory::contains_pc(pc)) {\n-          next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+        if (UnsafeMemoryAccess::contains_pc(pc)) {\n+          next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/bsd_x86\/os_bsd_x86.cpp","additions":6,"deletions":14,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -243,3 +243,2 @@\n-        bool is_unsafe_arraycopy = (thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc));\n-        bool is_unsafe_setmemory = (thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc));\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy) {\n+        bool is_unsafe_memory_access = (thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc));\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -247,5 +246,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -293,5 +289,2 @@\n-      if (UnsafeCopyMemory::contains_pc(pc)) {\n-        next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-      }\n-      if (UnsafeSetMemory::contains_pc(pc)) {\n-        next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+      if (UnsafeMemoryAccess::contains_pc(pc)) {\n+        next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/os_linux_aarch64.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -329,2 +329,1 @@\n-             (UnsafeCopyMemory::contains_pc(pc) ||\n-              UnsafeSetMemory::contains_pc(pc)))) {\n+             UnsafeMemoryAccess::contains_pc(pc))) {\n@@ -368,5 +367,2 @@\n-    if (UnsafeCopyMemory::contains_pc(pc)) {\n-      next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-    }\n-    if (UnsafeSetMemory::contains_pc(pc)) {\n-      next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+    if (UnsafeMemoryAccess::contains_pc(pc)) {\n+      next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/linux_arm\/os_linux_arm.cpp","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -358,3 +358,2 @@\n-        bool is_unsafe_arraycopy = (thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc));\n-        bool is_unsafe_setmemory = (thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc));\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy || is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = (thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc));\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -362,5 +361,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -386,5 +382,2 @@\n-        if (UnsafeCopyMemory::contains_pc(pc)) {\n-          next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-        }\n-        if (UnsafeSetMemory::contains_pc(pc)) {\n-          next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+        if (UnsafeMemoryAccess::contains_pc(pc)) {\n+          next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/linux_ppc\/os_linux_ppc.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -233,3 +233,2 @@\n-        bool is_unsafe_arraycopy = (thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc));\n-        bool is_unsafe_setmemory = (thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc));\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy || is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = (thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc));\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -237,5 +236,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -279,5 +275,2 @@\n-      if (UnsafeCopyMemory::contains_pc(pc)) {\n-        next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-      }\n-      if (UnsafeSetMemory::contains_pc(pc)) {\n-        next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+      if (UnsafeMemoryAccess::contains_pc(pc)) {\n+        next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/linux_riscv\/os_linux_riscv.cpp","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -263,4 +263,2 @@\n-        bool is_unsafe_arraycopy = thread->doing_unsafe_access() && UnsafeCopyMemory::contains_pc(pc);\n-        bool is_unsafe_setmemory = thread->doing_unsafe_access() && UnsafeSetMemory::contains_pc(pc);\n-        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_arraycopy ||\n-            is_unsafe_setmemory) {\n+        bool is_unsafe_memory_access = thread->doing_unsafe_access() && UnsafeMemoryAccess::contains_pc(pc);\n+        if ((nm != nullptr && nm->has_unsafe_access()) || is_unsafe_memory_access) {\n@@ -268,5 +266,2 @@\n-          if (is_unsafe_arraycopy) {\n-            next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-          }\n-          if (is_unsafe_setmemory) {\n-            next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+          if (is_unsafe_memory_access) {\n+            next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n@@ -323,5 +318,2 @@\n-        if (UnsafeCopyMemory::contains_pc(pc)) {\n-          next_pc = UnsafeCopyMemory::page_error_continue_pc(pc);\n-        }\n-        if (UnsafeSetMemory::contains_pc(pc)) {\n-          next_pc = UnsafeSetMemory::page_error_continue_pc(pc);\n+        if (UnsafeMemoryAccess::contains_pc(pc)) {\n+          next_pc = UnsafeMemoryAccess::page_error_continue_pc(pc);\n","filename":"src\/hotspot\/os_cpu\/linux_x86\/os_linux_x86.cpp","additions":6,"deletions":14,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -43,9 +43,4 @@\n-UnsafeCopyMemory* UnsafeCopyMemory::_table                      = nullptr;\n-int UnsafeCopyMemory::_table_length                             = 0;\n-int UnsafeCopyMemory::_table_max_length                         = 0;\n-address UnsafeCopyMemory::_common_exit_stub_pc                  = nullptr;\n-\n-UnsafeSetMemory* UnsafeSetMemory::_table                       = nullptr;\n-int UnsafeSetMemory::_table_length                             = 0;\n-int UnsafeSetMemory::_table_max_length                         = 0;\n-address UnsafeSetMemory::_common_exit_stub_pc                  = nullptr;\n+UnsafeMemoryAccess* UnsafeMemoryAccess::_table                      = nullptr;\n+int UnsafeMemoryAccess::_table_length                             = 0;\n+int UnsafeMemoryAccess::_table_max_length                         = 0;\n+address UnsafeMemoryAccess::_common_exit_stub_pc                  = nullptr;\n@@ -209,28 +204,3 @@\n-void UnsafeCopyMemory::create_table(int max_size) {\n-  UnsafeCopyMemory::_table = new UnsafeCopyMemory[max_size];\n-  UnsafeCopyMemory::_table_max_length = max_size;\n-}\n-\n-bool UnsafeCopyMemory::contains_pc(address pc) {\n-  for (int i = 0; i < UnsafeCopyMemory::_table_length; i++) {\n-    UnsafeCopyMemory* entry = &UnsafeCopyMemory::_table[i];\n-    if (pc >= entry->start_pc() && pc < entry->end_pc()) {\n-      return true;\n-    }\n-  }\n-  return false;\n-}\n-\n-address UnsafeCopyMemory::page_error_continue_pc(address pc) {\n-  for (int i = 0; i < UnsafeCopyMemory::_table_length; i++) {\n-    UnsafeCopyMemory* entry = &UnsafeCopyMemory::_table[i];\n-    if (pc >= entry->start_pc() && pc < entry->end_pc()) {\n-      return entry->error_exit_pc();\n-    }\n-  }\n-  return nullptr;\n-}\n-\n-void UnsafeSetMemory::create_table(int max_size) {\n-  UnsafeSetMemory::_table = new UnsafeSetMemory[max_size];\n-  UnsafeSetMemory::_table_max_length = max_size;\n+void UnsafeMemoryAccess::create_table(int max_size) {\n+  UnsafeMemoryAccess::_table = new UnsafeMemoryAccess[max_size];\n+  UnsafeMemoryAccess::_table_max_length = max_size;\n@@ -239,3 +209,3 @@\n-bool UnsafeSetMemory::contains_pc(address pc) {\n-  for (int i = 0; i < UnsafeSetMemory::_table_length; i++) {\n-    UnsafeSetMemory* entry = &UnsafeSetMemory::_table[i];\n+bool UnsafeMemoryAccess::contains_pc(address pc) {\n+  for (int i = 0; i < UnsafeMemoryAccess::_table_length; i++) {\n+    UnsafeMemoryAccess* entry = &UnsafeMemoryAccess::_table[i];\n@@ -249,3 +219,3 @@\n-address UnsafeSetMemory::page_error_continue_pc(address pc) {\n-  for (int i = 0; i < UnsafeSetMemory::_table_length; i++) {\n-    UnsafeSetMemory* entry = &UnsafeSetMemory::_table[i];\n+address UnsafeMemoryAccess::page_error_continue_pc(address pc) {\n+  for (int i = 0; i < UnsafeMemoryAccess::_table_length; i++) {\n+    UnsafeMemoryAccess* entry = &UnsafeMemoryAccess::_table[i];\n@@ -551,23 +521,1 @@\n-UnsafeCopyMemoryMark::UnsafeCopyMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc) {\n-  _cgen = cgen;\n-  _ucm_entry = nullptr;\n-  if (add_entry) {\n-    address err_exit_pc = nullptr;\n-    if (!continue_at_scope_end) {\n-      err_exit_pc = error_exit_pc != nullptr ? error_exit_pc : UnsafeCopyMemory::common_exit_stub_pc();\n-    }\n-    assert(err_exit_pc != nullptr || continue_at_scope_end, \"error exit not set\");\n-    _ucm_entry = UnsafeCopyMemory::add_to_table(_cgen->assembler()->pc(), nullptr, err_exit_pc);\n-  }\n-}\n-\n-UnsafeCopyMemoryMark::~UnsafeCopyMemoryMark() {\n-  if (_ucm_entry != nullptr) {\n-    _ucm_entry->set_end_pc(_cgen->assembler()->pc());\n-    if (_ucm_entry->error_exit_pc() == nullptr) {\n-      _ucm_entry->set_error_exit_pc(_cgen->assembler()->pc());\n-    }\n-  }\n-}\n-\n-UnsafeSetMemoryMark::UnsafeSetMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc) {\n+UnsafeMemoryMark::UnsafeMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc) {\n@@ -579,1 +527,1 @@\n-      err_exit_pc = error_exit_pc != nullptr ? error_exit_pc : UnsafeSetMemory::common_exit_stub_pc();\n+      err_exit_pc = error_exit_pc != nullptr ? error_exit_pc : UnsafeMemoryAccess::common_exit_stub_pc();\n@@ -582,1 +530,1 @@\n-    _ucm_entry = UnsafeSetMemory::add_to_table(_cgen->assembler()->pc(), nullptr, err_exit_pc);\n+    _ucm_entry = UnsafeMemoryAccess::add_to_table(_cgen->assembler()->pc(), nullptr, err_exit_pc);\n@@ -586,1 +534,1 @@\n-UnsafeSetMemoryMark::~UnsafeSetMemoryMark() {\n+UnsafeMemoryMark::~UnsafeMemoryMark() {\n","filename":"src\/hotspot\/share\/runtime\/stubRoutines.cpp","additions":17,"deletions":69,"binary":false,"changes":86,"status":"modified"},{"patch":"@@ -79,1 +79,1 @@\n-class UnsafeCopyMemory : public CHeapObj<mtCode> {\n+class UnsafeMemoryAccess : public CHeapObj<mtCode> {\n@@ -86,1 +86,1 @@\n-  static UnsafeCopyMemory* _table;\n+  static UnsafeMemoryAccess* _table;\n@@ -89,1 +89,1 @@\n-  UnsafeCopyMemory() : _start_pc(nullptr), _end_pc(nullptr), _error_exit_pc(nullptr) {}\n+  UnsafeMemoryAccess() : _start_pc(nullptr), _end_pc(nullptr), _error_exit_pc(nullptr) {}\n@@ -100,3 +100,3 @@\n-  static UnsafeCopyMemory* add_to_table(address start_pc, address end_pc, address error_exit_pc) {\n-    guarantee(_table_length < _table_max_length, \"Incorrect UnsafeCopyMemory::_table_max_length\");\n-    UnsafeCopyMemory* entry = &_table[_table_length];\n+  static UnsafeMemoryAccess* add_to_table(address start_pc, address end_pc, address error_exit_pc) {\n+    guarantee(_table_length < _table_max_length, \"Incorrect UnsafeMemoryAccess::_table_max_length\");\n+    UnsafeMemoryAccess* entry = &_table[_table_length];\n@@ -116,1 +116,1 @@\n-class UnsafeCopyMemoryMark : public StackObj {\n+class UnsafeMemoryMark : public StackObj {\n@@ -118,1 +118,1 @@\n-  UnsafeCopyMemory*  _ucm_entry;\n+  UnsafeMemoryAccess*  _ucm_entry;\n@@ -121,48 +121,2 @@\n-  UnsafeCopyMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc = nullptr);\n-  ~UnsafeCopyMemoryMark();\n-};\n-\n-class UnsafeSetMemory : public CHeapObj<mtCode> {\n- private:\n-  address _start_pc;\n-  address _end_pc;\n-  address _error_exit_pc;\n- public:\n-  static address           _common_exit_stub_pc;\n-  static UnsafeSetMemory* _table;\n-  static int               _table_length;\n-  static int               _table_max_length;\n-  UnsafeSetMemory() : _start_pc(nullptr), _end_pc(nullptr), _error_exit_pc(nullptr) {}\n-  void    set_start_pc(address pc)      { _start_pc = pc; }\n-  void    set_end_pc(address pc)        { _end_pc = pc; }\n-  void    set_error_exit_pc(address pc) { _error_exit_pc = pc; }\n-  address start_pc()      const { return _start_pc; }\n-  address end_pc()        const { return _end_pc; }\n-  address error_exit_pc() const { return _error_exit_pc; }\n-\n-  static void    set_common_exit_stub_pc(address pc) { _common_exit_stub_pc = pc; }\n-  static address common_exit_stub_pc()               { return _common_exit_stub_pc; }\n-\n-  static UnsafeSetMemory* add_to_table(address start_pc, address end_pc, address error_exit_pc) {\n-    guarantee(_table_length < _table_max_length, \"Incorrect UnsafeSetMemory::_table_max_length\");\n-    UnsafeSetMemory* entry = &_table[_table_length];\n-    entry->set_start_pc(start_pc);\n-    entry->set_end_pc(end_pc);\n-    entry->set_error_exit_pc(error_exit_pc);\n-\n-    _table_length++;\n-    return entry;\n-  }\n-\n-  static bool    contains_pc(address pc);\n-  static address page_error_continue_pc(address pc);\n-  static void    create_table(int max_size);\n-};\n-\n-class UnsafeSetMemoryMark : public StackObj {\n- private:\n-  UnsafeSetMemory*  _ucm_entry;\n-  StubCodeGenerator* _cgen;\n- public:\n-  UnsafeSetMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc = nullptr);\n-  ~UnsafeSetMemoryMark();\n+  UnsafeMemoryMark(StubCodeGenerator* cgen, bool add_entry, bool continue_at_scope_end, address error_exit_pc = nullptr);\n+  ~UnsafeMemoryMark();\n","filename":"src\/hotspot\/share\/runtime\/stubRoutines.hpp","additions":10,"deletions":56,"binary":false,"changes":66,"status":"modified"}]}