{"files":[{"patch":"@@ -33,1 +33,1 @@\n- * The following example shows a naive implementation of a setting control for\n+ * The following example shows an implementation of a setting control for\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/SettingControl.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -68,0 +68,1 @@\n+import java.util.regex.PatternSyntaxException;\n@@ -100,0 +101,1 @@\n+        private static final String DEFAULT_VALUE = \"true\";\n@@ -104,1 +106,7 @@\n-            return values.contains(\"true\") ? \"true\" : \"false\";\n+            if (values.contains(\"true\")) {\n+                return \"true\";\n+            }\n+            if (values.contains(\"false\")) {\n+                return \"false\";\n+            }\n+            return DEFAULT_VALUE;\n@@ -108,2 +116,5 @@\n-        public void setValue(String settingValue) {\n-            value = \"true\".equals(settingValue);\n+        public void setValue(String value) {\n+            \/\/ Ignore invalid values\n+            if (\"true\".equals(value) || \"false\".equals(value)) {\n+                this.value = \"true\".equals(value);\n+            }\n@@ -510,1 +521,2 @@\n-     private Pattern pattern = Pattern.compile(\".*\");\n+     private static final String DEFAULT_VALUE = \".*\";\n+     private Pattern pattern = Pattern.compile(DEFAULT_VALUE);\n@@ -513,2 +525,17 @@\n-     public void setValue(String value) {\n-         this.pattern = Pattern.compile(value);\n+     public String combine(Set<String> values) {\n+         List<String> valid = new ArrayList<>();\n+         for (String value : values) {\n+             try {\n+                 Pattern.compile(value);\n+                 valid.add(value);\n+             } catch (PatternSyntaxException pse) {\n+                 \/\/ Ignore invalid patterns\n+             }\n+         }\n+         if (valid.isEmpty()) {\n+             return DEFAULT_VALUE;\n+         }\n+         if (valid.size() == 1) {\n+             return valid.getFirst();\n+         }\n+         return \"(\" + String.join(\")|(\", valid) + \")\";\n@@ -518,2 +545,6 @@\n-     public String combine(Set<String> values) {\n-         return String.join(\"|\", values);\n+     public void setValue(String value) {\n+         try {\n+             this.pattern = Pattern.compile(value);\n+         } catch (PatternSyntaxException pse) {\n+             \/\/ Ignore invalid patterns\n+         }\n@@ -524,1 +555,1 @@\n-         return pattern.toString();\n+         return pattern.pattern();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/snippet-files\/Snippets.java","additions":41,"deletions":10,"binary":false,"changes":51,"status":"modified"}]}