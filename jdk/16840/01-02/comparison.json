{"files":[{"patch":"@@ -112,1 +112,6 @@\n-    mdo->clean_extra_data(&cl);\n+    {\n+      \/\/ We hold the extra data lock, so now don't safepoint so we don't\n+      \/\/ give up the lock during cleaning.\n+      NoSafepointVerifier no_safepoint;\n+      mdo->clean_extra_data(&cl);\n+    }\n","filename":"src\/hotspot\/share\/ci\/ciMethodData.cpp","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1833,0 +1833,1 @@\n+  \/\/ TODO safe?\n@@ -1842,0 +1843,1 @@\n+  \/\/ TODO safe?\n","filename":"src\/hotspot\/share\/oops\/methodData.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -36,0 +36,2 @@\n+#include \"runtime\/mutexLocker.hpp\"\n+#include \"runtime\/safepointVerifiers.hpp\"\n@@ -2257,1 +2259,4 @@\n-  uint arg_modified(int a)                       { ArgInfoData *aid = arg_info();\n+  uint arg_modified(int a)                       { \/\/ Lock and avoid breaking lock with Safepoint\n+                                                   MutexLocker ml(extra_data_lock());\n+                                                   NoSafepointVerifier no_safepoint;\n+                                                   ArgInfoData *aid = arg_info();\n@@ -2266,1 +2271,4 @@\n-  void set_arg_modified(int a, uint v)           { ArgInfoData *aid = arg_info();\n+  void set_arg_modified(int a, uint v)           { \/\/ Lock and avoid breaking lock with Safepoint\n+                                                   MutexLocker ml(extra_data_lock());\n+                                                   NoSafepointVerifier no_safepoint;\n+                                                   ArgInfoData *aid = arg_info();\n@@ -2346,1 +2354,1 @@\n-  int extra_data_size() const          { return (int)((address)extra_data_limit() - (address)extra_data_base()); }\n+  int extra_data_size() const          { return (int)((address)extra_data_limit() - (address)limit_data_position()); }\n","filename":"src\/hotspot\/share\/oops\/methodData.hpp","additions":11,"deletions":3,"binary":false,"changes":14,"status":"modified"}]}