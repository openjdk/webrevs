{"files":[{"patch":"@@ -1416,0 +1416,56 @@\n+\/\/ vector unsigned integer max\/min\n+\n+instruct vmaxu(vReg dst, vReg src1, vReg src2) %{\n+  match(Set dst (UMaxV src1 src2));\n+  ins_cost(VEC_COST);\n+  format %{ \"vmaxu $dst, $src1, $src2\" %}\n+  ins_encode %{\n+    BasicType bt = Matcher::vector_element_basic_type(this);\n+    __ vsetvli_helper(bt, Matcher::vector_length(this));\n+    __ vmaxu_vv(as_VectorRegister($dst$$reg),\n+                as_VectorRegister($src1$$reg), as_VectorRegister($src2$$reg));\n+  %}\n+  ins_pipe(pipe_slow);\n+%}\n+\n+instruct vminu(vReg dst, vReg src1, vReg src2) %{\n+  match(Set dst (UMinV src1 src2));\n+  ins_cost(VEC_COST);\n+  format %{ \"vminu $dst, $src1, $src2\" %}\n+  ins_encode %{\n+    BasicType bt = Matcher::vector_element_basic_type(this);\n+    __ vsetvli_helper(bt, Matcher::vector_length(this));\n+    __ vminu_vv(as_VectorRegister($dst$$reg),\n+                as_VectorRegister($src1$$reg), as_VectorRegister($src2$$reg));\n+  %}\n+  ins_pipe(pipe_slow);\n+%}\n+\n+\/\/ vector unsigned integer max\/min - predicated\n+\n+instruct vmaxu_masked(vReg dst_src1, vReg src2, vRegMask_V0 v0) %{\n+  match(Set dst_src1 (UMaxV (Binary dst_src1 src2) v0));\n+  ins_cost(VEC_COST);\n+  format %{ \"vmaxu_masked $dst_src1, $dst_src1, $src2, $v0\" %}\n+  ins_encode %{\n+    BasicType bt = Matcher::vector_element_basic_type(this);\n+    __ vsetvli_helper(bt, Matcher::vector_length(this));\n+    __ vmaxu_vv(as_VectorRegister($dst_src1$$reg), as_VectorRegister($dst_src1$$reg),\n+                as_VectorRegister($src2$$reg), Assembler::v0_t);\n+  %}\n+  ins_pipe(pipe_slow);\n+%}\n+\n+instruct vminu_masked(vReg dst_src1, vReg src2, vRegMask_V0 v0) %{\n+  match(Set dst_src1 (UMinV (Binary dst_src1 src2) v0));\n+  ins_cost(VEC_COST);\n+  format %{ \"vminu_masked $dst_src1, $dst_src1, $src2, $v0\" %}\n+  ins_encode %{\n+    BasicType bt = Matcher::vector_element_basic_type(this);\n+    __ vsetvli_helper(bt, Matcher::vector_length(this));\n+    __ vminu_vv(as_VectorRegister($dst_src1$$reg), as_VectorRegister($dst_src1$$reg),\n+                as_VectorRegister($src2$$reg), Assembler::v0_t);\n+  %}\n+  ins_pipe(pipe_slow);\n+%}\n+\n","filename":"src\/hotspot\/cpu\/riscv\/riscv_v.ad","additions":56,"deletions":0,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -79,1 +79,1 @@\n-        applyIfCPUFeature = {\"avx\", \"true\"})\n+        applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -118,1 +118,1 @@\n-        applyIfCPUFeature = {\"avx\", \"true\"})\n+        applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -175,1 +175,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -200,1 +200,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -225,1 +225,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -250,1 +250,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -275,1 +275,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -300,1 +300,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -325,1 +325,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -350,1 +350,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -375,1 +375,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -400,1 +400,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -425,1 +425,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 2 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -450,1 +450,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -475,1 +475,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -500,1 +500,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -525,1 +525,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -550,1 +550,1 @@\n-    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx512vl\", \"true\", \"sve\", \"true\"})\n+    @IR(counts = {IRNode.ADD_VI, IRNode.VECTOR_SIZE_ANY, \" 3 \"}, applyIfCPUFeatureOr = {\"avx512vl\", \"true\", \"sve\", \"true\", \"rvv\", \"true\"})\n@@ -578,1 +578,1 @@\n-    @IR(counts = {IRNode.UMAX_VI, IRNode.VECTOR_SIZE_ANY, \" 1 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VI, IRNode.VECTOR_SIZE_ANY, \" 1 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -603,1 +603,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, IRNode.VECTOR_SIZE_ANY, \" 1 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, IRNode.VECTOR_SIZE_ANY, \" 1 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/VectorCommutativeOperSharingTest.java","additions":20,"deletions":20,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -108,1 +108,1 @@\n-    @IR(counts = {IRNode.UMAX_VB, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VB, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -131,1 +131,1 @@\n-    @IR(counts = {IRNode.UMAX_VS, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VS, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -154,1 +154,1 @@\n-    @IR(counts = {IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -177,1 +177,1 @@\n-    @IR(counts = {IRNode.UMAX_VL, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VL, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -200,1 +200,1 @@\n-    @IR(counts = {IRNode.UMIN_VB, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VB, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -223,1 +223,1 @@\n-    @IR(counts = {IRNode.UMIN_VS, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VS, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -246,1 +246,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -269,1 +269,1 @@\n-    @IR(counts = {IRNode.UMIN_VL, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VL, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -292,1 +292,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, \" 0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, \" 0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -315,1 +315,1 @@\n-    @IR(counts = {IRNode.UMAX_VI, \" 0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VI, \" 0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -338,1 +338,1 @@\n-    @IR(counts = {IRNode.UMAX_VI, \" 0 \", IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VI, \" 0 \", IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -365,1 +365,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -392,1 +392,1 @@\n-    @IR(counts = {IRNode.UMAX_VI, \" 0 \", IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMAX_VI, \" 0 \", IRNode.UMIN_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -419,1 +419,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n@@ -446,1 +446,1 @@\n-    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.UMIN_VI, \" 0 \", IRNode.UMAX_VI, \" >0 \"}, applyIfCPUFeatureOr = {\"avx\", \"true\", \"rvv\", \"true\"})\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/VectorUnsignedMinMaxOperationsTest.java","additions":15,"deletions":15,"binary":false,"changes":30,"status":"modified"}]}