{"files":[{"patch":"@@ -3,1 +3,1 @@\n-#  Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,5 +27,11 @@\n-for module in $@\n-do\n-    file=${module\/\/.\/_}.java\n-    echo creating $file for $module...\n-    cat > $file <<EOF\n+# generates a wrapper file\n+# arguments:\n+#   $1 - file number. Like '_2' (can be empty)\n+#   $2 - classes range in perecents. Like ' 0% 50%' (can be empty)\n+generate_file() {\n+    local full_name=${file}${1}.java\n+    echo creating $full_name for $module...\n+\n+    [[ -z $2 ]] && scope_str=\"all\" || scope_str=\"some\"\n+\n+    cat > ${full_name} <<EOF\n@@ -33,1 +39,1 @@\n- * Copyright (c) 2017, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, ${YEAR}, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,1 +63,1 @@\n- * @summary run CTW for all classes from $module module\n+ * @summary run CTW for ${scope_str} classes from $module module\n@@ -68,1 +74,1 @@\n- * @run driver\/timeout=7200 sun.hotspot.tools.ctw.CtwRunner modules:$module\n+ * @run driver\/timeout=7200 sun.hotspot.tools.ctw.CtwRunner modules:${module}${2}\n@@ -71,0 +77,33 @@\n+}\n+\n+if [ \"$#\" -eq 0 ]; then\n+    echo \"No arguments given, scanning open\/src for modules\"\n+    MODULES=$(find ..\/..\/..\/..\/..\/..\/src -name module-info.java | \\\n+        grep share\/classes\/module-info.java |                         `# only standard modules are taken` \\\n+        sed 's\/.*src\\\/\/\/' | sed 's\/\\\/.*\/\/')                            # cleaning the module name of leading and trailing paths\n+else\n+    echo \"Using provided arguments as module(s) list\"\n+    MODULES=$@\n+fi\n+\n+YEAR=$(date +%Y)\n+\n+for module in $MODULES\n+do\n+    file=${module\/\/.\/_}\n+\n+    case $module in\n+        # Those are too large, we split them into 2 wrappers\n+        \"java.base\")      generate_file \"\" \" 0% 50%\"; generate_file \"_2\" \" 50% 100%\" ;;\n+        \"java.desktop\")   generate_file \"\" \" 0% 50%\"; generate_file \"_2\" \" 50% 100%\" ;;\n+        \"jdk.localedata\") generate_file \"\" \" 0% 50%\"; generate_file \"_2\" \" 50% 100%\" ;;\n+\n+        # Those have no classes (needs to be checked on re-generations)!\n+        \"jdk.jdwp.agent\") ;;\n+        \"jdk.graal.compiler\") ;;\n+        \"jdk.graal.compiler.management\") ;;\n+        \"jdk.crypto.ec\") ;;\n+        \"java.se\") ;;\n+\n+        # a more-or-less \"standard\" module\n+        *) generate_file \"\" \"\"\n@@ -72,0 +111,1 @@\n+    esac\n","filename":"test\/hotspot\/jtreg\/applications\/ctw\/modules\/generate.bash","additions":49,"deletions":9,"binary":false,"changes":58,"status":"modified"}]}