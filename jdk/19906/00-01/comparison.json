{"files":[{"patch":"@@ -277,2 +277,0 @@\n-        labels = labels.clone();\n-\n@@ -280,1 +278,10 @@\n-        labels = Stream.of(labels).map(l -> convertEnumConstants(lookup, enumClass, l)).toArray();\n+        boolean constantsOnly = true;\n+        int len = labels.length;\n+\n+        for (int i = 0; i < len; i++) {\n+            Object convertedLabel =\n+                    convertEnumConstants(lookup, enumClass, labels[i]);\n+            labels[i] = convertedLabel;\n+            constantsOnly &=\n+                    EnumDesc.class.isAssignableFrom(convertedLabel.getClass());\n+        }\n@@ -283,1 +290,0 @@\n-        boolean constantsOnly = Stream.of(labels).allMatch(l -> EnumDesc.class.isAssignableFrom(l.getClass()));\n@@ -336,1 +342,1 @@\n-                                                                      enumClass,\n+                                                                      Enum.class,\n@@ -343,1 +349,1 @@\n-            return (int) generatedSwitch.invoke(value, restartIndex);\n+            return (int) generatedSwitch.invokeExact(value, restartIndex);\n@@ -424,1 +430,1 @@\n-        public volatile int[] constantsMap;\n+        public int[] constantsMap;\n@@ -426,1 +432,1 @@\n-        public volatile MethodHandle generatedSwitch;\n+        public MethodHandle generatedSwitch;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/SwitchBootstraps.java","additions":14,"deletions":8,"binary":false,"changes":22,"status":"modified"}]}