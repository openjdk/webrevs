{"files":[{"patch":"@@ -62,1 +62,1 @@\n-  friend class AsyncLogTest_logBuffer_vm_Test;\n+  friend class AsyncLogTest_logBuffer__vm_Test;\n","filename":"src\/hotspot\/share\/logging\/logAsyncWriter.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,2 +34,3 @@\n-  friend class LogStreamTest_TestLineBufferAllocation_vm_Test;\n-  friend class LogStreamTest_TestLineBufferAllocationCap_vm_Test;\n+  \/\/ see test\/hotspot\/gtest\/logging\/test_logStream.cpp\n+  friend class LogStreamTest_TestLineBufferAllocation__vm_Test;\n+  friend class LogStreamTest_TestLineBufferAllocationCap__vm_Test;\n@@ -88,3 +89,0 @@\n-  \/\/ see test\/hotspot\/gtest\/logging\/test_logStream.cpp\n-  friend class LogStreamTest_TestLineBufferAllocation_vm_Test;\n-  friend class LogStreamTest_TestLineBufferAllocationCap_vm_Test;\n","filename":"src\/hotspot\/share\/logging\/logStream.hpp","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -106,1 +106,1 @@\n-  return is_suffix(\"_vm\", name) && !is_suffix(\"_other_vm\", name);\n+  return is_suffix(\"__vm\", name);\n@@ -237,2 +237,2 @@\n-    const char* const othervm_suffix = \"_other_vm\"; \/\/ TEST_OTHER_VM\n-    const char* const vmassert_suffix = \"_vm_assert\"; \/\/ TEST_VM_ASSERT(_MSG)\n+    const char* const othervm_suffix = \"__other_vm\"; \/\/ TEST_OTHER_VM\n+    const char* const vmassert_suffix = \"__vm_assert\"; \/\/ TEST_VM_ASSERT(_MSG)\n","filename":"test\/hotspot\/gtest\/gtestMain.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -33,0 +33,1 @@\n+#define GTEST_DONT_DEFINE_TEST_F 1\n@@ -57,0 +58,2 @@\n+\n+#include <string_view>\n@@ -68,0 +71,10 @@\n+constexpr bool gtest_check_valid_test_name(std::string_view name) {\n+  auto ends_with = [&](std::string_view other) {\n+    return name.size() >= other.size() &&\n+           name.compare(name.size() - other.size(), std::string_view::npos, other) == 0;\n+  };\n+\n+  \/\/ Test names are not allowed to end in `_`, `__vm`, `__other_vm` or `__vm_assert`\n+  return !ends_with(\"_\") && !ends_with(\"__vm\") && !ends_with(\"__other_vm\") && !ends_with(\"__vm_assert\");\n+}\n+\n@@ -70,1 +83,5 @@\n-#define TEST(category, name) GTEST_TEST(category, name)\n+#define HS_GTEST_CHECK_NAME(name) static_assert(gtest_check_valid_test_name(#name));\n+\n+#define TEST(category, name) HS_GTEST_CHECK_NAME(name) GTEST_TEST(category, name)\n+\n+#define TEST_F(category, name) HS_GTEST_CHECK_NAME(name) GTEST_TEST_F(category, name)\n@@ -72,1 +89,1 @@\n-#define TEST_VM(category, name) GTEST_TEST(category, CONCAT(name, _vm))\n+#define TEST_VM(category, name) HS_GTEST_CHECK_NAME(name) GTEST_TEST(category, CONCAT(name, __vm))\n@@ -74,3 +91,1 @@\n-#define TEST_VM_F(test_fixture, name)                               \\\n-  GTEST_TEST_(test_fixture, name ## _vm, test_fixture,              \\\n-              ::testing::internal::GetTypeId<test_fixture>())\n+#define TEST_VM_F(test_fixture, name) HS_GTEST_CHECK_NAME(name) GTEST_TEST_F(test_fixture, CONCAT(name, __vm))\n@@ -97,1 +112,1 @@\n-  TEST(category, CONCAT(name, _other_vm)) {                         \\\n+  GTEST_TEST(category, CONCAT(name, __other_vm)) {                  \\\n@@ -115,1 +130,1 @@\n-  TEST(category, CONCAT(name, _vm_assert)) {                        \\\n+  GTEST_TEST(category, CONCAT(name, __vm_assert)) {                 \\\n@@ -137,1 +152,1 @@\n-  TEST(category, CONCAT(name, _vm_assert)) {                        \\\n+  GTEST_TEST(category, CONCAT(name, __vm_assert)) {                 \\\n@@ -158,1 +173,1 @@\n-  TEST(category, CONCAT(name, _vm_assert)) {                        \\\n+  GTEST_TEST(category, CONCAT(name, __vm_assert)) {                 \\\n@@ -175,1 +190,1 @@\n-  TEST(category, CONCAT(name, _vm_assert)) {                        \\\n+  GTEST_TEST(category, CONCAT(name, __vm_assert)) {                 \\\n","filename":"test\/hotspot\/gtest\/unittest.hpp","additions":25,"deletions":10,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -80,1 +80,1 @@\n-        var filter = Stream.concat(Stream.of(\"--gtest_filter=-*_vm:*_vm_assert\"),\n+        var filter = Stream.concat(Stream.of(\"--gtest_filter=-*__vm:*__other_vm:*__vm_assert\"),\n","filename":"test\/hotspot\/jtreg\/gtest\/AllNotVMGtest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -54,3 +54,1 @@\n-        TF(\"istream.coverage_vm\"),\n-        \/\/ JDK-8372243\n-        TF(\"ZForwardingTest.find_every_other_vm\"),\n+        TF(\"istream.coverage__vm\"),\n","filename":"test\/hotspot\/jtreg\/gtest\/CheckGtestDependencies.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-        TF(\"LogTagSet.defaults_vm\"),\n+        TF(\"LogTagSet.defaults__vm\"),\n","filename":"test\/hotspot\/jtreg\/gtest\/CheckShuffledGtest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}