{"files":[{"patch":"@@ -817,16 +817,1 @@\n-  \/\/ Create input type (domain)\n-  int argcnt = NOT_LP64(3) LP64_ONLY(4);\n-  const Type** const domain_fields = TypeTuple::fields(argcnt);\n-  int argp = TypeFunc::Parms;\n-  domain_fields[argp++] = TypeInstPtr::NOTNULL;  \/\/ src\n-  domain_fields[argp++] = TypeInstPtr::NOTNULL;  \/\/ dst\n-  domain_fields[argp++] = TypeX_X;               \/\/ size lower\n-  LP64_ONLY(domain_fields[argp++] = Type::HALF); \/\/ size upper\n-  assert(argp == TypeFunc::Parms+argcnt, \"correct decoding\");\n-  const TypeTuple* const domain = TypeTuple::make(TypeFunc::Parms + argcnt, domain_fields);\n-\n-  \/\/ Create result type (range)\n-  const Type** const range_fields = TypeTuple::fields(0);\n-  const TypeTuple* const range = TypeTuple::make(TypeFunc::Parms + 0, range_fields);\n-\n-  return TypeFunc::make(domain, range);\n+  return OptoRuntime::clone_type_Type();\n","filename":"src\/hotspot\/share\/gc\/shared\/c2\/barrierSetC2.cpp","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -522,1 +522,21 @@\n-const TypeFunc* ShenandoahBarrierSetC2::write_barrier_pre_Type() {\n+const TypeFunc* ShenandoahBarrierSetC2::_write_barrier_pre_Type              = nullptr;\n+const TypeFunc* ShenandoahBarrierSetC2::_clone_barrier_Type                  = nullptr;\n+const TypeFunc* ShenandoahBarrierSetC2::_load_reference_barrier_Type         = nullptr;\n+\n+inline const TypeFunc* ShenandoahBarrierSetC2::write_barrier_pre_Type() {\n+  assert(ShenandoahBarrierSetC2::_write_barrier_pre_Type != nullptr, \"should be initialized\");\n+  return ShenandoahBarrierSetC2::_write_barrier_pre_Type;\n+}\n+\n+inline const TypeFunc* ShenandoahBarrierSetC2::clone_barrier_Type() {\n+  assert(ShenandoahBarrierSetC2::_clone_barrier_Type != nullptr, \"should be initialized\");\n+  return ShenandoahBarrierSetC2::_clone_barrier_Type;\n+}\n+\n+const TypeFunc* ShenandoahBarrierSetC2::load_reference_barrier_Type() {\n+  assert(ShenandoahBarrierSetC2::_load_reference_barrier_Type != nullptr, \"should be initialized\");\n+  return ShenandoahBarrierSetC2::_load_reference_barrier_Type;\n+}\n+\n+void ShenandoahBarrierSetC2::make_write_barrier_pre_Type() {\n+  assert(ShenandoahBarrierSetC2::_write_barrier_pre_Type == nullptr, \"should be\");\n@@ -531,1 +551,1 @@\n-  return TypeFunc::make(domain, range);\n+  ShenandoahBarrierSetC2::_write_barrier_pre_Type = TypeFunc::make(domain, range);\n@@ -534,1 +554,2 @@\n-const TypeFunc* ShenandoahBarrierSetC2::clone_barrier_Type() {\n+void ShenandoahBarrierSetC2::make_clone_barrier_Type() {\n+  assert(ShenandoahBarrierSetC2::_clone_barrier_Type == nullptr, \"should be\");\n@@ -543,1 +564,1 @@\n-  return TypeFunc::make(domain, range);\n+  ShenandoahBarrierSetC2::_clone_barrier_Type = TypeFunc::make(domain, range);\n@@ -546,1 +567,2 @@\n-const TypeFunc* ShenandoahBarrierSetC2::load_reference_barrier_Type() {\n+void ShenandoahBarrierSetC2::make_load_reference_barrier_Type() {\n+  assert(ShenandoahBarrierSetC2::_load_reference_barrier_Type == nullptr, \"should be\");\n@@ -558,1 +580,1 @@\n-  return TypeFunc::make(domain, range);\n+  ShenandoahBarrierSetC2::_load_reference_barrier_Type = TypeFunc::make(domain, range);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/c2\/shenandoahBarrierSetC2.cpp","additions":28,"deletions":6,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -106,0 +106,1 @@\n+  static const TypeFunc* _write_barrier_pre_Type;\n@@ -107,0 +108,3 @@\n+  static void make_write_barrier_pre_Type();\n+\n+  static const TypeFunc* _clone_barrier_Type;\n@@ -108,0 +112,3 @@\n+  static void make_clone_barrier_Type();\n+\n+  static const TypeFunc* _load_reference_barrier_Type;\n@@ -109,0 +116,2 @@\n+  static void make_load_reference_barrier_Type();\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/c2\/shenandoahBarrierSetC2.hpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -268,0 +268,1 @@\n+const TypeFunc* OptoRuntime::_clone_type_Type                     = nullptr;\n@@ -2181,0 +2182,19 @@\n+static const TypeFunc* make_clone_type_Type() {\n+  \/\/ Create input type (domain)\n+  int argcnt = NOT_LP64(3) LP64_ONLY(4);\n+  const Type** const domain_fields = TypeTuple::fields(argcnt);\n+  int argp = TypeFunc::Parms;\n+  domain_fields[argp++] = TypeInstPtr::NOTNULL;  \/\/ src\n+  domain_fields[argp++] = TypeInstPtr::NOTNULL;  \/\/ dst\n+  domain_fields[argp++] = TypeX_X;               \/\/ size lower\n+  LP64_ONLY(domain_fields[argp++] = Type::HALF); \/\/ size upper\n+  assert(argp == TypeFunc::Parms+argcnt, \"correct decoding\");\n+  const TypeTuple* const domain = TypeTuple::make(TypeFunc::Parms + argcnt, domain_fields);\n+\n+  \/\/ Create result type (range)\n+  const Type** const range_fields = TypeTuple::fields(0);\n+  const TypeTuple* const range = TypeTuple::make(TypeFunc::Parms + 0, range_fields);\n+\n+  return TypeFunc::make(domain, range);\n+}\n+\n@@ -2346,0 +2366,1 @@\n+  _clone_type_Type                    = make_clone_type_Type();\n","filename":"src\/hotspot\/share\/opto\/runtime.cpp","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -202,0 +202,1 @@\n+  static const TypeFunc* _clone_type_Type;\n@@ -740,0 +741,5 @@\n+  static inline const TypeFunc* clone_type_Type() {\n+    assert(_clone_type_Type != nullptr, \"should be initialized\");\n+    return _clone_type_Type;\n+  }\n+\n","filename":"src\/hotspot\/share\/opto\/runtime.hpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,0 +31,3 @@\n+#if INCLUDE_SHENANDOAHGC\n+#include \"gc\/shenandoah\/c2\/shenandoahBarrierSetC2.hpp\"\n+#endif \/\/ INCLUDE_SHENANDOAHGC\n@@ -733,0 +736,6 @@\n+#if INCLUDE_SHENANDOAHGC\n+  ShenandoahBarrierSetC2::make_write_barrier_pre_Type();\n+  ShenandoahBarrierSetC2::make_clone_barrier_Type();\n+  ShenandoahBarrierSetC2::make_load_reference_barrier_Type();\n+#endif \/\/INCLUDE_SHENANDOAHGC\n+\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"}]}