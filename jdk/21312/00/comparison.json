{"files":[{"patch":"@@ -37,0 +37,3 @@\n+import java.security.AccessController;\n+import java.security.PrivilegedActionException;\n+import java.security.PrivilegedExceptionAction;\n@@ -62,0 +65,9 @@\n+    @SuppressWarnings(\"removal\")\n+    private static Optional<Path> readSymlinkPrivileged(final Path symlink) throws IOException {\n+      try {\n+        return AccessController.doPrivileged((PrivilegedExceptionAction<Optional<Path>>) () -> Optional.ofNullable(Files.readSymbolicLink(symlink)));\n+      } catch (PrivilegedActionException e) {\n+          if (e.getException() instanceof IOException ioe) throw ioe; else return Optional.empty();\n+      }\n+    }\n+\n@@ -63,1 +75,1 @@\n-        Path nsPath = null;\n+        Optional<Path> nsPath = Optional.empty();\n@@ -66,1 +78,1 @@\n-            nsPath = Files.readSymbolicLink(SELF.resolve(NS_MNT));\n+            nsPath = readSymlinkPrivileged(SELF.resolve(NS_MNT));\n@@ -68,1 +80,1 @@\n-            \/\/ do nothing\n+            \/\/ do nothing...\n@@ -70,1 +82,1 @@\n-            SELF_MNT_NS = Optional.ofNullable(nsPath);\n+            SELF_MNT_NS = nsPath;\n@@ -280,1 +292,1 @@\n-                targetMountNS = Optional.ofNullable(Files.readSymbolicLink(procPidPath.resolve(NS_MNT)));\n+                targetMountNS = readSymlinkPrivileged(procPidPath.resolve(NS_MNT));\n@@ -306,1 +318,1 @@\n-                curPidNS = Optional.ofNullable(Files.readSymbolicLink(procPidPath.resolve(NS_PID)));\n+                curPidNS = readSymlinkPrivileged(procPidPath.resolve(NS_PID));\n","filename":"src\/jdk.attach\/linux\/classes\/sun\/tools\/attach\/VirtualMachineImpl.java","additions":18,"deletions":6,"binary":false,"changes":24,"status":"modified"}]}