{"files":[{"patch":"@@ -26,0 +26,1 @@\n+import java.nio.file.DirectoryStream;\n@@ -151,0 +152,41 @@\n+\n+        Path legalDir = mainDirToScan.resolve(\"legal\");\n+        ArrayList<String> allowedEndingsLegalDir = new ArrayList<>();\n+        allowedEndingsLegalDir.add(\".md\");\n+        allowedEndingsLegalDir.add(\"ADDITIONAL_LICENSE_INFO\");\n+        allowedEndingsLegalDir.add(\"ASSEMBLY_EXCEPTION\");\n+        allowedEndingsLegalDir.add(\"LICENSE\");\n+\n+        \/\/ those MUST be in every subdir of the legal dir\n+        ArrayList<String> requiredFilesInLegalSubdirs = new ArrayList<>();\n+        requiredFilesInLegalSubdirs.add(\"ADDITIONAL_LICENSE_INFO\");\n+        requiredFilesInLegalSubdirs.add(\"ASSEMBLY_EXCEPTION\");\n+        requiredFilesInLegalSubdirs.add(\"LICENSE\");\n+\n+        if (Files.isDirectory(legalDir)) {\n+            System.out.println(\"Legal directory to scan:\" + legalDir);\n+            try (DirectoryStream<Path> stream = Files.newDirectoryStream(legalDir)) {\n+                for (Path subfolder : stream) {\n+                    if (Files.isDirectory(subfolder)) {\n+                        System.out.println(\"Checking legal dir subfolder for required files: \" + subfolder.getFileName());\n+\n+                        for (String fileName : requiredFilesInLegalSubdirs) {\n+                            Path filePath = subfolder.resolve(fileName);\n+                            if (Files.exists(filePath)) {\n+                                System.out.println(\"  Found \" + fileName);\n+                            } else {\n+                                System.out.println(\"  Missing \" + fileName);\n+                                throw new Error(\"legal dir scan for required files failed\");\n+                            }\n+                        }\n+                    }\n+                }\n+            }\n+\n+            boolean legalDirRes = scanFiles(legalDir, allowedEndingsLegalDir);\n+            if (legalDirRes) {\n+                System.out.println(\"Legal directory scan successful.\");\n+            } else {\n+                throw new Error(\"Legal dir scan failed\");\n+            }\n+        }\n","filename":"test\/jdk\/build\/CheckFiles.java","additions":42,"deletions":0,"binary":false,"changes":42,"status":"modified"}]}