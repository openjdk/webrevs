{"files":[{"patch":"@@ -43,1 +43,0 @@\n-    SET_SHARED_LIBRARY_MAPFILE='-Wl,-version-script=[$]1'\n@@ -52,1 +51,0 @@\n-      SET_SHARED_LIBRARY_MAPFILE='-Wl,-exported_symbols_list,[$]1'\n@@ -60,1 +58,0 @@\n-      SET_SHARED_LIBRARY_MAPFILE=''\n@@ -67,1 +64,0 @@\n-      SET_SHARED_LIBRARY_MAPFILE='-Wl,-version-script=[$]1'\n@@ -83,1 +79,0 @@\n-    SET_SHARED_LIBRARY_MAPFILE=''\n@@ -90,1 +85,0 @@\n-    SET_SHARED_LIBRARY_MAPFILE='-def:[$]1'\n@@ -96,1 +90,0 @@\n-  AC_SUBST(SET_SHARED_LIBRARY_MAPFILE)\n","filename":"make\/autoconf\/flags-cflags.m4","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -620,4 +620,0 @@\n-# Options to linker to specify a mapfile.\n-# (Note absence of := assignment, because we do not want to evaluate the macro body here)\n-SET_SHARED_LIBRARY_MAPFILE = @SET_SHARED_LIBRARY_MAPFILE@\n-\n","filename":"make\/autoconf\/spec.gmk.template","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -92,3 +92,0 @@\n-#   MAPFILE mapfile\n-#   USE_MAPFILE_FOR_SYMBOLS if true and this is a STATIC_BUILD, just copy the\n-#       mapfile for the output symbols file\n@@ -205,2 +202,0 @@\n-  else\n-    $$(eval $$(call SetupLinkingMicrosoft,$1))\n","filename":"make\/common\/NativeCompilation.gmk","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-\n@@ -52,8 +51,0 @@\n-  ifneq ($(DISABLE_MAPFILES), true)\n-    $1_REAL_MAPFILE := $$($1_MAPFILE)\n-  endif\n-\n-  ifneq ($$($1_REAL_MAPFILE), )\n-    $1_EXTRA_LDFLAGS += $(call SET_SHARED_LIBRARY_MAPFILE,$$($1_REAL_MAPFILE))\n-  endif\n-\n@@ -98,9 +89,1 @@\n-  # Generating a static library, ie object file archive.\n-  ifeq ($(STATIC_BUILD), true)\n-    ifeq ($$($1_USE_MAPFILE_FOR_SYMBOLS), true)\n-      STATIC_MAPFILE_DEP := $$($1_MAPFILE)\n-    endif\n-  endif\n-\n-  $1_TARGET_DEPS := $$($1_ALL_OBJS) $$($1_RES) $$($1_VARDEPS_FILE) \\\n-      $$(STATIC_MAPFILE_DEP)\n+  $1_TARGET_DEPS := $$($1_ALL_OBJS) $$($1_VARDEPS_FILE)\n@@ -139,22 +122,5 @@\n-          ifeq ($$($1_USE_MAPFILE_FOR_SYMBOLS), true)\n-\t    $(CP) $$($1_MAPFILE) $$(@D)\/$$(basename $$(@F)).symbols\n-          else\n-            # get the exported symbols from mapfiles and if there\n-            # is no mapfile, get them from the archive\n-\t    $(RM) $$(@D)\/$$(basename $$(@F)).symbols; \\\n-\t    if [ ! -z $$($1_MAPFILE) -a -e $$($1_MAPFILE) ]; then \\\n-\t      $(ECHO) \"Getting symbols from mapfile $$($1_MAPFILE)\"; \\\n-\t      $(AWK) '\/global:\/','\/local:\/' $$($1_MAPFILE) | \\\n-\t\t  $(SED) -e 's\/#.*\/\/;s\/global:\/\/;s\/local:\/\/;s\/\\;\/\/;s\/^[ \t]*\/_\/;\/^_$$$$\/d' | \\\n-\t\t  $(EGREP) -v \"JNI_OnLoad|JNI_OnUnload|Agent_OnLoad|Agent_OnUnload|Agent_OnAttach\" > \\\n-\t\t  $$(@D)\/$$(basename $$(@F)).symbols || true; \\\n-\t      $(NM) $(NMFLAGS) $$($1_TARGET) | $(GREP)  \" T \" | \\\n-\t\t  $(EGREP) \"JNI_OnLoad|JNI_OnUnload|Agent_OnLoad|Agent_OnUnload|Agent_OnAttach\" | \\\n-\t\t  $(CUT) -d ' ' -f 3 >>  $$(@D)\/$$(basename $$(@F)).symbols || true;\\\n-\t    else \\\n-\t      $(ECHO) \"Getting symbols from nm\"; \\\n-\t      $(NM) $(NMFLAGS) -m $$($1_TARGET) | $(GREP)  \"__TEXT\" | \\\n-\t\t  $(EGREP) -v \"non-external|private extern|__TEXT,__eh_frame\" | \\\n-\t\t  $(SED) -e  's\/.* \/\/' > $$(@D)\/$$(basename $$(@F)).symbols; \\\n-\t    fi\n-          endif\n+\t  $(RM) $$(@D)\/$$(basename $$(@F)).symbols; \\\n+\t  $(ECHO) \"Getting symbols from nm\"; \\\n+\t  $(NM) $(NMFLAGS) -m $$($1_TARGET) | $(GREP)  \"__TEXT\" | \\\n+\t      $(EGREP) -v \"non-external|private extern|__TEXT,__eh_frame\" | \\\n+\t      $(SED) -e  's\/.* \/\/' > $$(@D)\/$$(basename $$(@F)).symbols\n@@ -183,1 +149,1 @@\n-  $1_TARGET_DEPS := $$($1_ALL_OBJS) $$($1_REAL_MAPFILE) $$($1_VARDEPS_FILE)\n+  $1_TARGET_DEPS := $$($1_ALL_OBJS) $$($1_VARDEPS_FILE)\n","filename":"make\/common\/native\/Link.gmk","additions":7,"deletions":41,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -30,12 +30,0 @@\n-\n-################################################################################\n-define SetupLinkingMicrosoft\n-  ifneq ($(DISABLE_MAPFILES), true)\n-    $1_REAL_MAPFILE := $$($1_MAPFILE)\n-  endif\n-\n-  ifneq ($$($1_REAL_MAPFILE), )\n-    $1_EXTRA_LDFLAGS += $(call SET_SHARED_LIBRARY_MAPFILE,$$($1_REAL_MAPFILE))\n-  endif\n-endef\n-\n@@ -102,1 +90,1 @@\n-      $$($1_REAL_MAPFILE) $$($1_VARDEPS_FILE)\n+      $$($1_VARDEPS_FILE)\n","filename":"make\/common\/native\/LinkMicrosoft.gmk","additions":1,"deletions":13,"binary":false,"changes":14,"status":"modified"}]}