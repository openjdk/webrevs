[{"commit":{"message":"AArch64 SVE implementation for Arrays.sort\n\nThis patch adds an SVE implementation of primitive array sorting\n(Arrays.sort()) on AArch64 systems that support SVE. On non-SVE machines,\nwe fall back to the existing Java implementation.\n\nFor smaller arrays (length <= 64), we use insertion sort;\nfor larger arrays we use an SVE-vectorized quicksort partitioner\nfollowed by an odd-even transposition cleanup pass.\n\nThe SVE path is enabled by default for int type.\nFor float type, it is available through the experimental flag :\n\n-XX:+UnlockExperimentalVMOptions -XX:+UseSVELibSimdSortForFP\n\nWithout this flag being enabled, the default Java implementation would\nbe executed for floats (the flag is disabled by default).\n\nFloat is gated due to observed regressions on some small\/medium sizes.\nOn larger arrays, the SVE float path shows upto 1.47x speedup on\nNeoverse V2 and 2.12x on Neoverse V1.\n\nFollowing are the performance numbers for ArraysSort JMH benchmark -\n\nCase A: Ratio between the scores of master branch and\nUseSVELibSimdSortForFP flag disabled (which is the default).\nCase B: Ratio between the scores of master branch and\nUseSVELibSimdSortForFP flag enabled (the int numbers will be the same\nbut this now enables SVE vectorized sorting for floats).\n\nWe would want the ratios to be >= 1 to be at par or better than the\ndefault Java implementation (master branch).\n\nOn Neoverse V1:\n\nBenchmark                       (size)   Mode    Cnt    A       B\nArraysSort.floatParallelSort    10       avgt    3      0.98    0.98\nArraysSort.floatParallelSort    25       avgt    3      1.01    0.83\nArraysSort.floatParallelSort    50       avgt    3      0.99    0.55\nArraysSort.floatParallelSort    75       avgt    3      0.99    0.66\nArraysSort.floatParallelSort    100      avgt    3      0.98    0.66\nArraysSort.floatParallelSort    1000     avgt    3      1.00    0.84\nArraysSort.floatParallelSort    10000    avgt    3      1.03    1.52\nArraysSort.floatParallelSort    100000   avgt    3      1.03    1.46\nArraysSort.floatParallelSort    1000000  avgt    3      0.98    1.81\nArraysSort.floatSort            10       avgt    3      1.00    0.98\nArraysSort.floatSort            25       avgt    3      1.00    0.81\nArraysSort.floatSort            50       avgt    3      0.99    0.56\nArraysSort.floatSort            75       avgt    3      0.99    0.65\nArraysSort.floatSort            100      avgt    3      0.98    0.70\nArraysSort.floatSort            1000     avgt    3      0.99    0.84\nArraysSort.floatSort            10000    avgt    3      0.99    1.72\nArraysSort.floatSort            100000   avgt    3      1.00    1.94\nArraysSort.floatSort            1000000  avgt    3      1.00    2.13\nArraysSort.intParallelSort      10       avgt    3      1.08    1.08\nArraysSort.intParallelSort      25       avgt    3      1.04    1.05\nArraysSort.intParallelSort      50       avgt    3      1.29    1.30\nArraysSort.intParallelSort      75       avgt    3      1.16    1.16\nArraysSort.intParallelSort      100      avgt    3      1.07    1.07\nArraysSort.intParallelSort      1000     avgt    3      1.13    1.13\nArraysSort.intParallelSort      10000    avgt    3      1.49    1.38\nArraysSort.intParallelSort      100000   avgt    3      1.64    1.62\nArraysSort.intParallelSort      1000000  avgt    3      2.26    2.27\nArraysSort.intSort              10       avgt    3      1.08    1.08\nArraysSort.intSort              25       avgt    3      1.02    1.02\nArraysSort.intSort              50       avgt    3      1.25    1.25\nArraysSort.intSort              75       avgt    3      1.16    1.20\nArraysSort.intSort              100      avgt    3      1.07    1.07\nArraysSort.intSort              1000     avgt    3      1.12    1.13\nArraysSort.intSort              10000    avgt    3      1.94    1.95\nArraysSort.intSort              100000   avgt    3      1.86    1.86\nArraysSort.intSort              1000000  avgt    3      2.09    2.09\nOn Neoverse V2:\n\nBenchmark                       (size)   Mode    Cnt    A       B\nArraysSort.floatParallelSort    10       avgt    3      1.02    1.02\nArraysSort.floatParallelSort    25       avgt    3      0.97    0.71\nArraysSort.floatParallelSort    50       avgt    3      0.94    0.65\nArraysSort.floatParallelSort    75       avgt    3      0.96    0.82\nArraysSort.floatParallelSort    100      avgt    3      0.95    0.84\nArraysSort.floatParallelSort    1000     avgt    3      1.01    0.94\nArraysSort.floatParallelSort    10000    avgt    3      1.01    1.25\nArraysSort.floatParallelSort    100000   avgt    3      1.01    1.09\nArraysSort.floatParallelSort    1000000  avgt    3      1.00    1.10\nArraysSort.floatSort            10       avgt    3      1.02    1.00\nArraysSort.floatSort            25       avgt    3      0.99    0.76\nArraysSort.floatSort            50       avgt    3      0.97    0.66\nArraysSort.floatSort            75       avgt    3      1.01    0.83\nArraysSort.floatSort            100      avgt    3      1.00    0.85\nArraysSort.floatSort            1000     avgt    3      0.99    0.93\nArraysSort.floatSort            10000    avgt    3      1.00    1.28\nArraysSort.floatSort            100000   avgt    3      1.00    1.37\nArraysSort.floatSort            1000000  avgt    3      1.00    1.48\nArraysSort.intParallelSort      10       avgt    3      1.05    1.05\nArraysSort.intParallelSort      25       avgt    3      0.99    0.84\nArraysSort.intParallelSort      50       avgt    3      1.03    1.14\nArraysSort.intParallelSort      75       avgt    3      0.91    0.99\nArraysSort.intParallelSort      100      avgt    3      0.98    0.96\nArraysSort.intParallelSort      1000     avgt    3      1.32    1.30\nArraysSort.intParallelSort      10000    avgt    3      1.40    1.40\nArraysSort.intParallelSort      100000   avgt    3      1.00    1.04\nArraysSort.intParallelSort      1000000  avgt    3      1.15    1.14\nArraysSort.intSort              10       avgt    3      1.05    1.05\nArraysSort.intSort              25       avgt    3      1.03    1.03\nArraysSort.intSort              50       avgt    3      1.08    1.14\nArraysSort.intSort              75       avgt    3      0.88    0.98\nArraysSort.intSort              100      avgt    3      1.01    0.99\nArraysSort.intSort              1000     avgt    3      1.3     1.32\nArraysSort.intSort              10000    avgt    3      1.43    1.43\nArraysSort.intSort              100000   avgt    3      1.30    1.30\nArraysSort.intSort              1000000  avgt    3      1.37    1.37"},"files":[{"filename":"make\/modules\/java.base\/Lib.gmk"},{"filename":"src\/hotspot\/cpu\/aarch64\/globals_aarch64.hpp"},{"filename":"src\/hotspot\/cpu\/aarch64\/matcher_aarch64.hpp"},{"filename":"src\/hotspot\/cpu\/aarch64\/stubGenerator_aarch64.cpp"},{"filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64.cpp"},{"filename":"src\/hotspot\/share\/runtime\/stubRoutines.cpp"},{"filename":"src\/hotspot\/share\/runtime\/stubRoutines.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/pivot-selection.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/simdsort-support.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-common-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-config.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-linux-qsort.cpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-oet-sort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-qsort.hpp"}],"sha":"513b1f1d82cf43610d649e2d4669f0d718420986"},{"commit":{"message":"Prepare base for SVE implementation in libsimdsort\n\nSeparated the libsimdsort implementation for aarch64 and x86 in two\ndifferent folders under src\/java.base\/linux\/native\/libsimdsort which\nmight help in better future maintenance of AArch64 and x86\nimplementations.\n\nNew layout -\n\nsrc\/java.base\/linux\/native\/libsimdsort\/aarch64\/…\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/…\n\nMoved the following files into the libsimdsort\/x86 folder -\n\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-32bit-qsort.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-emu-funcs.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-linux-qsort.cpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-32bit-qsort.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-64bit-qsort.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-linux-qsort.cpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/simdsort-support.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/xss-common-includes.h\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/xss-common-qsort.h\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/xss-network-qsort.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/xss-optimal-networks.hpp\nsrc\/java.base\/linux\/native\/libsimdsort\/x86\/xss-pivot-selection.hpp\n\nCopied the following files from libsimdsort\/x86 to libsimdsort\/aarch64\nfolder -\n\nx86\/xss-pivot-selection.hpp -> aarch64\/pivot-selection.hpp\nx86\/simdsort-support.hpp -> aarch64\/simdsort-support.hpp\nx86\/xss-common-qsort.h -> aarch64\/sve-common-qsort.hpp\nx86\/avx2-linux-qsort.cpp -> aarch64\/sve-linux-qsort.cpp\nx86\/avx2-32bit-qsort.hpp -> aarch64\/sve-qsort.hpp"},"files":[{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/pivot-selection.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/simdsort-support.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-common-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-linux-qsort.cpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/aarch64\/sve-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-32bit-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-emu-funcs.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx2-linux-qsort.cpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-32bit-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-64bit-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/avx512-linux-qsort.cpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/simdsort-support.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/xss-common-includes.h"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/xss-common-qsort.h"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/xss-network-qsort.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/xss-optimal-networks.hpp"},{"filename":"src\/java.base\/linux\/native\/libsimdsort\/x86\/xss-pivot-selection.hpp"}],"sha":"901445f00aac85eea06a48ffcfb32e54f46cb6c3"}]