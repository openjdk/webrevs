{"files":[{"patch":"@@ -32,1 +32,1 @@\n- * @run main SerializableObjectMethodReferencesOnInterfaces\n+ * @compile\/ref=SerializableObjectMethodReferencesOnInterfaces.out -XDrawDiagnostics --debug=dumpLambdaDeserializationStats SerializableObjectMethodReferencesOnInterfaces.java\n@@ -37,10 +37,0 @@\n-import java.lang.classfile.ClassFile;\n-import java.lang.classfile.ClassModel;\n-import java.lang.classfile.CodeElement;\n-import java.lang.classfile.MethodModel;\n-import java.lang.classfile.instruction.ConstantInstruction;\n-import java.lang.classfile.instruction.InvokeInstruction;\n-import java.net.URL;\n-import java.nio.file.Path;\n-import java.nio.file.Paths;\n-import java.util.Iterator;\n@@ -50,4 +40,0 @@\n-    public static void main(String... args) throws Exception {\n-        new SerializableObjectMethodReferencesOnInterfaces().run();\n-    }\n-\n@@ -77,76 +63,0 @@\n-\n-    public void run() throws Exception {\n-        URL url =\n-                SerializableObjectMethodReferencesOnInterfaces.class.getResource(\n-                        \"SerializableObjectMethodReferencesOnInterfaces$Test.class\");\n-        Path file = Paths.get(url.toURI());\n-\n-        ClassModel cf = ClassFile.of().parse(file);\n-        String actual = printDeserializationTests(cf);\n-        String expected =\n-                \"\"\"\n-                getImplMethodKind 5\n-                getFunctionalInterfaceClass SerializableObjectMethodReferencesOnInterfaces$Test$F\n-                getFunctionalInterfaceMethodName apply\n-                getFunctionalInterfaceMethodSignature (Ljava\/lang\/Object;)Ljava\/lang\/Object;\n-                getImplClass java\/lang\/Object\n-                getImplMethodSignature ()I\n-                getImplMethodKind 5\n-                getFunctionalInterfaceClass SerializableObjectMethodReferencesOnInterfaces$Test$F\n-                getFunctionalInterfaceMethodName apply\n-                getFunctionalInterfaceMethodSignature (Ljava\/lang\/Object;)Ljava\/lang\/Object;\n-                getImplClass java\/lang\/Object\n-                getImplMethodSignature ()I\n-                getImplMethodKind 5\n-                getFunctionalInterfaceClass SerializableObjectMethodReferencesOnInterfaces$Test$F\n-                getFunctionalInterfaceMethodName apply\n-                getFunctionalInterfaceMethodSignature (Ljava\/lang\/Object;)Ljava\/lang\/Object;\n-                getImplClass java\/lang\/Enum\n-                getImplMethodSignature ()I\n-                getImplMethodKind 5\n-                getFunctionalInterfaceClass SerializableObjectMethodReferencesOnInterfaces$Test$F\n-                getFunctionalInterfaceMethodName apply\n-                getFunctionalInterfaceMethodSignature (Ljava\/lang\/Object;)Ljava\/lang\/Object;\n-                getImplClass java\/lang\/Object\n-                getImplMethodSignature ()I\n-                \"\"\";\n-        if (!actual.equals(expected)) {\n-            throw new AssertionError(\n-                    \"Unexpected deserialization tests, expected:\\n\"\n-                            + expected\n-                            + \"\\nactual:\\n\"\n-                            + actual);\n-        }\n-    }\n-\n-    private static String printDeserializationTests(ClassModel cf) {\n-        MethodModel m =\n-                cf.methods().stream()\n-                        .filter(\n-                                x ->\n-                                        x.methodName()\n-                                                .stringValue()\n-                                                .contentEquals(\"$deserializeLambda$\"))\n-                        .findFirst()\n-                        .get();\n-        Iterator<CodeElement> it = m.code().get().iterator();\n-        StringBuilder sb = new StringBuilder();\n-        while (it.hasNext()) {\n-            CodeElement curr = it.next();\n-            if (curr instanceof InvokeInstruction i\n-                    && i.method()\n-                            .owner()\n-                            .asInternalName()\n-                            .contentEquals(\"java\/lang\/invoke\/SerializedLambda\")) {\n-                CodeElement next = it.next();\n-                if (next instanceof ConstantInstruction c) {\n-                    sb.append(\n-                            i.method().name().stringValue()\n-                                    + \" \"\n-                                    + c.constantValue().toString()\n-                                    + \"\\n\");\n-                }\n-            }\n-        }\n-        return sb.toString();\n-    }\n","filename":"test\/langtools\/tools\/javac\/lambda\/SerializableObjectMethodReferencesOnInterfaces.java","additions":1,"deletions":91,"binary":false,"changes":92,"status":"modified"},{"patch":"@@ -0,0 +1,4 @@\n+SerializableObjectMethodReferencesOnInterfaces.java:57:33: compiler.note.lambda.deserialization.stat: SerializableObjectMethodReferencesOnInterfaces$Test$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 5, java\/lang\/Object, hashCode, ()I\n+SerializableObjectMethodReferencesOnInterfaces.java:58:33: compiler.note.lambda.deserialization.stat: SerializableObjectMethodReferencesOnInterfaces$Test$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 5, java\/lang\/Object, hashCode, ()I\n+SerializableObjectMethodReferencesOnInterfaces.java:59:32: compiler.note.lambda.deserialization.stat: SerializableObjectMethodReferencesOnInterfaces$Test$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 5, java\/lang\/Enum, hashCode, ()I\n+SerializableObjectMethodReferencesOnInterfaces.java:60:37: compiler.note.lambda.deserialization.stat: SerializableObjectMethodReferencesOnInterfaces$Test$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 5, java\/lang\/Object, hashCode, ()I\n","filename":"test\/langtools\/tools\/javac\/lambda\/SerializableObjectMethodReferencesOnInterfaces.out","additions":4,"deletions":0,"binary":false,"changes":4,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n-SerializableObjectMethods.java:60:35: compiler.note.lambda.deserialization.stat: SerializableObjectMethods$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 9, SerializableObjectMethods$I2, hashCode, ()I\n+SerializableObjectMethods.java:60:35: compiler.note.lambda.deserialization.stat: SerializableObjectMethods$F, apply, (Ljava\/lang\/Object;)Ljava\/lang\/Object;, 5, java\/lang\/Object, hashCode, ()I\n","filename":"test\/langtools\/tools\/javac\/lambda\/SerializableObjectMethods.out","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}