{"files":[{"patch":"@@ -45,1 +45,1 @@\n- *\n+ * <p>\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLAlgorithmConstraints.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -66,0 +66,1 @@\n+ * @run main\/othervm RsaSsaPssConstraints RsaSsa-Pss true\n@@ -72,1 +73,2 @@\n- * @run main\/othervm RsaSsaPssConstraints RsaSsa-Pss true\n+ * @run main\/othervm RsaSsaPssConstraints SHA384withRSA false\n+ * @run main\/othervm RsaSsaPssConstraints SHA384withECDSA false\n@@ -102,1 +104,0 @@\n-        var test = new RsaSsaPssConstraints(\"TLS\");\n@@ -104,0 +105,2 @@\n+        \/\/ Note: CertificateBuilder generates RSASSA-PSS certificate\n+        \/\/ signature using SHA-384 digest algorithm by default.\n@@ -105,2 +108,0 @@\n-                \/\/ CertificateBuilder generates RSASSA-PSS certificate\n-                \/\/ signature using SHA-384 digest algorithm.\n@@ -109,10 +110,18 @@\n-        if (fail) {\n-            runAndCheckException(test::run,\n-                    serverEx -> {\n-                        assertTrue(serverEx instanceof SSLHandshakeException);\n-                        assertEquals(serverEx.getMessage(),\n-                                \"(handshake_failure) \"\n-                                        + \"No available authentication scheme\");\n-                    });\n-        } else {\n-            test.run();\n+        for (String protocol : new String[]{\"TLS\", \"TLSv1.2\"}) {\n+            var test = new RsaSsaPssConstraints(protocol);\n+\n+            final String errorMsg = protocol.equals(\"TLSv1.2\") ?\n+                    \"no cipher suites in common\" :\n+                    \"No available authentication scheme\";\n+\n+            if (fail) {\n+                runAndCheckException(test::run,\n+                        serverEx -> {\n+                            assertTrue(\n+                                    serverEx instanceof SSLHandshakeException);\n+                            assertEquals(serverEx.getMessage(),\n+                                    \"(handshake_failure) \" + errorMsg);\n+                        });\n+            } else {\n+                test.run();\n+            }\n@@ -233,1 +242,0 @@\n-\n","filename":"test\/jdk\/sun\/security\/ssl\/SignatureScheme\/RsaSsaPssConstraints.java","additions":23,"deletions":15,"binary":false,"changes":38,"status":"modified"}]}