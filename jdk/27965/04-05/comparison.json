{"files":[{"patch":"@@ -1062,1 +1062,1 @@\n-  return _preimage_static_archive_dumped == 1;\n+  return AtomicAccess::load_acquire(&_preimage_static_archive_dumped) == 1;\n","filename":"src\/hotspot\/share\/cds\/aotMetaspace.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @summary Sanity test for DiagnosticCommand MBean ability to invoke AOT.end_recording\n+ * @requires vm.cds.supports.aot.class.linking\n@@ -30,0 +30,1 @@\n+ * @summary Sanity test for DiagnosticCommand MBean ability to invoke AOT.end_recording\n@@ -37,1 +38,0 @@\n-import java.io.IOException;\n@@ -98,1 +98,1 @@\n-                out.shouldNotContain(\"IOException occurred!\");\n+                out.shouldNotContain(\"Exception occurred!\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/aotCache\/DiagnosticCommandMBeanTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -32,0 +32,5 @@\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller -jar LingeredApp.jar\n+ *              jdk\/test\/lib\/apps\/LingeredApp\n+ *              jdk\/test\/lib\/apps\/LingeredApp$1\n+ *              jdk\/test\/lib\/apps\/LingeredApp$SteadyStateLock\n+ *              jdk\/test\/lib\/process\/OutputBuffer\n@@ -44,0 +49,5 @@\n+        test(false);\n+        test(true);\n+    }\n+\n+    static void test(boolean isTraining) throws Exception {\n@@ -48,1 +58,9 @@\n-            LingeredApp.startApp(theApp);\n+            if (isTraining) {\n+                LingeredApp.startApp(theApp,\n+                                     \"-cp\", \"LingeredApp.jar\",\n+                                     \"-XX:AOTMode=record\",\n+                                     \"-XX:AOTConfiguration=LingeredApp.aotconfig\");\n+            } else {\n+                LingeredApp.startApp(theApp,\n+                                     \"-cp\", \"LingeredApp.jar\");\n+            }\n@@ -57,1 +75,6 @@\n-                output.shouldContain(\"AOT.end_recording is unsupported\");\n+                if (isTraining) {\n+                    output.shouldContain(\"Recording ended successfully\");\n+                } else {\n+                    \/\/ this message is output when the VM is not recording AOT data\n+                    output.shouldContain(\"AOT.end_recording is unsupported\");\n+                }\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/aotCache\/JcmdAOTEndRecordingTest.java","additions":25,"deletions":2,"binary":false,"changes":27,"status":"modified"}]}