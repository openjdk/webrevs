{"files":[{"patch":"@@ -37,1 +37,0 @@\n-import java.lang.classfile.FieldBuilder;\n@@ -42,1 +41,0 @@\n-import java.lang.constant.DynamicConstantDesc;\n@@ -54,1 +52,1 @@\n-import java.lang.classfile.constantpool.MethodRefEntry;\n+\n@@ -58,2 +56,0 @@\n-import static java.lang.invoke.MethodHandles.Lookup.ClassOption.NESTMATE;\n-import static java.lang.invoke.MethodHandles.Lookup.ClassOption.STRONG;\n@@ -64,0 +60,1 @@\n+import jdk.internal.vm.annotation.Stable;\n@@ -74,1 +71,1 @@\n-    private static final String[] EMPTY_STRING_ARRAY = new String[0];\n+    private static final @Stable String[] ARG_NAME_CACHE = {\"arg$1\", \"arg$2\", \"arg$3\", \"arg$4\", \"arg$5\", \"arg$6\", \"arg$7\", \"arg$8\"};\n@@ -99,1 +96,0 @@\n-    private final String[] argNames;                 \/\/ Generated names for the constructor arguments\n@@ -177,0 +173,2 @@\n+        ClassDesc[] argDescs;\n+        MethodTypeDesc constructorTypeDesc;\n@@ -178,1 +176,0 @@\n-            argNames = new String[parameterCount];\n@@ -181,1 +178,0 @@\n-                argNames[i] = \"arg$\" + (i + 1);\n@@ -184,0 +180,1 @@\n+            constructorTypeDesc = MethodTypeDescImpl.ofValidated(CD_void, argDescs);\n@@ -185,1 +182,0 @@\n-            argNames = EMPTY_STRING_ARRAY;\n@@ -187,0 +183,1 @@\n+            constructorTypeDesc = MTD_void;\n@@ -188,1 +185,6 @@\n-        constructorTypeDesc = MethodTypeDescImpl.ofValidated(CD_void, argDescs);\n+        this.argDescs = argDescs;\n+        this.constructorTypeDesc = constructorTypeDesc;\n+    }\n+\n+    private static String argName(int i) {\n+        return i < ARG_NAME_CACHE.length ? ARG_NAME_CACHE[i] :  \"arg$\" + (i + 1);\n@@ -316,1 +318,1 @@\n-                    clb.withField(argNames[i], argDescs[i], ACC_PRIVATE | ACC_FINAL);\n+                    clb.withField(argName(i), argDescs[i], ACC_PRIVATE | ACC_FINAL);\n@@ -399,1 +401,1 @@\n-                               .putfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argNames[i], argDescs[i])));\n+                               .putfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argName(i), argDescs[i])));\n@@ -451,1 +453,1 @@\n-                               .getfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argNames[i], argDescs[i])));\n+                               .getfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argName(i), argDescs[i])));\n@@ -508,1 +510,1 @@\n-                for (int i = 0; i < argNames.length; i++) {\n+                for (int i = 0; i < argDescs.length; i++) {\n@@ -510,1 +512,1 @@\n-                       .getfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argNames[i], argDescs[i])));\n+                       .getfield(pool.fieldRefEntry(lambdaClassEntry, pool.nameAndTypeEntry(argName(i), argDescs[i])));\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/InnerClassLambdaMetafactory.java","additions":18,"deletions":16,"binary":false,"changes":34,"status":"modified"}]}