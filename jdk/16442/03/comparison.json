{"files":[{"patch":"@@ -387,1 +387,1 @@\n-    private static List<String> addTestThreadFactoryArgs(String testThreadFactoryName, List<String> command) {\n+    private static String[] addTestThreadFactoryArgs(String testThreadFactoryName, String[] commandArgs) {\n@@ -401,1 +401,1 @@\n-        for (String cmd : command) {\n+        for (String cmd : commandArgs) {\n@@ -413,1 +413,1 @@\n-                return command;\n+                return commandArgs;\n@@ -431,1 +431,1 @@\n-                return command;\n+                return commandArgs;\n@@ -441,1 +441,1 @@\n-        return args;\n+        return args.toArray(String[]::new);\n@@ -463,6 +463,1 @@\n-        String testThreadFactoryName = System.getProperty(\"test.thread.factory\");\n-        if (testThreadFactoryName != null) {\n-            args.addAll(addTestThreadFactoryArgs(testThreadFactoryName, Arrays.asList(command)));\n-        } else {\n-            Collections.addAll(args, command);\n-        }\n+        Collections.addAll(args, command);\n@@ -521,1 +516,6 @@\n-        return createJavaProcessBuilder(Utils.prependTestJavaOpts(command));\n+        String[] newCommand = Utils.prependTestJavaOpts(command);\n+        String testThreadFactoryName = System.getProperty(\"test.thread.factory\");\n+        if (testThreadFactoryName != null) {\n+            newCommand = addTestThreadFactoryArgs(testThreadFactoryName, newCommand);\n+        }\n+        return createJavaProcessBuilder(newCommand);\n","filename":"test\/lib\/jdk\/test\/lib\/process\/ProcessTools.java","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"}]}