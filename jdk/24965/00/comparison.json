{"files":[{"patch":"@@ -1326,2 +1326,3 @@\n-    int metadata_size = align_up(code_buffer->total_metadata_size(), wordSize);\n-    JVMCI_ONLY( _jvmci_data_size = 0; )\n+    uint16_t metadata_size;\n+    CHECKED_CAST(metadata_size, uint16_t, align_up(code_buffer->total_metadata_size(), wordSize));\n+    JVMCI_ONLY( _metadata_size = metadata_size; )\n@@ -1500,3 +1501,4 @@\n-    uint16_t metadata_size = (uint16_t)align_up(code_buffer->total_metadata_size(), wordSize);\n-    JVMCI_ONLY(CHECKED_CAST(_jvmci_data_size, uint16_t, align_up(compiler->is_jvmci() ? jvmci_data->size() : 0, oopSize)));\n-    int jvmci_data_size = 0 JVMCI_ONLY(+ _jvmci_data_size);\n+    uint16_t metadata_size;\n+    CHECKED_CAST(metadata_size, uint16_t, align_up(code_buffer->total_metadata_size(), wordSize));\n+    JVMCI_ONLY( _metadata_size = metadata_size; )\n+    int jvmci_data_size = 0 JVMCI_ONLY( + align_up(compiler->is_jvmci() ? jvmci_data->size() : 0, oopSize));\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -240,1 +240,3 @@\n-  uint16_t _jvmci_data_size;\n+  \/\/ _metadata_size is not specific to JVMCI. In the non-JVMCI case, it can be derived as:\n+  \/\/ _metadata_size = mutable_data_size - relocation_size\n+  uint16_t _metadata_size;\n@@ -540,2 +542,2 @@\n-  Metadata** metadata_end       () const { return (Metadata**) (mutable_data_end() - _jvmci_data_size); }\n-  address jvmci_data_begin      () const { return               mutable_data_end() - _jvmci_data_size; }\n+  Metadata** metadata_end       () const { return (Metadata**) (mutable_data_begin() + _relocation_size + _metadata_size); }\n+  address jvmci_data_begin      () const { return               mutable_data_begin() + _relocation_size + _metadata_size; }\n","filename":"src\/hotspot\/share\/code\/nmethod.hpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}