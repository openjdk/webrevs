{"files":[{"patch":"@@ -53,0 +53,1 @@\n+    static boolean verbose = false; \/\/ avoid too verbose output\n@@ -75,1 +76,2 @@\n-        assertThat(containsSubjectName(certificates, rootCASubjectName), \"Root CA not found \" + rootCASubjectName, certificates);\n+        assertThat(containsSubjectName(certificates, rootCASubjectName),\n+                \"Root CA not found \" + rootCASubjectName, certificates);\n@@ -78,1 +80,2 @@\n-        assertThat(containsSubjectName(certificates, intermediateCASubjectName), \"Intermediate CA not found \" + intermediateCASubjectName, certificates);\n+        assertThat(containsSubjectName(certificates, intermediateCASubjectName),\n+                \"Intermediate CA not found \" + intermediateCASubjectName, certificates);\n@@ -81,1 +84,6 @@\n-        assertThat(not(containsSubjectName(certificates, nonTrustedCASubjectName)), \"Non trusted CA found \" + nonTrustedCASubjectName, certificates);\n+        assertThat(not(containsSubjectName(certificates, nonTrustedCASubjectName)),\n+                \"Non trusted CA found \" + nonTrustedCASubjectName, certificates);\n+\n+        String nonTrustedIntermediateCASubjectName = \"CN=Non Trusted Example Intermediate CA,O=Example,C=US\";\n+        assertThat(not(containsSubjectName(certificates, nonTrustedIntermediateCASubjectName)),\n+                \"Non trusted intermediate CA found \" + nonTrustedIntermediateCASubjectName, certificates);\n@@ -189,1 +197,5 @@\n-            throw new AssertionError(message + \", subjects: \" + getSubjects(certificates));\n+            String errMessage = message;\n+            if (verbose) {\n+                errMessage += \", subjects: \" + getSubjects(certificates);\n+            }\n+            throw new AssertionError(errMessage);\n","filename":"test\/jdk\/java\/security\/KeyStore\/CheckMacOSKeyChainIntermediateCATrust.java","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -28,1 +28,17 @@\n-rm -f non-trusted-root.key root.key test-intermediate-ca.csr intermediate.key test-ca.srl\n+openssl genrsa -out non-trusted-intermediate.key 2048\n+openssl req -new -sha256 -nodes -key non-trusted-intermediate.key  \\\n+  -subj \"\/C=US\/O=Example\/CN=Non Trusted Example Intermediate CA\" -out non-trusted-intermediate-ca.csr\n+\n+openssl x509 -req \\\n+ -extensions v3_ca \\\n+ -extfile openssl.cnf \\\n+ -in non-trusted-intermediate-ca.csr \\\n+ -CA non-trusted-test-ca.pem \\\n+ -CAkey non-trusted-root.key \\\n+ -CAcreateserial \\\n+ -out non-trusted-intermediate-ca.pem \\\n+ -days 3650 \\\n+ -sha256\n+\n+rm -f non-trusted-root.key root.key test-intermediate-ca.csr intermediate.key test-ca.srl non-trusted-intermediate.key \\\n+  non-trusted-intermediate-ca.csr non-trusted-test-ca.srl\n","filename":"test\/jdk\/java\/security\/KeyStore\/generate-mac-os-intermediate-ca-certs.sh","additions":17,"deletions":1,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -0,0 +1,23 @@\n+-----BEGIN CERTIFICATE-----\n+MIIDyTCCArGgAwIBAgIUFqJJqie2b55pDsftOOBqkWJuX6owDQYJKoZIhvcNAQEL\n+BQAwQDELMAkGA1UEBhMCVVMxEDAOBgNVBAoMB0V4YW1wbGUxHzAdBgNVBAMMFk5v\n+biBUcnVzdGVkIEV4YW1wbGUgQ0EwHhcNMjUwMTI3MjEyNDM2WhcNMzUwMTI1MjEy\n+NDM2WjBNMQswCQYDVQQGEwJVUzEQMA4GA1UECgwHRXhhbXBsZTEsMCoGA1UEAwwj\n+Tm9uIFRydXN0ZWQgRXhhbXBsZSBJbnRlcm1lZGlhdGUgQ0EwggEiMA0GCSqGSIb3\n+DQEBAQUAA4IBDwAwggEKAoIBAQCszrhwXVvR5QkSOoIJg0S5Ij1CqAuYf+WS9Ym6\n+itSzk744j4P2pVd7rM+1SfUfVqY7dFoE7JSQBTw3i\/ruo7Zl\/USuXFZa93w6g3TB\n+g0sqA2N4UmNm5Y588Dd2cGIBZgNVvwQzsiG6zWdTppH0rL91hgy32M\/CGkVH6WaU\n+nK4xCe5PiheGkvJBn6OaeqWpG0K76fDWmucUzaMv0b+DmRQ4GsXbwloiKndchGzE\n+\/56EcHNAr1mgvnh+ADTXPKjEsHWv+1cQk4ql4Di53GvVJ\/n6eh6K8aGD10OyQlIL\n+Tk82LI+FxiPvRHF\/uBUjndgZsK9k\/txDm5VY1z4mpMCd2h1nAgMBAAGjga0wgaow\n+HQYDVR0OBBYEFIhW8ihXHrc2ywJqt9xZbrcYcNzlMHsGA1UdIwR0MHKAFAy\/+rvH\n+8b9QCumbjj7Q6+9hW9ImoUSkQjBAMQswCQYDVQQGEwJVUzEQMA4GA1UECgwHRXhh\n+bXBsZTEfMB0GA1UEAwwWTm9uIFRydXN0ZWQgRXhhbXBsZSBDQYIUQWptFePVwo9i\n+HM6KUT93F4mkQvYwDAYDVR0TBAUwAwEB\/zANBgkqhkiG9w0BAQsFAAOCAQEAfEsL\n+\/d07gw8xFs8hMTvXK\/5PKEw4WuxoytrWDfwIUJpWJBOjcCmlZnSmwdZ12PHQ1mB9\n+oHLr\/RZKxYYn2MP9GqDrFTV+wAAAiIw5eU92HQOmPEgXIYhzsvfm29qwR1tdiAQE\n+4tXc7Y3O2B1b7lcJGbhjAt+\/RkDcvT7Pi5jYd2F3apsKPo8GsC0zCsX\/t7SnOxhj\n+qmPsEsBphBfE\/dzqkow\/iVWPGjvaV2rOrspGOfjF+j+APJNqBuH05uFR7GGaQ2Fm\n+mhh+nWmmDod\/rJpQP5ToTdLeYki9DMsaJjqth1VF5rWUhOzfWczdOFD5szrxxJcV\n+L+iJJspxFIvQpS3Pgg==\n+-----END CERTIFICATE-----\n","filename":"test\/jdk\/java\/security\/KeyStore\/non-trusted-intermediate-ca.pem","additions":23,"deletions":0,"binary":false,"changes":23,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n-MIIDYTCCAkmgAwIBAgIUfsgXAir7EToLxt+9WCYfhfuiGt8wDQYJKoZIhvcNAQEL\n+MIIDYTCCAkmgAwIBAgIUQWptFePVwo9iHM6KUT93F4mkQvYwDQYJKoZIhvcNAQEL\n@@ -4,2 +4,2 @@\n-biBUcnVzdGVkIEV4YW1wbGUgQ0EwHhcNMjUwMTI2MjIyNDQzWhcNMzUwMTI0MjIy\n-NDQzWjBAMQswCQYDVQQGEwJVUzEQMA4GA1UECgwHRXhhbXBsZTEfMB0GA1UEAwwW\n+biBUcnVzdGVkIEV4YW1wbGUgQ0EwHhcNMjUwMTI3MjEyMzU4WhcNMzUwMTI1MjEy\n+MzU4WjBAMQswCQYDVQQGEwJVUzEQMA4GA1UECgwHRXhhbXBsZTEfMB0GA1UEAwwW\n@@ -7,14 +7,14 @@\n-AQoCggEBALQyfO8sEDsp7qDH8OWjotinxyjTNjJ0I0Cke8pPHU73wL18ZFV8OvoI\n-OGTcYGFjRjOnjKUDFT6qC4oupGh8+NSfslqNQ35l4nU1tYRB81QHfAyCMq3gSVoU\n-hgaZle9x2rJrawAkxLE8xMrOkmM0r805O7x+hu9Bj3PwxQ0ubN5cb3SFvBhhlkss\n-8q9qUfK9mLQavgfp\/U1WgtlnX4GP+HFAzthcz4ENagMpUuD1h9aDtFPNJREkTGhX\n-mh+U7zkVZjP9waN5p2monsZIsSLvrdAfnySBjceueHHOi9l\/OYUG3wayWvNmxnpV\n-RtI1Zs4l7qs\/mWGrqy4Fl2iwGZ3sy0UCAwEAAaNTMFEwHQYDVR0OBBYEFAY88dZY\n-+LJgqAqbFYtmGzqyyD1oMB8GA1UdIwQYMBaAFAY88dZY+LJgqAqbFYtmGzqyyD1o\n-MA8GA1UdEwEB\/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAGSr3ifbi5AX4EO\/\n-eN1CK+XKPgbnVI6NrtyZfjDja1RmbYPFcuRaSDdH\/8y3oHLhgJzyu\/vFtvMJps\/B\n-JslYlIZHxhSC2sSqg2FrA5JQZlNfDSF2pRqk0Gs9xQj+ZtGbmUj0c+aOB5edjD\/C\n-h0GIh0WL+WtKAl6VNI+urqYuiQ19CBPuF8OAMkpC\/MYQocAtGhsRrlsMtMApJcvX\n-NAzf+3a+eUyEZnpcj7fkpGuBsKS0giNWVVtyNXMOoHL3L1PBqbI7lIQdHiBdivTm\n-Cg+icgOLBXsouJzovjT1bNL3JTU3v7z2\/hYr0x5gC9yK\/rS79uVcpxvTU3gub8WB\n-HK1MYhc=\n+AQoCggEBAKMh6zqtUcvDLwQJTQcKX4XLQ65MrS81OXpzgajZmgd4vgdv\/1PtcXkR\n+Tzqpeyi137BSvn0VM3CM5e4YLHVwg7iarv92v+gEq+sZcErONbdIvHYGp4J9t+1o\n+YQHfFsGf1juJe6Ey2s4P10FdWLQN+3BMZXwAnaaGCXnYCixs7ocdIpbobUdRLasF\n+N0NRQ4BZk+vgmqcC69rB66bNUJhkb40mdcqf0aPCpWnd\/MHit\/NQ\/VXyAIEjllZk\n+i4Jd5aoouOvjI8a7Pp0z+GHFU4RwQjuFfbJvSyeQ5OL1PAn74amwLMnHF+FBJIuW\n+jwIWmPNDyU9I9WL2YEmi42xhc3R5XIkCAwEAAaNTMFEwHQYDVR0OBBYEFAy\/+rvH\n+8b9QCumbjj7Q6+9hW9ImMB8GA1UdIwQYMBaAFAy\/+rvH8b9QCumbjj7Q6+9hW9Im\n+MA8GA1UdEwEB\/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAHouuX960Xzb4M1m\n+QcNV6m7mAjZDdAlRkuTq3ba1dycH8hJrsT3uE3YNXEKiBIkGCYcX1KXomCgWNOdR\n+AFc10nV4GV0Com149kmD5oeBp9auqmaSPWTJQxyi7dj\/gjNGCfbjf\/GD3O1qmfqN\n+RjKQqluP0koXZjUqL3LJro91XNMDxcQH0CcDdhHv6R7Ob0UndaW1neIljo8U0JFx\n+yMA+pIua3QppElvynSBSlK5jSDmuVTLrRM401hx\/1isKAUmCoz9zuVzjygxt8bdL\n+gKu66Ze\/7RRUee2HxEOxkw53gYfBan+918UXd6feq3nC8A9g6v2L6M6\/UkWeTiLs\n+4KjanI4=\n","filename":"test\/jdk\/java\/security\/KeyStore\/non-trusted-test-ca.pem","additions":17,"deletions":17,"binary":false,"changes":34,"status":"modified"}]}