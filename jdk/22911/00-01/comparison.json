{"files":[{"patch":"@@ -37,2 +37,2 @@\n-import org.junit.jupiter.api.AfterEach;\n-import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n@@ -79,0 +79,3 @@\n+\n+        String nonTrustedCASubjectName = \"CN=Non Trusted Example CA,O=Example,C=US\";\n+        assertThat(not(containsSubjectName(certificates, nonTrustedCASubjectName)), \"Non trusted CA found \" + nonTrustedCASubjectName, certificates);\n@@ -81,2 +84,2 @@\n-    @BeforeEach\n-    public void setup() {\n+    @BeforeAll\n+    static void setup() {\n@@ -87,2 +90,2 @@\n-    @AfterEach\n-    public void cleanup() {\n+    @AfterAll\n+    static void cleanup() {\n@@ -105,0 +108,9 @@\n+        caPath = Path.of(\"%s\/%s\".formatted(DIR, \"non-trusted-test-ca.pem\"));\n+        args = List.of(\n+                \"\/usr\/bin\/security\",\n+                \"add-certificates\",\n+                \"-k\", loginKeyChain,\n+                caPath.toString()\n+        );\n+        executeProcess(args);\n+\n@@ -123,6 +135,4 @@\n-            int exitStatus = ProcessTools.executeProcess(params.toArray(new String[0])).getExitValue();\n-            if (exitStatus != 0) {\n-                fail(\"Process started with: \" + params + \" failed\");\n-            }\n-        } catch (Throwable e) {\n-            fail(e.getMessage());\n+            ProcessTools.executeProcess(params.toArray(new String[0]))\n+                    .shouldHaveExitValue(0);\n+        } catch (Exception e) {\n+            fail(\"Unexpected exception: \" + e);\n@@ -133,0 +143,9 @@\n+        executeProcess(\n+                List.of(\n+                        \"\/usr\/bin\/security\",\n+                        \"delete-certificate\",\n+                        \"-c\", \"Non Trusted Example CA\",\n+                        \"-t\"\n+                )\n+        );\n+\n@@ -152,0 +171,4 @@\n+    private static boolean not(boolean condition) {\n+        return !condition;\n+    }\n+\n","filename":"test\/jdk\/java\/security\/KeyStore\/CheckMacOSKeyChainIntermediateCATrust.java","additions":35,"deletions":12,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -25,1 +25,4 @@\n-rm -f root.key test-intermediate-ca.csr intermediate.key test-ca.srl\n+openssl genrsa -out non-trusted-root.key 2048\n+openssl req -x509 -sha256 -nodes -extensions v3_ca -key non-trusted-root.key -subj \"\/C=US\/O=Example\/CN=Non Trusted Example CA\" -days 3650 -out non-trusted-test-ca.pem\n+\n+rm -f non-trusted-root.key root.key test-intermediate-ca.csr intermediate.key test-ca.srl\n","filename":"test\/jdk\/java\/security\/KeyStore\/generate-mac-os-intermediate-ca-certs.sh","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -0,0 +1,21 @@\n+-----BEGIN CERTIFICATE-----\n+MIIDYTCCAkmgAwIBAgIUfsgXAir7EToLxt+9WCYfhfuiGt8wDQYJKoZIhvcNAQEL\n+BQAwQDELMAkGA1UEBhMCVVMxEDAOBgNVBAoMB0V4YW1wbGUxHzAdBgNVBAMMFk5v\n+biBUcnVzdGVkIEV4YW1wbGUgQ0EwHhcNMjUwMTI2MjIyNDQzWhcNMzUwMTI0MjIy\n+NDQzWjBAMQswCQYDVQQGEwJVUzEQMA4GA1UECgwHRXhhbXBsZTEfMB0GA1UEAwwW\n+Tm9uIFRydXN0ZWQgRXhhbXBsZSBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\n+AQoCggEBALQyfO8sEDsp7qDH8OWjotinxyjTNjJ0I0Cke8pPHU73wL18ZFV8OvoI\n+OGTcYGFjRjOnjKUDFT6qC4oupGh8+NSfslqNQ35l4nU1tYRB81QHfAyCMq3gSVoU\n+hgaZle9x2rJrawAkxLE8xMrOkmM0r805O7x+hu9Bj3PwxQ0ubN5cb3SFvBhhlkss\n+8q9qUfK9mLQavgfp\/U1WgtlnX4GP+HFAzthcz4ENagMpUuD1h9aDtFPNJREkTGhX\n+mh+U7zkVZjP9waN5p2monsZIsSLvrdAfnySBjceueHHOi9l\/OYUG3wayWvNmxnpV\n+RtI1Zs4l7qs\/mWGrqy4Fl2iwGZ3sy0UCAwEAAaNTMFEwHQYDVR0OBBYEFAY88dZY\n++LJgqAqbFYtmGzqyyD1oMB8GA1UdIwQYMBaAFAY88dZY+LJgqAqbFYtmGzqyyD1o\n+MA8GA1UdEwEB\/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAGSr3ifbi5AX4EO\/\n+eN1CK+XKPgbnVI6NrtyZfjDja1RmbYPFcuRaSDdH\/8y3oHLhgJzyu\/vFtvMJps\/B\n+JslYlIZHxhSC2sSqg2FrA5JQZlNfDSF2pRqk0Gs9xQj+ZtGbmUj0c+aOB5edjD\/C\n+h0GIh0WL+WtKAl6VNI+urqYuiQ19CBPuF8OAMkpC\/MYQocAtGhsRrlsMtMApJcvX\n+NAzf+3a+eUyEZnpcj7fkpGuBsKS0giNWVVtyNXMOoHL3L1PBqbI7lIQdHiBdivTm\n+Cg+icgOLBXsouJzovjT1bNL3JTU3v7z2\/hYr0x5gC9yK\/rS79uVcpxvTU3gub8WB\n+HK1MYhc=\n+-----END CERTIFICATE-----\n","filename":"test\/jdk\/java\/security\/KeyStore\/non-trusted-test-ca.pem","additions":21,"deletions":0,"binary":false,"changes":21,"status":"added"}]}