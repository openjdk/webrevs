{"files":[{"patch":"@@ -257,5 +257,1 @@\n-                    \/\/ We perform symlinks resolution on currentPath\n-                    \/\/ under the rationale that the person writing the\n-                    \/\/ original properties file is the one who decides\n-                    \/\/ where the relative includes should resolve.\n-                    path = currentPath.toRealPath().resolveSibling(path);\n+                    path = currentPath.resolveSibling(path);\n","filename":"src\/java.base\/share\/classes\/java\/security\/Security.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -123,1 +123,1 @@\n-        ExtraPropsFile extraFile = filesMgr.newExtraFile();\n+        ExtraPropsFile extraFile = filesMgr.newExtraFile(ExtraMode.FILE_URI);\n@@ -133,1 +133,1 @@\n-        ex.setExtraFile(extraFile, Executor.ExtraMode.FILE_URI, false);\n+        ex.setExtraFile(extraFile, false);\n@@ -155,1 +155,1 @@\n-        ExtraPropsFile extraFile = filesMgr.newExtraFile();\n+        ExtraPropsFile extraFile = filesMgr.newExtraFile(ExtraMode.HTTP_SERVED);\n@@ -163,1 +163,1 @@\n-        ex.setExtraFile(extraFile, Executor.ExtraMode.HTTP_SERVED, true);\n+        ex.setExtraFile(extraFile, true);\n@@ -168,2 +168,2 @@\n-            Executor.ExtraMode mode) throws Exception {\n-        ExtraPropsFile extraFile = filesMgr.newExtraFile();\n+            ExtraMode mode) throws Exception {\n+        ExtraPropsFile extraFile = filesMgr.newExtraFile(mode);\n@@ -175,1 +175,1 @@\n-        ex.setExtraFile(extraFile, mode, true);\n+        ex.setExtraFile(extraFile, true);\n@@ -181,1 +181,1 @@\n-        extraPropertiesByHelper(ex, filesMgr, Executor.ExtraMode.PATH_ABS);\n+        extraPropertiesByHelper(ex, filesMgr, ExtraMode.PATH_ABS);\n@@ -186,1 +186,1 @@\n-        extraPropertiesByHelper(ex, filesMgr, Executor.ExtraMode.PATH_REL);\n+        extraPropertiesByHelper(ex, filesMgr, ExtraMode.PATH_REL);\n@@ -190,2 +190,2 @@\n-            char specialChar, Executor.ExtraMode extraMode,\n-            boolean useRelativeIncludes) throws Exception {\n+            char specialChar, ExtraMode extraMode, boolean useRelativeIncludes)\n+            throws Exception {\n@@ -196,1 +196,1 @@\n-            extraFile = filesMgr.newExtraFile(\"extra\" + suffix);\n+            extraFile = filesMgr.newExtraFile(\"extra\" + suffix, extraMode);\n@@ -213,1 +213,1 @@\n-        ex.setExtraFile(extraFile, extraMode, false);\n+        ex.setExtraFile(extraFile, false);\n@@ -219,2 +219,1 @@\n-        specialCharsIncludes(ex, filesMgr, '\\u2022',\n-                Executor.ExtraMode.PATH_ABS, true);\n+        specialCharsIncludes(ex, filesMgr, '\\u2022', ExtraMode.PATH_ABS, true);\n@@ -225,2 +224,1 @@\n-        specialCharsIncludes(ex, filesMgr, '\\u2022',\n-                Executor.ExtraMode.FILE_URI, true);\n+        specialCharsIncludes(ex, filesMgr, '\\u2022', ExtraMode.FILE_URI, true);\n@@ -235,1 +233,1 @@\n-                Executor.ExtraMode.RAW_FILE_URI1, false);\n+                ExtraMode.RAW_FILE_URI1, false);\n@@ -244,1 +242,1 @@\n-                Executor.ExtraMode.RAW_FILE_URI2, false);\n+                ExtraMode.RAW_FILE_URI2, false);\n@@ -249,2 +247,1 @@\n-        specialCharsIncludes(ex, filesMgr, ' ',\n-                Executor.ExtraMode.PATH_ABS, true);\n+        specialCharsIncludes(ex, filesMgr, ' ', ExtraMode.PATH_ABS, true);\n@@ -255,2 +252,1 @@\n-        specialCharsIncludes(ex, filesMgr, ' ',\n-                Executor.ExtraMode.FILE_URI, true);\n+        specialCharsIncludes(ex, filesMgr, ' ', ExtraMode.FILE_URI, true);\n@@ -264,2 +260,1 @@\n-        specialCharsIncludes(ex, filesMgr, ' ',\n-                Executor.ExtraMode.RAW_FILE_URI1, false);\n+        specialCharsIncludes(ex, filesMgr, ' ', ExtraMode.RAW_FILE_URI1, false);\n@@ -273,2 +268,1 @@\n-        specialCharsIncludes(ex, filesMgr, ' ',\n-                Executor.ExtraMode.RAW_FILE_URI2, false);\n+        specialCharsIncludes(ex, filesMgr, ' ', ExtraMode.RAW_FILE_URI2, false);\n@@ -373,1 +367,1 @@\n-        ExtraPropsFile extraFile = filesMgr.newExtraFile();\n+        ExtraPropsFile extraFile = filesMgr.newExtraFile(ExtraMode.HTTP_SERVED);\n@@ -379,1 +373,1 @@\n-        ex.setExtraFile(extraFile, Executor.ExtraMode.HTTP_SERVED, true);\n+        ex.setExtraFile(extraFile, true);\n@@ -405,1 +399,1 @@\n-        ExtraPropsFile extraFile = filesMgr.newExtraFile();\n+        ExtraPropsFile extraFile = filesMgr.newExtraFile(ExtraMode.HTTP_SERVED);\n@@ -436,2 +430,1 @@\n-        ex.setExtraFile(\n-                filesMgr.newExtraFile(), Executor.ExtraMode.FILE_URI, true);\n+        ex.setExtraFile(filesMgr.newExtraFile(ExtraMode.FILE_URI), true);\n@@ -446,1 +439,0 @@\n-        final Path displayPath;\n@@ -448,1 +440,1 @@\n-        private Include(PropsFile propsFile, String value, Path displayPath) {\n+        private Include(PropsFile propsFile, String value) {\n@@ -451,1 +443,0 @@\n-            this.displayPath = displayPath;\n@@ -454,3 +445,2 @@\n-        static Include ofAbsolute(PropsFile propsFile) {\n-            return new Include(propsFile, propsFile.path.toString(),\n-                    propsFile.path);\n+        static Include of(PropsFile propsFile) {\n+            return new Include(propsFile, propsFile.path.toString());\n@@ -459,3 +449,2 @@\n-        static Include ofRelative(PropsFile propsFile, Path baseDir) {\n-            Path rel = baseDir.relativize(propsFile.path);\n-            return new Include(propsFile, rel.toString(), baseDir.resolve(rel));\n+        static Include of(PropsFile propsFile, String value) {\n+            return new Include(propsFile, value);\n@@ -464,2 +453,3 @@\n-        Include withNewValue(String newValue) {\n-            return new Include(propsFile, newValue, displayPath);\n+        void assertProcessed(OutputAnalyzer oa) {\n+            oa.shouldContain(\"processing include: '\" + value + \"'\");\n+            oa.shouldContain(\"finished processing \" + propsFile.displayPath);\n@@ -472,0 +462,1 @@\n+    protected Path displayPath;\n@@ -478,0 +469,1 @@\n+        this.displayPath = path;\n@@ -521,1 +513,1 @@\n-        addIncludeDefinition(Include.ofAbsolute(propsFile));\n+        addIncludeDefinition(Include.of(propsFile));\n@@ -525,1 +517,3 @@\n-        addIncludeDefinition(Include.ofRelative(propsFile, path.getParent()));\n+        Path rel = path.getParent().relativize(propsFile.path);\n+        addIncludeDefinition(Include.of(propsFile, rel.toString()));\n+        propsFile.displayPath = displayPath.getParent().resolve(rel);\n@@ -533,2 +527,1 @@\n-            oa.shouldContain(\"processing include: '\" + include.value + \"'\");\n-            oa.shouldContain(\"finished processing \" + include.displayPath);\n+            include.assertProcessed(oa);\n@@ -545,2 +538,1 @@\n-            oa.shouldContain(\"processing include: '\" + include.value + \"'\");\n-            oa.shouldContain(\"finished processing \" + include.displayPath);\n+            include.assertProcessed(oa);\n@@ -567,0 +559,4 @@\n+enum ExtraMode {\n+    HTTP_SERVED, FILE_URI, RAW_FILE_URI1, RAW_FILE_URI2, PATH_ABS, PATH_REL\n+}\n+\n@@ -568,0 +564,1 @@\n+    private static final Path CWD = Path.of(\".\").toAbsolutePath();\n@@ -569,0 +566,1 @@\n+    private final ExtraMode mode;\n@@ -571,1 +569,2 @@\n-    ExtraPropsFile(String fileName, URI url, Path path) throws IOException {\n+    ExtraPropsFile(String fileName, URI url, Path path, ExtraMode mode)\n+            throws IOException {\n@@ -574,0 +573,4 @@\n+        this.mode = mode;\n+        if (mode == ExtraMode.PATH_REL) {\n+            this.displayPath = CWD.relativize(path);\n+        }\n@@ -581,1 +584,1 @@\n-            include = include.withNewValue(\n+            include = Include.of(include.propsFile,\n@@ -589,0 +592,11 @@\n+    String getSysPropValue() {\n+        return switch (mode) {\n+            case HTTP_SERVED -> url.toString();\n+            case FILE_URI -> path.toUri().toString();\n+            case RAW_FILE_URI1 -> \"file:\" + path;\n+            case RAW_FILE_URI2 ->\n+                    \"file:\/\/\" + (path.startsWith(\"\/\") ? \"\" : \"\/\") + path;\n+            case PATH_ABS, PATH_REL -> displayPath.toString();\n+        };\n+    }\n+\n@@ -713,2 +727,2 @@\n-    ExtraPropsFile newExtraFile() throws IOException {\n-        return newExtraFile(\"extra.properties\");\n+    ExtraPropsFile newExtraFile(ExtraMode mode) throws IOException {\n+        return newExtraFile(\"extra.properties\", mode);\n@@ -717,1 +731,2 @@\n-    ExtraPropsFile newExtraFile(String extraFileName) throws IOException {\n+    ExtraPropsFile newExtraFile(String extraFileName, ExtraMode mode)\n+            throws IOException {\n@@ -722,1 +737,1 @@\n-                    return new ExtraPropsFile(fileName, uri, path);\n+                    return new ExtraPropsFile(fileName, uri, path, mode);\n@@ -768,3 +783,0 @@\n-    enum ExtraMode {\n-        HTTP_SERVED, FILE_URI, RAW_FILE_URI1, RAW_FILE_URI2, PATH_ABS, PATH_REL\n-    }\n@@ -780,1 +792,0 @@\n-    private static final Path CWD = Path.of(\".\").toAbsolutePath();\n@@ -823,2 +834,1 @@\n-    void setExtraFile(ExtraPropsFile extraPropsFile, ExtraMode mode,\n-            boolean overrideAll) {\n+    void setExtraFile(ExtraPropsFile extraPropsFile, boolean overrideAll) {\n@@ -827,10 +837,1 @@\n-        setRawExtraFile(switch (mode) {\n-            case HTTP_SERVED -> extraPropsFile.url.toString();\n-            case FILE_URI -> extraPropsFile.path.toUri().toString();\n-            case RAW_FILE_URI1 -> \"file:\" + extraPropsFile.path;\n-            case RAW_FILE_URI2 -> \"file:\/\/\" +\n-                    (extraPropsFile.path.startsWith(\"\/\") ? \"\" : \"\/\") +\n-                    extraPropsFile.path;\n-            case PATH_ABS -> extraPropsFile.path.toString();\n-            case PATH_REL -> CWD.relativize(extraPropsFile.path).toString();\n-        }, overrideAll);\n+        setRawExtraFile(extraPropsFile.getSysPropValue(), overrideAll);\n","filename":"test\/jdk\/java\/security\/Security\/ConfigFileTest.java","additions":73,"deletions":72,"binary":false,"changes":145,"status":"modified"}]}