{"files":[{"patch":"@@ -776,0 +776,2 @@\n+  \/\/ With +UseCompactObjectHeaders, the minimum filler size is only one word,\n+  \/\/ because both Klass* gets encoded in the mark-word.\n@@ -784,4 +786,0 @@\n-  if (UseCompactObjectHeaders) {\n-    \/\/ The gap is always equal to min-fill-size, so nothing to do.\n-    return;\n-  }\n@@ -794,1 +792,1 @@\n-  if (MinObjAlignment > 1) {\n+  if (MinObjAlignment >= checked_cast<int>(CollectedHeap::min_fill_size())) {\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -223,1 +223,1 @@\n-bool klass_is_sane(oop object) {\n+static bool klass_is_sane(oop object) {\n@@ -232,3 +232,1 @@\n-    if (!mark.is_forwarded()) {\n-      klass = mark.klass_without_asserts();\n-    } else {\n+    if (mark.is_forwarded()) {\n@@ -237,1 +235,1 @@\n-      klass = nullptr;\n+      return true;\n@@ -239,2 +237,2 @@\n-  } else {\n-    klass = object->klass_without_asserts();\n+\n+    return Metaspace::contains(mark.klass_without_asserts());\n@@ -242,1 +240,2 @@\n-  return klass == nullptr || Metaspace::contains(klass);\n+\n+  return Metaspace::contains(object->klass_without_asserts());\n","filename":"src\/hotspot\/share\/gc\/shared\/collectedHeap.cpp","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -282,0 +282,1 @@\n+  nonstatic_field(Klass,                       _prototype_header,                             markWord)                              \\\n","filename":"src\/hotspot\/share\/jvmci\/vmStructs_jvmci.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"oops\/klass.hpp\"\n","filename":"src\/hotspot\/share\/oops\/compressedKlass.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-\/\/ The hash (preceding nKlass) shall be a direct neighbor but not interleave\n+\/\/ The hash (preceding klass bits) shall be a direct neighbor but not interleave\n","filename":"src\/hotspot\/share\/oops\/markWord.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-  const narrowKlass nk = value() >> klass_shift;\n","filename":"src\/hotspot\/share\/oops\/markWord.inline.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}