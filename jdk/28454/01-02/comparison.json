{"files":[{"patch":"@@ -1076,1 +1076,2 @@\n-    private static int encodedLengthASCII(byte coder, byte[] value) {\n+    \/\/ This follows the implementation of encodeASCII\n+    private static int encodedLengthASCII(byte coder, byte[] val) {\n@@ -1078,1 +1079,1 @@\n-            return value.length;\n+            return val.length;\n@@ -1080,1 +1081,1 @@\n-        int len = value.length >> 1;\n+        int len = val.length >> 1;\n@@ -1083,1 +1084,1 @@\n-            char c = StringUTF16.getChar(value, i);\n+            char c = StringUTF16.getChar(val, i);\n@@ -1089,1 +1090,1 @@\n-                    Character.isLowSurrogate(StringUTF16.getChar(value, i + 1))) {\n+                    Character.isLowSurrogate(StringUTF16.getChar(val, i + 1))) {\n@@ -1491,0 +1492,1 @@\n+    \/\/ This follows the implementation of encodeUTF8\n@@ -1582,0 +1584,1 @@\n+    \/\/ This follows the implementation of encodeUTF8_UTF16\n@@ -2136,2 +2139,2 @@\n-     * @param cs the charset used to the compute the length\n-     * @return length in bytes of the string\n+     * @param cs the {@link Charset} used to the compute the length\n+     * @return the length in bytes of the given String encoded with the given {@link Charset}\n@@ -2150,1 +2153,1 @@\n-            return byteFor(value.length, coder);\n+            return bytesForCoder(value.length, coder);\n@@ -2155,1 +2158,4 @@\n-    private int byteFor(int length, int coder) {\n+    \/\/ For the BOM‑less UTF‑16 charsets, the byte length is 'length' for LATIN1,\n+    \/\/ and 'length << 1' for UTF-16. Lone surrogates get replaced with U+FFFD when\n+    \/\/ encoding to UTF‑16 by getBytes, and all of LATIN1 can be encoded in UTF‑16.\n+    private int bytesForCoder(int length, int coder) {\n","filename":"src\/java.base\/share\/classes\/java\/lang\/String.java","additions":15,"deletions":9,"binary":false,"changes":24,"status":"modified"}]}