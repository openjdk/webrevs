{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2022, 2025 Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 6797535 6889858 6891113 8013712 8011800 8014365 8280168\n+ * @bug 6797535 6889858 6891113 8013712 8011800 8014365 8280168 8373661\n@@ -28,0 +28,1 @@\n+ * @run junit BasicObjectsTest\n@@ -30,2 +31,13 @@\n-import java.util.*;\n-import java.util.function.*;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+import static org.junit.jupiter.api.Assertions.assertSame;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.fail;\n+import org.junit.jupiter.api.Test;\n+import java.util.Arrays;\n+import java.util.Objects;\n+import java.util.function.Function;\n+import java.util.function.Supplier;\n@@ -34,17 +46,0 @@\n-    public static void main(String... args) {\n-        int errors = 0;\n-        errors += testEquals();\n-        errors += testDeepEquals();\n-        errors += testHashCode();\n-        errors += testHash();\n-        errors += testToString();\n-        errors += testToString2();\n-        errors += testToIdentityString();\n-        errors += testCompare();\n-        errors += testRequireNonNull();\n-        errors += testIsNull();\n-        errors += testNonNull();\n-        errors += testNonNullOf();\n-        if (errors > 0 )\n-            throw new RuntimeException();\n-    }\n@@ -52,2 +47,2 @@\n-    private static int testEquals() {\n-        int errors = 0;\n+    @Test\n+    public void testEquals() {\n@@ -61,5 +56,1 @@\n-                if (result != expected) {\n-                    errors++;\n-                    System.err.printf(\"When equating %s to %s, got %b instead of %b%n.\",\n-                                      a, b, result, expected);\n-                }\n+                assertEquals(expected, result, \"testEquals\");\n@@ -67,1 +58,0 @@\n-        return errors;\n@@ -70,2 +60,2 @@\n-    private static int testDeepEquals() {\n-        int errors = 0;\n+    @Test\n+    public void testDeepEquals() {\n@@ -90,5 +80,1 @@\n-                if (result != expected) {\n-                    errors++;\n-                    System.err.printf(\"When equating %s to %s, got %b instead of %b%n.\",\n-                                      a, b, result, expected);\n-                }\n+                assertEquals(expected, result, \"testDeepEquals\");\n@@ -96,2 +82,0 @@\n-\n-        return errors;\n@@ -100,3 +84,3 @@\n-    private static int testHashCode() {\n-        int errors = 0;\n-        errors += (Objects.hashCode(null) == 0 ) ? 0 : 1;\n+    @Test\n+    public void testHashCode() {\n+        assertEquals(0, Objects.hashCode(null), \"testHashCode\");\n@@ -104,2 +88,1 @@\n-        errors += (Objects.hashCode(s) == s.hashCode() ) ? 0 : 1;\n-        return errors;\n+        assertEquals(s.hashCode(), Objects.hashCode(s), \"testHashCode\");\n@@ -108,3 +91,2 @@\n-    private static int testHash() {\n-        int errors = 0;\n-\n+    @Test\n+    public void testHash() {\n@@ -113,1 +95,1 @@\n-        errors += ((Objects.hash((Object[])null) == 0) ? 0 : 1);\n+        assertEquals(0, Objects.hash((Object[])null), \"testHash\");\n@@ -115,4 +97,3 @@\n-        errors += (Objects.hash(\"perfect\", \"ham\", \"THC\") ==\n-                   Arrays.hashCode(data)) ? 0 : 1;\n-\n-        return errors;\n+        assertEquals(Arrays.hashCode(data),\n+                     Objects.hash(\"perfect\", \"ham\", \"THC\"),\n+                     \"testHash\");\n@@ -121,3 +102,3 @@\n-    private static int testToString() {\n-        int errors = 0;\n-        errors += (\"null\".equals(Objects.toString(null)) ) ? 0 : 1;\n+    @Test\n+    public void testToString() {\n+        assertEquals(\"null\", Objects.toString(null), \"testToString\");\n@@ -125,2 +106,1 @@\n-        errors += (s.equals(Objects.toString(s)) ) ? 0 : 1;\n-        return errors;\n+        assertEquals(s, Objects.toString(s), \"testToString\");\n@@ -129,2 +109,2 @@\n-    private static int testToString2() {\n-        int errors = 0;\n+    @Test\n+    public void testToString2() {\n@@ -132,3 +112,2 @@\n-        errors += (s.equals(Objects.toString(null, s)) ) ? 0 : 1;\n-        errors += (s.equals(Objects.toString(s, \"another string\")) ) ? 0 : 1;\n-        return errors;\n+        assertEquals(s, Objects.toString(null, s), \"testToString2\");\n+        assertEquals(s, Objects.toString(s, \"another string\"), \"testToString2\");\n@@ -137,10 +116,6 @@\n-    private static int testToIdentityString() {\n-        int errors = 0;\n-        \/\/ Test null behavior\n-        try {\n-            Objects.toIdentityString(null);\n-            errors++;\n-        } catch (NullPointerException npe) {\n-            ; \/\/ Expected\n-        }\n-        \/\/ Behavior on typical objects\n+    @Test\n+    public void testToIdentityString() {\n+        assertThrows(NullPointerException.class,\n+            () -> Objects.toIdentityString(null),\n+            \"testToIdentityString\");\n+\n@@ -148,2 +123,2 @@\n-        errors += (Objects.toIdentityString(o).equals(o.toString()))? 0 : 1;\n-        \/\/ Verify object's toString *not* called\n+        assertEquals(o.toString(), Objects.toIdentityString(o), \"testToIdentityString\");\n+\n@@ -153,1 +128,2 @@\n-                    throw new RuntimeException();\n+                    fail(\"toString should not be called\");\n+                    return null;\n@@ -156,2 +132,3 @@\n-        Objects.toIdentityString(badToString);\n-        \/\/ Verify object's hashCode *not* called\n+        assertDoesNotThrow(() -> Objects.toIdentityString(badToString),\n+            \"testToIdentityString\");\n+\n@@ -161,1 +138,2 @@\n-                    throw new RuntimeException(\"0xDEADBEFF\");\n+                    fail(\"hashCode should not be called\");\n+                    return 0;\n@@ -164,2 +142,2 @@\n-        Objects.toIdentityString(badHashCode);\n-        return errors;\n+        assertDoesNotThrow(() -> Objects.toIdentityString(badHashCode),\n+            \"testToIdentityString\");\n@@ -168,2 +146,2 @@\n-    private static int testCompare() {\n-        int errors = 0;\n+    @Test\n+    public void testCompare() {\n@@ -172,1 +150,1 @@\n-        errors += compareTest(null, null, 0);\n+        compareTest(null, null, 0);\n@@ -175,1 +153,1 @@\n-            errors += compareTest(a, a, 0);\n+            compareTest(a, a, 0);\n@@ -179,1 +157,1 @@\n-                errors += compareTest(a, b, expected);\n+                compareTest(a, b, expected);\n@@ -182,1 +160,0 @@\n-        return errors;\n@@ -185,2 +162,1 @@\n-    private static int compareTest(String a, String b, int expected) {\n-        int errors = 0;\n+    private void compareTest(String a, String b, int expected) {\n@@ -188,6 +164,1 @@\n-        if (Integer.signum(result) != Integer.signum(expected)) {\n-            errors++;\n-            System.err.printf(\"When comparing %s to %s, got %d instead of %d%n.\",\n-                              a, b, result, expected);\n-        }\n-        return errors;\n+        assertEquals(Integer.signum(expected), Integer.signum(result), \"testCompare\");\n@@ -196,3 +167,2 @@\n-    private static int testRequireNonNull() {\n-        int errors = 0;\n-\n+    @Test\n+    public void testRequireNonNull() {\n@@ -207,3 +177,3 @@\n-        errors += testRNN_NonNull(rnn1, RNN_1);\n-        errors += testRNN_NonNull(rnn2, RNN_2);\n-        errors += testRNN_NonNull(rnn3, RNN_3);\n+        testRNN_NonNull(rnn1, RNN_1);\n+        testRNN_NonNull(rnn2, RNN_2);\n+        testRNN_NonNull(rnn3, RNN_3);\n@@ -211,4 +181,3 @@\n-        errors += testRNN_Null(rnn1, RNN_1, null);\n-        errors += testRNN_Null(rnn2, RNN_2, \"trousers\");\n-        errors += testRNN_Null(rnn3, RNN_3, \"trousers\");\n-        return errors;\n+        testRNN_Null(rnn1, RNN_1);\n+        testRNN_Null(rnn2, RNN_2);\n+        testRNN_Null(rnn3, RNN_3);\n@@ -217,14 +186,4 @@\n-    private static int testRNN_NonNull(Function<String, String> testFunc,\n-                                       String testFuncName) {\n-        int errors = 0;\n-        try {\n-            String s = testFunc.apply(\"pants\");\n-            if (s != \"pants\") {\n-                System.err.printf(testFuncName + \" failed to return its arg\");\n-                errors++;\n-            }\n-        } catch (NullPointerException e) {\n-            System.err.printf(testFuncName + \" threw unexpected NPE\");\n-            errors++;\n-        }\n-        return errors;\n+    private void testRNN_NonNull(Function<String, String> testFunc,\n+                                 String testFuncName) {\n+        String s = testFunc.apply(\"pants\");\n+        assertSame(\"pants\", s, testFuncName);\n@@ -233,15 +192,6 @@\n-    private static int testRNN_Null(Function<String, String> testFunc,\n-                                    String testFuncName,\n-                                    String expectedMessage) {\n-        int errors = 0;\n-        try {\n-            String s = testFunc.apply(null);\n-            System.err.printf(testFuncName + \" failed to throw NPE\");\n-            errors++;\n-        } catch (NullPointerException e) {\n-            if (e.getMessage() != expectedMessage) {\n-                System.err.printf(testFuncName + \" threw NPE w\/ bad detail msg\");\n-                errors++;\n-            }\n-        }\n-        return errors;\n+    private void testRNN_Null(Function<String, String> testFunc,\n+                             String testFuncName) {\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> testFunc.apply(null),\n+            testFuncName);\n@@ -250,7 +200,6 @@\n-    private static int testIsNull() {\n-        int errors = 0;\n-\n-        errors += Objects.isNull(null) ? 0 : 1;\n-        errors += Objects.isNull(Objects.class) ? 1 : 0;\n-\n-        return errors;\n+    @Test\n+    public void testIsNull() {\n+        assertTrue(Objects.isNull(null),\n+            \"isNull(null) should return true\");\n+        assertFalse(Objects.isNull(Objects.class),\n+            \"isNull(Objects.class) should return false\");\n@@ -259,7 +208,6 @@\n-    private static int testNonNull() {\n-        int errors = 0;\n-\n-        errors += Objects.nonNull(null) ? 1 : 0;\n-        errors += Objects.nonNull(Objects.class) ? 0 : 1;\n-\n-        return errors;\n+    @Test\n+    public void testNonNull() {\n+        assertFalse(Objects.nonNull(null),\n+            \"nonNull(null) should return false\");\n+        assertTrue(Objects.nonNull(Objects.class),\n+            \"nonNull(Objects.class) should return true\");\n@@ -268,2 +216,2 @@\n-    private static int testNonNullOf() {\n-        int errors = 0;\n+    @Test\n+    public void testNonNullOf() {\n@@ -274,1 +222,0 @@\n-        \/\/ Confirm the compile time return type matches\n@@ -276,10 +223,1 @@\n-        errors += (result == defString) ? 0 : 1;\n-        errors += (Objects.requireNonNullElse(nonNullString, defString) == nonNullString) ? 0 : 1;\n-        errors += (Objects.requireNonNullElse(nonNullString, null) == nonNullString) ? 0 : 1;\n-        try {\n-            Objects.requireNonNullElse(null, null);\n-            errors += 1;\n-        } catch (NullPointerException npe) {\n-            \/\/ expected\n-            errors += npe.getMessage().equals(\"defaultObj\") ? 0 : 1;\n-        }\n+        assertSame(defString, result, \"testNonNullOf\");\n@@ -287,0 +225,2 @@\n+        assertSame(nonNullString, Objects.requireNonNullElse(nonNullString, defString),\n+            \"testNonNullOf\");\n@@ -288,4 +228,2 @@\n-        \/\/ Test requireNonNullElseGet with a supplier\n-        errors += (Objects.requireNonNullElseGet(nullString, () -> defString) == defString) ? 0 : 1;\n-        errors += (Objects.requireNonNullElseGet(nonNullString, () -> defString) == nonNullString) ? 0 : 1;\n-        errors += (Objects.requireNonNullElseGet(nonNullString, () -> null) == nonNullString) ? 0 : 1;\n+        assertSame(nonNullString, Objects.requireNonNullElse(nonNullString, null),\n+            \"testNonNullOf\");\n@@ -293,15 +231,68 @@\n-        try {\n-            Objects.requireNonNullElseGet(null, () -> null);\n-            errors += 1;\n-        } catch (NullPointerException npe) {\n-            \/\/ expected\n-            errors += npe.getMessage().equals(\"supplier.get()\") ? 0 : 1;\n-        }\n-        try {       \/\/ supplier is null\n-            Objects.requireNonNullElseGet(null, null);\n-            errors += 1;\n-        } catch (NullPointerException npe) {\n-            \/\/ expected\n-            errors += npe.getMessage().equals(\"supplier\") ? 0 : 1;\n-        }\n-        return errors;\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElse(null, null),\n+            \"testNonNullOf\");\n+\n+        assertSame(defString, Objects.requireNonNullElseGet(nullString, () -> defString),\n+            \"testNonNullOf\");\n+\n+        assertSame(nonNullString, Objects.requireNonNullElseGet(nonNullString, () -> defString),\n+            \"testNonNullOf\");\n+\n+        assertSame(nonNullString, Objects.requireNonNullElseGet(nonNullString, () -> null),\n+            \"testNonNullOf\");\n+\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElseGet(null, () -> null),\n+            \"testNonNullOf\");\n+\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElseGet(null, null),\n+            \"testNonNullOf\");\n+    }\n+\n+    @Test\n+    public void testRequireNonNullWithNullSupplier() {\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNull(null, (Supplier<String>) null),\n+            \"testRequireNonNullWithNullSupplier\");\n+    }\n+\n+    @Test\n+    public void testRequireNonNullWithSupplierThrowingException() {\n+        RuntimeException expectedException = new RuntimeException(\"Supplier exception\");\n+        RuntimeException actualException = assertThrows(\n+            RuntimeException.class,\n+            () -> Objects.requireNonNull(null, () -> {\n+                throw expectedException;\n+            }),\n+            \"testRequireNonNullWithSupplierThrowingException\");\n+        assertSame(expectedException, actualException,\n+            \"testRequireNonNullWithSupplierThrowingException\");\n+    }\n+\n+    @Test\n+    public void testRequireNonNullElseBothNull() {\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElse(null, null),\n+            \"testRequireNonNullElseBothNull\");\n+    }\n+\n+    @Test\n+    public void testRequireNonNullElseGetWithNullSupplier() {\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElseGet(null, null),\n+            \"testRequireNonNullElseGetWithNullSupplier\");\n+    }\n+\n+    @Test\n+    public void testRequireNonNullElseGetWithSupplierReturningNull() {\n+        assertThrows(\n+            NullPointerException.class,\n+            () -> Objects.requireNonNullElseGet(null, () -> null),\n+            \"testRequireNonNullElseGetWithSupplierReturningNull\");\n","filename":"test\/jdk\/java\/util\/Objects\/BasicObjectsTest.java","additions":169,"deletions":178,"binary":false,"changes":347,"status":"modified"}]}