{"files":[{"patch":"@@ -168,1 +168,1 @@\n-TEST_VM_F(ShenandoahOldGenerationTest, test_shared_expends_promoted_but_does_not_change_plab) {\n+TEST_VM_F(ShenandoahOldGenerationTest, test_expend_promoted_should_increase_expended) {\n@@ -170,19 +170,0 @@\n-  ShenandoahAllocRequest req = ShenandoahAllocRequest::for_shared_gc(128, ShenandoahAffiliation::OLD_GENERATION, true);\n-  req.set_actual_size(128);\n-  size_t actual_size = req.actual_size() * HeapWordSize;\n-\n-  size_t expended_before = old->get_promoted_expended();\n-  old->configure_plab_for_current_thread(req);\n-  size_t expended_after = old->get_promoted_expended();\n-\n-  EXPECT_EQ(expended_before + actual_size, expended_after) << \"Shared promotion still expends promotion\";\n-  EXPECT_EQ(plab_promoted(), INITIAL_PLAB_PROMOTED) << \"Shared promotion should not count in plab\";\n-  EXPECT_EQ(plab_size(), INITIAL_PLAB_SIZE) << \"Shared promotion should not change size of plab\";\n-  EXPECT_FALSE(promotions_enabled());\n-}\n-\n-TEST_VM_F(ShenandoahOldGenerationTest, test_shared_evacuation_has_no_side_effects) {\n-  SKIP_IF_NOT_SHENANDOAH();\n-  ShenandoahAllocRequest req = ShenandoahAllocRequest::for_shared_gc(128, ShenandoahAffiliation::OLD_GENERATION, false);\n-  req.set_actual_size(128);\n-\n@@ -190,1 +171,1 @@\n-  old->configure_plab_for_current_thread(req);\n+  old->expend_promoted(128);\n@@ -192,5 +173,1 @@\n-\n-  EXPECT_EQ(expended_before, expended_after) << \"Not a promotion, should not expend promotion reserve\";\n-  EXPECT_EQ(plab_promoted(), INITIAL_PLAB_PROMOTED) << \"Not a plab, should not have touched plab\";\n-  EXPECT_EQ(plab_size(), INITIAL_PLAB_SIZE) << \"Not a plab, should not have touched plab\";\n-  EXPECT_FALSE(promotions_enabled());\n+  EXPECT_EQ(expended_before + 128, expended_after) << \"Should expend promotion\";\n","filename":"test\/hotspot\/gtest\/gc\/shenandoah\/test_shenandoahOldGeneration.cpp","additions":3,"deletions":26,"binary":false,"changes":29,"status":"modified"}]}