{"files":[{"patch":"@@ -29,1 +29,0 @@\n-import sun.awt.AppContext;\n@@ -37,4 +36,0 @@\n-  * There can be up to FetcherInfo.MAX_NUM_FETCHERS_PER_APPCONTEXT\n-  * ImageFetcher threads for each AppContext.  A per-AppContext queue\n-  * of ImageFetchables is used to track objects to fetch.\n-  *\n@@ -156,1 +151,0 @@\n-                        \/\/ A normal occurrence as an AppContext is disposed\n@@ -283,20 +277,11 @@\n-       final AppContext appContext = AppContext.getAppContext();\n-       ThreadGroup threadGroup = appContext.getThreadGroup();\n-       ThreadGroup fetcherThreadGroup;\n-       if (threadGroup.getParent() != null) {\n-           \/\/ threadGroup is not the root, so we proceed\n-           fetcherThreadGroup = threadGroup;\n-       } else {\n-           \/\/ threadGroup is the root (\"system\") ThreadGroup.\n-           \/\/ We instead want to use its child: the \"main\"\n-           \/\/ ThreadGroup.  Thus, we start with the current\n-           \/\/ ThreadGroup, and go up the tree until\n-           \/\/ threadGroup.getParent().getParent() == null.\n-           threadGroup = Thread.currentThread().getThreadGroup();\n-           ThreadGroup parent = threadGroup.getParent();\n-           while ((parent != null)\n-                && (parent.getParent() != null)) {\n-                threadGroup = parent;\n-                parent = threadGroup.getParent();\n-           }\n-           fetcherThreadGroup = threadGroup;\n+       \/\/ We don't want the root (\"system\") ThreadGroup.\n+       \/\/ We instead want to use its child: the \"main\"\n+       \/\/ ThreadGroup.  Thus, we start with the current\n+       \/\/ ThreadGroup, and go up the tree until\n+       \/\/ threadGroup.getParent().getParent() == null.\n+       ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n+       ThreadGroup parent = threadGroup.getParent();\n+       while ((parent != null)\n+            && (parent.getParent() != null)) {\n+            threadGroup = parent;\n+            parent = threadGroup.getParent();\n@@ -304,1 +289,2 @@\n-       final ThreadGroup fetcherGroup = fetcherThreadGroup;\n+       final ThreadGroup fetcherGroup = threadGroup;\n+\n@@ -323,1 +309,1 @@\n-  * The FetcherInfo class encapsulates the per-AppContext ImageFetcher\n+  * The FetcherInfo class encapsulates the ImageFetcher\n@@ -328,1 +314,2 @@\n-    static final int MAX_NUM_FETCHERS_PER_APPCONTEXT = 4;\n+    static final int MAX_NUM_FETCHERS = 4;\n+    static final FetcherInfo FETCHER_INFO = new FetcherInfo();\n@@ -336,1 +323,1 @@\n-        fetchers = new Thread[MAX_NUM_FETCHERS_PER_APPCONTEXT];\n+        fetchers = new Thread[MAX_NUM_FETCHERS];\n@@ -342,4 +329,0 @@\n-    \/* The key to put()\/get() the FetcherInfo into\/from the AppContext. *\/\n-    private static final Object FETCHER_INFO_KEY =\n-                                        new StringBuffer(\"FetcherInfo\");\n-\n@@ -347,9 +330,1 @@\n-        AppContext appContext = AppContext.getAppContext();\n-        synchronized(appContext) {\n-            FetcherInfo info = (FetcherInfo)appContext.get(FETCHER_INFO_KEY);\n-            if (info == null) {\n-                info = new FetcherInfo();\n-                appContext.put(FETCHER_INFO_KEY, info);\n-            }\n-            return info;\n-        }\n+        return FETCHER_INFO;\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/ImageFetcher.java","additions":18,"deletions":43,"binary":false,"changes":61,"status":"modified"}]}