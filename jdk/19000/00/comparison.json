{"files":[{"patch":"@@ -517,0 +517,9 @@\n+    }\n+\n+    \/* at least on AIX try also the LD_LIBRARY_PATH \/ LIBPATH *\/\n+    if (GetApplicationHomeFromLD_LIBRARY_PATH(path, pathsize)) {\n+        JLI_Snprintf(libjava, sizeof(libjava), \"%s\/lib\/\" JAVA_DLL, path);\n+        if (stat(libjava, &s) == 0) {\n+            JLI_TraceLauncher(\"JRE path is %s\\n\", path);\n+            return JNI_TRUE;\n+        }\n","filename":"src\/java.base\/unix\/native\/libjli\/java_md.c","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -62,0 +62,2 @@\n+jboolean GetApplicationHomeFromLD_LIBRARY_PATH(char *buf, jint bufsize);\n+\n","filename":"src\/java.base\/unix\/native\/libjli\/java_md.h","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,0 +28,7 @@\n+#define JAVA_DLL \"libjava.so\"\n+#ifdef AIX\n+#define LD_LIBRARY_PATH \"LIBPATH\"\n+#else\n+#define LD_LIBRARY_PATH \"LD_LIBRARY_PATH\"\n+#endif\n+\n@@ -111,0 +118,38 @@\n+static jboolean\n+LibjavaExists(const char *path) {\n+    char tmp[PATH_MAX + 1];\n+    struct stat statbuf;\n+    JLI_Snprintf(tmp, PATH_MAX, \"%s\/%s\", path, JAVA_DLL);\n+    if (stat(tmp, &statbuf) == 0) {\n+        return JNI_TRUE;\n+    }\n+    return JNI_FALSE;\n+}\n+\n+\/*\n+ * Retrieves the path to the JRE home by locating libjava.so in\n+ * one of the LD_LIBRARY_PATH and then truncating the path to it.\n+ *\/\n+jboolean\n+GetApplicationHomeFromLD_LIBRARY_PATH(char *buf, jint bufsize)\n+{\n+    char *env = getenv(LD_LIBRARY_PATH);\n+    char *tmp;\n+    char* save_ptr = NULL;\n+    char *envpath = JLI_StringDup(env);\n+    for (tmp = strtok_r(envpath, \":\", &save_ptr); tmp != NULL; tmp = strtok_r(NULL, \":\", &save_ptr)) {\n+        if (LibjavaExists(tmp)) {\n+            char *path = realpath(tmp, buf);\n+            if (path == buf) {\n+                JLI_StrCat(buf, \"\/\");\n+                if (JNI_TRUE == TruncatePath(buf, JNI_TRUE)) {\n+                    JLI_MemFree(envpath);\n+                    return JNI_TRUE;\n+                }\n+            }\n+        }\n+    }\n+    JLI_MemFree(envpath);\n+    return JNI_FALSE;\n+}\n+\n","filename":"src\/java.base\/unix\/native\/libjli\/java_md_common.c","additions":45,"deletions":0,"binary":false,"changes":45,"status":"modified"}]}