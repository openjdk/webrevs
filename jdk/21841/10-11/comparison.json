{"files":[{"patch":"@@ -103,0 +103,3 @@\n+    private static final int INITIAL_PATTERN_CAPACITY = 4;\n+    private final List<Pattern> disabledPatterns;\n+\n@@ -104,1 +107,0 @@\n-    private final List<Pattern> disabledPatterns = new ArrayList<>();\n@@ -139,1 +141,7 @@\n-        loadDisabledPatterns();\n+\n+        \/\/ Support patterns only for jdk.tls.disabledAlgorithms\n+        if (PROPERTY_TLS_DISABLED_ALGS.equals(propertyName)) {\n+            disabledPatterns = getDisabledPatterns();\n+        } else {\n+            disabledPatterns = null;\n+        }\n@@ -980,1 +988,1 @@\n-        return disabledPatterns.stream().noneMatch(\n+        return disabledPatterns == null || disabledPatterns.stream().noneMatch(\n@@ -984,2 +992,3 @@\n-    private void loadDisabledPatterns() {\n-        List<String> patternStrings = new ArrayList<>();\n+    private List<Pattern> getDisabledPatterns() {\n+        List<Pattern> ret = null;\n+        List<String> patternStrings = new ArrayList<>(INITIAL_PATTERN_CAPACITY);\n@@ -993,0 +1002,3 @@\n+                patternStrings.add(p);\n+            }\n+        }\n@@ -994,3 +1006,2 @@\n-                disabledPatterns.add(Pattern.compile(\n-                        \/\/ Ignore all regex characters but asterisk.\n-                        \"^\\\\Q\" + p.replace(\"*\", \"\\\\E.*\\\\Q\") + \"\\\\E$\"));\n+        if (!patternStrings.isEmpty()) {\n+            ret = new ArrayList<>(INITIAL_PATTERN_CAPACITY);\n@@ -998,1 +1009,7 @@\n-                patternStrings.add(p);\n+            for (String p : patternStrings) {\n+                \/\/ Exclude patterns from algorithm code flow.\n+                disabledAlgorithms.remove(p);\n+\n+                \/\/ Ignore all regex characters but asterisk.\n+                ret.add(Pattern.compile(\n+                        \"^\\\\Q\" + p.replace(\"*\", \"\\\\E.*\\\\Q\") + \"\\\\E$\"));\n@@ -1002,2 +1019,1 @@\n-        \/\/ Exclude patterns from algorithm code flow.\n-        patternStrings.forEach(disabledAlgorithms::remove);\n+        return ret;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/DisabledAlgorithmConstraints.java","additions":27,"deletions":11,"binary":false,"changes":38,"status":"modified"}]}