{"files":[{"patch":"@@ -146,0 +146,2 @@\n+\n+  NOT_PRODUCT(clear_strings());\n@@ -1100,1 +1102,2 @@\n-AsmRemarks::AsmRemarks() : _remarks(new AsmRemarkCollection()) {\n+AsmRemarks::AsmRemarks() {\n+  init();\n@@ -1105,4 +1108,5 @@\n-  if (_remarks != nullptr) {\n-    clear();\n-  }\n-  assert(_remarks == nullptr, \"must be\");\n+  assert(_remarks == nullptr, \"Must 'clear()' before deleting!\");\n+}\n+\n+void AsmRemarks::init() {\n+  _remarks = new AsmRemarkCollection();\n@@ -1155,1 +1159,2 @@\n-DbgStrings::DbgStrings() : _strings(new DbgStringCollection()) {\n+DbgStrings::DbgStrings() {\n+  init();\n@@ -1160,4 +1165,5 @@\n-  if (_strings != nullptr) {\n-    clear();\n-  }\n-  assert(_strings == nullptr, \"must be\");\n+  assert(_strings == nullptr, \"Must 'clear()' before deleting!\");\n+}\n+\n+void DbgStrings::init() {\n+  _strings = new DbgStringCollection();\n","filename":"src\/hotspot\/share\/asm\/codeBuffer.cpp","additions":16,"deletions":10,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -429,0 +429,2 @@\n+  void init();\n+\n@@ -455,0 +457,2 @@\n+  void init();\n+\n@@ -824,0 +828,5 @@\n+\n+  void clear_strings() {\n+    _asm_remarks.clear();\n+    _dbg_strings.clear();\n+  }\n","filename":"src\/hotspot\/share\/asm\/codeBuffer.hpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -918,7 +918,0 @@\n-#ifndef PRODUCT\n-  AsmRemarks asm_remarks;\n-  read_asm_remarks(asm_remarks);\n-  DbgStrings dbg_strings;\n-  read_dbg_strings(dbg_strings);\n-#endif \/\/ PRODUCT\n-\n@@ -929,4 +922,0 @@\n-#ifndef PRODUCT\n-                                         , asm_remarks\n-                                         , dbg_strings\n-#endif\n@@ -938,0 +927,7 @@\n+#ifndef PRODUCT\n+  code_blob->asm_remarks().init();\n+  read_asm_remarks(code_blob->asm_remarks());\n+  code_blob->dbg_strings().init();\n+  read_dbg_strings(code_blob->dbg_strings());\n+#endif \/\/ PRODUCT\n+\n","filename":"src\/hotspot\/share\/code\/aotCodeCache.cpp","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -284,4 +284,0 @@\n-#ifndef PRODUCT\n-                           , AsmRemarks& archived_asm_remarks\n-                           , DbgStrings& archived_dbg_strings\n-#endif \/\/ PRODUCT\n@@ -306,5 +302,0 @@\n-#ifndef PRODUCT\n-      blob->use_remarks(archived_asm_remarks);\n-      blob->use_strings(archived_dbg_strings);\n-#endif \/\/ PRODUCT\n-\n","filename":"src\/hotspot\/share\/code\/codeBlob.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -321,6 +321,1 @@\n-                          ImmutableOopMapSet* archived_oop_maps\n-#ifndef PRODUCT\n-                          , AsmRemarks& archived_asm_remarks\n-                          , DbgStrings& archived_dbg_strings\n-#endif \/\/ PRODUCT\n-                         );\n+                          ImmutableOopMapSet* archived_oop_maps);\n","filename":"src\/hotspot\/share\/code\/codeBlob.hpp","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"}]}