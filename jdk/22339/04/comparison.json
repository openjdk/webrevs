{"files":[{"patch":"@@ -850,0 +850,6 @@\n+                @Override\n+                public ByteBuffer newDirectByteBuffer(int cap) {\n+                    long addr = UNSAFE.allocateMemory(cap);\n+                    return new DirectByteBuffer(addr, cap);\n+                }\n+\n","filename":"src\/java.base\/share\/classes\/java\/nio\/Buffer.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -162,0 +162,1 @@\n+    \/\/ and JavaNioAccess.newDirectByteBuffer(int).\n@@ -164,1 +165,1 @@\n-    private Direct$Type$Buffer(long addr, long cap) {\n+    Direct$Type$Buffer(long addr, long cap) {\n","filename":"src\/java.base\/share\/classes\/java\/nio\/Direct-X-Buffer.java.template","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -70,0 +70,5 @@\n+    \/**\n+     * Used by {@code sun.nio.ch.Util}.\n+     *\/\n+    ByteBuffer newDirectByteBuffer(int cap);\n+\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaNioAccess.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -39,0 +39,2 @@\n+import jdk.internal.access.JavaNioAccess;\n+import jdk.internal.access.SharedSecrets;\n@@ -44,0 +46,2 @@\n+    private static final JavaNioAccess NIO_ACCESS = SharedSecrets.getJavaNioAccess();\n+\n@@ -224,1 +228,1 @@\n-            return ByteBuffer.allocateDirect(size);\n+            return NIO_ACCESS.newDirectByteBuffer(size);\n@@ -239,1 +243,1 @@\n-            return ByteBuffer.allocateDirect(size);\n+            return NIO_ACCESS.newDirectByteBuffer(size);\n@@ -250,1 +254,1 @@\n-            return ByteBuffer.allocateDirect(size + alignment - 1)\n+            return NIO_ACCESS.newDirectByteBuffer(size + alignment - 1)\n@@ -266,1 +270,1 @@\n-        return ByteBuffer.allocateDirect(size + alignment - 1)\n+        return NIO_ACCESS.newDirectByteBuffer(size + alignment - 1)\n@@ -324,1 +328,1 @@\n-        ((DirectBuffer)buf).cleaner().clean();\n+        unsafe.freeMemory(((DirectBuffer)buf).address());\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/ch\/Util.java","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -72,3 +72,0 @@\n-\n-# Direct buffer memory allocated before test launch\n-java\/nio\/Buffer\/LimitDirectMemory.java 8342849 generic-all\n","filename":"test\/jdk\/ProblemList-Virtual.txt","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"}]}