{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -932,0 +932,6 @@\n+    \/* If derivation failed, do not attempt copy-back *\/\n+    if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) {\n+        jKeyHandle = 0L;\n+        goto cleanup;\n+    }\n+\n@@ -959,2 +965,3 @@\n-    if (ckAssertReturnValueOK(env, rv) != CK_ASSERT_OK) {\n-        jKeyHandle =0L;\n+    \/* Do not continue if any copy-back operation raised an exception *\/\n+    if ((*env)->ExceptionCheck(env)) {\n+        goto cleanup;\n","filename":"src\/jdk.crypto.cryptoki\/share\/native\/libj2pkcs11\/p11_keymgmt.c","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"}]}