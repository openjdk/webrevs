{"files":[{"patch":"@@ -49,1 +49,2 @@\n-    static final OfFloat FLOAT = JAVA_FLOAT.withByteAlignment(4);\n+    final static OfFloat  C_FLOAT  = (ValueLayout.OfFloat)  abi.canonicalLayouts().get(\"float\");\n+    final static OfDouble C_DOUBLE = (ValueLayout.OfDouble) abi.canonicalLayouts().get(\"double\");\n@@ -52,2 +53,2 @@\n-        FLOAT.withName(\"p0\"),\n-        FLOAT.withName(\"p1\")\n+        C_FLOAT.withName(\"p0\"),\n+        C_FLOAT.withName(\"p1\")\n@@ -57,7 +58,7 @@\n-        FLOAT.withName(\"p0\"),\n-        FLOAT.withName(\"p1\"),\n-        FLOAT.withName(\"p2\"),\n-        FLOAT.withName(\"p3\"),\n-        FLOAT.withName(\"p4\"),\n-        FLOAT.withName(\"p5\"),\n-        FLOAT.withName(\"p6\")\n+        C_FLOAT.withName(\"p0\"),\n+        C_FLOAT.withName(\"p1\"),\n+        C_FLOAT.withName(\"p2\"),\n+        C_FLOAT.withName(\"p3\"),\n+        C_FLOAT.withName(\"p4\"),\n+        C_FLOAT.withName(\"p5\"),\n+        C_FLOAT.withName(\"p6\")\n@@ -68,3 +69,3 @@\n-        JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT,\n-        JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT, JAVA_FLOAT,\n-        JAVA_FLOAT, JAVA_FLOAT, S_FFLayout, JAVA_FLOAT);\n+        C_FLOAT, C_FLOAT, C_FLOAT, C_FLOAT, C_FLOAT,\n+        C_FLOAT, C_FLOAT, C_FLOAT, C_FLOAT, C_FLOAT,\n+        C_FLOAT, C_FLOAT, S_FFLayout, C_FLOAT);\n@@ -73,1 +74,1 @@\n-        S_FFLayout, JAVA_FLOAT);\n+        S_FFLayout, C_FLOAT);\n@@ -76,1 +77,1 @@\n-        S_FFLayout, JAVA_DOUBLE);\n+        S_FFLayout, C_DOUBLE);\n@@ -79,1 +80,1 @@\n-        S_FFFFFFFLayout, JAVA_FLOAT);\n+        S_FFFFFFFLayout, C_FLOAT);\n@@ -82,4 +83,4 @@\n-    static final FunctionDescriptor fdpass_struct_after_floats = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, JAVA_FLOAT);\n-    static final FunctionDescriptor fdpass_struct_after_structs = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, JAVA_FLOAT);\n-    static final FunctionDescriptor fdpass_struct_after_structs_plus_double = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, JAVA_DOUBLE);\n-    static final FunctionDescriptor fdpass_large_struct_after_structs = FunctionDescriptor.of(S_FFFFFFFLayout, ADDRESS, S_FFFFFFFLayout, JAVA_FLOAT);\n+    static final FunctionDescriptor fdpass_struct_after_floats = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, C_FLOAT);\n+    static final FunctionDescriptor fdpass_struct_after_structs = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, C_FLOAT);\n+    static final FunctionDescriptor fdpass_struct_after_structs_plus_double = FunctionDescriptor.of(S_FFLayout, ADDRESS, S_FFLayout, C_DOUBLE);\n+    static final FunctionDescriptor fdpass_large_struct_after_structs = FunctionDescriptor.of(S_FFFFFFFLayout, ADDRESS, S_FFFFFFFLayout, C_FLOAT);\n@@ -112,2 +113,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -115,7 +115,7 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 2.0f);\n-            s.set(FLOAT, 8, 3.0f);\n-            s.set(FLOAT, 12, 4.0f);\n-            s.set(FLOAT, 16, 5.0f);\n-            s.set(FLOAT, 20, 6.0f);\n-            s.set(FLOAT, 24, 7.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 2.0f);\n+            s.set(C_FLOAT, 8, 3.0f);\n+            s.set(C_FLOAT, 12, 4.0f);\n+            s.set(C_FLOAT, 16, 5.0f);\n+            s.set(C_FLOAT, 20, 6.0f);\n+            s.set(C_FLOAT, 24, 7.0f);\n@@ -123,7 +123,7 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n-            p2 = s.get(FLOAT, 8);\n-            p3 = s.get(FLOAT, 12);\n-            p4 = s.get(FLOAT, 16);\n-            p5 = s.get(FLOAT, 20);\n-            p6 = s.get(FLOAT, 24);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n+            p2 = s.get(C_FLOAT, 8);\n+            p3 = s.get(C_FLOAT, 12);\n+            p4 = s.get(C_FLOAT, 16);\n+            p5 = s.get(C_FLOAT, 20);\n+            p6 = s.get(C_FLOAT, 24);\n@@ -141,2 +141,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -144,2 +143,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -150,2 +149,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -162,2 +161,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -165,2 +163,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -170,2 +168,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -182,2 +180,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -185,2 +182,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -190,2 +187,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -202,2 +199,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -205,7 +201,7 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 2.0f);\n-            s.set(FLOAT, 8, 3.0f);\n-            s.set(FLOAT, 12, 4.0f);\n-            s.set(FLOAT, 16, 5.0f);\n-            s.set(FLOAT, 20, 6.0f);\n-            s.set(FLOAT, 24, 7.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 2.0f);\n+            s.set(C_FLOAT, 8, 3.0f);\n+            s.set(C_FLOAT, 12, 4.0f);\n+            s.set(C_FLOAT, 16, 5.0f);\n+            s.set(C_FLOAT, 20, 6.0f);\n+            s.set(C_FLOAT, 24, 7.0f);\n@@ -215,7 +211,7 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n-            p2 = s.get(FLOAT, 8);\n-            p3 = s.get(FLOAT, 12);\n-            p4 = s.get(FLOAT, 16);\n-            p5 = s.get(FLOAT, 20);\n-            p6 = s.get(FLOAT, 24);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n+            p2 = s.get(C_FLOAT, 8);\n+            p3 = s.get(C_FLOAT, 12);\n+            p4 = s.get(C_FLOAT, 16);\n+            p5 = s.get(C_FLOAT, 20);\n+            p6 = s.get(C_FLOAT, 24);\n@@ -232,14 +228,14 @@\n-        float val0 = p0.get(FLOAT,  0) + p1.get(FLOAT,  0);\n-        float val1 = p0.get(FLOAT,  4) + p1.get(FLOAT,  4);\n-        float val2 = p0.get(FLOAT,  8) + p1.get(FLOAT,  8);\n-        float val3 = p0.get(FLOAT, 12) + p1.get(FLOAT, 12);\n-        float val4 = p0.get(FLOAT, 16) + p1.get(FLOAT, 16);\n-        float val5 = p0.get(FLOAT, 20) + p1.get(FLOAT, 20);\n-        float val6 = p0.get(FLOAT, 24) + p1.get(FLOAT, 24);\n-        p0.set(FLOAT,  0, val0);\n-        p0.set(FLOAT,  4, val1);\n-        p0.set(FLOAT,  8, val2);\n-        p0.set(FLOAT, 12, val3);\n-        p0.set(FLOAT, 16, val4);\n-        p0.set(FLOAT, 20, val5);\n-        p0.set(FLOAT, 24, val6);\n+        float val0 = p0.get(C_FLOAT,  0) + p1.get(C_FLOAT,  0);\n+        float val1 = p0.get(C_FLOAT,  4) + p1.get(C_FLOAT,  4);\n+        float val2 = p0.get(C_FLOAT,  8) + p1.get(C_FLOAT,  8);\n+        float val3 = p0.get(C_FLOAT, 12) + p1.get(C_FLOAT, 12);\n+        float val4 = p0.get(C_FLOAT, 16) + p1.get(C_FLOAT, 16);\n+        float val5 = p0.get(C_FLOAT, 20) + p1.get(C_FLOAT, 20);\n+        float val6 = p0.get(C_FLOAT, 24) + p1.get(C_FLOAT, 24);\n+        p0.set(C_FLOAT,  0, val0);\n+        p0.set(C_FLOAT,  4, val1);\n+        p0.set(C_FLOAT,  8, val2);\n+        p0.set(C_FLOAT, 12, val3);\n+        p0.set(C_FLOAT, 16, val4);\n+        p0.set(C_FLOAT, 20, val5);\n+        p0.set(C_FLOAT, 24, val6);\n@@ -253,2 +249,2 @@\n-        float val = s.get(FLOAT, 0);\n-        s.set(FLOAT, 0, val + f);\n+        float val = s.get(C_FLOAT, 0);\n+        s.set(C_FLOAT, 0, val + f);\n@@ -262,2 +258,2 @@\n-        float val = s.get(FLOAT, 0);\n-        s.set(FLOAT, 0, val + f);\n+        float val = s.get(C_FLOAT, 0);\n+        s.set(C_FLOAT, 0, val + f);\n@@ -271,2 +267,2 @@\n-        float val = s.get(FLOAT, 0);\n-        s.set(FLOAT, 0, val + (float) f);\n+        float val = s.get(C_FLOAT, 0);\n+        s.set(C_FLOAT, 0, val + (float) f);\n@@ -279,2 +275,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -282,7 +277,7 @@\n-            s.set(FLOAT,  0, 1.0f);\n-            s.set(FLOAT,  4, 2.0f);\n-            s.set(FLOAT,  8, 3.0f);\n-            s.set(FLOAT, 12, 4.0f);\n-            s.set(FLOAT, 16, 5.0f);\n-            s.set(FLOAT, 20, 6.0f);\n-            s.set(FLOAT, 24, 7.0f);\n+            s.set(C_FLOAT,  0, 1.0f);\n+            s.set(C_FLOAT,  4, 2.0f);\n+            s.set(C_FLOAT,  8, 3.0f);\n+            s.set(C_FLOAT, 12, 4.0f);\n+            s.set(C_FLOAT, 16, 5.0f);\n+            s.set(C_FLOAT, 20, 6.0f);\n+            s.set(C_FLOAT, 24, 7.0f);\n@@ -294,7 +289,7 @@\n-            p0 = s.get(FLOAT,  0);\n-            p1 = s.get(FLOAT,  4);\n-            p2 = s.get(FLOAT,  8);\n-            p3 = s.get(FLOAT, 12);\n-            p4 = s.get(FLOAT, 16);\n-            p5 = s.get(FLOAT, 20);\n-            p6 = s.get(FLOAT, 24);\n+            p0 = s.get(C_FLOAT,  0);\n+            p1 = s.get(C_FLOAT,  4);\n+            p2 = s.get(C_FLOAT,  8);\n+            p3 = s.get(C_FLOAT, 12);\n+            p4 = s.get(C_FLOAT, 16);\n+            p5 = s.get(C_FLOAT, 20);\n+            p6 = s.get(C_FLOAT, 24);\n@@ -312,2 +307,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -315,2 +309,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -325,2 +319,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -337,2 +331,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -340,2 +333,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -349,2 +342,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -361,2 +354,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -364,2 +356,2 @@\n-            s.set(FLOAT, 0, 1.0f);\n-            s.set(FLOAT, 4, 1.0f);\n+            s.set(C_FLOAT, 0, 1.0f);\n+            s.set(C_FLOAT, 4, 1.0f);\n@@ -373,2 +365,2 @@\n-            p0 = s.get(FLOAT, 0);\n-            p1 = s.get(FLOAT, 4);\n+            p0 = s.get(C_FLOAT, 0);\n+            p1 = s.get(C_FLOAT, 4);\n@@ -385,2 +377,1 @@\n-        try {\n-            Arena arena = Arena.ofConfined();\n+        try (Arena arena = Arena.ofConfined()) {\n@@ -388,7 +379,7 @@\n-            s.set(FLOAT,  0, 1.0f);\n-            s.set(FLOAT,  4, 2.0f);\n-            s.set(FLOAT,  8, 3.0f);\n-            s.set(FLOAT, 12, 4.0f);\n-            s.set(FLOAT, 16, 5.0f);\n-            s.set(FLOAT, 20, 6.0f);\n-            s.set(FLOAT, 24, 7.0f);\n+            s.set(C_FLOAT,  0, 1.0f);\n+            s.set(C_FLOAT,  4, 2.0f);\n+            s.set(C_FLOAT,  8, 3.0f);\n+            s.set(C_FLOAT, 12, 4.0f);\n+            s.set(C_FLOAT, 16, 5.0f);\n+            s.set(C_FLOAT, 20, 6.0f);\n+            s.set(C_FLOAT, 24, 7.0f);\n@@ -402,7 +393,7 @@\n-            p0 = s.get(FLOAT,  0);\n-            p1 = s.get(FLOAT,  4);\n-            p2 = s.get(FLOAT,  8);\n-            p3 = s.get(FLOAT, 12);\n-            p4 = s.get(FLOAT, 16);\n-            p5 = s.get(FLOAT, 20);\n-            p6 = s.get(FLOAT, 24);\n+            p0 = s.get(C_FLOAT,  0);\n+            p1 = s.get(C_FLOAT,  4);\n+            p2 = s.get(C_FLOAT,  8);\n+            p3 = s.get(C_FLOAT, 12);\n+            p4 = s.get(C_FLOAT, 16);\n+            p5 = s.get(C_FLOAT, 20);\n+            p6 = s.get(C_FLOAT, 24);\n","filename":"test\/jdk\/java\/foreign\/TestHFA.java","additions":131,"deletions":140,"binary":false,"changes":271,"status":"modified"}]}