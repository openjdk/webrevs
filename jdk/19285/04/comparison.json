{"files":[{"patch":"@@ -847,4 +847,2 @@\n-    if (bs_nm->is_armed(nm)) {\n-      bool alive = bs_nm->nmethod_entry_barrier(nm);\n-      assert(alive, \"should be alive\");\n-    }\n+    bool alive = bs_nm->nmethod_entry_barrier(nm);\n+    assert(alive, \"should be alive\");\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -103,0 +103,6 @@\n+  if (!is_armed(nm)) {\n+    \/\/ Some other thread got here first and healed the oops\n+    \/\/ and disarmed the nmethod. No need to continue.\n+    return true;\n+  }\n+\n@@ -175,0 +181,3 @@\n+  \/\/ Check for disarmed method here to avoid going into DeoptimizeNMethodBarriersALot code\n+  \/\/ too often. nmethod_entry_barrier checks for disarmed status itself,\n+  \/\/ but we have no visibility into whether the barrier acted or not.\n","filename":"src\/hotspot\/share\/gc\/shared\/barrierSetNMethod.cpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -35,0 +35,6 @@\n+  if (!is_armed(nm)) {\n+    \/\/ Some other thread got here first and healed the oops\n+    \/\/ and disarmed the nmethod. No need to continue.\n+    return true;\n+  }\n+\n@@ -39,2 +45,2 @@\n-    \/\/ Some other thread got here first and healed the oops\n-    \/\/ and disarmed the nmethod.\n+    \/\/ Some other thread managed to complete while we were\n+    \/\/ waiting for lock. No need to continue.\n","filename":"src\/hotspot\/share\/gc\/x\/xBarrierSetNMethod.cpp","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -40,0 +40,7 @@\n+  if (!is_armed(nm)) {\n+    log_develop_trace(gc, nmethod)(\"nmethod: \" PTR_FORMAT \" visited by entry (disarmed before lock)\", p2i(nm));\n+    \/\/ Some other thread got here first and healed the oops\n+    \/\/ and disarmed the nmethod. No need to continue.\n+    return true;\n+  }\n+\n@@ -47,2 +54,2 @@\n-    \/\/ Some other thread got here first and healed the oops\n-    \/\/ and disarmed the nmethod.\n+    \/\/ Some other thread managed to complete while we were\n+    \/\/ waiting for lock. No need to continue.\n","filename":"src\/hotspot\/share\/gc\/z\/zBarrierSetNMethod.cpp","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"}]}