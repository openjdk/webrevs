{"files":[{"patch":"@@ -2830,5 +2830,0 @@\n-  if (name == vmSymbols::object_initializer_name() &&\n-      signature == vmSymbols::void_method_signature() &&\n-      m->is_vanilla_constructor()) {\n-    _has_vanilla_constructor = true;\n-  }\n@@ -4165,23 +4160,0 @@\n-  \/\/ Check if this klass has a vanilla default constructor\n-  if (super == nullptr) {\n-    \/\/ java.lang.Object has empty default constructor\n-    ik->set_has_vanilla_constructor();\n-  } else {\n-    if (super->has_vanilla_constructor() &&\n-        _has_vanilla_constructor) {\n-      ik->set_has_vanilla_constructor();\n-    }\n-#ifdef ASSERT\n-    bool v = false;\n-    if (super->has_vanilla_constructor()) {\n-      const Method* const constructor =\n-        ik->find_method(vmSymbols::object_initializer_name(),\n-                       vmSymbols::void_method_signature());\n-      if (constructor != nullptr && constructor->is_vanilla_constructor()) {\n-        v = true;\n-      }\n-    }\n-    assert(v == ik->has_vanilla_constructor(), \"inconsistent has_vanilla_constructor\");\n-#endif\n-  }\n-\n@@ -5374,1 +5346,1 @@\n-  \/\/ Fill in has_finalizer, has_vanilla_constructor, and layout_helper\n+  \/\/ Fill in has_finalizer and layout_helper\n@@ -5560,1 +5532,0 @@\n-  _has_vanilla_constructor(false),\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":1,"deletions":30,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -200,1 +200,0 @@\n-  bool _has_vanilla_constructor;\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -769,2 +769,0 @@\n-  bool has_vanilla_constructor() const  { return _misc_flags.has_vanilla_constructor(); }\n-  void set_has_vanilla_constructor()    { _misc_flags.set_has_vanilla_constructor(true); }\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,2 +56,1 @@\n-    flag(has_vanilla_constructor            , 1 << 13) \/* True if klass has a vanilla default constructor *\/ \\\n-    flag(has_final_method                   , 1 << 14) \/* True if klass has final method *\/ \\\n+    flag(has_final_method                   , 1 << 13) \/* True if klass has final method *\/ \\\n","filename":"src\/hotspot\/share\/oops\/instanceKlassFlags.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -664,43 +664,0 @@\n-bool Method::is_vanilla_constructor() const {\n-  \/\/ Returns true if this method is a vanilla constructor, i.e. an \"<init>\" \"()V\" method\n-  \/\/ which only calls the superclass vanilla constructor and possibly does stores of\n-  \/\/ zero constants to local fields:\n-  \/\/\n-  \/\/   aload_0\n-  \/\/   invokespecial\n-  \/\/   indexbyte1\n-  \/\/   indexbyte2\n-  \/\/\n-  \/\/ followed by an (optional) sequence of:\n-  \/\/\n-  \/\/   aload_0\n-  \/\/   aconst_null \/ iconst_0 \/ fconst_0 \/ dconst_0\n-  \/\/   putfield\n-  \/\/   indexbyte1\n-  \/\/   indexbyte2\n-  \/\/\n-  \/\/ followed by:\n-  \/\/\n-  \/\/   return\n-\n-  assert(name() == vmSymbols::object_initializer_name(),    \"Should only be called for default constructors\");\n-  assert(signature() == vmSymbols::void_method_signature(), \"Should only be called for default constructors\");\n-  int size = code_size();\n-  \/\/ Check if size match\n-  if (size == 0 || size % 5 != 0) return false;\n-  address cb = code_base();\n-  int last = size - 1;\n-  if (cb[0] != Bytecodes::_aload_0 || cb[1] != Bytecodes::_invokespecial || cb[last] != Bytecodes::_return) {\n-    \/\/ Does not call superclass default constructor\n-    return false;\n-  }\n-  \/\/ Check optional sequence\n-  for (int i = 4; i < last; i += 5) {\n-    if (cb[i] != Bytecodes::_aload_0) return false;\n-    if (!Bytecodes::is_zero_const(Bytecodes::cast(cb[i+1]))) return false;\n-    if (cb[i+2] != Bytecodes::_putfield) return false;\n-  }\n-  return true;\n-}\n-\n-\n","filename":"src\/hotspot\/share\/oops\/method.cpp","additions":0,"deletions":43,"binary":false,"changes":43,"status":"modified"}]}