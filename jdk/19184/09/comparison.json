{"files":[{"patch":"@@ -130,1 +130,3 @@\n-                    restoreEcho = echo(false);\n+                    synchronized(restoreEchoLock) {\n+                        restoreEcho = echo(false);\n+                    }\n@@ -143,2 +145,5 @@\n-                        if (restoreEcho)\n-                            restoreEcho = echo(true);\n+                        synchronized(restoreEchoLock) {\n+                            if (restoreEcho) {\n+                                restoreEcho = echo(true);\n+                            }\n+                        }\n@@ -157,1 +162,1 @@\n-                        } catch (IOException x) {\n+                        } catch (IOException _) {\n@@ -181,2 +186,4 @@\n-                                        if (restoreEcho) {\n-                                            echo(true);\n+                                        synchronized(restoreEchoLock) {\n+                                            if (restoreEcho) {\n+                                                echo(true);\n+                                            }\n@@ -184,1 +191,1 @@\n-                                    } catch (IOException x) { }\n+                                    } catch (IOException _) { }\n@@ -187,1 +194,1 @@\n-        } catch (IllegalStateException e) {\n+        } catch (IllegalStateException _) {\n@@ -212,0 +219,2 @@\n+    \/\/ Must not block while holding this. It is used in the shutdown hook.\n+    private final Object restoreEchoLock;\n@@ -382,0 +391,1 @@\n+        restoreEchoLock = new Object();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/io\/JdkConsoleImpl.java","additions":18,"deletions":8,"binary":false,"changes":26,"status":"modified"}]}