{"files":[{"patch":"@@ -28,0 +28,1 @@\n+ * @build jdk.test.lib.Platform jdk.test.lib.NetworkConfiguration\n@@ -38,0 +39,2 @@\n+\n+import jdk.test.lib.NetworkConfiguration;\n@@ -106,7 +109,2 @@\n-            Enumeration<NetworkInterface> nifs = NetworkInterface.getNetworkInterfaces();\n-            while (nifs.hasMoreElements()) {\n-                NetworkInterface ni = nifs.nextElement();\n-                if (ni.supportsMulticast() && !ni.getInterfaceAddresses().isEmpty()) {\n-                    return ni;\n-                }\n-            }\n+            NetworkConfiguration nc = NetworkConfiguration.probe();\n+            return nc.multicastInterfaces(true).findAny().orElse(null);\n","filename":"test\/jdk\/java\/net\/SocketOption\/OptionsTest.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n-    permission java.net.SocketPermission \"*:*\", \"connect, accept, listen, resolve\";\n+    permission java.net.SocketPermission \"localhost:*\", \"connect, accept, listen, resolve\";\n@@ -29,0 +29,8 @@\n+\/\/ for JTwork\/classes\/test\/lib\/jdk\/test\/lib\/Platform.class\n+grant codeBase \"file:${test.classes}\/..\/..\/..\/..\/test\/lib\/-\" {\n+    permission java.util.PropertyPermission \"*\", \"read\";\n+};\n+\/\/ for JTwork\/classes\/test\/lib\/jdk\/test\/lib\/NetworkConfiguration.class\n+grant codeBase \"file:${test.classes}\/..\/..\/..\/..\/test\/lib\/-\" {\n+    permission java.net.SocketPermission \"*:*\", \"connect\";\n+};\n","filename":"test\/jdk\/java\/net\/SocketOption\/options.policy","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -396,1 +396,4 @@\n-            for (InetAddress addr : list(nif.getInetAddresses())) {\n+            @SuppressWarnings(\"removal\")\n+            List<InetAddress> addrList = AccessController.doPrivileged(\n+                    (PrivilegedAction<List<InetAddress>>) () -> list(nif.getInetAddresses()));\n+            for (InetAddress addr : addrList) {\n","filename":"test\/lib\/jdk\/test\/lib\/NetworkConfiguration.java","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"}]}