{"files":[{"patch":"@@ -63,1 +63,2 @@\n-        return new OfRef<>(upstream, comparator);\n+        return Comparator.naturalOrder().equals(comparator) ?\n+                new OfRef<>(upstream) : new OfRef<>(upstream, comparator);\n","filename":"src\/java.base\/share\/classes\/java\/util\/stream\/SortedOps.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import java.util.Comparator;\n@@ -741,3 +742,3 @@\n-     * {@code Comparator} is {@code null}) then the characteristic is converted\n-     * to the {@link #SORTED} flag, otherwise the characteristic is not\n-     * converted.\n+     * {@code Comparator} is {@code null} or {@code Comparator.naturalOrder()}) then\n+     * the characteristic is converted to the {@link #SORTED} flag, otherwise\n+     * the characteristic is not converted.\n@@ -751,1 +752,3 @@\n-        if ((characteristics & Spliterator.SORTED) != 0 && spliterator.getComparator() != null) {\n+        if ((characteristics & Spliterator.SORTED) != 0 &&\n+                !(spliterator.getComparator() == null ||\n+                        spliterator.getComparator().equals(Comparator.naturalOrder()))) {\n","filename":"src\/java.base\/share\/classes\/java\/util\/stream\/StreamOpFlag.java","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -380,0 +380,5 @@\n+\n+        {\n+            int flags = StreamOpFlag.fromCharacteristics(new SortedEmptySpliterator(Comparator.naturalOrder()));\n+            assertEquals(flags, StreamOpFlag.IS_SORTED);\n+        }\n","filename":"test\/jdk\/java\/util\/stream\/boottest\/java.base\/java\/util\/stream\/StreamOpFlagsTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.util.Comparator;\n@@ -118,0 +119,1 @@\n+        assertSorted(to10.stream().sorted(Comparator.naturalOrder()).iterator());\n@@ -122,0 +124,3 @@\n+        s = to10.stream().sorted(Comparator.naturalOrder()).spliterator();\n+        assertTrue(s.hasCharacteristics(Spliterator.SORTED));\n+\n","filename":"test\/jdk\/java\/util\/stream\/test\/org\/openjdk\/tests\/java\/util\/stream\/SortedOpTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"}]}