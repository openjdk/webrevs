{"files":[{"patch":"@@ -752,9 +752,7 @@\n-        if ((characteristics & Spliterator.SORTED) != 0 &&\n-                (spliterator.getComparator() instanceof Comparator c &&\n-                        !c.equals(Comparator.naturalOrder()))) {\n-            \/\/ Do not propagate the SORTED characteristic if it does not correspond\n-            \/\/ to a natural sort order\n-            return characteristics & SPLITERATOR_CHARACTERISTICS_MASK & ~Spliterator.SORTED;\n-        }\n-        else {\n-            return characteristics & SPLITERATOR_CHARACTERISTICS_MASK;\n+        if ((characteristics & Spliterator.SORTED) != 0) {\n+            Comparator<?> comparator = spliterator.getComparator();\n+            if (comparator != null && !Comparator.naturalOrder().equals(comparator)) {\n+                \/\/ Do not propagate the SORTED characteristic if it does not correspond\n+                \/\/ to a natural sort order\n+                return characteristics & SPLITERATOR_CHARACTERISTICS_MASK & ~Spliterator.SORTED;\n+            }\n@@ -762,0 +760,1 @@\n+        return characteristics & SPLITERATOR_CHARACTERISTICS_MASK;\n","filename":"src\/java.base\/share\/classes\/java\/util\/stream\/StreamOpFlag.java","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"}]}