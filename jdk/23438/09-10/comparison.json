{"files":[{"patch":"@@ -1398,1 +1398,0 @@\n-  const TypeInteger* mask_t;\n@@ -1400,3 +1399,5 @@\n-  if (and_node->Opcode() == Op_And(bt) &&\n-      (mask_t = phase->type(and_node->in(2))->isa_integer(bt)) &&\n-      mask_t->is_con()) {\n+  if (and_node->Opcode() != Op_And(bt)) {\n+    return nullptr;\n+  }\n+  const TypeInteger* mask_t = phase->type(and_node->in(2))->isa_integer(bt);\n+  if (mask_t != nullptr && mask_t->is_con()) {\n@@ -1428,4 +1429,5 @@\n-  const TypeInt* left_shift_t;\n-  if (shift == 16 &&\n-      (left_shift_t = phase->type(shl->in(2))->isa_int()) &&\n-      left_shift_t->is_con(16)) {\n+  const TypeInt* left_shift_t = phase->type(shl->in(2))->isa_int();\n+  if (left_shift_t == nullptr) {\n+    return nullptr;\n+  }\n+  if (shift == 16 && left_shift_t->is_con(16)) {\n@@ -1451,3 +1453,1 @@\n-  if (shift == 24 &&\n-      (left_shift_t = phase->type(shl->in(2))->isa_int()) &&\n-      left_shift_t->is_con(24)) {\n+  if (shift == 24 && left_shift_t->is_con(24)) {\n","filename":"src\/hotspot\/share\/opto\/mulnode.cpp","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -325,1 +325,1 @@\n-  RShiftNode(Node* in1, Node* in2) : Node(nullptr,in1,in2) {}\n+  RShiftNode(Node* in1, Node* in2) : Node(nullptr, in1, in2) {}\n@@ -336,1 +336,1 @@\n-  RShiftINode(Node* in1, Node* in2) : RShiftNode(in1,in2) {}\n+  RShiftINode(Node* in1, Node* in2) : RShiftNode(in1, in2) {}\n","filename":"src\/hotspot\/share\/opto\/mulnode.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @bug 8320330\n+ * @bug 8320330 8349361\n@@ -106,1 +106,1 @@\n-    final static int test5Shift = RunInfo.getRandom().nextInt(32);\n+    final static int test5Shift = RunInfo.getRandom().nextInt(1, 32);\n@@ -136,1 +136,1 @@\n-    final static int test7Shift = RunInfo.getRandom().nextInt(32);\n+    final static int test7Shift = RunInfo.getRandom().nextInt(1, 32);\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/irTests\/RShiftINodeIdealizationTests.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -106,1 +106,1 @@\n-    final static int test5Shift = RunInfo.getRandom().nextInt(64);\n+    final static int test5Shift = RunInfo.getRandom().nextInt(1, 64);\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/irTests\/RShiftLNodeIdealizationTests.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}