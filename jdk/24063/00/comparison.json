{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -98,0 +98,1 @@\n+HOTSPOT_SETUP_IMPORT_JVMS\n","filename":"make\/autoconf\/configure.ac","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -105,0 +105,43 @@\n+################################################################################\n+# Setup an optional list of additional JVMs that should be included during\n+# build.\n+#\n+AC_DEFUN_ONCE([HOTSPOT_SETUP_IMPORT_JVMS],\n+[\n+  UTIL_ARG_WITH(NAME: import-jvms, TYPE: string,\n+      DEFAULT: [],\n+      DESC: [Additional JVMs to import, on the format <name>:<path to jvm lib>, separated by commas],\n+      OPTIONAL: true)\n+\n+  IMPORT_JVMS=\n+  IMPORT_JVM_NAMES=\n+  AC_MSG_CHECKING([for import JVMs])\n+  # Create a nicely formatted list of import JVM names\n+  [ import_jvm_names=\"`$ECHO $with_import_jvms | $SED -E -e 's\/([^:,]+):[^,]+\/\\1\/g; s\/,\/, \/g'`\" ]\n+  if test \"x$import_jvm_names\" = x; then\n+    AC_MSG_RESULT([none])\n+  else\n+    AC_MSG_RESULT([$import_jvm_names])\n+\n+    import_jvms=\"`$ECHO $with_import_jvms | $SED -e 's\/,\/ \/g'`\"\n+\n+    for import_jvm in $import_jvms; do\n+      import_jvm_name=`$ECHO $import_jvm | $CUT -d: -f1`\n+      import_jvm_lib=`$ECHO $import_jvm | $CUT -d: -f2`\n+      if test \"x$import_jvm_name\" = \"x$JVM_VARIANT_MAIN\"; then\n+        AC_MSG_ERROR([JVM name '$JVM_VARIANT_MAIN' is not allowed for an import JVM])\n+      fi\n+      if ! test -e $import_jvm_lib; then\n+        AC_MSG_ERROR([Import JVM '$import_jvm_name' not found at $import_jvm_lib])\n+      fi\n+\n+      UTIL_FIXUP_PATH(import_jvm_lib)\n+      AC_MSG_NOTICE([Importing JVM '$import_jvm_name' from $import_jvm_lib])\n+      IMPORT_JVM_NAMES=\"$IMPORT_JVM_NAMES $import_jvm_name\"\n+      IMPORT_JVMS=\"$IMPORT_JVMS $import_jvm_name:$import_jvm_lib\"\n+    done\n+  fi\n+  AC_SUBST(IMPORT_JVMS)\n+  AC_SUBST(IMPORT_JVM_NAMES)\n+])\n+\n","filename":"make\/autoconf\/hotspot.m4","additions":44,"deletions":1,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -326,0 +326,3 @@\n+IMPORT_JVMS := @IMPORT_JVMS@\n+IMPORT_JVM_NAMES := @IMPORT_JVM_NAMES@\n+\n","filename":"make\/autoconf\/spec.gmk.template","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -86,6 +86,2 @@\n-# In jvm.cfg, the first listed KNOWN variant is the default. On most build\n-# configurations, that is the server variant.\n-ifeq ($(call And, $(call isTargetOs, windows) $(call isTargetCpu, x86)), true)\n-  DEFAULT_CFG_VARIANT ?= client\n-endif\n-DEFAULT_CFG_VARIANT ?= server\n+# In jvm.cfg, the first listed KNOWN variant is the default.\n+DEFAULT_CFG_VARIANT := $(JVM_VARIANT_MAIN)\n@@ -98,0 +94,3 @@\n+# Append imported JVMs\n+ORDERED_CFG_VARIANTS += $(IMPORT_JVM_NAMES)\n+\n@@ -122,0 +121,20 @@\n+# Copy import JVMs into place, if any\n+#\n+ifneq ($(IMPORT_JVM_NAMES),)\n+  rename_to_libjvm = $(LIBRARY_PREFIX)jvm$(SHARED_LIBRARY_SUFFIX)\n+\n+  $(foreach import_jvm, $(IMPORT_JVM_NAMES), \\\n+    $(eval $(import_jvm)_path := $(patsubst $(import_jvm):%,%,$(filter $(import_jvm):%, $(IMPORT_JVMS)))) \\\n+    $(eval $(call MakeDir, $(LIB_DST_DIR)\/$(import_jvm))) \\\n+    $(eval $(call SetupCopyFiles, IMPORT_JVM_$(import_jvm), \\\n+        FILES := $($(import_jvm)_path), \\\n+        DEST := $(LIB_DST_DIR)\/$(import_jvm), \\\n+        FLATTEN := true, \\\n+        NAME_MACRO := rename_to_libjvm, \\\n+        LOG_ACTION := Copying import JVM '$(import_jvm)', \\\n+    )) \\\n+    $(eval TARGETS += $(IMPORT_JVM_$(import_jvm))) \\\n+  )\n+endif\n+\n+################################################################################\n","filename":"make\/modules\/java.base\/Copy.gmk","additions":25,"deletions":6,"binary":false,"changes":31,"status":"modified"}]}