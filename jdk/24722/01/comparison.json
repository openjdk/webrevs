{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -352,1 +352,1 @@\n-      print_debug(\"can't allocate memory for thread_info\\n\");\n+      print_error(\"can't allocate memory for thread_info\\n\");\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/libproc_impl.c","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+#include <errno.h>\n@@ -70,1 +71,1 @@\n-    print_debug(\"can't allocate memory for map array\\n\");\n+    print_error(\"can't allocate memory for map array\\n\");\n@@ -192,1 +193,2 @@\n-   if((newthr = add_thread_info(ph, prstat->pr_pid)) == NULL)\n+   if((newthr = add_thread_info(ph, prstat->pr_pid)) == NULL) {\n+      print_error(\"failed to add thread info\\n\");\n@@ -194,0 +196,1 @@\n+   }\n@@ -259,1 +262,1 @@\n-      print_debug(\"failed to lseek to PT_NOTE data\\n\");\n+      print_error(\"failed to lseek to PT_NOTE data\\n\");\n@@ -266,1 +269,1 @@\n-      print_debug(\"can't allocate memory for reading core notes\\n\");\n+      print_error(\"can't allocate memory for reading core notes\\n\");\n@@ -272,1 +275,1 @@\n-      print_debug(\"failed to read notes, core file must have been truncated\\n\");\n+      print_error(\"failed to read notes, core file must have been truncated\\n\");\n@@ -285,0 +288,1 @@\n+          print_error(\"failed to handle NT_PRSTATUS note\\n\");\n@@ -317,1 +321,2 @@\n-   if ((phbuf =  read_program_header_table(ph->core->core_fd, core_ehdr)) == NULL)\n+   if ((phbuf =  read_program_header_table(ph->core->core_fd, core_ehdr)) == NULL) {\n+      print_error(\"failed to read program header table\\n\");\n@@ -319,0 +324,1 @@\n+   }\n@@ -347,0 +353,1 @@\n+              print_error(\"failed to read note segment\\n\");\n@@ -354,1 +361,4 @@\n-                  core_php->p_vaddr, core_php->p_filesz, core_php->p_flags) == NULL) goto err;\n+                     core_php->p_vaddr, core_php->p_filesz, core_php->p_flags) == NULL) {\n+                  print_error(\"failed to add map info\\n\");\n+                  goto err;\n+               }\n@@ -379,0 +389,1 @@\n+    print_error(\"failed to read program header table\\n\");\n@@ -394,0 +405,1 @@\n+          print_error(\"failed to add map info\\n\");\n@@ -415,1 +427,1 @@\n-          print_debug(\"address conflict @ 0x%lx (existing map size = %ld, size = %ld, flags = %d)\\n\",\n+          print_error(\"address conflict @ 0x%lx (existing map size = %ld, size = %ld, flags = %d)\\n\",\n@@ -445,1 +457,1 @@\n-    print_debug(\"interpreter is not a valid ELF file\\n\");\n+    print_error(\"interpreter is not a valid ELF file\\n\");\n@@ -450,1 +462,1 @@\n-    print_debug(\"can't read segments of interpreter\\n\");\n+    print_error(\"can't read segments of interpreter\\n\");\n@@ -466,0 +478,1 @@\n+    print_error(\"failed to read program header table\\n\");\n@@ -476,1 +489,4 @@\n-        if (add_map_info(ph, ph->core->exec_fd, exec_php->p_offset, exec_php->p_vaddr, exec_php->p_filesz, exec_php->p_flags) == NULL) goto err;\n+        if (add_map_info(ph, ph->core->exec_fd, exec_php->p_offset, exec_php->p_vaddr, exec_php->p_filesz, exec_php->p_flags) == NULL) {\n+          print_error(\"failed to add map info\\n\");\n+          goto err;\n+        }\n@@ -487,0 +503,1 @@\n+        print_error(\"Invalid ELF interpreter info\\n\");\n@@ -491,1 +508,1 @@\n-        print_debug(\"Unable to read in the ELF interpreter\\n\");\n+        print_error(\"Unable to read in the ELF interpreter\\n\");\n@@ -498,1 +515,1 @@\n-        print_debug(\"can't open runtime loader\\n\");\n+        print_error(\"can't open runtime loader\\n\");\n@@ -558,1 +575,1 @@\n-    print_debug(\"can't read program header of shared object\\n\");\n+    print_error(\"can't read program header of shared object\\n\");\n@@ -574,1 +591,1 @@\n-    print_debug(\"can't read address of dynamic section in shared object\\n\");\n+    print_error(\"can't read address of dynamic section in shared object\\n\");\n@@ -610,1 +627,1 @@\n-      print_debug(\"can't read debug info from _DYNAMIC\\n\");\n+      print_error(\"can't read debug info from _DYNAMIC\\n\");\n@@ -621,1 +638,1 @@\n-    print_debug(\"can't read first link map address\\n\");\n+    print_error(\"can't read first link map address\\n\");\n@@ -628,1 +645,1 @@\n-    print_debug(\"can't read ld base address\\n\");\n+    print_error(\"can't read ld base address\\n\");\n@@ -637,0 +654,1 @@\n+      print_error(\"failed to read interp segments\\n\");\n@@ -642,0 +660,1 @@\n+    print_error(\"failed to sort segment map array\\n\");\n@@ -657,1 +676,1 @@\n-         print_debug(\"can't read shared object base address diff\\n\");\n+         print_error(\"can't read shared object base address diff\\n\");\n@@ -664,1 +683,1 @@\n-         print_debug(\"can't read address of shared object name\\n\");\n+         print_error(\"can't read address of shared object name\\n\");\n@@ -690,0 +709,1 @@\n+                   print_error(\"failed to calculate load address\\n\");\n@@ -699,1 +719,1 @@\n-                  print_debug(\"can't read shared object's segments\\n\");\n+                  print_error(\"can't read shared object's segments\\n\");\n@@ -706,1 +726,2 @@\n-               if (sort_map_array(ph) != true)\n+               if (sort_map_array(ph) != true) {\n+                  print_error(\"failed to sort segment map array\\n\");\n@@ -708,0 +729,1 @@\n+               }\n@@ -719,1 +741,1 @@\n-      print_debug(\"can't read next link in link_map\\n\");\n+      print_error(\"can't read next link in link_map\\n\");\n@@ -735,1 +757,1 @@\n-    print_debug(\"can't allocate ps_prochandle\\n\");\n+    print_error(\"can't allocate ps_prochandle\\n\");\n@@ -741,1 +763,1 @@\n-    print_debug(\"can't allocate ps_prochandle\\n\");\n+    print_error(\"can't allocate ps_prochandle\\n\");\n@@ -753,1 +775,1 @@\n-    print_debug(\"can't open core file\\n\");\n+    print_error(\"can't open core file: %s\\n\", strerror(errno));\n@@ -759,1 +781,1 @@\n-    print_debug(\"core file is not a valid ELF ET_CORE file\\n\");\n+    print_error(\"core file is not a valid ELF ET_CORE file\\n\");\n@@ -764,1 +786,1 @@\n-    print_debug(\"can't open executable file\\n\");\n+    print_error(\"can't open executable file: %s\\n\", strerror(errno));\n@@ -770,1 +792,1 @@\n-    print_debug(\"executable file is not a valid ELF file\\n\");\n+    print_error(\"executable file is not a valid ELF file\\n\");\n@@ -776,0 +798,1 @@\n+    print_error(\"failed to read core segments\\n\");\n@@ -782,0 +805,1 @@\n+    print_error(\"failed to read exec segments\\n\");\n@@ -786,0 +810,1 @@\n+    print_error(\"failed to add lib info\\n\");\n@@ -793,0 +818,1 @@\n+    print_error(\"failed to sort segment map array\\n\");\n@@ -797,0 +823,1 @@\n+    print_error(\"failed to read libraries\\n\");\n@@ -802,0 +829,1 @@\n+    print_error(\"failed to sort segment map array\\n\");\n@@ -806,0 +834,1 @@\n+    print_error(\"failed to workaround class sharing\\n\");\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/ps_core.c","additions":59,"deletions":30,"binary":false,"changes":89,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -352,1 +352,1 @@\n-    print_debug(\"can't open \/proc\/%d\/maps file\\n\", ph->pid);\n+    print_error(\"can't open \/proc\/%d\/maps file\\n\", ph->pid);\n@@ -450,1 +450,1 @@\n-    print_debug(\"%s\\n\", err_buf);\n+    print_error(\"%s\\n\", err_buf);\n@@ -457,0 +457,2 @@\n+    } else {\n+       print_error(\"Failed to attach to the process with pid %d.\\n\", pid);\n@@ -464,1 +466,5 @@\n-  add_thread_info(ph, ph->pid);\n+  if (add_thread_info(ph, ph->pid) == NULL) {\n+    print_error(\"failed to add thread info\\n\");\n+    free(ph);\n+    return NULL;\n+  }\n@@ -472,1 +478,4 @@\n-  read_lib_info(ph);\n+  if (read_lib_info(ph) == false) {\n+    print_error(\"failed to read lib info\\n\");\n+    goto err;\n+  }\n@@ -494,1 +503,4 @@\n-      add_thread_info(ph, lwp_id);\n+      if (add_thread_info(ph, lwp_id) == NULL) {\n+        print_error(\"failed to add thread info\\n\");\n+        goto err;\n+      }\n@@ -513,2 +525,2 @@\n-          Prelease(ph);\n-          return NULL;\n+          print_error(\"Failed to attach to the thread with lwp_id %d.\\n\", current_thr->lwp_id);\n+          goto err;\n@@ -520,0 +532,3 @@\n+err:\n+  Prelease(ph);\n+  return NULL;\n","filename":"src\/jdk.hotspot.agent\/linux\/native\/libsaproc\/ps_proc.c","additions":23,"deletions":8,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -326,1 +326,1 @@\n-    print_debug(\"can't allocate memory for thread_info\\n\");\n+    print_error(\"can't allocate memory for thread_info\\n\");\n","filename":"src\/jdk.hotspot.agent\/macosx\/native\/libsaproc\/libproc_impl.c","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -77,1 +77,1 @@\n-    print_debug(\"can't allocate memory for map array\\n\");\n+    print_error(\"can't allocate memory for map array\\n\");\n@@ -283,0 +283,1 @@\n+     print_error(\"Failed to read program header table\\n\");\n@@ -290,0 +291,1 @@\n+      print_error(\"Failed to read command\\n\");\n@@ -297,1 +299,1 @@\n-        print_debug(\"failed to read LC_SEGMENT_64 i = %d!\\n\", i);\n+        print_error(\"failed to read LC_SEGMENT_64 i = %d!\\n\", i);\n@@ -304,1 +306,1 @@\n-          print_debug(\"Failed to add map_info at i = %d\\n\", i);\n+          print_error(\"Failed to add map_info at i = %d\\n\", i);\n@@ -321,1 +323,1 @@\n-          printf(\"Reading flavor, count failed.\\n\");\n+          print_error(\"Reading flavor, count failed.\\n\");\n@@ -329,1 +331,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -336,1 +338,1 @@\n-            printf(\"create thread_info failed\\n\");\n+            print_error(\"create thread_info failed\\n\");\n@@ -373,1 +375,1 @@\n-            print_debug(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -380,1 +382,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -390,1 +392,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -397,1 +399,1 @@\n-            printf(\"create thread_info failed\\n\");\n+            print_error(\"create thread_info failed\\n\");\n@@ -446,1 +448,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -453,1 +455,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -460,1 +462,1 @@\n-            printf(\"Reading flavor, count failed.\\n\");\n+            print_error(\"Reading flavor, count failed.\\n\");\n@@ -634,0 +636,1 @@\n+        print_error(\"Failed to file header\\n\");\n@@ -644,0 +647,1 @@\n+          print_error(\"Failed to read command\\n\");\n@@ -655,0 +659,1 @@\n+            print_error(\"Failed to read command\\n\");\n@@ -713,1 +718,1 @@\n-    print_debug(\"can't allocate ps_prochandle\\n\");\n+    print_error(\"can't allocate ps_prochandle\\n\");\n@@ -719,1 +724,1 @@\n-    print_debug(\"can't allocate ps_prochandle\\n\");\n+    print_error(\"can't allocate ps_prochandle\\n\");\n@@ -741,1 +746,1 @@\n-    print_debug(\"core file is not a valid Mach-O file\\n\");\n+    print_error(\"core file is not a valid Mach-O file\\n\");\n@@ -746,1 +751,1 @@\n-    print_error(\"can't open executable file\\n\");\n+    print_error(\"can't open executable file: %s\\n\", strerror(errno));\n@@ -782,1 +787,1 @@\n-    print_error(\"failed to workaround classshareing\\n\");\n+    print_error(\"failed to workaround class sharing\\n\");\n","filename":"src\/jdk.hotspot.agent\/macosx\/native\/libsaproc\/ps_core.c","additions":24,"deletions":19,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -144,0 +144,1 @@\n+    print_error(\"failed to allocate map\\n\");\n@@ -161,0 +162,1 @@\n+    print_debug(\"failed to allocate class share map\\n\");\n","filename":"src\/jdk.hotspot.agent\/share\/native\/libsaproc\/ps_core_common.c","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}