{"files":[{"patch":"@@ -347,3 +347,0 @@\n-  } else if (w.is_being_inflated() || w.has_displaced_mark_helper()) {\n-    \/\/ Informs caller that we aren't able to determine the age\n-    return markWord::max_age + 1; \/\/ sentinel\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.inline.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -63,7 +63,0 @@\n-\/\/    [0 ............ 0| 00]  inflating          inflation in progress (stack-locking in use)\n-\/\/\n-\/\/    We assume that stack\/thread pointers have the lowest two bits cleared.\n-\/\/\n-\/\/  - INFLATING() is a distinguished markword value of all zeros that is\n-\/\/    used when inflating an existing stack-lock into an ObjectMonitor.\n-\/\/    See below for is_being_inflated() and INFLATING().\n@@ -176,13 +169,0 @@\n-  \/\/ Special temporary state of the markWord while being inflated.\n-  \/\/ Code that looks at mark outside a lock need to take this into account.\n-  bool is_being_inflated() const { return (value() == 0); }\n-\n-  \/\/ Distinguished markword value - used when inflating over\n-  \/\/ an existing stack-lock.  0 indicates the markword is \"BUSY\".\n-  \/\/ Lockword mutators that use a LD...CAS idiom should always\n-  \/\/ check for and avoid overwriting a 0 value installed by some\n-  \/\/ other thread.  (They should spin or block instead.  The 0 value\n-  \/\/ is transient and *should* be short-lived).\n-  \/\/ Fast-locking does not use INFLATING.\n-  static markWord INFLATING() { return zero(); }    \/\/ inflate-in-progress\n-\n@@ -212,0 +192,3 @@\n+  markWord set_has_monitor() const {\n+    return markWord((value() & ~lock_mask_in_place) | monitor_value);\n+  }\n@@ -218,21 +201,1 @@\n-  bool has_displaced_mark_helper() const {\n-    intptr_t lockbits = value() & lock_mask_in_place;\n-    return !UseObjectMonitorTable && lockbits == monitor_value;\n-  }\n-  markWord displaced_mark_helper() const;\n-  void set_displaced_mark_helper(markWord m) const;\n-  markWord copy_set_hash(intptr_t hash) const {\n-    uintptr_t tmp = value() & (~hash_mask_in_place);\n-    tmp |= ((hash & hash_mask) << hash_shift);\n-    return markWord(tmp);\n-  }\n-  \/\/ it is only used to be stored into BasicLock as the\n-  \/\/ indicator that the lock is using heavyweight monitor\n-  static markWord unused_mark() {\n-    return markWord(marked_value);\n-  }\n-  \/\/ the following two functions create the markWord to be\n-  \/\/ stored into object header, it encodes monitor info\n-  static markWord encode(BasicLock* lock) {\n-    return from_pointer(lock);\n-  }\n+\n@@ -245,2 +208,3 @@\n-  markWord set_has_monitor() const {\n-    return markWord((value() & ~lock_mask_in_place) | monitor_value);\n+  bool has_displaced_mark_helper() const {\n+    intptr_t lockbits = value() & lock_mask_in_place;\n+    return !UseObjectMonitorTable && lockbits == monitor_value;\n@@ -248,0 +212,2 @@\n+  markWord displaced_mark_helper() const;\n+  void set_displaced_mark_helper(markWord m) const;\n@@ -272,0 +238,6 @@\n+  markWord copy_set_hash(intptr_t hash) const {\n+    uintptr_t tmp = value() & (~hash_mask_in_place);\n+    tmp |= ((hash & hash_mask) << hash_shift);\n+    return markWord(tmp);\n+  }\n+\n","filename":"src\/hotspot\/share\/oops\/markWord.hpp","additions":15,"deletions":43,"binary":false,"changes":58,"status":"modified"}]}