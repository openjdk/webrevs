{"files":[{"patch":"@@ -611,1 +611,0 @@\n-sun\/security\/provider\/certpath\/OCSP\/OCSPNoContentLength.java    8300939 generic-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -324,1 +324,1 @@\n-        return dumpHexBytes(data, 16, \"\\n\", \" \");\n+        return dumpHexBytes(data, data.length, 16, \"\\n\", \" \");\n@@ -329,1 +329,2 @@\n-     * @param data the array of bytes to dump to stdout.\n+     * @param data the array of bytes to dump to stdout\n+     * @param dataLen the length of the data to be displayed\n@@ -338,2 +339,2 @@\n-    private static String dumpHexBytes(byte[] data, int itemsPerLine,\n-            String lineDelim, String itemDelim) {\n+    private static String dumpHexBytes(byte[] data, int dataLen,\n+            int itemsPerLine, String lineDelim, String itemDelim) {\n@@ -342,1 +343,1 @@\n-            for (int i = 0; i < data.length; i++) {\n+            for (int i = 0; i < dataLen; i++) {\n@@ -492,0 +493,1 @@\n+            log(\"Signature algorithm set to \" + sigAlgId.getName());\n@@ -555,0 +557,2 @@\n+            log(\"Response Content-Length field \" +\n+                    (isDisabled ? \"disabled\" : \"enabled\"));\n@@ -729,0 +733,4 @@\n+\n+                \/\/ Read in the first line which will be the request line.\n+                \/\/ This will be tokenized so we know if we are dealing with\n+                \/\/ a GET or POST.\n@@ -737,1 +745,1 @@\n-                        switch (headerTokens[0]) {\n+                        switch (headerTokens[0].toUpperCase()) {\n@@ -742,1 +750,1 @@\n-                                ocspReq = parseHttpOcspGet(headerTokens);\n+                                ocspReq = parseHttpOcspGet(headerTokens, in);\n@@ -776,0 +784,3 @@\n+                out.flush();\n+\n+                log(\"Closing \" + ocspSocket);\n@@ -873,0 +884,2 @@\n+         * @param inStream the input stream from the socket bound to this\n+         * {@code OcspHandler}.\n@@ -881,2 +894,20 @@\n-        private LocalOcspRequest parseHttpOcspGet(String[] headerTokens)\n-                throws IOException, CertificateException {\n+        private LocalOcspRequest parseHttpOcspGet(String[] headerTokens,\n+                InputStream inStream) throws IOException, CertificateException {\n+            \/\/ Before we process the remainder of the GET URL, we should drain\n+            \/\/ the InputStream of any other header data.  We (for now) won't\n+            \/\/ use it, but will display the contents if logging is enabled.\n+            boolean endOfHeader = false;\n+            while (!endOfHeader) {\n+                String[] lineTokens = readLine(inStream).split(\":\", 2);\n+                \/\/ We expect to see a type and value pair delimited by a colon.\n+                if (lineTokens[0].isEmpty()) {\n+                    endOfHeader = true;\n+                } else if (lineTokens.length == 2) {\n+                    log(String.format(\"ReqHdr: %s: %s\", lineTokens[0].trim(),\n+                            lineTokens[1].trim()));\n+                } else {\n+                    \/\/ A colon wasn't found and token 0 should be the whole line\n+                    log(\"ReqHdr: \" + lineTokens[0].trim());\n+                }\n+            }\n+\n@@ -1203,1 +1234,3 @@\n-                sb.append(dumpHexBytes(cid.getIssuerNameHash(), 256, \"\", \"\"));\n+                byte[] cidHashBuf = cid.getIssuerNameHash();\n+                sb.append(dumpHexBytes(cidHashBuf, cidHashBuf.length,\n+                        256, \"\", \"\"));\n@@ -1206,1 +1239,3 @@\n-                sb.append(dumpHexBytes(cid.getIssuerKeyHash(), 256, \"\", \"\"));\n+                cidHashBuf = cid.getIssuerKeyHash();\n+                sb.append(dumpHexBytes(cidHashBuf, cidHashBuf.length,\n+                        256, \"\", \"\"));\n@@ -1546,1 +1581,3 @@\n-                sb.append(dumpHexBytes(certId.getIssuerNameHash(), 256, \"\", \"\"));\n+                byte[] cidHashBuf = certId.getIssuerNameHash();\n+                sb.append(dumpHexBytes(cidHashBuf, cidHashBuf.length,\n+                        256, \"\", \"\"));\n@@ -1549,1 +1586,3 @@\n-                sb.append(dumpHexBytes(certId.getIssuerKeyHash(), 256, \"\", \"\"));\n+                cidHashBuf = certId.getIssuerKeyHash();\n+                sb.append(dumpHexBytes(cidHashBuf, cidHashBuf.length,\n+                        256, \"\", \"\"));\n","filename":"test\/jdk\/java\/security\/testlibrary\/SimpleOCSPServer.java","additions":52,"deletions":13,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-    static final boolean debug = false;\n+    static final boolean debug = true;\n@@ -70,1 +70,0 @@\n-\n","filename":"test\/jdk\/sun\/security\/provider\/certpath\/OCSP\/OCSPNoContentLength.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"}]}