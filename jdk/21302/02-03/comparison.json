{"files":[{"patch":"@@ -396,1 +396,1 @@\n-        _num_workers(MAX2(1, os::active_processor_count() \/ cpus_per_worker - 1)),\n+        _num_workers(MAX2(1, os::active_processor_count() \/ CPUS_PER_WORKER - 1)),\n@@ -431,1 +431,1 @@\n-  task->maybe_override_max_chunks(_num_workers * chunks_per_worker);\n+  task->maybe_override_max_chunks(_num_workers * CHUNKS_PER_WORKER);\n","filename":"src\/hotspot\/share\/cds\/archiveUtils.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -346,1 +346,1 @@\n-  static constexpr int cpus_per_worker = 4;\n+  static constexpr int CPUS_PER_WORKER = 4;\n@@ -350,1 +350,1 @@\n-  static constexpr int chunks_per_worker = 4;\n+  static constexpr int CHUNKS_PER_WORKER = 4;\n","filename":"src\/hotspot\/share\/cds\/archiveUtils.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1952,16 +1952,3 @@\n-    BitMapView* bm;\n-    SharedDataRelocator* reloc;\n-    int bitmap_chunk;\n-\n-    \/\/ Pick up the slice from one of the bitmaps.\n-    int chunks_per_bitmap = max_chunks \/ 2;\n-    if (chunk < chunks_per_bitmap) {\n-      bm = _rw_bm;\n-      reloc = _rw_reloc;\n-      bitmap_chunk = chunk;\n-    } else {\n-      \/\/ Processing RO bitmap\n-      bm = _ro_bm;\n-      reloc = _ro_reloc;\n-      bitmap_chunk = chunk - chunks_per_bitmap;\n-    }\n+    work_on(chunk, max_chunks, _rw_bm, _rw_reloc);\n+    work_on(chunk, max_chunks, _ro_bm, _ro_reloc);\n+  }\n@@ -1969,3 +1956,4 @@\n-    \/\/ Process the slice.\n-    BitMap::idx_t start = MIN2(bm->size(), bm->size() * bitmap_chunk \/ chunks_per_bitmap);\n-    BitMap::idx_t end   = MIN2(bm->size(), bm->size() * (bitmap_chunk + 1) \/ chunks_per_bitmap);\n+  void work_on(int chunk, int max_chunks, BitMapView* bm, SharedDataRelocator* reloc) {\n+    BitMap::idx_t size  = bm->size();\n+    BitMap::idx_t start = MIN2(size, size * chunk \/ max_chunks);\n+    BitMap::idx_t end   = MIN2(size, size * (chunk + 1) \/ max_chunks);\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":7,"deletions":19,"binary":false,"changes":26,"status":"modified"}]}