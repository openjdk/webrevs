{"files":[{"patch":"@@ -32,1 +32,0 @@\n-import java.io.File;\n@@ -39,0 +38,2 @@\n+import java.util.List;\n+import java.util.stream.Stream;\n@@ -88,5 +89,9 @@\n-            Files.walk(workDir)\n-                    .filter(Files::isRegularFile)\n-                    .filter(f -> (f.getFileName().toString().contains(\"core\") || f.getFileName().toString().contains(\"mdmp\")))\n-                    .forEach(core -> gatherCoreInfo(workDir, name,\n-                            core, log, gathererFactory.getCoreInfoGatherer()));\n+            \/\/ generate a cores.html file after parsing the core dump files (if any)\n+            List<Path> coreFiles;\n+            try (Stream<Path> paths = Files.walk(workDir)) {\n+                coreFiles = paths.filter(Files::isRegularFile)\n+                        .filter(f -> (f.getFileName().toString().contains(\"core\")\n+                                || f.getFileName().toString().contains(\"mdmp\")))\n+                        .toList();\n+            }\n+            gatherCoreInfo(workDir, name, coreFiles, log, gathererFactory.getCoreInfoGatherer());\n@@ -106,2 +111,5 @@\n-    private void gatherCoreInfo(Path workDir, String name, Path core, PrintWriter log,\n-                               CoreInfoGatherer gatherer) {\n+    private void gatherCoreInfo(Path workDir, String name, List<Path> coreFiles,\n+                                PrintWriter log, CoreInfoGatherer gatherer) {\n+        if (coreFiles.isEmpty()) {\n+            return;\n+        }\n@@ -111,1 +119,4 @@\n-                gatherer.gatherCoreInfo(html.getRootSection(), core);\n+                \/\/ gather information from the contents of each core file\n+                for (Path coreFile : coreFiles) {\n+                    gatherer.gatherCoreInfo(html.getRootSection(), coreFile);\n+                }\n@@ -114,2 +125,2 @@\n-            log.printf(\"ERROR: exception in observer on getting environment \"\n-                    + \"information %s:\", name);\n+            log.printf(\"ERROR: exception in %s observer while gathering information from\"\n+                    + \" core dump file\", name);\n","filename":"test\/failure_handler\/src\/share\/classes\/jdk\/test\/failurehandler\/jtreg\/GatherDiagnosticInfoObserver.java","additions":22,"deletions":11,"binary":false,"changes":33,"status":"modified"}]}