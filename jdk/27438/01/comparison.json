{"files":[{"patch":"@@ -184,0 +184,10 @@\n+            \/\/ From RFC 8446 \"Implementations\n+            \/\/ MUST NOT send Handshake and Alert records that have a zero-length\n+            \/\/ TLSInnerPlaintext.content; if such a message is received, the\n+            \/\/ receiving implementation MUST terminate the connection with an\n+            \/\/ \"unexpected_message\" alert.\"\n+            if (m.remaining() == 0) {\n+                throw context.fatal(Alert.UNEXPECTED_MESSAGE,\n+                        \"Alert fragments must not be zero length.\");\n+            }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/Alert.java","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -1926,1 +1926,1 @@\n-                for (; i > 0 && pt.get(i) == 0; i--);\n+                for (; i >= pos && pt.get(i) == 0; i--);\n@@ -1928,1 +1928,1 @@\n-                if (i < (pos + 1)) {\n+                if (i < pos) {\n@@ -2444,4 +2444,3 @@\n-                for (; i > 0 && pt.get(i) == 0; i--) {\n-                    \/\/ blank\n-                }\n-                if (i < (pos + 1)) {\n+                for (; i >= pos && pt.get(i) == 0; i--);\n+\n+                if (i < pos) {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLCipher.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -106,1 +106,1 @@\n-        } catch (SSLHandshakeException exc) {\n+        } catch (SSLProtocolException exc) {\n@@ -136,1 +136,1 @@\n-        } catch (SSLHandshakeException exc) {\n+        } catch (SSLProtocolException exc) {\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLEngineImpl\/SSLEngineEmptyFragments.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -354,1 +354,1 @@\n-                tests::testEmptyAlertNotHandshaking, SSLHandshakeException.class);\n+                tests::testEmptyAlertNotHandshaking, SSLProtocolException.class);\n@@ -356,1 +356,1 @@\n-                tests::testEmptyAlertDuringHandshake, SSLHandshakeException.class);\n+                tests::testEmptyAlertDuringHandshake, SSLProtocolException.class);\n@@ -364,1 +364,1 @@\n-                tests::testEmptyAlertNotHandshaking, SSLHandshakeException.class);\n+                tests::testEmptyAlertNotHandshaking, SSLProtocolException.class);\n","filename":"test\/jdk\/sun\/security\/ssl\/SSLSocketImpl\/SSLSocketEmptyFragments.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}