{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,1 +32,0 @@\n-import java.security.AccessController;\n@@ -78,23 +77,1 @@\n-    @SuppressWarnings(\"removal\")\n-    private synchronized void privilegedConnect(final String host,\n-                                              final int port,\n-                                              final int timeout)\n-        throws IOException\n-    {\n-        try {\n-            AccessController.doPrivileged(\n-                new java.security.PrivilegedExceptionAction<>() {\n-                    public Void run() throws IOException {\n-                              superConnectServer(host, port, timeout);\n-                              cmdIn = getInputStream();\n-                              cmdOut = getOutputStream();\n-                              return null;\n-                          }\n-                      });\n-        } catch (java.security.PrivilegedActionException pae) {\n-            throw (IOException) pae.getException();\n-        }\n-    }\n-\n-    private void superConnectServer(String host, int port,\n-                                    int timeout) throws IOException {\n+    private synchronized void doConnect(final String host, final int port, final int timeout) throws IOException {\n@@ -102,0 +79,2 @@\n+        cmdIn = getInputStream();\n+        cmdOut = getOutputStream();\n@@ -154,9 +133,2 @@\n-            @SuppressWarnings(\"removal\")\n-            PasswordAuthentication pw =\n-                java.security.AccessController.doPrivileged(\n-                    new java.security.PrivilegedAction<>() {\n-                        public PasswordAuthentication run() {\n-                                return Authenticator.requestPasswordAuthentication(\n-                                       server, addr, serverPort, \"SOCKS5\", \"SOCKS authentication\", null);\n-                            }\n-                        });\n+            PasswordAuthentication pw = Authenticator.requestPasswordAuthentication(\n+                    server, addr, serverPort, \"SOCKS5\", \"SOCKS authentication\", null);\n@@ -253,2 +225,0 @@\n-     * @throws  SecurityException if there is a security manager and it\n-     *                          doesn't allow the connection\n@@ -269,2 +239,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n@@ -273,8 +241,1 @@\n-        if (security != null) {\n-            if (epoint.isUnresolved())\n-                security.checkConnect(epoint.getHostName(),\n-                                      epoint.getPort());\n-            else\n-                security.checkConnect(epoint.getAddress().getHostAddress(),\n-                                      epoint.getPort());\n-        }\n+\n@@ -286,6 +247,1 @@\n-            ProxySelector sel = java.security.AccessController.doPrivileged(\n-                new java.security.PrivilegedAction<>() {\n-                    public ProxySelector run() {\n-                            return ProxySelector.getDefault();\n-                        }\n-                    });\n+            ProxySelector sel = ProxySelector.getDefault();\n@@ -340,1 +296,1 @@\n-                    privilegedConnect(server, serverPort, remainingMillis(deadlineMillis));\n+                    doConnect(server, serverPort, remainingMillis(deadlineMillis));\n@@ -364,1 +320,1 @@\n-                privilegedConnect(server, serverPort, remainingMillis(deadlineMillis));\n+                doConnect(server, serverPort, remainingMillis(deadlineMillis));\n@@ -370,1 +326,1 @@\n-        \/\/ cmdIn & cmdOut were initialized during the privilegedConnect() call\n+        \/\/ `cmdIn` & `cmdOut` were initialized during the `doConnect()` call\n","filename":"src\/java.base\/share\/classes\/java\/net\/SocksSocketImpl.java","additions":11,"deletions":55,"binary":false,"changes":66,"status":"modified"}]}