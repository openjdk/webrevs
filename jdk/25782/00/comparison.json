{"files":[{"patch":"@@ -47,0 +47,1 @@\n+#include \"compiler\/compilerDefinitions.inline.hpp\"\n@@ -235,0 +236,9 @@\n+  \/\/ Which JIT compier is used\n+  _compiler_type = (u1)CompilerType::compiler_none; \/\/ Interpreter only\n+  if (CompilerConfig::is_c2_enabled()) {\n+    _compiler_type = (u1)CompilerType::compiler_c2;\n+  } else if (CompilerConfig::is_jvmci_compiler_enabled()) {\n+    _compiler_type = (u1)CompilerType::compiler_jvmci;\n+  } else if (CompilerConfig::is_c1_enabled()) {\n+    _compiler_type = (u1)CompilerType::compiler_c1;\n+  }\n@@ -1938,0 +1948,25 @@\n+  bool jvmci_compiler_is_enabled = CompilerConfig::is_jvmci_compiler_enabled();\n+  CompilerType compiler_type = CompilerType::compiler_none; \/\/ Interpreter only\n+  if (CompilerConfig::is_c2_enabled()) {\n+    compiler_type = CompilerType::compiler_c2;\n+  } else if (jvmci_compiler_is_enabled) {\n+    compiler_type = CompilerType::compiler_jvmci;\n+  } else if (CompilerConfig::is_c1_enabled()) {\n+    compiler_type = CompilerType::compiler_c1;\n+  }\n+  CompilerType archive_compiler_type = CompilerType(_compiler_type);\n+  \/\/ JVMCI compiler loads additional jdk.internal.vm.ci module,\n+  \/\/ does different type profiling settigns and generate\n+  \/\/ different code. We can't use archive which was produced\n+  \/\/ without it and reverse.\n+  \/\/ Only allow mix when JIT compilation is disabled.\n+  \/\/ Interpreter is used by default when dumping archive.\n+  bool intepreter_is_used = (archive_compiler_type == CompilerType::compiler_none) ||\n+                            (compiler_type == CompilerType::compiler_none);\n+  if (!intepreter_is_used &&\n+      jvmci_compiler_is_enabled != (archive_compiler_type == CompilerType::compiler_jvmci)) {\n+    MetaspaceShared::report_loading_error(\"The %s's JIT compiler setting (%s)\"\n+                                          \" does not equal the current setting (%s).\", file_type,\n+                                          compilertype2name(archive_compiler_type), compilertype2name(compiler_type));\n+    return false;\n+  }\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":35,"deletions":0,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -150,0 +150,1 @@\n+  u1      _compiler_type;\n","filename":"src\/hotspot\/share\/cds\/filemap.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}