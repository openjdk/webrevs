{"files":[{"patch":"@@ -126,0 +126,8 @@\n+size_t G1Allocator::free_bytes_in_retained_old_region() const {\n+  if (_retained_old_gc_alloc_region == nullptr) {\n+    return 0;\n+  } else {\n+    return _retained_old_gc_alloc_region->free();\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Allocator.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -106,0 +106,1 @@\n+\n@@ -107,0 +108,2 @@\n+  \/\/ Return the amount of free bytes in the current retained old region.\n+  size_t free_bytes_in_retained_old_region() const;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Allocator.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2967,2 +2967,2 @@\n-  \/\/ For simplicity, just count whole regions.\n-  const size_t cur_occupancy = (old_regions_count() + humongous_regions_count()) * G1HeapRegion::GrainBytes;\n+  const size_t cur_occupancy = (old_regions_count() + humongous_regions_count()) * G1HeapRegion::GrainBytes -\n+                               _allocator->free_bytes_in_retained_old_region();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}