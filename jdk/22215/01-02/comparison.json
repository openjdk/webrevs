{"files":[{"patch":"@@ -46,0 +46,16 @@\n+    private final SecretKey EMPTY_KEY = new SecretKey() {\n+        @Override\n+        public String getAlgorithm() {\n+            return \"Generic\";\n+        }\n+\n+        @Override\n+        public String getFormat() {\n+            return \"RAW\";\n+        }\n+\n+        @Override\n+        public byte[] getEncoded() {\n+            return new byte[0];\n+        }\n+    };\n@@ -142,1 +158,1 @@\n-        } else if (salt != null) {\n+        } else if (salt != EMPTY_KEY) {\n@@ -188,2 +204,2 @@\n-                ret = P11Key.secretKey(session, derivedObjectID, alg, outLen,\n-                        null);\n+                ret = P11Key.secretKey(session, derivedObjectID, alg,\n+                        outLen * 8, null);\n@@ -246,1 +262,1 @@\n-                        derivedKeyID, \"Generic\", derivedKeyLen, null);\n+                        derivedKeyID, \"Generic\", derivedKeyLen * 8, null);\n@@ -268,1 +284,1 @@\n-            return null;\n+            return EMPTY_KEY;\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11KDF.java","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -135,1 +135,1 @@\n-                } else {\n+                } else if (baseKey != null) {\n@@ -614,0 +614,15 @@\n+    private static void test_AES_HKDFWithHmacSHA256_EmptyBaseKey() {\n+        executeTest(\"AES - HKDF-SHA256 (empty base key)\",\n+                \"HKDF-SHA256\",\n+                \"AES\",\n+                (SecretKey) null,\n+                \"101112131415161718191a1b1c1d1e1f\",\n+                \"a0a1a2a3a4a5a6a7a8a9aaabacadaeaf\",\n+                \"cc267bd9515c1eba2cf6aaa1fc8380677f4351fcbea6d70873df5a334efc\" +\n+                        \"ee0d\",\n+                \"cf353a33460b146c0eae3f0788ee281e5a0be15280fbeba107472aa1cd58\" +\n+                        \"d111\",\n+                \"326e9028f51c05c1919215bad6e35668c94c88040c3777e8e6f8b6acdece\" +\n+                        \"85fa\");\n+    }\n+\n","filename":"test\/jdk\/sun\/security\/pkcs11\/KDF\/TestHKDF.java","additions":16,"deletions":1,"binary":false,"changes":17,"status":"modified"}]}