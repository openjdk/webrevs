{"files":[{"patch":"@@ -1168,1 +1168,0 @@\n-  _safepoint_duration(0),\n@@ -1537,2 +1536,0 @@\n-  _safepoint_duration += synchronize_duration;\n-\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -189,1 +189,0 @@\n-  jlong _safepoint_duration;                       \/\/ Time spent in safepoints since start of VM.\n@@ -918,1 +917,0 @@\n-  jlong safepoint_duration() const { return _safepoint_duration; }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -150,2 +150,2 @@\n-void G1ConcurrentRefineSweepState::add_yield_duration(jlong duration) {\n-  stats()->inc_yield_duration(duration);\n+void G1ConcurrentRefineSweepState::add_yield_during_sweep_duration(jlong duration) {\n+  stats()->inc_yield_during_sweep_duration(duration);\n@@ -158,4 +158,0 @@\n-bool G1ConcurrentRefineSweepState::in_sweep_epoch() const {\n-  return _sweep_start_epoch == refinement_epoch();\n-}\n-\n@@ -163,1 +159,1 @@\n-  bool result = in_sweep_epoch();\n+  bool result = _sweep_start_epoch == refinement_epoch();\n@@ -203,1 +199,1 @@\n-    if (in_sweep_epoch()) {\n+    if (is_in_progress()) {\n@@ -330,1 +326,1 @@\n-                          \"refers_to_cset %zu (%.2f%%) still_refers_to_cset %zu (%.2f%%) clean_again %zu pending %zu)\",\n+                          \"refers_to_cset %zu (%.2f%%) still_refers_to_cset %zu (%.2f%%) no_cross_region %zu pending %zu)\",\n@@ -344,1 +340,1 @@\n-                          s->cards_clean_again(),\n+                          s->cards_no_cross_region(),\n@@ -349,1 +345,1 @@\n-  bool has_sweep_rt_work = is_in_progress() && _state == State::SweepRT;\n+  bool has_sweep_rt_work = _state == State::SweepRT;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefine.cpp","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -154,2 +154,0 @@\n-  bool in_sweep_epoch() const;\n-\n@@ -183,1 +181,1 @@\n-  void add_yield_duration(jlong duration);\n+  void add_yield_during_sweep_duration(jlong duration);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefine.hpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n-  _yield_duration(0),\n+  _yield_during_sweep_duration(0),\n@@ -37,1 +37,1 @@\n-  _cards_clean_again(0),\n+  _cards_no_cross_region(0),\n@@ -43,1 +43,1 @@\n-  Atomic::add(&_yield_duration, other->_yield_duration, memory_order_relaxed);\n+  Atomic::add(&_yield_during_sweep_duration, other->_yield_during_sweep_duration, memory_order_relaxed);\n@@ -50,1 +50,1 @@\n-  Atomic::add(&_cards_clean_again, other->_cards_clean_again, memory_order_relaxed);\n+  Atomic::add(&_cards_no_cross_region, other->_cards_no_cross_region, memory_order_relaxed);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefineStats.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-  jlong _yield_duration;              \/\/ Time spent yielding during the sweep (not doing the sweep).\n+  jlong _yield_during_sweep_duration; \/\/ Time spent yielding during the sweep (not doing the sweep).\n@@ -45,1 +45,1 @@\n-  size_t _cards_clean_again;          \/\/ Number of dirty cards that were cleaned by the mutator.\n+  size_t _cards_no_cross_region;      \/\/ Number of dirty cards that were dirtied, but then cleaned again by the mutator.\n@@ -54,2 +54,2 @@\n-  jlong sweep_duration() const { return _sweep_duration - _yield_duration; }\n-  jlong yield_duration() const { return _yield_duration; }\n+  jlong sweep_duration() const { return _sweep_duration - _yield_during_sweep_duration; }\n+  jlong yield_during_sweep_duration() const { return _yield_during_sweep_duration; }\n@@ -67,1 +67,1 @@\n-  size_t cards_clean_again() const { return _cards_clean_again; }\n+  size_t cards_no_cross_region() const { return _cards_no_cross_region; }\n@@ -75,1 +75,1 @@\n-  void inc_yield_duration(jlong t) { _yield_duration += t; }\n+  void inc_yield_during_sweep_duration(jlong t) { _yield_during_sweep_duration += t; }\n@@ -83,1 +83,1 @@\n-  void inc_cards_clean_again() { _cards_clean_again++; }\n+  void inc_cards_no_cross_region() { _cards_no_cross_region++; }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefineStats.hpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -73,2 +73,2 @@\n-      case G1RemSet::NoInteresting: {\n-        _refine_stats.inc_cards_clean_again();\n+      case G1RemSet::NoCrossRegion: {\n+        _refine_stats.inc_cards_no_cross_region();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefineSweepTask.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -172,1 +172,1 @@\n-  jlong synchronize_duration_at_sweep_start = g1h->safepoint_duration();\n+  jlong total_yield_during_sweep_duration = 0;\n@@ -190,1 +190,1 @@\n-      jlong yield_start = os::elapsed_counter();\n+      jlong yield_during_sweep_start = os::elapsed_counter();\n@@ -199,1 +199,1 @@\n-        jlong yield_duration = os::elapsed_counter() - yield_start;\n+        jlong yield_during_sweep_duration = os::elapsed_counter() - yield_during_sweep_start;\n@@ -201,1 +201,2 @@\n-                              TimeHelper::counter_to_millis(yield_duration));\n+                              TimeHelper::counter_to_millis(yield_during_sweep_duration));\n+        total_yield_during_sweep_duration += yield_during_sweep_duration;\n@@ -207,1 +208,1 @@\n-    state.add_yield_duration(G1CollectedHeap::heap()->safepoint_duration() - synchronize_duration_at_sweep_start);\n+    state.add_yield_during_sweep_duration(total_yield_during_sweep_duration);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefineThread.cpp","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -611,1 +611,1 @@\n-            TimeHelper::counter_to_millis(stats.yield_duration()),\n+            TimeHelper::counter_to_millis(stats.yield_during_sweep_duration()),\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Policy.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1366,1 +1366,1 @@\n-      return NoInteresting;\n+      return NoCrossRegion;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -125,1 +125,1 @@\n-      NoInteresting,         \/\/ There is no interesting reference in the card any more. The mutator changed all\n+      NoCrossRegion,         \/\/ There is no interesting reference in the card any more. The mutator changed all\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}