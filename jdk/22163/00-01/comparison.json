{"files":[{"patch":"@@ -36,1 +36,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA re-enable\n@@ -38,1 +38,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA256\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA256 re-enable\n@@ -45,1 +45,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256 re-enable\n@@ -52,2 +52,1 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n+import javax.net.ssl.SSLEngine;\n@@ -59,2 +58,0 @@\n-import javax.net.ssl.SSLEngine;\n-\n@@ -71,2 +68,0 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n-\n","filename":"test\/jdk\/javax\/net\/ssl\/DTLS\/CipherSuite.java","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -37,6 +37,3 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n-import java.io.FileInputStream;\n-import java.nio.ByteBuffer;\n-import java.nio.ReadOnlyBufferException;\n-import java.security.KeyStore;\n+import java.security.*;\n+import java.io.*;\n+import java.nio.*;\n@@ -45,9 +42,4 @@\n-import javax.net.ssl.KeyManagerFactory;\n-import javax.net.ssl.SSLContext;\n-import javax.net.ssl.SSLEngine;\n-import javax.net.ssl.SSLEngineResult;\n-import javax.net.ssl.SSLEngineResult.HandshakeStatus;\n-import javax.net.ssl.SSLEngineResult.Status;\n-import javax.net.ssl.SSLProtocolException;\n-import javax.net.ssl.SSLSession;\n-import javax.net.ssl.TrustManagerFactory;\n+import javax.net.ssl.*;\n+import javax.net.ssl.SSLEngineResult.*;\n+\n+import jdk.test.lib.security.SecurityUtils;\n@@ -69,2 +61,1 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\");\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLEngine\/Basics.java","additions":8,"deletions":17,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -33,7 +33,0 @@\n-import static javax.net.ssl.SSLEngineResult.HandshakeStatus.NEED_TASK;\n-import static javax.net.ssl.SSLEngineResult.HandshakeStatus.NEED_UNWRAP;\n-import static javax.net.ssl.SSLEngineResult.HandshakeStatus.NEED_WRAP;\n-import static javax.net.ssl.SSLEngineResult.HandshakeStatus.NOT_HANDSHAKING;\n-\n-import jdk.test.lib.security.SecurityUtils;\n-\n@@ -42,0 +35,1 @@\n+import javax.net.ssl.*;\n@@ -43,12 +37,4 @@\n-import java.security.GeneralSecurityException;\n-import java.security.KeyStore;\n-import java.util.LinkedList;\n-import java.util.List;\n-\n-import javax.net.ssl.KeyManagerFactory;\n-import javax.net.ssl.SSLContext;\n-import javax.net.ssl.SSLEngine;\n-import javax.net.ssl.SSLEngineResult;\n-import javax.net.ssl.SSLHandshakeException;\n-import javax.net.ssl.SSLProtocolException;\n-import javax.net.ssl.TrustManagerFactory;\n+import java.util.*;\n+import java.security.*;\n+import static javax.net.ssl.SSLEngineResult.HandshakeStatus.*;\n+import jdk.test.lib.security.SecurityUtils;\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLEngine\/EngineCloseOnAlert.java","additions":5,"deletions":19,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -45,2 +45,0 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n@@ -49,1 +47,0 @@\n-\n@@ -55,0 +52,2 @@\n+import jdk.test.lib.security.SecurityUtils;\n+\n@@ -177,2 +176,1 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\");\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/TLSv11\/GenericBlockCipher.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,4 +35,3 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n-import java.io.InputStream;\n-import java.io.OutputStream;\n+import java.io.*;\n+import java.net.*;\n+import javax.net.ssl.*;\n@@ -40,4 +39,1 @@\n-import javax.net.ssl.SSLServerSocket;\n-import javax.net.ssl.SSLServerSocketFactory;\n-import javax.net.ssl.SSLSocket;\n-import javax.net.ssl.SSLSocketFactory;\n+import jdk.test.lib.security.SecurityUtils;\n","filename":"test\/jdk\/javax\/net\/ssl\/TLSv12\/ProtocolFilter.java","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n- * @library \/test\/lib\n@@ -33,2 +32,0 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n@@ -105,6 +102,0 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -130,3 +121,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -200,6 +188,0 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -225,3 +207,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -241,1 +220,0 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/CheckCipherSuites.java","additions":0,"deletions":22,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -24,2 +24,0 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n@@ -27,0 +25,1 @@\n+import java.util.stream.Stream;\n@@ -31,0 +30,2 @@\n+import jdk.test.lib.security.SecurityUtils;\n+\n@@ -86,1 +87,0 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n@@ -95,0 +95,14 @@\n+        \/\/ Re-enable TLS_RSA_* cipher suites if needed.\n+        for (String p : Stream.concat(\n+                        Arrays.stream(\n+                                servercipherSuites == null\n+                                        ? new String[0] : servercipherSuites),\n+                        Arrays.stream(\n+                                clientcipherSuites == null\n+                                        ? new String[0] : clientcipherSuites))\n+                .toArray(String[]::new)) {\n+            if (p.startsWith(\"TLS_RSA_\")) {\n+                SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+            }\n+        }\n+\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/SystemPropCipherSuitesOrder.java","additions":17,"deletions":3,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -71,4 +71,5 @@\n-import jdk.test.lib.security.SecurityUtils;\n-\n-import java.nio.ByteBuffer;\n-import java.security.SecureRandom;\n+import javax.net.ssl.*;\n+import javax.net.ssl.SSLEngineResult.*;\n+import java.security.*;\n+import java.nio.*;\n+import java.util.List;\n@@ -77,1 +78,0 @@\n-import java.util.List;\n@@ -79,5 +79,1 @@\n-import javax.net.ssl.SSLEngineResult;\n-import javax.net.ssl.SSLEngineResult.HandshakeStatus;\n-import javax.net.ssl.SSLException;\n-import javax.net.ssl.SSLProtocolException;\n-import javax.net.ssl.SSLSession;\n+import jdk.test.lib.security.SecurityUtils;\n@@ -278,2 +274,1 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\");\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/sun\/security\/ssl\/ClientHandshaker\/LengthCheckTest.java","additions":7,"deletions":12,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm DebugReportsOneExtraByte\n+ * @run main DebugReportsOneExtraByte\n@@ -94,1 +94,0 @@\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n@@ -105,1 +104,1 @@\n-            SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\");\n+            SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/sun\/security\/ssl\/EngineArgs\/DebugReportsOneExtraByte.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"}]}