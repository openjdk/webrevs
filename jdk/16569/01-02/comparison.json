{"files":[{"patch":"@@ -414,3 +414,8 @@\n-    BOOL supportsSecureState = YES;\n-    if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n-       supportsSecureState = NO;\n+    static BOOL checked = NO;\n+    static BOOL supportsSecureState = YES;\n+\n+    if (checked == NO) {\n+        checked = YES;\n+        if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n+            supportsSecureState = NO;\n+        }\n@@ -653,1 +658,3 @@\n-        [ApplicationDelegate sharedDelegate].fDockMenu = menu;\n+        if ([ApplicationDelegate sharedDelegate] != nil) {\n+            [ApplicationDelegate sharedDelegate].fDockMenu = menu;\n+        }\n@@ -833,7 +840,9 @@\n-        switch (menuID) {\n-            case com_apple_eawt__AppMenuBarHandler_MENU_ABOUT:\n-                [delegate _updateAboutMenu:visible enabled:enabled];\n-                break;\n-            case com_apple_eawt__AppMenuBarHandler_MENU_PREFS:\n-                [delegate _updatePreferencesMenu:visible enabled:enabled];\n-                break;\n+        if (delegate != nil) {\n+            switch (menuID) {\n+                case com_apple_eawt__AppMenuBarHandler_MENU_ABOUT:\n+                    [delegate _updateAboutMenu:visible enabled:enabled];\n+                    break;\n+                case com_apple_eawt__AppMenuBarHandler_MENU_PREFS:\n+                    [delegate _updatePreferencesMenu:visible enabled:enabled];\n+                    break;\n+            }\n@@ -858,1 +867,3 @@\n-        [ApplicationDelegate sharedDelegate].fDefaultMenuBar = menu;\n+        if ([ApplicationDelegate sharedDelegate] != nil) {\n+            [ApplicationDelegate sharedDelegate].fDefaultMenuBar = menu;\n+        }\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/ApplicationDelegate.m","additions":23,"deletions":12,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -206,3 +206,8 @@\n-    BOOL supportsSecureState = YES;\n-    if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n-        supportsSecureState = NO;\n+    static BOOL checked = NO;\n+    static BOOL supportsSecureState = YES;\n+\n+    if (checked == NO) {\n+        checked = YES;\n+        if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n+            supportsSecureState = NO;\n+        }\n","filename":"src\/java.desktop\/macosx\/native\/libosxapp\/QueuingApplicationDelegate.m","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"}]}