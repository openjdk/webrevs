{"files":[{"patch":"@@ -844,1 +844,1 @@\n-    if (menuBar == nil) {\n+    if (menuBar == nil && [ApplicationDelegate sharedDelegate] != nil) {\n@@ -1233,1 +1233,1 @@\n-        if (actualMenuBar == nil) {\n+        if (actualMenuBar == nil && [ApplicationDelegate sharedDelegate] != nil) {\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/AWTWindow.m","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -119,0 +119,1 @@\n+    BOOL overrideDelegate = (getenv(\"AWT_OVERRIDE_NSDELEGATE\") != NULL);\n@@ -120,1 +121,1 @@\n-        if ([NSApp isMemberOfClass:[NSApplication class]]) shouldInstall = YES;\n+        if ([NSApp isMemberOfClass:[NSApplication class]] && overrideDelegate) shouldInstall = YES;\n@@ -412,0 +413,8 @@\n+- (BOOL)applicationSupportsSecureRestorableState:(NSApplication *)app {\n+    BOOL supportsSecureState = YES;\n+    if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n+       supportsSecureState = NO;\n+    }\n+    return supportsSecureState;\n+}\n+\n@@ -509,2 +518,4 @@\n-    [[ApplicationDelegate sharedDelegate].fProgressIndicator removeFromSuperview];\n-    [dockImageView addSubview:[ApplicationDelegate sharedDelegate].fProgressIndicator];\n+    if ([ApplicationDelegate sharedDelegate] != nil) {\n+        [[ApplicationDelegate sharedDelegate].fProgressIndicator removeFromSuperview];\n+        [dockImageView addSubview:[ApplicationDelegate sharedDelegate].fProgressIndicator];\n+    }\n@@ -523,5 +534,8 @@\n-    if ([value doubleValue] >= 0 && [value doubleValue] <=100) {\n-        [delegate.fProgressIndicator setDoubleValue:[value doubleValue]];\n-        [delegate.fProgressIndicator setHidden:NO];\n-    } else {\n-        [delegate.fProgressIndicator setHidden:YES];\n+    if (delegate != nil) {\n+        if ([value doubleValue] >= 0 && [value doubleValue] <=100) {\n+            [delegate.fProgressIndicator setDoubleValue:[value doubleValue]];\n+            [delegate.fProgressIndicator setHidden:NO];\n+        } else {\n+            [delegate.fProgressIndicator setHidden:YES];\n+        }\n+        [[NSApp dockTile] display];\n@@ -529,2 +543,0 @@\n-\n-    [[NSApp dockTile] display];\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/ApplicationDelegate.m","additions":22,"deletions":10,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -213,3 +213,5 @@\n-        CMenuBar* defaultMenu = [[ApplicationDelegate sharedDelegate] defaultMenuBar];\n-        if (defaultMenu != nil) {\n-            [CMenuBar activate:defaultMenu modallyDisabled:NO];\n+        if ([ApplicationDelegate sharedDelegate] != nil) {\n+            CMenuBar* defaultMenu = [[ApplicationDelegate sharedDelegate] defaultMenuBar];\n+            if (defaultMenu != nil) {\n+                [CMenuBar activate:defaultMenu modallyDisabled:NO];\n+            }\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/CMenuBar.m","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -203,0 +203,10 @@\n+\n+- (BOOL)applicationSupportsSecureRestorableState:(NSApplication *)app\n+{\n+    BOOL supportsSecureState = YES;\n+    if (getenv(\"AWT_DISABLE_NSDELEGATE_SECURE_SAVE\") != NULL) {\n+        supportsSecureState = NO;\n+    }\n+    return supportsSecureState;\n+}\n+\n","filename":"src\/java.desktop\/macosx\/native\/libosxapp\/QueuingApplicationDelegate.m","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"}]}