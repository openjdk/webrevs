{"files":[{"patch":"@@ -782,1 +782,1 @@\n-      st->print(\" ... \");\n+      st->print(\" ... (%d characters ommitted) ... \", length - 2 * (max_length \/ 2));\n","filename":"src\/hotspot\/share\/classfile\/javaClasses.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -53,2 +53,3 @@\n-        \/\/ Modified string format is \"xxx ... xxx\" (abridged)\n-        final String padding = \" ... \";\n+        \/\/ Modified string format is \"xxx ... (N characters ommitted) ... xxx\" (abridged)\n+        final String elipse = \" ... \";\n+        final String text = \" characters ommitted)\";\n@@ -96,3 +97,4 @@\n-                    int padStart = r.indexOf(padding);\n-                    String firstHalf = r.substring(0, padStart);\n-                    String secondHalf = r.substring(padStart + padding.length(), r.length());\n+                    int elipseStart = r.indexOf(elipse);\n+                    String firstHalf = r.substring(0, elipseStart);\n+                    int secondElipseStart = r.lastIndexOf(elipse);\n+                    String secondHalf = r.substring(secondElipseStart + elipse.length(), r.length());\n@@ -105,2 +107,11 @@\n-                    \/\/ Note: if maxlength is odd the div effectively rounds down\n-                    checkEqual(r.length(), (maxLength \/ 2) * 2 + padding.length());\n+\n+                    \/\/ Now check number of characters ommitted\n+                    String tail = r.substring(r.indexOf(\"(\"), r.length());\n+                    int numberEnd = tail.indexOf(\" \");\n+                    String nChars = tail.substring(1, numberEnd);\n+                    System.out.println(\"N: >\" + nChars + \"<\");\n+\n+                    \/\/ Now add all the bits back together to get the expected full length\n+                    int fullLength = maxLength \/ 2 + elipse.length() + 1 \/* for ( *\/\n+                        + nChars.length() + text.length() + elipse.length() + maxLength \/ 2;\n+                    checkEqual(r.length(), fullLength);\n","filename":"test\/hotspot\/jtreg\/runtime\/PrintingTests\/StringPrinting.java","additions":18,"deletions":7,"binary":false,"changes":25,"status":"modified"}]}