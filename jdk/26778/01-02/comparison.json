{"files":[{"patch":"@@ -32,1 +32,1 @@\n-        return BuildEnvFromParams.create(params, MacPackage::guessRuntimeLayout);\n+        return BuildEnvFromParams.create(params, MacPackagingPipeline.APPLICATION_LAYOUT::resolveAt, MacPackage::guessRuntimeLayout);\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacBuildEnvFromParams.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n-import static jdk.jpackage.internal.StandardBundlerParam.PREDEFINED_RUNTIME_IMAGE;\n+import static jdk.jpackage.internal.ApplicationLayoutUtils.PLATFORM_APPLICATION_LAYOUT;\n@@ -29,0 +29,1 @@\n+import static jdk.jpackage.internal.StandardBundlerParam.PREDEFINED_RUNTIME_IMAGE;\n@@ -32,1 +33,0 @@\n-import static jdk.jpackage.internal.ApplicationLayoutUtils.PLATFORM_APPLICATION_LAYOUT;\n@@ -37,0 +37,1 @@\n+import jdk.jpackage.internal.model.ApplicationLayout;\n@@ -43,0 +44,1 @@\n+            Function<Path, ApplicationLayout> predefinedAppImageLayoutProvider,\n@@ -58,1 +60,1 @@\n-            var layout = PLATFORM_APPLICATION_LAYOUT.resolveAt(PREDEFINED_APP_IMAGE.findIn(params).orElseThrow());\n+            var layout = predefinedAppImageLayoutProvider.apply(PREDEFINED_APP_IMAGE.findIn(params).orElseThrow());\n@@ -70,1 +72,1 @@\n-        return create(params, RuntimeLayout.DEFAULT::resolveAt);\n+        return create(params, PLATFORM_APPLICATION_LAYOUT::resolveAt, RuntimeLayout.DEFAULT::resolveAt);\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/BuildEnvFromParams.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1177,4 +1177,9 @@\n-            TKit.assertStringListEquals(\n-                    addLauncherNames().stream().sorted().toList(),\n-                    aif.addLaunchers().keySet().stream().sorted().toList(),\n-                    \"Check additional launcher names\");\n+            \/\/ Don't compare the add launchers configured on the command line with the\n+            \/\/ add launchers listed in the `.jpackage.xml` file if the latter comes from\n+            \/\/ a predefined app image.\n+            if (!hasArgument(\"--app-image\")) {\n+                TKit.assertStringListEquals(\n+                        addLauncherNames().stream().sorted().toList(),\n+                        aif.addLaunchers().keySet().stream().sorted().toList(),\n+                        \"Check additional launcher names\");\n+            }\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"}]}