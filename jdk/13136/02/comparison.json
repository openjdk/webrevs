{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+#include \"metaprogramming\/primitiveConversions.hpp\"\n@@ -502,6 +503,2 @@\n-  union {\n-    unsigned ival;\n-    float val;\n-  };\n-  ival = fp_immediate_for_encoding(value, 0);\n-  return val;\n+  unsigned ival = fp_immediate_for_encoding(value, 0);\n+  return PrimitiveConversions::cast<float>(ival);\n","filename":"src\/hotspot\/cpu\/aarch64\/assembler_aarch64.cpp","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +30,0 @@\n-#include \"utilities\/globalDefinitions.hpp\"\n@@ -31,0 +31,2 @@\n+#include \"metaprogramming\/primitiveConversions.hpp\"\n+#include \"utilities\/globalDefinitions.hpp\"\n@@ -434,5 +436,1 @@\n-  union {\n-    float fpval;\n-    uint32_t val;\n-  };\n-  fpval = immediate;\n+  uint32_t val = PrimitiveConversions::cast<uint32_t>(immediate);\n","filename":"src\/hotspot\/cpu\/aarch64\/immediate_aarch64.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -282,1 +282,1 @@\n-      _num.val = v;\n+      _bits = PrimitiveConversions::cast<unsigned int>(v);\n@@ -285,4 +285,4 @@\n-    virtual unsigned int f_hi4() const { return (_num.bits << 9) >> (19+9); }\n-    virtual bool f_lo_is_null() const { return (_num.bits & ((1 << 19) - 1)) == 0; }\n-    virtual int e() const { return ((_num.bits << 1) >> (23+1)) - 127; }\n-    virtual unsigned int s() const { return _num.bits >> 31; }\n+    override unsigned int f_hi4() const { return (_bits << 9) >> (19+9); }\n+    override bool f_lo_is_null() const { return (_bits & ((1 << 19) - 1)) == 0; }\n+    override int e() const { return ((_bits << 1) >> (23+1)) - 127; }\n+    override unsigned int s() const { return _bits >> 31; }\n@@ -291,4 +291,1 @@\n-    union {\n-      float val;\n-      unsigned int bits;\n-    } _num;\n+    unsigned int _bits;\n@@ -300,1 +297,1 @@\n-      _num.val = v;\n+      _bits = PrimitiveConversions::cast<uint64_t>(v);\n@@ -303,4 +300,4 @@\n-    virtual unsigned int f_hi4() const { return (_num.bits << 12) >> (48+12); }\n-    virtual bool f_lo_is_null() const { return (_num.bits & ((1LL << 48) - 1)) == 0; }\n-    virtual int e() const { return ((_num.bits << 1) >> (52+1)) - 1023; }\n-    virtual unsigned int s() const { return _num.bits >> 63; }\n+    override unsigned int f_hi4() const { return (_bits << 12) >> (48+12); }\n+    override bool f_lo_is_null() const { return (_bits & ((1LL << 48) - 1)) == 0; }\n+    override int e() const { return ((_bits << 1) >> (52+1)) - 1023; }\n+    override unsigned int s() const { return _bits >> 63; }\n@@ -309,4 +306,1 @@\n-    union {\n-      double val;\n-      unsigned long long bits;\n-    } _num;\n+    uint64_t _bits;\n","filename":"src\/hotspot\/cpu\/arm\/assembler_arm.hpp","additions":13,"deletions":19,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+#include \"metaprogramming\/primitiveConversions.hpp\"\n@@ -676,5 +677,1 @@\n-  union {\n-    jfloat f;\n-    jint i;\n-  } accessor;\n-  accessor.f = c;\n+  jint float_bits = PrimitiveConversions::cast<jint>(c);\n@@ -684,1 +681,1 @@\n-  emit_int32(accessor.i);\n+  emit_int32(float_bits);\n","filename":"src\/hotspot\/cpu\/arm\/macroAssembler_arm.cpp","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -49,0 +49,1 @@\n+#include \"metaprogramming\/primitiveConversions.hpp\"\n@@ -240,3 +241,2 @@\n-  union { jfloat f; juint i; } xbits, ybits;\n-  xbits.f = x;\n-  ybits.f = y;\n+  juint xbits = PrimitiveConversions::cast<juint>(x);\n+  juint ybits = PrimitiveConversions::cast<juint>(y);\n@@ -244,2 +244,2 @@\n-  if (((xbits.i & float_sign_mask) != float_infinity) &&\n-       ((ybits.i & float_sign_mask) == float_infinity) ) {\n+  if (((xbits & float_sign_mask) != float_infinity) &&\n+       ((ybits & float_sign_mask) == float_infinity) ) {\n@@ -257,3 +257,2 @@\n-  union { jdouble d; julong l; } xbits, ybits;\n-  xbits.d = x;\n-  ybits.d = y;\n+  julong xbits = PrimitiveConversions::cast<julong>(x);\n+  julong ybits = PrimitiveConversions::cast<julong>(y);\n@@ -261,2 +260,2 @@\n-  if (((xbits.l & double_sign_mask) != double_infinity) &&\n-       ((ybits.l & double_sign_mask) == double_infinity) ) {\n+  if (((xbits & double_sign_mask) != double_infinity) &&\n+       ((ybits & double_sign_mask) == double_infinity) ) {\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":9,"deletions":10,"binary":false,"changes":19,"status":"modified"}]}