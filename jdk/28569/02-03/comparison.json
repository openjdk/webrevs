{"files":[{"patch":"@@ -295,0 +295,3 @@\n+        \/**\n+         * Throws an IOException if the ModuleReader is closed.\n+         *\/\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/module\/ModulePatcher.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import org.junit.jupiter.api.BeforeAll;\n@@ -46,0 +47,37 @@\n+    private static ModuleReference patchedModuleRef;\n+\n+    @BeforeAll\n+    static void beforeAll() {\n+        patchedModuleRef = ModuleFinder.ofSystem()\n+                .find(\"java.base\")\n+                .orElseThrow();\n+    }\n+\n+    \/*\n+     * Verifies that the resource that was patched into a module\n+     * is found by the ModuleReader.\n+     *\/\n+    @Test\n+    void testPatchedResourcePresence() throws Exception {\n+        try (ModuleReader reader = patchedModuleRef.open()) {\n+            String resourceName = \"java\/lang\/PatchedFoo.class\";\n+            Optional<URI> res = reader.find(resourceName);\n+            assertTrue(res.isPresent(), resourceName + \" is missing in \"\n+                    + patchedModuleRef.descriptor().name() + \" module\");\n+        }\n+    }\n+\n+    \/*\n+     * Verifies the ModuleReader against a resource which isn't\n+     * expected to be part of the patched module.\n+     *\/\n+    @Test\n+    void testNonExistentResource() throws Exception {\n+        try (ModuleReader reader = patchedModuleRef.open()) {\n+            String nonExistentResource = \"foo\/bar\/NonExistent.class\";\n+            Optional<URI> res = reader.find(nonExistentResource);\n+            assertTrue(res.isEmpty(), \"unexpected resource \" + nonExistentResource\n+                    + \" in \" + patchedModuleRef.descriptor().name() + \" module\");\n+        }\n+    }\n+\n@@ -54,18 +92,4 @@\n-    void testIOExceptionUponClose() throws Exception {\n-        final ModuleReference mref = ModuleFinder.ofSystem()\n-                .find(\"java.base\")\n-                .orElseThrow();\n-        final ModuleReader reader;\n-        final Stream<String> resources;\n-        final String nonExistentResource = \"foo\/bar\/NonExistent.class\";\n-        \/\/ open the ModuleReader\n-        try (var _ = reader = mref.open()) {\n-            \/\/ verify we are using the patched module\n-            final String resourceName = \"java\/lang\/PatchedFoo.class\";\n-            final Optional<URI> res = reader.find(resourceName);\n-            assertTrue(res.isPresent(), resourceName + \" is missing in \"\n-                    + mref.descriptor().name() + \" module\");\n-            \/\/ test a non-existent resource\n-            assertTrue(reader.find(nonExistentResource).isEmpty(),\n-                    \"unexpected resource \" + nonExistentResource + \" in \"\n-                            + mref.descriptor().name() + \" module\");\n+    void testIOExceptionAfterClose() throws Exception {\n+        ModuleReader reader;\n+        Stream<String> resources;\n+        try (var _ = reader = patchedModuleRef.open()) {\n@@ -88,0 +112,1 @@\n+        String nonExistentResource = \"foo\/bar\/NonExistent.class\";\n","filename":"test\/jdk\/java\/lang\/module\/ModuleReader\/patched\/PatchedModuleReaderTest.java","additions":43,"deletions":18,"binary":false,"changes":61,"status":"modified"}]}