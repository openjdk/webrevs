{"files":[{"patch":"@@ -27,0 +27,1 @@\n+import java.io.ByteArrayInputStream;\n@@ -28,0 +29,1 @@\n+import java.io.InputStream;\n@@ -41,1 +43,0 @@\n-import jdk.internal.jimage.BasicImageReader.ImageError.Reason;\n@@ -147,2 +148,1 @@\n-                throw new ImageError(Reason.INVALID_JIMAGE,\n-                        \"\\\"\" + name + \"\\\" is not an image file\");\n+                throw new IOException(\"\\\"\" + name + \"\\\" is not an image file\");\n@@ -151,2 +151,1 @@\n-            throw new ImageError(Reason.INVALID_JIMAGE,\n-                    \"\\\"\" + name + \"\\\" is not an image file\");\n+            throw new IOException(\"\\\"\" + name + \"\\\" is not an image file\");\n@@ -169,2 +168,1 @@\n-            throw new ImageError(Reason.CORRUPT_JIMAGE,\n-                    \"The image file \\\"\" + name + \"\\\" is corrupted\");\n+            throw new IOException(\"The image file \\\"\" + name + \"\\\" is corrupted\");\n@@ -197,2 +195,1 @@\n-            throw new ImageError(Reason.INVALID_JIMAGE,\n-                    \"\\\"\" + name + \"\\\" is not an image file\");\n+            throw new IOException(\"\\\"\" + name + \"\\\" is not an image file\");\n@@ -203,4 +200,2 @@\n-            throw new ImageError(Reason.BAD_VERSION,\n-                    \"The image file \\\"\" + name + \"\\\" is not the correct version.\\n\"\n-                            + \"Major: \" + result.getMajorVersion()\n-                            + \". Minor: \" + result.getMinorVersion());\n+            throw new IOException(\"The image file \\\"\" + name + \"\\\" is not the correct version.\\n\"\n+                    + \"Use '<JAVA_HOME>\/bin\/jimage' for the JDK associated with this jimage file.\");\n@@ -465,22 +460,3 @@\n-    \/**\n-     * Specialized {@link IOException} thrown during construction to provide a\n-     * semantic reason for failure and allow better user-facing error messages.\n-     *\/\n-    public final static class ImageError extends IOException {\n-        private static final long serialVersionUID = 6002259582237888214L;\n-\n-        public enum Reason {\n-            \/** The file being opened does not appear to be a jimage file. *\/\n-            INVALID_JIMAGE,\n-            \/** The jimage file being opened is corrupted. *\/\n-            CORRUPT_JIMAGE,\n-            \/** The jimage file being opened has the wrong version. *\/\n-            BAD_VERSION,\n-        }\n-\n-        private final Reason reason;\n-\n-        public ImageError(Reason reason, String message) {\n-            super(message);\n-            this.reason = reason;\n-        }\n+    public InputStream getResourceStream(ImageLocation loc) {\n+        Objects.requireNonNull(loc);\n+        byte[] bytes = getResource(loc);\n@@ -488,3 +464,1 @@\n-        public Reason getReason() {\n-            return reason;\n-        }\n+        return new ByteArrayInputStream(bytes);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/BasicImageReader.java","additions":12,"deletions":38,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import java.nio.file.Path;\n@@ -48,1 +47,0 @@\n-import jdk.internal.jimage.BasicImageReader.ImageError.Reason;\n@@ -440,6 +438,0 @@\n-                \/\/ Handle specific errors for which better advice can be given.\n-                if (ioe instanceof BasicImageReader.ImageError err\n-                        && err.getReason() == Reason.BAD_VERSION) {\n-                    throw TASK_HELPER.newBadArgs(\"err.bad.version\", file);\n-                }\n-                \/\/ Non-specific error during processing.\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jimage\/JImageTask.java","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-\\             by the --dir=<directory> (default=''.'') option.\\n\\\n+\\             by the --dir=<directory> (default='.') option.\\n\\\n@@ -41,1 +41,1 @@\n-\\  verify   - Reports on any .class entries that don''t verify as classes.\\n\\\n+\\  verify   - Reports on any .class entries that don't verify as classes.\\n\\\n@@ -47,1 +47,1 @@\n-\\             by the --dir=<directory> (default=''.'') option.\n+\\             by the --dir=<directory> (default='.') option.\n@@ -57,1 +57,1 @@\n-\\  verify   - Reports errors on any .class entries that don''t verify as classes.\n+\\  verify   - Reports errors on any .class entries that don't verify as classes.\n@@ -104,2 +104,0 @@\n-err.bad.version=Unable to open {0}: mismatched file and tool version\\n\\\n-Use ''<JAVA_HOME>\/bin\/jimage'' for the JDK associated with this jimage file.\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jimage\/resources\/jimage.properties","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"}]}