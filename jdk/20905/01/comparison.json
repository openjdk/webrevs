{"files":[{"patch":"@@ -1183,0 +1183,2 @@\n+        \/\/ CEN size is limited to the maximum array size in the JDK\n+        private static final int MAX_CEN_SIZE = Integer.MAX_VALUE - 2;\n@@ -1190,1 +1192,1 @@\n-        private byte[] cen;                  \/\/ CEN & ENDHDR\n+        private byte[] cen;                  \/\/ CEN\n@@ -1246,1 +1248,1 @@\n-            if (headerSize > 0xFFFF || pos + headerSize > cen.length - ENDHDR) {\n+            if (headerSize > 0xFFFF || pos + headerSize > cen.length) {\n@@ -1299,1 +1301,1 @@\n-            if (extraEndOffset > cen.length - ENDHDR) {\n+            if (extraEndOffset > cen.length) {\n@@ -1737,2 +1739,2 @@\n-                \/\/ read in the CEN and END\n-                if (end.cenlen + ENDHDR >= Integer.MAX_VALUE) {\n+                \/\/ read in the CEN\n+                if (end.cenlen > MAX_CEN_SIZE) {\n@@ -1741,2 +1743,2 @@\n-                cen = this.cen = new byte[(int)(end.cenlen + ENDHDR)];\n-                if (readFullyAt(cen, 0, cen.length, cenpos) != end.cenlen + ENDHDR) {\n+                cen = this.cen = new byte[(int)end.cenlen];\n+                if (readFullyAt(cen, 0, cen.length, cenpos) != end.cenlen) {\n@@ -1771,1 +1773,1 @@\n-            int limit = cen.length - ENDHDR;\n+            int limit = cen.length;\n@@ -1834,1 +1836,1 @@\n-            if (pos + ENDHDR != cen.length) {\n+            if (pos != cen.length) {\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipFile.java","additions":11,"deletions":9,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,1 +71,1 @@\n-    private static int MAX_CEN_SIZE = Integer.MAX_VALUE - ENDHDR - 1;\n+    private static int MAX_CEN_SIZE = Integer.MAX_VALUE - 2;\n","filename":"test\/jdk\/java\/util\/zip\/ZipFile\/EndOfCenValidation.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}