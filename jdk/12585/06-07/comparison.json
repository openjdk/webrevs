{"files":[{"patch":"@@ -1616,0 +1616,9 @@\n+\n+  \/\/ In case we are not using CHA based vtables we need to make sure the loaded\n+  \/\/ deopt is completed before anyone link this class.\n+  \/\/ Linking is done with _init_monitor held, by loading and deopting with it\n+  \/\/ held we make sure the deopt is completed before linking.\n+  if (!UseVtableBasedCHA) {\n+    k->init_monitor()->lock();\n+  }\n+\n@@ -1637,0 +1646,4 @@\n+\n+  if (!UseVtableBasedCHA) {\n+    k->init_monitor()->unlock();\n+  }\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -797,3 +797,6 @@\n-    } else if (mh->code() != nullptr) {\n-      deopt_scope.mark(mh->code());\n-      ++result;\n+    } else {\n+      MutexLocker ml(CompiledMethod_lock, Mutex::_no_safepoint_check_flag);\n+      if (mh->code() != nullptr) {\n+        deopt_scope.mark(mh->code());\n+        ++result;\n+      }\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"}]}