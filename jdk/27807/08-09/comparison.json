{"files":[{"patch":"@@ -956,1 +956,0 @@\n-        int len = WB;\n@@ -958,2 +957,2 @@\n-        int[] w = new int[len];\n-        int[] tW = new int[kLen];\n+        int[] tmp = new int[WB];\n+        int[] w = new int[kLen];\n@@ -965,10 +964,10 @@\n-            System.arraycopy(sessionK[0], i * len, w, 0, len);\n-            w[0] = TMI0[w[0] >>> 24] ^ TMI1[(w[0] >> 16) & 0xFF]\n-                    ^ TMI2[(w[0] >> 8) & 0xFF] ^ TMI3[w[0] & 0xFF];\n-            w[1] = TMI0[w[1] >>> 24] ^ TMI1[(w[1] >> 16) & 0xFF]\n-                    ^ TMI2[(w[1] >> 8) & 0xFF] ^ TMI3[w[1] & 0xFF];\n-            w[2] = TMI0[w[2] >>> 24] ^ TMI1[(w[2] >> 16) & 0xFF]\n-                    ^ TMI2[(w[2] >> 8) & 0xFF] ^ TMI3[w[2] & 0xFF];\n-            w[3] = TMI0[w[3] >>> 24] ^ TMI1[(w[3] >> 16) & 0xFF]\n-                    ^ TMI2[(w[3] >> 8) & 0xFF] ^ TMI3[w[3] & 0xFF];\n-            System.arraycopy(w, 0, tW, kLen - (i * len), len);\n+            System.arraycopy(sessionK[0], i * WB, tmp, 0, WB);\n+            tmp[0] = TMI0[tmp[0] >>> 24] ^ TMI1[(tmp[0] >> 16) & 0xFF]\n+                    ^ TMI2[(tmp[0] >> 8) & 0xFF] ^ TMI3[tmp[0] & 0xFF];\n+            tmp[1] = TMI0[tmp[1] >>> 24] ^ TMI1[(tmp[1] >> 16) & 0xFF]\n+                    ^ TMI2[(tmp[1] >> 8) & 0xFF] ^ TMI3[tmp[1] & 0xFF];\n+            tmp[2] = TMI0[tmp[2] >>> 24] ^ TMI1[(tmp[2] >> 16) & 0xFF]\n+                    ^ TMI2[(tmp[2] >> 8) & 0xFF] ^ TMI3[tmp[2] & 0xFF];\n+            tmp[3] = TMI0[tmp[3] >>> 24] ^ TMI1[(tmp[3] >> 16) & 0xFF]\n+                    ^ TMI2[(tmp[3] >> 8) & 0xFF] ^ TMI3[tmp[3] & 0xFF];\n+            System.arraycopy(tmp, 0, w, kLen - (i * WB), WB);\n@@ -976,3 +975,3 @@\n-        System.arraycopy(sessionK[0], kLen - len, tW, len, len);\n-        System.arraycopy(sessionK[0], 0, tW, 0, len);\n-        Arrays.fill(w, 0);\n+        System.arraycopy(sessionK[0], kLen - WB, w, WB, WB);\n+        System.arraycopy(sessionK[0], 0, w, 0, WB);\n+        Arrays.fill(tmp, 0);\n@@ -980,1 +979,1 @@\n-        return tW;\n+        return w;\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":16,"deletions":17,"binary":false,"changes":33,"status":"modified"}]}