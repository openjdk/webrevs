{"files":[{"patch":"@@ -950,39 +950,0 @@\n-    \/**\n-     * Performs the inverse cipher mix column matrix multiplication per row.\n-     *\n-     * @param state [in, out] the round key for inverse mix column processing.\n-     * @param idx [in] the column index of the round key to process.\n-     *\n-     * @return the processed round key row.\n-     *\/\n-    private static int invMix(int[] state, int idx) {\n-        \/\/ If we want to repurpose the inverse lookup tables for mix column\n-        \/\/ transform of the inverse expansion key - saves 4KB of memory with the\n-        \/\/ cost of 19.7% of decreased performance of key reinitialization.\n-        int a0 = TMI0[(state[idx] >> 24) & 0xFF];\n-        int a1 = TMI1[(state[idx] >> 16) & 0xFF];\n-        int a2 = TMI2[(state[idx] >> 8) & 0xFF];\n-        int a3 = TMI3[state[idx] & 0xFF];\n-\n-        \/\/ Add columns\n-        return a0 ^ a1 ^ a2 ^ a3;\n-    }\n-\n-    \/**\n-     * Performs the inverse cipher mix column on the round key.\n-     *\n-     * @param state [in, out] the round key for inverse mix column processing.\n-     *\/\n-    private static void invMixRKey(int[] state) {\n-        int len = WB;\n-        int[] mSum = new int[len];\n-\n-        mSum[0] = invMix(state, 0);\n-        mSum[1] = invMix(state, 1);\n-        mSum[2] = invMix(state, 2);\n-        mSum[3] = invMix(state, 3);\n-\n-        System.arraycopy(mSum, 0, state, 0, len);\n-        Arrays.fill(mSum, 0);\n-    }\n-\n@@ -1005,1 +966,8 @@\n-            invMixRKey(w);\n+            w[0] = TMI0[w[0] >>> 24] ^ TMI1[(w[0] >> 16) & 0xFF]\n+                    ^ TMI2[(w[0] >> 8) & 0xFF] ^ TMI3[w[0] & 0xFF];\n+            w[1] = TMI0[w[1] >>> 24] ^ TMI1[(w[1] >> 16) & 0xFF]\n+                    ^ TMI2[(w[1] >> 8) & 0xFF] ^ TMI3[w[1] & 0xFF];\n+            w[2] = TMI0[w[2] >>> 24] ^ TMI1[(w[2] >> 16) & 0xFF]\n+                    ^ TMI2[(w[2] >> 8) & 0xFF] ^ TMI3[w[2] & 0xFF];\n+            w[3] = TMI0[w[3] >>> 24] ^ TMI1[(w[3] >> 16) & 0xFF]\n+                    ^ TMI2[(w[3] >> 8) & 0xFF] ^ TMI3[w[3] & 0xFF];\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":8,"deletions":40,"binary":false,"changes":48,"status":"modified"}]}