{"files":[{"patch":"@@ -940,1 +940,1 @@\n-                tmp = subByte(rW, SBOX) ^ RCON[(i \/ nk) - 1];\n+                tmp = subWord(rW) ^ RCON[(i \/ nk) - 1];\n@@ -942,1 +942,1 @@\n-                tmp = subByte(tmp, SBOX);\n+                tmp = subWord(tmp);\n@@ -1016,1 +1016,1 @@\n-     * Subtitute the byte as a step of key expansion.\n+     * Subtitute the word as a step of key expansion.\n@@ -1023,5 +1023,5 @@\n-    private static int subByte(int state, byte[][] sub) {\n-        byte b0 = (byte) (state >>> 24);\n-        byte b1 = (byte) ((state >> 16) & 0xFF);\n-        byte b2 = (byte) ((state >> 8) & 0xFF);\n-        byte b3 = (byte) (state & 0xFF);\n+    private static int subWord(int word) {\n+        byte b0 = (byte) (word >>> 24);\n+        byte b1 = (byte) ((word >> 16) & 0xFF);\n+        byte b2 = (byte) ((word >> 8) & 0xFF);\n+        byte b3 = (byte) (word & 0xFF);\n@@ -1029,4 +1029,4 @@\n-        return ((sub[(b0 & 0xF0) >> 4][b0 & 0x0F] & 0xFF) << 24)\n-                | ((sub[(b1 & 0xF0) >> 4][b1 & 0x0F] & 0xFF) << 16)\n-                | ((sub[(b2 & 0xF0) >> 4][b2 & 0x0F] & 0xFF) << 8)\n-                | (sub[(b3 & 0xF0) >> 4][b3 & 0x0F] & 0xFF);\n+        return ((SBOX[(b0 & 0xF0) >> 4][b0 & 0x0F] & 0xFF) << 24)\n+                | ((SBOX[(b1 & 0xF0) >> 4][b1 & 0x0F] & 0xFF) << 16)\n+                | ((SBOX[(b2 & 0xF0) >> 4][b2 & 0x0F] & 0xFF) << 8)\n+                | (SBOX[(b3 & 0xF0) >> 4][b3 & 0x0F] & 0xFF);\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"}]}