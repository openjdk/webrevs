{"files":[{"patch":"@@ -931,1 +931,1 @@\n-            sessionK[1] = invGenRoundKeys();\n+            sessionK[1] = genInvRoundKeys(sessionK[0], rounds);\n@@ -975,4 +975,4 @@\n-    private int[] invGenRoundKeys() {\n-        int kLen = sessionK[0].length;;\n-        int[] tmp = new int[WB];\n-        int[] w = new int[kLen];\n+    private static int[] genInvRoundKeys(int[] w, int rounds) {\n+        int kLen = w.length;;\n+        int[] temp = new int[WB];\n+        int[] dw = new int[kLen];\n@@ -984,10 +984,10 @@\n-            System.arraycopy(sessionK[0], i * WB, tmp, 0, WB);\n-            tmp[0] = TMI0[tmp[0] >>> 24] ^ TMI1[(tmp[0] >> 16) & 0xFF]\n-                    ^ TMI2[(tmp[0] >> 8) & 0xFF] ^ TMI3[tmp[0] & 0xFF];\n-            tmp[1] = TMI0[tmp[1] >>> 24] ^ TMI1[(tmp[1] >> 16) & 0xFF]\n-                    ^ TMI2[(tmp[1] >> 8) & 0xFF] ^ TMI3[tmp[1] & 0xFF];\n-            tmp[2] = TMI0[tmp[2] >>> 24] ^ TMI1[(tmp[2] >> 16) & 0xFF]\n-                    ^ TMI2[(tmp[2] >> 8) & 0xFF] ^ TMI3[tmp[2] & 0xFF];\n-            tmp[3] = TMI0[tmp[3] >>> 24] ^ TMI1[(tmp[3] >> 16) & 0xFF]\n-                    ^ TMI2[(tmp[3] >> 8) & 0xFF] ^ TMI3[tmp[3] & 0xFF];\n-            System.arraycopy(tmp, 0, w, kLen - (i * WB), WB);\n+            System.arraycopy(w, i * WB, temp, 0, WB);\n+            temp[0] = TMI0[temp[0] >>> 24] ^ TMI1[(temp[0] >> 16) & 0xFF]\n+                    ^ TMI2[(temp[0] >> 8) & 0xFF] ^ TMI3[temp[0] & 0xFF];\n+            temp[1] = TMI0[temp[1] >>> 24] ^ TMI1[(temp[1] >> 16) & 0xFF]\n+                    ^ TMI2[(temp[1] >> 8) & 0xFF] ^ TMI3[temp[1] & 0xFF];\n+            temp[2] = TMI0[temp[2] >>> 24] ^ TMI1[(temp[2] >> 16) & 0xFF]\n+                    ^ TMI2[(temp[2] >> 8) & 0xFF] ^ TMI3[temp[2] & 0xFF];\n+            temp[3] = TMI0[temp[3] >>> 24] ^ TMI1[(temp[3] >> 16) & 0xFF]\n+                    ^ TMI2[(temp[3] >> 8) & 0xFF] ^ TMI3[temp[3] & 0xFF];\n+            System.arraycopy(temp, 0, dw, kLen - (i * WB), WB);\n@@ -995,3 +995,3 @@\n-        System.arraycopy(sessionK[0], kLen - WB, w, WB, WB);\n-        System.arraycopy(sessionK[0], 0, w, 0, WB);\n-        Arrays.fill(tmp, 0);\n+        System.arraycopy(w, kLen - WB, dw, WB, WB);\n+        System.arraycopy(w, 0, dw, 0, WB);\n+        Arrays.fill(temp, 0);\n@@ -999,1 +999,1 @@\n-        return w;\n+        return dw;\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":19,"deletions":19,"binary":false,"changes":38,"status":"modified"}]}