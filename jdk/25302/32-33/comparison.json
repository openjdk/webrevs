{"files":[{"patch":"@@ -122,1 +122,1 @@\n-  return Atomic::load(&_head) == 0;\n+  return Atomic::load_acquire(&_head) == 0;\n@@ -231,1 +231,1 @@\n-  Atomic::store(&_is_async_processing_of_cpu_time_jfr_requests_triggered, true);\n+  Atomic::release_store(&_is_async_processing_of_cpu_time_jfr_requests_triggered, true);\n@@ -311,2 +311,2 @@\n-    if (Atomic::load(&_is_async_processing_of_cpu_time_jfr_requests_triggered)) {\n-      Atomic::store(&_is_async_processing_of_cpu_time_jfr_requests_triggered, false);\n+    if (Atomic::load_acquire(&_is_async_processing_of_cpu_time_jfr_requests_triggered)) {\n+      Atomic::release_store(&_is_async_processing_of_cpu_time_jfr_requests_triggered, false);\n@@ -328,1 +328,1 @@\n-      if (!jt->has_last_Java_frame() || !tl->try_acquire_cpu_time_jfr_dequeue_lock()) {\n+      if (!jt->has_last_Java_frame() || jt->thread_state() != _thread_in_native || !tl->try_acquire_cpu_time_jfr_dequeue_lock()) {\n@@ -576,0 +576,1 @@\n+    log_error(jfr)(\"Failed to register the signal handler for thread sampling: %s\", os::strerror(os::get_last_error()));\n","filename":"src\/hotspot\/share\/jfr\/periodic\/sampling\/jfrCPUTimeThreadSampler.cpp","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -483,1 +483,0 @@\n-  assert(jt->thread_state() == _thread_in_native, \"invariant\");\n","filename":"src\/hotspot\/share\/jfr\/periodic\/sampling\/jfrThreadSampling.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -575,1 +575,1 @@\n-  return Atomic::load(&_cpu_time_jfr_locked) == ENQUEUE;\n+  return Atomic::load_acquire(&_cpu_time_jfr_locked) == ENQUEUE;\n@@ -579,1 +579,1 @@\n-  return Atomic::load(&_cpu_time_jfr_locked) == DEQUEUE;\n+  return Atomic::load_acquire(&_cpu_time_jfr_locked) == DEQUEUE;\n@@ -605,1 +605,1 @@\n-  Atomic::store(&_cpu_time_jfr_locked, UNLOCKED);\n+  Atomic::release_store(&_cpu_time_jfr_locked, UNLOCKED);\n","filename":"src\/hotspot\/share\/jfr\/support\/jfrThreadLocal.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}