{"files":[{"patch":"@@ -2163,3 +2163,1 @@\n-    ldr(rscratch1, Address(mdp, poly_count_offset));\n-    add(rscratch1, rscratch1, DataLayout::counter_increment);\n-    str(rscratch1, Address(mdp, poly_count_offset));\n+    increment(Address(mdp, poly_count_offset), DataLayout::counter_increment);\n@@ -2169,1 +2167,1 @@\n-  Register offset = rscratch1;\n+  Register offset = rscratch2;\n@@ -2226,2 +2224,2 @@\n-    ldr(rscratch2, Address(mdp, offset));\n-    cmp(rscratch2, recv);\n+    ldr(rscratch1, Address(mdp, offset));\n+    cmp(rscratch1, recv);\n@@ -2230,2 +2228,2 @@\n-  sub(rscratch2, offset, end_receiver_offset);\n-  cbnz(rscratch2, L_loop_search_receiver);\n+  sub(rscratch1, offset, end_receiver_offset);\n+  cbnz(rscratch1, L_loop_search_receiver);\n@@ -2236,2 +2234,2 @@\n-    ldr(rscratch2, Address(mdp, offset));\n-    cbz(rscratch2, L_found_empty);\n+    ldr(rscratch1, Address(mdp, offset));\n+    cbz(rscratch1, L_found_empty);\n@@ -2239,2 +2237,2 @@\n-  sub(rscratch2, offset, end_receiver_offset);\n-  cbnz(rscratch2, L_loop_search_empty);\n+  sub(rscratch1, offset, end_receiver_offset);\n+  cbnz(rscratch1, L_loop_search_empty);\n@@ -2248,2 +2246,3 @@\n-  \/\/ The update code uses CAS, which clobbers rscratch1. However we\n-  \/\/ will no longer need this value so we do not need to save it.\n+  \/\/ The update uses CAS, which clobbers rscratch1. Therefore, rscratch2\n+  \/\/ is used to hold the destination address. This is safe because the\n+  \/\/ offset is no longer needed after the address is computed.\n@@ -2253,1 +2252,1 @@\n-          \/*acquire*\/ false, \/*release*\/ false, \/*weak*\/ false, noreg);\n+          \/*acquire*\/ false, \/*release*\/ false, \/*weak*\/ true, noreg);\n@@ -2273,3 +2272,1 @@\n-  ldr(rscratch2, Address(mdp, offset));\n-  add(rscratch2, rscratch2, DataLayout::counter_increment);\n-  str(rscratch2, Address(mdp, offset));\n+  increment(Address(mdp, offset), DataLayout::counter_increment);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":15,"deletions":18,"binary":false,"changes":33,"status":"modified"}]}