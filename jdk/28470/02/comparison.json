{"files":[{"patch":"@@ -1013,2 +1013,4 @@\n-  st->print_cr(\"Compiler Memory Statistic, 10 most expensive compilations:\");\n-  print_all_by_size(st, false, false, 0, 10);\n+  if (Thread::current_or_null_safe() != nullptr) {\n+    st->print_cr(\"Compiler Memory Statistic, 10 most expensive compilations:\");\n+    print_all_by_size(st, false, false, 0, 10);\n+  }\n","filename":"src\/hotspot\/share\/compiler\/compilationMemoryStatistic.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2358,1 +2358,2 @@\n-  size_t heap_used = Heap_lock->owned_by_self() ? used() : used_unlocked();\n+  size_t heap_used = (Thread::current_or_null_safe() != nullptr &&\n+                      Heap_lock->owned_by_self()) ? used() : used_unlocked();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"runtime\/thread.hpp\"\n@@ -86,1 +87,2 @@\n-  if (!_lock->try_lock_without_rank_check()) {\n+  if (Thread::current_or_null_safe() == nullptr ||\n+      !_lock->try_lock_without_rank_check()) {\n","filename":"src\/hotspot\/share\/gc\/shared\/gcLogPrecious.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -667,0 +667,1 @@\n+      _thread != nullptr &&\n@@ -1308,1 +1309,1 @@\n-  STEP_IF(\"Native Memory Tracking\", _verbose)\n+  STEP_IF(\"Native Memory Tracking\", _verbose && _thread != nullptr)\n","filename":"src\/hotspot\/share\/utilities\/vmError.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}