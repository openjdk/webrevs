{"files":[{"patch":"@@ -2149,0 +2149,27 @@\n+    private void selectRows(ListSelectionModel selModel, int rowCount) {\n+        selModel.setValueIsAdjusting(true);\n+        int oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), true);\n+        int oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), true);\n+\n+        setRowSelectionInterval(0, rowCount-1);\n+\n+        \/\/ this is done to restore the anchor and lead\n+        SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n+\n+        selModel.setValueIsAdjusting(false);\n+    }\n+\n+    private void selectColumns(TableColumnModel  columnModel, int columnCount) {\n+        ListSelectionModel selModel = columnModel.getSelectionModel();\n+        selModel.setValueIsAdjusting(true);\n+        int oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), false);\n+        int oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), false);\n+\n+        setColumnSelectionInterval(0, columnCount-1);\n+\n+        \/\/ this is done to restore the anchor and lead\n+        SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n+\n+        selModel.setValueIsAdjusting(false);\n+    }\n+\n@@ -2165,23 +2192,2 @@\n-            selModel = selectionModel;\n-            selModel.setValueIsAdjusting(true);\n-            oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), true);\n-            oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), true);\n-\n-            setRowSelectionInterval(0, getRowCount()-1);\n-\n-            \/\/ this is done to restore the anchor and lead\n-            SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n-\n-            selModel.setValueIsAdjusting(false);\n-\n-            selModel = columnModel.getSelectionModel();\n-            selModel.setValueIsAdjusting(true);\n-            oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), false);\n-            oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), false);\n-\n-            setColumnSelectionInterval(0, getColumnCount()-1);\n-\n-            \/\/ this is done to restore the anchor and lead\n-            SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n-\n-            selModel.setValueIsAdjusting(false);\n+            selectRows(selectionModel, rowCount);\n+            selectColumns(columnModel, columnCount);\n@@ -2189,11 +2195,1 @@\n-            selModel = selectionModel;\n-            selModel.setValueIsAdjusting(true);\n-            oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), true);\n-            oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), true);\n-\n-            setRowSelectionInterval(0, getRowCount()-1);\n-\n-            \/\/ this is done to restore the anchor and lead\n-            SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n-\n-            selModel.setValueIsAdjusting(false);\n+            selectRows(selectionModel, rowCount);\n@@ -2201,11 +2197,1 @@\n-            selModel = columnModel.getSelectionModel();\n-            selModel.setValueIsAdjusting(true);\n-            oldLead = getAdjustedIndex(selModel.getLeadSelectionIndex(), false);\n-            oldAnchor = getAdjustedIndex(selModel.getAnchorSelectionIndex(), false);\n-\n-            setColumnSelectionInterval(0, getColumnCount()-1);\n-\n-            \/\/ this is done to restore the anchor and lead\n-            SwingUtilities2.setLeadAnchorWithoutSelection(selModel, oldLead, oldAnchor);\n-\n-            selModel.setValueIsAdjusting(false);\n+            selectColumns(columnModel, columnCount);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/JTable.java","additions":31,"deletions":45,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -40,0 +40,5 @@\n+        testColumnSelect();\n+        testRowSelect();\n+    }\n+\n+    private static void testColumnSelect() {\n@@ -70,0 +75,31 @@\n+\n+    private static void testRowSelect() {\n+        boolean rowSelNoColumn, rowSelWithColumn;\n+\n+        \/\/ TableModel with 10 rows, but no columns\n+        DefaultTableModel data = new DefaultTableModel(10, 0);\n+\n+        JTable table = new JTable(data);\n+\n+        \/\/ columns can be selected\n+        table.setRowSelectionAllowed(true);\n+        table.setColumnSelectionAllowed(false);\n+\n+        table.selectAll();\n+\n+        rowSelNoColumn = table.isRowSelected(0);\n+\n+        \/\/ After selectAll(), I would expect all rows to be selected, no matter\n+        \/\/ whether there are columns or not.\n+        System.out.println(\"Row 0 is selected: \"+ rowSelNoColumn);\n+\n+        data.addColumn(new Object[0]);\n+        table.selectAll();\n+\n+        rowSelWithColumn = table.isRowSelected(0);\n+        System.out.println(\"Row 0 is selected: \"+ rowSelWithColumn);\n+\n+        if (!(rowSelNoColumn && rowSelWithColumn)) {\n+            throw new RuntimeException(\"selectAll did not select row\");\n+        }\n+    }\n","filename":"test\/jdk\/javax\/swing\/JTable\/TestTableSelectAll.java","additions":36,"deletions":0,"binary":false,"changes":36,"status":"modified"}]}