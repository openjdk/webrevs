{"files":[{"patch":"@@ -171,1 +171,4 @@\n-        actualPlaintextBuf.put(cipher.doFinal());\n+\n+        outArray = new byte[cipher.getOutputSize(0) + outOfs];\n+        cipher.doFinal(outArray, outOfs);\n+        actualPlaintextBuf.put(outArray, outOfs, outArray.length - outOfs);\n@@ -186,1 +189,7 @@\n-        cipher.doFinal(ByteBuffer.allocate(0), actualPlaintextDir);\n+\n+        outBuffer = ByteBuffer.allocateDirect(\n+                cipher.getOutputSize(0) + outOfs);\n+        outBuffer.position(outOfs);\n+        cipher.doFinal(ByteBuffer.allocate(0), outBuffer);\n+        outBuffer.position(outOfs);\n+        actualPlaintextDir.put(outBuffer);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestCipherTextStealingMultipart.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"}]}