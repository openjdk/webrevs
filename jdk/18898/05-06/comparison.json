{"files":[{"patch":"@@ -956,8 +956,0 @@\n-                if (blockMode == Mode.CTS) {\n-                    convertCTSVariant(null, padBuffer, padBufferLen);\n-                    k = token.p11.C_DecryptUpdate(session.id(),\n-                            0, padBuffer, 0, padBufferLen,\n-                            0, out, outOfs, outLen);\n-                    outOfs += k;\n-                    outLen -= k;\n-                }\n@@ -983,0 +975,8 @@\n+                    if (blockMode == Mode.CTS) {\n+                        convertCTSVariant(null, padBuffer, padBufferLen);\n+                        k = token.p11.C_DecryptUpdate(session.id(),\n+                                0, padBuffer, 0, padBufferLen,\n+                                0, out, outOfs, outLen);\n+                        outOfs += k;\n+                        outLen -= k;\n+                    }\n@@ -1069,8 +1069,0 @@\n-                    if (blockMode == Mode.CTS) {\n-                        convertCTSVariant(null, padBuffer, padBufferLen);\n-                        k = token.p11.C_DecryptUpdate(session.id(),\n-                                0, padBuffer, 0, padBufferLen,\n-                                outAddr, outArray, outOfs, outLen);\n-                        outOfs += k;\n-                        outLen -= k;\n-                    }\n@@ -1098,0 +1090,8 @@\n+                        if (blockMode == Mode.CTS) {\n+                            convertCTSVariant(null, padBuffer, padBufferLen);\n+                            k = token.p11.C_DecryptUpdate(session.id(),\n+                                    0, padBuffer, 0, padBufferLen,\n+                                    outAddr, outArray, outOfs, outLen);\n+                            outOfs += k;\n+                            outLen -= k;\n+                        }\n@@ -1172,0 +1172,3 @@\n+            \/\/ No assumptions should be made about the current ciphertextBuf\n+            \/\/ position. Use offsets to read and write bytes from the last two\n+            \/\/ blocks. Other blocks should not be modified.\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Cipher.java","additions":19,"deletions":16,"binary":false,"changes":35,"status":"modified"}]}