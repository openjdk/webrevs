{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -524,1 +524,1 @@\n-  if (allow_suspend && _handshakee->is_disable_suspend()) {\n+  if (allow_suspend && (_handshakee->is_disable_suspend() || _handshakee->is_vthread_transition_disabler())) {\n","filename":"src\/hotspot\/share\/runtime\/handshake.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -502,1 +502,1 @@\n-  DEBUG_ONLY(_is_vthread_transition_disabler(false) COMMA)\n+  _is_vthread_transition_disabler(false),\n@@ -1168,1 +1168,0 @@\n-#ifdef ASSERT\n@@ -1173,0 +1172,1 @@\n+#ifdef ASSERT\n@@ -1186,1 +1186,1 @@\n-  assert(!is_vthread_transition_disabler(), \"no suspend allowed for vthread transition disablers\");\n+  \/\/ The HandshakeState::has_operation does not allow such suspends.\n","filename":"src\/hotspot\/share\/runtime\/javaThread.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -737,1 +737,1 @@\n-  DEBUG_ONLY(bool _is_vthread_transition_disabler;)  \/\/ thread currently disabled vthread transitions\n+  bool _is_vthread_transition_disabler;              \/\/ thread currently disabled vthread transitions\n@@ -742,1 +742,0 @@\n-#ifdef ASSERT\n@@ -745,0 +744,1 @@\n+#ifdef ASSERT\n","filename":"src\/hotspot\/share\/runtime\/javaThread.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2025, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -297,1 +297,1 @@\n-  DEBUG_ONLY(JavaThread::current()->set_is_vthread_transition_disabler(true);)\n+  JavaThread::current()->set_is_vthread_transition_disabler(true);\n@@ -303,1 +303,1 @@\n-  DEBUG_ONLY(JavaThread* thread = JavaThread::current();)\n+  JavaThread* thread = JavaThread::current();\n@@ -338,1 +338,1 @@\n-  DEBUG_ONLY(thread->set_is_vthread_transition_disabler(true);)\n+  thread->set_is_vthread_transition_disabler(true);\n@@ -361,1 +361,1 @@\n-  DEBUG_ONLY(JavaThread::current()->set_is_vthread_transition_disabler(false);)\n+  JavaThread::current()->set_is_vthread_transition_disabler(false);\n@@ -387,1 +387,1 @@\n-  DEBUG_ONLY(thread->set_is_vthread_transition_disabler(false);)\n+  thread->set_is_vthread_transition_disabler(false);\n","filename":"src\/hotspot\/share\/runtime\/mountUnmountDisabler.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2025, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -136,0 +136,1 @@\n+    assert(!_target->is_vthread_transition_disabler(), \"attempt to suspend a vthread transition disabler\");\n","filename":"src\/hotspot\/share\/runtime\/suspendResumeManager.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}