{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2025, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/protocol\/https\/HttpsClient.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @summary Test that the HttpsURLConnection does not set IPv6 address literals for SNI hostname during TLS handshake\n@@ -28,1 +29,0 @@\n- * @summary TLS connection to IPv6 address fails with BCJSSE due to IllegalArgumentException\n@@ -32,3 +32,18 @@\n-import javax.net.ssl.*;\n-import java.io.*;\n-import java.net.*;\n+import javax.net.ssl.HandshakeCompletedListener;\n+import javax.net.ssl.HttpsURLConnection;\n+import javax.net.ssl.SSLParameters;\n+import javax.net.ssl.SSLServerSocket;\n+import javax.net.ssl.SSLServerSocketFactory;\n+import javax.net.ssl.SSLSession;\n+import javax.net.ssl.SSLSocket;\n+import javax.net.ssl.SSLSocketFactory;\n+import java.io.BufferedWriter;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.OutputStream;\n+import java.io.OutputStreamWriter;\n+import java.net.InetAddress;\n+import java.net.Socket;\n+import java.net.SocketAddress;\n+import java.net.URL;\n+import java.net.UnknownHostException;\n@@ -41,12 +56,0 @@\n-    \/*\n-     * =============================================================\n-     * Set the various variables needed for the tests, then\n-     * specify what tests to run on each side.\n-     *\/\n-\n-    \/*\n-     * Should we run the client or server in a separate thread?\n-     * Both sides can throw exceptions, but do you have a preference\n-     * as to which side should be the main thread.\n-     *\/\n-    static boolean separateServerThread = true;\n@@ -62,10 +65,1 @@\n-    static boolean debug = false;\n-\n-    \/*\n-     * If the client or server is doing some kind of object creation\n-     * that the other side depends on, and that thread prematurely\n-     * exits, you may experience a hang.  The test harness will\n-     * terminate all hung threads after its timeout has expired,\n-     * currently 3 minutes by default, but you might try to be\n-     * smart about it....\n-     *\/\n+    static boolean debug = Boolean.getBoolean(\"test.debug\");\n@@ -97,1 +91,0 @@\n-        Thread.sleep(5000);\n@@ -131,5 +124,0 @@\n-    \/*\n-     * =============================================================\n-     * The remainder is just support stuff\n-     *\/\n-\n@@ -139,0 +127,1 @@\n+    \/\/ stores an exception thrown by server in a separate thread\n@@ -140,1 +129,0 @@\n-    volatile Exception clientException = null;\n@@ -156,1 +144,0 @@\n-    Thread clientThread = null;\n@@ -165,7 +152,2 @@\n-        if (separateServerThread) {\n-            startServer(true);\n-            startClient(false);\n-        } else {\n-            startClient(true);\n-            startServer(false);\n-        }\n+        startServer();\n+        startClient();\n@@ -176,5 +158,1 @@\n-        if (separateServerThread) {\n-            serverThread.join();\n-        } else {\n-            clientThread.join();\n-        }\n+        serverThread.join();\n@@ -182,7 +160,0 @@\n-        \/*\n-         * When we get here, the test is pretty much over.\n-         *\n-         * If the main thread excepted, that propagates back\n-         * immediately.  If the other thread threw an exception, we\n-         * should report back.\n-         *\/\n@@ -191,2 +162,0 @@\n-        if (clientException != null)\n-            throw clientException;\n@@ -195,16 +164,14 @@\n-    void startServer(boolean newThread) throws Exception {\n-        if (newThread) {\n-            serverThread = new Thread() {\n-                public void run() {\n-                    try {\n-                        doServerSide();\n-                    } catch (Exception e) {\n-                        \/*\n-                         * Our server thread just died.\n-                         *\n-                         * Release the client, if not active already...\n-                         *\/\n-                        System.err.println(\"Server died:\");\n-                        serverReady = true;\n-                        serverException = e;\n-                    }\n+    void startServer() throws Exception {\n+        serverThread = new Thread() {\n+            public void run() {\n+                try {\n+                    doServerSide();\n+                } catch (Exception e) {\n+                    \/*\n+                     * Our server thread just died.\n+                     *\n+                     * Release the client, if not active already...\n+                     *\/\n+                    System.err.println(\"Server died:\");\n+                    serverReady = true;\n+                    serverException = e;\n@@ -212,5 +179,3 @@\n-            };\n-            serverThread.start();\n-        } else {\n-            doServerSide();\n-        }\n+            }\n+        };\n+        serverThread.start();\n@@ -219,19 +184,2 @@\n-    void startClient(boolean newThread) throws Exception {\n-        if (newThread) {\n-            clientThread = new Thread() {\n-                public void run() {\n-                    try {\n-                        doClientSide();\n-                    } catch (Exception e) {\n-                        \/*\n-                         * Our client thread just died.\n-                         *\/\n-                        System.err.println(\"Client died...\");\n-                        clientException = e;\n-                    }\n-                }\n-            };\n-            clientThread.start();\n-        } else {\n-            doClientSide();\n-        }\n+    void startClient() throws Exception {\n+        doClientSide();\n","filename":"test\/jdk\/javax\/net\/ssl\/HttpsURLConnection\/SubjectAltNameIPv6.java","additions":43,"deletions":95,"binary":false,"changes":138,"status":"modified"}]}