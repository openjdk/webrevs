{"files":[{"patch":"@@ -28,3 +28,2 @@\n- * @library \/java\/awt\/regtesthelpers\n- * @build PassFailJFrame\n- * @run main\/manual FocusKeepTest\n+ * @key headful\n+ * @run main FocusKeepTest\n@@ -34,0 +33,2 @@\n+import java.awt.KeyboardFocusManager;\n+import java.awt.Robot;\n@@ -36,1 +37,1 @@\n-import java.awt.Frame;\n+import java.awt.event.KeyEvent;\n@@ -39,0 +40,1 @@\n+import javax.swing.SwingUtilities;\n@@ -42,3 +44,2 @@\n-    private static final String INSTRUCTIONS = \"\"\"\n-         When window comes up, hit tab key.\n-         If Focus stay on the first component press Pass else press Fail\"\"\";\n+    static JFrame frame;\n+    static JTextField tf;\n@@ -47,12 +48,22 @@\n-        PassFailJFrame.builder()\n-                .title(\"FocusKeepTest Instructions\")\n-                .instructions(INSTRUCTIONS)\n-                .rows((int) INSTRUCTIONS.lines().count() + 2)\n-                .columns(35)\n-                .testUI(FocusKeepTest::createTestUI)\n-                .build()\n-                .awaitAndCheck();\n-    }\n-\n-    private static Frame createTestUI() {\n-        return new TestFocusSwing();\n+        Robot robot = new Robot();\n+        robot.setAutoDelay(100);\n+        try {\n+            SwingUtilities.invokeAndWait(() -> createTestUI());\n+            robot.waitForIdle();\n+            robot.delay(1000);\n+            robot.keyPress(KeyEvent.VK_TAB);\n+            robot.keyRelease(KeyEvent.VK_TAB);\n+            if (KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner() instanceof JTextField tf1) {\n+                if (!tf1.getText().equals(\"TextField 1\")) {\n+                    throw new RuntimeException(\"Focus on wrong textfield\");\n+                }\n+            } else {\n+                throw new RuntimeException(\"Focus not on correct component\");\n+            }\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (frame != null) {\n+                    frame.dispose();\n+                }\n+            });\n+        }\n@@ -60,17 +71,14 @@\n-\n-}\n-\n-class TestFocusSwing extends JFrame {\n-\n-    public TestFocusSwing() {\n-        JTextField tf;\n-\n-        tf = new JTextField (\"TextField 1\");\n-        tf.addFocusListener (new MyFocusAdapter (\"TextField 1\"));\n-        add(tf, BorderLayout.NORTH);\n-\n-        tf = new JTextField (\"TextField 2\");\n-        tf.addFocusListener (new MyFocusAdapter (\"TextField 2\"));\n-        add(tf, BorderLayout.SOUTH);\n-\n-        pack();\n+   \n+    private static void createTestUI() {    \n+        frame = new JFrame(\"FocusKeepTest\");        \n+        tf = new JTextField(\"TextField 1\");\n+        tf.addFocusListener(new MyFocusAdapter(\"TextField 1\"));\n+        frame.add(tf, BorderLayout.NORTH);\n+\n+        tf = new JTextField(\"TextField 2\");\n+        tf.addFocusListener(new MyFocusAdapter(\"TextField 2\"));\n+        frame.add(tf, BorderLayout.SOUTH);\n+\n+        frame.pack();\n+        frame.setLocationRelativeTo(null);\n+        frame.setVisible(true); \n@@ -79,1 +87,1 @@\n-    class MyFocusAdapter extends FocusAdapter {\n+    static class MyFocusAdapter extends FocusAdapter {\n","filename":"test\/jdk\/java\/awt\/Focus\/FocusKeepTest.java","additions":45,"deletions":37,"binary":false,"changes":82,"status":"modified"}]}