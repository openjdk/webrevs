{"files":[{"patch":"@@ -54,0 +54,1 @@\n+#include \"runtime\/init.hpp\"\n@@ -327,0 +328,8 @@\n+      if (!is_init_completed()) {\n+        \/\/ Can't do GC; try heap expansion to satisfy the request.\n+        result = expand_heap_and_allocate(size, is_tlab);\n+        if (result != nullptr) {\n+          return result;\n+        }\n+      }\n+\n@@ -397,2 +406,2 @@\n-  assert(SafepointSynchronize::is_at_safepoint(), \"precondition\");\n-  \/\/ We just finished a young\/full gc, try everything to satisfy this allocation request.\n+  assert(Heap_lock->is_locked(), \"precondition\");\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/parallelScavengeHeap.cpp","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -304,2 +304,1 @@\n-  assert(SafepointSynchronize::is_at_safepoint(), \"precondition\");\n-  assert(Thread::current()->is_VM_thread(), \"precondition\");\n+  assert(Heap_lock->is_locked(), \"precondition\");\n","filename":"src\/hotspot\/share\/gc\/parallel\/psYoungGen.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -847,2 +847,1 @@\n-  assert(SafepointSynchronize::is_at_safepoint(), \"precondition\");\n-  assert(Thread::current()->is_VM_thread(), \"precondition\");\n+  assert(Heap_lock->is_locked(), \"precondition\");\n","filename":"src\/hotspot\/share\/gc\/serial\/defNewGeneration.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -70,0 +70,1 @@\n+#include \"runtime\/init.hpp\"\n@@ -271,0 +272,2 @@\n+  assert(Heap_lock->is_locked(), \"precondition\");\n+\n@@ -319,0 +322,8 @@\n+      if (!is_init_completed()) {\n+        \/\/ Can't do GC; try heap expansion to satisfy the request.\n+        result = expand_heap_and_allocate(size, is_tlab);\n+        if (result != nullptr) {\n+          return result;\n+        }\n+      }\n+\n","filename":"src\/hotspot\/share\/gc\/serial\/serialHeap.cpp","additions":11,"deletions":0,"binary":false,"changes":11,"status":"modified"}]}