{"files":[{"patch":"@@ -761,1 +761,17 @@\n-    return (JLI_HasSuffix(arg, \".java\") && stat(arg, &st) == 0);\n+    if (JLI_HasSuffix(arg, \".java\") == JNI_TRUE)\n+        return JNI_TRUE;\n+    if (stat(arg, &st) != 0)\n+        return JNI_FALSE;\n+    if (st.st_size < 2)\n+        return JNI_FALSE;\n+    \/*\n+     * In a shebang file, the first two bytes must be 0x23 0x21,\n+     * the two-character ASCII encoding of #!.\n+     *\/\n+    FILE* file = fopen(arg, \"r\");\n+    if (file == NULL)\n+        return JNI_FALSE;\n+    char c = fgetc(file);\n+    char d = fgetc(file);\n+    fclose(file);\n+    return c == 0x23 && d == 0x21; \/\/ #!\n","filename":"src\/java.base\/share\/native\/libjli\/java.c","additions":17,"deletions":1,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -164,0 +164,14 @@\n+    public void testHelloWorldWithShebangWithoutSource(Path base) throws IOException {\n+        tb.writeJavaFiles(base,\n+            \"#!\/usr\/bin\/java\\n\" + \/\/ without \"--source N\" for JDK-8340380\n+            \"import java.util.Arrays;\\n\" +\n+            \"class HelloWorld {\\n\" +\n+            \"    public static void main(String... args) {\\n\" +\n+            \"        System.out.println(\\\"Hello World! \\\" + Arrays.toString(args));\\n\" +\n+            \"    }\\n\" +\n+            \"}\");\n+        Files.copy(base.resolve(\"HelloWorld.java\"), base.resolve(\"HelloWorld\"));\n+        testSuccess(base.resolve(\"HelloWorld\"), \"Hello World! [1, 2, 3]\\n\");\n+    }\n+\n+    @Test\n","filename":"test\/langtools\/tools\/javac\/launcher\/SourceLauncherTest.java","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"}]}