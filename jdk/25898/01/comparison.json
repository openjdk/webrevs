{"files":[{"patch":"@@ -94,8 +94,1 @@\n-static int enhancedExceptionsAllowed = -1;\n-\n-#define CHECK_NULL_THROW_ERROR(X) \\\n-    if (X == NULL) {                                        \\\n-        JNU_ThrowByName(env, \"java\/lang\/InternalError\",     \\\n-            \"can't initialize enhanced exceptions\");        \\\n-        return -1;                                          \\\n-    }\n+static int enhancedExceptionsAllowed = 0;\n@@ -111,1 +104,1 @@\n-    CHECK_NULL_THROW_ERROR(cls);\n+    CHECK_NULL_RETURN(cls, ENH_INIT_ERROR);\n@@ -113,1 +106,1 @@\n-    CHECK_NULL_THROW_ERROR(fid);\n+    CHECK_NULL_RETURN(fid, ENH_INIT_ERROR);\n","filename":"src\/java.base\/share\/native\/libnet\/net_util.c","additions":3,"deletions":10,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -186,0 +186,5 @@\n+\/* return codes *\/\n+#define ENH_INIT_ERROR -1  \/* initialization error: check exceptions *\/\n+#define ENH_DISABLED    0  \/* enhanced exceptions disabled *\/\n+#define ENH_ENABLED     1  \/* enhanced exceptions enabled *\/\n+\n","filename":"src\/java.base\/share\/native\/libnet\/net_util.h","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -191,0 +191,3 @@\n+    if (enhancedExceptions == ENH_INIT_ERROR && (*env)->ExceptionCheck(env)) {\n+        return;\n+    }\n@@ -192,1 +195,1 @@\n-    if (enhancedExceptions) {\n+    if (enhancedExceptions == ENH_ENABLED) {\n@@ -203,1 +206,1 @@\n-        if (enhancedExceptions) {\n+        if (enhancedExceptions == ENH_ENABLED) {\n","filename":"src\/java.base\/unix\/native\/libnet\/net_util_md.c","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -91,3 +91,6 @@\n-        NET_ThrowByNameWithLastError(\n-            env, \"java\/net\/UnknownHostException\",\n-            getEnhancedExceptionsAllowed(env) ? hostname : \"\");\n+        int enh = getEnhancedExceptionsAllowed(env);\n+        if (enh == ENH_INIT_ERROR && (*env)->ExceptionCheck(env)) {\n+            return NULL;\n+        }\n+        const char *hmsg = (enh == ENH_ENABLED) ? hostname : \"\";\n+        NET_ThrowByNameWithLastError( env, \"java\/net\/UnknownHostException\", hmsg);\n","filename":"src\/java.base\/windows\/native\/libnet\/Inet4AddressImpl.c","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -86,2 +86,6 @@\n-        NET_ThrowByNameWithLastError(env, \"java\/net\/UnknownHostException\",\n-            getEnhancedExceptionsAllowed(env) ? hostname : \"\");\n+        int enh = getEnhancedExceptionsAllowed(env);\n+        if (enh == ENH_INIT_ERROR && (*env)->ExceptionCheck(env)) {\n+            return NULL;\n+        }\n+        const char *hmsg = (enh == ENH_ENABLED) ? hostname : \"\";\n+        NET_ThrowByNameWithLastError(env, \"java\/net\/UnknownHostException\", hmsg);\n","filename":"src\/java.base\/windows\/native\/libnet\/Inet6AddressImpl.c","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"}]}