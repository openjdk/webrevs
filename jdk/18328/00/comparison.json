{"files":[{"patch":"@@ -3952,4 +3952,4 @@\n-  if (UseNeon) {\n-      cmp(len, (u1)64);\n-      br(Assembler::LT, L_by16);\n-      eor(v16, T16B, v16, v16);\n+    \/\/ Neon code start\n+    cmp(len, (u1)64);\n+    br(Assembler::LT, L_by16);\n+    eor(v16, T16B, v16, v16);\n@@ -3957,1 +3957,1 @@\n-    Label L_fold;\n+  Label L_fold;\n@@ -3959,1 +3959,1 @@\n-      add(tmp, table0, 4*256*sizeof(juint)); \/\/ Point at the Neon constants\n+    add(tmp, table0, 4*256*sizeof(juint)); \/\/ Point at the Neon constants\n@@ -3961,6 +3961,6 @@\n-      ld1(v0, v1, T2D, post(buf, 32));\n-      ld1r(v4, T2D, post(tmp, 8));\n-      ld1r(v5, T2D, post(tmp, 8));\n-      ld1r(v6, T2D, post(tmp, 8));\n-      ld1r(v7, T2D, post(tmp, 8));\n-      mov(v16, S, 0, crc);\n+    ld1(v0, v1, T2D, post(buf, 32));\n+    ld1r(v4, T2D, post(tmp, 8));\n+    ld1r(v5, T2D, post(tmp, 8));\n+    ld1r(v6, T2D, post(tmp, 8));\n+    ld1r(v7, T2D, post(tmp, 8));\n+    mov(v16, S, 0, crc);\n@@ -3968,2 +3968,2 @@\n-      eor(v0, T16B, v0, v16);\n-      sub(len, len, 64);\n+    eor(v0, T16B, v0, v16);\n+    sub(len, len, 64);\n@@ -3971,5 +3971,5 @@\n-    BIND(L_fold);\n-      pmull(v22, T8H, v0, v5, T8B);\n-      pmull(v20, T8H, v0, v7, T8B);\n-      pmull(v23, T8H, v0, v4, T8B);\n-      pmull(v21, T8H, v0, v6, T8B);\n+  BIND(L_fold);\n+    pmull(v22, T8H, v0, v5, T8B);\n+    pmull(v20, T8H, v0, v7, T8B);\n+    pmull(v23, T8H, v0, v4, T8B);\n+    pmull(v21, T8H, v0, v6, T8B);\n@@ -3977,8 +3977,4 @@\n-      pmull2(v18, T8H, v0, v5, T16B);\n-      pmull2(v16, T8H, v0, v7, T16B);\n-      pmull2(v19, T8H, v0, v4, T16B);\n-      pmull2(v17, T8H, v0, v6, T16B);\n-\n-      uzp1(v24, T8H, v20, v22);\n-      uzp2(v25, T8H, v20, v22);\n-      eor(v20, T16B, v24, v25);\n+    pmull2(v18, T8H, v0, v5, T16B);\n+    pmull2(v16, T8H, v0, v7, T16B);\n+    pmull2(v19, T8H, v0, v4, T16B);\n+    pmull2(v17, T8H, v0, v6, T16B);\n@@ -3986,3 +3982,3 @@\n-      uzp1(v26, T8H, v16, v18);\n-      uzp2(v27, T8H, v16, v18);\n-      eor(v16, T16B, v26, v27);\n+    uzp1(v24, T8H, v20, v22);\n+    uzp2(v25, T8H, v20, v22);\n+    eor(v20, T16B, v24, v25);\n@@ -3990,2 +3986,3 @@\n-      ushll2(v22, T4S, v20, T8H, 8);\n-      ushll(v20, T4S, v20, T4H, 8);\n+    uzp1(v26, T8H, v16, v18);\n+    uzp2(v27, T8H, v16, v18);\n+    eor(v16, T16B, v26, v27);\n@@ -3993,2 +3990,2 @@\n-      ushll2(v18, T4S, v16, T8H, 8);\n-      ushll(v16, T4S, v16, T4H, 8);\n+    ushll2(v22, T4S, v20, T8H, 8);\n+    ushll(v20, T4S, v20, T4H, 8);\n@@ -3996,4 +3993,2 @@\n-      eor(v22, T16B, v23, v22);\n-      eor(v18, T16B, v19, v18);\n-      eor(v20, T16B, v21, v20);\n-      eor(v16, T16B, v17, v16);\n+    ushll2(v18, T4S, v16, T8H, 8);\n+    ushll(v16, T4S, v16, T4H, 8);\n@@ -4001,3 +3996,4 @@\n-      uzp1(v17, T2D, v16, v20);\n-      uzp2(v21, T2D, v16, v20);\n-      eor(v17, T16B, v17, v21);\n+    eor(v22, T16B, v23, v22);\n+    eor(v18, T16B, v19, v18);\n+    eor(v20, T16B, v21, v20);\n+    eor(v16, T16B, v17, v16);\n@@ -4005,2 +4001,3 @@\n-      ushll2(v20, T2D, v17, T4S, 16);\n-      ushll(v16, T2D, v17, T2S, 16);\n+    uzp1(v17, T2D, v16, v20);\n+    uzp2(v21, T2D, v16, v20);\n+    eor(v17, T16B, v17, v21);\n@@ -4008,2 +4005,2 @@\n-      eor(v20, T16B, v20, v22);\n-      eor(v16, T16B, v16, v18);\n+    ushll2(v20, T2D, v17, T4S, 16);\n+    ushll(v16, T2D, v17, T2S, 16);\n@@ -4011,3 +4008,2 @@\n-      uzp1(v17, T2D, v20, v16);\n-      uzp2(v21, T2D, v20, v16);\n-      eor(v28, T16B, v17, v21);\n+    eor(v20, T16B, v20, v22);\n+    eor(v16, T16B, v16, v18);\n@@ -4015,4 +4011,3 @@\n-      pmull(v22, T8H, v1, v5, T8B);\n-      pmull(v20, T8H, v1, v7, T8B);\n-      pmull(v23, T8H, v1, v4, T8B);\n-      pmull(v21, T8H, v1, v6, T8B);\n+    uzp1(v17, T2D, v20, v16);\n+    uzp2(v21, T2D, v20, v16);\n+    eor(v28, T16B, v17, v21);\n@@ -4020,4 +4015,4 @@\n-      pmull2(v18, T8H, v1, v5, T16B);\n-      pmull2(v16, T8H, v1, v7, T16B);\n-      pmull2(v19, T8H, v1, v4, T16B);\n-      pmull2(v17, T8H, v1, v6, T16B);\n+    pmull(v22, T8H, v1, v5, T8B);\n+    pmull(v20, T8H, v1, v7, T8B);\n+    pmull(v23, T8H, v1, v4, T8B);\n+    pmull(v21, T8H, v1, v6, T8B);\n@@ -4025,1 +4020,4 @@\n-      ld1(v0, v1, T2D, post(buf, 32));\n+    pmull2(v18, T8H, v1, v5, T16B);\n+    pmull2(v16, T8H, v1, v7, T16B);\n+    pmull2(v19, T8H, v1, v4, T16B);\n+    pmull2(v17, T8H, v1, v6, T16B);\n@@ -4027,3 +4025,1 @@\n-      uzp1(v24, T8H, v20, v22);\n-      uzp2(v25, T8H, v20, v22);\n-      eor(v20, T16B, v24, v25);\n+    ld1(v0, v1, T2D, post(buf, 32));\n@@ -4031,3 +4027,3 @@\n-      uzp1(v26, T8H, v16, v18);\n-      uzp2(v27, T8H, v16, v18);\n-      eor(v16, T16B, v26, v27);\n+    uzp1(v24, T8H, v20, v22);\n+    uzp2(v25, T8H, v20, v22);\n+    eor(v20, T16B, v24, v25);\n@@ -4035,2 +4031,3 @@\n-      ushll2(v22, T4S, v20, T8H, 8);\n-      ushll(v20, T4S, v20, T4H, 8);\n+    uzp1(v26, T8H, v16, v18);\n+    uzp2(v27, T8H, v16, v18);\n+    eor(v16, T16B, v26, v27);\n@@ -4038,2 +4035,2 @@\n-      ushll2(v18, T4S, v16, T8H, 8);\n-      ushll(v16, T4S, v16, T4H, 8);\n+    ushll2(v22, T4S, v20, T8H, 8);\n+    ushll(v20, T4S, v20, T4H, 8);\n@@ -4041,4 +4038,2 @@\n-      eor(v22, T16B, v23, v22);\n-      eor(v18, T16B, v19, v18);\n-      eor(v20, T16B, v21, v20);\n-      eor(v16, T16B, v17, v16);\n+    ushll2(v18, T4S, v16, T8H, 8);\n+    ushll(v16, T4S, v16, T4H, 8);\n@@ -4046,3 +4041,4 @@\n-      uzp1(v17, T2D, v16, v20);\n-      uzp2(v21, T2D, v16, v20);\n-      eor(v16, T16B, v17, v21);\n+    eor(v22, T16B, v23, v22);\n+    eor(v18, T16B, v19, v18);\n+    eor(v20, T16B, v21, v20);\n+    eor(v16, T16B, v17, v16);\n@@ -4050,2 +4046,3 @@\n-      ushll2(v20, T2D, v16, T4S, 16);\n-      ushll(v16, T2D, v16, T2S, 16);\n+    uzp1(v17, T2D, v16, v20);\n+    uzp2(v21, T2D, v16, v20);\n+    eor(v16, T16B, v17, v21);\n@@ -4053,2 +4050,2 @@\n-      eor(v20, T16B, v22, v20);\n-      eor(v16, T16B, v16, v18);\n+    ushll2(v20, T2D, v16, T4S, 16);\n+    ushll(v16, T2D, v16, T2S, 16);\n@@ -4056,3 +4053,2 @@\n-      uzp1(v17, T2D, v20, v16);\n-      uzp2(v21, T2D, v20, v16);\n-      eor(v20, T16B, v17, v21);\n+    eor(v20, T16B, v22, v20);\n+    eor(v16, T16B, v16, v18);\n@@ -4060,2 +4056,3 @@\n-      shl(v16, T2D, v28, 1);\n-      shl(v17, T2D, v20, 1);\n+    uzp1(v17, T2D, v20, v16);\n+    uzp2(v21, T2D, v20, v16);\n+    eor(v20, T16B, v17, v21);\n@@ -4063,2 +4060,2 @@\n-      eor(v0, T16B, v0, v16);\n-      eor(v1, T16B, v1, v17);\n+    shl(v16, T2D, v28, 1);\n+    shl(v17, T2D, v20, 1);\n@@ -4066,2 +4063,2 @@\n-      subs(len, len, 32);\n-      br(Assembler::GE, L_fold);\n+    eor(v0, T16B, v0, v16);\n+    eor(v1, T16B, v1, v17);\n@@ -4069,13 +4066,2 @@\n-      mov(crc, 0);\n-      mov(tmp, v0, D, 0);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n-      mov(tmp, v0, D, 1);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n-      mov(tmp, v1, D, 0);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n-      mov(tmp, v1, D, 1);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n-      update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n+    subs(len, len, 32);\n+    br(Assembler::GE, L_fold);\n@@ -4083,2 +4069,16 @@\n-      add(len, len, 32);\n-  }\n+    mov(crc, 0);\n+    mov(tmp, v0, D, 0);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n+    mov(tmp, v0, D, 1);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n+    mov(tmp, v1, D, 0);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n+    mov(tmp, v1, D, 1);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, false);\n+    update_word_crc32(crc, tmp, tmp2, table0, table1, table2, table3, true);\n+\n+    add(len, len, 32);\n+    \/\/ Neon code end\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":102,"deletions":102,"binary":false,"changes":204,"status":"modified"}]}