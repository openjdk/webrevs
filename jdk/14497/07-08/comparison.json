{"files":[{"patch":"@@ -33,0 +33,1 @@\n+import javax.accessibility.AccessibleContext;\n@@ -38,1 +39,0 @@\n-import javax.swing.JLabel;\n@@ -45,2 +45,0 @@\n-import apple.laf.JRSUIState;\n-import apple.laf.JRSUIConstants.ArrowsOnly;\n@@ -49,0 +47,1 @@\n+import apple.laf.JRSUIConstants.ArrowsOnly;\n@@ -54,2 +53,1 @@\n-\n-import javax.accessibility.AccessibleContext;\n+import apple.laf.JRSUIState;\n@@ -90,4 +88,8 @@\n-        AccessibleContext ac = this.getAccessibleContext();\n-        if (ac != null && !comboBox.isEditable() && list.getModel().getSize() > 0) {\n-            ac.setAccessibleName(String.valueOf(list.getModel()\n-                    .getElementAt(0)));\n+        updateAccessibleName();\n+    }\n+\n+    protected void updateAccessibleName() {\n+        AccessibleContext ac = getAccessibleContext();\n+        if (ac != null && !comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n+            Component c = getRendererComponent();\n+            ac.setAccessibleName(c.getAccessibleContext().getAccessibleName());\n@@ -199,1 +201,1 @@\n-    protected void doRendererPaint(final Graphics g, final ButtonModel buttonModel, final boolean editable, final Insets insets, int left, int top, int width, int height) {\n+    final Component getRendererComponent() {\n@@ -202,0 +204,4 @@\n+        return renderer.getListCellRendererComponent(list, comboBox.getSelectedItem(), -1, false, false);\n+    }\n+\n+    protected void doRendererPaint(final Graphics g, final ButtonModel buttonModel, final boolean editable, final Insets insets, int left, int top, int width, int height) {\n@@ -203,2 +209,1 @@\n-        final Component c = renderer.getListCellRendererComponent(list, comboBox.getSelectedItem(), -1, false, false);\n-        \/\/ System.err.println(\"Renderer: \" + renderer);\n+        final Component c = getRendererComponent();\n","filename":"src\/java.desktop\/macosx\/classes\/com\/apple\/laf\/AquaComboBoxButton.java","additions":17,"deletions":12,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -41,0 +41,2 @@\n+import java.beans.PropertyChangeEvent;\n+import java.beans.PropertyChangeListener;\n@@ -83,0 +85,2 @@\n+    private static final String RENDERER_PROPERTY = \"renderer\";\n+\n@@ -107,0 +111,1 @@\n+        comboBox.addPropertyChangeListener(RENDERER_PROPERTY, propertyRendererListener);\n@@ -112,0 +117,1 @@\n+        comboBox.removePropertyChangeListener(RENDERER_PROPERTY, propertyRendererListener);\n@@ -139,3 +145,2 @@\n-                AccessibleContext ac = ((Accessible)arrowButton).getAccessibleContext();\n-                if (ac != null && !comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n-                    ac.setAccessibleName(String.valueOf(comboBox.getSelectedItem()));\n+                if (!comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n+                    ((AquaComboBoxButton) arrowButton).updateAccessibleName();\n@@ -762,3 +767,2 @@\n-                } else if (!comboBox.isEditable()\n-                        && (arrowButton instanceof Accessible accessibleArrowButton)) {\n-                    return accessibleArrowButton;\n+                } else if (!comboBox.isEditable()) {\n+                    return arrowButton;\n@@ -770,0 +774,10 @@\n+\n+    private final PropertyChangeListener propertyRendererListener =\n+            new PropertyChangeListener() {\n+                @Override\n+                public void propertyChange(final PropertyChangeEvent evt) {\n+                    if (RENDERER_PROPERTY.equals(evt.getPropertyName())) {\n+                        ((AquaComboBoxButton) arrowButton).updateAccessibleName();\n+                    }\n+                }\n+            };\n","filename":"src\/java.desktop\/macosx\/classes\/com\/apple\/laf\/AquaComboBoxUI.java","additions":20,"deletions":6,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -62,1 +62,0 @@\n-        combo.setRenderer(this);\n@@ -64,0 +63,1 @@\n+        combo.setRenderer(this);\n","filename":"test\/jdk\/javax\/swing\/JComboBox\/6567433\/UpdateUIRecursionTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}