{"files":[{"patch":"@@ -87,10 +87,0 @@\n-\n-        updateAccessibleName();\n-    }\n-\n-    protected void updateAccessibleName() {\n-        AccessibleContext ac = getAccessibleContext();\n-        if (ac != null && !comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n-            Component c = getRendererComponent();\n-            ac.setAccessibleName(c.getAccessibleContext().getAccessibleName());\n-        }\n@@ -201,1 +191,1 @@\n-    final Component getRendererComponent() {\n+    private Component getRendererComponent() {\n@@ -268,0 +258,22 @@\n+\n+    @Override\n+    public AccessibleContext getAccessibleContext() {\n+        if (accessibleContext == null) {\n+            accessibleContext = new AccessibleAquaComboBoxButton();\n+        }\n+        return accessibleContext;\n+    }\n+\n+    private final class AccessibleAquaComboBoxButton extends AccessibleJButton {\n+        @Override\n+        public String getAccessibleName() {\n+            String name = super.getAccessibleName();\n+            if (name == null || name.isEmpty()) {\n+                if (!comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n+                    Component c = getRendererComponent();\n+                    name = c.getAccessibleContext().getAccessibleName();\n+                }\n+            }\n+            return name;\n+        }\n+    }\n","filename":"src\/java.desktop\/macosx\/classes\/com\/apple\/laf\/AquaComboBoxButton.java","additions":23,"deletions":11,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -41,2 +41,0 @@\n-import java.beans.PropertyChangeEvent;\n-import java.beans.PropertyChangeListener;\n@@ -85,2 +83,0 @@\n-    private static final String RENDERER_PROPERTY = \"renderer\";\n-\n@@ -111,1 +107,0 @@\n-        comboBox.addPropertyChangeListener(RENDERER_PROPERTY, propertyRendererListener);\n@@ -117,1 +112,0 @@\n-        comboBox.removePropertyChangeListener(RENDERER_PROPERTY, propertyRendererListener);\n@@ -142,1 +136,0 @@\n-\n@@ -144,5 +137,0 @@\n-\n-                if (!comboBox.isEditable() && comboBox.getSelectedItem() != null) {\n-                    ((AquaComboBoxButton) arrowButton).updateAccessibleName();\n-                }\n-\n@@ -774,10 +762,0 @@\n-\n-    private final PropertyChangeListener propertyRendererListener =\n-            new PropertyChangeListener() {\n-                @Override\n-                public void propertyChange(final PropertyChangeEvent evt) {\n-                    if (RENDERER_PROPERTY.equals(evt.getPropertyName())) {\n-                        ((AquaComboBoxButton) arrowButton).updateAccessibleName();\n-                    }\n-                }\n-            };\n","filename":"src\/java.desktop\/macosx\/classes\/com\/apple\/laf\/AquaComboBoxUI.java","additions":0,"deletions":22,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -30,2 +30,2 @@\n- * @summary Verifies if JComboBox selected item magnifies using\n- * screen magnifier a11y tool.\n+ * @summary Verifies if item selected in JComboBox magnifies using\n+ *          screen magnifier a11y tool\n@@ -48,1 +48,1 @@\n-            \"1) Enable Screen magnifier on the Mac \\n\\n\" +\n+            \"1) Enable Screen magnifier on the Mac\\n\\n\" +\n@@ -51,3 +51,3 @@\n-            \"2) Move the mouse over the combobox selected item by pressing  \" +\n-                \"\\\"command\\\" button.\\n\\n\" +\n-            \"3) If magnified label is visible, Press Pass else Fail.\";\n+            \"2) Move the mouse over the combo box and press \" +\n+                \"\\\"Command\\\" button.\\n\\n\" +\n+            \"3) If magnified label is visible, press Pass else Fail.\";\n@@ -57,2 +57,8 @@\n-        PassFailJFrame passFailJFrame = new PassFailJFrame(\n-                \"JComboBox Screen Magnifier Test Instructions\", INSTRUCTIONS, 5, 12, 40);\n+        PassFailJFrame passFailJFrame = new PassFailJFrame.Builder()\n+                .title(\"JComboBox Screen Magnifier Test Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .testTimeOut(5)\n+                .rows(12)\n+                .columns(40)\n+                .screenCapture()\n+                .build();\n@@ -68,1 +74,1 @@\n-                \"Mango\", \"Pine Apple\", \"Banana\"};\n+                \"Mango\", \"Pineapple\", \"Banana\"};\n@@ -71,1 +77,1 @@\n-        JLabel fruitLabel = new JLabel(\"Fruits : \", JLabel.CENTER);\n+        JLabel fruitLabel = new JLabel(\"Fruits:\", JLabel.CENTER);\n@@ -75,1 +81,1 @@\n-        comboBox.getAccessibleContext().setAccessibleName(\"Fruit jCombobox\");\n+        comboBox.getAccessibleContext().setAccessibleName(\"Fruit Combo box\");\n@@ -81,1 +87,0 @@\n-        frame.setLocationRelativeTo(null);\n","filename":"test\/jdk\/javax\/accessibility\/JComboBox\/TestJComboBoxScreenMagnifier.java","additions":17,"deletions":12,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,1 +27,1 @@\n- * @bug 6567433\n+ * @bug 6567433 8283214\n@@ -62,1 +62,0 @@\n-        renderer = new DefaultListCellRenderer();\n@@ -64,0 +63,1 @@\n+        renderer = new DefaultListCellRenderer();\n","filename":"test\/jdk\/javax\/swing\/JComboBox\/6567433\/UpdateUIRecursionTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}