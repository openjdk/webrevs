{"files":[{"patch":"@@ -1297,1 +1297,4 @@\n-        print_oop_with_requested_addr_cr(&st, source_oop, false, true);\n+        \/\/ Don't print the requested addr again as we have just printed it at the beginning of the line.\n+        \/\/ Example:\n+        \/\/ 0x00000007ffd27938: @@ Object (0xfffa4f27) java.util.HashMap\n+        print_oop_addr_and_type_cr(&st, source_oop, \/*print_requested_addr=*\/false);\n@@ -1301,0 +1304,2 @@\n+        \/\/ Example:\n+        \/\/ 0x00000007ffc3ffd8: @@ Object filler 40 bytes\n@@ -1318,1 +1323,1 @@\n-  \/\/ in _source_obj with their requested addresses using print_oop_with_requested_addr_cr().\n+  \/\/ in _source_obj with their requested addresses using print_oop_addr_and_type_cr().\n@@ -1340,1 +1345,1 @@\n-          print_oop_with_requested_addr_cr(_st, obj);\n+          print_oop_addr_and_type_cr(_st, obj);\n@@ -1401,1 +1406,1 @@\n-          print_oop_with_requested_addr_cr(&st, obj);\n+          print_oop_addr_and_type_cr(&st, obj);\n@@ -1418,1 +1423,1 @@\n-            print_oop_with_requested_addr_cr(&st, rr);\n+            print_oop_addr_and_type_cr(&st, rr);\n@@ -1452,1 +1457,1 @@\n-        print_oop_with_requested_addr_cr(&st, HeapShared::pending_roots()->at(i));\n+        print_oop_addr_and_type_cr(&st, HeapShared::pending_roots()->at(i));\n@@ -1457,3 +1462,4 @@\n-  \/\/ The output looks like this. The first number is the requested address. The second number is\n-  \/\/ the narrowOop version of the requested address.\n-  \/\/     0x00000007ffc7e840 (0xfff8fd08) java.lang.Class\n+  \/\/ Example output:\n+  \/\/ - The first number is the requested address (if print_requested_addr == true)\n+  \/\/ - The second number is the narrowOop version of the requested address (if UseCompressedOops == true)\n+  \/\/     0x00000007ffc7e840 (0xfff8fd08) java.lang.Class Ljava\/util\/Array;\n@@ -1461,1 +1467,2 @@\n-  static void print_oop_with_requested_addr_cr(outputStream* st, oop source_oop, bool print_addr = true, bool print_aot_init = false) {\n+  static void print_oop_addr_and_type_cr(outputStream* st, oop source_oop,\n+                                         bool print_requested_addr = true) {\n@@ -1467,1 +1474,1 @@\n-      if (print_addr) {\n+      if (print_requested_addr) {\n@@ -1488,8 +1495,6 @@\n-          if (print_aot_init) {\n-            Klass* src_klass = java_lang_Class::as_Klass(scratch_mirror);\n-            if (src_klass != nullptr && src_klass->is_instance_klass()) {\n-              InstanceKlass* buffered_klass =\n-                ArchiveBuilder::current()->get_buffered_addr(InstanceKlass::cast(src_klass));\n-              if (buffered_klass->has_aot_initialized_mirror()) {\n-                st->print(\" (aot-inited)\");\n-              }\n+          Klass* src_klass = java_lang_Class::as_Klass(scratch_mirror);\n+          if (src_klass != nullptr && src_klass->is_instance_klass()) {\n+            InstanceKlass* buffered_klass =\n+              ArchiveBuilder::current()->get_buffered_addr(InstanceKlass::cast(src_klass));\n+            if (buffered_klass->has_aot_initialized_mirror()) {\n+              st->print(\" (aot-inited)\");\n","filename":"src\/hotspot\/share\/cds\/archiveBuilder.cpp","additions":24,"deletions":19,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n-0x00000000ffe00000: @@ Object (0xffe00000) java.lang.String\n+0x00000000ffe00000: @@ Object (0xffe00000) java.lang.String \"\"\n@@ -152,1 +152,1 @@\n-    static Pattern objPattern1 = Pattern.compile(\"^0x([0-9a-f]+): @@ Object (.*)\");\n+    static Pattern objPattern1 = Pattern.compile(\"^0x([0-9a-f]+): @@ Object ([^ ]*)\");\n@@ -156,1 +156,1 @@\n-    static Pattern objPattern2 = Pattern.compile(\"^0x([0-9a-f]+): @@ Object [(]0x([0-9a-f]+)[)] (.*)\");\n+    static Pattern objPattern2 = Pattern.compile(\"^0x([0-9a-f]+): @@ Object [(]0x([0-9a-f]+)[)] ([^ ]*)\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/CDSMapReader.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}