{"files":[{"patch":"@@ -182,9 +182,5 @@\n-  for (int d = 0; d < _files.length(); d++) {\n-    const MemoryFile* file = _files.at(d);\n-    for (int i = 0; i < mt_number_of_tags; i++) {\n-      VirtualMemory* snap = snapshot->by_type(NMTUtil::index_to_tag(i));\n-      const VirtualMemory* current = file->_summary.by_type(NMTUtil::index_to_tag(i));\n-      \/\/ Only account the committed memory.\n-      snap->commit_memory(current->committed());\n-    }\n-  }\n+  iterate_summary([&](MemTag tag, const VirtualMemory* current) {\n+    VirtualMemory* snap = snapshot->by_type(tag);\n+    \/\/ Only account the committed memory.\n+    snap->commit_memory(current->committed());\n+  });\n","filename":"src\/hotspot\/share\/nmt\/memoryFileTracker.cpp","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -42,0 +42,2 @@\n+\/\/ All memory is accounted as committed, there is no reserved memory.\n+\/\/ Any reserved memory is expected to exist in the VirtualMemoryTracker.\n@@ -75,0 +77,10 @@\n+  template<typename F>\n+  void iterate_summary(F f) const {\n+    for (int d = 0; d < _files.length(); d++) {\n+      const MemoryFile* file = _files.at(d);\n+      for (int i = 0; i < mt_number_of_tags; i++) {\n+        f(NMTUtil::index_to_tag(i), file->_summary.by_type(NMTUtil::index_to_tag(i)));\n+      }\n+    }\n+  }\n+\n@@ -102,0 +114,5 @@\n+    template<typename F>\n+    static void iterate_summary(F f) {\n+      _tracker->iterate_summary(f);\n+    };\n+\n","filename":"src\/hotspot\/share\/nmt\/memoryFileTracker.hpp","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"nmt\/memoryFileTracker.hpp\"\n@@ -93,0 +94,12 @@\n+\n+  { \/\/ MemoryFileTracker addition\n+    using MFT = MemoryFileTracker::Instance;\n+    MFT::Locker lock;\n+    MFT::iterate_summary([&](MemTag tag, const VirtualMemory* vm) {\n+      int i = NMTUtil::tag_to_index(tag);\n+      _vm_by_type[i].reserved += vm->reserved();\n+      _vm_by_type[i].committed += vm->committed();\n+      _vm_total.reserved += vm->reserved();\n+      _vm_total.committed += vm->committed();\n+    });\n+  }\n","filename":"src\/hotspot\/share\/nmt\/nmtUsage.cpp","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"nmt\/memTag.hpp\"\n","filename":"src\/hotspot\/share\/nmt\/nmtUsage.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -41,2 +41,0 @@\n-\n-jdk\/jfr\/event\/runtime\/TestNativeMemoryUsageEvents.java   8343893 generic-all\n","filename":"test\/jdk\/ProblemList-zgc.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}