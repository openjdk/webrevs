{"files":[{"patch":"@@ -105,1 +105,1 @@\n-                out.println(\"meth01: skipping results check for virtual thread\");\n+                out.println(\"meth02: skipping results check for virtual thread\");\n@@ -121,1 +121,1 @@\n-            out.println(\"meth01: skipping results check for virtual thread\");\n+            out.println(\"meth03: skipping results check for virtual thread\");\n@@ -134,1 +134,1 @@\n-            out.println(\"meth01: skipping results check for virtual thread\");\n+            out.println(\"meth04: skipping results check for virtual thread\");\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetLocalVariable\/setlocal001.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -47,0 +47,7 @@\n+static void check_error(jvmtiError err, bool is_virtual, const char* func_id) {\n+    if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n+        printf(\"(%s) unexpected error: %s (%d)\\n\", func_id, TranslateError(err), err);\n+        result = STATUS_FAILED;\n+    }\n+}\n+\n@@ -78,5 +85,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalLong) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalLong\");\n@@ -86,5 +89,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalFloat) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalFloat\");\n@@ -94,5 +93,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalDouble) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalDouble\");\n@@ -106,5 +101,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i1) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i1\");\n@@ -114,5 +105,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i2) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i2\");\n@@ -122,5 +109,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i3) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i3\");\n@@ -130,5 +113,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i4) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i4\");\n@@ -138,5 +117,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i5) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i5\");\n@@ -150,5 +125,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalObject#ob1) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalObject#ob1\");\n@@ -158,5 +129,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalObject#ob2) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalObject#ob2\");\n@@ -170,5 +137,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i1,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i1,param\");\n@@ -178,5 +141,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i2,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i2,param\");\n@@ -186,5 +145,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i3,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i3,param\");\n@@ -194,5 +149,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#i4,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#i4,param\");\n@@ -202,5 +153,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalInt#b,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalInt#b,param\");\n@@ -210,5 +157,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalLong,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalLong,param\");\n@@ -218,5 +161,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalFloat,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalFloat,param\");\n@@ -226,5 +165,1 @@\n-                if (err != JVMTI_ERROR_NONE && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                    printf(\"(SetLocalDouble,param) unexpected error: %s (%d)\\n\",\n-                           TranslateError(err), err);\n-                    result = STATUS_FAILED;\n-                }\n+                check_error(err, is_virtual, \"SetLocalDouble,param\");\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetLocalVariable\/setlocal001\/setlocal001.cpp","additions":25,"deletions":90,"binary":false,"changes":115,"status":"modified"},{"patch":"@@ -43,0 +43,9 @@\n+static void check_error(jvmtiError err, bool is_virtual, char* var_name) {\n+    if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n+        printf(\"(%s) \", var_name);\n+        printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n+        printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n+        result = STATUS_FAILED;\n+    }\n+}\n+\n@@ -75,0 +84,2 @@\n+        char* var_name = table[i].name;\n+\n@@ -78,6 +89,1 @@\n-            if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"(%s) \", table[i].name);\n-                printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n-                printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -87,6 +93,1 @@\n-            if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"(%s) \", table[i].name);\n-                printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n-                printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -96,6 +97,1 @@\n-            if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"(%s) \", table[i].name);\n-                printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n-                printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -105,6 +101,1 @@\n-            if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"(%s) \", table[i].name);\n-                printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n-                printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -114,6 +105,1 @@\n-            if (err != JVMTI_ERROR_INVALID_SLOT && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"(%s) \", table[i].name);\n-                printf(\"Error expected: JVMTI_ERROR_INVALID_SLOT or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n-                printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetLocalVariable\/setlocal003\/setlocal003.cpp","additions":16,"deletions":30,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -43,0 +43,9 @@\n+static void check_error(jvmtiError err, bool is_virtual, char* var_name) {\n+    if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n+        printf(\"(%s) \", var_name);\n+        printf(\"Error: expected: JVMTI_ERROR_TYPE_MISMATCH or JVMTI_ERROR_OPAQUE_FRAME,\\n\");\n+        printf(\"\\t    actual: %s (%d)\\n\", TranslateError(err), err);\n+        result = STATUS_FAILED;\n+    }\n+}\n+\n@@ -76,0 +85,2 @@\n+        char* var_name = table[i].name;\n+\n@@ -80,6 +91,1 @@\n-            if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"\\\"%s\\\" against SetLocalObject:\\n\", table[i].name);\n-                printf(\"    expected: JVMTI_ERROR_TYPE_MISMATCHi or JVMTI_ERROR_OPAQUE_FRAME,\");\n-                printf(\" actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -90,6 +96,1 @@\n-            if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"\\\"%s\\\" against SetLocalInt:\\n\", table[i].name);\n-                printf(\"    expected: JVMTI_ERROR_TYPE_MISMATCH or JVMTI_ERROR_OPAQUE_FRAME,\");\n-                printf(\" actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -100,6 +101,1 @@\n-            if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"\\\"%s\\\" against SetLocalLong:\\n\", table[i].name);\n-                printf(\"    expected: JVMTI_ERROR_TYPE_MISMATCH or JVMTI_ERROR_OPAQUE_FRAME,\");\n-                printf(\" actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -110,6 +106,1 @@\n-            if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"\\\"%s\\\" against SetLocalFloat:\\n\", table[i].name);\n-                printf(\"    expected: JVMTI_ERROR_TYPE_MISMATCH or JVMTI_ERROR_OPAQUE_FRAME,\");\n-                printf(\" actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n@@ -120,6 +111,1 @@\n-            if (err != JVMTI_ERROR_TYPE_MISMATCH && !(is_virtual && err == JVMTI_ERROR_OPAQUE_FRAME)) {\n-                printf(\"\\\"%s\\\" against SetLocalDouble:\\n\", table[i].name);\n-                printf(\"    expected: JVMTI_ERROR_TYPE_MISMATCH or JVMTI_ERROR_OPAQUE_FRAME,\");\n-                printf(\" actual: %s (%d)\\n\", TranslateError(err), err);\n-                result = STATUS_FAILED;\n-            }\n+            check_error(err, is_virtual, var_name);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetLocalVariable\/setlocal004\/setlocal004.cpp","additions":16,"deletions":30,"binary":false,"changes":46,"status":"modified"}]}