{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -76,0 +76,2 @@\n+    private Throwable printerAbortExcpn;\n+\n@@ -250,1 +252,1 @@\n-    private void completePrintLoop() {\n+    private void completePrintLoop(Throwable excpn)  {\n@@ -260,0 +262,2 @@\n+        printerAbortExcpn = excpn;\n+\n@@ -377,0 +381,3 @@\n+                    if (printerAbortExcpn != null) {\n+                        throw (PrinterAbortException) printerAbortExcpn;\n+                    }\n@@ -754,3 +761,2 @@\n-            try {\n-                LWCToolkit.invokeLater(new Runnable() { public void run() {\n-                    try {\n+            EventQueue.invokeLater(() -> {\n+                try {\n@@ -758,5 +764,4 @@\n-                    } catch (PrinterAbortException pae) {\n-                        \/\/ no-op, let the native side handle it\n-                    }\n-                }}, null);\n-            } catch (java.lang.reflect.InvocationTargetException ite) {}\n+                } catch (PrinterAbortException pae) {\n+                    \/\/ no-op, let the native side handle it\n+                }\n+            });\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/lwawt\/macosx\/CPrinterJob.java","additions":15,"deletions":10,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+static jclass sjc_PAbortEx = NULL;\n@@ -38,0 +39,1 @@\n+#define GET_PRINERABORTEXCEPTION_CLASS(ret) GET_CLASS_RETURN(sjc_PAbortEx, \"java\/awt\/print\/PrinterAbortException\", ret);\n@@ -263,1 +265,6 @@\n-    CHECK_EXCEPTION();\n+    if (b) {\n+        GET_PRINERABORTEXCEPTION_CLASS(b);\n+        (*env)->ThrowNew(env, sjc_PAbortEx, \"Printer Job cancelled\");\n+    } else {\n+        CHECK_EXCEPTION();\n+    }\n@@ -272,2 +279,7 @@\n-    DECLARE_METHOD(jf_completePrintLoop, sjc_CPrinterJob, \"completePrintLoop\", \"()V\");\n-    (*env)->CallVoidMethod(env, fPrinterJob, jf_completePrintLoop);\n+    jthrowable excpn = (*env)->ExceptionOccurred(env);\n+    if (excpn != NULL) {\n+        (*env)->ExceptionDescribe(env);\n+        (*env)->ExceptionClear(env);\n+    }\n+    DECLARE_METHOD(jf_completePrintLoop, sjc_CPrinterJob, \"completePrintLoop\", \"(Ljava\/lang\/Throwable;)V\");\n+    (*env)->CallVoidMethod(env, fPrinterJob, jf_completePrintLoop, excpn);\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/PrinterView.m","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @bug 4245280\n+ * @bug 4245280 8335231\n","filename":"test\/jdk\/java\/awt\/print\/PrinterJob\/Cancel\/PrinterJobCancel.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}