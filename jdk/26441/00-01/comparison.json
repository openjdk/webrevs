{"files":[{"patch":"@@ -44,3 +44,0 @@\n-#ifdef ASSERT\n-#include \"ci\/ciUtilities.inline.hpp\"\n-#endif\n@@ -475,0 +472,4 @@\n+  virtual ciMethod* callee_method() {\n+    return _callee;\n+  }\n+\n@@ -476,12 +477,1 @@\n-#ifdef ASSERT\n-    \/\/ Check that the callee hasn't changed between inline attempts (except with dynamic loading: then check dependencies)\n-    if (_callee != nullptr && _callee != m) {\n-      VM_ENTRY_MARK;\n-      Compile* C = Compile::current();\n-      Dependencies* deps = C->dependencies();\n-      MutexLocker ml(Compile_lock);\n-      deps->encode_content_bytes();\n-      assert(deps->validate_dependencies(C->env()->task()) != Dependencies::end_marker,\n-        \"repeated inline attempt with different callee\");\n-    }\n-#endif\n+    assert(_callee == nullptr || _callee == m, \"repeated inline attempt with different callee\");\n","filename":"src\/hotspot\/share\/opto\/callGenerator.cpp","additions":5,"deletions":15,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -91,0 +91,1 @@\n+  virtual ciMethod* callee_method() { ShouldNotReachHere(); }\n","filename":"src\/hotspot\/share\/opto\/callGenerator.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1239,2 +1239,14 @@\n-        \/\/ Register for late inlining.\n-        cg->set_callee_method(callee);\n+        ciMethod* old_callee = cg->callee_method();\n+        if (old_callee == nullptr || old_callee == callee) {\n+          \/\/ Register for late inlining.\n+          cg->set_callee_method(callee);\n+#ifdef ASSERT\n+        } else {\n+          \/\/ If callee has changed between inline attempts, check that it happens because of dynamic loading\n+          Dependencies* deps = phase->C->dependencies();\n+          MutexLocker ml(Compile_lock);\n+          deps->encode_content_bytes();\n+          assert(deps->validate_dependencies(phase->C->env()->task()) != Dependencies::end_marker,\n+          \"repeated inline attempt with different callee\");\n+#endif\n+        }\n","filename":"src\/hotspot\/share\/opto\/callnode.cpp","additions":14,"deletions":2,"binary":false,"changes":16,"status":"modified"}]}