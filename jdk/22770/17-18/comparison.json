{"files":[{"patch":"@@ -33,1 +33,1 @@\n-class AsyncLogWriter::Locker {\n+class AsyncLogWriter::Locker : public StackObj {\n@@ -110,1 +110,1 @@\n-  void* stalled_message_ptr = nullptr;\n+  void* stalled_message = nullptr;\n@@ -121,2 +121,2 @@\n-      stalled_message_ptr = os::malloc(size, mtLogging);\n-      if (stalled_message_ptr == nullptr) {\n+      stalled_message = os::malloc(size, mtLogging);\n+      if (stalled_message == nullptr) {\n@@ -127,2 +127,3 @@\n-      new (stalled_message_ptr) Message(output, decorations, msg, msg_len);\n-      _stalled_message = (Message*)stalled_message_ptr;\n+      new (stalled_message) Message(output, decorations, msg, msg_len);\n+      _stalled_message = (Message*)stalled_message;\n+      _data_available = true;\n@@ -139,1 +140,1 @@\n-  os::free(stalled_message_ptr);\n+  os::free(stalled_message);\n@@ -270,1 +271,1 @@\n-      while (!_data_available && _stalled_message == nullptr) {\n+      while (!_data_available) {\n@@ -293,0 +294,2 @@\n+    \/\/ Any stalled message must be written *after* the buffer has been written.\n+    \/\/ This is because we try hard to output messages in program-order.\n@@ -301,0 +304,1 @@\n+\n","filename":"src\/hotspot\/share\/logging\/logAsyncWriter.cpp","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"}]}