{"files":[{"patch":"@@ -44,1 +44,1 @@\n-  FreeNode* old_head = AtomicAccess::xchg(&_head, node);\n+  FreeNode* old_head = _head.exchange(node);\n@@ -51,1 +51,1 @@\n-  return AtomicAccess::add(&_count, size_t(1));\n+  return _count.add_then_fetch(1u);\n@@ -55,2 +55,2 @@\n-  NodeList result{AtomicAccess::load(&_head), _tail, AtomicAccess::load(&_count)};\n-  AtomicAccess::store(&_head, (FreeNode*)nullptr);\n+  NodeList result{_head.load_relaxed(), _tail, _count.load_relaxed()};\n+  _head.store_relaxed(nullptr);\n@@ -58,1 +58,1 @@\n-  AtomicAccess::store(&_count, size_t(0));\n+  _count.store_relaxed(0u);\n@@ -63,1 +63,1 @@\n-  return  AtomicAccess::load(&_count);\n+  return _count.load_relaxed();\n@@ -88,1 +88,1 @@\n-  uint index = AtomicAccess::load(&_active_pending_list);\n+  uint index = _active_pending_list.load_relaxed();\n@@ -96,1 +96,1 @@\n-  uint index = AtomicAccess::load(&_active_pending_list);\n+  uint index = _active_pending_list.load_relaxed();\n@@ -99,1 +99,1 @@\n-  _free_count = 0;\n+  _free_count.store_relaxed(0u);\n@@ -103,1 +103,1 @@\n-  return AtomicAccess::load(&_free_count);\n+  return _free_count.load_relaxed();\n@@ -107,1 +107,1 @@\n-  uint index = AtomicAccess::load(&_active_pending_list);\n+  uint index = _active_pending_list.load_relaxed();\n@@ -127,1 +127,1 @@\n-    size_t count = AtomicAccess::sub(&_free_count, 1u);\n+    size_t count = _free_count.sub_then_fetch(1u);\n@@ -152,1 +152,1 @@\n-    uint index = AtomicAccess::load_acquire(&_active_pending_list);\n+    uint index = _active_pending_list.load_acquire();\n@@ -167,2 +167,2 @@\n-  if (AtomicAccess::load(&_transfer_lock) || \/\/ Skip CAS if likely to fail.\n-      AtomicAccess::cmpxchg(&_transfer_lock, false, true)) {\n+  if (_transfer_lock.load_relaxed() || \/\/ Skip CAS if likely to fail.\n+      _transfer_lock.compare_exchange(false, true)) {\n@@ -175,1 +175,1 @@\n-  uint index = AtomicAccess::load(&_active_pending_list);\n+  uint index = _active_pending_list.load_relaxed();\n@@ -177,1 +177,1 @@\n-  AtomicAccess::release_store(&_active_pending_list, new_active);\n+  _active_pending_list.release_store(new_active);\n@@ -189,1 +189,1 @@\n-    AtomicAccess::add(&_free_count, count);\n+    _free_count.add_then_fetch(count);\n@@ -194,1 +194,1 @@\n-  AtomicAccess::release_store(&_transfer_lock, false);\n+  _transfer_lock.release_store(false);\n","filename":"src\/hotspot\/share\/gc\/shared\/freeListAllocator.cpp","additions":19,"deletions":19,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-#include \"runtime\/atomicAccess.hpp\"\n+#include \"runtime\/atomic.hpp\"\n@@ -65,1 +65,1 @@\n-    FreeNode* volatile _next;\n+    Atomic<FreeNode*> _next;\n@@ -69,1 +69,1 @@\n-    FreeNode* next() { return AtomicAccess::load(&_next); }\n+    FreeNode* next() { return _next.load_relaxed(); }\n@@ -71,1 +71,1 @@\n-    FreeNode* volatile* next_addr() { return &_next; }\n+    Atomic<FreeNode*>* next_addr() { return &_next; }\n@@ -73,1 +73,1 @@\n-    void set_next(FreeNode* next) { AtomicAccess::store(&_next, next); }\n+    void set_next(FreeNode* next) { _next.store_relaxed(next); }\n@@ -88,2 +88,2 @@\n-    FreeNode* volatile _head;\n-    volatile size_t _count;\n+    Atomic<FreeNode*> _head;\n+    Atomic<size_t> _count;\n@@ -108,2 +108,2 @@\n-  static FreeNode* volatile* next_ptr(FreeNode& node) { return node.next_addr(); }\n-  typedef LockFreeStack<FreeNode, &next_ptr> Stack;\n+  static Atomic<FreeNode*>* next_ptr(FreeNode& node) { return node.next_addr(); }\n+  using Stack = LockFreeStack<FreeNode, &next_ptr>;\n@@ -116,1 +116,1 @@\n-  DECLARE_PADDED_MEMBER(1, volatile size_t, _free_count);\n+  DECLARE_PADDED_MEMBER(1, Atomic<size_t>, _free_count);\n@@ -118,1 +118,1 @@\n-  DECLARE_PADDED_MEMBER(3, volatile bool, _transfer_lock);\n+  DECLARE_PADDED_MEMBER(3, Atomic<bool>, _transfer_lock);\n@@ -121,1 +121,1 @@\n-  volatile uint _active_pending_list;\n+  Atomic<uint> _active_pending_list;\n","filename":"src\/hotspot\/share\/gc\/shared\/freeListAllocator.hpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"}]}