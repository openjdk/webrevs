{"files":[{"patch":"@@ -684,1 +684,0 @@\n-  set_to_saved_mark_word();\n@@ -748,1 +747,0 @@\n-    set_eden_saved_mark_word();\n@@ -750,1 +748,0 @@\n-    set_from_saved_mark_word();\n@@ -907,3 +904,1 @@\n-  _eden_saved_mark_word = eden()->top();\n-  _from_saved_mark_word = from()->top();\n-  _to_saved_mark_word = to()->top();\n+  set_saved_mark_word();\n@@ -914,3 +909,1 @@\n-  assert(eden_saved_mark_at_top(), \"Violated spec - alloc in eden\");\n-  assert(from_saved_mark_at_top(), \"Violated spec - alloc in from\");\n-  return to_saved_mark_at_top();\n+  return saved_mark_at_top();\n","filename":"src\/hotspot\/share\/gc\/serial\/defNewGeneration.cpp","additions":2,"deletions":9,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -141,4 +141,3 @@\n-  \/\/ Saved mark word\n-  HeapWord* _eden_saved_mark_word;\n-  HeapWord* _from_saved_mark_word;\n-  HeapWord* _to_saved_mark_word;\n+\n+  \/\/ Saved mark word, for to-space\n+  HeapWord* _saved_mark_word;\n@@ -176,13 +175,3 @@\n-  HeapWord* eden_saved_mark_word() const    { return _eden_saved_mark_word; }\n-  HeapWord* from_saved_mark_word() const    { return _from_saved_mark_word; }\n-  HeapWord* to_saved_mark_word()   const    { return _to_saved_mark_word;   }\n-\n-  \/\/ Set saved mark word.\n-  void set_eden_saved_mark_word()           { _eden_saved_mark_word = eden()->top(); }\n-  void set_from_saved_mark_word()           { _from_saved_mark_word = from()->top(); }\n-  void set_to_saved_mark_word()             { _to_saved_mark_word   = to()->top();   }\n-\n-  \/\/ Verify saved mark word\n-  bool eden_saved_mark_at_top()             { return _eden_saved_mark_word == _eden_space->top(); }\n-  bool from_saved_mark_at_top()             { return _from_saved_mark_word == _from_space->top(); }\n-  bool to_saved_mark_at_top()               { return _to_saved_mark_word   == _to_space->top();   }\n+  HeapWord* saved_mark_word()   const    { return _saved_mark_word; }\n+  void set_saved_mark_word()             { _saved_mark_word = to()->top(); }\n+  bool saved_mark_at_top()               { return _saved_mark_word == _to_space->top(); }\n","filename":"src\/hotspot\/share\/gc\/serial\/defNewGeneration.hpp","additions":6,"deletions":17,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -39,5 +39,2 @@\n-  \/\/ No allocation in eden and from spaces, so no iteration required.\n-  assert(eden_saved_mark_at_top(), \"inv\");\n-  assert(from_saved_mark_at_top(), \"inv\");\n-\n-  Generation::oop_since_save_marks_iterate_impl(cl, to(), &_to_saved_mark_word);\n+  Generation::oop_since_save_marks_iterate_impl(cl, to(), _saved_mark_word);\n+  set_saved_mark_word();\n","filename":"src\/hotspot\/share\/gc\/serial\/defNewGeneration.inline.hpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -211,1 +211,1 @@\n-  void oop_since_save_marks_iterate_impl(OopClosureType* blk, ContiguousSpace* space, HeapWord** saved_mark_word);\n+  void oop_since_save_marks_iterate_impl(OopClosureType* blk, ContiguousSpace* space, HeapWord* saved_mark_word);\n@@ -215,1 +215,1 @@\n-void Generation::oop_since_save_marks_iterate_impl(OopClosureType* blk, ContiguousSpace* space, HeapWord** saved_mark_word) {\n+void Generation::oop_since_save_marks_iterate_impl(OopClosureType* blk, ContiguousSpace* space, HeapWord* saved_mark_word) {\n@@ -217,1 +217,1 @@\n-  HeapWord* p = *saved_mark_word;\n+  HeapWord* p = saved_mark_word;\n@@ -229,2 +229,0 @@\n-\n-  *saved_mark_word = space->top();\n","filename":"src\/hotspot\/share\/gc\/serial\/generation.hpp","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -307,1 +307,0 @@\n-  set_saved_mark_word();\n","filename":"src\/hotspot\/share\/gc\/serial\/tenuredGeneration.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -62,1 +62,2 @@\n-  Generation::oop_since_save_marks_iterate_impl(blk, _the_space, &_saved_mark_word);\n+  Generation::oop_since_save_marks_iterate_impl(blk, _the_space, _saved_mark_word);\n+  set_saved_mark_word();\n","filename":"src\/hotspot\/share\/gc\/serial\/tenuredGeneration.inline.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}