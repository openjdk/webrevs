{"files":[{"patch":"@@ -1059,6 +1059,1 @@\n-    Node* in1 = n->in(1);\n-    if (!in1->isa_Vector()) {\n-      break;\n-    }\n-    assert(n->as_Vector()->length() == in1->as_Vector()->length(), \"vector length must match\");\n-    n = in1;\n+    n = n->in(1);\n@@ -1492,1 +1487,2 @@\n-  if (in1->Opcode() == Op_VectorLoadMask && length() == in1->as_Vector()->length()) {\n+  if (in1->Opcode() == Op_VectorLoadMask) {\n+    assert(length() == in1->as_Vector()->length(), \"vector length must match\");\n","filename":"src\/hotspot\/share\/opto\/vectornode.cpp","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -41,0 +41,12 @@\n+    private static final VectorSpecies<Byte> B64 = ByteVector.SPECIES_64;\n+    private static final VectorSpecies<Short> S64 = ShortVector.SPECIES_64;\n+    private static final VectorSpecies<Short> S128 = ShortVector.SPECIES_128;\n+    private static final VectorSpecies<Integer> I64 = IntVector.SPECIES_64;\n+    private static final VectorSpecies<Integer> I128 = IntVector.SPECIES_128;\n+    private static final VectorSpecies<Integer> I256 = IntVector.SPECIES_256;\n+    private static final VectorSpecies<Long> L128 = LongVector.SPECIES_128;\n+    private static final VectorSpecies<Long> L256 = LongVector.SPECIES_256;\n+    private static final VectorSpecies<Float> F128 = FloatVector.SPECIES_128;\n+    private static final VectorSpecies<Float> F256 = FloatVector.SPECIES_256;\n+    private static final VectorSpecies<Double> D128 = DoubleVector.SPECIES_128;\n+    private static final VectorSpecies<Double> D256 = DoubleVector.SPECIES_256;\n@@ -93,2 +105,2 @@\n-        testOneCastKernel(ByteVector.SPECIES_64, ShortVector.SPECIES_128);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testOneCastKernel(B64, S128);\n+        verifyResult(B64.length());\n@@ -96,2 +108,2 @@\n-        testTwoCastsKernel(ByteVector.SPECIES_64, ShortVector.SPECIES_128, ByteVector.SPECIES_64);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testTwoCastsKernel(B64, S128, B64);\n+        verifyResult(B64.length());\n@@ -99,2 +111,2 @@\n-        testThreeCastsKernel(ByteVector.SPECIES_64, ShortVector.SPECIES_128, ByteVector.SPECIES_64, ShortVector.SPECIES_128);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testThreeCastsKernel(B64, S128, B64, S128);\n+        verifyResult(B64.length());\n@@ -110,2 +122,2 @@\n-        testOneCastKernel(ByteVector.SPECIES_64, IntVector.SPECIES_256);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testOneCastKernel(B64, I256);\n+        verifyResult(B64.length());\n@@ -113,2 +125,2 @@\n-        testTwoCastsKernel(ByteVector.SPECIES_64, ShortVector.SPECIES_128, IntVector.SPECIES_256);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testTwoCastsKernel(B64, S128, I256);\n+        verifyResult(B64.length());\n@@ -116,2 +128,2 @@\n-        testThreeCastsKernel(ByteVector.SPECIES_64, ShortVector.SPECIES_128, FloatVector.SPECIES_256, IntVector.SPECIES_256);\n-        verifyResult(ByteVector.SPECIES_64.length());\n+        testThreeCastsKernel(B64, S128, F256, I256);\n+        verifyResult(B64.length());\n@@ -127,2 +139,2 @@\n-        testOneCastKernel(ShortVector.SPECIES_128, ByteVector.SPECIES_64);\n-        verifyResult(ShortVector.SPECIES_128.length());\n+        testOneCastKernel(S128, B64);\n+        verifyResult(S128.length());\n@@ -130,2 +142,2 @@\n-        testTwoCastsKernel(ShortVector.SPECIES_64, IntVector.SPECIES_128, ShortVector.SPECIES_64);\n-        verifyResult(ShortVector.SPECIES_64.length());\n+        testTwoCastsKernel(S64, I128, S64);\n+        verifyResult(S64.length());\n@@ -133,2 +145,2 @@\n-        testThreeCastsKernel(ShortVector.SPECIES_128, ByteVector.SPECIES_64, ShortVector.SPECIES_128, ByteVector.SPECIES_64);\n-        verifyResult(ShortVector.SPECIES_128.length());\n+        testThreeCastsKernel(S128, B64, S128, B64);\n+        verifyResult(S128.length());\n@@ -144,2 +156,2 @@\n-        testOneCastKernel(ShortVector.SPECIES_128, IntVector.SPECIES_256);\n-        verifyResult(ShortVector.SPECIES_128.length());\n+        testOneCastKernel(S128, I256);\n+        verifyResult(S128.length());\n@@ -147,2 +159,2 @@\n-        testTwoCastsKernel(ShortVector.SPECIES_64, IntVector.SPECIES_128, LongVector.SPECIES_256);\n-        verifyResult(ShortVector.SPECIES_64.length());\n+        testTwoCastsKernel(S64, I128, L256);\n+        verifyResult(S64.length());\n@@ -150,2 +162,2 @@\n-        testThreeCastsKernel(ShortVector.SPECIES_128, ByteVector.SPECIES_64, FloatVector.SPECIES_256, IntVector.SPECIES_256);\n-        verifyResult(ShortVector.SPECIES_128.length());\n+        testThreeCastsKernel(S128, B64, F256, I256);\n+        verifyResult(S128.length());\n@@ -161,2 +173,2 @@\n-        testOneCastKernel(IntVector.SPECIES_MAX, FloatVector.SPECIES_MAX);\n-        verifyResult(IntVector.SPECIES_MAX.length());\n+        testOneCastKernel(I128, F128);\n+        verifyResult(I128.length());\n@@ -164,2 +176,2 @@\n-        testTwoCastsKernel(IntVector.SPECIES_128, ShortVector.SPECIES_64, FloatVector.SPECIES_128);\n-        verifyResult(IntVector.SPECIES_128.length());\n+        testTwoCastsKernel(I128, S64, F128);\n+        verifyResult(I128.length());\n@@ -167,2 +179,2 @@\n-        testThreeCastsKernel(IntVector.SPECIES_128, ShortVector.SPECIES_64, FloatVector.SPECIES_128, ShortVector.SPECIES_64);\n-        verifyResult(IntVector.SPECIES_128.length());\n+        testThreeCastsKernel(I128, S64, F128, S64);\n+        verifyResult(I128.length());\n@@ -178,2 +190,2 @@\n-        testOneCastKernel(IntVector.SPECIES_MAX, FloatVector.SPECIES_MAX);\n-        verifyResult(IntVector.SPECIES_MAX.length());\n+        testOneCastKernel(I128, F128);\n+        verifyResult(I128.length());\n@@ -181,2 +193,2 @@\n-        testTwoCastsKernel(IntVector.SPECIES_128, ShortVector.SPECIES_64, LongVector.SPECIES_256);\n-        verifyResult(IntVector.SPECIES_128.length());\n+        testTwoCastsKernel(I128, S64, L256);\n+        verifyResult(I128.length());\n@@ -184,2 +196,2 @@\n-        testThreeCastsKernel(IntVector.SPECIES_128, ShortVector.SPECIES_64, FloatVector.SPECIES_128, LongVector.SPECIES_256);\n-        verifyResult(IntVector.SPECIES_128.length());\n+        testThreeCastsKernel(I128, S64, F128, L256);\n+        verifyResult(I128.length());\n@@ -195,2 +207,2 @@\n-        testOneCastKernel(LongVector.SPECIES_MAX, DoubleVector.SPECIES_MAX);\n-        verifyResult(LongVector.SPECIES_MAX.length());\n+        testOneCastKernel(L128, D128);\n+        verifyResult(L128.length());\n@@ -198,2 +210,2 @@\n-        testTwoCastsKernel(LongVector.SPECIES_128, IntVector.SPECIES_64, DoubleVector.SPECIES_128);\n-        verifyResult(LongVector.SPECIES_128.length());\n+        testTwoCastsKernel(L128, I64, D128);\n+        verifyResult(L128.length());\n@@ -201,2 +213,2 @@\n-        testThreeCastsKernel(LongVector.SPECIES_128, IntVector.SPECIES_64, DoubleVector.SPECIES_128, IntVector.SPECIES_64);\n-        verifyResult(LongVector.SPECIES_128.length());\n+        testThreeCastsKernel(L128, I64, D128, I64);\n+        verifyResult(L128.length());\n@@ -212,2 +224,2 @@\n-        testOneCastKernel(LongVector.SPECIES_MAX, DoubleVector.SPECIES_MAX);\n-        verifyResult(LongVector.SPECIES_MAX.length());\n+        testOneCastKernel(L128, D128);\n+        verifyResult(L128.length());\n@@ -215,2 +227,2 @@\n-        testTwoCastsKernel(LongVector.SPECIES_256, IntVector.SPECIES_128, ShortVector.SPECIES_64);\n-        verifyResult(LongVector.SPECIES_256.length());\n+        testTwoCastsKernel(L256, I128, S64);\n+        verifyResult(L256.length());\n@@ -218,2 +230,2 @@\n-        testThreeCastsKernel(LongVector.SPECIES_256, IntVector.SPECIES_128, FloatVector.SPECIES_128, ShortVector.SPECIES_64);\n-        verifyResult(LongVector.SPECIES_256.length());\n+        testThreeCastsKernel(L256, I128, F128, S64);\n+        verifyResult(L256.length());\n@@ -229,2 +241,2 @@\n-        testOneCastKernel(FloatVector.SPECIES_MAX, IntVector.SPECIES_MAX);\n-        verifyResult(FloatVector.SPECIES_MAX.length());\n+        testOneCastKernel(F128, I128);\n+        verifyResult(F128.length());\n@@ -232,2 +244,2 @@\n-        testTwoCastsKernel(FloatVector.SPECIES_128, ShortVector.SPECIES_64, IntVector.SPECIES_128);\n-        verifyResult(FloatVector.SPECIES_128.length());\n+        testTwoCastsKernel(F128, S64, I128);\n+        verifyResult(F128.length());\n@@ -235,2 +247,2 @@\n-        testThreeCastsKernel(FloatVector.SPECIES_128, ShortVector.SPECIES_64, IntVector.SPECIES_128, ShortVector.SPECIES_64);\n-        verifyResult(FloatVector.SPECIES_128.length());\n+        testThreeCastsKernel(F128, S64, I128, S64);\n+        verifyResult(F128.length());\n@@ -246,2 +258,2 @@\n-        testOneCastKernel(FloatVector.SPECIES_MAX, IntVector.SPECIES_MAX);\n-        verifyResult(FloatVector.SPECIES_MAX.length());\n+        testOneCastKernel(F128, I128);\n+        verifyResult(F128.length());\n@@ -249,2 +261,2 @@\n-        testTwoCastsKernel(FloatVector.SPECIES_128, ShortVector.SPECIES_64, LongVector.SPECIES_256);\n-        verifyResult(FloatVector.SPECIES_128.length());\n+        testTwoCastsKernel(F128, S64, L256);\n+        verifyResult(F128.length());\n@@ -252,2 +264,2 @@\n-        testThreeCastsKernel(FloatVector.SPECIES_128, ShortVector.SPECIES_64, IntVector.SPECIES_128, LongVector.SPECIES_256);\n-        verifyResult(FloatVector.SPECIES_128.length());\n+        testThreeCastsKernel(F128, S64, I128, L256);\n+        verifyResult(F128.length());\n@@ -263,2 +275,2 @@\n-        testOneCastKernel(DoubleVector.SPECIES_MAX, LongVector.SPECIES_MAX);\n-        verifyResult(DoubleVector.SPECIES_MAX.length());\n+        testOneCastKernel(D128, L128);\n+        verifyResult(D128.length());\n@@ -266,2 +278,2 @@\n-        testTwoCastsKernel(DoubleVector.SPECIES_128, IntVector.SPECIES_64, LongVector.SPECIES_128);\n-        verifyResult(DoubleVector.SPECIES_128.length());\n+        testTwoCastsKernel(D128, I64, L128);\n+        verifyResult(D128.length());\n@@ -269,2 +281,2 @@\n-        testThreeCastsKernel(DoubleVector.SPECIES_128, IntVector.SPECIES_64, LongVector.SPECIES_128, IntVector.SPECIES_64);\n-        verifyResult(DoubleVector.SPECIES_128.length());\n+        testThreeCastsKernel(D128, I64, L128, I64);\n+        verifyResult(D128.length());\n@@ -280,2 +292,2 @@\n-        testOneCastKernel(DoubleVector.SPECIES_MAX, LongVector.SPECIES_MAX);\n-        verifyResult(DoubleVector.SPECIES_MAX.length());\n+        testOneCastKernel(D128, L128);\n+        verifyResult(D128.length());\n@@ -283,2 +295,2 @@\n-        testTwoCastsKernel(DoubleVector.SPECIES_256, ShortVector.SPECIES_64, IntVector.SPECIES_128);\n-        verifyResult(DoubleVector.SPECIES_256.length());\n+        testTwoCastsKernel(D256, S64, I128);\n+        verifyResult(D256.length());\n@@ -286,2 +298,2 @@\n-        testThreeCastsKernel(DoubleVector.SPECIES_256, ShortVector.SPECIES_64, LongVector.SPECIES_256, IntVector.SPECIES_128);\n-        verifyResult(DoubleVector.SPECIES_256.length());\n+        testThreeCastsKernel(D256, S64, L256, I128);\n+        verifyResult(D256.length());\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/VectorStoreMaskIdentityTest.java","additions":84,"deletions":72,"binary":false,"changes":156,"status":"modified"}]}