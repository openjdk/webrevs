{"files":[{"patch":"@@ -30,1 +30,0 @@\n-import sun.security.util.KnownOIDs;\n@@ -167,1 +166,4 @@\n-        tmp0.write(new AlgorithmId(prf));\n+        \/\/ HmacSHA1 is the default and must not be encoded.\n+        if (!prf.equals(ObjectIdentifier.of(KnownOIDs.HmacSHA1))) {\n+            tmp0.write(new AlgorithmId(prf));\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/PBKDF2Parameters.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8286069\n+ * @bug 8286069 8371156\n@@ -95,1 +95,1 @@\n-        \/\/ 003D:000A  [10130]                     OID 1.2.840.113549.2.7 (HmacSHA1)\n+        \/\/ 003D:000A  [10130]                     OID 1.2.840.113549.2.9 (HmacSHA256)\n@@ -103,1 +103,5 @@\n-            DerUtils.checkAlg(data, \"110c010c01010c010130\", oids[1]);\n+            if (oids[1] == KnownOIDs.HmacSHA1) {\n+                DerUtils.shouldNotExist(data, \"110c010c01010c010130\");\n+            } else {\n+                DerUtils.checkAlg(data, \"110c010c01010c010130\", oids[1]);\n+            }\n","filename":"test\/jdk\/sun\/security\/pkcs12\/ImportPassKeyAlg.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -119,0 +119,10 @@\n+\n+        \/\/ Verify that DEFAULT HmacSHA1 prf does not get encoded.\n+        System.setProperty(\"keystore.pkcs12.macAlgorithm\", \"PBEWITHHMACSHA1\");\n+        der = emptyP12();\n+        DerUtils.checkAlg(der, \"2000\", KnownOIDs.PBMAC1);\n+        DerUtils.checkAlg(der, \"200100\", KnownOIDs.PBKDF2);\n+        DerUtils.shouldNotExist(der, \"20010130\");\n+        DerUtils.checkAlg(der, \"200110\", KnownOIDs.HmacSHA1);\n+        DerUtils.checkInt(der, \"2001011\", 10000);\n+        DerUtils.checkInt(der, \"2001012\", 20);\n","filename":"test\/jdk\/sun\/security\/pkcs12\/PBMAC1Test.java","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"}]}