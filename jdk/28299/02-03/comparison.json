{"files":[{"patch":"@@ -7176,0 +7176,1 @@\n+  bool is_decrypt = false;\n@@ -7186,0 +7187,1 @@\n+    is_decrypt = true;\n@@ -7219,1 +7221,1 @@\n-  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object);\n+  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object, is_decrypt);\n@@ -7234,1 +7236,1 @@\n-\n+  bool is_decrypt= false;\n@@ -7245,0 +7247,1 @@\n+    is_decrypt = true;\n@@ -7298,1 +7301,1 @@\n-  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object);\n+  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object, is_decrypt);\n@@ -7322,1 +7325,1 @@\n-\n+  bool is_decrypt = false;\n@@ -7333,0 +7336,1 @@\n+    is_decrypt = true;\n@@ -7384,1 +7388,1 @@\n-  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object);\n+  Node* k_start = get_key_start_from_aescrypt_object(aescrypt_object, is_decrypt);\n@@ -7477,1 +7481,1 @@\n-Node* LibraryCallKit::get_key_start_from_aescrypt_object(Node* aescrypt_object) {\n+Node* LibraryCallKit::get_key_start_from_aescrypt_object(Node* aescrypt_object, bool is_decrypt) {\n@@ -7483,1 +7487,1 @@\n-  const char* key_name = \"sessionKe\";\n+  bool use_decryption_key = false;\n@@ -7485,1 +7489,1 @@\n-  const char* key_name = \"K\";\n+  bool use_decryption_key = is_decrypt;\n@@ -7487,1 +7491,1 @@\n-  Node* objAESCryptKey = load_field_from_object(aescrypt_object, key_name, \"[I\");\n+  Node* objAESCryptKey = load_field_from_object(aescrypt_object, use_decryption_key ? \"sessionKd\" : \"sessionKe\", \"[I\");\n","filename":"src\/hotspot\/share\/opto\/library_call.cpp","additions":13,"deletions":9,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -341,1 +341,1 @@\n-  Node* get_key_start_from_aescrypt_object(Node* aescrypt_object);\n+  Node* get_key_start_from_aescrypt_object(Node* aescrypt_object, bool is_decrypt = false);\n","filename":"src\/hotspot\/share\/opto\/library_call.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -57,3 +57,3 @@\n-    \/\/ Following attributes (sessionKe and K) are specific to Intrinsics, where\n-    \/\/ sessionKe is the unprocessed key that is used for PPC64, S390 and\n-    \/\/ RISCV64 architectures, whereas K is used for everything else.\n+    \/\/ Following attributes are specific to Intrinsics, where sessionKe is the\n+    \/\/ unprocessed key that is also used for decryption on PPC64, S390 and\n+    \/\/ RISCV64 architectures. Other ones use sessionKd for decryption.\n@@ -62,1 +62,0 @@\n-    private int[] K = null; \/\/ preprocessed key in case of decryption\n@@ -943,3 +942,0 @@\n-            K = sessionKd;\n-        } else {\n-            K = sessionKe;\n@@ -1047,0 +1043,1 @@\n+        int[] K = sessionKe;\n@@ -1225,0 +1222,1 @@\n+        int[] K = sessionKd;\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AES_Crypt.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"}]}