{"files":[{"patch":"@@ -4952,4 +4952,6 @@\n-\/\/ Mark locking regions (identified by BoxLockNode) as coarsened\n-\/\/ if locks coarsening optimization removed lock\/unlock from them.\n-\/\/ Such regions become unbalanced and we can't execute other\n-\/\/ locks elimination optimization on them.\n+\/\/ Mark locking regions (identified by BoxLockNode) as unbalanced if\n+\/\/ locks coarsening optimization removed Lock\/Unlock nodes from them.\n+\/\/ Such regions become unbalanced because coarsening only removes part\n+\/\/ of Lock\/Unlock nodes in region. As result we can't execute other\n+\/\/ locks elimination optimizations which assume all code paths have\n+\/\/ corresponding pair of Lock\/Unlock nodes - they are balanced.\n@@ -4964,1 +4966,3 @@\n-      if (alock->is_coarsened() && !box->is_unbalanced()) { \/\/ Not marked already\n+      if (alock->is_coarsened()) {\n+        \/\/ coarsened_locks_consistent(), which is called before this method, verifies\n+        \/\/ that the rest of Lock\/Unlock nodes on locks_list are also coarsened.\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"}]}