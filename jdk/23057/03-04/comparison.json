{"files":[{"patch":"@@ -4168,14 +4168,14 @@\n-\/\/          entry  0\n-\/\/                 |\n-\/\/                 v\n-\/\/ outer 1,2    +->1\n-\/\/              |  |\n-\/\/              |  v\n-\/\/              |  2<---+  ncsfpt in 2\n-\/\/              |_\/|\\   |\n-\/\/                 | v  |\n-\/\/ inner 2,3      \/  3  |  call in 3\n-\/\/               \/   |  |\n-\/\/              v    +--+\n-\/\/        exit  4\n-\/\/\n+\/\/             entry  0\n+\/\/                    |\n+\/\/                    v\n+\/\/   outer 1,2,4  +-> 1\n+\/\/                |    \\\n+\/\/                |     v\n+\/\/    inner 2,3   |     2 <---+  ncsfpt in 2\n+\/\/                |    \/ \\    |\n+\/\/                |   v   v   |\n+\/\/                |  4     3  |  call in 3\n+\/\/                |_\/ \\     \\_|\n+\/\/                     |\n+\/\/                     v\n+\/\/               exit  5\n@@ -4192,2 +4192,5 @@\n-\/\/  A) Counted loops are okay\n-\/\/  B) Innermost loops are okay because there's no inner loops can delete\n+\/\/  A) Counted loops are okay (i.e. do not need to preserve ncsfpts),\n+\/\/     because they will only execute for a short time\n+\/\/  B) Innermost loops are okay because there's no inner loops that can\n+\/\/     delete their ncsfpts. Only outer loops need to mark safepoints for\n+\/\/     protection, because only loops further in can accidentally delete\n","filename":"src\/hotspot\/share\/opto\/loopnode.cpp","additions":19,"deletions":16,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -24,1 +24,1 @@\n-package compiler.c2.irTests;\n+package compiler.loopopts;\n@@ -33,2 +33,1 @@\n- * @requires vm.compiler2.enabled\n- * @run main compiler.c2.irTests.TestLoopSafepoint\n+ * @run main compiler.loopopts.TestRedundantSafepointElimination\n@@ -36,1 +35,1 @@\n-public class TestLoopSafepoint {\n+public class TestRedundantSafepointElimination {\n","filename":"test\/hotspot\/jtreg\/compiler\/loopopts\/TestRedundantSafepointElimination.java","additions":3,"deletions":4,"binary":false,"changes":7,"previous_filename":"test\/hotspot\/jtreg\/compiler\/c2\/irTests\/TestLoopSafepoint.java","status":"renamed"}]}