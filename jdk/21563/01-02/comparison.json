{"files":[{"patch":"@@ -85,1 +85,3 @@\n-        DHParameterSpec ffhde2048ParamSpec;\n+        DHParameterSpec dhParameterSpec;\n+        String algorithm = \"DH\";\n+        int primeSize = SecurityUtils.getTestKeySize(algorithm);\n@@ -92,1 +94,1 @@\n-            paramGen.init(2048);\n+            paramGen.init(primeSize);\n@@ -94,1 +96,1 @@\n-            ffhde2048ParamSpec = (DHParameterSpec)params.getParameterSpec\n+            dhParameterSpec = (DHParameterSpec)params.getParameterSpec\n@@ -98,1 +100,1 @@\n-            DiffieHellmanGroup dhGroup = SecurityUtils.getTestDHGroup();\n+            DiffieHellmanGroup dhGroup = SecurityUtils.getTestDHGroup(primeSize);\n@@ -100,1 +102,1 @@\n-            ffhde2048ParamSpec = new DHParameterSpec(dhGroup.getModulus(),\n+            dhParameterSpec = new DHParameterSpec(dhGroup.getModulus(),\n@@ -110,1 +112,1 @@\n-        aliceKpairGen.initialize(ffhde2048ParamSpec);\n+        aliceKpairGen.initialize(dhParameterSpec);\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/KeyAgreement\/DHKeyAgreement2.java","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"}]}