{"files":[{"patch":"@@ -39,1 +39,1 @@\n- * @LastModified: May 2021\n+ * @LastModified: Nov 2021\n@@ -313,0 +313,34 @@\n+\n+    @Override\n+    public void setProperty(String name, String value) {\n+        \/\/ property name cannot be null\n+        if (name == null) {\n+            String fmsg = XSLMessages.createXPATHMessage(\n+                    XPATHErrorResources.ER_PROPERTY_NAME_NULL,\n+                    new Object[] {CLASS_NAME,  value} );\n+            throw new NullPointerException(fmsg);\n+         }\n+\n+        \/\/ property name not recognized\n+        String fmsg = XSLMessages.createXPATHMessage(\n+                XPATHErrorResources.ER_PROPERTY_UNKNOWN,\n+                new Object[] {name, CLASS_NAME, value} );\n+        throw new IllegalArgumentException(fmsg);\n+    }\n+\n+    @Override\n+    public String getProperty(String name) {\n+        \/\/ property name cannot be null\n+        if (name == null) {\n+            String fmsg = XSLMessages.createXPATHMessage(\n+                    XPATHErrorResources.ER_GETTING_NULL_PROPERTY,\n+                    new Object[] {CLASS_NAME} );\n+            throw new NullPointerException(fmsg);\n+        }\n+\n+        \/\/ unknown property\n+        String fmsg = XSLMessages.createXPATHMessage(\n+                XPATHErrorResources.ER_GETTING_UNKNOWN_PROPERTY,\n+                new Object[] {name, CLASS_NAME} );\n+        throw new IllegalArgumentException(fmsg);\n+    }\n","filename":"src\/java.xml\/share\/classes\/com\/sun\/org\/apache\/xpath\/internal\/jaxp\/XPathFactoryImpl.java","additions":35,"deletions":1,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,1 @@\n- * @LastModified: May 2019\n+ * @LastModified: Nov 2021\n@@ -325,0 +325,4 @@\n+  public static final String ER_PROPERTY_NAME_NULL = \"ER_PROPERTY_NAME_NULL\";\n+  public static final String ER_PROPERTY_UNKNOWN = \"ER_PROPERTY_UNKNOWN\";\n+  public static final String ER_GETTING_NULL_PROPERTY = \"ER_GETTING_NULL_PROPERTY\";\n+  public static final String ER_GETTING_UNKNOWN_PROPERTY = \"ER_GETTING_UNKNOWN_PROPERTY\";\n@@ -839,0 +843,20 @@\n+  \/** Field ER_PROPERTY_NAME_NULL                       *\/\n+\n+  { ER_PROPERTY_NAME_NULL,\n+       \"Trying to set a property with a null name: {0}#setProperty( null, {1})\"},\n+\n+  \/** Field ER_PROPERTY_UNKNOWN                       *\/\n+\n+  { ER_PROPERTY_UNKNOWN,\n+       \"Trying to set the unknown property \\\"{0}\\\":{1}#setProperty({0},{2})\"},\n+\n+  \/** Field ER_GETTING_NULL_PROPERTY                       *\/\n+\n+  { ER_GETTING_NULL_PROPERTY,\n+       \"Trying to get a property with a null name: {0}#getProperty(null)\"},\n+\n+  \/** Field ER_GETTING_NULL_PROPERTY                       *\/\n+\n+  { ER_GETTING_UNKNOWN_PROPERTY,\n+       \"Trying to get the unknown property \\\"{0}\\\":{1}#getProperty({0})\"},\n+\n","filename":"src\/java.xml\/share\/classes\/com\/sun\/org\/apache\/xpath\/internal\/res\/XPATHErrorResources.java","additions":26,"deletions":2,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -278,2 +278,3 @@\n-     * <p>Set a feature for this {@code XPathFactory} and\n-     * <code>XPath<\/code>s created by this factory.<\/p>\n+     * Sets a feature for this {@code XPathFactory}. The feature applies to\n+     * {@code XPath} objects that the {@code XPathFactory} creates. It has no\n+     * impact on {@code XPath} objects that are already created.\n@@ -372,0 +373,56 @@\n+\n+    \/**\n+     * Sets a property for this {@code XPathFactory}. The property applies to\n+     * {@code XPath} objects that the {@code XPathFactory} creates. It has no\n+     * impact on {@code XPath} objects that are already created.\n+     * <p>\n+     * A property can either be defined in this {@code XPathFactory}, or by the\n+     * underlying implementation.\n+     *\n+     * @implSpec\n+     * The default implementation throws\n+     * {@link java.lang.UnsupportedOperationException}.\n+     *\n+     * @param name the property name\n+     * @param value the value for the property\n+     *\n+     * @throws IllegalArgumentException if the property name is not recognized,\n+     * or the value can not be assigned\n+     * @throws UnsupportedOperationException if the implementation does not\n+     * support the method\n+     * @throws NullPointerException if the {@code name} is {@code null}\n+     *\n+     * @since 18\n+     *\/\n+    public void setProperty(String name, String value) {\n+\n+        if (name == null) {\n+            throw new NullPointerException(\"the name parameter is null\");\n+        }\n+        throw new UnsupportedOperationException(\"not implemented\");\n+    }\n+\n+    \/**\n+     * Returns the value of the specified property.\n+     *\n+     * @implSpec\n+     * The default implementation throws\n+     * {@link java.lang.UnsupportedOperationException}.\n+     *\n+     * @param name the property name\n+     * @return the value of the property.\n+     *\n+     * @throws IllegalArgumentException if the property name is not recognized\n+     * @throws UnsupportedOperationException if the implementation does not\n+     * support the method\n+     * @throws NullPointerException if the {@code name} is {@code null}\n+     *\n+     * @since 18\n+     *\/\n+    public String getProperty(String name) {\n+\n+        if (name == null) {\n+            throw new NullPointerException(\"the name parameter is null\");\n+        }\n+        throw new UnsupportedOperationException(\"not implemented\");\n+    }\n","filename":"src\/java.xml\/share\/classes\/javax\/xml\/xpath\/XPathFactory.java","additions":59,"deletions":2,"binary":false,"changes":61,"status":"modified"},{"patch":"@@ -0,0 +1,74 @@\n+\/*\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package xpath;\n+\n+import javax.xml.xpath.XPath;\n+import javax.xml.xpath.XPathFactory;\n+import javax.xml.xpath.XPathFactoryConfigurationException;\n+import javax.xml.xpath.XPathFunctionResolver;\n+import javax.xml.xpath.XPathVariableResolver;\n+\n+\/**\n+ * A dummy implementation of the XPathFactory without implementing\n+ * the setProperty\/getProperty methods\n+ *\/\n+public class XPathFactoryDummyImpl extends XPathFactory {\n+\n+    @Override\n+        public boolean isObjectModelSupported(String objectModel) {\n+            \/\/ support the default object model, W3C DOM\n+            if (objectModel.equals(XPathFactory.DEFAULT_OBJECT_MODEL_URI)) {\n+                return true;\n+            }\n+\n+            \/\/ no support\n+            return false;\n+        }\n+\n+\n+    @Override\n+    public void setFeature(String name, boolean value) throws XPathFactoryConfigurationException {\n+        throw new UnsupportedOperationException(\"Not supported yet.\");\n+    }\n+\n+    @Override\n+    public boolean getFeature(String name) throws XPathFactoryConfigurationException {\n+        throw new UnsupportedOperationException(\"Not supported yet.\");\n+    }\n+\n+    @Override\n+    public void setXPathVariableResolver(XPathVariableResolver resolver) {\n+        throw new UnsupportedOperationException(\"Not supported yet.\");\n+    }\n+\n+    @Override\n+    public void setXPathFunctionResolver(XPathFunctionResolver resolver) {\n+        throw new UnsupportedOperationException(\"Not supported yet.\");\n+    }\n+\n+    @Override\n+    public XPath newXPath() {\n+        throw new UnsupportedOperationException(\"Not supported yet.\");\n+    }\n+\n+}\n","filename":"test\/jaxp\/javax\/xml\/jaxp\/unittest\/xpath\/XPathFactoryDummyImpl.java","additions":74,"deletions":0,"binary":false,"changes":74,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import org.testng.Assert;\n@@ -34,1 +35,0 @@\n-import org.testng.annotations.Listeners;\n@@ -41,3 +41,2 @@\n- * @bug 6376058\n- * @library \/javax\/xml\/jaxp\/libs \/javax\/xml\/jaxp\/unittest\n- * @run testng\/othervm -DrunSecMngr=true -Djava.security.manager=allow xpath.XPathTest\n+ * @bug 6376058 8276141\n+ * @build xpath.XPathTest xpath.XPathFactoryDummyImpl\n@@ -47,1 +46,0 @@\n-@Listeners({jaxp.library.BasePolicy.class})\n@@ -49,0 +47,57 @@\n+    \/*\n+     * DataProvider for testXPathFactory\n+     *\/\n+    @DataProvider(name = \"xpath\")\n+    public Object[][] getXPathFactory() throws Exception {\n+        return new Object[][]{\n+            {null},\n+            {\"xpath.XPathFactoryDummyImpl\"},\n+        };\n+    }\n+\n+    \/*\n+     * @bug 8276141\n+     * Tests the setProperty\/getProperty method for the XPathFactory.\n+    *\/\n+    @Test(dataProvider = \"xpath\")\n+    public void testXPathFactory(String factoryName)\n+            throws Exception {\n+\n+        XPathFactory xpf;\n+        if (factoryName == null) {\n+            xpf = XPathFactory.newInstance();\n+        } else {\n+            xpf = XPathFactory.newInstance(\n+                XPathFactory.DEFAULT_OBJECT_MODEL_URI, factoryName, null);\n+        }\n+\n+        \/\/ NPE\n+        Assert.assertThrows(NullPointerException.class,\n+                () -> setProperty(xpf, null, \"value\"));\n+        Assert.assertThrows(NullPointerException.class,\n+                () -> getProperty(xpf, null));\n+\n+        if (factoryName == null) {\n+            \/\/ default factory impl\n+            Assert.assertThrows(IllegalArgumentException.class,\n+                    () -> setProperty(xpf, \"unknown\", \"value\"));\n+            Assert.assertThrows(IllegalArgumentException.class,\n+                    () -> getProperty(xpf, \"unknown\"));\n+        } else {\n+            \/\/ the DummyImpl does not implement the method\n+            Assert.assertThrows(UnsupportedOperationException.class,\n+                    () -> setProperty(xpf, \"unknown\", \"value\"));\n+            Assert.assertThrows(UnsupportedOperationException.class,\n+                    () -> getProperty(xpf, \"unknown\"));\n+        }\n+    }\n+\n+    private void setProperty(XPathFactory xpf, String name, String value)\n+            throws Exception {\n+        xpf.setProperty(name, value);\n+    }\n+\n+    private void getProperty(XPathFactory xpf, String name)\n+            throws Exception {\n+        xpf.getProperty(name);\n+    }\n","filename":"test\/jaxp\/javax\/xml\/jaxp\/unittest\/xpath\/XPathTest.java","additions":61,"deletions":6,"binary":false,"changes":67,"status":"modified"}]}