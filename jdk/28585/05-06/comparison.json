{"files":[{"patch":"@@ -125,2 +125,19 @@\n-                            MethodHandle mh = ad.adaptedMethodHandle(handle);\n-                            <RETURN>mh.invokeBasic(<LINK_TO_INVOKER_ARGS>);\n+                            MethodHandle mh = handle.getMethodHandle(ad.mode);\n+                            <RETURN>mh.asType(ad.symbolicMethodTypeInvoker).invokeBasic(<LINK_TO_INVOKER_ARGS>);\n+                        }\n+                    }\"\"\";\n+\n+    static final String GUARD_METHOD_TEMPLATE_V =\n+            \"\"\"\n+                    @ForceInline\n+                    @LambdaForm.Compiled\n+                    @Hidden\n+                    static final <METHOD> throws Throwable {\n+                        boolean direct = handle.checkAccessModeThenIsDirect(ad);\n+                        if (direct && handle.vform.methodType_table[ad.type] == ad.symbolicMethodTypeErased) {\n+                            MethodHandle.linkToStatic(<LINK_TO_STATIC_ARGS>);\n+                        } else if (direct && handle.vform.getMethodType_V(ad.type) == ad.symbolicMethodTypeErased) {\n+                            MethodHandle.linkToStatic(<LINK_TO_STATIC_ARGS>);\n+                        } else {\n+                            MethodHandle mh = handle.getMethodHandle(ad.mode);\n+                            mh.asType(ad.symbolicMethodTypeInvoker).invokeBasic(<LINK_TO_INVOKER_ARGS>);\n@@ -266,1 +283,4 @@\n-        return GUARD_METHOD_TEMPLATE.\n+        String template = returnType == void.class\n+                ? GUARD_METHOD_TEMPLATE_V\n+                : GUARD_METHOD_TEMPLATE;\n+        return template.\n","filename":"make\/jdk\/src\/classes\/build\/tools\/methodhandle\/VarHandleGuardMethodGenerator.java","additions":23,"deletions":3,"binary":false,"changes":26,"status":"modified"}]}