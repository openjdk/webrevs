{"files":[{"patch":"@@ -32,0 +32,1 @@\n+#include \"memory\/metaspace.hpp\"\n@@ -76,3 +77,2 @@\n-static bool can_compress_element(const Klass* klass) {\n-  return CompressedKlassPointers::is_encodable(klass) &&\n-         JfrTraceId::load_raw(klass) < uncompressed_threshold;\n+static bool can_compress_element(traceid id) {\n+  return Metaspace::using_class_space() && id < uncompressed_threshold;\n@@ -83,1 +83,1 @@\n-  return element_size(can_compress_element(klass));\n+  return element_size(can_compress_element(JfrTraceId::load_raw(klass)));\n@@ -139,2 +139,1 @@\n-  assert(can_compress_element(klass), \"invariant\");\n-  assert(id == JfrTraceId::load_raw(klass), \"invariant\");\n+  assert(can_compress_element(id), \"invariant\");\n@@ -156,1 +155,1 @@\n-  if (can_compress_element(klass)) {\n+  if (can_compress_element(id)) {\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/traceid\/jfrTraceIdKlassQueue.cpp","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"}]}