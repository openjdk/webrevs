{"files":[{"patch":"@@ -2768,1 +2768,1 @@\n-   if (hr->is_humongous()) {\n+  if (hr->is_humongous()) {\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -174,0 +174,1 @@\n+    hr->prepare_for_full_gc();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -177,0 +177,1 @@\n+  void prepare_for_full_gc();\n@@ -232,5 +233,11 @@\n-  \/\/ is equal to bottom except from Remark and until the region has been\n-  \/\/ scrubbed concurrently. The scrubbing ensures that all dead objects (with\n-  \/\/ possibly unloaded classes) have beenreplaced with filler objects that\n-  \/\/ are parsable. Below this limit the marking bitmap must be used to\n-  \/\/ determine size and liveness.\n+  \/\/ is equal to bottom except\n+  \/\/\n+  \/\/ * from Remark and until the region has been scrubbed concurrently. The\n+  \/\/   scrubbing ensures that all dead objects (with possibly unloaded classes)\n+  \/\/   have been replaced with filler objects that are parsable.\n+  \/\/ * after the marking phase in the Full GC pause until the objects have been\n+  \/\/   moved. Some (debug) code iterates over the heap after marking but before\n+  \/\/   compaction.\n+  \/\/\n+  \/\/ Below this limit the marking bitmap must be used to determine size and\n+  \/\/ liveness.\n","filename":"src\/hotspot\/share\/gc\/g1\/heapRegion.hpp","additions":12,"deletions":5,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -170,0 +170,7 @@\n+inline void HeapRegion::prepare_for_full_gc() {\n+  \/\/ After marking and class unloading the heap temporarily contains dead objects\n+  \/\/ with unloaded klasses. Moving parsable_bottom makes some (debug) code correctly\n+  \/\/ skip dead objects.\n+  _parsable_bottom = top();\n+}\n+\n@@ -191,1 +198,1 @@\n-  _parsable_bottom = bottom();\n+  reset_parsable_bottom();\n","filename":"src\/hotspot\/share\/gc\/g1\/heapRegion.inline.hpp","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,10 @@\n+\/**\n+ * @test id=8320331\n+ * @bug 8320331\n+ * @requires vm.debug\n+ * @library \/test\/lib\n+ * @modules java.base\/jdk.internal.misc\n+ * @modules java.compiler\n+ * @run main\/othervm\/timeout=200 -XX:+UnlockDiagnosticVMOptions -XX:+VerifyDuringGC -Xmx1g FragmentMetaspace\n+ *\/\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/Metaspace\/FragmentMetaspace.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"}]}