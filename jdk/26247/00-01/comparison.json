{"files":[{"patch":"@@ -1550,14 +1550,14 @@\n-        thread1 = new Thread() {\n-            public void run() {\n-                udpConsumerReady = true;\n-                while (true) {\n-                    try {\n-                        byte[] inbuf = new byte[8192];\n-                        DatagramPacket p = new DatagramPacket(inbuf, inbuf.length);\n-                        udp.receive(p);\n-                        System.out.println(\"-----------------------------------------------\");\n-                        System.out.println(\">>>>> UDP packet received\");\n-                        q.put(new Job(processMessage(Arrays.copyOf(inbuf, p.getLength())), udp, p));\n-                    } catch (Exception e) {\n-                        e.printStackTrace();\n-                    }\n+        thread1 = new Thread(() -> {\n+            udpConsumerReady = true;\n+            while (true) {\n+                try {\n+                    byte[] inbuf = new byte[8192];\n+                    DatagramPacket p = new DatagramPacket(inbuf, inbuf.length);\n+                    udp.receive(p);\n+                    System.out.println(\"-----------------------------------------------\");\n+                    System.out.println(\">>>>> UDP packet received\");\n+                    q.put(new Job(processMessage(Arrays.copyOf(inbuf, p.getLength())), udp, p));\n+                } catch (InterruptedException e){\n+                    break; \/\/ Thread was stopped, so stopping the loop\n+                } catch (Exception e) {\n+                    e.printStackTrace();\n@@ -1566,1 +1566,1 @@\n-        };\n+        });\n@@ -1571,19 +1571,12 @@\n-        thread2 = new Thread() {\n-            public void run() {\n-                tcpConsumerReady = true;\n-                while (true) {\n-                    try {\n-                        Socket socket = tcp.accept();\n-                        System.out.println(\"-----------------------------------------------\");\n-                        System.out.println(\">>>>> TCP connection established\");\n-                        DataInputStream in = new DataInputStream(socket.getInputStream());\n-                        DataOutputStream out = new DataOutputStream(socket.getOutputStream());\n-                        int len = in.readInt();\n-                        if (len > 65535) {\n-                            throw new Exception(\"Huge request not supported\");\n-                        }\n-                        byte[] token = new byte[len];\n-                        in.readFully(token);\n-                        q.put(new Job(processMessage(token), socket, out));\n-                    } catch (Exception e) {\n-                        e.printStackTrace();\n+        thread2 = new Thread(() -> {\n+            tcpConsumerReady = true;\n+            while (true) {\n+                try {\n+                    Socket socket = tcp.accept();\n+                    System.out.println(\"-----------------------------------------------\");\n+                    System.out.println(\">>>>> TCP connection established\");\n+                    DataInputStream in = new DataInputStream(socket.getInputStream());\n+                    DataOutputStream out = new DataOutputStream(socket.getOutputStream());\n+                    int len = in.readInt();\n+                    if (len > 65535) {\n+                        throw new Exception(\"Huge request not supported\");\n@@ -1591,0 +1584,7 @@\n+                    byte[] token = new byte[len];\n+                    in.readFully(token);\n+                    q.put(new Job(processMessage(token), socket, out));\n+                } catch (InterruptedException e){\n+                    break; \/\/ Thread was stopped, so stopping the loop\n+                } catch (Exception e) {\n+                    e.printStackTrace();\n@@ -1593,1 +1593,1 @@\n-        };\n+        });\n@@ -1598,8 +1598,8 @@\n-        thread3 = new Thread() {\n-            public void run() {\n-                dispatcherReady = true;\n-                while (true) {\n-                    try {\n-                        q.take().send();\n-                    } catch (Exception e) {\n-                    }\n+        thread3 = new Thread(() -> {\n+            dispatcherReady = true;\n+            while (true) {\n+                try {\n+                    q.take().send();\n+                } catch (InterruptedException e){\n+                    break; \/\/ Thread was stopped, so stopping the loop\n+                } catch (Exception e) {\n@@ -1608,1 +1608,1 @@\n-        };\n+        });\n","filename":"test\/jdk\/sun\/security\/krb5\/auto\/KDC.java","additions":44,"deletions":44,"binary":false,"changes":88,"status":"modified"}]}