{"files":[{"patch":"@@ -343,2 +343,2 @@\n-    private short[] prefix  = new short[4096];\n-    private byte[]  suffix  = new byte[4096];\n+    private short[] prefix  = new short[4097];\n+    private byte[]  suffix  = new byte[4097];\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/GifImageDecoder.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1995, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1995, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -193,2 +193,2 @@\n-    if (((*env)->GetArrayLength(env, prefixh) != 4096) ||\n-        ((*env)->GetArrayLength(env, suffixh) != 4096) ||\n+    if (((*env)->GetArrayLength(env, prefixh) != 4097) ||\n+        ((*env)->GetArrayLength(env, suffixh) != 4097) ||\n@@ -346,0 +346,1 @@\n+\n@@ -347,1 +348,3 @@\n-            outCode[--outCount] = prevChar;\n+            if (curCode != 4095) {\n+                outCode[--outCount] = prevChar;\n+            }\n@@ -457,0 +460,2 @@\n+            } else if (codeSize == 12) {\n+                freeCode = 4096;\n","filename":"src\/java.desktop\/share\/native\/libawt\/awt\/image\/gif\/gifdecoder.c","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -0,0 +1,50 @@\n+\/*\n+ * Copyright (c) 1999, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8351913\n+ * @summary Checks that sun.awt.image.GifImageDecoder decodes a gif correctly\n+ *          that maxes out its LZW compression table at 4096 entries.\n+ *\/\n+\n+import java.io.File;\n+import java.net.URL;\n+\n+public class GifMaxLZWTableTest {\n+\n+    public static void main(String[] args) throws Throwable {\n+        \/\/ this is frame #44 from\n+        \/\/ https:\/\/upload.wikimedia.org\/wikipedia\/commons\/8\/8b\/Scanner-abdominal-portal.gif\n+        URL srcURL = GifMaxLZWTableTest.class.getResource(\n+                \"Scanner-abdominal-portal.gif-44.gif\");\n+\n+        File dir = null;\n+\n+        \/\/ un-comment to visually inspect the frames:\n+\/\/        dir = new File(\"GifMaxLZWTableTest-frames\");\n+\/\/        dir.mkdir();\n+\n+        GifComparison.run(srcURL, dir);\n+    }\n+}\n","filename":"test\/jdk\/sun\/awt\/image\/gif\/GifMaxLZWTableTest.java","additions":50,"deletions":0,"binary":false,"changes":50,"status":"added"},{"filename":"test\/jdk\/sun\/awt\/image\/gif\/Scanner-abdominal-portal.gif-44.gif","binary":true,"status":"added"}]}