{"files":[{"patch":"@@ -157,2 +157,0 @@\n-java\/awt\/Mixing\/AWT_Mixing\/JMenuBarOverlapping.java 8159451 linux-all,windows-all,macosx-all\n-java\/awt\/Mixing\/AWT_Mixing\/JSplitPaneOverlapping.java 6986109 generic-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -24,0 +24,1 @@\n+import java.awt.Component;\n@@ -25,0 +26,1 @@\n+import java.awt.KeyboardFocusManager;\n@@ -26,0 +28,2 @@\n+import java.awt.event.FocusAdapter;\n+import java.awt.event.FocusEvent;\n@@ -29,0 +33,2 @@\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n@@ -113,0 +119,42 @@\n+        final CountDownLatch latch = new CountDownLatch(1);\n+        f.addFocusListener(new FocusAdapter() {\n+            @Override public void focusGained(FocusEvent e) {\n+                latch.countDown();\n+            }\n+        });\n+        if (!testResize) {\n+            wasLWClicked = false;\n+            try {\n+                SwingUtilities.invokeAndWait(new Runnable() {\n+\n+                    public void run() {\n+                        testedComponent.setBounds(0, 0,\n+                                testedComponent.getPreferredSize().width,\n+                                testedComponent.getPreferredSize().height + 20);\n+                        Component focusOwner = KeyboardFocusManager.getCurrentKeyboardFocusManager()\n+                                .getFocusOwner();\n+                        if (focusOwner == f) {\n+                            \/\/ frame already had focus\n+                            latch.countDown();\n+                        } else {\n+                            f.requestFocusInWindow();\n+                        }\n+                    }\n+                });\n+            } catch (InterruptedException | InvocationTargetException ex) {\n+                fail(ex.getMessage());\n+            }\n+            Point lLoc = testedComponent.getLocationOnScreen();\n+            lLoc.translate(1, testedComponent.getPreferredSize().height + 1);\n+            try {\n+                if (!latch.await(1, TimeUnit.SECONDS)) {\n+                    throw new RuntimeException(\"Ancestor frame didn't receive focus\");\n+                }\n+                clickAndBlink(robot, lLoc);\n+            } catch (InterruptedException e) {\n+                throw new RuntimeException(e);\n+            }\n+            return wasLWClicked;\n+        } else {\n+            latch.countDown();\n+        }\n@@ -115,0 +163,1 @@\n+\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/GlassPaneOverlappingTestBase.java","additions":49,"deletions":0,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -67,0 +67,2 @@\n+        frame.setLocationRelativeTo(null);\n+        frame.setVisible(true);\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/JComboBoxOverlapping.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n- * @run main JMenuBarOverlapping\n+ * @run main\/timeout=180 JMenuBarOverlapping\n@@ -76,1 +76,0 @@\n-\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/JMenuBarOverlapping.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -72,0 +72,1 @@\n+        frame.setLocationRelativeTo(null);\n@@ -78,0 +79,1 @@\n+                frame.setVisible(false);\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/JPopupMenuOverlapping.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -73,0 +73,2 @@\n+        currentAwtControl.setForeground(Color.WHITE);\n+        currentAwtControl.setBackground(Color.WHITE);\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/JSplitPaneOverlapping.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import javax.swing.UIManager;\n@@ -61,0 +62,1 @@\n+    static final int TOLERANCE_MACOSX = 15;\n@@ -80,1 +82,2 @@\n-            Process p = Runtime.getRuntime().exec(JAVA_HOME + \"\/bin\/java FrameBorderCounter\");\n+            Process p = Runtime.getRuntime()\n+                    .exec(JAVA_HOME + \"\/bin\/java FrameBorderCounter\");\n@@ -88,1 +91,3 @@\n-                throw new RuntimeException(\"FrameBorderCounter exited with not null code!\\n\" + readInputStream(p.getErrorStream()));\n+                throw new RuntimeException(\n+                        \"FrameBorderCounter exited with not null code!\\n\" +\n+                                readInputStream(p.getErrorStream()));\n@@ -111,1 +116,0 @@\n-\n@@ -113,1 +117,4 @@\n-        borderShift = Math.abs(borderShift) == 1 ? borderShift : (borderShift \/ 2);\n+        borderShift =\n+                Math.abs(borderShift) == 1 ?\n+                borderShift :\n+                (borderShift \/ 2);\n@@ -136,0 +143,1 @@\n+\n@@ -159,0 +167,1 @@\n+\n@@ -161,1 +170,2 @@\n-                lLoc.translate(frame.getWidth() + borderShift, frame.getHeight() + borderShift);\n+                lLoc.translate(frame.getWidth() + borderShift,\n+                        frame.getHeight() + borderShift);\n@@ -174,1 +184,2 @@\n-                if (!c.equals(jbColor)) {\n+                System.out.println(\"Color picked for jbutton: \" + c);\n+                if (!isAlmostEqualColor(c, jbColor)) {\n@@ -180,1 +191,2 @@\n-                if (!c.equals(awtColor)) {\n+                System.out.println(\"Color picked for awtButton: \" + c);\n+                if (!isAlmostEqualColor(c, awtColor)) {\n@@ -186,1 +198,2 @@\n-                if (!c.equals(jb2Color)) {\n+                System.out.println(\"Color picked for jbutton2: \" + c);\n+                if (!isAlmostEqualColor(c, jb2Color)) {\n@@ -192,1 +205,2 @@\n-                if (!c.equals(awt2Color)) {\n+                System.out.println(\"Color picked for awtButton2: \" + c);\n+                if (!isAlmostEqualColor(c, awt2Color)) {\n@@ -215,0 +229,1 @@\n+\n@@ -238,0 +253,7 @@\n+        try {\n+            UIManager.setLookAndFeel(\n+                    UIManager.getCrossPlatformLookAndFeelClassName());\n+        } catch (Exception e) {\n+            throw new RuntimeException(e);\n+        }\n+\n@@ -259,1 +281,2 @@\n-            throw new RuntimeException(\"Timed out after \" + sleepTime \/ 1000 + \" seconds\");\n+            throw new RuntimeException(\n+                    \"Timed out after \" + sleepTime \/ 1000 + \" seconds\");\n@@ -316,0 +339,9 @@\n+    private static boolean isAlmostEqualColor(Color color, Color refColor) {\n+        System.out.println(\"Comparing color: \" + color + \" with reference \" +\n+                \"color: \" + refColor);\n+        return color.equals(refColor)\n+               || (Math.abs(color.getRed() - refColor.getRed()) < TOLERANCE_MACOSX\n+                   && Math.abs(color.getGreen() - refColor.getGreen()) < TOLERANCE_MACOSX\n+                   && Math.abs(color.getBlue() - refColor.getBlue()) < TOLERANCE_MACOSX);\n+    }\n+\n@@ -318,0 +350,1 @@\n+\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/MixingPanelsResizing.java","additions":43,"deletions":10,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -385,4 +385,2 @@\n-        if ((component instanceof java.awt.Scrollbar) || isMac && (component instanceof java.awt.Button)) {\n-            return false;\n-        }\n-        return true;\n+        return !(component instanceof java.awt.Scrollbar) &&\n+                (!isMac || !(component instanceof java.awt.Button));\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/OverlappingTestBase.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -160,0 +160,1 @@\n+        final CountDownLatch latch = new CountDownLatch(1);\n@@ -161,1 +162,0 @@\n-            final CountDownLatch latch = new CountDownLatch(1);\n@@ -168,7 +168,8 @@\n-            try {\n-                if (!latch.await(1L, TimeUnit.SECONDS)) {\n-                    throw new RuntimeException(\n-                            \"Ancestor frame didn't receive focus\");\n-                }\n-            } catch (InterruptedException e) {\n-                throw new RuntimeException(e);\n+        } else {\n+            latch.countDown();\n+        }\n+        try {\n+            boolean await = latch.await(1, TimeUnit.SECONDS);\n+            if (!await) {\n+                throw new RuntimeException(\"Ancestor frame didn't receive \" +\n+                        \"focus\");\n@@ -176,0 +177,3 @@\n+            clickAndBlink(robot, lLoc);\n+        } catch (InterruptedException e) {\n+            throw new RuntimeException(e);\n@@ -177,2 +181,0 @@\n-\n-        clickAndBlink(robot, lLoc);\n","filename":"test\/jdk\/java\/awt\/Mixing\/AWT_Mixing\/SimpleOverlappingTestBase.java","additions":12,"deletions":10,"binary":false,"changes":22,"status":"modified"}]}