{"files":[{"patch":"@@ -46,1 +46,6 @@\n-    ReservedMemoryRegion rmr_found = VirtualMemoryTracker::Instance::tree()->find_reserved_region(stack_end);\n+    ReservedMemoryRegion rmr_found;\n+    {\n+      MemTracker::NmtVirtualMemoryLocker vml;\n+      rmr_found = VirtualMemoryTracker::Instance::tree()->find_reserved_region(stack_end);\n+    }\n+\n@@ -50,0 +55,1 @@\n+\n@@ -57,12 +63,14 @@\n-    VirtualMemoryTracker::Instance::tree()->visit_committed_regions(rmr_found, [&](const CommittedMemoryRegion& cmr) {\n-      if (cmr.base() + cmr.size() == stack_top) {\n-        EXPECT_TRUE(cmr.size() <= stack_size);\n-        found_stack_top = true;\n-      }\n-      if(i_addr < stack_top && i_addr >= cmr.base()) {\n-        found_i_addr = true;\n-      }\n-      i++;\n-      return true;\n-    });\n-\n+    {\n+      MemTracker::NmtVirtualMemoryLocker vml;\n+      VirtualMemoryTracker::Instance::tree()->visit_committed_regions(rmr_found, [&](const CommittedMemoryRegion& cmr) {\n+        if (cmr.base() + cmr.size() == stack_top) {\n+          EXPECT_TRUE(cmr.size() <= stack_size);\n+          found_stack_top = true;\n+        }\n+        if (i_addr < stack_top && i_addr >= cmr.base()) {\n+          found_i_addr = true;\n+        }\n+        i++;\n+        return true;\n+      });\n+    }\n","filename":"test\/hotspot\/gtest\/runtime\/test_committed_virtualmemory.cpp","additions":21,"deletions":13,"binary":false,"changes":34,"status":"modified"}]}