{"files":[{"patch":"@@ -111,1 +111,1 @@\n-  array->oop_iterate_range(mark_closure(), beg_index, end_index);\n+  array->oop_iterate_elements_range(mark_closure(), beg_index, end_index);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCMarker.inline.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -241,3 +241,3 @@\n-  to_array->oop_iterate_range(&_scanner,\n-                              checked_cast<int>(claim._start),\n-                              checked_cast<int>(claim._end));\n+  to_array->oop_iterate_elements_range(&_scanner,\n+                                       checked_cast<int>(claim._start),\n+                                       checked_cast<int>(claim._end));\n@@ -263,1 +263,1 @@\n-  to_array->oop_iterate_range(&_scanner, 0, checked_cast<int>(initial_chunk_size));\n+  to_array->oop_iterate_elements_range(&_scanner, 0, checked_cast<int>(initial_chunk_size));\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ParScanThreadState.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -415,1 +415,1 @@\n-  array->oop_iterate_range(&mark_and_push_closure, beg_index, end_index);\n+  array->oop_iterate_elements_range(&mark_and_push_closure, beg_index, end_index);\n","filename":"src\/hotspot\/share\/gc\/serial\/serialFullGC.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -170,1 +170,1 @@\n-    array->oop_iterate_range(cl, 0, len);\n+    array->oop_iterate_elements_range(cl, 0, len);\n@@ -219,1 +219,1 @@\n-      array->oop_iterate_range(cl, from, len);\n+      array->oop_iterate_elements_range(cl, from, len);\n@@ -251,1 +251,1 @@\n-  array->oop_iterate_range(cl, from, to);\n+  array->oop_iterate_elements_range(cl, from, to);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -459,1 +459,1 @@\n-  ZIterator::oop_iterate_range(obj, &cl, start, end);\n+  ZIterator::oop_iterate_elements_range(obj, &cl, start, end);\n","filename":"src\/hotspot\/share\/gc\/z\/zHeapIterator.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,1 +44,1 @@\n-  static void oop_iterate_range(objArrayOop obj, OopClosureT* cl, int start, int end);\n+  static void oop_iterate_elements_range(objArrayOop obj, OopClosureT* cl, int start, int end);\n","filename":"src\/hotspot\/share\/gc\/z\/zIterator.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -69,1 +69,1 @@\n-void ZIterator::oop_iterate_range(objArrayOop obj, OopClosureT* cl, int start, int end) {\n+void ZIterator::oop_iterate_elements_range(objArrayOop obj, OopClosureT* cl, int start, int end) {\n@@ -71,1 +71,1 @@\n-  obj->oop_iterate_range(cl, start, end);\n+  obj->oop_iterate_elements_range(cl, start, end);\n","filename":"src\/hotspot\/share\/gc\/z\/zIterator.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -138,1 +138,1 @@\n-  \/\/ Iterate over oop elements within [start, end), and metadata.\n+  \/\/ Iterate over all oop elements, and no metadata.\n@@ -140,1 +140,1 @@\n-  inline void oop_oop_iterate_range(objArrayOop a, OopClosureType* closure, int start, int end);\n+  inline void oop_oop_iterate_elements(objArrayOop a, OopClosureType* closure);\n@@ -142,2 +142,1 @@\n- public:\n-  \/\/ Iterate over all oop elements.\n+  \/\/ Iterate over oop elements within index range [start, end), and no metadata.\n@@ -145,1 +144,1 @@\n-  inline void oop_oop_iterate_elements(objArrayOop a, OopClosureType* closure);\n+  inline void oop_oop_iterate_elements_range(objArrayOop a, OopClosureType* closure, int start, int end);\n@@ -148,1 +147,1 @@\n-  \/\/ Iterate over all oop elements with indices within mr.\n+  \/\/ Iterate over all oop elements bounded by addresses [low, high), and no metadata.\n","filename":"src\/hotspot\/share\/oops\/objArrayKlass.hpp","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -41,2 +41,2 @@\n-  T* p         = (T*)a->base();\n-  T* const end = p + a->length();\n+  oop_oop_iterate_elements_range<T>(a, closure, 0, a->length());\n+}\n@@ -44,1 +44,9 @@\n-  for (;p < end; p++) {\n+\/\/ Like oop_oop_iterate but only iterates over a specified range and only used\n+\/\/ for objArrayOops.\n+template <typename T, class OopClosureType>\n+void ObjArrayKlass::oop_oop_iterate_elements_range(objArrayOop a, OopClosureType* closure, int start, int end) {\n+  T* base        = (T*)a->base();\n+  T* p           = base + start;\n+  T* const end_p = base + end;\n+\n+  for (;p < end_p; ++p) {\n@@ -101,20 +109,0 @@\n-\/\/ Like oop_oop_iterate but only iterates over a specified range and only used\n-\/\/ for objArrayOops.\n-template <typename T, class OopClosureType>\n-void ObjArrayKlass::oop_oop_iterate_range(objArrayOop a, OopClosureType* closure, int start, int end) {\n-  T* low = (T*)a->base() + start;\n-  T* high = (T*)a->base() + end;\n-\n-  oop_oop_iterate_elements_bounded<T>(a, closure, low, high);\n-}\n-\n-\/\/ Placed here to resolve include cycle between objArrayKlass.inline.hpp and objArrayOop.inline.hpp\n-template <typename OopClosureType>\n-void objArrayOopDesc::oop_iterate_range(OopClosureType* blk, int start, int end) {\n-  if (UseCompressedOops) {\n-    ((ObjArrayKlass*)klass())->oop_oop_iterate_range<narrowOop>(this, blk, start, end);\n-  } else {\n-    ((ObjArrayKlass*)klass())->oop_oop_iterate_range<oop>(this, blk, start, end);\n-  }\n-}\n-\n","filename":"src\/hotspot\/share\/oops\/objArrayKlass.inline.hpp","additions":11,"deletions":23,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n-  \/\/ special iterators for index ranges, returns size of object\n+  \/\/ Special iterators for an element index range\n@@ -88,1 +88,1 @@\n-  void oop_iterate_range(OopClosureType* blk, int start, int end);\n+  void oop_iterate_elements_range(OopClosureType* blk, int start, int end);\n","filename":"src\/hotspot\/share\/oops\/objArrayOop.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+#include \"oops\/objArrayKlass.inline.hpp\"\n@@ -54,0 +55,9 @@\n+template <typename OopClosureType>\n+void objArrayOopDesc::oop_iterate_elements_range(OopClosureType* blk, int start, int end) {\n+  if (UseCompressedOops) {\n+    ((ObjArrayKlass*)klass())->oop_oop_iterate_elements_range<narrowOop>(this, blk, start, end);\n+  } else {\n+    ((ObjArrayKlass*)klass())->oop_oop_iterate_elements_range<oop>(this, blk, start, end);\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/oops\/objArrayOop.inline.hpp","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"}]}