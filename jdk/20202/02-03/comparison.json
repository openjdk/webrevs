{"files":[{"patch":"@@ -539,0 +539,1 @@\n+CHeapBitMap* JVMFlag::iteratorMarkers = new CHeapBitMap(JVMFlag::numFlags, mtNMT);\n@@ -705,5 +706,2 @@\n-  for (size_t i = 0; i < length; i++) {\n-    if (flagTable[i].is_unlocked() && !(skipDefaults && flagTable[i].is_default())) {\n-      flagTable[i].clear_iterated();\n-    }\n-  }\n+  iteratorMarkers->clear();\n+\n@@ -712,1 +710,2 @@\n-    JVMFlag* best = nullptr;\n+    JVMFlag* best_flag = nullptr;\n+    size_t best_i = 0;\n@@ -714,3 +713,4 @@\n-      if (!(flagTable[i].is_iterated()) && flagTable[i].is_unlocked() && !(skipDefaults && flagTable[i].is_default())) {\n-        if ((best == nullptr) || (strcmp(best->name(), flagTable[i].name()) > 0)) {\n-          best = &flagTable[i];\n+      if (!iteratorMarkers->at(i) && flagTable[i].is_unlocked() && !(skipDefaults && flagTable[i].is_default())) {\n+        if ((best_flag == nullptr) || (strcmp(best_flag->name(), flagTable[i].name()) > 0)) {\n+          best_flag = &flagTable[i];\n+          best_i = i;\n@@ -720,3 +720,3 @@\n-    if (best != nullptr) {\n-      best->print_on(out, withComments, printRanges);\n-      best->set_iterated();\n+    if (best_flag != nullptr) {\n+      best_flag->print_on(out, withComments, printRanges);\n+      iteratorMarkers->at_put(best_i, true);\n","filename":"src\/hotspot\/share\/runtime\/flags\/jvmFlag.cpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"utilities\/bitMap.hpp\"\n@@ -82,2 +83,0 @@\n-    VALUE_ITERATED          = 1 << 18,\n-\n@@ -157,0 +156,2 @@\n+  static CHeapBitMap* iteratorMarkers;\n+\n@@ -302,4 +303,0 @@\n-  void clear_iterated()           { _flags = Flags(_flags & ~VALUE_ITERATED);                 }\n-  void set_iterated()             { _flags = Flags(_flags | VALUE_ITERATED);                  }\n-  bool is_iterated()              { return (_flags & VALUE_ITERATED) != 0;                    }\n-\n","filename":"src\/hotspot\/share\/runtime\/flags\/jvmFlag.hpp","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"}]}