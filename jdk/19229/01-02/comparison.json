{"files":[{"patch":"@@ -134,2 +134,2 @@\n-  \/\/ might have created lots of old entries. Clean them up proactively.\n-  OopMapCache::cleanup_old_entries();\n+  \/\/ might have created lots of old entries. Trigger the cleanup now.\n+  OopMapCache::trigger_cleanup();\n","filename":"src\/hotspot\/share\/gc\/shared\/gcVMOperations.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -56,2 +56,2 @@\n-  \/\/ might have created lots of old entries. Clean them up proactively.\n-  OopMapCache::cleanup_old_entries();\n+  \/\/ might have created lots of old entries. Trigger the cleanup now.\n+  OopMapCache::trigger_cleanup();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVMOperations.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -580,5 +580,0 @@\n-      if (head == nullptr) {\n-        \/\/ The queue was empty before, notify service thread there is now work to do.\n-        MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n-        Service_lock->notify_all();\n-      }\n@@ -600,1 +595,8 @@\n-void OopMapCache::cleanup_old_entries() {\n+void OopMapCache::trigger_cleanup() {\n+  if (has_cleanup_work()) {\n+    MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n+    Service_lock->notify_all();\n+  }\n+}\n+\n+void OopMapCache::cleanup() {\n","filename":"src\/hotspot\/share\/interpreter\/oopMapCache.cpp","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -186,0 +186,3 @@\n+  \/\/ Request cleanup if work is needed\n+  static void trigger_cleanup();\n+\n@@ -187,1 +190,1 @@\n-  static void cleanup_old_entries();\n+  static void cleanup();\n","filename":"src\/hotspot\/share\/interpreter\/oopMapCache.hpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -204,1 +204,1 @@\n-      OopMapCache::cleanup_old_entries();\n+      OopMapCache::cleanup();\n","filename":"src\/hotspot\/share\/runtime\/serviceThread.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}