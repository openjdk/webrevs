{"files":[{"patch":"@@ -30,1 +30,2 @@\n-import java.nio.file.*;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n@@ -32,1 +33,0 @@\n-import java.util.concurrent.atomic.AtomicInteger;\n@@ -52,1 +52,0 @@\n-    private SocketChannel s1, s2;\n@@ -54,3 +53,1 @@\n-    private static volatile String tempDir;\n-    private static final AtomicInteger count = new AtomicInteger(0);\n-    private volatile Path socket;\n+    private SocketChannel s1, s2;\n@@ -58,1 +55,1 @@\n-    @Param({\"inet\", \"unix\"})\n+    @Param({\"INET\", \"UNIX\"})\n@@ -61,29 +58,0 @@\n-    static {\n-        try {\n-            Path p = Files.createTempDirectory(\"readWriteTest\");\n-            tempDir = p.toString();\n-        } catch (IOException e) {\n-            tempDir = null;\n-        }\n-    }\n-\n-    private ServerSocketChannel getServerSocketChannel() throws IOException {\n-        if (family.equals(\"inet\"))\n-            return getInetServerSocketChannel();\n-        else if (family.equals(\"unix\"))\n-            return getUnixServerSocketChannel();\n-        throw new InternalError();\n-    }\n-\n-\n-    private ServerSocketChannel getInetServerSocketChannel() throws IOException {\n-        return ServerSocketChannel.open().bind(null);\n-    }\n-\n-    private ServerSocketChannel getUnixServerSocketChannel() throws IOException {\n-        int next = count.incrementAndGet();\n-        socket = Paths.get(tempDir, Integer.toString(next));\n-        UnixDomainSocketAddress addr = UnixDomainSocketAddress.of(socket);\n-        return ServerSocketChannel.open(StandardProtocolFamily.UNIX).bind(addr);\n-    }\n-\n@@ -92,1 +60,2 @@\n-        ssc = getServerSocketChannel();\n+        StandardProtocolFamily typedFamily = StandardProtocolFamily.valueOf(family);\n+        ssc = ServerSocketChannel.open(typedFamily).bind(null);\n@@ -96,1 +65,4 @@\n-    public void afterRun() throws IOException {\n+    public void afterRun() throws Exception {\n+        Path udsFilePath = ssc.getLocalAddress() instanceof UnixDomainSocketAddress udsChannel\n+                ? udsChannel.getPath()\n+                : null;\n@@ -98,3 +70,2 @@\n-        if (family.equals(\"unix\")) {\n-            Files.deleteIfExists(socket);\n-            Files.deleteIfExists(Path.of(tempDir));\n+        if (udsFilePath != null) {\n+            Files.delete(udsFilePath);\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/net\/SocketChannelConnectionSetup.java","additions":12,"deletions":41,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -54,10 +54,0 @@\n-    private volatile Path socket;\n-\n-    private ServerSocketChannel getServerSocketChannel() throws IOException {\n-        socket = Files.createTempDirectory(UnixSocketChannelReadWrite.class.getSimpleName()).resolve(\"sock\");\n-        UnixDomainSocketAddress addr = UnixDomainSocketAddress.of(socket);\n-        ServerSocketChannel c = ServerSocketChannel.open(StandardProtocolFamily.UNIX);\n-        c.bind(addr);\n-        return c;\n-    }\n-\n@@ -66,1 +56,1 @@\n-        ssc = getServerSocketChannel();\n+        ssc = ServerSocketChannel.open(StandardProtocolFamily.UNIX).bind(null);\n@@ -81,0 +71,1 @@\n+        Path udsFilePath = ((UnixDomainSocketAddress) ssc.getLocalAddress()).getPath();\n@@ -82,2 +73,1 @@\n-        Files.delete(socket);\n-        Files.delete(socket.getParent());\n+        Files.delete(udsFilePath);\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/net\/UnixSocketChannelReadWrite.java","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"}]}