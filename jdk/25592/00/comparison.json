{"files":[{"patch":"@@ -60,5 +60,1 @@\n-  if (TrainingData::have_data()) {\n-    \/\/ If we're running in AOT mode some classes may not be loaded yet\n-    return !k->is_instance_klass() || InstanceKlass::cast(k)->is_loaded();\n-  }\n-  return true;\n+  return TrainingData::is_klass_loaded(k);\n","filename":"src\/hotspot\/share\/ci\/ciMethodData.cpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -52,0 +52,1 @@\n+#include \"oops\/trainingData.hpp\"\n@@ -508,2 +509,5 @@\n-      klass = *((Klass**) (intptr_t) (base_address + offset));\n-      if (klass == nullptr || !klass->is_loader_alive()) {\n+      Klass* k = *((Klass**) (intptr_t) (base_address + offset));\n+      if (k == nullptr || k->class_loader_data() == nullptr || !TrainingData::is_klass_loaded(k)) {\n+        return nullptr;\n+      }\n+      if (!k->is_loader_alive()) {\n@@ -513,0 +517,1 @@\n+      klass = k;\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompilerToVM.cpp","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -286,0 +286,8 @@\n+  static bool is_klass_loaded(Klass* k) {\n+    if (have_data()) {\n+      \/\/ If we're running in AOT mode some classes may not be loaded yet\n+      return !k->is_instance_klass() || InstanceKlass::cast(k)->is_loaded();\n+    }\n+    return true;\n+  }\n+\n","filename":"src\/hotspot\/share\/oops\/trainingData.hpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -446,13 +446,1 @@\n-    static class RawItemProfile<T> {\n-        final int entries;\n-        final T[] items;\n-        final long[] counts;\n-        final long totalCount;\n-\n-        RawItemProfile(int entries, T[] items, long[] counts, long totalCount) {\n-            this.entries = entries;\n-            this.items = items;\n-            this.counts = counts;\n-            this.totalCount = totalCount;\n-        }\n-    }\n+    record RawItemProfile<T>(int entries, T[] items, long[] counts, long totalCount) {}\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk\/vm\/ci\/hotspot\/HotSpotMethodData.java","additions":1,"deletions":13,"binary":false,"changes":14,"status":"modified"}]}