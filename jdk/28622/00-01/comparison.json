{"files":[{"patch":"@@ -237,1 +237,1 @@\n-  size_t available = _space_info->soft_available();\n+  size_t available = _space_info->soft_available_exclude_evac_reserve();\n@@ -240,5 +240,3 @@\n-  log_debug(gc)(\"should_start_gc calculation: available: %zu%s, soft_max_capacity: %zu%s\"\n-                \", allocated_since_gc_start: %zu%s\",\n-                byte_size_in_proper_unit(available), proper_unit_for_byte_size(available),\n-                byte_size_in_proper_unit(capacity), proper_unit_for_byte_size(capacity),\n-                byte_size_in_proper_unit(allocated), proper_unit_for_byte_size(allocated));\n+  log_debug(gc, ergo)(\"should_start_gc calculation: available: \" PROPERFMT \", soft_max_capacity: \"  PROPERFMT \", \"\n+                \"allocated_since_gc_start: \"  PROPERFMT,\n+                PROPERFMTARGS(available), PROPERFMTARGS(capacity), PROPERFMTARGS(allocated));\n@@ -258,1 +256,1 @@\n-    log_trigger(\"Free (Soft mutator free) (%zu%s) is below minimum threshold (%zu%s)\",\n+    log_trigger(\"Free (Soft) (%zu%s) is below minimum threshold (%zu%s)\",\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahAdaptiveHeuristics.cpp","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -51,2 +51,2 @@\n-  size_t available = _space_info->soft_available();\n-  size_t allocated = _space_info->bytes_allocated_since_gc_start();\n+  size_t available = _space_info->soft_available_exclude_evac_reserve();\n+  size_t bytes_allocated = _space_info->bytes_allocated_since_gc_start();\n@@ -54,5 +54,3 @@\n-  log_debug(gc)(\"should_start_gc calculation: available: %zu%s, soft_max_capacity: %zu%s\"\n-                \", allocated_since_gc_start: %zu%s\",\n-                byte_size_in_proper_unit(available), proper_unit_for_byte_size(available),\n-                byte_size_in_proper_unit(capacity), proper_unit_for_byte_size(capacity),\n-                byte_size_in_proper_unit(allocated), proper_unit_for_byte_size(allocated));\n+  log_debug(gc, ergo)(\"should_start_gc calculation: available: \" PROPERFMT \", soft_max_capacity: \"  PROPERFMT \", \"\n+                \"allocated_since_gc_start: \"  PROPERFMT,\n+                PROPERFMTARGS(available), PROPERFMTARGS(capacity), PROPERFMTARGS(bytes_allocated));\n@@ -64,1 +62,1 @@\n-    log_trigger(\"Free (Soft mutator free) (%zu%s) is below minimum threshold (%zu%s)\",\n+    log_trigger(\"Free (Soft) (%zu%s) is below minimum threshold (%zu%s)\",\n@@ -71,1 +69,0 @@\n-  size_t bytes_allocated = _space_info->bytes_allocated_since_gc_start();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahCompactHeuristics.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n-  virtual size_t soft_available() const = 0;\n+  virtual size_t soft_available_exclude_evac_reserve() const = 0;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahSpaceInfo.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -45,1 +45,1 @@\n-  size_t available = _space_info->soft_available();\n+  size_t available = _space_info->soft_available_exclude_evac_reserve();\n@@ -48,5 +48,3 @@\n-  log_debug(gc)(\"should_start_gc calculation: available: %zu%s, soft_max_capacity: %zu%s\"\n-                \", allocated_since_gc_start: %zu%s\",\n-                byte_size_in_proper_unit(available), proper_unit_for_byte_size(available),\n-                byte_size_in_proper_unit(capacity), proper_unit_for_byte_size(capacity),\n-                byte_size_in_proper_unit(allocated), proper_unit_for_byte_size(allocated));\n+  log_debug(gc, ergo)(\"should_start_gc calculation: available: \" PROPERFMT \", soft_max_capacity: \"  PROPERFMT \", \"\n+                \"allocated_since_gc_start: \"  PROPERFMT,\n+                PROPERFMTARGS(available), PROPERFMTARGS(capacity), PROPERFMTARGS(allocated));\n@@ -57,1 +55,1 @@\n-    log_trigger(\"Free (Soft mutator free) (%zu%s) is below minimum threshold (%zu%s)\",\n+    log_trigger(\"Free (Soft) (%zu%s) is below minimum threshold (%zu%s)\",\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahStaticHeuristics.cpp","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -3209,1 +3209,3 @@\n-    if (_heap->mode()->is_generational()) {log_freeset_stats(ShenandoahFreeSetPartitionId::OldCollector, ls);}\n+    if (_heap->mode()->is_generational()) {\n+      log_freeset_stats(ShenandoahFreeSetPartitionId::OldCollector, ls);\n+    }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -939,2 +939,2 @@\n-size_t ShenandoahGeneration::soft_available() const {\n-  size_t result = available(ShenandoahHeap::heap()->soft_max_capacity());\n+size_t ShenandoahGeneration::soft_available_exclude_evac_reserve() const {\n+  size_t result = available(ShenandoahHeap::heap()->soft_max_capacity() * (100.0 - ShenandoahEvacReserve) \/ 100);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGeneration.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -129,1 +129,1 @@\n-  size_t soft_available() const override;\n+  size_t soft_available_exclude_evac_reserve() const override;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGeneration.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -81,1 +81,1 @@\n-size_t ShenandoahGlobalGeneration::soft_available() const {\n+size_t ShenandoahGlobalGeneration::soft_available_exclude_evac_reserve() const {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGlobalGeneration.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-  size_t soft_available() const override;\n+  size_t soft_available_exclude_evac_reserve() const override;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGlobalGeneration.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -141,2 +141,2 @@\n-size_t ShenandoahYoungGeneration::soft_available() const {\n-  size_t available = this->ShenandoahGeneration::soft_available();\n+size_t ShenandoahYoungGeneration::soft_available_exclude_evac_reserve() const {\n+  size_t available = this->ShenandoahGeneration::soft_available_exclude_evac_reserve();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahYoungGeneration.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n-  size_t soft_available() const override;\n+  size_t soft_available_exclude_evac_reserve() const override;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahYoungGeneration.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}