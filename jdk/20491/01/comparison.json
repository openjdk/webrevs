{"files":[{"patch":"@@ -935,1 +935,1 @@\n-      FLAGS_COMPILER_CHECK_ARGUMENTS(ARGUMENT: [${BRANCH_PROTECTION_FLAG}],\n+      FLAGS_COMPILER_CHECK_ARGUMENTS(ARGUMENT: [$BRANCH_PROTECTION_FLAG],\n@@ -940,1 +940,0 @@\n-  BRANCH_PROTECTION_CFLAGS=\"\"\n@@ -942,1 +941,1 @@\n-      RESULT: USE_BRANCH_PROTECTION, AVAILABLE: $BRANCH_PROTECTION_AVAILABLE,\n+      RESULT: BRANCH_PROTECTION_ENABLED, AVAILABLE: $BRANCH_PROTECTION_AVAILABLE,\n@@ -944,2 +943,1 @@\n-      IF_ENABLED: [ BRANCH_PROTECTION_CFLAGS=${BRANCH_PROTECTION_FLAG}])\n-  AC_SUBST(BRANCH_PROTECTION_CFLAGS)\n+      IF_ENABLED: [BRANCH_PROTECTION_CFLAGS=$BRANCH_PROTECTION_FLAG])\n","filename":"make\/autoconf\/flags-cflags.m4","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -153,0 +153,4 @@\n+  if test \"x$BRANCH_PROTECTION_ENABLED\" = \"xtrue\"; then\n+    $2JVM_ASFLAGS=\"${$2JVM_ASFLAGS} $BRANCH_PROTECTION_FLAG\"\n+  fi\n+\n","filename":"make\/autoconf\/flags-other.m4","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -432,1 +432,0 @@\n-BRANCH_PROTECTION_CFLAGS := @BRANCH_PROTECTION_CFLAGS@\n","filename":"make\/autoconf\/spec.gmk.template","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -67,0 +67,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -69,0 +70,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -73,0 +75,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -77,0 +80,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -83,0 +87,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -89,0 +94,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -97,0 +103,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -106,0 +113,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n@@ -113,0 +121,1 @@\n+\"       hint    #0x24; \/\/ bti j\\n\"                                               \\\n","filename":"src\/hotspot\/cpu\/aarch64\/copy_aarch64.hpp","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -44,0 +45,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -59,0 +61,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -60,1 +63,1 @@\n-        ldadd x1, x2, [x0]\n+        ldadd   x1, x2, [x0]\n@@ -73,0 +76,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -74,1 +78,1 @@\n-        ldadd w1, w2, [x0]\n+        ldadd   w1, w2, [x0]\n@@ -87,0 +91,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -101,0 +106,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -115,0 +121,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -134,0 +141,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -152,0 +160,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -170,0 +179,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -186,0 +196,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -202,0 +213,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -218,0 +230,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -234,0 +247,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -251,0 +265,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -267,0 +282,1 @@\n+        hint    #0x22 \/\/ bti c\n@@ -280,0 +296,32 @@\n+\n+\/* Emit .note.gnu.property section in case of PAC or BTI being enabled.\n+ * For more details see \"ELF for the Arm® 64-bit Architecture (AArch64)\".\n+ * https:\/\/github.com\/ARM-software\/abi-aa\/blob\/main\/aaelf64\/aaelf64.rst\n+ *\/\n+#ifdef __ARM_FEATURE_BTI_DEFAULT\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 3\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 1\n+    #endif\n+#else\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 2\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 0\n+    #endif\n+#endif\n+\n+#if (GNU_PROPERTY_AARCH64_FEATURE != 0)\n+        .pushsection .note.gnu.property, \"a\"\n+        .align  3\n+        .long   4          \/* name length *\/\n+        .long   0x10       \/* data length *\/\n+        .long   5          \/* note type: NT_GNU_PROPERTY_TYPE_0 *\/\n+        .string \"GNU\"      \/* vendor name *\/\n+        .long   0xc0000000 \/* GNU_PROPERTY_AARCH64_FEATURE_1_AND *\/\n+        .long   4          \/* pr_datasze *\/\n+        .long   GNU_PROPERTY_AARCH64_FEATURE\n+        .long   0\n+        .popsection\n+#endif\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/atomic_linux_aarch64.S","additions":50,"deletions":2,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -86,1 +86,3 @@\n-        ret                             \/\/ -8 == 0 words\n+        \/\/ -8 == 0 words\n+        hint    #0x24 \/\/ bti j\n+        ret\n@@ -88,1 +90,3 @@\n-        ldr     t0, [s, #16]            \/\/ -7 == 1 word\n+        \/\/ -7 == 1 word\n+        hint    #0x24 \/\/ bti j\n+        ldr     t0, [s, #16]\n@@ -92,1 +96,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -6 = 2 words\n+        \/\/ -6 == 2 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -96,1 +102,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -5 = 3 words\n+        \/\/ -5 == 3 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -102,1 +110,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -4 = 4 words\n+        \/\/ -4 == 4 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -108,1 +118,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -3 = 5 words\n+        \/\/ -3 == 5 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -116,1 +128,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -2 = 6 words\n+        \/\/ -2 == 6 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -124,1 +138,3 @@\n-        ldp     t0, t1, [s, #16]        \/\/ -1 = 7 words\n+        \/\/ -1 == 7 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #16]\n@@ -131,2 +147,1 @@\n-        str     t6, [d, #64]\n-        \/\/ Is always aligned here, code for 7 words is one instruction\n+        \/\/ Is always aligned here, code for 7 words is two instructions\n@@ -136,0 +151,1 @@\n+        str     t6, [d, #64]\n@@ -187,1 +203,3 @@\n-        ret                             \/\/ -8 == 0 words\n+        \/\/ -8 == 0 words\n+        hint    #0x24 \/\/ bti j\n+        ret\n@@ -189,1 +207,3 @@\n-        ldr     t0, [s, #-8]            \/\/ -7 == 1 word\n+        \/\/ -7 == 1 word\n+        hint    #0x24 \/\/ bti j\n+        ldr     t0, [s, #-8]\n@@ -193,1 +213,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -6 = 2 words\n+        \/\/ -6 == 2 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -197,1 +219,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -5 = 3 words\n+        \/\/ -5 == 3 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -203,1 +227,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -4 = 4 words\n+        \/\/ -4 == 4 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -209,1 +235,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -3 = 5 words\n+        \/\/ -3 == 5 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -217,1 +245,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -2 = 6 words\n+        \/\/ -2 == 6 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -225,1 +255,3 @@\n-        ldp     t0, t1, [s, #-16]       \/\/ -1 = 7 words\n+        \/\/ -1 == 7 words\n+        hint    #0x24 \/\/ bti j\n+        ldp     t0, t1, [s, #-16]\n@@ -232,2 +264,1 @@\n-        str     t6, [d, #-56]\n-        \/\/ Is always aligned here, code for 7 words is one instruction\n+        \/\/ Is always aligned here, code for 7 words is two instructions\n@@ -237,0 +268,1 @@\n+        str     t6, [d, #-56]\n@@ -238,0 +270,32 @@\n+\n+\/* Emit .note.gnu.property section in case of PAC or BTI being enabled.\n+ * For more details see \"ELF for the Arm® 64-bit Architecture (AArch64)\".\n+ * https:\/\/github.com\/ARM-software\/abi-aa\/blob\/main\/aaelf64\/aaelf64.rst\n+ *\/\n+#ifdef __ARM_FEATURE_BTI_DEFAULT\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 3\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 1\n+    #endif\n+#else\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 2\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 0\n+    #endif\n+#endif\n+\n+#if (GNU_PROPERTY_AARCH64_FEATURE != 0)\n+        .pushsection .note.gnu.property, \"a\"\n+        .align  3\n+        .long   4          \/* name length *\/\n+        .long   0x10       \/* data length *\/\n+        .long   5          \/* note type: NT_GNU_PROPERTY_TYPE_0 *\/\n+        .string \"GNU\"      \/* vendor name *\/\n+        .long   0xc0000000 \/* GNU_PROPERTY_AARCH64_FEATURE_1_AND *\/\n+        .long   4          \/* pr_datasze *\/\n+        .long   GNU_PROPERTY_AARCH64_FEATURE\n+        .long   0\n+        .popsection\n+#endif\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/copy_linux_aarch64.S","additions":84,"deletions":20,"binary":false,"changes":104,"status":"modified"},{"patch":"@@ -51,0 +51,32 @@\n+\n+\/* Emit .note.gnu.property section in case of PAC or BTI being enabled.\n+ * For more details see \"ELF for the Arm® 64-bit Architecture (AArch64)\".\n+ * https:\/\/github.com\/ARM-software\/abi-aa\/blob\/main\/aaelf64\/aaelf64.rst\n+ *\/\n+#ifdef __ARM_FEATURE_BTI_DEFAULT\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 3\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 1\n+    #endif\n+#else\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 2\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 0\n+    #endif\n+#endif\n+\n+#if (GNU_PROPERTY_AARCH64_FEATURE != 0)\n+        .pushsection .note.gnu.property, \"a\"\n+        .align  3\n+        .long   4          \/* name length *\/\n+        .long   0x10       \/* data length *\/\n+        .long   5          \/* note type: NT_GNU_PROPERTY_TYPE_0 *\/\n+        .string \"GNU\"      \/* vendor name *\/\n+        .long   0xc0000000 \/* GNU_PROPERTY_AARCH64_FEATURE_1_AND *\/\n+        .long   4          \/* pr_datasze *\/\n+        .long   GNU_PROPERTY_AARCH64_FEATURE\n+        .long   0\n+        .popsection\n+#endif\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/safefetch_linux_aarch64.S","additions":32,"deletions":0,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -47,0 +47,32 @@\n+\n+\/* Emit .note.gnu.property section in case of PAC or BTI being enabled.\n+ * For more details see \"ELF for the Arm® 64-bit Architecture (AArch64)\".\n+ * https:\/\/github.com\/ARM-software\/abi-aa\/blob\/main\/aaelf64\/aaelf64.rst\n+ *\/\n+#ifdef __ARM_FEATURE_BTI_DEFAULT\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 3\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 1\n+    #endif\n+#else\n+    #ifdef __ARM_FEATURE_PAC_DEFAULT\n+        #define GNU_PROPERTY_AARCH64_FEATURE 2\n+    #else\n+        #define GNU_PROPERTY_AARCH64_FEATURE 0\n+    #endif\n+#endif\n+\n+#if (GNU_PROPERTY_AARCH64_FEATURE != 0)\n+        .pushsection .note.gnu.property, \"a\"\n+        .align  3\n+        .long   4          \/* name length *\/\n+        .long   0x10       \/* data length *\/\n+        .long   5          \/* note type: NT_GNU_PROPERTY_TYPE_0 *\/\n+        .string \"GNU\"      \/* vendor name *\/\n+        .long   0xc0000000 \/* GNU_PROPERTY_AARCH64_FEATURE_1_AND *\/\n+        .long   4          \/* pr_datasze *\/\n+        .long   GNU_PROPERTY_AARCH64_FEATURE\n+        .long   0\n+        .popsection\n+#endif\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/threadLS_linux_aarch64.S","additions":32,"deletions":0,"binary":false,"changes":32,"status":"modified"}]}