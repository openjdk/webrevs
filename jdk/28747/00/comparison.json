{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+ * @requires vm.opt.DisableExplicitGC != \"true\"\n@@ -34,1 +35,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:-UseGCOverheadLimit\n@@ -63,0 +64,1 @@\n+\n@@ -79,3 +81,6 @@\n-                validate();\n-                Algorithms.eatMemory(stresser);\n-                        if(stresser.continueExecution()) {\n+                validate(false \/* don't check gc count increases *\/);\n+                int iteration = 0;\n+                do {\n+                    System.out.println(\"=========== stressor iter: \" + (stresser.getIteration())\n+                                    + \" runOne iter: \" + (++iteration) + \" ===========\");\n+                    Algorithms.eatMemory(stresser);\n@@ -83,1 +88,1 @@\n-                    validateNonTrivial();\n+                    validate(true);\n@@ -86,1 +91,1 @@\n-                    validateNonTrivial();\n+                    validate(true);\n@@ -89,2 +94,2 @@\n-                    validateNonTrivial();\n-                        }\n+                    validate(true);\n+                } while (stresser.continueExecution());\n@@ -101,1 +106,1 @@\n-        private void validate() {\n+        private void validate(boolean gcCountMustIncrease) {\n@@ -103,1 +108,1 @@\n-                        throw new TestFailure(\"collectionCount negative: \" + collectionCount);\n+                    throw new TestFailure(\"collectionCount negative: \" + collectionCount);\n@@ -105,3 +110,1 @@\n-                        throw new TestFailure(\"collectionTime negative: \" + collectionTime);\n-                if (collectionCount < collectionCountOld)\n-                        throw new TestFailure(\"collectionCount decreased: \" + collectionCount + \" -> \" + collectionCountOld);\n+                    throw new TestFailure(\"collectionTime negative: \" + collectionTime);\n@@ -109,9 +112,6 @@\n-                        throw new TestFailure(\"collectionTime decreased: \" + collectionTime + \" -> \" + collectionTimeOld);\n-        }\n-\n-        private void validateNonTrivial() {\n-                if (collectionCount < 0)\n-                        throw new TestFailure(\"collectionCount negative: \" + collectionCount);\n-                if (collectionTime < 0)\n-                        throw new TestFailure(\"collectionTime negative: \" + collectionTime);\n-                if (collectionCount <= collectionCountOld)\n+                    throw new TestFailure(\"collectionTime decreased: \" + collectionTime + \" -> \" + collectionTimeOld);\n+                if (!gcCountMustIncrease) {\n+                    if (collectionCount < collectionCountOld)\n+                        throw new TestFailure(\"collectionCount decreased: \" + collectionCount + \" -> \" + collectionCountOld);\n+                } else {\n+                    if (collectionCount <= collectionCountOld)\n@@ -119,2 +119,1 @@\n-                if (collectionTime < collectionTimeOld)\n-                        throw new TestFailure(\"collection time became smaller: \" + collectionTime + \" -> \" + collectionTimeOld);\n+                }\n@@ -129,2 +128,2 @@\n-                        collectionCount += gcBean.getCollectionCount();\n-                        collectionTime += gcBean.getCollectionTime();\n+                    collectionCount += gcBean.getCollectionCount();\n+                    collectionTime += gcBean.getCollectionTime();\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/GarbageCollectorMXBean\/CollectionCounters\/CollectionCounters001\/CollectionCounters001.java","additions":26,"deletions":27,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+ * @requires vm.opt.DisableExplicitGC != \"true\"\n@@ -34,1 +35,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:-UseGCOverheadLimit\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/GarbageCollectorMXBean\/CollectionCounters\/CollectionCounters002\/TestDescription.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+ * @requires vm.opt.DisableExplicitGC != \"true\"\n@@ -34,1 +35,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:-UseGCOverheadLimit\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/GarbageCollectorMXBean\/CollectionCounters\/CollectionCounters003\/TestDescription.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+ * @requires vm.opt.DisableExplicitGC != \"true\"\n@@ -34,1 +35,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:-UseGCOverheadLimit\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/GarbageCollectorMXBean\/CollectionCounters\/CollectionCounters004\/TestDescription.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+ * @requires vm.opt.DisableExplicitGC != \"true\"\n@@ -34,1 +35,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:-UseGCOverheadLimit\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/GarbageCollectorMXBean\/CollectionCounters\/CollectionCounters005\/TestDescription.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}