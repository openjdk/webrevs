{"files":[{"patch":"@@ -28,2 +28,0 @@\n-import java.security.AccessController;\n-import java.security.PrivilegedAction;\n@@ -662,1 +660,0 @@\n-    @SuppressWarnings(\"removal\")\n@@ -664,1 +661,1 @@\n-        Console c;\n+        Console c = null;\n@@ -676,4 +673,2 @@\n-            c = AccessController.doPrivileged(new PrivilegedAction<Console>() {\n-                public Console run() {\n-                    var consModName = System.getProperty(\"jdk.console\",\n-                            JdkConsoleProvider.DEFAULT_PROVIDER_MODULE_NAME);\n+            var consModName = System.getProperty(\"jdk.console\",\n+                    JdkConsoleProvider.DEFAULT_PROVIDER_MODULE_NAME);\n@@ -681,8 +676,5 @@\n-                    for (var jcp : ServiceLoader.load(ModuleLayer.boot(), JdkConsoleProvider.class)) {\n-                        if (consModName.equals(jcp.getClass().getModule().getName())) {\n-                            var jc = jcp.console(istty, CHARSET);\n-                            if (jc != null) {\n-                                return new ProxyingConsole(jc);\n-                            }\n-                            break;\n-                        }\n+            for (var jcp : ServiceLoader.load(ModuleLayer.boot(), JdkConsoleProvider.class)) {\n+                if (consModName.equals(jcp.getClass().getModule().getName())) {\n+                    var jc = jcp.console(istty, CHARSET);\n+                    if (jc != null) {\n+                        c = new ProxyingConsole(jc);\n@@ -690,1 +682,1 @@\n-                    return null;\n+                    break;\n@@ -692,1 +684,1 @@\n-            });\n+            }\n@@ -694,1 +686,0 @@\n-            c = null;\n","filename":"src\/java.base\/share\/classes\/java\/io\/Console.java","additions":10,"deletions":19,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -754,5 +754,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -778,5 +773,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -797,5 +787,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -823,5 +808,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -851,5 +831,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -884,5 +859,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -923,5 +893,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -950,5 +915,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -986,3 +946,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) security.checkWrite(path);\n@@ -1010,5 +967,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkDelete(path);\n-        }\n@@ -1046,5 +998,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkDelete(path);\n-        }\n@@ -1100,5 +1047,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(path);\n-        }\n@@ -1278,5 +1220,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1348,6 +1285,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-            security.checkWrite(dest.path);\n-        }\n@@ -1383,5 +1314,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1409,5 +1335,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1448,5 +1369,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1520,5 +1436,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1598,5 +1509,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(path);\n-        }\n@@ -1655,5 +1561,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkExec(path);\n-        }\n@@ -1729,6 +1630,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n-        if (sm != null) {\n-            sm.checkPermission(new RuntimePermission(\"getFileSystemAttributes\"));\n-            sm.checkRead(path);\n-        }\n@@ -1767,6 +1662,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n-        if (sm != null) {\n-            sm.checkPermission(new RuntimePermission(\"getFileSystemAttributes\"));\n-            sm.checkRead(path);\n-        }\n@@ -1808,6 +1697,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n-        if (sm != null) {\n-            sm.checkPermission(new RuntimePermission(\"getFileSystemAttributes\"));\n-            sm.checkRead(path);\n-        }\n@@ -1843,1 +1726,0 @@\n-        @SuppressWarnings(\"removal\")\n@@ -1900,5 +1782,2 @@\n-                if (System.getSecurityManager() != null)\n-                    throw new IOException(\"Unable to create temporary file\");\n-                else\n-                    throw new IOException(\"Unable to create temporary file, \"\n-                        + name);\n+                throw new IOException(\"Unable to create temporary file, \"\n+                    + name);\n@@ -2001,2 +1880,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n@@ -2006,11 +1883,0 @@\n-\n-            if (sm != null) {\n-                try {\n-                    sm.checkWrite(f.getPath());\n-                } catch (SecurityException se) {\n-                    \/\/ don't reveal temporary directory location\n-                    if (directory == null)\n-                        throw new SecurityException(\"Unable to create temporary file\");\n-                    throw se;\n-                }\n-            }\n","filename":"src\/java.base\/share\/classes\/java\/io\/File.java","additions":2,"deletions":136,"binary":false,"changes":138,"status":"modified"},{"patch":"@@ -134,5 +134,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(name);\n-        }\n@@ -169,2 +164,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n@@ -174,3 +167,0 @@\n-        if (security != null) {\n-            security.checkRead(fdObj);\n-        }\n","filename":"src\/java.base\/share\/classes\/java\/io\/FileInputStream.java","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -203,5 +203,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkWrite(name);\n-        }\n@@ -239,2 +234,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n@@ -244,3 +237,0 @@\n-        if (security != null) {\n-            security.checkWrite(fdObj);\n-        }\n","filename":"src\/java.base\/share\/classes\/java\/io\/FileOutputStream.java","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n-import java.security.*;\n+import java.security.Permission;\n+import java.security.PermissionCollection;\n@@ -39,1 +40,0 @@\n-import sun.security.action.GetPropertyAction;\n@@ -184,2 +184,1 @@\n-    private static final Path here = builtInFS.getPath(\n-            GetPropertyAction.privilegedGetProperty(\"user.dir\"));\n+    private static final Path here = builtInFS.getPath(jdk.internal.util.StaticProperty.userDir());\n@@ -364,17 +363,11 @@\n-            cpath = AccessController.doPrivileged(new PrivilegedAction<>() {\n-                public String run() {\n-                    try {\n-                        String path = cpath;\n-                        if (cpath.endsWith(\"*\")) {\n-                            \/\/ call getCanonicalPath with a path with wildcard character\n-                            \/\/ replaced to avoid calling it with paths that are\n-                            \/\/ intended to match all entries in a directory\n-                            path = path.substring(0, path.length() - 1) + \"-\";\n-                            path = new File(path).getCanonicalPath();\n-                            return path.substring(0, path.length() - 1) + \"*\";\n-                        } else {\n-                            return new File(path).getCanonicalPath();\n-                        }\n-                    } catch (IOException ioe) {\n-                        return cpath;\n-                    }\n+            try {\n+                String path = cpath;\n+                if (cpath.endsWith(\"*\")) {\n+                    \/\/ call getCanonicalPath with a path with wildcard character\n+                    \/\/ replaced to avoid calling it with paths that are\n+                    \/\/ intended to match all entries in a directory\n+                    path = path.substring(0, path.length() - 1) + \"-\";\n+                    path = new File(path).getCanonicalPath();\n+                    cpath = path.substring(0, path.length() - 1) + \"*\";\n+                } else {\n+                    cpath = new File(path).getCanonicalPath();\n@@ -382,1 +375,2 @@\n-            });\n+            } catch (IOException ignore) {\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/io\/FilePermission.java","additions":16,"deletions":22,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -248,8 +248,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager security = System.getSecurityManager();\n-        if (security != null) {\n-            security.checkRead(name);\n-            if (rw) {\n-                security.checkWrite(name);\n-            }\n-        }\n","filename":"src\/java.base\/share\/classes\/java\/io\/RandomAccessFile.java","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import java.security.*;\n+import java.security.BasicPermission;\n@@ -47,1 +47,0 @@\n- * @see java.lang.SecurityManager\n","filename":"src\/java.base\/share\/classes\/java\/io\/SerializablePermission.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import sun.security.action.GetPropertyAction;\n@@ -39,1 +38,1 @@\n-        Properties props = GetPropertyAction.privilegedGetProperties();\n+        Properties props = System.getProperties();\n@@ -153,5 +152,0 @@\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n-        if (sm != null) {\n-            sm.checkPropertyAccess(\"user.dir\");\n-        }\n@@ -262,10 +256,1 @@\n-        try {\n-            @SuppressWarnings(\"removal\")\n-            SecurityManager security = System.getSecurityManager();\n-            if (security != null) {\n-                security.checkRead(\"\/\");\n-            }\n-            return new File[] { new File(\"\/\") };\n-        } catch (SecurityException x) {\n-            return new File[0];\n-        }\n+        return new File[] { new File(\"\/\") };\n","filename":"src\/java.base\/unix\/classes\/java\/io\/UnixFileSystem.java","additions":2,"deletions":17,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import sun.security.action.GetPropertyAction;\n@@ -56,1 +55,1 @@\n-        String enableADS = GetPropertyAction.privilegedGetProperty(\"jdk.io.File.enableADS\");\n+        String enableADS = System.getProperty(\"jdk.io.File.enableADS\");\n@@ -84,1 +83,1 @@\n-        Properties props = GetPropertyAction.privilegedGetProperties();\n+        Properties props = System.getProperties();\n@@ -397,1 +396,1 @@\n-            return getUserPath() + slashify(path); \/* Completely relative *\/\n+            return userDir + slashify(path); \/* Completely relative *\/\n@@ -399,1 +398,1 @@\n-            String up = getUserPath();\n+            String up = userDir;\n@@ -405,1 +404,1 @@\n-            String up = getUserPath();\n+            String up = userDir;\n@@ -416,8 +415,0 @@\n-                @SuppressWarnings(\"removal\")\n-                SecurityManager security = System.getSecurityManager();\n-                try {\n-                    if (security != null) security.checkRead(p);\n-                } catch (SecurityException x) {\n-                    \/* Don't disclose the drive's directory in the exception *\/\n-                    throw new SecurityException(\"Cannot resolve path \" + path);\n-                }\n@@ -431,11 +422,0 @@\n-    private String getUserPath() {\n-        \/* For both compatibility and security,\n-           we must look this up every time *\/\n-        @SuppressWarnings(\"removal\")\n-        SecurityManager sm = System.getSecurityManager();\n-        if (sm != null) {\n-            sm.checkPropertyAccess(\"user.dir\");\n-        }\n-        return userDir;\n-    }\n-\n@@ -598,1 +578,0 @@\n-            .filter(f -> access(f.getPath()))\n@@ -603,11 +582,0 @@\n-    private boolean access(String path) {\n-        try {\n-            @SuppressWarnings(\"removal\")\n-            SecurityManager security = System.getSecurityManager();\n-            if (security != null) security.checkRead(path);\n-            return true;\n-        } catch (SecurityException x) {\n-            return false;\n-        }\n-    }\n-\n","filename":"src\/java.base\/windows\/classes\/java\/io\/WinNTFileSystem.java","additions":5,"deletions":37,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,2 +33,0 @@\n-import java.security.AccessController;\n-import java.security.PrivilegedAction;\n@@ -197,5 +195,0 @@\n-                    @SuppressWarnings(\"removal\")\n-                    SecurityManager sm = System.getSecurityManager();\n-                    if (sm != null) {\n-                        sm.checkListen(isa.getPort());\n-                    }\n@@ -367,5 +360,0 @@\n-                @SuppressWarnings(\"removal\")\n-                SecurityManager sm = System.getSecurityManager();\n-                if (sm != null)\n-                    sm.checkConnect(isa.getAddress().getHostAddress(),\n-                                    isa.getPort());\n@@ -1097,1 +1085,1 @@\n-    @SuppressWarnings({\"removal\", \"restricted\"})\n+    @SuppressWarnings({\"restricted\"})\n@@ -1100,7 +1088,1 @@\n-        AccessController.doPrivileged(\n-            new PrivilegedAction<>() {\n-                public Void run() {\n-                    System.loadLibrary(\"sctp\");\n-                    return null;\n-                }\n-            });\n+        System.loadLibrary(\"sctp\");\n","filename":"src\/jdk.sctp\/unix\/classes\/sun\/nio\/ch\/sctp\/SctpChannelImpl.java","additions":3,"deletions":21,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -152,4 +152,0 @@\n-                    @SuppressWarnings(\"removal\")\n-                    SecurityManager sm = System.getSecurityManager();\n-                    if (sm != null)\n-                        sm.checkListen(isa.getPort());\n@@ -511,15 +507,0 @@\n-                            @SuppressWarnings(\"removal\")\n-                            SecurityManager sm = System.getSecurityManager();\n-                            if (sm != null) {\n-                                InetSocketAddress isa  = (InetSocketAddress)info.address();\n-                                if (!addressMap.containsKey(isa)) {\n-                                    \/* must be a new association *\/\n-                                    try {\n-                                        sm.checkAccept(isa.getAddress().getHostAddress(),\n-                                                       isa.getPort());\n-                                    } catch (SecurityException se) {\n-                                        buffer.clear();\n-                                        throw se;\n-                                    }\n-                                }\n-                            }\n@@ -807,7 +788,0 @@\n-\n-                        } else { \/* must be new association *\/\n-                            @SuppressWarnings(\"removal\")\n-                            SecurityManager sm = System.getSecurityManager();\n-                            if (sm != null)\n-                                sm.checkConnect(addr.getAddress().getHostAddress(),\n-                                                addr.getPort());\n","filename":"src\/jdk.sctp\/unix\/classes\/sun\/nio\/ch\/sctp\/SctpMultiChannelImpl.java","additions":1,"deletions":27,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -112,4 +112,0 @@\n-                @SuppressWarnings(\"removal\")\n-                SecurityManager sm = System.getSecurityManager();\n-                if (sm != null)\n-                    sm.checkListen(isa.getPort());\n@@ -250,6 +246,0 @@\n-            @SuppressWarnings(\"removal\")\n-            SecurityManager sm = System.getSecurityManager();\n-            if (sm != null)\n-                sm.checkAccept(isa.getAddress().getHostAddress(),\n-                               isa.getPort());\n-\n","filename":"src\/jdk.sctp\/unix\/classes\/sun\/nio\/ch\/sctp\/SctpServerChannelImpl.java","additions":1,"deletions":11,"binary":false,"changes":12,"status":"modified"}]}