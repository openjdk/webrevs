{"files":[{"patch":"@@ -30,1 +30,0 @@\n-import com.sun.hotspot.igv.data.Group;\n@@ -147,2 +146,1 @@\n-     * Exports the provided graph document to an XML file.\n-     * Displays a file chooser dialog to specify the location and name of the XML file.\n+     * Stores the provided graph document to the designated file path with associated contexts.\n@@ -150,18 +148,1 @@\n-    public static void exportToXML(GraphDocument doc) {\n-        JFileChooser fc = new JFileChooser();\n-        fc.setFileFilter(xmlFileFilter);\n-        fc.setCurrentDirectory(new File(Settings.get().get(Settings.DIRECTORY, Settings.DIRECTORY_DEFAULT)));\n-        if (fc.showSaveDialog(null) == JFileChooser.APPROVE_OPTION) {\n-            String path = fc.getSelectedFile().getAbsolutePath();\n-            try {\n-                saveGraphDocument(doc, path, false);\n-            } catch (IOException e) {\n-                throw new RuntimeException(e);\n-            }\n-        }\n-    }\n-\n-    \/**\n-     * Stores the provided graph document to the designated file path, optionally with associated contexts.\n-     *\/\n-    private static void saveGraphDocument(GraphDocument doc, String path, boolean saveContext) throws IOException {\n+    private static void saveGraphDocument(GraphDocument doc, String path) throws IOException {\n@@ -173,8 +154,9 @@\n-        if (saveContext) {\n-            WindowManager manager = WindowManager.getDefault();\n-            for (Mode mode : manager.getModes()) {\n-                List<TopComponent> compList = new ArrayList<>(Arrays.asList(manager.getOpenedTopComponents(mode)));\n-                for (TopComponent comp : compList) {\n-                    if (comp instanceof EditorTopComponent etc) {\n-                        GraphContext graphContext = getGraphContext(etc);\n-                        saveContexts.add(graphContext);\n+        WindowManager manager = WindowManager.getDefault();\n+        for (Mode mode : manager.getModes()) {\n+            List<TopComponent> compList = new ArrayList<>(Arrays.asList(manager.getOpenedTopComponents(mode)));\n+            for (TopComponent comp : compList) {\n+                if (comp instanceof EditorTopComponent etc) {\n+                    InputGraph graph = etc.getModel().getGraph();\n+                    if (graph.isDiffGraph() && graph.getFirstGraph().getGroup() != graph.getSecondGraph().getGroup()) {\n+                        \/\/ don't save diff graphs comparing graphs from different groups\n+                        continue;\n@@ -182,0 +164,2 @@\n+                    GraphContext graphContext = getGraphContext(etc);\n+                    saveContexts.add(graphContext);\n@@ -218,0 +202,1 @@\n+        toolbar.add(ImportAction.get(ImportAction.class));\n@@ -228,5 +213,0 @@\n-        toolbar.add(ImportAction.get(ImportAction.class));\n-        toolbar.add(ExportAction.get(ExportAction.class).createContextAwareInstance(this.getLookup()));\n-\n-        toolbar.addSeparator();\n-\n@@ -434,1 +414,1 @@\n-                saveGraphDocument(getDocument(), filePath, true);\n+                saveGraphDocument(getDocument(), filePath);\n@@ -459,1 +439,1 @@\n-                saveGraphDocument(getDocument(), path, true);\n+                saveGraphDocument(getDocument(), path);\n","filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/java\/com\/sun\/hotspot\/igv\/coordinator\/OutlineTopComponent.java","additions":16,"deletions":36,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -1,94 +0,0 @@\n-\/*\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\n- *\/\n-\n-package com.sun.hotspot.igv.coordinator.actions;\n-\n-import com.sun.hotspot.igv.coordinator.FolderNode;\n-import com.sun.hotspot.igv.coordinator.OutlineTopComponent;\n-import com.sun.hotspot.igv.data.Folder;\n-import com.sun.hotspot.igv.data.GraphDocument;\n-import com.sun.hotspot.igv.data.Group;\n-import javax.swing.Action;\n-import org.openide.nodes.Node;\n-import org.openide.util.HelpCtx;\n-import org.openide.util.ImageUtilities;\n-import org.openide.util.NbBundle;\n-import org.openide.util.actions.NodeAction;\n-\n-\n-public final class ExportAction extends NodeAction {\n-\n-    public ExportAction() {\n-        putValue(Action.SHORT_DESCRIPTION, \"Export selected groups to XML file...\");\n-        putValue(Action.SMALL_ICON, ImageUtilities.loadImageIcon(iconResource(), true));\n-    }\n-\n-    @Override\n-    protected void performAction(Node[] activatedNodes) {\n-        GraphDocument doc = new GraphDocument();\n-        for (Node node : activatedNodes) {\n-            if (node instanceof FolderNode folderNode) {\n-                Folder folder = folderNode.getFolder();\n-                if (folder instanceof Group group) {\n-                    doc.addElement(group);\n-                }\n-            }\n-        }\n-\n-        OutlineTopComponent.exportToXML(doc);\n-    }\n-\n-    @Override\n-    public String getName() {\n-        return NbBundle.getMessage(ExportAction.class, \"CTL_ExportAction\");\n-    }\n-\n-    @Override\n-    protected String iconResource() {\n-        return \"com\/sun\/hotspot\/igv\/coordinator\/images\/export.png\";\n-    }\n-\n-    @Override\n-    public HelpCtx getHelpCtx() {\n-        return HelpCtx.DEFAULT_HELP;\n-    }\n-\n-    @Override\n-    protected boolean asynchronous() {\n-        return false;\n-    }\n-\n-    @Override\n-    protected boolean enable(Node[] nodes) {\n-        if (nodes.length > 0) {\n-            for (Node n : nodes) {\n-                if (!(n instanceof FolderNode) || ((FolderNode) n).isRootNode()) {\n-                    return false;\n-                }\n-            }\n-            return true;\n-        }\n-        return false;\n-    }\n-}\n","filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/java\/com\/sun\/hotspot\/igv\/coordinator\/actions\/ExportAction.java","additions":0,"deletions":94,"binary":false,"changes":94,"status":"deleted"},{"patch":"@@ -7,1 +7,0 @@\n-CTL_ExportAction=Export selected groups...\n","filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/resources\/com\/sun\/hotspot\/igv\/coordinator\/actions\/Bundle.properties","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/resources\/com\/sun\/hotspot\/igv\/coordinator\/images\/export.png","binary":true,"status":"deleted"},{"filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/resources\/com\/sun\/hotspot\/igv\/coordinator\/images\/import.png","binary":true,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-            <file name=\"com-sun-hotspot-igv-coordinator-actions-ExportAction.instance\"\/>\n@@ -80,4 +79,0 @@\n-            <file name=\"com-sun-hotspot-igv-coordinator-actions-ExportAction.shadow\">\n-                <attr name=\"originalFile\" stringvalue=\"Actions\/File\/com-sun-hotspot-igv-coordinator-actions-ExportAction.instance\"\/>\n-                <attr name=\"position\" intvalue=\"500\"\/>\n-            <\/file>\n@@ -119,1 +114,1 @@\n-            <file name=\"org-openide-actions-ExportAction.shadow_hidden\"\/>\n+            <file name=\"org-openide-actions-SaveAllAction.shadow_hidden\"\/>\n","filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/resources\/com\/sun\/hotspot\/igv\/coordinator\/layer.xml","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"}]}