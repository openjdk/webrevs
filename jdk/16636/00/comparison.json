{"files":[{"patch":"@@ -505,0 +505,15 @@\n+                    Window oppositeWindow = e.getOppositeWindow();\n+\n+                    \/\/ The focus can move between the window calling the popup,\n+                    \/\/ and the popup window itself.\n+                    \/\/ We only dismiss the popup in other cases.\n+                    if (oppositeWindow != null) {\n+                        if (window == oppositeWindow.getParent() ) {\n+                            addWaylandWindowFocusListenerToWindow(oppositeWindow);\n+                            return;\n+                        }\n+                        if (window.getParent() == oppositeWindow) {\n+                            return;\n+                        }\n+                    }\n+\n@@ -519,0 +534,9 @@\n+    private static void addWaylandWindowFocusListenerToWindow(Window window) {\n+        if (!Arrays\n+                .asList(window.getWindowFocusListeners())\n+                .contains(waylandWindowFocusListener)\n+        ) {\n+            window.addWindowFocusListener(waylandWindowFocusListener);\n+        }\n+    }\n+\n@@ -521,6 +545,1 @@\n-        if (!isOnWayland()\n-                || invoker == null\n-                || Arrays\n-                    .asList(invoker.getWindowFocusListeners())\n-                    .contains(waylandWindowFocusListener)\n-        ) {\n+        if (!isOnWayland() || invoker == null) {\n@@ -530,1 +549,1 @@\n-        invoker.addWindowFocusListener(waylandWindowFocusListener);\n+        addWaylandWindowFocusListenerToWindow(invoker);\n@@ -540,0 +559,3 @@\n+        for (Window ownedWindow : invoker.getOwnedWindows()) {\n+            ownedWindow.removeWindowFocusListener(waylandWindowFocusListener);\n+        }\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/UNIXToolkit.java","additions":29,"deletions":7,"binary":false,"changes":36,"status":"modified"}]}