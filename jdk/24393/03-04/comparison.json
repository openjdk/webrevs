{"files":[{"patch":"@@ -116,1 +116,0 @@\n-            KDF hkdf = KDF.getInstance(hashAlg.hkdfAlgorithm);\n@@ -121,0 +120,1 @@\n+                KDF hkdf = KDF.getInstance(hashAlg.hkdfAlgorithm);\n@@ -131,0 +131,1 @@\n+            KDF hkdf = KDF.getInstance(hashAlg.hkdfAlgorithm);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/KAKeyDerivation.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -840,1 +840,0 @@\n-            KDF hkdf = KDF.getInstance(hashAlg.hkdfAlgorithm);\n@@ -842,3 +841,0 @@\n-            earlySecret = hkdf.deriveKey(\"TlsEarlySecret\",\n-                    HKDFParameterSpec.ofExtract().addSalt(zeros).addIKM(psk)\n-                    .extractOnly());\n@@ -849,3 +845,5 @@\n-            return hkdf.deriveKey(\"TlsBinderKey\",\n-                    HKDFParameterSpec.expandOnly(earlySecret, hkdfInfo,\n-                    hashAlg.hashLength));\n+            KDF hkdf = KDF.getInstance(hashAlg.hkdfAlgorithm);\n+            HKDFParameterSpec spec = HKDFParameterSpec.ofExtract()\n+                    .addSalt(zeros).addIKM(psk)\n+                    .thenExpand(hkdfInfo, hashAlg.hashLength);\n+            return hkdf.deriveKey(\"TlsBinderKey\", spec);\n@@ -854,4 +852,0 @@\n-        } finally {\n-            if (earlySecret instanceof SecretKeySpec s) {\n-                SharedSecrets.getJavaxCryptoSpecAccess().clearSecretKeySpec(s);\n-            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/PreSharedKeyExtension.java","additions":5,"deletions":11,"binary":false,"changes":16,"status":"modified"}]}