{"files":[{"patch":"@@ -91,7 +91,16 @@\n-            HttpClient client = HttpClient.newBuilder().sslContext(sslContext).build();\n-            long start = System.currentTimeMillis();\n-            for (int i = 0; i < 1000; i++) {\n-                var uri = URIBuilder.newBuilder().scheme(scheme).loopback().port(server.getAddress().getPort()).path(\"\/test\").build();\n-                var response = client.send(HttpRequest.newBuilder(uri).build(), HttpResponse.BodyHandlers.ofString());\n-                if (!response.body().equals(\"hello\"))\n-                    throw new IllegalStateException(\"incorrect body \" + response.body());\n+            try (HttpClient client = HttpClient.newBuilder().sslContext(sslContext).build()) {\n+                long start = System.currentTimeMillis();\n+                for (int i = 0; i < 1000; i++) {\n+                    var uri = URIBuilder.newBuilder().scheme(scheme).loopback().port(server.getAddress().getPort()).path(\"\/test\").build();\n+                    var response = client.send(HttpRequest.newBuilder(uri).build(), HttpResponse.BodyHandlers.ofString());\n+                    if (!response.body().equals(\"hello\"))\n+                        throw new IllegalStateException(\"incorrect body \" + response.body());\n+                }\n+                for (int i = 0; i < 1000; i++) {\n+                    var uri = URIBuilder.newBuilder().scheme(scheme).loopback().port(server.getAddress().getPort()).path(\"\/chunked\").build();\n+                    var response = client.send(HttpRequest.newBuilder(uri).build(), HttpResponse.BodyHandlers.ofString());\n+                    if (!response.body().equals(\"hello\"))\n+                        throw new IllegalStateException(\"incorrect body \" + response.body());\n+                }\n+                long time = System.currentTimeMillis() - start;\n+                System.out.println(\"time \" + time);\n@@ -99,8 +108,0 @@\n-            for (int i = 0; i < 1000; i++) {\n-                var uri = URIBuilder.newBuilder().scheme(scheme).loopback().port(server.getAddress().getPort()).path(\"\/chunked\").build();\n-                var response = client.send(HttpRequest.newBuilder(uri).build(), HttpResponse.BodyHandlers.ofString());\n-                if (!response.body().equals(\"hello\"))\n-                    throw new IllegalStateException(\"incorrect body \" + response.body());\n-            }\n-            long time = System.currentTimeMillis() - start;\n-            System.out.println(\"time \" + time);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/TcpNoDelayNotRequired.java","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"}]}