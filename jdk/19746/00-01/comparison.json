{"files":[{"patch":"@@ -468,1 +468,0 @@\n-  int barriers = G1C2BarrierPre | G1C2BarrierPost;\n@@ -471,1 +470,1 @@\n-    return barriers;\n+    return G1C2BarrierPre | G1C2BarrierPost;\n@@ -478,3 +477,1 @@\n-  if (g1_can_remove_pre_barrier(kit, &kit->gvn(), adr, access.type(), adr_idx)) {\n-    barriers ^= G1C2BarrierPre;\n-  }\n+  bool can_remove_pre_barrier = g1_can_remove_pre_barrier(kit, &kit->gvn(), adr, access.type(), adr_idx);\n@@ -482,0 +479,1 @@\n+  bool can_remove_post_barrier = false;\n@@ -487,1 +485,1 @@\n-    barriers ^= G1C2BarrierPost;\n+    can_remove_post_barrier = true;\n@@ -493,1 +491,1 @@\n-    barriers ^= G1C2BarrierPost;\n+    can_remove_post_barrier = true;\n@@ -496,1 +494,9 @@\n-    barriers ^= G1C2BarrierPost;\n+    can_remove_post_barrier = true;\n+  }\n+\n+  int barriers = 0;\n+  if (!can_remove_pre_barrier) {\n+    barriers |= G1C2BarrierPre;\n+  }\n+  if (!can_remove_post_barrier) {\n+    barriers |= G1C2BarrierPost;\n","filename":"src\/hotspot\/share\/gc\/g1\/c2\/g1BarrierSetC2.cpp","additions":14,"deletions":8,"binary":false,"changes":22,"status":"modified"}]}