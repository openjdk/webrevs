{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,0 +35,1 @@\n+import java.awt.EventQueue;\n@@ -45,3 +46,26 @@\n-    public static void main(final String[] args) {\n-        ActivateFocusTest app = new ActivateFocusTest();\n-        app.doTest();\n+    private static final int NUM_FRAMES = 2;\n+    private static ActivateFocus[] af;\n+\n+    public static void main(final String[] args) throws Exception {\n+        try {\n+            ActivateFocusTest app = new ActivateFocusTest();\n+            EventQueue.invokeAndWait(() -> app.doTest());\n+\n+            Thread.sleep(1000);\n+            boolean testFailed = false;\n+            for (int i = 0; i < NUM_FRAMES; i++) {\n+                testFailed |= (af[i].lw.focusCounter > 1);\n+                System.out.println(\"testFailed \" + testFailed);\n+            }\n+            if (testFailed) {\n+                throw new RuntimeException(\"TEST FAILED - focus is gained more than one time\");\n+            } else {\n+                System.out.println(\"TEST PASSED\");\n+            }\n+        } finally {\n+            EventQueue.invokeAndWait(() -> {\n+                for (int i = 0; i < NUM_FRAMES; i++) {\n+                    af[i].dispose();\n+                }\n+            });\n+        }\n@@ -51,2 +75,1 @@\n-      ActivateFocus[] af = new ActivateFocus[2];\n-      boolean testFailed = false;\n+      af = new ActivateFocus[NUM_FRAMES];\n@@ -54,1 +77,1 @@\n-      for (int i = 0; i < 2; i++) {\n+      for (int i = 0; i < NUM_FRAMES; i++) {\n@@ -59,13 +82,0 @@\n-      try {\n-          Thread.sleep(5000);\n-      } catch (InterruptedException ie) {\n-          throw new RuntimeException(\"TEST FAILED - thread was interrupted\");\n-      }\n-      for (int i = 0; i < 2; i++) {\n-          testFailed = (af[i].lw.focusCounter > 1);\n-      }\n-      if (testFailed) {\n-          throw new RuntimeException(\"TEST FAILED - focus is gained more than one time\");\n-      } else {\n-          System.out.println(\"TEST PASSED\");\n-      }\n","filename":"test\/jdk\/java\/awt\/Focus\/ActivateFocusTest.java","additions":30,"deletions":20,"binary":false,"changes":50,"status":"modified"}]}