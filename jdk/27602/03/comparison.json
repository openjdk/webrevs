{"files":[{"patch":"@@ -29,0 +29,1 @@\n+#include \"logging\/logStream.hpp\"\n@@ -74,2 +75,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not commit PerfData memory\\n\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not commit PerfData memory\\n\");\n@@ -300,1 +302,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -302,1 +305,1 @@\n-        warning(\"directory %s is a symlink and is not secure\\n\", dirname);\n+        log.print_cr(\"directory %s is a symlink and is not secure\\n\", dirname);\n@@ -304,1 +307,1 @@\n-        warning(\"could not open directory %s: %s\\n\", dirname, os::strerror(errno));\n+        log.print_cr(\"could not open directory %s: %s\\n\", dirname, os::strerror(errno));\n@@ -374,2 +377,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not change to directory %s\", dirname);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not change to directory %s\", dirname);\n@@ -414,2 +418,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"fstat failed on %s: %s\\n\", filename, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"fstat failed on %s: %s\\n\", filename, os::strerror(errno));\n@@ -421,2 +426,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file %s has multiple links\\n\", filename);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file %s has multiple links\\n\", filename);\n@@ -450,1 +456,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -452,2 +459,1 @@\n-        warning(\"Could not retrieve passwd entry: %s\\n\",\n-                os::strerror(result));\n+        log.print_cr(\"Could not retrieve passwd entry: %s\\n\", os::strerror(result));\n@@ -466,2 +472,1 @@\n-        warning(\"Could not retrieve passwd entry: %s\\n\",\n-                os::strerror(errno));\n+        log.print_cr(\"Could not retrieve passwd entry: %s\\n\", os::strerror(errno));\n@@ -470,3 +475,2 @@\n-        warning(\"Could not determine user name: %s\\n\",\n-                p->pw_name == nullptr ? \"pw_name = null\" :\n-                                     \"pw_name zero length\");\n+        log.print_cr(\"Could not determine user name: %s\\n\",\n+                p->pw_name == nullptr ? \"pw_name = null\" : \"pw_name zero length\");\n@@ -683,1 +687,2 @@\n-  if (PrintMiscellaneous && Verbose && result == OS_ERR) {\n+  if (log_is_enabled(Debug, perf) && result == OS_ERR) {\n+    LogStreamHandle(Debug, perf) log;\n@@ -685,2 +690,2 @@\n-      warning(\"Could not unlink shared memory backing\"\n-              \" store file %s : %s\\n\", path, os::strerror(errno));\n+      log.print_cr(\"Could not unlink shared memory backing\"\n+                   \" store file %s : %s\\n\", path, os::strerror(errno));\n@@ -822,1 +827,0 @@\n-      \/\/\n@@ -825,2 +829,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"%s directory is insecure\\n\", dirname);\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"%s directory is insecure\\n\", dirname);\n@@ -834,4 +839,3 @@\n-      \/\/\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not create directory %s: %s\\n\",\n-                dirname, os::strerror(errno));\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not create directory %s: %s\\n\", dirname, os::strerror(errno));\n@@ -875,1 +879,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -877,1 +882,1 @@\n-        warning(\"file %s is a symlink and is not secure\\n\", filename);\n+        log.print_cr(\"file %s is a symlink and is not secure\\n\", filename);\n@@ -879,1 +884,1 @@\n-        warning(\"could not create file %s: %s\\n\", filename, os::strerror(errno));\n+        log.print_cr(\"could not create file %s: %s\\n\", filename, os::strerror(errno));\n@@ -927,2 +932,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not truncate shared memory file: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not truncate shared memory file: %s\\n\", os::strerror(errno));\n@@ -936,2 +942,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not set shared memory file size: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not set shared memory file size: %s\\n\", os::strerror(errno));\n@@ -1060,2 +1067,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"mmap failed -  %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"mmap failed -  %s\\n\", os::strerror(errno));\n@@ -1138,2 +1146,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"fstat failed: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"fstat failed: %s\\n\", os::strerror(errno));\n@@ -1215,2 +1224,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"mmap failed: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"mmap failed: %s\\n\", os::strerror(errno));\n@@ -1247,1 +1257,0 @@\n-\n@@ -1250,3 +1259,3 @@\n-      \/\/\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Reverting to non-shared PerfMemory region.\\n\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Reverting to non-shared PerfMemory region.\\n\");\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":55,"deletions":46,"binary":false,"changes":101,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"logging\/logStream.hpp\"\n@@ -65,2 +66,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not commit PerfData memory\\n\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not commit PerfData memory\\n\");\n@@ -99,3 +101,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not create Perfdata save file: %s: %s\\n\",\n-              destfile, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not create Perfdata save file: %s: %s\\n\",\n+                   destfile, os::strerror(errno));\n@@ -108,3 +111,4 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"Could not write Perfdata save file: %s: %s\\n\",\n-                  destfile, os::strerror(errno));\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"Could not write Perfdata save file: %s: %s\\n\",\n+                       destfile, os::strerror(errno));\n@@ -120,3 +124,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      if (result == OS_ERR) {\n-        warning(\"Could not close %s: %s\\n\", destfile, os::strerror(errno));\n+    if (result == OS_ERR) {\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not close %s: %s\\n\", destfile, os::strerror(errno));\n@@ -223,3 +228,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not get attributes for file %s: \"\n-                \" lasterror = %d\\n\", path, lasterror);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not get attributes for file %s: \"\n+                     \" lasterror = %d\\n\", path, lasterror);\n@@ -237,2 +243,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"%s is a reparse point\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"%s is a reparse point\\n\", path);\n@@ -256,3 +263,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"%s is not a directory, file attributes = \"\n-              INTPTR_FORMAT \"\\n\", path, fa);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"%s is not a directory, file attributes = \"\n+                   INTPTR_FORMAT \"\\n\", path, fa);\n@@ -495,4 +503,5 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      if (errno != ENOENT) {\n-        warning(\"Could not unlink shared memory backing\"\n-                \" store file %s : %s\\n\", path, os::strerror(errno));\n+    if (errno != ENOENT) {\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not unlink shared memory backing\"\n+                     \" store file %s : %s\\n\", path, os::strerror(errno));\n@@ -518,1 +527,1 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n@@ -521,1 +530,2 @@\n-        warning(\"OpenProcess failed: %d\\n\", GetLastError());\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"OpenProcess failed: %d\\n\", GetLastError());\n@@ -529,2 +539,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetExitCodeProcess failed: %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetExitCodeProcess failed: %d\\n\", GetLastError());\n@@ -548,2 +559,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"bypassing file system criteria checks for %s\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"bypassing file system criteria checks for %s\\n\", path);\n@@ -556,2 +568,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"expected device specifier in path: %s\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"expected device specifier in path: %s\\n\", path);\n@@ -579,4 +592,5 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not get device information for %s: \"\n-              \" path = %s: lasterror = %d\\n\",\n-              root_path, path, GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not get device information for %s: \"\n+                   \" path = %s: lasterror = %d\\n\",\n+                   root_path, path, GetLastError());\n@@ -589,3 +603,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file system type %s on device %s does not support\"\n-              \" ACLs\\n\", fs_type, root_path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file system type %s on device %s does not support\"\n+                   \" ACLs\\n\", fs_type, root_path);\n@@ -598,3 +613,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file system type %s on device %s is compressed\\n\",\n-              fs_type, root_path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file system type %s on device %s is compressed\\n\",\n+                   fs_type, root_path);\n@@ -707,2 +723,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"CreateFileMapping failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"CreateFileMapping failed, lasterror = %d\\n\", GetLastError());\n@@ -720,2 +737,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file mapping already exists, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file mapping already exists, lasterror = %d\\n\", GetLastError());\n@@ -786,2 +804,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"OpenProcessToken failure: lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"OpenProcessToken failure: lasterror = %d \\n\", GetLastError());\n@@ -798,3 +817,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"GetTokenInformation failure: lasterror = %d,\"\n-                \" rsize = %d\\n\", lasterror, rsize);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                     \" rsize = %d\\n\", lasterror, rsize);\n@@ -811,3 +831,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetTokenInformation failure: lasterror = %d,\"\n-              \" rsize = %d\\n\", GetLastError(), rsize);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                   \" rsize = %d\\n\", GetLastError(), rsize);\n@@ -824,3 +845,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetTokenInformation failure: lasterror = %d,\"\n-              \" rsize = %d\\n\", GetLastError(), rsize);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                   \" rsize = %d\\n\", GetLastError(), rsize);\n@@ -869,3 +891,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetSecurityDescriptor failure: lasterror = %d \\n\",\n-              GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetSecurityDescriptor failure: lasterror = %d \\n\",\n+                   GetLastError());\n@@ -889,2 +912,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"GetAclInformation failure: lasterror = %d \\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"GetAclInformation failure: lasterror = %d \\n\", GetLastError());\n@@ -917,2 +941,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -930,2 +955,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -957,2 +983,3 @@\n-          if (PrintMiscellaneous && Verbose) {\n-            warning(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n+          if (log_is_enabled(Debug, perf)) {\n+            LogStreamHandle(Debug, perf) log;\n+            log.print_cr(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n@@ -972,3 +999,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"AddAccessAllowedAce failure: lasterror = %d \\n\",\n-                GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"AddAccessAllowedAce failure: lasterror = %d \\n\",\n+                     GetLastError());\n@@ -988,2 +1016,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -996,2 +1025,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n@@ -1008,3 +1038,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"SetSecurityDescriptorDacl failure:\"\n-              \" lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"SetSecurityDescriptorDacl failure:\"\n+                   \" lasterror = %d \\n\", GetLastError());\n@@ -1028,3 +1059,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"SetSecurityDescriptorControl failure:\"\n-                \" lasterror = %d \\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"SetSecurityDescriptorControl failure:\"\n+                     \" lasterror = %d \\n\", GetLastError());\n@@ -1060,3 +1092,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"InitializeSecurityDescriptor failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"InitializeSecurityDescriptor failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1117,3 +1150,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"AllocateAndInitializeSid failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"AllocateAndInitializeSid failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1135,3 +1169,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"AllocateAndInitializeSid failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"AllocateAndInitializeSid failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1239,2 +1274,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"%s directory is insecure\\n\", dirname);\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"%s directory is insecure\\n\", dirname);\n@@ -1252,1 +1288,1 @@\n-        if (PrintMiscellaneous && Verbose) {\n+        if (log_is_enabled(Debug, perf)) {\n@@ -1254,1 +1290,2 @@\n-          warning(\"SetFileSecurity failed for %s directory.  lasterror %d \\n\",\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"SetFileSecurity failed for %s directory.  lasterror %d \\n\",\n@@ -1259,2 +1296,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"CreateDirectory failed: %d\\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"CreateDirectory failed: %d\\n\", GetLastError());\n@@ -1328,2 +1366,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not create file %s: %d\\n\", filename, lasterror);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not create file %s: %d\\n\", filename, lasterror);\n@@ -1356,3 +1395,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Could not get status information from file %s: %s\\n\",\n-            filename, os::strerror(errno));\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not get status information from file %s: %s\\n\",\n+                     filename, os::strerror(errno));\n@@ -1372,2 +1412,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not flush file %s: %d\\n\", filename, lasterror);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not flush file %s: %d\\n\", filename, lasterror);\n@@ -1405,3 +1446,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"OpenFileMapping failed for shared memory object %s:\"\n-              \" lasterror = %d\\n\", objectname, lasterror);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"OpenFileMapping failed for shared memory object %s:\"\n+                   \" lasterror = %d\\n\", objectname, lasterror);\n@@ -1488,2 +1530,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n@@ -1554,2 +1597,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"stat %s failed: %s\\n\", filename, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"stat %s failed: %s\\n\", filename, os::strerror(errno));\n@@ -1562,3 +1606,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"unexpected file size: size = %zu\\n\",\n-              statbuf.st_size);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"unexpected file size: size = %zu\\n\", statbuf.st_size);\n@@ -1566,2 +1610,1 @@\n-    THROW_MSG_0(vmSymbols::java_io_IOException(),\n-                \"Invalid PerfMemory size\");\n+    THROW_MSG_0(vmSymbols::java_io_IOException(), \"Invalid PerfMemory size\");\n@@ -1640,2 +1683,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n@@ -1711,2 +1755,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Reverting to non-shared PerfMemory region.\\n\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Reverting to non-shared PerfMemory region.\\n\");\n","filename":"src\/hotspot\/os\/windows\/perfMemory_windows.cpp","additions":163,"deletions":118,"binary":false,"changes":281,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"logging\/logStream.hpp\"\n@@ -117,2 +118,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not create PerfData Memory region, reverting to malloc\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not create PerfData Memory region, reverting to malloc\");\n@@ -253,3 +255,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Invalid performance data file path name specified, \"\\\n-                \"fall back to a default name\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Invalid performance data file path name specified, \"\\\n+                     \"fall back to a default name\");\n","filename":"src\/hotspot\/share\/runtime\/perfMemory.cpp","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"}]}