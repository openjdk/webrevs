{"files":[{"patch":"@@ -74,2 +74,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not commit PerfData memory\\n\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not commit PerfData memory\\n\");\n@@ -300,1 +301,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -302,1 +304,1 @@\n-        warning(\"directory %s is a symlink and is not secure\\n\", dirname);\n+        log.print_cr(\"directory %s is a symlink and is not secure\\n\", dirname);\n@@ -304,1 +306,1 @@\n-        warning(\"could not open directory %s: %s\\n\", dirname, os::strerror(errno));\n+        log.print_cr(\"could not open directory %s: %s\\n\", dirname, os::strerror(errno));\n@@ -374,2 +376,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not change to directory %s\", dirname);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not change to directory %s\", dirname);\n@@ -414,2 +417,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"fstat failed on %s: %s\\n\", filename, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"fstat failed on %s: %s\\n\", filename, os::strerror(errno));\n@@ -421,2 +425,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file %s has multiple links\\n\", filename);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file %s has multiple links\\n\", filename);\n@@ -450,1 +455,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -452,2 +458,1 @@\n-        warning(\"Could not retrieve passwd entry: %s\\n\",\n-                os::strerror(result));\n+        log.print_cr(\"Could not retrieve passwd entry: %s\\n\", os::strerror(result));\n@@ -466,2 +471,1 @@\n-        warning(\"Could not retrieve passwd entry: %s\\n\",\n-                os::strerror(errno));\n+        log.print_cr(\"Could not retrieve passwd entry: %s\\n\", os::strerror(errno));\n@@ -470,3 +474,2 @@\n-        warning(\"Could not determine user name: %s\\n\",\n-                p->pw_name == nullptr ? \"pw_name = null\" :\n-                                     \"pw_name zero length\");\n+        log.print_cr(\"Could not determine user name: %s\\n\",\n+                p->pw_name == nullptr ? \"pw_name = null\" : \"pw_name zero length\");\n@@ -683,1 +686,2 @@\n-  if (PrintMiscellaneous && Verbose && result == OS_ERR) {\n+  if (log_is_enabled(Debug, perf) && result == OS_ERR) {\n+    LogStreamHandle(Debug, perf) log;\n@@ -685,2 +689,2 @@\n-      warning(\"Could not unlink shared memory backing\"\n-              \" store file %s : %s\\n\", path, os::strerror(errno));\n+      log.print_cr(\"Could not unlink shared memory backing\"\n+                   \" store file %s : %s\\n\", path, os::strerror(errno));\n@@ -822,1 +826,0 @@\n-      \/\/\n@@ -825,2 +828,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"%s directory is insecure\\n\", dirname);\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"%s directory is insecure\\n\", dirname);\n@@ -834,4 +838,3 @@\n-      \/\/\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not create directory %s: %s\\n\",\n-                dirname, os::strerror(errno));\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not create directory %s: %s\\n\", dirname, os::strerror(errno));\n@@ -875,1 +878,2 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n@@ -877,1 +881,1 @@\n-        warning(\"file %s is a symlink and is not secure\\n\", filename);\n+        log.print_cr(\"file %s is a symlink and is not secure\\n\", filename);\n@@ -879,1 +883,1 @@\n-        warning(\"could not create file %s: %s\\n\", filename, os::strerror(errno));\n+        log.print_cr(\"could not create file %s: %s\\n\", filename, os::strerror(errno));\n@@ -927,2 +931,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not truncate shared memory file: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not truncate shared memory file: %s\\n\", os::strerror(errno));\n@@ -936,2 +941,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not set shared memory file size: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not set shared memory file size: %s\\n\", os::strerror(errno));\n@@ -1060,2 +1066,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"mmap failed -  %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"mmap failed -  %s\\n\", os::strerror(errno));\n@@ -1138,2 +1145,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"fstat failed: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"fstat failed: %s\\n\", os::strerror(errno));\n@@ -1215,2 +1223,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"mmap failed: %s\\n\", os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"mmap failed: %s\\n\", os::strerror(errno));\n@@ -1247,1 +1256,0 @@\n-\n@@ -1250,3 +1258,3 @@\n-      \/\/\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Reverting to non-shared PerfMemory region.\\n\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Reverting to non-shared PerfMemory region.\\n\");\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":54,"deletions":46,"binary":false,"changes":100,"status":"modified"},{"patch":"@@ -65,2 +65,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not commit PerfData memory\\n\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not commit PerfData memory\\n\");\n@@ -99,3 +100,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not create Perfdata save file: %s: %s\\n\",\n-              destfile, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not create Perfdata save file: %s: %s\\n\",\n+                   destfile, os::strerror(errno));\n@@ -108,3 +110,4 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"Could not write Perfdata save file: %s: %s\\n\",\n-                  destfile, os::strerror(errno));\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"Could not write Perfdata save file: %s: %s\\n\",\n+                       destfile, os::strerror(errno));\n@@ -120,3 +123,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      if (result == OS_ERR) {\n-        warning(\"Could not close %s: %s\\n\", destfile, os::strerror(errno));\n+    if (result == OS_ERR) {\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not close %s: %s\\n\", destfile, os::strerror(errno));\n@@ -223,3 +227,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not get attributes for file %s: \"\n-                \" lasterror = %d\\n\", path, lasterror);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not get attributes for file %s: \"\n+                     \" lasterror = %d\\n\", path, lasterror);\n@@ -237,2 +242,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"%s is a reparse point\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"%s is a reparse point\\n\", path);\n@@ -256,3 +262,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"%s is not a directory, file attributes = \"\n-              INTPTR_FORMAT \"\\n\", path, fa);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"%s is not a directory, file attributes = \"\n+                   INTPTR_FORMAT \"\\n\", path, fa);\n@@ -495,4 +502,5 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      if (errno != ENOENT) {\n-        warning(\"Could not unlink shared memory backing\"\n-                \" store file %s : %s\\n\", path, os::strerror(errno));\n+    if (errno != ENOENT) {\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not unlink shared memory backing\"\n+                     \" store file %s : %s\\n\", path, os::strerror(errno));\n@@ -518,1 +526,1 @@\n-    if (PrintMiscellaneous && Verbose) {\n+    if (log_is_enabled(Debug, perf)) {\n@@ -521,1 +529,2 @@\n-        warning(\"OpenProcess failed: %d\\n\", GetLastError());\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"OpenProcess failed: %d\\n\", GetLastError());\n@@ -529,2 +538,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetExitCodeProcess failed: %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetExitCodeProcess failed: %d\\n\", GetLastError());\n@@ -548,2 +558,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"bypassing file system criteria checks for %s\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"bypassing file system criteria checks for %s\\n\", path);\n@@ -556,2 +567,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"expected device specifier in path: %s\\n\", path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"expected device specifier in path: %s\\n\", path);\n@@ -579,4 +591,5 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not get device information for %s: \"\n-              \" path = %s: lasterror = %d\\n\",\n-              root_path, path, GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not get device information for %s: \"\n+                   \" path = %s: lasterror = %d\\n\",\n+                   root_path, path, GetLastError());\n@@ -589,3 +602,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file system type %s on device %s does not support\"\n-              \" ACLs\\n\", fs_type, root_path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file system type %s on device %s does not support\"\n+                   \" ACLs\\n\", fs_type, root_path);\n@@ -598,3 +612,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file system type %s on device %s is compressed\\n\",\n-              fs_type, root_path);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file system type %s on device %s is compressed\\n\",\n+                   fs_type, root_path);\n@@ -707,2 +722,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"CreateFileMapping failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"CreateFileMapping failed, lasterror = %d\\n\", GetLastError());\n@@ -720,2 +736,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"file mapping already exists, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"file mapping already exists, lasterror = %d\\n\", GetLastError());\n@@ -786,2 +803,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"OpenProcessToken failure: lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"OpenProcessToken failure: lasterror = %d \\n\", GetLastError());\n@@ -798,3 +816,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"GetTokenInformation failure: lasterror = %d,\"\n-                \" rsize = %d\\n\", lasterror, rsize);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                     \" rsize = %d\\n\", lasterror, rsize);\n@@ -811,3 +830,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetTokenInformation failure: lasterror = %d,\"\n-              \" rsize = %d\\n\", GetLastError(), rsize);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                   \" rsize = %d\\n\", GetLastError(), rsize);\n@@ -824,3 +844,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetTokenInformation failure: lasterror = %d,\"\n-              \" rsize = %d\\n\", GetLastError(), rsize);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetTokenInformation failure: lasterror = %d,\"\n+                   \" rsize = %d\\n\", GetLastError(), rsize);\n@@ -869,3 +890,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"GetSecurityDescriptor failure: lasterror = %d \\n\",\n-              GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"GetSecurityDescriptor failure: lasterror = %d \\n\",\n+                   GetLastError());\n@@ -889,2 +911,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"GetAclInformation failure: lasterror = %d \\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"GetAclInformation failure: lasterror = %d \\n\", GetLastError());\n@@ -917,2 +940,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -930,2 +954,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -957,2 +982,3 @@\n-          if (PrintMiscellaneous && Verbose) {\n-            warning(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n+          if (log_is_enabled(Debug, perf)) {\n+            LogStreamHandle(Debug, perf) log;\n+            log.print_cr(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n@@ -972,3 +998,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"AddAccessAllowedAce failure: lasterror = %d \\n\",\n-                GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"AddAccessAllowedAce failure: lasterror = %d \\n\",\n+                     GetLastError());\n@@ -988,2 +1015,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"InitializeAcl failure: lasterror = %d \\n\", GetLastError());\n@@ -996,2 +1024,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"AddAce failure: lasterror = %d \\n\", GetLastError());\n@@ -1008,3 +1037,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"SetSecurityDescriptorDacl failure:\"\n-              \" lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"SetSecurityDescriptorDacl failure:\"\n+                   \" lasterror = %d \\n\", GetLastError());\n@@ -1028,3 +1058,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"SetSecurityDescriptorControl failure:\"\n-                \" lasterror = %d \\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"SetSecurityDescriptorControl failure:\"\n+                     \" lasterror = %d \\n\", GetLastError());\n@@ -1060,3 +1091,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"InitializeSecurityDescriptor failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"InitializeSecurityDescriptor failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1117,3 +1149,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"AllocateAndInitializeSid failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"AllocateAndInitializeSid failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1135,3 +1168,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"AllocateAndInitializeSid failure: \"\n-              \"lasterror = %d \\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"AllocateAndInitializeSid failure: \"\n+                   \"lasterror = %d \\n\", GetLastError());\n@@ -1239,2 +1273,3 @@\n-        if (PrintMiscellaneous && Verbose) {\n-          warning(\"%s directory is insecure\\n\", dirname);\n+        if (log_is_enabled(Debug, perf)) {\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"%s directory is insecure\\n\", dirname);\n@@ -1252,1 +1287,1 @@\n-        if (PrintMiscellaneous && Verbose) {\n+        if (log_is_enabled(Debug, perf)) {\n@@ -1254,1 +1289,2 @@\n-          warning(\"SetFileSecurity failed for %s directory.  lasterror %d \\n\",\n+          LogStreamHandle(Debug, perf) log;\n+          log.print_cr(\"SetFileSecurity failed for %s directory.  lasterror %d \\n\",\n@@ -1259,2 +1295,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"CreateDirectory failed: %d\\n\", GetLastError());\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"CreateDirectory failed: %d\\n\", GetLastError());\n@@ -1328,2 +1365,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"could not create file %s: %d\\n\", filename, lasterror);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"could not create file %s: %d\\n\", filename, lasterror);\n@@ -1356,3 +1394,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Could not get status information from file %s: %s\\n\",\n-            filename, os::strerror(errno));\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Could not get status information from file %s: %s\\n\",\n+                     filename, os::strerror(errno));\n@@ -1372,2 +1411,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"could not flush file %s: %d\\n\", filename, lasterror);\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"could not flush file %s: %d\\n\", filename, lasterror);\n@@ -1405,3 +1445,4 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"OpenFileMapping failed for shared memory object %s:\"\n-              \" lasterror = %d\\n\", objectname, lasterror);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"OpenFileMapping failed for shared memory object %s:\"\n+                   \" lasterror = %d\\n\", objectname, lasterror);\n@@ -1488,2 +1529,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n@@ -1554,2 +1596,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"stat %s failed: %s\\n\", filename, os::strerror(errno));\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"stat %s failed: %s\\n\", filename, os::strerror(errno));\n@@ -1562,3 +1605,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"unexpected file size: size = %zu\\n\",\n-              statbuf.st_size);\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"unexpected file size: size = %zu\\n\", statbuf.st_size);\n@@ -1566,2 +1609,1 @@\n-    THROW_MSG_0(vmSymbols::java_io_IOException(),\n-                \"Invalid PerfMemory size\");\n+    THROW_MSG_0(vmSymbols::java_io_IOException(), \"Invalid PerfMemory size\");\n@@ -1640,2 +1682,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"MapViewOfFile failed, lasterror = %d\\n\", GetLastError());\n@@ -1711,2 +1754,3 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Reverting to non-shared PerfMemory region.\\n\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Reverting to non-shared PerfMemory region.\\n\");\n","filename":"src\/hotspot\/os\/windows\/perfMemory_windows.cpp","additions":162,"deletions":118,"binary":false,"changes":280,"status":"modified"},{"patch":"@@ -117,2 +117,3 @@\n-    if (PrintMiscellaneous && Verbose) {\n-      warning(\"Could not create PerfData Memory region, reverting to malloc\");\n+    if (log_is_enabled(Debug, perf)) {\n+      LogStreamHandle(Debug, perf) log;\n+      log.print_cr(\"Could not create PerfData Memory region, reverting to malloc\");\n@@ -253,3 +254,4 @@\n-      if (PrintMiscellaneous && Verbose) {\n-        warning(\"Invalid performance data file path name specified, \"\\\n-                \"fall back to a default name\");\n+      if (log_is_enabled(Debug, perf)) {\n+        LogStreamHandle(Debug, perf) log;\n+        log.print_cr(\"Invalid performance data file path name specified, \"\\\n+                     \"fall back to a default name\");\n","filename":"src\/hotspot\/share\/runtime\/perfMemory.cpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"}]}