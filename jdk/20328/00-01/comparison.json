{"files":[{"patch":"@@ -54,0 +54,14 @@\n+        \/\/ OldObjectSample is emitted at the end of the recording, and we need\n+        \/\/ to let GC catch up before we do the event. There is no reason to wait\n+        \/\/ for a long time if GC can manage it quickly. Try a few backoff intervals,\n+        \/\/ but try to complete as fast as possible.\n+        for (int power = 0; power < 13; power++) {\n+            if (tryWith(1 << power)) {\n+                return;\n+            }\n+        }\n+\n+        Asserts.fail(\"Could not find old object with field 'testField'\");\n+    }\n+\n+    public static boolean tryWith(int backoff) throws Exception {\n@@ -60,2 +74,1 @@\n-            \/\/ Let GC catch up before we stop the recording and do the old object sample\n-            Thread.sleep(5000);\n+            Thread.sleep(backoff);\n@@ -66,1 +79,0 @@\n-            Events.hasEvents(events);\n@@ -69,1 +81,1 @@\n-                    return;\n+                    return true;\n@@ -72,2 +84,1 @@\n-            System.out.println(events);\n-            Asserts.fail(\"Could not find old object with field 'testField'\");\n+            return false;\n","filename":"test\/jdk\/jdk\/jfr\/event\/oldobject\/TestFieldInformation.java","additions":17,"deletions":6,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import jdk.test.lib.Asserts;\n@@ -77,0 +78,15 @@\n+\n+        \/\/ OldObjectSample is emitted at the end of the recording, and we need\n+        \/\/ to let GC catch up before we do the event. There is no reason to wait\n+        \/\/ for a long time if GC can manage it quickly. Try a few backoff intervals,\n+        \/\/ but try to complete as fast as possible.\n+        for (int power = 0; power < 13; power++) {\n+            if (tryWith(1 << power)) {\n+                return;\n+            }\n+        }\n+\n+        Asserts.fail(\"No events\");\n+    }\n+\n+    public static boolean tryWith(int backoff) throws Exception {\n@@ -89,2 +105,1 @@\n-            \/\/ Let GC catch up before we stop the recording and do the old object sample\n-            Thread.sleep(5000);\n+            Thread.sleep(backoff);\n@@ -94,1 +109,0 @@\n-            Events.hasEvents(events);\n@@ -98,1 +112,1 @@\n-                    return;\n+                    return true;\n@@ -102,0 +116,2 @@\n+\n+        return false;\n","filename":"test\/jdk\/jdk\/jfr\/event\/oldobject\/TestLargeRootSet.java","additions":20,"deletions":4,"binary":false,"changes":24,"status":"modified"}]}