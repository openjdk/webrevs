{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,0 +26,2 @@\n+import java.io.FileWriter;\n+import java.io.IOException;\n@@ -27,0 +29,2 @@\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n@@ -30,0 +34,3 @@\n+    static final String STYLE_SHEET_FILENAME = \"failure-handler-style.css\";\n+    static final String SCRIPT_FILENAME = \"failure-handler-script.js\";\n+\n@@ -33,3 +40,26 @@\n-    public HtmlPage(PrintWriter writer) {\n-        Objects.requireNonNull(writer, \"writer cannot be null\");\n-        this.writer = writer;\n+    \/**\n+     * Constructs a {@code HtmlPage}\n+     *\n+     * @param dir          The directory into which the HTML file and related resources will be created\n+     * @param htmlFileName The HTML file name\n+     * @param append       if {@code true} then the content will be appended to the file represented\n+     *                     by the {@code htmlFileName}, else the {@code htmlFileName} will be overwritten\n+     *                     with the new content\n+     * @throws IllegalArgumentException if {@code dir} is not a directory or if the\n+     *                                  {@code htmlFileName} is {@linkplain String#isBlank() blank}\n+     * @throws IOException if there is an error constructing file resource(s) for this HTML page\n+     *\/\n+    public HtmlPage(final Path dir, final String htmlFileName, final boolean append)\n+            throws IOException {\n+        Objects.requireNonNull(dir, \"directory cannot be null\");\n+        Objects.requireNonNull(htmlFileName, \"HTML file name cannot be null\");\n+        if (!Files.isDirectory(dir)) {\n+            throw new IllegalArgumentException(dir + \" is not a directory\");\n+        }\n+        if (htmlFileName.isBlank()) {\n+            throw new IllegalArgumentException(\"HTML file name cannot be blank\");\n+        }\n+        final FileWriter fileWriter = new FileWriter(dir.resolve(htmlFileName).toFile(), append);\n+        this.writer = new PrintWriter(fileWriter, true);\n+        createScriptFile(dir);\n+        createStyleSheetFile(dir);\n@@ -39,0 +69,1 @@\n+\n@@ -47,0 +78,61 @@\n+\n+    private static void createStyleSheetFile(final Path destDir) throws IOException {\n+        final Path styleSheet = destDir.resolve(STYLE_SHEET_FILENAME);\n+        final String content = \"\"\"\n+                div { display:none;}\n+                \"\"\";\n+        Files.writeString(styleSheet, content);\n+    }\n+\n+    private static void createScriptFile(final Path destDir) throws IOException {\n+        final Path script = destDir.resolve(SCRIPT_FILENAME);\n+        final String content = \"\"\"\n+                function doShow(e) {\n+                  while (e != null) {\n+                    if (e.tagName == 'DIV') {\n+                      e.style.display = 'block';\n+                    }\n+                    e = e.parentNode;\n+                  }\n+                }\n+\n+                function showHandler(event) {\n+                  elementId = this.dataset.show;\n+                  elementToShow = document.getElementById(elementId);\n+                  doShow(elementToShow);\n+                }\n+\n+                function toggleHandler(event) {\n+                  toggleElementId = this.dataset.toggle;\n+                  elementToToggle = document.getElementById(toggleElementId);\n+                  d = elementToToggle.style.display;\n+                  if (d == 'block') {\n+                    elementToToggle.style.display = 'none';\n+                  } else {\n+                    doShow(elementToToggle);\n+                  }\n+                }\n+\n+                function bodyLoadHandler() {\n+                  const index = location.href.indexOf(\"#\");\n+                  if (index != -1) {\n+                    doShow(document.getElementById(location.href.substring(index + 1)));\n+                  }\n+                  \/\/ elements that require the \"toggleHandler\" function to be registered\n+                  \/\/ as an event handler for the onclick event\n+                  const requiringToggleHandler = document.querySelectorAll(\"[data-toggle]\");\n+                  for (const e of requiringToggleHandler) {\n+                    e.addEventListener(\"click\", toggleHandler);\n+                  }\n+                  \/\/ elements that require the \"showHandler\" function to be registered\n+                  \/\/ as an event handler for the onclick event\n+                  const requiringShowHandler = document.querySelectorAll(\"[data-show]\");\n+                  for (const e of requiringShowHandler) {\n+                    e.addEventListener(\"click\", showHandler);\n+                  }\n+                }\n+                \/\/ register a onload event handler\n+                window.addEventListener(\"DOMContentLoaded\", bodyLoadHandler);\n+                \"\"\";\n+        Files.writeString(script, content);\n+    }\n","filename":"test\/failure_handler\/src\/share\/classes\/jdk\/test\/failurehandler\/HtmlPage.java","additions":96,"deletions":4,"binary":false,"changes":100,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -60,35 +60,9 @@\n-            this.pw.println(\"<style>\\n\"\n-                    + \"div { display:none;}\\n\"\n-                    + \"<\/style>\\n\"\n-                    + \"\\n\"\n-                    + \"<script>\\n\"\n-                    + \"function show(e) {\\n\"\n-                    + \"  while (e != null) {\\n\"\n-                    + \"    if (e.tagName == 'DIV') {\\n\"\n-                    + \"      e.style.display = 'block';\\n\"\n-                    + \"    }\\n\"\n-                    + \"    e = e.parentNode;\\n\"\n-                    + \"  }\\n\"\n-                    + \"}\\n\"\n-                    + \"\\n\"\n-                    + \"function toggle(id) {\\n\"\n-                    + \"  e = document.getElementById(id);\\n\"\n-                    + \"  d = e.style.display;\\n\"\n-                    + \"  if (d == 'block') {\\n\"\n-                    + \"    e.style.display = 'none';\\n\"\n-                    + \"  } else {\\n\"\n-                    + \"    show(e);\\n\"\n-                    + \"  }\\n\"\n-                    + \"}\\n\"\n-                    + \"\\n\"\n-                    + \"function main() {\\n\"\n-                    + \"  index = location.href.indexOf(\\\"#\\\");\"\n-                    + \"  if (index != -1) {\\n\"\n-                    + \"    show(document.getElementById(location.href.substring(index + 1)));\\n\"\n-                    + \"  }\\n\"\n-                    + \"}\\n\"\n-                    + \"\\n\"\n-                    + \"<\/script>\\n\"\n-                    + \"<\/head>\");\n-\n-            this.pw.println(\"<body onload='main()'>\");\n+\n+            this.pw.println(\"<head>\");\n+            this.pw.println(\n+                    \"<link href=\\\"\" + HtmlPage.STYLE_SHEET_FILENAME + \"\\\" rel=\\\"stylesheet\\\" type=\\\"text\/css\\\" \/>\");\n+            this.pw.println(\n+                    \"<script src=\\\"\" + HtmlPage.SCRIPT_FILENAME + \"\\\" type=\\\"text\/javascript\\\" ><\/script>\");\n+            this.pw.println(\"<\/head>\");\n+\n+            this.pw.println(\"<body>\");\n@@ -149,1 +123,1 @@\n-        pw.printf(\"<a href=\\\"#%1$s\\\" onclick=\\\"show(document.getElementById('%1$s')); return true;\\\">%2$s<\/a>%n\",\n+        pw.printf(\"<a href=\\\"#%1$s\\\" data-show=\\\"%1$s\\\" >%2$s<\/a>%n\",\n@@ -191,1 +165,1 @@\n-            pw.printf(\"<li><a name='%1$s'\/><a href='#%1$s' onclick=\\\"toggle('%1$s'); return false;\\\">%2$s<\/a><div id='%1$s'><code><pre>\",\n+            pw.printf(\"<li><a name='%1$s'\/><a href='#%1$s' data-toggle=\\\"%1$s\\\" >%2$s<\/a><div id='%1$s'><code><pre>\",\n","filename":"test\/failure_handler\/src\/share\/classes\/jdk\/test\/failurehandler\/HtmlSection.java","additions":12,"deletions":38,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -108,3 +108,1 @@\n-        File output = workDir.resolve(CORES_OUTPUT).toFile();\n-        try (HtmlPage html = new HtmlPage(new PrintWriter(\n-                new FileWriter(output, true), true))) {\n+        try (HtmlPage html = new HtmlPage(workDir, CORES_OUTPUT, true)) {\n@@ -124,3 +122,1 @@\n-        File output = workDir.resolve(ENVIRONMENT_OUTPUT).toFile();\n-        try (HtmlPage html = new HtmlPage(new PrintWriter(\n-                new FileWriter(output, true), true))) {\n+        try (HtmlPage html = new HtmlPage(workDir, ENVIRONMENT_OUTPUT, true)) {\n","filename":"test\/failure_handler\/src\/share\/classes\/jdk\/test\/failurehandler\/jtreg\/GatherDiagnosticInfoObserver.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -72,10 +72,1 @@\n-\n-            File output = workDir.resolve(OUTPUT_FILENAME).toFile();\n-            try {\n-                PrintWriter pw = new PrintWriter(new FileWriter(output, true), true);\n-                runGatherer(name, workDir, actionsLog, pw, pid);\n-            } catch (IOException e) {\n-                actionsLog.printf(\"IOException: cannot open output file[%s] : %s\",\n-                        output, e.getMessage());\n-                e.printStackTrace(actionsLog);\n-            }\n+            runGatherer(name, actionsLog, pid);\n@@ -93,3 +84,3 @@\n-    private void runGatherer(String name, Path workDir, PrintWriter log,\n-                             PrintWriter out, long pid) {\n-        try (HtmlPage html = new HtmlPage(out)) {\n+    private void runGatherer(String name, PrintWriter log, long pid) {\n+        Path workDir = outputDir.toPath();\n+        try (HtmlPage html = new HtmlPage(workDir, OUTPUT_FILENAME, true)) {\n","filename":"test\/failure_handler\/src\/share\/classes\/jdk\/test\/failurehandler\/jtreg\/GatherProcessInfoTimeoutHandler.java","additions":5,"deletions":14,"binary":false,"changes":19,"status":"modified"}]}