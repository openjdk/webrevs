{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -61,0 +61,1 @@\n+    private boolean birthtime_available;\n@@ -166,1 +167,1 @@\n-        if (UnixNativeDispatcher.birthtimeSupported()) {\n+        if (UnixNativeDispatcher.birthtimeSupported() && birthtime_available) {\n@@ -169,1 +170,1 @@\n-            \/\/ return last modified when birth time not supported\n+            \/\/ return last modified when birth time unsupported or unavailable\n","filename":"src\/java.base\/unix\/classes\/sun\/nio\/fs\/UnixFileAttributes.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -187,0 +187,1 @@\n+static jfieldID attrs_birthtime_available;\n@@ -335,0 +336,2 @@\n+    attrs_birthtime_available = (*env)->GetFieldID(env, clazz, \"birthtime_available\", \"Z\");\n+    CHECK_NULL_RETURN(attrs_birthtime_available, 0);\n@@ -623,0 +626,5 @@\n+\n+    \/\/ Check mask for birth time and set flag accordingly. The birth time is\n+    \/\/ filled in if and only if the STATX_BTIME bit is set in the mask.\n+    \/\/ Although the statx system call might be supported by the operating\n+    \/\/ system, the birth time is not necessarily supported by the file system.\n@@ -624,5 +632,3 @@\n-        \/\/  Birth time was filled in so use it\n-        (*env)->SetLongField(env, attrs, attrs_st_birthtime_sec,\n-                             (jlong)buf->stx_btime.tv_sec);\n-        (*env)->SetLongField(env, attrs, attrs_st_birthtime_nsec,\n-                             (jlong)buf->stx_btime.tv_nsec);\n+        (*env)->SetBooleanField(env, attrs, attrs_birthtime_available, (jboolean)JNI_TRUE);\n+        (*env)->SetLongField(env, attrs, attrs_st_birthtime_sec, (jlong)buf->stx_btime.tv_sec);\n+        (*env)->SetLongField(env, attrs, attrs_st_birthtime_nsec, (jlong)buf->stx_btime.tv_nsec);\n@@ -630,5 +636,1 @@\n-        \/\/  Birth time was not filled in: fall back to last modification time\n-        (*env)->SetLongField(env, attrs, attrs_st_birthtime_sec,\n-                             (jlong)buf->stx_mtime.tv_sec);\n-        (*env)->SetLongField(env, attrs, attrs_st_birthtime_nsec,\n-                             (jlong)buf->stx_mtime.tv_nsec);\n+        (*env)->SetBooleanField(env, attrs, attrs_birthtime_available, (jboolean)JNI_FALSE);\n@@ -636,0 +638,1 @@\n+\n@@ -664,0 +667,1 @@\n+    \/\/ birthtime_available defaults to 'false'; on Darwin, it is always true\n@@ -665,0 +669,1 @@\n+    (*env)->SetBooleanField(env, attrs, attrs_birthtime_available, (jboolean)JNI_TRUE);\n","filename":"src\/java.base\/unix\/native\/libnio\/fs\/UnixNativeDispatcher.c","additions":15,"deletions":10,"binary":false,"changes":25,"status":"modified"}]}