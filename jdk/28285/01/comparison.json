{"files":[{"patch":"@@ -35,1 +35,0 @@\n-#include \"nmt\/memTagBitmap.hpp\"\n@@ -43,0 +42,2 @@\n+#include \"utilities\/bitMap.hpp\"\n+#include \"utilities\/bitMap.inline.hpp\"\n@@ -131,2 +132,2 @@\n-  \/\/ return their collective flags.\n-  MemTagBitmap lookup(const void* from, const void* to) const {\n+  \/\/ fill out their collective flags into bm.\n+  void lookup(const void* from, const void* to, ResourceBitMap& bm) const {\n@@ -141,1 +142,0 @@\n-    MemTagBitmap bm;\n@@ -144,1 +144,1 @@\n-        bm.set_tag(_mem_tags[i]);\n+        bm.set_bit((BitMap::idx_t)_mem_tags[i]);\n@@ -150,1 +150,0 @@\n-    return bm;\n@@ -250,2 +249,4 @@\n-    const MemTagBitmap flags = _nmt_info.lookup(vma_from, vma_to);\n-    if (flags.has_any()) {\n+    ResourceMark rm;\n+    ResourceBitMap flags(mt_number_of_tags);\n+    _nmt_info.lookup(vma_from, vma_to, flags);\n+    if (!flags.is_empty()) {\n@@ -254,1 +255,1 @@\n-        if (flags.has_tag(mem_tag)) {\n+        if (flags.at((BitMap::idx_t)mem_tag)) {\n","filename":"src\/hotspot\/share\/nmt\/memMapPrinter.cpp","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -1,56 +0,0 @@\n-\/*\n- * Copyright (c) 2023, 2024, Red Hat, Inc. All rights reserved.\n- * Copyright (c) 2023, 2024, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\n- *\/\n-\n-#ifndef SHARE_NMT_MEMTAGBITMAP_HPP\n-#define SHARE_NMT_MEMTAGBITMAP_HPP\n-\n-#include \"nmt\/memTag.hpp\"\n-#include \"utilities\/debug.hpp\"\n-#include \"utilities\/globalDefinitions.hpp\"\n-\n-class MemTagBitmap {\n-  uint32_t _v;\n-  STATIC_ASSERT(sizeof(_v) * BitsPerByte >= mt_number_of_tags);\n-\n-public:\n-  MemTagBitmap(uint32_t v = 0) : _v(v) {}\n-  MemTagBitmap(const MemTagBitmap& o) : _v(o._v) {}\n-\n-  uint32_t raw_value() const { return _v; }\n-\n-  void set_tag(MemTag mem_tag) {\n-    const int bitno = (int)mem_tag;\n-    _v |= nth_bit(bitno);\n-  }\n-\n-  bool has_tag(MemTag mem_tag) const {\n-    const int bitno = (int)mem_tag;\n-    return _v & nth_bit(bitno);\n-  }\n-\n-  bool has_any() const { return _v > 0; }\n-};\n-\n-#endif \/\/ SHARE_NMT_MEMTAGBITMAP_HPP\n","filename":"src\/hotspot\/share\/nmt\/memTagBitmap.hpp","additions":0,"deletions":56,"binary":false,"changes":56,"status":"deleted"}]}