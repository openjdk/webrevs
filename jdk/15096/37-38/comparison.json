{"files":[{"patch":"@@ -1581,1 +1581,1 @@\n-    JNIEnv *env = (JNIEnv *)JNU_GetEnv(jvm, JNI_VERSION_1_2);\n+    JNIEnv *env = (JNIEnv *) JNU_GetEnv(jvm, JNI_VERSION_1_2);\n@@ -1583,1 +1583,1 @@\n-    NotifyModalBlockedStruct *nmbs = (NotifyModalBlockedStruct *)param;\n+    NotifyModalBlockedStruct *nmbs = static_cast<NotifyModalBlockedStruct *>(param);\n@@ -1591,3 +1591,21 @@\n-    JNI_CHECK_PEER_GOTO(peer, ret);\n-    AwtFrame *f;\n-    f = (AwtFrame *) pData;\n+    if (peer == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"peer\");\n+        env->DeleteGlobalRef(self);\n+        env->DeleteGlobalRef(blockerPeer);\n+\n+        delete nmbs;\n+        return;\n+    } else {\n+        pData = JNI_GET_PDATA(peer);\n+        if (pData == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(peer);\n+            env->DeleteGlobalRef(self);\n+            env->DeleteGlobalRef(peer);\n+            env->DeleteGlobalRef(blockerPeer);\n+\n+            delete nmbs;\n+            return;\n+        }\n+    }\n+    AwtFrame *f = (AwtFrame *) pData;\n@@ -1597,3 +1615,21 @@\n-    JNI_CHECK_PEER_GOTO(blockerPeer, ret);\n-    AwtDialog *dialog;\n-    dialog = (AwtDialog *) pData;\n+    if (blockerPeer == NULL) {\n+        env->ExceptionClear();\n+        JNU_ThrowNullPointerException(env, \"blockerPeer\");\n+        env->DeleteGlobalRef(self);\n+        env->DeleteGlobalRef(peer);\n+\n+        delete nmbs;\n+        return;\n+    } else {\n+        pData = JNI_GET_PDATA(blockerPeer);\n+        if (pData == NULL) {\n+            THROW_NULL_PDATA_IF_NOT_DESTROYED(blockerPeer);\n+            env->DeleteGlobalRef(self);\n+            env->DeleteGlobalRef(peer);\n+            env->DeleteGlobalRef(blockerPeer);\n+\n+            delete nmbs;\n+            return;\n+        }\n+    }\n+    AwtDialog *dialog = (AwtDialog *) pData;\n@@ -1649,1 +1685,1 @@\n-ret:\n+\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Frame.cpp","additions":45,"deletions":9,"binary":false,"changes":54,"status":"modified"}]}