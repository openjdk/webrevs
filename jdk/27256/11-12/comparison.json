{"files":[{"patch":"@@ -64,1 +64,1 @@\n-    private static final long DEFAULT_TIMEOUT = 5000; \/\/5s\n+    private static final long DEFAULT_MAX_BASE_CHECKS = 4_000_000;\n@@ -73,2 +73,2 @@\n-    private final long missingExhaustivenessTimeout;\n-    private long startTime = -1;\n+    private final long maxBaseChecks;\n+    private long baseChecks = -1;\n@@ -91,2 +91,2 @@\n-        String timeout = options.get(\"exhaustivityTimeout\");\n-        long computedTimeout = DEFAULT_TIMEOUT;\n+        String baseChecks = options.get(\"exhaustivityMaxBaseChecks\");\n+        long computedMaxBaseChecks = DEFAULT_MAX_BASE_CHECKS;\n@@ -94,1 +94,1 @@\n-        if (timeout != null) {\n+        if (baseChecks != null) {\n@@ -96,1 +96,1 @@\n-                computedTimeout = Long.parseLong(timeout);\n+                computedMaxBaseChecks = Long.parseLong(baseChecks);\n@@ -102,1 +102,1 @@\n-        missingExhaustivenessTimeout = computedTimeout;\n+        maxBaseChecks = computedMaxBaseChecks;\n@@ -461,2 +461,0 @@\n-                    checkTimeout();\n-\n@@ -694,3 +692,3 @@\n-        if (startTime != (-1) &&\n-            (System.currentTimeMillis() - startTime) > missingExhaustivenessTimeout) {\n-            throw new TimeoutException(null);\n+        if (baseChecks != (-1) &&\n+            ++baseChecks > maxBaseChecks) {\n+            throw new TooManyChecksException(null);\n@@ -834,1 +832,1 @@\n-        if (missingExhaustivenessTimeout == 0) {\n+        if (maxBaseChecks == 0) {\n@@ -838,1 +836,1 @@\n-            startTime = System.currentTimeMillis();\n+            baseChecks = 0;\n@@ -845,1 +843,1 @@\n-        } catch (TimeoutException ex) {\n+        } catch (TooManyChecksException ex) {\n@@ -848,1 +846,1 @@\n-            startTime = -1;\n+            baseChecks = -1;\n@@ -861,1 +859,1 @@\n-        } catch (TimeoutException ex) {\n+        } catch (TooManyChecksException ex) {\n@@ -863,1 +861,1 @@\n-                ex = new TimeoutException(inMissingPatterns);\n+                ex = new TooManyChecksException(inMissingPatterns);\n@@ -1236,1 +1234,1 @@\n-    protected static class TimeoutException extends RuntimeException {\n+    protected static class TooManyChecksException extends RuntimeException {\n@@ -1240,1 +1238,1 @@\n-        public TimeoutException(Set<PatternDescription> missingPatterns) {\n+        public TooManyChecksException(Set<PatternDescription> missingPatterns) {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/ExhaustivenessComputer.java","additions":19,"deletions":21,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -2526,1 +2526,1 @@\n-                             \"-XDexhaustivityTimeout=0\",\n+                             \"-XDexhaustivityMaxBaseChecks=0\",\n","filename":"test\/langtools\/tools\/javac\/patterns\/Exhaustiveness.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -567,1 +567,1 @@\n-                     \"-XDexhaustivityTimeout=\" + Long.MAX_VALUE) \/\/never timeout\n+                     \"-XDexhaustivityMaxBaseChecks=\" + Long.MAX_VALUE) \/\/never give up\n","filename":"test\/langtools\/tools\/javac\/patterns\/ExhaustivenessConvenientErrors.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}