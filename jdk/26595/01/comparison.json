{"files":[{"patch":"@@ -66,1 +66,1 @@\n-size_t G1CSetCandidateGroup::liveness() const {\n+double G1CSetCandidateGroup::liveness_percent() const {\n@@ -68,2 +68,1 @@\n-\n-  return (size_t) ceil(((capacity - _reclaimable_bytes) * 100.0) \/ capacity);\n+  return ((capacity - _reclaimable_bytes) * 100.0) \/ capacity;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectionSetCandidates.cpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -105,1 +105,1 @@\n-  size_t liveness() const;\n+  double liveness_percent() const;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectionSetCandidates.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2978,1 +2978,0 @@\n-#define G1PPRL_GCEFF_FORMAT           \"  %14s\"\n@@ -2985,0 +2984,1 @@\n+#define G1PPRL_GID_LIVENESS_FORMAT    \"  %#.3g\"\n@@ -3093,1 +3093,1 @@\n-  do_cset_groups();\n+  log_cset_candidate_groups();\n@@ -3113,1 +3113,17 @@\n-void G1PrintRegionLivenessInfoClosure::do_cset_groups() {\n+void G1PrintRegionLivenessInfoClosure::log_cset_candidate_group(G1CSetCandidateGroup* group, const char* type) {\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n+                          G1PPRL_GID_FORMAT\n+                          G1PPRL_LEN_FORMAT\n+                          G1PPRL_GID_GCEFF_FORMAT\n+                          G1PPRL_GID_LIVENESS_FORMAT\n+                          G1PPRL_BYTE_FORMAT\n+                          G1PPRL_TYPE_H_FORMAT,\n+                          group->group_id(),\n+                          group->length(),\n+                          group->gc_efficiency(),\n+                          group->liveness_percent(),\n+                          group->card_set()->mem_size(),\n+                          type);\n+}\n+\n+void G1PrintRegionLivenessInfoClosure::log_cset_candidate_groups() {\n@@ -3115,2 +3131,2 @@\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\" Collectionset Candidate Groups\");\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX \" Types: Y=Young Regions, M=From Marking Regions, R=Retained Regions\");\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\" Collection Set Candidate Groups\");\n+  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX \" Types: Y=Young, M=From Marking Regions, R=Retained Regions\");\n@@ -3140,1 +3156,0 @@\n-  G1CSetCandidateGroup* young_only_cset_group =g1h->young_regions_cset_group();\n@@ -3142,13 +3157,2 @@\n-  _total_remset_bytes += young_only_cset_group->card_set()->mem_size();\n-\n-  log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                          G1PPRL_GID_FORMAT\n-                          G1PPRL_LEN_FORMAT\n-                          G1PPRL_GCEFF_FORMAT\n-                          G1PPRL_BYTE_FORMAT\n-                          G1PPRL_BYTE_FORMAT\n-                          G1PPRL_TYPE_H_FORMAT,\n-                          young_only_cset_group->group_id(), young_only_cset_group->length(),\n-                          \"-\",\n-                          size_t(0), young_only_cset_group->card_set()->mem_size(),\n-                          \"Y\");\n+  log_cset_candidate_group(g1h->young_regions_cset_group(), \"Y\");\n+  _total_remset_bytes += g1h->young_regions_cset_group()->card_set()->mem_size();\n@@ -3157,0 +3161,1 @@\n+    log_cset_candidate_group(group, \"M\");\n@@ -3158,11 +3163,0 @@\n-    log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                            G1PPRL_GID_FORMAT\n-                            G1PPRL_LEN_FORMAT\n-                            G1PPRL_GID_GCEFF_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_TYPE_H_FORMAT,\n-                            group->group_id(), group->length(),\n-                            group->gc_efficiency(),\n-                            group->liveness(), group->card_set()->mem_size(),\n-                            \"M\");\n@@ -3172,0 +3166,1 @@\n+    log_cset_candidate_group(group, \"R\");\n@@ -3173,11 +3168,0 @@\n-    log_trace(gc, liveness)(G1PPRL_LINE_PREFIX\n-                            G1PPRL_GID_FORMAT\n-                            G1PPRL_LEN_FORMAT\n-                            G1PPRL_GID_GCEFF_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_BYTE_FORMAT\n-                            G1PPRL_TYPE_H_FORMAT,\n-                            group->group_id(), group->length(),\n-                            group->gc_efficiency(),\n-                            group->liveness(), group->card_set()->mem_size(),\n-                            \"R\");\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":25,"deletions":41,"binary":false,"changes":66,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+class G1CSetCandidateGroup;\n@@ -977,1 +978,2 @@\n-  void do_cset_groups();\n+  void log_cset_candidate_group(G1CSetCandidateGroup* gr, const char* type);\n+  void log_cset_candidate_groups();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.hpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}