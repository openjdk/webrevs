{"files":[{"patch":"@@ -373,1 +373,2 @@\n-                app.runtimeBuilder().orElseThrow().withNativeCommands();\n+                app.runtimeBuilder().orElseThrow().withNativeCommands() ||\n+                Files.isDirectory(env.resolvedLayout().runtimeDirectory().resolve(\"bin\"));\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacPackagingPipeline.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1222,0 +1222,23 @@\n+        MAC_RUNTIME_PLIST_JDK_KEY(cmd -> {\n+            if (TKit.isOSX()) {\n+                var appLayout = cmd.appLayout();\n+                \/\/ Runtime directory may not exist.\n+                \/\/ For example in AppImagePackageTest.testEmpty() case.\n+                if (!Files.isDirectory(appLayout.runtimeDirectory())) {\n+                    return;\n+                }\n+                var plistPath = appLayout.runtimeDirectory().resolve(\"Contents\/Info.plist\");\n+                var keyName = \"JavaVM\";\n+                var keyValue = MacHelper.readPList(plistPath).findDictValue(keyName);\n+                if (cmd.isRuntime() || Files.isDirectory(appLayout.runtimeHomeDirectory().resolve(\"bin\"))) {\n+                    \/\/ There are native launchers in the runtime\n+                    TKit.assertTrue(keyValue.isPresent(), String.format(\n+                            \"Check the runtime plist file [%s] contains '%s' key\",\n+                            plistPath, keyName));\n+                } else {\n+                    TKit.assertTrue(keyValue.isEmpty(), String.format(\n+                            \"Check the runtime plist file [%s] contains NO '%s' key\",\n+                            plistPath, keyName));\n+                }\n+            }\n+        }),\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":23,"deletions":0,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import static jdk.jpackage.internal.util.PListWriter.writeKey;\n@@ -434,0 +435,4 @@\n+                    writeKey(xml, \"JavaVM\");\n+                    writeDict(xml, toXmlConsumer(() -> {\n+                        writeString(xml, \"JVMVersion\", value(\"CF_BUNDLE_VERSION\", cmd.version()));\n+                    }));\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/CustomInfoPListTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"}]}