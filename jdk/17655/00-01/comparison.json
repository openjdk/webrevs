{"files":[{"patch":"@@ -1224,0 +1224,4 @@\n+  if (!UnlockDiagnosticVMOptions) {\n+    output()->print_cr(\"-XX:+UnlockDiagnosticVMOptions is required\");\n+    return;\n+  }\n@@ -1245,3 +1249,0 @@\n-    if (!UnlockDiagnosticVMOptions) {\n-      output()->print_cr(\"find requires -XX:+UnlockDiagnosticVMOptions\");\n-    } else {\n@@ -1249,1 +1250,0 @@\n-    }\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run testng\/othervm -Dvmdebug.find=true -XX:+UnlockDiagnosticVMOptions VMDebugTest\n+ * @run testng\/othervm -Dvmdebug.enabled=true -XX:+UnlockDiagnosticVMOptions VMDebugTest\n@@ -39,1 +39,1 @@\n- * @run testng\/othervm -Dvmdebug.find=false VMDebugTest\n+ * @run testng\/othervm -Dvmdebug.enabled=false VMDebugTest\n@@ -72,0 +72,12 @@\n+        \/\/ Testing VM.debug requires UnlockDiagnosticVMOptions or a debug JVM.\n+        \/\/ This test runs with a System Property set as a hint whether UnlockDiagnosticVMOptions is set.\n+        boolean enabled = Platform.isDebugBuild() || Boolean.getBoolean(\"vmdebug.find\");\n+        System.out.println(\"VM.debug should be enabled = \" + enabled);\n+        if (!enabled) {\n+            \/\/ Use any pointer, command should be refused:\n+            output = executor.execute(\"VM.debug find 0x0\");\n+            output.shouldContain(\"-XX:+UnlockDiagnosticVMOptions is required\");\n+            return; \/\/ no more testing\n+        } \n+\n+        \/\/ Tests with VM.debug enabled:\n@@ -102,11 +114,2 @@\n-        \/\/ Test VM.debug find: requires UnlockDiagnosticVMOptions or a debug JVM.\n-        \/\/ This test runs with a System Property set as a hint whether UnlockDiagnosticVMOptions is set.\n-        boolean findEnabled = Platform.isDebugBuild() || Boolean.getBoolean(\"vmdebug.find\");\n-        System.out.println(\"VM.debug find should be enabled = \" + findEnabled);\n-        if (!findEnabled) {\n-            \/\/ Use any pointer, command should be refused:\n-            output = executor.execute(\"VM.debug find 0x0\");\n-            output.shouldContain(\"find requires -XX:+UnlockDiagnosticVMOptions\");\n-        } else {\n-            testFind(executor);\n-        }\n+        \/\/ Test VM.debug find:\n+        testFind(executor);\n","filename":"test\/hotspot\/jtreg\/serviceability\/dcmd\/vm\/VMDebugTest.java","additions":16,"deletions":13,"binary":false,"changes":29,"status":"modified"}]}