{"files":[{"patch":"@@ -623,1 +623,1 @@\n-      __ z_lochi(result, 1, Assembler::bcondEqual);\n+      __ load_on_condition_imm_32(result, 1, Assembler::bcondEqual);\n@@ -632,1 +632,1 @@\n-      __ z_lochi(result, 1, Assembler::bcondEqual);\n+      __ load_on_condition_imm_32(result, 1, Assembler::bcondEqual);\n","filename":"src\/hotspot\/cpu\/s390\/c1_Runtime1_s390.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3697,1 +3697,1 @@\n-  z_lochi(r_linear_result, 1, bcondNotHigh); \/\/ load failure if array_length <= 0\n+  load_on_condition_imm_32(r_linear_result, 1, bcondNotHigh); \/\/ load failure if array_length <= 0\n@@ -6961,0 +6961,26 @@\n+\n+\/\/ LOAD HALFWORD IMMEDIATE ON CONDITION (32 <- 16)\n+void MacroAssembler::load_on_condition_imm_32(Register dst, int64_t i2, branch_condition cc) {\n+  if (VM_Version::has_LoadStoreConditional2()) { \/\/ z_lochi works on z13 or above\n+    assert(Assembler::is_simm16(i2), \"sanity\");\n+    z_lochi(dst, i2, cc);\n+  } else {\n+    NearLabel done;\n+    z_brc(Assembler::inverse_condition(cc), done);\n+    z_lhi(dst, i2);\n+    bind(done);\n+  }\n+}\n+\n+\/\/ LOAD HALFWORD IMMEDIATE ON CONDITION (64 <- 16)\n+void MacroAssembler::load_on_condition_imm_64(Register dst, int64_t i2, branch_condition cc) {\n+  if (VM_Version::has_LoadStoreConditional2()) { \/\/ z_locghi works on z13 or above\n+    assert(Assembler::is_simm16(i2), \"sanity\");\n+    z_locghi(dst, i2, cc);\n+  } else {\n+    NearLabel done;\n+    z_brc(Assembler::inverse_condition(cc), done);\n+    z_lghi(dst, i2);\n+    bind(done);\n+  }\n+}\n","filename":"src\/hotspot\/cpu\/s390\/macroAssembler_s390.cpp","additions":27,"deletions":1,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -1112,0 +1112,2 @@\n+  void load_on_condition_imm_32(Register dst, int64_t i2, branch_condition cc);\n+  void load_on_condition_imm_64(Register dst, int64_t i2, branch_condition cc);\n","filename":"src\/hotspot\/cpu\/s390\/macroAssembler_s390.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}