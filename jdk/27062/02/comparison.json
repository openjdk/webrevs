{"files":[{"patch":"@@ -1985,1 +1985,1 @@\n-                        checkAutoCloseable(resource.pos(), localEnv, resource.type);\n+                        checkAutoCloseable(resource.pos(), localEnv, resource.type, true);\n@@ -2034,1 +2034,1 @@\n-    void checkAutoCloseable(DiagnosticPosition pos, Env<AttrContext> env, Type resource) {\n+    void checkAutoCloseable(DiagnosticPosition pos, Env<AttrContext> env, Type resource, boolean useSite) {\n@@ -2052,1 +2052,2 @@\n-                    close.overrides(syms.autoCloseableClose, resource.tsym, types, true) &&\n+                    (useSite || close.owner != syms.autoCloseableType.tsym) &&\n+                    ((MethodSymbol)close).binaryOverrides(syms.autoCloseableClose, resource.tsym, types) &&\n@@ -5652,1 +5653,1 @@\n-        checkAutoCloseable(tree.pos(), env, c.type);\n+        checkAutoCloseable(tree.pos(), env, c.type, false);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -0,0 +1,249 @@\n+\/*\n+ * @test \/nodynamiccopyright\/\n+ * @bug 8155591\n+ * @summary Verify cases where no AutoCloseable InterruptedException warning should be generated\n+ * @compile\/ref=InterruptedExceptionTest2.out -XDrawDiagnostics -Xlint:try InterruptedExceptionTest2.java\n+ *\/\n+\n+import java.util.function.Supplier;\n+\n+\/\/ Here's an interface and a class that we can inherit declaring offending close() methods\n+\n+interface HasClose {\n+    void close() throws Exception;\n+}\n+\n+class WithClose {\n+    public void close() throws Exception { }\n+}\n+\n+\/\/ Interface declaration tests\n+\n+interface InterruptedExceptionTest_I1 extends AutoCloseable {\n+}\n+\n+interface InterruptedExceptionTest_I2 extends AutoCloseable {\n+    @Override void close();\n+}\n+\n+interface InterruptedExceptionTest_I3 extends AutoCloseable {               \/\/ warning here\n+    @Override void close() throws InterruptedException;\n+}\n+\n+interface InterruptedExceptionTest_I4 extends AutoCloseable {               \/\/ warning here\n+    @Override void close() throws Exception;\n+}\n+\n+interface InterruptedExceptionTest_I5 extends AutoCloseable {\n+    @Override default void close() { }\n+}\n+\n+interface InterruptedExceptionTest_I6 extends AutoCloseable {               \/\/ warning here\n+    @Override default void close() throws InterruptedException { }\n+}\n+\n+interface InterruptedExceptionTest_I7 extends AutoCloseable {               \/\/ warning here\n+    @Override default void close() throws Exception { }\n+}\n+\n+interface InterruptedExceptionTest_I8 extends HasClose, AutoCloseable {\n+}\n+\n+interface InterruptedExceptionTest_I9 extends HasClose, AutoCloseable {\n+    @Override void close();\n+}\n+\n+\/\/ Abstract class declaration tests\n+\n+abstract class InterruptedExceptionTest_C1 implements AutoCloseable {\n+}\n+\n+abstract class InterruptedExceptionTest_C2 implements AutoCloseable {\n+    @Override public abstract void close();\n+}\n+\n+abstract class InterruptedExceptionTest_C3 implements AutoCloseable {       \/\/ warning here\n+    @Override public abstract void close() throws InterruptedException;\n+}\n+\n+abstract class InterruptedExceptionTest_C4 implements AutoCloseable {       \/\/ warning here\n+    @Override public abstract void close() throws Exception;\n+}\n+\n+abstract class InterruptedExceptionTest_C5 implements AutoCloseable {\n+    @Override public void close() { }\n+}\n+\n+abstract class InterruptedExceptionTest_C6 implements AutoCloseable {       \/\/ warning here\n+    @Override public void close() throws InterruptedException { }\n+}\n+\n+abstract class InterruptedExceptionTest_C7 implements AutoCloseable {       \/\/ warning here\n+    @Override public void close() throws Exception { }\n+}\n+\n+abstract class InterruptedExceptionTest_C8 implements HasClose, AutoCloseable {\n+}\n+\n+abstract class InterruptedExceptionTest_C9 implements HasClose, AutoCloseable {\n+    @Override public void close() { }\n+}\n+\n+abstract class InterruptedExceptionTest_C10 extends WithClose implements AutoCloseable { \/\/ warning here\n+}\n+\n+\/\/ Interface use site tests\n+\n+class UseSite_I1 {\n+    void m(Supplier<InterruptedExceptionTest_I1> s) throws Exception {\n+        try (InterruptedExceptionTest_I1 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I2 {\n+    void m(Supplier<InterruptedExceptionTest_I2> s) throws Exception {\n+        try (InterruptedExceptionTest_I2 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I3 {\n+    void m(Supplier<InterruptedExceptionTest_I3> s) throws Exception {\n+        try (InterruptedExceptionTest_I3 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I4 {\n+    void m(Supplier<InterruptedExceptionTest_I4> s) throws Exception {\n+        try (InterruptedExceptionTest_I4 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I5 {\n+    void m(Supplier<InterruptedExceptionTest_I5> s) throws Exception {\n+        try (InterruptedExceptionTest_I5 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I6 {\n+    void m(Supplier<InterruptedExceptionTest_I6> s) throws Exception {\n+        try (InterruptedExceptionTest_I6 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I7 {\n+    void m(Supplier<InterruptedExceptionTest_I7> s) throws Exception {\n+        try (InterruptedExceptionTest_I7 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I8 {\n+    void m(Supplier<InterruptedExceptionTest_I8> s) throws Exception {\n+        try (InterruptedExceptionTest_I8 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_I9 {\n+    void m(Supplier<InterruptedExceptionTest_I9> s) throws Exception {\n+        try (InterruptedExceptionTest_I9 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+\/\/ Abstract class use site tests\n+\n+class UseSite_C1 {\n+    void m(Supplier<InterruptedExceptionTest_C1> s) throws Exception {\n+        try (InterruptedExceptionTest_C1 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C2 {\n+    void m(Supplier<InterruptedExceptionTest_C2> s) throws Exception {\n+        try (InterruptedExceptionTest_C2 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C3 {\n+    void m(Supplier<InterruptedExceptionTest_C3> s) throws Exception {\n+        try (InterruptedExceptionTest_C3 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C4 {\n+    void m(Supplier<InterruptedExceptionTest_C4> s) throws Exception {\n+        try (InterruptedExceptionTest_C4 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C5 {\n+    void m(Supplier<InterruptedExceptionTest_C5> s) throws Exception {\n+        try (InterruptedExceptionTest_C5 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C6 {\n+    void m(Supplier<InterruptedExceptionTest_C6> s) throws Exception {\n+        try (InterruptedExceptionTest_C6 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C7 {\n+    void m(Supplier<InterruptedExceptionTest_C7> s) throws Exception {\n+        try (InterruptedExceptionTest_C7 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C8 {\n+    void m(Supplier<InterruptedExceptionTest_C8> s) throws Exception {\n+        try (InterruptedExceptionTest_C8 t = s.get()) {                     \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C9 {\n+    void m(Supplier<InterruptedExceptionTest_C9> s) throws Exception {\n+        try (InterruptedExceptionTest_C9 t = s.get()) {\n+            t.hashCode();\n+        }\n+    }\n+}\n+\n+class UseSite_C10 {\n+    void m(Supplier<InterruptedExceptionTest_C10> s) throws Exception {\n+        try (InterruptedExceptionTest_C10 t = s.get()) {                    \/\/ warning here\n+            t.hashCode();\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/javac\/TryWithResources\/InterruptedExceptionTest2.java","additions":249,"deletions":0,"binary":false,"changes":249,"status":"added"},{"patch":"@@ -0,0 +1,23 @@\n+InterruptedExceptionTest2.java:29:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I3\n+InterruptedExceptionTest2.java:33:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I4\n+InterruptedExceptionTest2.java:41:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I6\n+InterruptedExceptionTest2.java:45:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I7\n+InterruptedExceptionTest2.java:65:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C3\n+InterruptedExceptionTest2.java:69:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C4\n+InterruptedExceptionTest2.java:77:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C6\n+InterruptedExceptionTest2.java:81:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C7\n+InterruptedExceptionTest2.java:92:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n+InterruptedExceptionTest2.java:99:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I1\n+InterruptedExceptionTest2.java:115:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I3\n+InterruptedExceptionTest2.java:123:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I4\n+InterruptedExceptionTest2.java:139:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I6\n+InterruptedExceptionTest2.java:147:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I7\n+InterruptedExceptionTest2.java:155:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I8\n+InterruptedExceptionTest2.java:173:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C1\n+InterruptedExceptionTest2.java:189:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C3\n+InterruptedExceptionTest2.java:197:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C4\n+InterruptedExceptionTest2.java:213:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C6\n+InterruptedExceptionTest2.java:221:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C7\n+InterruptedExceptionTest2.java:229:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C8\n+InterruptedExceptionTest2.java:245:43: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n+22 warnings\n","filename":"test\/langtools\/tools\/javac\/TryWithResources\/InterruptedExceptionTest2.out","additions":23,"deletions":0,"binary":false,"changes":23,"status":"added"}]}