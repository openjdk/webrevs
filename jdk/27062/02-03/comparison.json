{"files":[{"patch":"@@ -1985,1 +1985,1 @@\n-                        checkAutoCloseable(resource.pos(), localEnv, resource.type, true);\n+                        checkAutoCloseable(localEnv, resource, true);\n@@ -2034,1 +2034,3 @@\n-    void checkAutoCloseable(DiagnosticPosition pos, Env<AttrContext> env, Type resource, boolean useSite) {\n+    void checkAutoCloseable(Env<AttrContext> env, JCTree tree, boolean useSite) {\n+        DiagnosticPosition pos = tree.pos();\n+        Type resource = tree.type;\n@@ -2055,1 +2057,6 @@\n-                log.warning(pos, LintWarnings.TryResourceThrowsInterruptedExc(resource));\n+                if (!useSite && close.owner == resource.tsym) {\n+                    log.warning(TreeInfo.diagnosticPositionFor(close, tree),\n+                        LintWarnings.TryResourceCanThrowInterruptedExc(resource));\n+                } else {\n+                    log.warning(pos, LintWarnings.TryResourceThrowsInterruptedExc(resource));\n+                }\n@@ -5653,1 +5660,1 @@\n-        checkAutoCloseable(tree.pos(), env, c.type, false);\n+        checkAutoCloseable(env, tree, false);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":11,"deletions":4,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2371,0 +2371,5 @@\n+# 0: type\n+# lint: try\n+compiler.warn.try.resource.can.throw.interrupted.exc=\\\n+    close() method can throw InterruptedException in auto-closeable class {0}\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/compiler.properties","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -231,1 +231,2 @@\n-                    diagnostic.getCode().contains(\"try.resource.throws.interrupted.exc\")) {\n+                    (diagnostic.getCode().contains(\"try.resource.throws.interrupted.exc\") ||\n+                     diagnostic.getCode().contains(\"try.resource.can.throw.interrupted.exc\"))) {\n","filename":"test\/langtools\/tools\/javac\/TryWithResources\/InterruptedExceptionTest.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -16,1 +16,1 @@\n-class WithClose {\n+class WithConcreteClose {\n@@ -20,0 +20,4 @@\n+abstract class WithAbstractClose {\n+    public abstract void close() throws Exception;\n+}\n+\n@@ -29,2 +33,2 @@\n-interface InterruptedExceptionTest_I3 extends AutoCloseable {               \/\/ warning here\n-    @Override void close() throws InterruptedException;\n+interface InterruptedExceptionTest_I3 extends AutoCloseable {\n+    @Override void close() throws InterruptedException;                     \/\/ warning here\n@@ -33,2 +37,2 @@\n-interface InterruptedExceptionTest_I4 extends AutoCloseable {               \/\/ warning here\n-    @Override void close() throws Exception;\n+interface InterruptedExceptionTest_I4 extends AutoCloseable {\n+    @Override void close() throws Exception;                                \/\/ warning here\n@@ -41,2 +45,2 @@\n-interface InterruptedExceptionTest_I6 extends AutoCloseable {               \/\/ warning here\n-    @Override default void close() throws InterruptedException { }\n+interface InterruptedExceptionTest_I6 extends AutoCloseable {\n+    @Override default void close() throws InterruptedException { }          \/\/ warning here\n@@ -45,2 +49,2 @@\n-interface InterruptedExceptionTest_I7 extends AutoCloseable {               \/\/ warning here\n-    @Override default void close() throws Exception { }\n+interface InterruptedExceptionTest_I7 extends AutoCloseable {\n+    @Override default void close() throws Exception { }                     \/\/ warning here\n@@ -65,2 +69,2 @@\n-abstract class InterruptedExceptionTest_C3 implements AutoCloseable {       \/\/ warning here\n-    @Override public abstract void close() throws InterruptedException;\n+abstract class InterruptedExceptionTest_C3 implements AutoCloseable {\n+    @Override public abstract void close() throws InterruptedException;     \/\/ warning here\n@@ -69,2 +73,2 @@\n-abstract class InterruptedExceptionTest_C4 implements AutoCloseable {       \/\/ warning here\n-    @Override public abstract void close() throws Exception;\n+abstract class InterruptedExceptionTest_C4 implements AutoCloseable {\n+    @Override public abstract void close() throws Exception;                \/\/ warning here\n@@ -77,2 +81,2 @@\n-abstract class InterruptedExceptionTest_C6 implements AutoCloseable {       \/\/ warning here\n-    @Override public void close() throws InterruptedException { }\n+abstract class InterruptedExceptionTest_C6 implements AutoCloseable {\n+    @Override public void close() throws InterruptedException { }           \/\/ warning here\n@@ -81,2 +85,2 @@\n-abstract class InterruptedExceptionTest_C7 implements AutoCloseable {       \/\/ warning here\n-    @Override public void close() throws Exception { }\n+abstract class InterruptedExceptionTest_C7 implements AutoCloseable {\n+    @Override public void close() throws Exception { }                      \/\/ warning here\n@@ -92,1 +96,4 @@\n-abstract class InterruptedExceptionTest_C10 extends WithClose implements AutoCloseable { \/\/ warning here\n+abstract class InterruptedExceptionTest_C10 extends WithConcreteClose implements AutoCloseable { \/\/ warning here\n+}\n+\n+abstract class InterruptedExceptionTest_C11 extends WithAbstractClose implements AutoCloseable {\n","filename":"test\/langtools\/tools\/javac\/TryWithResources\/InterruptedExceptionTest2.java","additions":25,"deletions":18,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -1,22 +1,22 @@\n-InterruptedExceptionTest2.java:29:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I3\n-InterruptedExceptionTest2.java:33:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I4\n-InterruptedExceptionTest2.java:41:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I6\n-InterruptedExceptionTest2.java:45:1: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I7\n-InterruptedExceptionTest2.java:65:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C3\n-InterruptedExceptionTest2.java:69:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C4\n-InterruptedExceptionTest2.java:77:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C6\n-InterruptedExceptionTest2.java:81:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C7\n-InterruptedExceptionTest2.java:92:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n-InterruptedExceptionTest2.java:99:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I1\n-InterruptedExceptionTest2.java:115:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I3\n-InterruptedExceptionTest2.java:123:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I4\n-InterruptedExceptionTest2.java:139:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I6\n-InterruptedExceptionTest2.java:147:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I7\n-InterruptedExceptionTest2.java:155:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I8\n-InterruptedExceptionTest2.java:173:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C1\n-InterruptedExceptionTest2.java:189:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C3\n-InterruptedExceptionTest2.java:197:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C4\n-InterruptedExceptionTest2.java:213:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C6\n-InterruptedExceptionTest2.java:221:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C7\n-InterruptedExceptionTest2.java:229:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C8\n-InterruptedExceptionTest2.java:245:43: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n+InterruptedExceptionTest2.java:34:20: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_I3\n+InterruptedExceptionTest2.java:38:20: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_I4\n+InterruptedExceptionTest2.java:46:28: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_I6\n+InterruptedExceptionTest2.java:50:28: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_I7\n+InterruptedExceptionTest2.java:70:36: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_C3\n+InterruptedExceptionTest2.java:74:36: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_C4\n+InterruptedExceptionTest2.java:82:27: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_C6\n+InterruptedExceptionTest2.java:86:27: compiler.warn.try.resource.can.throw.interrupted.exc: InterruptedExceptionTest_C7\n+InterruptedExceptionTest2.java:96:10: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n+InterruptedExceptionTest2.java:106:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I1\n+InterruptedExceptionTest2.java:122:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I3\n+InterruptedExceptionTest2.java:130:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I4\n+InterruptedExceptionTest2.java:146:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I6\n+InterruptedExceptionTest2.java:154:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I7\n+InterruptedExceptionTest2.java:162:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_I8\n+InterruptedExceptionTest2.java:180:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C1\n+InterruptedExceptionTest2.java:196:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C3\n+InterruptedExceptionTest2.java:204:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C4\n+InterruptedExceptionTest2.java:220:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C6\n+InterruptedExceptionTest2.java:228:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C7\n+InterruptedExceptionTest2.java:236:42: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C8\n+InterruptedExceptionTest2.java:252:43: compiler.warn.try.resource.throws.interrupted.exc: InterruptedExceptionTest_C10\n","filename":"test\/langtools\/tools\/javac\/TryWithResources\/InterruptedExceptionTest2.out","additions":22,"deletions":22,"binary":false,"changes":44,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+\/\/ key: compiler.warn.try.resource.can.throw.interrupted.exc\n@@ -29,0 +30,6 @@\n+    {\n+        try (var t = new TryResourceThrowsInterruptedException()) {\n+            t.hashCode();\n+        } catch (InterruptedException e) {\n+        }\n+    }\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/TryResourceThrowsInterruptedExc.java","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"}]}