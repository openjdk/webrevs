{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -860,2 +860,1 @@\n-                            backgroundState =\n-                                (icon != null) ? State.BITMAP : State.NORMAL;\n+                            backgroundState = State.NORMAL;\n@@ -881,0 +880,3 @@\n+                            } else {\n+                                skin = xp.getSkin(c, part);\n+                                skin.paintSkin(g, x - 3*OFFSET, y + OFFSET, state);\n@@ -886,1 +888,33 @@\n-                    icon.paintIcon(c, g, x + OFFSET, y + OFFSET);\n+                    if (!((AbstractButton)c).isSelected()) {\n+                        Part backgroundPart = Part.MP_POPUPCHECKBACKGROUND;\n+                        Part part;\n+                        if (type == JRadioButtonMenuItem.class) {\n+                            part = Part.BP_RADIOBUTTON;\n+                        } else {\n+                            part = Part.MP_POPUPCHECK;\n+                        }\n+                        State backgroundState;\n+                        State state;\n+                        if (isEnabled(c, null)) {\n+                            backgroundState = State.NORMAL;\n+                            state = (type == JRadioButtonMenuItem.class)\n+                                    ? State.BULLETNORMAL\n+                                    : State.CHECKMARKNORMAL;\n+                        } else {\n+                            backgroundState = State.DISABLEDPUSHED;\n+                            state =\n+                                    (type == JRadioButtonMenuItem.class)\n+                                            ? State.BULLETDISABLED\n+                                            : State.CHECKMARKDISABLED;\n+                        }\n+                        XPStyle xp = XPStyle.getXP();\n+                        if (xp != null) {\n+                            Skin skin;\n+                            skin = xp.getSkin(c, backgroundPart);\n+                            skin.paintSkin(g, x, y,\n+                                    getIconWidth(), getIconHeight(), backgroundState);\n+                            skin = xp.getSkin(c, part);\n+                            skin.paintSkin(g, x - 2 * OFFSET, y + OFFSET, state);\n+                        }\n+                    }\n+                    icon.paintIcon(c, g, x + 3*OFFSET, y + OFFSET);\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsIconFactory.java","additions":38,"deletions":4,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -0,0 +1,87 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8348760\n+ * @summary Verify if RadioButton is shown if JRadioButtonMenuItem\n+ *          is rendered with ImageIcon in WindowsLookAndFeel\n+ * @requires (os.family == \"windows\")\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual TestImageIconWithJRadioButtonMenuItem\n+ *\/\n+\n+import javax.swing.AbstractButton;\n+import javax.swing.ButtonGroup;\n+import javax.swing.ImageIcon;\n+import javax.swing.JFrame;\n+import javax.swing.JPanel;\n+import javax.swing.JRadioButtonMenuItem;\n+import javax.swing.UIManager;\n+\n+public class TestImageIconWithJRadioButtonMenuItem {\n+\n+    private static final String instructionsText = \"\"\"\n+        Two JRadioButtonMenuItem will be shown.\n+        One JRadioButtonMenuItem is with imageIcon and\n+        another one without imageicon.\n+        Verify that for JRadioButtonMenuItem with imageicon,\n+        radiobutton is been shown alongside the imageicon.\n+        If radiobutton is shown, test passes else fails.\"\"\";\n+\n+    public static void main(String[] args) throws Exception {\n+        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());\n+        PassFailJFrame.builder()\n+                .title(\"JRadioButtonMenuItem Instructions\")\n+                .instructions(instructionsText)\n+                .rows(10)\n+                .columns(40)\n+                .testUI(TestImageIconWithJRadioButtonMenuItem::doTest)\n+                .build()\n+                .awaitAndCheck();\n+    }\n+\n+    public static JFrame doTest() {\n+        String imgPath1 = \".\/duke.gif\";\n+\n+        JFrame frame = new JFrame(\"RadioButtonWithImageIcon\");\n+        ImageIcon imageIcon1 = new ImageIcon(imgPath1);\n+        AbstractButton button1 = new JRadioButtonMenuItem(\"JRadioButtonMenuItem 1\",\n+                imageIcon1);\n+        button1.setSelected(true);\n+        AbstractButton button2 = new JRadioButtonMenuItem(\"JRadioButtonMenuItem 2\");\n+\n+        ButtonGroup buttonGroup = new ButtonGroup();\n+        buttonGroup.add(button1);\n+        buttonGroup.add(button2);\n+\n+        JPanel panel = new JPanel();\n+        panel.add(button1);\n+        panel.add(button2);\n+\n+        frame.getContentPane().add(panel);\n+        frame.pack();\n+        return frame;\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/JMenuItem\/TestImageIconWithJRadioButtonMenuItem.java","additions":87,"deletions":0,"binary":false,"changes":87,"status":"added"},{"filename":"test\/jdk\/javax\/swing\/JMenuItem\/duke.gif","binary":true,"status":"added"}]}