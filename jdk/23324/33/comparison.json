{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+import java.awt.Color;\n@@ -33,0 +34,2 @@\n+import java.awt.Insets;\n+import java.awt.Rectangle;\n@@ -40,0 +43,2 @@\n+import javax.swing.ButtonModel;\n+import javax.swing.Icon;\n@@ -41,0 +46,1 @@\n+import javax.swing.JMenu;\n@@ -45,0 +51,2 @@\n+import sun.swing.MenuItemLayoutHelper;\n+import sun.swing.SwingUtilities2;\n@@ -67,0 +75,4 @@\n+    private static Color disabledForeground;\n+    private static Color acceleratorSelectionForeground;\n+    private static Color acceleratorForeground;\n+\n@@ -146,0 +158,122 @@\n+    public static void applyInsets(Rectangle rect, Insets insets) {\n+        if (insets != null) {\n+            rect.x += insets.left;\n+            rect.y += insets.top;\n+            rect.width -= (insets.right + rect.x);\n+            rect.height -= (insets.bottom + rect.y);\n+        }\n+    }\n+\n+    public static void paintCheckIcon(Graphics g, MenuItemLayoutHelper lh,\n+                               MenuItemLayoutHelper.LayoutResult lr,\n+                               Color holdc, Color foreground) {\n+        if (lh.getCheckIcon() != null) {\n+            ButtonModel model = lh.getMenuItem().getModel();\n+            if (model.isArmed() || (lh.getMenuItem() instanceof JMenu\n+                    && model.isSelected())) {\n+                g.setColor(foreground);\n+            } else {\n+                g.setColor(holdc);\n+            }\n+            if (lh.useCheckAndArrow()) {\n+                lh.getCheckIcon().paintIcon(lh.getMenuItem(), g,\n+                        lr.getCheckRect().x, lr.getCheckRect().y);\n+            }\n+            g.setColor(holdc);\n+        }\n+    }\n+\n+    public static void paintIcon(Graphics g, MenuItemLayoutHelper lh,\n+                          MenuItemLayoutHelper.LayoutResult lr, Color holdc) {\n+        if (lh.getIcon() != null) {\n+            Icon icon;\n+            ButtonModel model = lh.getMenuItem().getModel();\n+            if (!model.isEnabled()) {\n+                icon = lh.getMenuItem().getDisabledIcon();\n+            } else if (model.isPressed() && model.isArmed()) {\n+                icon = lh.getMenuItem().getPressedIcon();\n+                if (icon == null) {\n+                    \/\/ Use default icon\n+                    icon = lh.getMenuItem().getIcon();\n+                }\n+            } else {\n+                icon = lh.getMenuItem().getIcon();\n+            }\n+\n+            if (icon != null) {\n+                icon.paintIcon(lh.getMenuItem(), g, lr.getIconRect().x,\n+                        lr.getIconRect().y);\n+                g.setColor(holdc);\n+            }\n+        }\n+    }\n+\n+\n+    public static void paintAccText(Graphics g, MenuItemLayoutHelper lh,\n+                             MenuItemLayoutHelper.LayoutResult lr) {\n+        if (!lh.getAccText().isEmpty()) {\n+            ButtonModel model = lh.getMenuItem().getModel();\n+            g.setFont(lh.getAccFontMetrics().getFont());\n+            if (!model.isEnabled()) {\n+\n+                \/\/ paint the accText disabled\n+                if (disabledForeground != null) {\n+                    g.setColor(disabledForeground);\n+                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n+                            lh.getAccText(), lr.getAccRect().x,\n+                            lr.getAccRect().y + lh.getAccFontMetrics().getAscent());\n+                } else {\n+                    g.setColor(lh.getMenuItem().getBackground().brighter());\n+                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n+                            lh.getAccText(), lr.getAccRect().x,\n+                            lr.getAccRect().y + lh.getAccFontMetrics().getAscent());\n+                    g.setColor(lh.getMenuItem().getBackground().darker());\n+                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n+                            lh.getAccText(), lr.getAccRect().x - 1,\n+                            lr.getAccRect().y + lh.getFontMetrics().getAscent() - 1);\n+                }\n+            } else {\n+\n+                \/\/ paint the accText normally\n+                if (model.isArmed()\n+                        || (lh.getMenuItem() instanceof JMenu\n+                        && model.isSelected())) {\n+                    g.setColor(acceleratorSelectionForeground);\n+                } else {\n+                    g.setColor(acceleratorForeground);\n+                }\n+                SwingUtilities2.drawString(lh.getMenuItem(), g, lh.getAccText(),\n+                        lr.getAccRect().x, lr.getAccRect().y +\n+                                lh.getAccFontMetrics().getAscent());\n+            }\n+        }\n+    }\n+\n+    public static void setDisabledForeground(Color disabledFg) {\n+        disabledForeground = disabledFg;\n+    }\n+\n+    public static void setAcceleratorSelectionForeground(Color acceleratorSelectionFg) {\n+        acceleratorForeground = acceleratorSelectionFg;\n+    }\n+\n+    public static void setAcceleratorForeground(Color acceleratorFg) {\n+        acceleratorForeground = acceleratorFg;\n+    }\n+\n+    public static void paintArrowIcon(Graphics g, MenuItemLayoutHelper lh,\n+                               MenuItemLayoutHelper.LayoutResult lr,\n+                               Color foreground) {\n+        if (lh.getArrowIcon() != null) {\n+            ButtonModel model = lh.getMenuItem().getModel();\n+            if (model.isArmed() || (lh.getMenuItem() instanceof JMenu\n+                    && model.isSelected())) {\n+                g.setColor(foreground);\n+            }\n+            if (lh.useCheckAndArrow()) {\n+                lh.getArrowIcon().paintIcon(lh.getMenuItem(), g,\n+                        lr.getArrowRect().x, lr.getArrowRect().y);\n+            }\n+        }\n+    }\n+\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/java\/swing\/SwingUtilities3.java","additions":135,"deletions":1,"binary":false,"changes":136,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,2 +28,12 @@\n-import java.awt.*;\n-import java.awt.event.*;\n+import java.awt.Color;\n+import java.awt.Component;\n+import java.awt.Dimension;\n+import java.awt.Font;\n+import java.awt.FontMetrics;\n+import java.awt.Graphics;\n+import java.awt.Insets;\n+import java.awt.Point;\n+import java.awt.Rectangle;\n+import java.awt.event.ActionEvent;\n+import java.awt.event.InputEvent;\n+import java.awt.event.MouseEvent;\n@@ -33,3 +43,23 @@\n-import javax.swing.*;\n-import javax.swing.event.*;\n-import javax.swing.plaf.*;\n+import javax.swing.ButtonModel;\n+import javax.swing.Icon;\n+import javax.swing.InputMap;\n+import javax.swing.JCheckBoxMenuItem;\n+import javax.swing.JComponent;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuItem;\n+import javax.swing.JRadioButtonMenuItem;\n+import javax.swing.KeyStroke;\n+import javax.swing.LookAndFeel;\n+import javax.swing.MenuElement;\n+import javax.swing.MenuSelectionManager;\n+import javax.swing.SwingUtilities;\n+import javax.swing.UIManager;\n+import javax.swing.event.MenuDragMouseEvent;\n+import javax.swing.event.MenuDragMouseListener;\n+import javax.swing.event.MenuKeyListener;\n+\n+import javax.swing.event.MouseInputListener;\n+import javax.swing.plaf.ComponentInputMapUIResource;\n+import javax.swing.plaf.ComponentUI;\n+import javax.swing.plaf.MenuItemUI;\n+import javax.swing.plaf.UIResource;\n@@ -38,1 +68,6 @@\n-import sun.swing.*;\n+import com.sun.java.swing.SwingUtilities3;\n+import sun.swing.MenuItemCheckIconFactory;\n+import sun.swing.MenuItemLayoutHelper;\n+import sun.swing.SwingUtilities2;\n+import sun.swing.UIAction;\n+\n@@ -673,21 +708,1 @@\n-        if (lh.getIcon() != null) {\n-            Icon icon;\n-            ButtonModel model = lh.getMenuItem().getModel();\n-            if (!model.isEnabled()) {\n-                icon = lh.getMenuItem().getDisabledIcon();\n-            } else if (model.isPressed() && model.isArmed()) {\n-                icon = lh.getMenuItem().getPressedIcon();\n-                if (icon == null) {\n-                    \/\/ Use default icon\n-                    icon = lh.getMenuItem().getIcon();\n-                }\n-            } else {\n-                icon = lh.getMenuItem().getIcon();\n-            }\n-\n-            if (icon != null) {\n-                icon.paintIcon(lh.getMenuItem(), g, lr.getIconRect().x,\n-                        lr.getIconRect().y);\n-                g.setColor(holdc);\n-            }\n-        }\n+        SwingUtilities3.paintIcon(g, lh, lr, holdc);\n@@ -699,14 +714,1 @@\n-        if (lh.getCheckIcon() != null) {\n-            ButtonModel model = lh.getMenuItem().getModel();\n-            if (model.isArmed() || (lh.getMenuItem() instanceof JMenu\n-                    && model.isSelected())) {\n-                g.setColor(foreground);\n-            } else {\n-                g.setColor(holdc);\n-            }\n-            if (lh.useCheckAndArrow()) {\n-                lh.getCheckIcon().paintIcon(lh.getMenuItem(), g,\n-                        lr.getCheckRect().x, lr.getCheckRect().y);\n-            }\n-            g.setColor(holdc);\n-        }\n+        SwingUtilities3.paintCheckIcon(g, lh, lr, holdc, foreground);\n@@ -717,34 +719,5 @@\n-        if (!lh.getAccText().isEmpty()) {\n-            ButtonModel model = lh.getMenuItem().getModel();\n-            g.setFont(lh.getAccFontMetrics().getFont());\n-            if (!model.isEnabled()) {\n-                \/\/ *** paint the accText disabled\n-                if (disabledForeground != null) {\n-                    g.setColor(disabledForeground);\n-                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n-                        lh.getAccText(), lr.getAccRect().x,\n-                        lr.getAccRect().y + lh.getAccFontMetrics().getAscent());\n-                } else {\n-                    g.setColor(lh.getMenuItem().getBackground().brighter());\n-                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n-                        lh.getAccText(), lr.getAccRect().x,\n-                        lr.getAccRect().y + lh.getAccFontMetrics().getAscent());\n-                    g.setColor(lh.getMenuItem().getBackground().darker());\n-                    SwingUtilities2.drawString(lh.getMenuItem(), g,\n-                        lh.getAccText(), lr.getAccRect().x - 1,\n-                        lr.getAccRect().y + lh.getFontMetrics().getAscent() - 1);\n-                }\n-            } else {\n-                \/\/ *** paint the accText normally\n-                if (model.isArmed()\n-                        || (lh.getMenuItem() instanceof JMenu\n-                        && model.isSelected())) {\n-                    g.setColor(acceleratorSelectionForeground);\n-                } else {\n-                    g.setColor(acceleratorForeground);\n-                }\n-                SwingUtilities2.drawString(lh.getMenuItem(), g, lh.getAccText(),\n-                        lr.getAccRect().x, lr.getAccRect().y +\n-                        lh.getAccFontMetrics().getAscent());\n-            }\n-        }\n+        SwingUtilities3.setDisabledForeground(disabledForeground);\n+        SwingUtilities3.setAcceleratorSelectionForeground(\n+                        acceleratorSelectionForeground);\n+        SwingUtilities3.setAcceleratorForeground(acceleratorForeground);\n+        SwingUtilities3.paintAccText(g, lh, lr);\n@@ -769,11 +742,1 @@\n-        if (lh.getArrowIcon() != null) {\n-            ButtonModel model = lh.getMenuItem().getModel();\n-            if (model.isArmed() || (lh.getMenuItem() instanceof JMenu\n-                                && model.isSelected())) {\n-                g.setColor(foreground);\n-            }\n-            if (lh.useCheckAndArrow()) {\n-                lh.getArrowIcon().paintIcon(lh.getMenuItem(), g,\n-                        lr.getArrowRect().x, lr.getArrowRect().y);\n-            }\n-        }\n+        SwingUtilities3.paintArrowIcon(g, lh, lr, foreground);\n@@ -783,6 +746,1 @@\n-        if(insets != null) {\n-            rect.x += insets.left;\n-            rect.y += insets.top;\n-            rect.width -= (insets.right + rect.x);\n-            rect.height -= (insets.bottom + rect.y);\n-        }\n+        SwingUtilities3.applyInsets(rect, insets);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/basic\/BasicMenuItemUI.java","additions":51,"deletions":93,"binary":false,"changes":144,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import javax.swing.Icon;\n@@ -76,0 +77,18 @@\n+\n+    \/**\n+     * Paint MenuItem.\n+     *\/\n+    protected void paintMenuItem(Graphics g, JComponent c,\n+                                 Icon checkIcon, Icon arrowIcon,\n+                                 Color background, Color foreground,\n+                                 int defaultTextIconGap) {\n+        if (WindowsMenuItemUI.isVistaPainting()) {\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n+                    arrowIcon, background, foreground, defaultTextIconGap,\n+                    menuItem, getPropertyPrefix());\n+            return;\n+        }\n+        super.paintMenuItem(g, c, checkIcon, arrowIcon, background,\n+                foreground, defaultTextIconGap);\n+    }\n+\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsCheckBoxMenuItemUI.java","additions":20,"deletions":1,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -883,0 +883,9 @@\n+                int skinWidth = -1;\n+\n+                \/\/ Windows 10 and Windows 11 have different layout for\n+                \/\/ radiobutton\/checkbox menuitem if image icon is present.\n+                \/\/ Windows 10 doesn't show bullet\/checkmark and just highlight\n+                \/\/ the image icon whereas Windows 11 show bullet\/checkmark\n+                \/\/ beside imageicon so this check is necessary to differentiate\n+                boolean isWindows11OrLater = Integer.parseInt(System.getProperty(\"os.name\")\n+                                                    .replaceAll(\"[^0-9]\", \"\")) >= 11;\n@@ -908,3 +917,11 @@\n-                            skin.paintSkin(g, x, y,\n-                                getIconWidth(), getIconHeight(), backgroundState);\n-                            if (icon == null) {\n+                            if (!isWindows11OrLater) {\n+                                skin.paintSkin(g, x, y,\n+                                        getIconWidth(), getIconHeight(), backgroundState);\n+                                if (icon == null) {\n+                                    skin = xp.getSkin(c, part);\n+                                    skin.paintSkin(g, x + OFFSET, y + OFFSET, state);\n+                                }\n+                            } else {\n+                                skin.paintSkin(g, x, y,\n+                                        getIconWidth(), getIconHeight(), backgroundState);\n+                                skinWidth = getIconWidth();\n@@ -912,1 +929,5 @@\n-                                skin.paintSkin(g, x + OFFSET, y + OFFSET, state);\n+                                if (icon == null || icon.getIconHeight() <= 16) {\n+                                    skin.paintSkin(g, x + OFFSET, y + OFFSET, state);\n+                                } else {\n+                                    skin.paintSkin(g, x + OFFSET, y + icon.getIconHeight() \/ 2, state);\n+                                }\n@@ -918,1 +939,6 @@\n-                    icon.paintIcon(c, g, x + OFFSET, y + OFFSET);\n+                    if (!isWindows11OrLater) {\n+                        icon.paintIcon(c, g, x + OFFSET, y + OFFSET);\n+                    } else {\n+                        icon.paintIcon(c, g, x + VistaMenuItemCheckIconFactory.getIconWidth(),\n+                                y + OFFSET);\n+                    }\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsIconFactory.java","additions":32,"deletions":6,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+import java.awt.Font;\n@@ -31,0 +32,1 @@\n+import java.awt.Insets;\n@@ -34,0 +36,1 @@\n+import java.util.Enumeration;\n@@ -35,0 +38,2 @@\n+import javax.swing.AbstractButton;\n+import javax.swing.ButtonGroup;\n@@ -36,0 +41,2 @@\n+import javax.swing.DefaultButtonModel;\n+import javax.swing.Icon;\n@@ -44,0 +51,1 @@\n+import com.sun.java.swing.SwingUtilities3;\n@@ -62,0 +70,3 @@\n+    private static Color disabledForeground;\n+    private static Color acceleratorSelectionForeground;\n+    private static Color acceleratorForeground;\n@@ -126,0 +137,21 @@\n+    protected void installDefaults() {\n+        super.installDefaults();\n+        String prefix = getPropertyPrefix();\n+\n+        if (acceleratorSelectionForeground == null ||\n+                acceleratorSelectionForeground instanceof UIResource) {\n+            acceleratorSelectionForeground =\n+                    UIManager.getColor(prefix + \".acceleratorSelectionForeground\");\n+        }\n+        if (acceleratorForeground == null ||\n+                acceleratorForeground instanceof UIResource) {\n+            acceleratorForeground =\n+                    UIManager.getColor(prefix + \".acceleratorForeground\");\n+        }\n+        if (disabledForeground == null ||\n+                disabledForeground instanceof UIResource) {\n+            disabledForeground =\n+                    UIManager.getColor(prefix + \".disabledForeground\");\n+        }\n+    }\n+\n@@ -138,0 +170,110 @@\n+    private static void applyInsets(Rectangle rect, Insets insets) {\n+        SwingUtilities3.applyInsets(rect, insets);\n+    }\n+\n+    private static void paintCheckIcon(Graphics g, MenuItemLayoutHelper lh,\n+                                MenuItemLayoutHelper.LayoutResult lr,\n+                                Color holdc, Color foreground) {\n+        SwingUtilities3.paintCheckIcon(g, lh, lr, holdc, foreground);\n+    }\n+\n+    private static void paintIcon(Graphics g, MenuItemLayoutHelper lh,\n+                           MenuItemLayoutHelper.LayoutResult lr, Color holdc) {\n+        SwingUtilities3.paintIcon(g, lh, lr, holdc);\n+    }\n+\n+    private static void paintAccText(Graphics g, MenuItemLayoutHelper lh,\n+                              MenuItemLayoutHelper.LayoutResult lr) {\n+        SwingUtilities3.setDisabledForeground(disabledForeground);\n+        SwingUtilities3.setAcceleratorSelectionForeground(\n+                        acceleratorSelectionForeground);\n+        SwingUtilities3.setAcceleratorForeground(acceleratorForeground);\n+        SwingUtilities3.paintAccText(g, lh, lr);\n+    }\n+\n+    private static void paintArrowIcon(Graphics g, MenuItemLayoutHelper lh,\n+                                MenuItemLayoutHelper.LayoutResult lr,\n+                                Color foreground) {\n+        SwingUtilities3.paintArrowIcon(g, lh, lr, foreground);\n+    }\n+\n+    protected void paintMenuItem(Graphics g, JComponent c,\n+                                 Icon checkIcon, Icon arrowIcon,\n+                                 Color background, Color foreground,\n+                                 int defaultTextIconGap) {\n+        if (WindowsMenuItemUI.isVistaPainting()) {\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n+                                            arrowIcon, background, foreground,\n+                                            defaultTextIconGap, menuItem,\n+                                            getPropertyPrefix());\n+            return;\n+        }\n+        super.paintMenuItem(g, c, checkIcon, arrowIcon, background,\n+                foreground, defaultTextIconGap);\n+    }\n+\n+    static void paintMenuItem(WindowsMenuItemUIAccessor accessor, Graphics g,\n+                              JComponent c, Icon checkIcon, Icon arrowIcon,\n+                              Color background, Color foreground,\n+                              int defaultTextIconGap, JMenuItem menuItem, String prefix) {\n+        \/\/ Save original graphics font and color\n+        Font holdf = g.getFont();\n+        Color holdc = g.getColor();\n+\n+        JMenuItem mi = (JMenuItem) c;\n+        g.setFont(mi.getFont());\n+\n+        Rectangle viewRect = new Rectangle(0, 0, mi.getWidth(), mi.getHeight());\n+        applyInsets(viewRect, mi.getInsets());\n+\n+        String acceleratorDelimiter =\n+                UIManager.getString(\"MenuItem.acceleratorDelimiter\");\n+        if (acceleratorDelimiter == null) { acceleratorDelimiter = \"+\"; }\n+        Font acceleratorFont = UIManager.getFont(\"MenuItem.acceleratorFont\");\n+        if (acceleratorFont == null) {\n+            acceleratorFont = UIManager.getFont(\"MenuItem.font\");\n+        }\n+\n+        MenuItemLayoutHelper lh = new MenuItemLayoutHelper(mi, checkIcon,\n+                arrowIcon, viewRect, defaultTextIconGap, acceleratorDelimiter,\n+                mi.getComponentOrientation().isLeftToRight(), mi.getFont(),\n+                acceleratorFont, MenuItemLayoutHelper.useCheckAndArrow(menuItem),\n+                prefix);\n+        MenuItemLayoutHelper.LayoutResult lr = lh.layoutMenuItem();\n+\n+        paintBackground(accessor, g, mi, background);\n+        paintCheckIcon(g, lh, lr, holdc, foreground);\n+        paintIcon(g, lh, lr, holdc);\n+\n+        boolean isWindows11OrLater = Integer.parseInt(System.getProperty(\"os.name\")\n+                                                    .replaceAll(\"[^0-9]\", \"\")) >= 11;\n+        if (isWindows11OrLater && lh.getCheckIcon() != null && lh.useCheckAndArrow()) {\n+            Rectangle rect = lr.getTextRect();\n+\n+            rect.x += lh.getAfterCheckIconGap();\n+\n+            lr.setTextRect(rect);\n+        }\n+        if (!lh.getText().isEmpty()) {\n+            if (lh.getHtmlView() != null) {\n+                \/\/ Text is HTML\n+                lh.getHtmlView().paint(g, lr.getTextRect());\n+            } else {\n+                \/\/ Text isn't HTML\n+                paintText(accessor, g, lh.getMenuItem(),\n+                          lr.getTextRect(), lh.getText());\n+            }\n+        }\n+        if (isWindows11OrLater && lh.getCheckIcon() != null && lh.useCheckAndArrow()) {\n+            Rectangle rect = lr.getAccRect();\n+            rect.x += lh.getAfterCheckIconGap();\n+            lr.setAccRect(rect);\n+        }\n+        paintAccText(g, lh, lr);\n+        paintArrowIcon(g, lh, lr, foreground);\n+\n+        \/\/ Restore original graphics font and color\n+        g.setColor(holdc);\n+        g.setFont(holdf);\n+    }\n+\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsMenuItemUI.java","additions":143,"deletions":1,"binary":false,"changes":144,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -133,0 +133,19 @@\n+    \/**\n+     * Paint MenuItem.\n+     *\/\n+    protected void paintMenuItem(Graphics g, JComponent c,\n+                              Icon checkIcon, Icon arrowIcon,\n+                              Color background, Color foreground,\n+                              int defaultTextIconGap) {\n+        if (WindowsMenuItemUI.isVistaPainting()) {\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon, arrowIcon,\n+                                            background, foreground,\n+                                            defaultTextIconGap, menuItem,\n+                                            getPropertyPrefix());\n+            return;\n+        }\n+        super.paintMenuItem(g, c, checkIcon, arrowIcon, background,\n+                                   foreground, defaultTextIconGap);\n+    }\n+\n+\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsMenuUI.java","additions":20,"deletions":1,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import javax.swing.Icon;\n@@ -77,0 +78,17 @@\n+    \/**\n+     * Paint MenuItem.\n+     *\/\n+    protected void paintMenuItem(Graphics g, JComponent c,\n+                                 Icon checkIcon, Icon arrowIcon,\n+                                 Color background, Color foreground,\n+                                 int defaultTextIconGap) {\n+        if (WindowsMenuItemUI.isVistaPainting()) {\n+            WindowsMenuItemUI.paintMenuItem(accessor, g, c, checkIcon,\n+                    arrowIcon, background, foreground, defaultTextIconGap,\n+                    menuItem, getPropertyPrefix());\n+            return;\n+        }\n+        super.paintMenuItem(g, c, checkIcon, arrowIcon, background,\n+                foreground, defaultTextIconGap);\n+    }\n+\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsRadioButtonMenuItemUI.java","additions":19,"deletions":1,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -0,0 +1,155 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8348760\n+ * @summary Verify if RadioButtonMenuItem bullet and\n+ *          JCheckboxMenuItem checkmark is shown if\n+ *          JRadioButtonMenuItem and JCheckboxMenuItem\n+ *          is rendered with ImageIcon in WindowsLookAndFeel\n+ * @requires (os.family == \"windows\")\n+ * @library \/java\/awt\/regtesthelpers\n+ * @build PassFailJFrame\n+ * @run main\/manual TestRadioAndCheckMenuItemWithIcon\n+ *\/\n+\n+import java.awt.Color;\n+import java.awt.Graphics;\n+import java.awt.event.ActionEvent;\n+import java.awt.event.KeyEvent;\n+import java.awt.image.BufferedImage;\n+\n+import javax.swing.AbstractButton;\n+import javax.swing.ButtonGroup;\n+import javax.swing.ImageIcon;\n+import javax.swing.JCheckBoxMenuItem;\n+import javax.swing.JFrame;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuBar;\n+import javax.swing.JMenuItem;\n+import javax.swing.JPanel;\n+import javax.swing.JRadioButtonMenuItem;\n+import javax.swing.KeyStroke;\n+import javax.swing.UIManager;\n+\n+public class TestRadioAndCheckMenuItemWithIcon {\n+\n+    private static final String INSTRUCTIONS = \"\"\"\n+        A top level Menu will be shown.\n+\n+        Clicking on the Menu will show a\n+        JRadioButtonMenuItem group with 3 radiobutton menuitems\n+        and a JCheckBoxMenuItem group with 3 checkbox menuitems.\n+\n+        First radiobutton menuitem is selected with imageicon of a red square.\n+        Second radiobutton menuitem is unselected with imageicon.\n+        Third radiobutton menuItem is unselected without imageicon.\n+\n+        First checkbox menuitem is selected with imageicon.\n+        Second checkbox menuitem is unselected with imageicon.\n+        Third checkbox menuItem is unselected without imageicon.\n+\n+        Verify that for first JRadioButtonMenuItem with imageicon,\n+        a bullet is shown alongside the imageicon and\n+        for first JCheckBoxMenuItem with imageicon\n+        a checkmark is shown alongside the imageicon.\n+\n+        If bullet and checkmark is shown, test passes else fails.\"\"\";\n+\n+    public static void main(String[] args) throws Exception {\n+        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());\n+        PassFailJFrame.builder()\n+                .title(\"JRadioButtonMenuItem Instructions\")\n+                .instructions(INSTRUCTIONS)\n+                .columns(60)\n+                .testUI(TestRadioAndCheckMenuItemWithIcon::doTest)\n+                .build()\n+                .awaitAndCheck();\n+    }\n+\n+    public static JFrame doTest() {\n+        BufferedImage img = new BufferedImage(16, 16, BufferedImage.TYPE_INT_ARGB);\n+        Graphics g = img.getGraphics();\n+        g.setColor(Color.red);\n+        g.fillRect(0, 0, img.getWidth(), img.getHeight());\n+        g.dispose();\n+\n+        BufferedImage img2 = new BufferedImage(64, 64, BufferedImage.TYPE_INT_ARGB);\n+        Graphics g2 = img2.getGraphics();\n+        g2.setColor(Color.red);\n+        g2.fillRect(0, 0, img2.getWidth(), img2.getHeight());\n+        g2.dispose();\n+\n+        JFrame frame = new JFrame(\"RadioButtonWithImageIcon\");\n+        ImageIcon imageIcon1 = new ImageIcon(img);\n+        ImageIcon imageIcon2 = new ImageIcon(img2);\n+        AbstractButton button1;\n+        JRadioButtonMenuItem m1 = new JRadioButtonMenuItem(\"JRadioButtonMenuItem 1\",\n+                imageIcon1);\n+        m1.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_F4, ActionEvent.ALT_MASK|ActionEvent.CTRL_MASK|ActionEvent.SHIFT_MASK));\n+        button1 = m1;\n+        button1.setSelected(true);\n+        AbstractButton button2 = new JRadioButtonMenuItem(\"JRadioButtonMenuItem 2\", imageIcon2);\n+        AbstractButton button3 = new JRadioButtonMenuItem(\"JRadioButtonMenuItem 3\");\n+\n+        ButtonGroup buttonGroup = new ButtonGroup();\n+        buttonGroup.add(button1);\n+        buttonGroup.add(button2);\n+        buttonGroup.add(button3);\n+\n+        AbstractButton check1 = new JCheckBoxMenuItem(\"JCheckBoxMenuItem 1\",\n+                imageIcon1);\n+        check1.setSelected(true);\n+        AbstractButton check2 = new JCheckBoxMenuItem(\"JCheckBoxMenuItem 2\", imageIcon1);\n+        JCheckBoxMenuItem c3;\n+        AbstractButton check3 = c3 = new JCheckBoxMenuItem(\"JCheckBoxMenuItem 3\");\n+        c3.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_F5, ActionEvent.ALT_MASK|ActionEvent.CTRL_MASK|ActionEvent.SHIFT_MASK));\n+\n+        JMenu topLevel = new JMenu(\"Menu\");\n+\n+        topLevel.add(button1);\n+        topLevel.add(button2);\n+        topLevel.add(button3);\n+\n+        topLevel.addSeparator();\n+\n+        topLevel.add(check1);\n+        topLevel.add(check2);\n+        topLevel.add(check3);\n+\n+        AbstractButton menuitem1 = new JMenuItem(\"MenuItem1\");\n+        AbstractButton menuitem2 = new JMenuItem(\"MenuItem2\", imageIcon1);\n+        topLevel.addSeparator();\n+        topLevel.add(menuitem1);\n+        topLevel.add(menuitem2);\n+\n+        JMenuBar menuBar = new JMenuBar();\n+        menuBar.add(topLevel);\n+\n+        frame.setJMenuBar(menuBar);\n+        frame.setSize(300, 300);\n+        return frame;\n+\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/JMenuItem\/TestRadioAndCheckMenuItemWithIcon.java","additions":155,"deletions":0,"binary":false,"changes":155,"status":"added"}]}