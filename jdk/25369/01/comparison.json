{"files":[{"patch":"@@ -154,1 +154,1 @@\n-void JVMCI::initialize_compiler(TRAPS) {\n+void JVMCI::initialize_compiler_in_create_vm(TRAPS) {\n@@ -165,1 +165,6 @@\n-  runtime->call_getCompiler(CHECK);\n+\n+  JVMCIENV_FROM_THREAD(THREAD);\n+  JVMCIENV->check_init(CHECK);\n+  JVMCIObject jvmciRuntime = runtime->get_HotSpotJVMCIRuntime(JVMCI_CHECK);\n+  runtime->initialize(JVMCI_CHECK);\n+  JVMCIENV->call_HotSpotJVMCIRuntime_getCompiler(jvmciRuntime, JVMCI_CHECK);\n","filename":"src\/hotspot\/share\/jvmci\/jvmci.cpp","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -194,3 +194,2 @@\n-  \/\/ Called to force initialization of the JVMCI compiler\n-  \/\/ early in VM startup.\n-  static void initialize_compiler(TRAPS);\n+  \/\/ Initializes the JVMCI compiler during VM startup.\n+  static void initialize_compiler_in_create_vm(TRAPS);\n","filename":"src\/hotspot\/share\/jvmci\/jvmci.hpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -254,3 +254,0 @@\n-  if (_init_error == JNI_ENOMEM) {\n-    THROW_MSG(vmSymbols::java_lang_OutOfMemoryError(), \"JNI_ENOMEM creating or attaching to libjvmci\");\n-  }\n@@ -259,1 +256,1 @@\n-           _init_error, _init_error_msg == nullptr ? \"unknown\" : _init_error_msg);\n+            _init_error, _init_error_msg != nullptr ? _init_error_msg : (_init_error == JNI_ENOMEM ? \"JNI_ENOMEM\" : \"none\"));\n","filename":"src\/hotspot\/share\/jvmci\/jvmciEnv.cpp","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -746,8 +746,0 @@\n-void JVMCIRuntime::call_getCompiler(TRAPS) {\n-  JVMCIENV_FROM_THREAD(THREAD);\n-  JVMCIENV->check_init(CHECK);\n-  JVMCIObject jvmciRuntime = JVMCIRuntime::get_HotSpotJVMCIRuntime(JVMCI_CHECK);\n-  initialize(JVMCI_CHECK);\n-  JVMCIENV->call_HotSpotJVMCIRuntime_getCompiler(jvmciRuntime, JVMCI_CHECK);\n-}\n-\n","filename":"src\/hotspot\/share\/jvmci\/jvmciRuntime.cpp","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -378,2 +378,0 @@\n-  void call_getCompiler(TRAPS);\n-\n","filename":"src\/hotspot\/share\/jvmci\/jvmciRuntime.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -838,1 +838,1 @@\n-    JVMCI::initialize_compiler(CHECK_JNI_ERR);\n+    JVMCI::initialize_compiler_in_create_vm(CHECK_JNI_ERR);\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}