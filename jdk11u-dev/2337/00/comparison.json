{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n-\n@@ -35,0 +34,1 @@\n+import javax.security.auth.login.FailedLoginException;\n@@ -37,0 +37,4 @@\n+\n+    private static final String UNIX_MODULE = \"UnixLoginModule\";\n+    private static final String NT_MODULE = \"NTLoginModule\";\n+\n@@ -39,13 +43,4 @@\n-                \"UnixLoginModule\", \"optional\",\n-                \"NTLoginModule\", \"optional\",\n-                \"SolarisLoginModule\", \"optional\");\n-        try {\n-            login(\"windows\", \"NTLoginModule\", \"required\");\n-            login(\"unix\", \"UnixLoginModule\", \"required\");\n-            login(\"solaris\", \"SolarisLoginModule\", \"required\");\n-        } catch (Exception e) {\n-            e.printStackTrace(System.out);\n-            if (e.toString().contains(\"UnsatisfiedLinkError\")) {\n-                throw new Exception(\"This is ugly\");\n-            }\n-        }\n+                UNIX_MODULE, \"optional\",\n+                NT_MODULE, \"optional\");\n+        login(\"windows\", NT_MODULE, \"required\");\n+        login(\"unix\", UNIX_MODULE, \"required\");\n@@ -59,3 +54,4 @@\n-        for (int i=0; i<conf.length; i+=2) {\n-            sb.append(\"    com.sun.security.auth.module.\" + conf[i]\n-                    + \" \" + conf[i+1] + \";\\n\");\n+        for (int i = 0; i < conf.length; i += 2) {\n+            sb.append(\"    com.sun.security.auth.module.\")\n+                    .append(conf[i]).append(\" \")\n+                    .append(conf[i + 1]).append(\";\\n\");\n@@ -70,3 +66,12 @@\n-        LoginContext lc = new LoginContext(\"hello\");\n-        lc.login();\n-        System.out.println(lc.getSubject());\n+        try {\n+            LoginContext lc = new LoginContext(\"hello\");\n+            lc.login();\n+            System.out.println(lc.getSubject());\n+            lc.logout();\n+        } catch (FailedLoginException e) {\n+            \/\/ This exception can occur in other platform module than the running one.\n+            if(e.getMessage().startsWith(\"Failed in attempt to import\")) {\n+                System.out.println(\"Expected Exception found.\");\n+                e.printStackTrace(System.out);\n+            }\n+        }\n","filename":"test\/jdk\/com\/sun\/security\/auth\/module\/AllPlatforms.java","additions":26,"deletions":21,"binary":false,"changes":47,"status":"modified"}]}