{"files":[{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2008, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n- * @author Denis Sharypov\n@@ -33,2 +32,8 @@\n-import java.awt.*;\n-import javax.swing.*;\n+\n+import java.awt.Color;\n+import java.awt.Dimension;\n+import java.awt.Point;\n+import java.awt.Robot;\n+import javax.swing.JFrame;\n+import javax.swing.SwingUtilities;\n+import javax.swing.JLabel;\n@@ -39,0 +44,1 @@\n+    private static JFrame mainFrame;\n@@ -42,1 +48,0 @@\n-        robot.setAutoDelay(50);\n@@ -44,1 +49,2 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n+        try {\n+            SwingUtilities.invokeAndWait(new Runnable() {\n@@ -46,5 +52,5 @@\n-            @Override\n-            public void run() {\n-                createAndShowGUI();\n-            }\n-        });\n+                @Override\n+                public void run() {\n+                    createAndShowGUI();\n+                }\n+            });\n@@ -52,1 +58,2 @@\n-        robot.waitForIdle();\n+            robot.waitForIdle();\n+            robot.delay(1000);\n@@ -54,1 +61,1 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n+            SwingUtilities.invokeAndWait(new Runnable() {\n@@ -56,3 +63,3 @@\n-            @Override\n-            public void run() {\n-                boolean passed = false;\n+                @Override\n+                public void run() {\n+                    boolean passed = false;\n@@ -60,4 +67,4 @@\n-                Point p = htmlComponent.getLocationOnScreen();\n-                Dimension d = htmlComponent.getSize();\n-                int x0 = p.x;\n-                int y = p.y + d.height \/ 2;\n+                    Point p = htmlComponent.getLocationOnScreen();\n+                    Dimension d = htmlComponent.getSize();\n+                    int x0 = p.x;\n+                    int y = p.y + d.height \/ 2;\n@@ -65,4 +72,5 @@\n-                for (int x = x0; x < x0 + d.width; x++) {\n-                    if (robot.getPixelColor(x, y).equals(Color.blue)) {\n-                        passed = true;\n-                        break;\n+                    for (int x = x0; x < x0 + d.width; x++) {\n+                        if (robot.getPixelColor(x, y).equals(Color.blue)) {\n+                            passed = true;\n+                            break;\n+                        }\n@@ -70,1 +78,0 @@\n-                }\n@@ -72,3 +79,3 @@\n-                if (!passed) {\n-                    throw new RuntimeException(\"Test failed.\");\n-                }\n+                    if (!passed) {\n+                        throw new RuntimeException(\"Test failed.\");\n+                    }\n@@ -76,2 +83,9 @@\n-            }\n-        });\n+                }\n+            });\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (mainFrame != null) {\n+                    mainFrame.dispose();\n+                }\n+            });\n+        }\n@@ -89,1 +103,1 @@\n-        JFrame mainFrame = new JFrame(\"bug4251579\");\n+        mainFrame = new JFrame(\"bug4251579\");\n@@ -95,0 +109,1 @@\n+        mainFrame.setLocationRelativeTo(null);\n","filename":"test\/jdk\/javax\/swing\/plaf\/basic\/BasicHTML\/4251579\/bug4251579.java","additions":46,"deletions":31,"binary":false,"changes":77,"status":"modified"}]}