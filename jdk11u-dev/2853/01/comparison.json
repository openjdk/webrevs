{"files":[{"patch":"@@ -106,2 +106,2 @@\n-void getDeviceString(char* buffer, int card, int device, int subdevice,\n-                     int usePlugHw, int isMidi) {\n+void getDeviceString(char* buffer, size_t bufferSize, int card, int device,\n+                     int subdevice, int usePlugHw, int isMidi) {\n@@ -109,1 +109,1 @@\n-        sprintf(buffer, \"%s:%d,%d,%d\",\n+        snprintf(buffer, bufferSize, \"%s:%d,%d,%d\",\n@@ -113,1 +113,1 @@\n-        sprintf(buffer, \"%s:%d,%d\",\n+        snprintf(buffer, bufferSize, \"%s:%d,%d\",\n@@ -120,2 +120,2 @@\n-void getDeviceStringFromDeviceID(char* buffer, UINT32 deviceID,\n-                                 int usePlugHw, int isMidi) {\n+void getDeviceStringFromDeviceID(char* buffer, size_t bufferSize,\n+                                 UINT32 deviceID, int usePlugHw, int isMidi) {\n@@ -128,1 +128,1 @@\n-        getDeviceString(buffer, card, device, subdevice, usePlugHw, isMidi);\n+        getDeviceString(buffer, bufferSize, card, device, subdevice, usePlugHw, isMidi);\n","filename":"src\/java.desktop\/linux\/native\/libjsound\/PLATFORM_API_LinuxOS_ALSA_CommonUtils.c","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -76,2 +76,2 @@\n-void getDeviceStringFromDeviceID(char* buffer, UINT32 deviceID,\n-                                 int usePlugHw, int isMidi);\n+void getDeviceStringFromDeviceID(char* buffer, size_t bufferSize,\n+                                 UINT32 deviceID, int usePlugHw, int isMidi);\n","filename":"src\/java.desktop\/linux\/native\/libjsound\/PLATFORM_API_LinuxOS_ALSA_CommonUtils.h","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -101,1 +101,1 @@\n-                sprintf(devname, ALSA_HARDWARE_CARD, card);\n+                snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, card);\n@@ -124,1 +124,1 @@\n-            sprintf(devname, ALSA_HARDWARE_CARD, card);\n+            snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, card);\n@@ -233,1 +233,1 @@\n-        getDeviceStringFromDeviceID(&buffer[2], deviceID, usePlugHw, ALSA_RAWMIDI);\n+        getDeviceStringFromDeviceID(&buffer[2], sizeof(buffer) - 2, deviceID, usePlugHw, ALSA_RAWMIDI);\n@@ -395,1 +395,1 @@\n-    getDeviceStringFromDeviceID(devicename, deviceID,\n+    getDeviceStringFromDeviceID(devicename, sizeof(devicename), deviceID,\n","filename":"src\/java.desktop\/linux\/native\/libjsound\/PLATFORM_API_LinuxOS_ALSA_MidiUtils.c","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -78,1 +78,1 @@\n-                sprintf(devname, ALSA_HARDWARE_CARD, card);\n+                snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, card);\n@@ -104,1 +104,1 @@\n-        sprintf(devname, ALSA_HARDWARE_CARD, card);\n+        snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, card);\n@@ -188,1 +188,1 @@\n-        getDeviceStringFromDeviceID(&buffer[2], deviceID, usePlugHw, ALSA_PCM);\n+        getDeviceStringFromDeviceID(&buffer[2], sizeof(buffer) - 2, deviceID, usePlugHw, ALSA_PCM);\n@@ -220,1 +220,1 @@\n-    getDeviceStringFromDeviceID(buffer, deviceID, !hardware, ALSA_PCM);\n+    getDeviceStringFromDeviceID(buffer, sizeof(buffer), deviceID, !hardware, ALSA_PCM);\n","filename":"src\/java.desktop\/linux\/native\/libjsound\/PLATFORM_API_LinuxOS_ALSA_PCMUtils.c","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -88,1 +88,1 @@\n-            sprintf(devname, ALSA_HARDWARE_CARD, card);\n+            snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, card);\n@@ -118,1 +118,1 @@\n-    sprintf(devname, ALSA_HARDWARE_CARD, (int) mixerIndex);\n+    snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, (int) mixerIndex);\n@@ -130,1 +130,1 @@\n-    sprintf(buffer, \" [%s]\", devname);\n+    snprintf(buffer, sizeof(buffer), \" [%s]\", devname);\n@@ -152,1 +152,1 @@\n-    sprintf(devname, ALSA_HARDWARE_CARD, (int) mixerIndex);\n+    snprintf(devname, sizeof(devname), ALSA_HARDWARE_CARD, (int) mixerIndex);\n","filename":"src\/java.desktop\/linux\/native\/libjsound\/PLATFORM_API_LinuxOS_ALSA_Ports.c","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -105,1 +105,1 @@\n-        sprintf(s, \"%s-%s:%d\", __FILE__, __FUNCTION__, __LINE__);       \\\n+        snprintf(s, sizeof(s), \"%s-%s:%d\", __FILE__, __FUNCTION__, __LINE__);       \\\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/font\/AWTStrike.m","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -282,1 +282,1 @@\n-    sprintf(report, reportFormat, header->filename, header->linenumber, header->size, header->order);\n+    snprintf(report, sizeof(report), reportFormat, header->filename, header->linenumber, header->size, header->order);\n","filename":"src\/java.desktop\/share\/native\/common\/awt\/debug\/debug_mem.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -219,1 +219,1 @@\n-    vsprintf(DTraceBuffer, fmt, arglist);\n+    vsnprintf(DTraceBuffer, sizeof(DTraceBuffer), fmt, arglist);\n","filename":"src\/java.desktop\/share\/native\/common\/awt\/debug\/debug_trace.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n- * a call to sprintf().  See the OGLBufImgOps_CreateConvolveProgram() method\n+ * a call to snprintf().  See the OGLBufImgOps_CreateConvolveProgram() method\n@@ -144,1 +144,1 @@\n-        sprintf(edge, \"sum = vec4(0.0);\");\n+        snprintf(edge, sizeof(edge), \"sum = vec4(0.0);\");\n@@ -147,1 +147,1 @@\n-        sprintf(edge,\n+        snprintf(edge, sizeof(edge),\n@@ -153,1 +153,1 @@\n-    sprintf(finalSource, convolveShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), convolveShaderSource,\n@@ -299,1 +299,1 @@\n- * simply by filling in these \"holes\" with a call to sprintf().  See the\n+ * simply by filling in these \"holes\" with a call to snprintf().  See the\n@@ -363,1 +363,1 @@\n-    sprintf(finalSource, rescaleShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), rescaleShaderSource,\n@@ -505,1 +505,1 @@\n- * simply by filling in these \"holes\" with a call to sprintf().  See the\n+ * simply by filling in these \"holes\" with a call to snprintf().  See the\n@@ -595,1 +595,1 @@\n-    sprintf(finalSource, lookupShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), lookupShaderSource,\n","filename":"src\/java.desktop\/share\/native\/common\/java2d\/opengl\/OGLBufImgOps.c","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -581,1 +581,1 @@\n-        sprintf(cycleCode, noCycleCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), noCycleCode, texCoordCalcCode);\n@@ -583,1 +583,1 @@\n-        sprintf(cycleCode, reflectCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), reflectCode, texCoordCalcCode);\n@@ -585,1 +585,1 @@\n-        sprintf(cycleCode, repeatCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), repeatCode, texCoordCalcCode);\n@@ -589,1 +589,1 @@\n-    sprintf(finalSource, multiGradientShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), multiGradientShaderSource,\n","filename":"src\/java.desktop\/share\/native\/common\/java2d\/opengl\/OGLPaints.c","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -390,1 +390,1 @@\n-    sprintf(buf, \"%d\", err->request_code);\n+    snprintf(buf, sizeof(buf), \"%d\", err->request_code);\n","filename":"src\/java.desktop\/unix\/native\/libsplashscreen\/splashscreen_sys.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -82,1 +82,1 @@\n-        sprintf(pargs,\n+        snprintf(pargs, sizeof(pargs),\n@@ -147,1 +147,1 @@\n-    sprintf(array, \"const DWORD *%sShaders[] =\\n{\\n\", name);\n+    snprintf(array, sizeof(array), \"const DWORD *%sShaders[] =\\n{\\n\", name);\n@@ -151,1 +151,1 @@\n-            sprintf(elem, \"    NULL,\\n\");\n+            snprintf(elem, sizeof(elem), \"    NULL,\\n\");\n@@ -153,1 +153,1 @@\n-            sprintf(elem, \"    %s%d,\\n\", name, i);\n+            snprintf(elem, sizeof(elem), \"    %s%d,\\n\", name, i);\n@@ -228,1 +228,1 @@\n-    sprintf(finalSource, convolveShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), convolveShaderSource,\n@@ -286,1 +286,1 @@\n-    sprintf(finalSource, rescaleShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), rescaleShaderSource,\n@@ -360,1 +360,1 @@\n-    sprintf(finalSource, lookupShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), lookupShaderSource,\n@@ -455,1 +455,1 @@\n-    sprintf(finalSource, basicGradientShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), basicGradientShaderSource,\n@@ -668,1 +668,1 @@\n-        sprintf(cycleCode, noCycleCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), noCycleCode, texCoordCalcCode);\n@@ -670,1 +670,1 @@\n-        sprintf(cycleCode, reflectCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), reflectCode, texCoordCalcCode);\n@@ -672,1 +672,1 @@\n-        sprintf(cycleCode, repeatCode, texCoordCalcCode);\n+        snprintf(cycleCode, sizeof(cycleCode), repeatCode, texCoordCalcCode);\n@@ -676,1 +676,1 @@\n-    sprintf(finalSource, multiGradientShaderSource,\n+    snprintf(finalSource, sizeof(finalSource), multiGradientShaderSource,\n","filename":"src\/java.desktop\/windows\/native\/libawt\/java2d\/d3d\/D3DShaderGen.c","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -303,1 +303,1 @@\n-        sprintf(c, \"Could not initialize COM: HRESULT=0x%08X\", hr);\n+        snprintf(c, sizeof(c), \"Could not initialize COM: HRESULT=0x%08X\", hr);\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/ShellFolder2.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1337,1 +1337,1 @@\n-            sprintf(szBuf, \"0x%8.8x(%s):Unknown message 0x%8.8x\\n\",\n+            snprintf(szBuf, sizeof(szBuf), \"0x%8.8x(%s):Unknown message 0x%8.8x\\n\",\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Component.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -285,1 +285,1 @@\n-        sprintf(name, \"%d.%d\", (midiInCaps.vDriverVersion & 0xFF00) >> 8, midiInCaps.vDriverVersion & 0xFF);\n+        snprintf(name, nameLength + 1, \"%d.%d\", (midiInCaps.vDriverVersion & 0xFF00) >> 8, midiInCaps.vDriverVersion & 0xFF);\n","filename":"src\/java.desktop\/windows\/native\/libjsound\/PLATFORM_API_WinOS_MidiIn.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -142,1 +142,1 @@\n-        sprintf(name, \"%d.%d\", (midiOutCaps.vDriverVersion & 0xFF00) >> 8, midiOutCaps.vDriverVersion & 0xFF);\n+        snprintf(name, nameLength + 1, \"%d.%d\", (midiOutCaps.vDriverVersion & 0xFF00) >> 8, midiOutCaps.vDriverVersion & 0xFF);\n","filename":"src\/java.desktop\/windows\/native\/libjsound\/PLATFORM_API_WinOS_MidiOut.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -116,2 +116,3 @@\n-        r += strlen(ret);\n-        sprintf((char*) r, \"%d\", flags);\n+        size_t usedLen = strlen(ret);\n+        r += usedLen;\n+        snprintf((char*) r, sizeof(ret) - usedLen, \"%d\", flags);\n@@ -222,2 +223,3 @@\n-        r += strlen(ret);\n-        sprintf((char*) r, \"%d\", controlState);\n+        size_t usedLen = strlen(ret);\n+        r += usedLen;\n+        snprintf((char*) r, sizeof(ret) - usedLen, \"%d\", controlState);\n@@ -362,1 +364,1 @@\n-        sprintf(description->version, \"%d.%d\", (mixerCaps.vDriverVersion & 0xFF00) >> 8, mixerCaps.vDriverVersion & 0xFF);\n+        snprintf(description->version, sizeof(description->version), \"%d.%d\", (mixerCaps.vDriverVersion & 0xFF00) >> 8, mixerCaps.vDriverVersion & 0xFF);\n","filename":"src\/java.desktop\/windows\/native\/libjsound\/PLATFORM_API_WinOS_Ports.c","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -163,4 +163,4 @@\n-    sprintf(bp, \"#%d\/%d\", bn, le_kind); bp += strlen(bp);\n-    if (le_bci != 0)  { sprintf(bp, \"\/bci%d\",  le_bci);  bp += strlen(bp); }\n-    if (le_back != 0) { sprintf(bp, \"\/back%d\", le_back); bp += strlen(bp); }\n-    if (le_len != 0)  { sprintf(bp, \"\/len%d\",  le_len);  bp += strlen(bp); }\n+    int nbytes = snprintf(bp, sizeof(b_name_buf), \"#%d\/%d\", bn, le_kind); bp += nbytes;\n+    if (le_bci != 0)  { nbytes += snprintf(bp, sizeof(b_name_buf) - nbytes, \"\/bci%d\",  le_bci);  bp += nbytes; }\n+    if (le_back != 0) { nbytes += snprintf(bp, sizeof(b_name_buf) - nbytes, \"\/back%d\", le_back); bp += nbytes; }\n+    if (le_len != 0)  { nbytes += snprintf(bp, sizeof(b_name_buf) - nbytes, \"\/len%d\",  le_len);  bp += nbytes; }\n","filename":"src\/jdk.pack\/share\/native\/common-unpack\/bands.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -979,1 +979,2 @@\n-  buf.malloc(100);\n+  int buf_len = 100;\n+  buf.malloc(buf_len);\n@@ -981,5 +982,5 @@\n-  sprintf(maxS, \"%d\", max);\n-  sprintf(minS, \"%d\", min);\n-  if (max == INT_MAX_VALUE)  strcpy(maxS, \"max\");\n-  if (min == INT_MIN_VALUE)  strcpy(minS, \"min\");\n-  sprintf((char*)buf.ptr, \"(%d,%d,%d,%d) L=%d r=[%s,%s]\",\n+  int nmax = snprintf(maxS, sizeof(maxS), \"%d\", max);\n+  int nmin = snprintf(minS, sizeof(minS), \"%d\", min);\n+  if (max == INT_MAX_VALUE)  snprintf(maxS + nmax, sizeof(maxS) - nmax, \"max\");\n+  if (min == INT_MIN_VALUE)  snprintf(minS + nmin, sizeof(minS) - nmin, \"min\");\n+  snprintf((char*)buf.ptr, buf_len, \"(%d,%d,%d,%d) L=%d r=[%s,%s]\",\n","filename":"src\/jdk.pack\/share\/native\/common-unpack\/coding.cpp","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -674,1 +674,1 @@\n-    sprintf(message, \"@\" ERROR_FORMAT \": magic\/ver = \"\n+    snprintf(message, sizeof(message), \"@\" ERROR_FORMAT \": magic\/ver = \"\n@@ -3723,1 +3723,1 @@\n-    sprintf((char*)buf.ptr, \"0x%08x\", value.i);\n+    snprintf((char*)buf.ptr, 12, \"0x%08x\", value.i);\n@@ -3728,1 +3728,1 @@\n-    sprintf((char*)buf.ptr, \"0x\" LONG_LONG_HEX_FORMAT, value.l);\n+    snprintf((char*)buf.ptr, 24, \"0x\" LONG_LONG_HEX_FORMAT, value.l);\n","filename":"src\/jdk.pack\/share\/native\/common-unpack\/unpack.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -421,1 +421,1 @@\n-  const char*  saveIntStr(int num) { char buf[30]; sprintf(buf, \"%d\", num); return saveStr(buf); }\n+  const char*  saveIntStr(int num) { char buf[30]; snprintf(buf, 30, \"%d\", num); return saveStr(buf); }\n","filename":"src\/jdk.pack\/share\/native\/common-unpack\/unpack.h","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -85,1 +85,1 @@\n-  sprintf(message, \"@assert failed: %s\\n\", p);\n+  snprintf(message, sizeof(message), \"@assert failed: %s\\n\", p);\n@@ -129,1 +129,1 @@\n-    sprintf(fname, \"mtr%d.txt\", getpid());\n+    snprintf(fname, sizeof(fname), \"mtr%d.txt\", getpid());\n","filename":"src\/jdk.pack\/share\/native\/common-unpack\/utils.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"runtime\/os.hpp\"\n@@ -176,1 +177,1 @@\n-  sprintf(input, \"%s,%s\", decorator_name_array[0], decorator_name_array[3]);\n+  os::snprintf_checked(input, sizeof(input), \"%s,%s\", decorator_name_array[0], decorator_name_array[3]);\n","filename":"test\/hotspot\/gtest\/logging\/test_logDecorators.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -147,1 +147,1 @@\n-  sprintf(data, \"%s\", start_marker);\n+  os::snprintf_checked(data, size, \"%s\", start_marker);\n@@ -151,1 +151,2 @@\n-  sprintf(data + size - strlen(end_marker) - 1, \"%s\", end_marker);\n+  size_t remaining_size = strlen(end_marker) + 1;\n+  os::snprintf_checked(data + size - remaining_size, remaining_size, \"%s\", end_marker);\n","filename":"test\/hotspot\/gtest\/logging\/test_logMessageTest.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-        sprintf(name, \"%s%d\", prefix, eventsCount);\n+        snprintf(name, sizeof(name), \"%s%d\", prefix, eventsCount);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/ThreadEnd\/threadend001\/threadend001.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-        sprintf(name, \"%s%d\", prefix, eventsCount);\n+        snprintf(name, sizeof(name), \"%s%d\", prefix, eventsCount);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/ThreadStart\/threadstart001\/threadstart001.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}