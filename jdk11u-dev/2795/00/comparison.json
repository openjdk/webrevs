{"files":[{"patch":"@@ -25,0 +25,4 @@\n+\n+# Path to libraries in the topmost test directory. This is needed so @library\n+# does not need ..\/..\/ notation to reach them\n+external.lib.roots = ..\/..\/\n","filename":"test\/langtools\/TEST.ROOT","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8164130\n+ * @bug 8164130 8334332\n@@ -28,1 +28,1 @@\n- * @library ..\/lib\n+ * @library ..\/lib \/test\/lib\n@@ -36,0 +36,3 @@\n+import java.nio.file.Path;\n+import java.nio.file.Files;\n+import java.util.Map;\n@@ -37,0 +40,8 @@\n+import jtreg.SkippedException;\n+\n+\/**\n+ * Tests IO Exception handling.\n+ *\n+ * Update: Windows does not permit setting folder to be readonly.\n+ * https:\/\/support.microsoft.com\/en-us\/help\/326549\/you-cannot-view-or-change-the-read-only-or-the-system-attributes-of-fo\n+ *\/\n@@ -48,1 +59,1 @@\n-            throw new Error(\"Cannot create directory\");\n+            throw skip(outDir, \"Cannot create directory\");\n@@ -51,1 +62,1 @@\n-            throw new Error(\"could not set directory read-only\");\n+            throw skip(outDir, \"could not set directory read-only\");\n@@ -54,1 +65,1 @@\n-            throw new Error(\"directory is writable\");\n+            throw skip(outDir, \"directory is writable\");\n@@ -72,1 +83,1 @@\n-            throw new Error(\"Cannot create directory\");\n+            throw skip(outDir, \"Cannot create directory\");\n@@ -77,1 +88,1 @@\n-            throw new Error(\"could not set index read-only\");\n+            throw skip(index, \"could not set index read-only\");\n@@ -80,1 +91,1 @@\n-            throw new Error(\"index is writable\");\n+            throw skip(index, \"index is writable\");\n@@ -112,1 +123,1 @@\n-            throw new Error(\"Cannot create directory\");\n+            throw skip(pkgOutDir, \"Cannot create directory\");\n@@ -115,1 +126,1 @@\n-            throw new Error(\"could not set directory read-only\");\n+            throw skip(pkgOutDir, \"could not set directory read-only\");\n@@ -118,1 +129,1 @@\n-            throw new Error(\"directory is writable\");\n+            throw skip(pkgOutDir, \"directory is writable\");\n@@ -156,1 +167,1 @@\n-            throw new Error(\"Cannot create directory\");\n+            throw skip(docFilesOutDir, \"Cannot create directory\");\n@@ -159,1 +170,1 @@\n-            throw new Error(\"could not set directory read-only\");\n+            throw skip(docFilesOutDir, \"could not set directory read-only\");\n@@ -162,1 +173,1 @@\n-            throw new Error(\"directory is writable\");\n+            throw skip(docFilesOutDir, \"directory is writable\");\n@@ -178,0 +189,25 @@\n+\n+    private Error skip(File f, String message) {\n+        out.print(System.getProperty(\"user.name\"));\n+        out.println(f + \": \" + message);\n+        showAllAttributes(f.toPath());\n+        throw new SkippedException(f + \": \" + message);\n+    }\n+\n+    private void showAllAttributes(Path p) {\n+        showAttributes(p, \"*\");\n+        showAttributes(p, \"posix:*\");\n+        showAttributes(p, \"dos:*\");\n+    }\n+\n+    private void showAttributes(Path p, String attributes) {\n+        out.println(\"Attributes: \" + attributes);\n+        try {\n+            Map<String, Object> map = Files.readAttributes(p, attributes);\n+            map.forEach((n, v) -> out.format(\"  %-10s: %s%n\", n, v));\n+        } catch (UnsupportedOperationException e) {\n+            out.println(\"Attributes not available \" + attributes);\n+        } catch (Throwable t) {\n+            out.println(\"Error accessing attributes \" + attributes + \": \" + t);\n+        }\n+    }\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testIOException\/TestIOException.java","additions":51,"deletions":15,"binary":false,"changes":66,"status":"modified"}]}