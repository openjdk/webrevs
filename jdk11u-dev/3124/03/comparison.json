{"files":[{"patch":"@@ -765,1 +765,1 @@\n-    ECDH, \\\n+    ECDH, TLS_RSA_*, \\\n","filename":"src\/java.base\/share\/conf\/security\/java.security","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,1 +36,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA re-enable\n@@ -38,1 +38,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA256\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_CBC_SHA256 re-enable\n@@ -45,1 +45,1 @@\n- * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256\n+ * @run main\/othervm CipherSuite TLS_RSA_WITH_AES_128_GCM_SHA256 re-enable\n","filename":"test\/jdk\/javax\/net\/ssl\/DTLS\/CipherSuite.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -56,1 +56,11 @@\n-    public static void main(String args[]) throws Exception {\n+    public static void main(String[] args) throws Exception {\n+        \/\/ Re-enable TLSv1.1 and TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\", \"TLS_RSA_*\");\n+\n+        runTest(\"TLSv1.3\", \"TLS_AES_256_GCM_SHA384\");\n+        runTest(\"TLSv1.2\", \"TLS_RSA_WITH_AES_256_GCM_SHA384\");\n+        runTest(\"TLSv1.1\", \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\");\n+    }\n+\n+    private static void runTest(String protocol, String cipherSuite) throws Exception {\n+        System.out.printf(\"Testing %s with %s%n\", protocol, cipherSuite);\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLEngine\/Basics.java","additions":12,"deletions":2,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,1 @@\n- *\n+ * @library \/test\/lib\n@@ -40,0 +40,1 @@\n+import jdk.test.lib.security.SecurityUtils;\n@@ -68,0 +69,2 @@\n+        \/\/ Re-enable TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLEngine\/EngineCloseOnAlert.java","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -177,2 +177,2 @@\n-        \/\/ Re-enable TLSv1.1 since test depends on it.\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\");\n+        \/\/ Re-enable TLSv1.1 and TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1.1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/TLSv11\/GenericBlockCipher.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+ * @library \/test\/lib\n@@ -38,0 +39,2 @@\n+import jdk.test.lib.security.SecurityUtils;\n+\n@@ -159,0 +162,2 @@\n+        \/\/ Re-enable TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/TLSv12\/ProtocolFilter.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8076221 8211883 8279164\n+ * @bug 8076221 8211883 8279164 8245545\n@@ -64,46 +64,52 @@\n-    private static final String[] disabled_ciphersuites\n-        = new String[] {\n-        \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n-        \"SSL_RSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n-        \"SSL_RSA_WITH_RC4_128_MD5\",\n-        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n-        \"SSL_DH_anon_WITH_RC4_128_MD5\",\n-        \"SSL_RSA_WITH_NULL_MD5\",\n-        \"SSL_RSA_WITH_NULL_SHA\",\n-        \"TLS_RSA_WITH_NULL_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n-        \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n-        \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n-        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n-        \"SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n-        \"SSL_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n-        \"SSL_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n-        \"SSL_DH_anon_WITH_DES_CBC_SHA\",\n-        \"SSL_DH_anon_WITH_RC4_128_MD5\",\n-        \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n-        \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n-        \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n-        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\"\n+    public static final String[] disabled_ciphersuites\n+            = new String[]{\n+            \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n+            \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n+            \"SSL_RSA_WITH_RC4_128_SHA\",\n+            \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n+            \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n+            \"SSL_RSA_WITH_RC4_128_MD5\",\n+            \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+            \"SSL_DH_anon_WITH_RC4_128_MD5\",\n+            \"SSL_RSA_WITH_NULL_MD5\",\n+            \"SSL_RSA_WITH_NULL_SHA\",\n+            \"TLS_RSA_WITH_NULL_SHA256\",\n+            \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n+            \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n+            \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n+            \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n+            \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+            \"SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n+            \"SSL_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n+            \"SSL_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n+            \"SSL_DH_anon_WITH_DES_CBC_SHA\",\n+            \"SSL_DH_anon_WITH_RC4_128_MD5\",\n+            \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n+            \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n+            \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n+            \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n+            \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n+            \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n+            \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n+            \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n+            \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n+            \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+            \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+            \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+            \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+            \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+            \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+            \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+            \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+            \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+            \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+            \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+            \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+            \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+            \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+            \"TLS_RSA_WITH_AES_128_CBC_SHA\"\n","filename":"test\/jdk\/javax\/net\/ssl\/ciphersuites\/DisabledAlgorithms.java","additions":54,"deletions":48,"binary":false,"changes":102,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 4750141 4895631 8217579 8163326 8279164\n+ * @bug 4750141 4895631 8217579 8163326 8279164 8245545\n@@ -102,6 +102,0 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -127,3 +121,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -197,6 +188,0 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -222,3 +207,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/CheckCipherSuites.java","additions":2,"deletions":20,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,0 +24,1 @@\n+import java.util.stream.Stream;\n@@ -89,2 +90,14 @@\n-                Arrays.deepToString(servercipherSuites),\n-                Arrays.deepToString(clientcipherSuites));\n+                          Arrays.deepToString(servercipherSuites),\n+                          Arrays.deepToString(clientcipherSuites));\n+\n+        \/\/ Re-enable TLS_RSA_* cipher suites if needed since test depends on it.\n+        if (Stream.concat(\n+                        Arrays.stream(\n+                                servercipherSuites == null\n+                                        ? new String[0] : servercipherSuites),\n+                        Arrays.stream(\n+                                clientcipherSuites == null\n+                                        ? new String[0] : clientcipherSuites))\n+                .anyMatch(s -> s.startsWith(\"TLS_RSA_\"))) {\n+            SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+        }\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/SystemPropCipherSuitesOrder.java","additions":16,"deletions":3,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -61,0 +61,2 @@\n+        \/\/ Re-enable TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/TLSCipherSuitesOrder.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,2 @@\n- * Copyright (c) 2018, Red Hat, Inc.\n+ * Copyright (c) 2019, Red Hat, Inc.\n+ * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +66,1 @@\n+import jdk.test.lib.security.SecurityUtils;\n@@ -83,0 +85,3 @@\n+        \/\/ Re-enable TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLS_RSA_*\");\n+\n@@ -458,1 +463,1 @@\n-}\n\\ No newline at end of file\n+}\n","filename":"test\/jdk\/sun\/security\/pkcs11\/fips\/TestTLS12.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -306,2 +306,2 @@\n-        \/\/ Re-enable TLSv1 since test depends on it.\n-        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\");\n+        \/\/ Re-enable TLSv1 and TLS_RSA_* since test depends on it.\n+        SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/sun\/security\/ssl\/ClientHandshaker\/LengthCheckTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -138,2 +138,2 @@\n-            \/\/ Re-enable TLSv1 since test depends on it\n-            SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\");\n+            \/\/ Re-enable TLSv1 and TLS_RSA_* since test depends on it\n+            SecurityUtils.removeFromDisabledTlsAlgs(\"TLSv1\", \"TLS_RSA_*\");\n","filename":"test\/jdk\/sun\/security\/ssl\/EngineArgs\/DebugReportsOneExtraByte.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}