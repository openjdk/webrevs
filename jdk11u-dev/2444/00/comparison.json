{"files":[{"patch":"@@ -40,1 +40,1 @@\n-    private static final int INCREMENT = 100 * 1024; \/\/ 100kb\n+    private static final int INCREMENT = 100 * 1024 * 1024 ; \/\/ 100MB\n@@ -57,3 +57,3 @@\n-            log.display(i + \" pool \" + monitor.getName(pool) + \" of type: \" + monitor.getType(pool));\n-            if (!monitor.isUsageThresholdSupported(pool)) {\n-                log.display(\"  does not support usage thresholds: skip\");\n+            \/\/ Skip non-heap pools, as they have unpredictable behaviour, or if\n+            \/\/ usage threshold not supported:\n+            if (monitor.getType(pool) != MemoryType.HEAP  || !monitor.isUsageThresholdSupported(pool)) {\n@@ -62,0 +62,1 @@\n+            log.display(i + \" pool \" + monitor.getName(pool) + \" of type: \" + monitor.getType(pool));\n@@ -65,0 +66,1 @@\n+            MemoryUsage peakUsage = monitor.getPeakUsage(pool);\n@@ -68,0 +70,1 @@\n+            long peakUsed = peakUsage.getUsed();\n@@ -79,0 +82,1 @@\n+            log.display(\"peak used value is \" + peakUsed);\n@@ -98,1 +102,1 @@\n-            MemoryUsage peakUsage = monitor.getPeakUsage(pool);\n+            peakUsage = monitor.getPeakUsage(pool);\n@@ -101,2 +105,1 @@\n-            long peakUsed = usage.getUsed();\n-            long peakMax = usage.getMax();\n+            peakUsed = peakUsage.getUsed();\n@@ -105,2 +108,1 @@\n-            log.display(\"peak used value is \" + peakUsed + \" peak max is \" + peakMax);\n-            log.display(\"  threshold set to \" + threshold);\n+            log.display(\"peak used value is \" + peakUsed);\n@@ -110,6 +112,0 @@\n-            \/\/ Test can be imprecise, particularly with CodeHeap: usage changes outside our control.\n-            if (thresholdCount > 0 && monitor.getType(pool) != MemoryType.HEAP) {\n-                log.display(\"  thresholdCount increasing outside our control for non-heap Pool: skip\");\n-                continue;\n-            }\n-\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/MemoryPoolMBean\/isUsageThresholdExceeded\/isexceeded001.java","additions":11,"deletions":15,"binary":false,"changes":26,"status":"modified"}]}