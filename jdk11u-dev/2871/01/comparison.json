{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,0 @@\n-\n@@ -28,1 +27,0 @@\n-\n@@ -30,1 +28,0 @@\n-\n@@ -32,1 +29,0 @@\n-\n@@ -35,0 +31,3 @@\n+import java.util.List;\n+import java.util.SplittableRandom;\n+import java.util.concurrent.CountDownLatch;\n@@ -40,3 +39,1 @@\n-import java.util.List;\n-import java.util.Random;\n-import java.util.concurrent.CountDownLatch;\n+import jdk.test.lib.RandomFactory;\n@@ -48,0 +45,1 @@\n+ * @library \/test\/lib\n@@ -54,1 +52,3 @@\n- * @summary Test the implementation of the jdk.nio.maxCachedBufferSize property.\n+ * @summary Test the implementation of the jdk.nio.maxCachedBufferSize property\n+ * (use -Dseed=X to set PRNG seed)\n+ * @key randomness\n@@ -73,1 +73,3 @@\n-    private static final int VERBOSE_PERIOD = 5 * 1000;\n+    private static final int VERBOSE_PERIOD = DEFAULT_ITERS \/ 10;\n+\n+    private static final SplittableRandom SRAND = RandomFactory.getSplittableRandom();\n@@ -89,0 +91,2 @@\n+    private static long initialCount;\n+    private static long initialCapacity;\n@@ -98,1 +102,1 @@\n-        private final Random random = new Random();\n+        private SplittableRandom random = SRAND.split();\n@@ -180,2 +184,3 @@\n-        final long directCount = directPool.getCount();\n-        final long directTotalCapacity = directPool.getTotalCapacity();\n+        final long directCount = directPool.getCount() - initialCount;\n+        final long directTotalCapacity =\n+            directPool.getTotalCapacity() - initialCapacity;\n@@ -193,1 +198,1 @@\n-                \"inconsistent direct buffer total capacity, expectex max = %d, found = %d\",\n+                \"inconsistent direct buffer total capacity, expected max = %d, found = %d\",\n@@ -199,0 +204,3 @@\n+        initialCount = directPool.getCount();\n+        initialCapacity = directPool.getTotalCapacity();\n+\n","filename":"test\/jdk\/sun\/nio\/ch\/TestMaxCachedBufferSize.java","additions":22,"deletions":14,"binary":false,"changes":36,"status":"modified"}]}