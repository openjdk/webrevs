{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -625,3 +625,7 @@\n-      if (add_map_info(ph, fd, segcmd.fileoff, segcmd.vmaddr, segcmd.vmsize) == NULL) {\n-        print_debug(\"Failed to add map_info at i = %d\\n\", i);\n-        goto err;\n+      \/\/ The base of the library is offset by a random amount which ends up as a load command with a\n+      \/\/ filesize of 0.  This must be ignored otherwise the base address of the library is wrong.\n+      if (segcmd.filesize != 0) {\n+        if (add_map_info(ph, fd, segcmd.fileoff, segcmd.vmaddr, segcmd.vmsize) == NULL) {\n+          print_debug(\"Failed to add map_info at i = %d\\n\", i);\n+          goto err;\n+        }\n@@ -629,1 +633,2 @@\n-      print_debug(\"LC_SEGMENT_64 added: nsects=%d fileoff=0x%llx vmaddr=0x%llx vmsize=0x%llx filesize=0x%llx %s\\n\",\n+      print_debug(\"LC_SEGMENT_64 %s: nsects=%d fileoff=0x%llx vmaddr=0x%llx vmsize=0x%llx filesize=0x%llx %s\\n\",\n+                  segcmd.filesize == 0 ? \"with filesize == 0 ignored\" : \"added\",\n","filename":"src\/jdk.hotspot.agent\/macosx\/native\/libsaproc\/ps_core.c","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -167,1 +167,1 @@\n-serviceability\/sa\/ClhsdbCDSCore.java 8294316,8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/ClhsdbCDSCore.java 8193639,8267433 solaris-all,macosx-x64\n@@ -171,1 +171,1 @@\n-serviceability\/sa\/ClhsdbFindPC.java 8294316,8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/ClhsdbFindPC.java 8193639,8267433 solaris-all,macosx-x64\n@@ -178,1 +178,1 @@\n-serviceability\/sa\/ClhsdbPmap.java 8294316,8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/ClhsdbPmap.java 8193639,8267433 solaris-all,macosx-x64\n@@ -182,1 +182,1 @@\n-serviceability\/sa\/ClhsdbPstack.java 8294316,8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/ClhsdbPstack.java 8193639,8267433 solaris-all,macosx-x64\n@@ -206,2 +206,2 @@\n-serviceability\/sa\/TestJmapCore.java 8294316,8193639,8267433 solaris-all,macosx-x64\n-serviceability\/sa\/TestJmapCoreMetaspace.java 8294316,8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/TestJmapCore.java 8193639,8267433 solaris-all,macosx-x64\n+serviceability\/sa\/TestJmapCoreMetaspace.java 8193639,8267433 solaris-all,macosx-x64\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}