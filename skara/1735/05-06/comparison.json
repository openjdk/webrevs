{"files":[{"patch":"@@ -91,1 +91,1 @@\n-            upgradeLabelsToGroups(pr, bot);\n+            upgradeLabelsToGroups(pr, bot, currentLabels);\n@@ -123,1 +123,1 @@\n-            upgradeLabelsToGroups(pr, bot);\n+            upgradeLabelsToGroups(pr, bot, currentLabels);\n@@ -153,0 +153,5 @@\n+    \/**\n+     * Attempts to add each label in labelsToAdd to the pull request.\n+     * Updates to currentLabels are performed immediately after each label addition, so group checks always\n+     * reflect the latest state after any modifications.\n+     *\/\n@@ -156,1 +161,1 @@\n-                var groups = bot.labelConfiguration().groupLabel(label);\n+                var groups = bot.labelConfiguration().groupLabels(label);\n@@ -180,0 +185,4 @@\n+    \/**\n+     * Attempts to remove each label in labelsToRemove from the pull request.\n+     * Updates to currentLabels are performed immediately after each label removal.\n+     *\/\n@@ -193,3 +202,3 @@\n-    private void upgradeLabelsToGroups(PullRequest pr, PullRequestBot bot) {\n-        Set<String> oldLabels = new HashSet<>(pr.labelNames());\n-        Set<String> newLabels = new HashSet<>(pr.labelNames());\n+    private void upgradeLabelsToGroups(PullRequest pr, PullRequestBot bot, Set<String> currentLabels) {\n+        Set<String> oldLabels = new HashSet<>(currentLabels);\n+        Set<String> newLabels = new HashSet<>(currentLabels);\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/LabelCommand.java","additions":15,"deletions":6,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n-    Set<String> groupLabel(String label);\n+    Set<String> groupLabels(String label);\n","filename":"forge\/src\/main\/java\/org\/openjdk\/skara\/forge\/LabelConfiguration.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -80,2 +80,2 @@\n-    public Set<String> groupLabel(String label) {\n-        return labelConfiguration().groupLabel(label);\n+    public Set<String> groupLabels(String label) {\n+        return labelConfiguration().groupLabels(label);\n","filename":"forge\/src\/main\/java\/org\/openjdk\/skara\/forge\/LabelConfigurationHostedRepository.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -171,1 +171,1 @@\n-    public Set<String> groupLabel(String label) {\n+    public Set<String> groupLabels(String label) {\n","filename":"forge\/src\/main\/java\/org\/openjdk\/skara\/forge\/LabelConfigurationJson.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}