{"files":[{"patch":"@@ -602,25 +602,35 @@\n-                               .filter(review -> review.verdict() == Review.Verdict.APPROVED)\n-                               .map(review -> {\n-                                   var entry = \" * \" + formatReviewer(review.reviewer());\n-                                   if (!review.targetRef().equals(pr.targetRef())) {\n-                                       entry += \" 🔄 Re-review required (review was made when pull request targeted the [\" + review.targetRef()\n-                                               + \"](\" + pr.repository().webUrl(new Branch(review.targetRef())) + \") branch)\";\n-                                   } else {\n-                                       var hash = review.hash();\n-                                       if (hash.isPresent()) {\n-                                           if (!hash.get().equals(pr.headHash())) {\n-                                               if (!reviewCoverage.covers(review) && tooFewReviewers) {\n-                                                   entry += \" 🔄 Re-review required (review applies to [\" + hash.get().abbreviate()\n-                                                           + \"](\" + pr.filesUrl(hash.get()) + \"))\";\n-                                               } else {\n-                                                   entry += \" ⚠️ Review applies to [\" + hash.get().abbreviate()\n-                                                           + \"](\" + pr.filesUrl(hash.get()) + \")\";\n-                                               }\n-                                           }\n-                                       } else {\n-                                           entry += \" 🔄 Re-review required (review applies to a commit that is no longer present)\";\n-                                       }\n-                                   }\n-                                   return entry;\n-                               })\n-                               .collect(Collectors.joining(\"\\n\"));\n+                .filter(review -> review.verdict() == Review.Verdict.APPROVED)\n+                .map(review -> {\n+                    var entry = \" * \" + formatReviewer(review.reviewer());\n+                    if (!review.targetRef().equals(pr.targetRef())) {\n+                        if (useStaleReviews || tooFewReviewers) {\n+                            entry += \" 🔄 Re-review required (review was made when pull request targeted the [\" + review.targetRef()\n+                                    + \"](\" + pr.repository().webUrl(new Branch(review.targetRef())) + \") branch)\";\n+                        } else {\n+                            entry += \" Review was made when pull request targeted the [\" + review.targetRef()\n+                                    + \"](\" + pr.repository().webUrl(new Branch(review.targetRef())) + \") branch\";\n+                        }\n+                    } else {\n+                        var hash = review.hash();\n+                        if (hash.isPresent()) {\n+                            if (!hash.get().equals(pr.headHash())) {\n+                                if (reviewCoverage.covers(review) || !tooFewReviewers) {\n+                                    entry += (tooFewReviewers ? \" ⚠️ \" : \" \")\n+                                            + \"Review applies to [\" + hash.get().abbreviate()\n+                                            + \"](\" + pr.filesUrl(hash.get()) + \")\";\n+                                } else {\n+                                    entry += \" 🔄 Re-review required (review applies to [\" + hash.get().abbreviate()\n+                                            + \"](\" + pr.filesUrl(hash.get()) + \"))\";\n+                                }\n+                            }\n+                        } else {\n+                            if (useStaleReviews || tooFewReviewers) {\n+                                entry += \" 🔄 Re-review required (review applies to a commit that is no longer present)\";\n+                            } else {\n+                                entry += \" Review applies to a commit that is no longer present\";\n+                            }\n+                        }\n+                    }\n+                    return entry;\n+                })\n+                .collect(Collectors.joining(\"\\n\"));\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckRun.java","additions":35,"deletions":25,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -1574,1 +1574,1 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertTrue(pr.store().body().contains(\"🔄 Re-review required\"));\n@@ -1583,0 +1583,1 @@\n+            assertFalse(pr.store().body().contains(\"⚠️ Review applies to\"));\n@@ -1595,1 +1596,1 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertTrue(pr.store().body().contains(\"🔄 Re-review required\"));\n@@ -1606,1 +1607,2 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertFalse(pr.store().body().contains(\"🔄 Re-review required\"));\n+            assertTrue(pr.store().body().contains(\"Review was made when pull request targeted\"));\n@@ -1616,1 +1618,2 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertTrue(pr.store().body().contains(\"Review applies to\"));\n+            assertTrue(pr.store().body().contains(\"Review was made when pull request targeted\"));\n@@ -1731,0 +1734,2 @@\n+            assertFalse(pr.store().body().contains(\"Re-review required\"));\n+            assertFalse(pr.store().body().contains(\"Review applies to\"));\n@@ -1741,0 +1746,2 @@\n+            assertFalse(pr.store().body().contains(\" ⚠️ Review applies to\"));\n+            assertTrue(pr.store().body().contains(\"Review applies to\"));\n@@ -1766,0 +1773,2 @@\n+            assertFalse(pr.store().body().contains(\" ⚠️ Review applies to\"));\n+            assertTrue(pr.store().body().contains(\"Review applies to\"));\n@@ -1790,1 +1799,2 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertFalse(pr.store().body().contains(\"Review applies to\"));\n+            assertTrue(pr.store().body().contains(\" 🔄 Re-review required\"));\n@@ -1798,0 +1808,2 @@\n+            assertFalse(pr.store().body().contains(\"Review applies to\"));\n+            assertFalse(pr.store().body().contains(\"Re-review required\"));\n@@ -1807,0 +1819,2 @@\n+            assertFalse(pr.store().body().contains(\" ⚠️ Review applies to\"));\n+            assertTrue(pr.store().body().contains(\"Review applies to\"));\n@@ -1880,1 +1894,1 @@\n-            assertTrue(pr.store().body().contains(\"Re-review required\"));\n+            assertTrue(pr.store().body().contains(\" 🔄 Re-review required\"));\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/CheckTests.java","additions":20,"deletions":6,"binary":false,"changes":26,"status":"modified"}]}