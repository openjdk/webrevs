{"files":[{"patch":"@@ -26,1 +26,0 @@\n-import org.openjdk.skara.bots.notify.prbranch.PullRequestBranchNotifier;\n@@ -48,1 +47,1 @@\n-    private Boolean wildCardProtected = false;\n+    private Boolean firstTimeCall = true;\n@@ -87,5 +86,3 @@\n-        if (!wildCardProtected && prListeners.stream()\n-                .anyMatch(e -> e instanceof PullRequestBranchNotifier && ((PullRequestBranchNotifier) e).isProtectBranches())) {\n-            log.info(\"Protecting branch *\");\n-            repository.protectBranchPattern(\"*\");\n-            wildCardProtected = true;\n+        if (firstTimeCall) {\n+            prListeners.forEach(listener -> listener.initialize(repository));\n+            firstTimeCall = false;\n","filename":"bots\/notify\/src\/main\/java\/org\/openjdk\/skara\/bots\/notify\/NotifyBot.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+import org.openjdk.skara.forge.HostedRepository;\n@@ -45,0 +46,3 @@\n+\n+    default void initialize(HostedRepository repo) {\n+    }\n","filename":"bots\/notify\/src\/main\/java\/org\/openjdk\/skara\/bots\/notify\/PullRequestListener.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -66,0 +66,2 @@\n+            \/\/ We still need this code because it's possible that we have some pr branch protected,\n+            \/\/ but it will be fine for us to remove this code later\n@@ -77,2 +79,4 @@\n-        log.info(\"Protecting branch * after deleting branch \" + branch);\n-        pr.repository().protectBranchPattern(\"*\");\n+        if (protectBranches) {\n+            log.info(\"Protecting branch * after deleting branch \" + branch);\n+            pr.repository().protectBranchPattern(\"*\");\n+        }\n@@ -144,2 +148,6 @@\n-    public boolean isProtectBranches() {\n-        return protectBranches;\n+    @Override\n+    public void initialize(HostedRepository repository) {\n+        if (protectBranches) {\n+            log.info(\"Protecting branch *\");\n+            repository.protectBranchPattern(\"*\");\n+        }\n","filename":"bots\/notify\/src\/main\/java\/org\/openjdk\/skara\/bots\/notify\/prbranch\/PullRequestBranchNotifier.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"}]}