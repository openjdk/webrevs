{"files":[{"patch":"@@ -25,0 +25,1 @@\n+import org.openjdk.skara.forge.HostedBranch;\n@@ -38,0 +39,1 @@\n+import java.util.Comparator;\n@@ -77,0 +79,2 @@\n+    private static final int BRANCHES_LIMIT = 10;\n+\n@@ -199,1 +203,4 @@\n-            reply.println(String.join(\", \", bot.forks().keySet().stream().sorted().toList()) + \".\");\n+            reply.println(String.join(\", \", bot.forks().keySet().stream()\n+                    .sorted()\n+                    .map(repo -> \"`\" + repo + \"`\")\n+                    .toList()) + \".\");\n@@ -201,0 +208,7 @@\n+            var branchNamesInCurrentRepo = bot.repo().branches().stream().map(HostedBranch::name).toList();\n+            if (branchNamesInCurrentRepo.contains(repoName)) {\n+                reply.println();\n+                reply.println(\"There is a branch `\" + repoName + \"` in the current repository `\" + bot.repo().name() + \"`.\");\n+                reply.println(\"To target a backport to this branch in the current repository use:\");\n+                reply.println(\"`\/backport :\" + repoName + \"`\");\n+            }\n@@ -211,0 +225,10 @@\n+            reply.print(\"List of valid branches: \");\n+            var branches = targetRepo.branches().stream()\n+                    .map(HostedBranch::name)\n+                    .filter(name -> !name.startsWith(\"pr\/\"))\n+                    .sorted(Comparator.reverseOrder())\n+                    .toList();\n+            reply.println(String.join(\", \", branches.stream()\n+                    .limit(BRANCHES_LIMIT)\n+                    .map(branch -> \"`\" + branch + \"`\")\n+                    .toList()) + (branches.size() > BRANCHES_LIMIT ? \"...\" : \".\"));\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/BackportCommand.java","additions":25,"deletions":1,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -66,1 +66,4 @@\n-\n+            \/\/ Create more branches\n+            for (int i = 1; i <= 20; i++) {\n+                localRepo.push(editHash, author.authenticatedUrl(), \"jdk\" + i, true);\n+            }\n@@ -98,0 +101,14 @@\n+\n+            author.addCommitComment(editHash, \"\/backport jdk11\");\n+            TestBotRunner.runPeriodicItems(bot);\n+            recentCommitComments = author.recentCommitComments();\n+            assertEquals(8, recentCommitComments.size());\n+            botReply = recentCommitComments.get(0);\n+            assertTrue(botReply.body().contains(\"There is a branch `jdk11` in the current repository `test`.\"));\n+\n+            author.addCommitComment(editHash, \"\/backport :jdk31\");\n+            TestBotRunner.runPeriodicItems(bot);\n+            recentCommitComments = author.recentCommitComments();\n+            assertEquals(10, recentCommitComments.size());\n+            botReply = recentCommitComments.get(0);\n+            assertTrue(botReply.body().contains(\"List of valid branches:\"));\n@@ -138,1 +155,1 @@\n-            assertTrue(botReply.body().contains(\"List of valid target repositories: foobar\/other-repo, test\"));\n+            assertTrue(botReply.body().contains(\"List of valid target repositories: `foobar\/other-repo`, `test`\"));\n@@ -179,1 +196,1 @@\n-            assertTrue(botReply.body().contains(\"List of valid target repositories: foobar\/other-repo\"));\n+            assertTrue(botReply.body().contains(\"List of valid target repositories: `foobar\/other-repo`\"));\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/BackportCommitCommandTests.java","additions":20,"deletions":3,"binary":false,"changes":23,"status":"modified"}]}