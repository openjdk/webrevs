{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -62,0 +62,6 @@\n+    private enum JiraIssueState {\n+        Open,\n+        Resolved,\n+        Closed\n+    }\n+\n@@ -240,1 +246,2 @@\n-    private void performTransition(String id) {\n+    private void performTransition(JiraIssueState state, Map<String, String> availableTransitions) {\n+        var id = availableTransitions.get(state.name());\n@@ -242,2 +249,7 @@\n-                        .put(\"transition\", JSON.object()\n-                                               .put(\"id\", id));\n+                .put(\"transition\", JSON.object()\n+                        .put(\"id\", id));\n+        if (state == JiraIssueState.Resolved) {\n+            query.put(\"fields\", JSON.object()\n+                    .put(\"resolution\", JSON.object()\n+                            .put(\"name\", \"Fixed\")));\n+        }\n@@ -245,2 +257,2 @@\n-               .body(query)\n-               .execute();\n+                .body(query)\n+                .execute();\n@@ -259,3 +271,3 @@\n-            if (!availableTransitions.containsKey(\"Resolved\")) {\n-                if (availableTransitions.containsKey(\"Open\")) {\n-                    performTransition(availableTransitions.get(\"Open\"));\n+            if (!availableTransitions.containsKey(JiraIssueState.Resolved.name())) {\n+                if (availableTransitions.containsKey(JiraIssueState.Open.name())) {\n+                    performTransition(JiraIssueState.Open, availableTransitions);\n@@ -263,1 +275,1 @@\n-                    if (!availableTransitions.containsKey(\"Resolved\")) {\n+                    if (!availableTransitions.containsKey(JiraIssueState.Resolved.name())) {\n@@ -272,1 +284,1 @@\n-            performTransition(availableTransitions.get(\"Resolved\"));\n+            performTransition(JiraIssueState.Resolved, availableTransitions);\n@@ -274,3 +286,3 @@\n-            if (!availableTransitions.containsKey(\"Closed\")) {\n-                if (availableTransitions.containsKey(\"Resolved\")) {\n-                    performTransition(availableTransitions.get(\"Resolved\"));\n+            if (!availableTransitions.containsKey(JiraIssueState.Closed.name())) {\n+                if (availableTransitions.containsKey(JiraIssueState.Resolved.name())) {\n+                    performTransition(JiraIssueState.Resolved, availableTransitions);\n@@ -278,1 +290,1 @@\n-                    if (!availableTransitions.containsKey(\"Closed\")) {\n+                    if (!availableTransitions.containsKey(JiraIssueState.Closed.name())) {\n@@ -285,1 +297,1 @@\n-            performTransition(availableTransitions.get(\"Closed\"));\n+            performTransition(JiraIssueState.Closed, availableTransitions);\n@@ -287,1 +299,1 @@\n-            if (!availableTransitions.containsKey(\"Open\")) {\n+            if (!availableTransitions.containsKey(JiraIssueState.Open.name())) {\n@@ -290,1 +302,1 @@\n-            performTransition(availableTransitions.get(\"Open\"));\n+            performTransition(JiraIssueState.Open, availableTransitions);\n","filename":"issuetracker\/src\/main\/java\/org\/openjdk\/skara\/issuetracker\/jira\/JiraIssue.java","additions":30,"deletions":18,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,0 @@\n-import java.net.URI;\n@@ -28,1 +27,0 @@\n-import org.junit.jupiter.api.condition.EnabledIf;\n@@ -37,1 +35,0 @@\n-import java.util.Properties;\n@@ -120,0 +117,14 @@\n+\n+    @Test\n+    @EnabledIfTestProperties({\"jira.uri\", \"jira.pat\", \"jira.project\", \"jira.issue\"})\n+    void testResolutionOfResolvedIssue() throws IOException {\n+        var project = tracker.project(props.get(\"jira.project\"));\n+        var issueId = props.get(\"jira.issue\");\n+\n+        var issue = project.issue(issueId).orElseThrow();\n+        issue.setState(Issue.State.OPEN);\n+        issue.setState(Issue.State.RESOLVED);\n+        issue = project.issue(issueId).orElseThrow();\n+        assertTrue(issue.resolution().isPresent());\n+        assertEquals(\"Fixed\", issue.resolution().get());\n+    }\n","filename":"issuetracker\/src\/test\/java\/org\/openjdk\/skara\/issuetracker\/jira\/JiraIntegrationTests.java","additions":15,"deletions":4,"binary":false,"changes":19,"status":"modified"}]}