{"files":[{"patch":"@@ -37,0 +37,1 @@\n+import java.util.Arrays;\n@@ -45,1 +46,2 @@\n-        reply.println(\"Usage: `\/backport <repository> [<branch>]`\");\n+        reply.println(\"Usage:  `\/backport <repository> [<branch>]` \" +\n+                \"or `\/backport [<repository>]:<branch>`\");\n@@ -49,1 +51,2 @@\n-        reply.println(\"Usage: `\/backport [disable] <repository> [<branch>]`\");\n+        reply.println(\"Usage: `\/backport [disable] <repository> [<branch>]` \" +\n+                \"or `\/backport [disable] [<repository>]:<branch>`\");\n@@ -94,0 +97,15 @@\n+\n+        \/\/ Preprocess args to support \"repo:branch\" argument\n+        if (parts[0].equals(\"disable\")) {\n+            if (parts.length == 2 && parts[1].contains(\":\")) {\n+                List<String> tempList = new ArrayList<>();\n+                tempList.add(\"disable\");\n+                tempList.addAll(Arrays.asList(parts[1].split(\":\")));\n+                parts = tempList.toArray(new String[0]);\n+            }\n+        } else {\n+            if (parts.length == 1 && parts[0].contains(\":\")) {\n+                parts = parts[0].split(\":\");\n+            }\n+        }\n+\n@@ -161,0 +179,3 @@\n+        if (repoName.isEmpty()) {\n+            repoName = bot.repo().name();\n+        }\n@@ -215,0 +236,5 @@\n+        \/\/ Preprocess args to support \"repo:branch\" argument\n+        if (parts.length == 1 && parts[0].contains(\":\")) {\n+            parts = parts[0].split(\":\");\n+        }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/BackportCommand.java","additions":28,"deletions":2,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -80,0 +80,18 @@\n+\n+            \/\/ Add a backport command\n+            author.addCommitComment(editHash, \"\/backport \" + author.name() + \":\" + author.defaultBranchName());\n+            TestBotRunner.runPeriodicItems(bot);\n+            recentCommitComments = author.recentCommitComments();\n+            assertEquals(4, recentCommitComments.size());\n+            botReply = recentCommitComments.get(0);\n+            assertTrue(botReply.body().contains(\"To create a pull request with this backport targeting \" +\n+                    \"[\" + author.name() + \":\" + author.defaultBranchName() + \"]\"));\n+\n+            \/\/ Add a backport command\n+            author.addCommitComment(editHash, \"\/backport :\" + author.defaultBranchName());\n+            TestBotRunner.runPeriodicItems(bot);\n+            recentCommitComments = author.recentCommitComments();\n+            assertEquals(6, recentCommitComments.size());\n+            botReply = recentCommitComments.get(0);\n+            assertTrue(botReply.body().contains(\"To create a pull request with this backport targeting \" +\n+                    \"[\" + author.name() + \":\" + author.defaultBranchName() + \"]\"));\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/BackportCommitCommandTests.java","additions":19,"deletions":1,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-                    .forks(Map.of(\"targetRepo\", targetRepo, \"targetRepo2\", targetRepo2))\n+                    .forks(Map.of(\"targetRepo\", targetRepo, \"targetRepo2\", targetRepo2, \"test\", author))\n@@ -92,1 +92,13 @@\n-            \/\/ disable backport for targetRepo on master\n+            \/\/ Enable backport for test on master\n+            pr.addComment(\"\/backport :master\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(pr, \"Backport for repo `test` on branch `master` was successfully enabled\");\n+            assertTrue(pr.store().labelNames().contains(\"backport=test:master\"));\n+\n+            \/\/ Disable backport for test on master\n+            pr.addComment(\"\/backport disable test:master\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(pr, \"Backport for repo `test` on branch `master` was successfully disabled\");\n+            assertFalse(pr.store().labelNames().contains(\"backport=test:master\"));\n+\n+            \/\/ Disable backport for targetRepo on master\n@@ -98,1 +110,1 @@\n-            \/\/ disable backport for targetRepo again\n+            \/\/ Disable backport for targetRepo again\n@@ -168,1 +180,1 @@\n-            \/\/close the pr\n+            \/\/ Close the pr\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/BackportPRCommandTests.java","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"}]}