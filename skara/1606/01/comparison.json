{"files":[{"patch":"@@ -83,0 +83,1 @@\n+    private boolean missingApprovalRequest = false;\n@@ -723,0 +724,2 @@\n+                                } else {\n+                                    missingApprovalRequest = true;\n@@ -1378,12 +1381,0 @@\n-            if (approvalNeeded() && approval.approvalComment() && readyToPostApprovalNeededComment) {\n-                for (var entry : additionalProgresses.entrySet()) {\n-                    if (!entry.getKey().endsWith(\"needs \" + approval.approvalTerm()) && !entry.getValue()) {\n-                        readyToPostApprovalNeededComment = false;\n-                        break;\n-                    }\n-                }\n-                if (readyToPostApprovalNeededComment) {\n-                    postApprovalNeededComment();\n-                }\n-            }\n-\n@@ -1405,0 +1396,13 @@\n+            if (!PullRequestUtils.isMerge(pr) && !newLabels.contains(\"ready\") && missingApprovalRequest\n+                    && approvalNeeded() && approval.approvalComment() && readyToPostApprovalNeededComment) {\n+                for (var entry : additionalProgresses.entrySet()) {\n+                    if (!entry.getKey().endsWith(\"needs \" + approval.approvalTerm()) && !entry.getValue()) {\n+                        readyToPostApprovalNeededComment = false;\n+                        break;\n+                    }\n+                }\n+                if (readyToPostApprovalNeededComment) {\n+                    postApprovalNeededComment();\n+                }\n+            }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckRun.java","additions":16,"deletions":12,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -135,1 +135,0 @@\n-            assertLastCommentContains(pr, \" This change is now ready for you to apply for [maintainer approval]\");\n@@ -168,0 +167,1 @@\n+            issue1.addLabel(\"CPU23_04-critical-request\");\n@@ -169,2 +169,3 @@\n-            issue1.setProperty(\"issuetype\", JSON.of(\"Bug\"));\n-            issue1.setProperty(\"priority\", JSON.of(\"2\"));\n+            issue2.setProperty(\"issuetype\", JSON.of(\"Bug\"));\n+            issue2.setProperty(\"priority\", JSON.of(\"2\"));\n+            issue2.addLabel(\"CPU23_04-critical-request\");\n@@ -213,0 +214,10 @@\n+            TestBotRunner.runPeriodicItems(prBot);\n+\n+            pr.addComment(\"\/approval 1 cancel\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            TestBotRunner.runPeriodicItems(issueBot);\n+            assertLastCommentContains(pr, \"This change is now ready for you to apply for [maintainer approval](https:\/\/example.com).\");\n+            pr.addComment(\"\/approval 2 cancel\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            TestBotRunner.runPeriodicItems(issueBot);\n+\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/ApprovalAndApproveCommandTests.java","additions":14,"deletions":3,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -415,1 +415,1 @@\n-                    , pr.store().comments().get(1).body());\n+                    , pr.store().comments().get(2).body());\n@@ -429,1 +429,1 @@\n-                    , pr.store().comments().get(1).body());\n+                    , pr.store().comments().get(2).body());\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/IssueBotTests.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}