{"files":[{"patch":"@@ -136,0 +136,13 @@\n+  auto get_field_from_object_constant = [field](const ciConstant& v) -> ciConstant {\n+    ciObject* obj = v.as_object();\n+    if (obj->is_null_object()) {\n+      return ciConstant();\n+    }\n+    \/\/ obj cannot be an ciArray since it is an element of a flat array, so it must be a value class, which arrays are not.\n+    ciInstance* inst = obj->as_instance();\n+    if (field == nullptr) {\n+      return inst->null_marker_value();\n+    }\n+    return inst->field_value(field);\n+  };\n+\n@@ -139,4 +152,1 @@\n-    if (field == nullptr) {\n-      return value.as_object()->as_instance()->null_marker_value();\n-    }\n-    return value.as_object()->as_instance()->field_value(field);\n+    return get_field_from_object_constant(value);\n@@ -148,4 +158,2 @@\n-  add_to_constant_value_cache(index, value);\n-\n-  if (field == nullptr) {\n-    return value.as_object()->as_instance()->null_marker_value();\n+  if (!value.is_valid()) {\n+    return ciConstant();\n@@ -153,1 +161,3 @@\n-  return value.as_object()->as_instance()->field_value(field);\n+\n+  add_to_constant_value_cache(index, value);\n+  return get_field_from_object_constant(value);\n","filename":"src\/hotspot\/share\/ci\/ciFlatArray.cpp","additions":19,"deletions":9,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -406,1 +406,1 @@\n-    return nullptr; \/\/ wrong offset\n+    return nullptr; \/\/ wrong offset, or the array element at offset off is null.\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}