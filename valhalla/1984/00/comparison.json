{"files":[{"patch":"@@ -35,1 +35,0 @@\n-runtime\/cds\/serviceability\/ReplaceCriticalClassesForSubgraphs.java                               8372599 generic-all\n","filename":"test\/hotspot\/jtreg\/ProblemList-enable-preview.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+ * @modules java.base\/jdk.internal.misc\n@@ -36,0 +37,2 @@\n+import jdk.internal.misc.PreviewFeatures;\n+\n@@ -43,18 +46,40 @@\n-        String tests[] = {\n-            \/\/ Try to replace classes that are used by the archived subgraph graphs. (CDS should be disabled)\n-            \"-early -notshared -subgraph java\/lang\/module\/ResolvedModule jdk.internal.module.ArchivedModuleGraph\",\n-            \"-early -notshared -subgraph java\/lang\/Integer java.lang.Integer$IntegerCache\",\n-\n-            \/\/ CDS should not be disabled -- these critical classes cannot be replaced because\n-            \/\/ JvmtiExport::early_class_hook_env() is false.\n-            \"-subgraph java\/lang\/module\/Configuration java.lang.module.Configuration\",\n-            \"-subgraph java\/lang\/ModuleLayer java.lang.ModuleLayer\",\n-            \"-subgraph java\/lang\/Integer java.lang.Integer$IntegerCache\",\n-\n-            \/\/ Tests for archived full module graph. We cannot use whitebox, which requires appending to bootclasspath.\n-            \/\/ VM will disable full module graph if bootclasspath is appended.\n-            \"-nowhitebox -early -notshared -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n-            \"-nowhitebox -early -notshared -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n-            \"-nowhitebox -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n-            \"-nowhitebox -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n-        };\n+        String tests[];\n+        \/\/ IntegerCache does not exist in preview mode so it should not be expected in the output\n+        if (PreviewFeatures.isEnabled()) {\n+            tests = new String[] {\n+                \/\/ Try to replace classes that are used by the archived subgraph graphs. (CDS should be disabled)\n+                \"-early -notshared -subgraph java\/lang\/module\/ResolvedModule jdk.internal.module.ArchivedModuleGraph\",\n+                \"-early -notshared -subgraph java\/lang\/Integer java.lang.Integer$IntegerCache\",\n+\n+                \/\/ CDS should not be disabled -- these critical classes cannot be replaced because\n+                \/\/ JvmtiExport::early_class_hook_env() is false.\n+                \"-subgraph java\/lang\/module\/Configuration java.lang.module.Configuration\",\n+                \"-subgraph java\/lang\/ModuleLayer java.lang.ModuleLayer\",\n+\n+                \/\/ Tests for archived full module graph. We cannot use whitebox, which requires appending to bootclasspath.\n+                \/\/ VM will disable full module graph if bootclasspath is appended.\n+                \"-nowhitebox -early -notshared -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -early -notshared -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n+            };\n+        } else {\n+            tests = new String[] {\n+                \/\/ Try to replace classes that are used by the archived subgraph graphs. (CDS should be disabled)\n+                \"-early -notshared -subgraph java\/lang\/module\/ResolvedModule jdk.internal.module.ArchivedModuleGraph\",\n+                \"-early -notshared -subgraph java\/lang\/Integer java.lang.Integer$IntegerCache\",\n+\n+                \/\/ CDS should not be disabled -- these critical classes cannot be replaced because\n+                \/\/ JvmtiExport::early_class_hook_env() is false.\n+                \"-subgraph java\/lang\/module\/Configuration java.lang.module.Configuration\",\n+                \"-subgraph java\/lang\/ModuleLayer java.lang.ModuleLayer\",\n+                \"-subgraph java\/lang\/Integer java.lang.Integer$IntegerCache\",\n+\n+                \/\/ Tests for archived full module graph. We cannot use whitebox, which requires appending to bootclasspath.\n+                \/\/ VM will disable full module graph if bootclasspath is appended.\n+                \"-nowhitebox -early -notshared -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -early -notshared -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -subgraph java\/lang\/Module jdk.internal.module.ArchivedBootLayer\",\n+                \"-nowhitebox -subgraph java\/lang\/ModuleLayer jdk.internal.module.ArchivedBootLayer\",\n+            };\n+        }\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/serviceability\/ReplaceCriticalClassesForSubgraphs.java","additions":44,"deletions":19,"binary":false,"changes":63,"status":"modified"}]}