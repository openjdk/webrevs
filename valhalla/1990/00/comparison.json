{"files":[{"patch":"@@ -1205,1 +1205,0 @@\n-                    implicit |= STRICT;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Check.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1744,1 +1744,1 @@\n-                isUninitializedNonNullableField(sym));\n+                isNonNullableField(sym));\n@@ -1754,1 +1754,1 @@\n-        boolean isUninitializedNonNullableField(VarSymbol sym) {\n+        boolean isNonNullableField(VarSymbol sym) {\n@@ -1756,1 +1756,1 @@\n-                    ((sym.flags() & (FINAL | HASINIT | PARAMETER)) == 0 &&\n+                    ((sym.flags() & (FINAL | PARAMETER)) == 0 &&\n@@ -2622,1 +2622,8 @@\n-                        if (allowValueClasses && (var.owner == classDef.sym && !var.isStatic() && var.isStrict() && !isInstanceRecordField)) {\n+                        if (allowValueClasses &&\n+                                (var.owner == classDef.sym &&\n+                                !var.isStatic() &&\n+                                (var.isStrict() || types.isNonNullable(var.type)) &&\n+                                !isInstanceRecordField)) {\n+                            Error errorKey =  (var.owner.isValueClass()) ?\n+                                    Errors.StrictFieldNotHaveBeenInitializedBeforeSuper(var) :\n+                                    Errors.NullRestrictedFieldNotHaveBeenInitializedBeforeSuper(var);\n@@ -2625,1 +2632,1 @@\n-                                        var, Errors.NonNullableShouldBeInitialized);\n+                                        var, errorKey);\n@@ -2627,1 +2634,1 @@\n-                                checkInit(TreeInfo.diagEndPos(tree), var, Errors.StrictFieldNotHaveBeenInitializedBeforeSuper(var));\n+                                checkInit(TreeInfo.diagEndPos(tree), var, errorKey);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":13,"deletions":6,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -4396,0 +4396,4 @@\n+\n+# 0: symbol\n+compiler.err.null.restricted.field.not.have.been.initialized.before.super=\\\n+    null restricted field {0} is not initialized before the supertype constructor has been called\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/compiler.properties","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,1 @@\n-    NonNullableShouldBeInitialized! field;\n+    static String! staticField;\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/NonNullableShouldBeInitialized.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,31 @@\n+\/*\n+ * Copyright (c) 2026, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/\/ key: compiler.err.null.restricted.field.not.have.been.initialized.before.super\n+\/\/ key: compiler.note.preview.filename\n+\/\/ key: compiler.note.preview.recompile\n+\/\/ options: --enable-preview -source ${jdk.version}\n+\n+class NonNullableShouldBeInitializedBeforeSuper {\n+    NonNullableShouldBeInitializedBeforeSuper! field;\n+}\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/NonNullableShouldBeInitializedBeforeSuper.java","additions":31,"deletions":0,"binary":false,"changes":31,"status":"added"},{"patch":"@@ -2,2 +2,2 @@\n-NonNullFieldInitTest.java:14:20: compiler.err.strict.field.not.have.been.initialized.before.super: s\n-NonNullFieldInitTest.java:18:17: compiler.err.non.nullable.should.be.initialized\n+NonNullFieldInitTest.java:14:20: compiler.err.null.restricted.field.not.have.been.initialized.before.super: s\n+NonNullFieldInitTest.java:18:17: compiler.err.null.restricted.field.not.have.been.initialized.before.super: s\n","filename":"test\/langtools\/tools\/javac\/nullability\/NonNullFieldInitTest.out","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -88,1 +88,1 @@\n-                #{TYPE} fld = init();\n+                #{TYPE} fld;\n@@ -93,0 +93,5 @@\n+\n+                Test() {\n+                    fld = init();\n+                    super();\n+                }\n","filename":"test\/langtools\/tools\/javac\/nullability\/NullRestrictionReflectiveTest.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -147,1 +147,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -155,1 +155,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -164,1 +164,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -172,1 +172,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -181,1 +181,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -190,1 +190,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -198,1 +198,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\")\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\")\n@@ -494,2 +494,2 @@\n-                                Result.Clean,\n-                                \"\"),\n+                                Result.Error,\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -511,1 +511,1 @@\n-    void testNonNullableFieldsAreStrict() throws Exception {\n+    void testNonNullableFieldsAreInitializedBeforeSuper() throws Exception {\n@@ -525,1 +525,1 @@\n-                                \"compiler.err.strict.field.not.have.been.initialized.before.super\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -533,1 +533,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.null.restricted.field.not.have.been.initialized.before.super\"),\n@@ -549,2 +549,5 @@\n-                                    Object! o = new Object();\n-                                    Test() {}\n+                                    Object! o;\n+                                    Test() {\n+                                        o = new Object();\n+                                        super();\n+                                    }\n@@ -558,1 +561,5 @@\n-                                    Object! o = new Object();\n+                                    Object! o;\n+                                    Test() {\n+                                        o = new Object();\n+                                        super();\n+                                    }\n@@ -593,27 +600,0 @@\n-\n-        for (String source : List.of(\n-                \"\"\"\n-                class Test {\n-                    Object! o = new Object();\n-                }\n-                \"\"\",\n-                \"\"\"\n-                class Test {\n-                    static Object! o = new Object();\n-                }\n-                \"\"\"\n-        )) {\n-            File dir = assertOK(true, source);\n-            for (final File fileEntry : dir.listFiles()) {\n-                var classFile = ClassFile.of().parse(fileEntry.toPath());\n-                for (var field : classFile.fields()) {\n-                    if (!field.flags().has(AccessFlag.STATIC)) {\n-                        Set<AccessFlag> fieldFlags = field.flags().flags();\n-                        Assert.check(fieldFlags.size() == 1 && fieldFlags.contains(AccessFlag.STRICT_INIT));\n-                    } else {\n-                        Set<AccessFlag> fieldFlags = field.flags().flags();\n-                        Assert.check(fieldFlags.size() == 2 && fieldFlags.contains(AccessFlag.STRICT_INIT) && fieldFlags.contains(AccessFlag.STATIC));\n-                    }\n-                }\n-            }\n-        }\n","filename":"test\/langtools\/tools\/javac\/nullability\/NullabilityCompilationTests.java","additions":22,"deletions":42,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -79,1 +79,5 @@\n-                        String! t = \"\";\n+                        String! t;\n+                        Test() {\n+                            t = \"\";\n+                            super();\n+                        }\n@@ -88,1 +92,5 @@\n-                        List<Test>! t = new ArrayList<>();\n+                        List<Test>! t;\n+                        Test() {\n+                            t = new ArrayList<>();\n+                            super();\n+                        }\n@@ -96,1 +104,5 @@\n-                        T! t = (T)new Object();\n+                        T! t;\n+                        Test() {\n+                            t = (T)new Object();\n+                            super();\n+                        }\n@@ -104,1 +116,5 @@\n-                        String[]! t = {\"\"};\n+                        String[]! t;\n+                        Test() {\n+                            t = new String[]{\"\"};\n+                            super();\n+                        }\n@@ -112,1 +128,5 @@\n-                        String[][]! t = {{\"\"}};\n+                        String[][]! t;\n+                        Test() {\n+                            t = new String[][]{{\"\"}};\n+                            super();\n+                        }\n","filename":"test\/langtools\/tools\/javac\/nullability\/NullabilitySignatureAttrTests.java","additions":25,"deletions":5,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -31,4 +31,6 @@\n-    public String! s = \"\";\n-    public String[]! s_arr = new String[] { \"\" };\n-    @SuppressWarnings(\"unchecked\")\n-    public X! x = (X)(String)\"\";\n+    public String! s;\n+    public String[]! s_arr;\n+    public X! x;\n+    public X[]! x_arr;\n+    public List<X>! list_x;\n+\n@@ -36,2 +38,8 @@\n-    public X[]! x_arr = (X[])(String[])new String[] { \"\" };\n-    public List<X>! list_x = List.of(null);\n+    Foo() {\n+        s = \"\";\n+        s_arr = new String[] { \"\" };\n+        x = (X)(String)\"\";\n+        x_arr = (X[])(String[])new String[] { \"\" };\n+        list_x = List.of(null);\n+        super();\n+    }\n","filename":"test\/langtools\/tools\/javac\/nullability\/separate\/pkg\/Foo.java","additions":14,"deletions":6,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -908,1 +908,1 @@\n-        assertFail(\"compiler.err.non.nullable.should.be.initialized\",\n+        assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n@@ -1064,43 +1064,0 @@\n-            assertFail(\"compiler.err.non.nullable.should.be.initialized\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict int i;\n-                    }\n-                    \"\"\"\n-            );\n-            assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict int i;\n-                        Test() {\n-                            super();\n-                            i = 0;\n-                        }\n-                    }\n-                    \"\"\"\n-            );\n-            assertFail(\"compiler.err.cant.ref.before.ctor.called\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.NullRestricted;\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class StrictNR {\n-                        static value class IValue {\n-                            int i = 0;\n-                        }\n-                        value class SValue {\n-                            short s = 0;\n-                        }\n-                        @Strict\n-                        @NullRestricted\n-                        IValue val = new IValue();\n-                            @Strict\n-                            @NullRestricted\n-                            SValue val4;\n-                        public StrictNR() {\n-                            val4 = new SValue();\n-                        }\n-                    }\n-                    \"\"\"\n-            );\n","filename":"test\/langtools\/tools\/javac\/valhalla\/value-objects\/ValueObjectCompilationTests.java","additions":1,"deletions":44,"binary":false,"changes":45,"status":"modified"}]}