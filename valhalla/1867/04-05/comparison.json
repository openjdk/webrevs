{"files":[{"patch":"@@ -62,2 +62,0 @@\n-    private final Names names;\n-    private final Symtab syms;\n@@ -72,2 +70,0 @@\n-        names = Names.instance(context);\n-        syms = Symtab.instance(context);\n@@ -87,7 +83,0 @@\n-    JCExpression generateNullCheckIfNeeded(JCExpression tree, JCNullableTypeExpression.NullMarker expectedNullness) {\n-        if (expectedNullness == JCNullableTypeExpression.NullMarker.NOT_NULL && !types.isNonNullable(tree.type)) {\n-            return attr.makeNullCheck(tree, true);\n-        }\n-        return tree;\n-    }\n-\n@@ -105,1 +94,3 @@\n-            tree.init = generateNullCheckIfNeeded(tree.init, tree.sym.type.getNullMarker());\n+            if (types.isNonNullable(tree.sym.type)) {\n+                tree.init = attr.makeNullCheck(tree.init, true);\n+            }\n@@ -116,1 +107,2 @@\n-                rhsSym != null) {\n+                rhsSym != null &&\n+                types.isNonNullable(lhsSym.type)) {\n@@ -118,1 +110,1 @@\n-            tree.rhs = generateNullCheckIfNeeded(tree.rhs, lhsSym.type.getNullMarker());\n+            tree.rhs = attr.makeNullCheck(tree.rhs, true);\n@@ -128,1 +120,2 @@\n-                rhsSym != null) {\n+                rhsSym != null &&\n+                types.isNonNullable(lhsSym.type)) {\n@@ -130,1 +123,1 @@\n-            tree.rhs = generateNullCheckIfNeeded(tree.rhs, lhsSym.type.getNullMarker());\n+            tree.rhs = attr.makeNullCheck(tree.rhs, true);\n@@ -138,1 +131,1 @@\n-            tree.expr = generateNullCheckIfNeeded(tree.expr, JCNullableTypeExpression.NullMarker.NOT_NULL);\n+            tree.expr = attr.makeNullCheck(tree.expr, true);\n@@ -171,2 +164,2 @@\n-            if (sym != null && !types.isNonNullable(sym.type)) {\n-                tree.expr = generateNullCheckIfNeeded(tree.expr, returnType.getNullMarker());\n+            if (sym != null && types.isNonNullable(returnType)) {\n+                tree.expr = attr.makeNullCheck(tree.expr, true);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/NullChecksWriter.java","additions":12,"deletions":19,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -910,1 +910,0 @@\n-        \/\/result = generateNullCheckIfNeeded((JCExpression)result);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/TransTypes.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}