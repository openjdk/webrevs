{"files":[{"patch":"@@ -3202,7 +3202,5 @@\n-    if (EnableValhalla) {\n-      if (!supports_inline_types()) {\n-        const bool is_module = (flags & JVM_ACC_MODULE) != 0;\n-        const bool is_interface = (flags & JVM_ACC_INTERFACE) != 0;\n-        if (!is_module && !is_interface) {\n-          flags |= JVM_ACC_IDENTITY;\n-        }\n+    if (!supports_inline_types()) {\n+      const bool is_module = (flags & JVM_ACC_MODULE) != 0;\n+      const bool is_interface = (flags & JVM_ACC_INTERFACE) != 0;\n+      if (!is_module && !is_interface) {\n+        flags |= JVM_ACC_IDENTITY;\n@@ -4649,1 +4647,0 @@\n-  const bool is_identity_class = (flags & JVM_ACC_IDENTITY) != 0;\n@@ -4678,1 +4675,1 @@\n-    if (!is_identity_class)  class_note = \" (a value class)\";\n+    if (!is_identity)  class_note = \" (a value class)\";\n@@ -6040,7 +6037,5 @@\n-  if (EnableValhalla) {\n-    if (!supports_inline_types()) {\n-      const bool is_module = (flags & JVM_ACC_MODULE) != 0;\n-      const bool is_interface = (flags & JVM_ACC_INTERFACE) != 0;\n-      if (!is_module && !is_interface) {\n-        flags |= JVM_ACC_IDENTITY;\n-      }\n+  if (!supports_inline_types()) {\n+    const bool is_module = (flags & JVM_ACC_MODULE) != 0;\n+    const bool is_interface = (flags & JVM_ACC_INTERFACE) != 0;\n+    if (!is_module && !is_interface) {\n+      flags |= JVM_ACC_IDENTITY;\n@@ -6050,0 +6045,1 @@\n+\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":12,"deletions":16,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -54,2 +54,3 @@\n-        testIt(\"SUPERset\", 0x21);  \/\/ ACC_SUPER 0x20 + ACC_PUBLIC 0x1\n-        testIt(\"SUPERnotset\", Modifier.PUBLIC);\n+        testIt(\"SUPERset\", Modifier.PUBLIC | Modifier.IDENTITY);\n+        \/\/ Because of the repurposing of ACC_SUPER into ACC_IDENTITY by JEP 401, the VM now fixes missing ACC_IDENTITY flags in old class files\n+        testIt(\"SUPERnotset\", Modifier.PUBLIC | Modifier.IDENTITY);\n@@ -66,1 +67,2 @@\n-        if (flags != Modifier.PUBLIC) {\n+        \/\/ Because of the repurposing of ACC_SUPER into ACC_IDENTITY by JEP 401, the VM now fixes missing ACC_IDENTITY flags in old class files\n+        if (flags != (Modifier.PUBLIC | Modifier.IDENTITY)) {\n@@ -73,1 +75,2 @@\n-        if (flags != Modifier.PUBLIC) {\n+        \/\/ Because of the repurposing of ACC_SUPER into ACC_IDENTITY by JEP 401, the VM now fixes missing ACC_IDENTITY flags in old class files\n+        if (flags != (Modifier.PUBLIC | Modifier.IDENTITY)) {\n","filename":"test\/hotspot\/jtreg\/runtime\/ClassFile\/ClassAccessFlagsRawTest.java","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"}]}