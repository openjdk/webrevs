{"files":[{"patch":"@@ -2332,0 +2332,11 @@\n+  if (_gvn.type(base)->is_inlinetypeptr() && is_store) {\n+    \/\/ FIXME: Larval bit check is needed to preserve the semantics of value\n+    \/\/ objects which can be mutated only if its _larval bit is set. Since\n+    \/\/ the oop is not always an AllocateNode, we have to find an utility way\n+    \/\/ to check the larval state for all kind of oops.\n+    AllocateNode* alloc = AllocateNode::Ideal_allocation(base);\n+    if (alloc != nullptr) {\n+      assert(alloc->_larval, \"InlineType instance must be in _larval state for unsafe put operation.\\n\");\n+    }\n+  }\n+\n@@ -2352,8 +2363,0 @@\n-      \/\/ FIXME: Larval bit check is needed to preserve the semantics of value\n-      \/\/ objects which can be mutated only if its _larval bit is set. Since\n-      \/\/ the oop is not always an AllocateNode, we have to find an utility way\n-      \/\/ to check the larval state for all kind of oops.\n-      AllocateNode* alloc = AllocateNode::Ideal_allocation(base);\n-      if (alloc != nullptr) {\n-        assert(alloc->_larval, \"InlineType instance must be in _larval state for unsafe put operation.\\n\");\n-      }\n@@ -2630,6 +2633,0 @@\n-  if (_gvn.type(base)->is_inlinetypeptr() && is_store) {\n-    AllocateNode* alloc = AllocateNode::Ideal_allocation(base);\n-    if (alloc != nullptr) {\n-      assert(alloc->_larval, \"InlineType instance must be in _larval state for unsafe put operation.\\n\");\n-    }\n-  }\n@@ -2667,2 +2664,0 @@\n-  const TypeInstPtr* ptr = buffer->bottom_type()->isa_instptr();\n-\n@@ -2680,0 +2675,1 @@\n+  const TypeInstPtr* ptr = buffer->bottom_type()->isa_instptr();\n","filename":"src\/hotspot\/share\/opto\/library_call.cpp","additions":12,"deletions":16,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -408,1 +408,1 @@\n-    @IR(failOn = {CALL_UNSAFE, ALLOC})\n+    @IR(failOn = {CALL_UNSAFE})\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestIntrinsics.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}