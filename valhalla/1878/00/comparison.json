{"files":[{"patch":"@@ -53,1 +53,0 @@\n-import java.lang.reflect.RuntimeType;\n@@ -231,2 +230,1 @@\n-                              Constable,\n-                              RuntimeType<T> {\n+                              Constable {\n@@ -680,12 +678,0 @@\n-    \/**\n-     * Returns a {@code Class} object representing the null restricted type\n-     * of this class or interface.\n-     *\n-     * @return the {@code Class} representing the null restricted type of\n-     *         this class or interface\n-     * @since Valhalla\n-     *\/\n-    public Class<?> asNullRestrictedType() {\n-        return this;\n-    }\n-\n@@ -3580,1 +3566,1 @@\n-        if (!canCast(obj))\n+        if (obj != null && !isInstance(obj))\n@@ -3589,14 +3575,0 @@\n-    \/**\n-     * Tests whether a cast to this class or interface will succeed.\n-     *\/\n-    public boolean canCast(Object obj) {\n-        return obj == null || isInstance(obj);\n-    }\n-\n-    \/**\n-     * Returns this {@code Class}.\n-     *\/\n-    public Class<T> baseClass() {\n-        return this;\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Class.java","additions":2,"deletions":30,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import java.lang.reflect.RuntimeType;\n@@ -120,13 +119,0 @@\n-    \/**\n-     * Returns a {@link RuntimeType} for the null-restricted type of {@code cls}.\n-     *\n-     * @param lookup unused\n-     * @param name unused\n-     * @param type the required result type (must be {@code RuntimeType.class})\n-     * @param cls the class, interface, or array type to be null-restricted\n-     * @return the null-restricted {@code RuntimeType}\n-     *\/\n-    public static RuntimeType<?> nullRestrictedClass(MethodHandles.Lookup lookup, String name, Class<?> type, Class<?> cls) {\n-        return RuntimeType.nullRestricted(cls);\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/ConstantBootstraps.java","additions":0,"deletions":14,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -519,10 +519,0 @@\n-    \/**\n-     * Get the {@code RuntimeType} enforced on components of an array.\n-     *\n-     * @param array the array\n-     * @return the {@code RuntimeType} of the components of {@code array}\n-     *\/\n-    public static RuntimeType<?> componentType(Object array) {\n-        return array.getClass().getComponentType();\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/Array.java","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -294,15 +294,0 @@\n-    \/**\n-     * Get a {@code RuntimeType} representing the type that is\n-     * dynamically enforced by this field. If the field does\n-     * not perform dynamic checks, this is the type that is\n-     * enforced by bytecode verification (the same as\n-     * {@link #getType} in most cases, but {@code Object} in\n-     * the case of an interface type).\n-     *\n-     * @return a {@code RuntimeType} representing the type that\n-     *         is dynamically enforced by this field\n-     *\/\n-    public RuntimeType<?> getRuntimeType() {\n-        return !type.isInterface() ? type : Object.class;\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/Field.java","additions":0,"deletions":15,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -1,94 +0,0 @@\n-\/*\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package java.lang.reflect;\n-\n-import java.lang.constant.*;\n-import java.util.Optional;\n-import java.util.Objects;\n-\n-\/**\n- * A {@code NullRestrictedClass} represents the null-restricted type of a class,\n- * interface, or array type.\n- *\/\n-final class NullRestrictedClass<T> implements RuntimeType<T> {\n-\n-    private final Class<T> c;\n-\n-    \/**\n-     * Assumes {@code c} is a class, interface, or array type, not a primitive.\n-     *\/\n-    NullRestrictedClass(Class<T> c) {\n-        this.c = c;\n-    }\n-\n-    \/**\n-     * Ensure an object is non-null and an instance of the class.\n-     * @throws NullPointerException if {@code arg} is {@code null}\n-     * @throws ClassCastException if {@code arg} is an instance of an incompatible class\n-     *\/\n-    public T cast(Object arg) {\n-        if (arg == null) throw new NullPointerException();\n-        return c.cast(arg);\n-    }\n-\n-    \/**\n-     * Tests whether {@code arg} is a non-null instance of the class.\n-     *\/\n-    public boolean canCast(Object arg) {\n-        return c.isInstance(arg);\n-    }\n-\n-    public Class<T> baseClass() {\n-        return c;\n-    }\n-\n-    public String toString() {\n-        \/\/ note that array types use descriptors\n-        return c.getName() + \"!\";\n-    }\n-\n-    public boolean equals(Object o) {\n-        return o instanceof NullRestrictedClass<?> that &&\n-               this.c.equals(that.c);\n-    }\n-\n-    public int hashCode() {\n-        return Objects.hash(NullRestrictedClass.class, c);\n-    }\n-\n-    public Optional<DynamicConstantDesc<NullRestrictedClass<T>>> describeConstable() {\n-        return c.describeConstable().map(classDesc ->\n-            DynamicConstantDesc.of(BSM_NULL_RESTRICTED_CLASS, classDesc));\n-    }\n-\n-    private static final DirectMethodHandleDesc BSM_NULL_RESTRICTED_CLASS =\n-        ConstantDescs.ofConstantBootstrap(\n-            ConstantDescs.CD_ConstantBootstraps,\n-            \"nullRestrictedClass\",\n-            RuntimeType.class.describeConstable().get(),\n-            ConstantDescs.CD_Class);\n-\n-}\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/NullRestrictedClass.java","additions":0,"deletions":94,"binary":false,"changes":94,"status":"deleted"},{"patch":"@@ -1,85 +0,0 @@\n-\/*\n- * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package java.lang.reflect;\n-\n-import java.lang.constant.Constable;\n-\n-\/**\n- * A {@code RuntimeType} represents a stable property of an object reference\n- * that can be dynamically checked at run time. These checks may be applied\n- * to a {@link Field} or an {@link Array} component.\n- *\n- * A {@code RuntimeType} might be a class, interface, or array type,\n- * represented with a {@link java.lang.Class} object. It might also be a\n- * null-restricted class, interface, or array type, which excludes the\n- * {@code null} reference. Other kinds of {@code RuntimeType}s may be\n- * supported in a future release.\n- *\n- * @param <T> the compile-time type enforced by this {@code RuntimeType}\n- *\/\n-public sealed interface RuntimeType<T> extends Constable\n-                                       permits Class, NullRestrictedClass {\n-\n-    \/**\n-     * Ensure an object has this type. If not, throw a {@link RuntimeException}.\n-     *\n-     * @param ref the object reference to check\n-     * @return the reference after casting\n-     *\/\n-    T cast(Object ref);\n-\n-    \/**\n-     * Tests whether a cast to this type will succeed.\n-     *\n-     * @param ref the object reference to check\n-     * @return {@code true} iff the {@link #cast} operation will succeed\n-     *\/\n-    boolean canCast(Object ref);\n-\n-    \/**\n-     * The most-specific {@code Class} that includes all values of this\n-     * {@code RuntimeType}.\n-     *\n-     * @return a {@code Class}\n-     *\/\n-    Class<?> baseClass();\n-\n-    \/**\n-     * Create a null-restricted class, interface, or array type.\n-     *\n-     * @param <T> the compile-time type of the {@code Class} object\n-     * @param c   the class to which instances of the {@code RuntimeType}\n-     *            should belong\n-     * @return    a null-restricted {@code RuntimeType}\n-     *\n-     * @throws IllegalArgumentException if {@code c} represents a primitive type\n-     *\/\n-    public static <T> RuntimeType<T> nullRestricted(Class<T> c) {\n-        if (c.isPrimitive()) throw new IllegalArgumentException();\n-        return new NullRestrictedClass<T>(c);\n-    }\n-\n-}\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/RuntimeType.java","additions":0,"deletions":85,"binary":false,"changes":85,"status":"deleted"},{"patch":"@@ -243,1 +243,0 @@\n-    public final Name asNullRestrictedType;\n@@ -442,1 +441,0 @@\n-        asNullRestrictedType = fromString(\"asNullRestrictedType\");\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/util\/Names.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}