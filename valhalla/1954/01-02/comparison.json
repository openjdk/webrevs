{"files":[{"patch":"@@ -799,1 +799,1 @@\n-    hash = result.get_jint() & markWord::hash_mask;\n+    hash = result.get_jint();\n@@ -802,4 +802,8 @@\n-    markWord mark = ho->mark().copy_set_hash(hash);\n-    ho->set_mark(mark);\n-\n-    return checked_cast<jint>(hash);\n+    markWord old_mark, new_mark, test;\n+    do {\n+      old_mark = ho->mark_acquire();\n+      new_mark = old_mark.copy_set_hash(hash);\n+      test = ho->cas_set_mark(new_mark, old_mark);\n+    } while (test != old_mark);\n+\n+    return checked_cast<jint>(new_mark.hash());\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"}]}