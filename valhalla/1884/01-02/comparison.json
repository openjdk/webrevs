{"files":[{"patch":"@@ -153,1 +153,5 @@\n-        \/\/ don't recurse inside let expressions, they are backend artifacts\n+        \/\/ only recurse in certain cases\n+        if (tree.needsNullChecks) {\n+            \/\/ and recurse on the expression part only\n+            tree.expr = translate(tree.expr);\n+        }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/NullChecksWriter.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -675,0 +675,1 @@\n+                r.needsNullChecks = true;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/TransPatterns.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -3472,0 +3472,1 @@\n+        public boolean needsNullChecks;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/tree\/JCTree.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -148,20 +148,0 @@\n-                \/*\"\"\"\n-                class Test {\n-                    static String id(int i, String!... arg) { return \"\"; }\n-                    public static void main(String... args) {\n-                        String s1 = null;\n-                        String s2 = \"\";\n-                        Object o = id(1, s1, s2); \/\/ NPE at runtime, method invocation\n-                    }\n-                }\n-                \"\"\",\n-                \"\"\"\n-                class Test {\n-                    static String id(int i, String!... arg) { return \"\"; }\n-                    public static void main(String... args) {\n-                        String s1 = \"\";\n-                        String s2 = null;\n-                        Object o = id(1, s1, s2); \/\/ NPE at runtime, method invocation\n-                    }\n-                }\n-                \"\"\",*\/\n@@ -233,0 +213,13 @@\n+                \"\"\",\n+                \"\"\"\n+                class Test {\n+                    public static void main(String... args) {\n+                        int i = switch (new Object()) {\n+                            default -> {\n+                                Object obj = null;\n+                                Object! nonNull = obj;\n+                                yield 0;\n+                            }\n+                        };\n+                    }\n+                }\n","filename":"test\/langtools\/tools\/javac\/nullability\/RuntimeNullChecks.java","additions":13,"deletions":20,"binary":false,"changes":33,"status":"modified"}]}