{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,6 +71,0 @@\n-    private static String[] PREVIEW_OPTIONS_PLUS_VM_ANNO = {\n-            \"--enable-preview\",\n-            \"-source\", Integer.toString(Runtime.version().feature()),\n-            \"--add-exports=java.base\/jdk.internal.vm.annotation=ALL-UNNAMED\"\n-    };\n-\n@@ -746,39 +740,0 @@\n-\n-        \/\/ testing experimental @Strict annotation\n-        String[] previousOptions = getCompileOptions();\n-        try {\n-            setCompileOptions(PREVIEW_OPTIONS_PLUS_VM_ANNO);\n-            for (String source : List.of(\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict int i = 0;\n-                    }\n-                    \"\"\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict final int i = 0;\n-                    }\n-                    \"\"\"\n-            )) {\n-                File dir = assertOK(true, source);\n-                for (final File fileEntry : dir.listFiles()) {\n-                    var classFile = ClassFile.of().parse(fileEntry.toPath());\n-                    Assert.check(classFile.flags().has(AccessFlag.IDENTITY));\n-                    for (var field : classFile.fields()) {\n-                        if (!field.flags().has(AccessFlag.STATIC)) {\n-                            Set<AccessFlag> fieldFlags = field.flags().flags();\n-                            Assert.check(fieldFlags.contains(AccessFlag.STRICT_INIT));\n-                            if (field.attributes().size() != 0) {\n-                                for (var attr : field.attributes()) {\n-                                    Assert.check(!attr.attributeName().stringValue().equals(\"RuntimeInvisibleAnnotations\"));\n-                                }\n-                            }\n-                        }\n-                    }\n-                }\n-            }\n-        } finally {\n-            setCompileOptions(previousOptions);\n-        }\n@@ -1008,103 +963,0 @@\n-        String[] previousOptions = getCompileOptions();\n-        try {\n-            setCompileOptions(PREVIEW_OPTIONS_PLUS_VM_ANNO);\n-            String[] sources = new String[]{\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        static value class IValue {\n-                            int i = 0;\n-                        }\n-                        @Strict\n-                        final IValue val = new IValue();\n-                    }\n-                    \"\"\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        static value class IValue {\n-                            int i = 0;\n-                        }\n-                        @Strict\n-                        final IValue val;\n-                        Test() {\n-                            val = new IValue();\n-                        }\n-                    }\n-                    \"\"\"\n-            };\n-            String expectedCodeSequence = \"aload_0,new,dup,invokespecial,putfield,aload_0,invokespecial,return\";\n-            for (String src : sources) {\n-                checkMnemonicsFor(src, \"aload_0,new,dup,invokespecial,putfield,aload_0,invokespecial,return\");\n-            }\n-\n-            assertFail(\"compiler.err.cant.ref.before.ctor.called\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.NullRestricted;\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class StrictNR {\n-                        static value class IValue {\n-                            int i = 0;\n-                        }\n-                        value class SValue {\n-                            short s = 0;\n-                        }\n-                        @Strict\n-                        @NullRestricted\n-                        IValue val = new IValue();\n-                        @Strict\n-                        @NullRestricted\n-                        final IValue val2;\n-                        @Strict\n-                        @NullRestricted\n-                        SValue val3 = new SValue();\n-                    }\n-                    \"\"\"\n-            );\n-            assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict int i;\n-                    }\n-                    \"\"\"\n-            );\n-            assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict int i;\n-                        Test() {\n-                            super();\n-                            i = 0;\n-                        }\n-                    }\n-                    \"\"\"\n-            );\n-            assertFail(\"compiler.err.cant.ref.before.ctor.called\",\n-                    \"\"\"\n-                    import jdk.internal.vm.annotation.NullRestricted;\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class StrictNR {\n-                        static value class IValue {\n-                            int i = 0;\n-                        }\n-                        value class SValue {\n-                            short s = 0;\n-                        }\n-                        @Strict\n-                        @NullRestricted\n-                        IValue val = new IValue();\n-                            @Strict\n-                            @NullRestricted\n-                            SValue val4;\n-                        public StrictNR() {\n-                            val4 = new SValue();\n-                        }\n-                    }\n-                    \"\"\"\n-            );\n-        } finally {\n-            setCompileOptions(previousOptions);\n-        }\n-\n@@ -1492,1 +1344,0 @@\n-                    \"--add-exports\", \"java.base\/jdk.internal.vm.annotation=ALL-UNNAMED\"\n@@ -1500,3 +1351,1 @@\n-                            import jdk.internal.vm.annotation.Strict;\n-                            class Test {\n-                                @Strict\n+                            value class Test {\n@@ -1504,1 +1353,0 @@\n-                                @Strict\n@@ -1528,3 +1376,1 @@\n-                            import jdk.internal.vm.annotation.Strict;\n-                            class Test {\n-                                @Strict\n+                            value class Test {\n@@ -1532,1 +1378,0 @@\n-                                @Strict\n@@ -1554,3 +1399,1 @@\n-                            import jdk.internal.vm.annotation.Strict;\n-                            class Test {\n-                                @Strict\n+                            value class Test {\n@@ -1558,1 +1401,0 @@\n-                                @Strict\n@@ -1636,3 +1478,1 @@\n-                    import jdk.internal.vm.annotation.Strict;\n-                    class Test {\n-                        @Strict\n+                    value class Test {\n@@ -1640,1 +1480,0 @@\n-                        @Strict\n","filename":"test\/langtools\/tools\/javac\/valhalla\/value-objects\/ValueObjectCompilationTests.java","additions":5,"deletions":166,"binary":false,"changes":171,"status":"modified"}]}