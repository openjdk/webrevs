{"files":[{"patch":"@@ -102,0 +102,3 @@\n+\n+COMPILATION_OUTPUTDIR := $(if $($(MODULE)_BIN), $($(MODULE)_BIN), $(JDK_OUTPUTDIR)\/modules)\n+\n@@ -108,1 +111,1 @@\n-    BIN := $(if $($(MODULE)_BIN), $($(MODULE)_BIN), $(JDK_OUTPUTDIR)\/modules), \\\n+    BIN := $(COMPILATION_OUTPUTDIR), \\\n@@ -141,0 +144,9 @@\n+  # Temporarily compile valueclasses into a separate directory with the form:\n+  #   <tempdir>\/<module>\/<classpath>\n+  # and then copy the class files into:\n+  #   <outdir>\/<module>\/META-INF\/preview\/<classpath>\n+  # We cannot compile directly into the desired directory because it's the\n+  # compiler which creates the original '<module>\/<classpath>\/...' hierarchy.\n+  VALUECLASS_OUTPUTDIR := $(SUPPORT_OUTPUTDIR)\/$(VALUECLASSES_STR)\n+  PREVIEW_OUTPUTDIR := $(COMPILATION_OUTPUTDIR)\/$(MODULE)\/META-INF\/preview\n+\n@@ -148,1 +160,1 @@\n-        BIN := $(SUPPORT_OUTPUTDIR)\/$(VALUECLASSES_STR)\/, \\\n+        BIN := $(VALUECLASS_OUTPUTDIR)\/, \\\n@@ -166,0 +178,8 @@\n+    # Restructure the class file hierarchy from <module>\/<classpath>\/... to <module>\/META-INF\/preview\/<classpath>\/...\n+    $(PREVIEW_OUTPUTDIR)\/_copy_valueclasses.marker: $($(MODULE)-$(VALUECLASSES_STR))\n+\t\t$(call MakeTargetDir)\n+\t\t$(CP) -R $(VALUECLASS_OUTPUTDIR)\/$(MODULE)\/. $(@D)\/\n+\t\t$(TOUCH) $@\n+\n+    TARGETS += $(PREVIEW_OUTPUTDIR)\/_copy_valueclasses.marker\n+\n","filename":"make\/CompileJavaModules.gmk","additions":22,"deletions":2,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+import java.util.NoSuchElementException;\n@@ -41,0 +42,1 @@\n+import java.util.function.Predicate;\n@@ -42,0 +44,2 @@\n+import java.util.stream.Stream;\n+\n@@ -329,0 +333,81 @@\n+    \/**\n+     * Returns the \"raw\" API for accessing underlying jimage resource entries.\n+     *\n+     * <p>This is only meaningful for use by code dealing directly with jimage\n+     * files, and cannot be used to reliably lookup resources used at runtime.\n+     *\n+     * <p>This API remains valid until the image reader from which it was\n+     * obtained is closed.\n+     *\/\n+    \/\/ Package visible for use by ImageReader.\n+    ResourceEntries getResourceEntries() {\n+        return new ResourceEntries() {\n+            @Override\n+            public Stream<String> entryNamesIn(String module) {\n+                if (module.isEmpty() || module.equals(\"modules\") || module.equals(\"packages\")) {\n+                    throw new IllegalArgumentException(\"Invalid module name: \" + module);\n+                }\n+                return IntStream.range(0, offsets.capacity())\n+                        .map(offsets::get)\n+                        .filter(offset -> offset != 0)\n+                        \/\/ Reusing a location instance or getting the module\n+                        \/\/ offset directly would save a lot of allocations here.\n+                        .mapToObj(offset -> ImageLocation.readFrom(BasicImageReader.this, offset))\n+                        \/\/ Reverse lookup of module offset would be faster here.\n+                        .filter(loc -> module.equals(loc.getModule()))\n+                        .map(ImageLocation::getFullName);\n+            }\n+\n+            private ImageLocation getResourceLocation(String name) {\n+                \/\/ Other types of invalid name just result in no entry being found.\n+                if (name.startsWith(\"\/modules\/\") || name.startsWith(\"\/packages\/\")) {\n+                    throw new IllegalArgumentException(\"Invalid entry name: \" + name);\n+                }\n+                ImageLocation location = BasicImageReader.this.findLocation(name);\n+                if (location == null) {\n+                    throw new NoSuchElementException(\"No such resource entry: \" + name);\n+                }\n+                return location;\n+            }\n+\n+            @Override\n+            public long sizeOf(String name) {\n+                return getResourceLocation(name).getUncompressedSize();\n+            }\n+\n+            @Override\n+            public InputStream open(String name) {\n+                return BasicImageReader.this.getResourceStream(getResourceLocation(name));\n+            }\n+        };\n+    }\n+\n+    \/**\n+     * Returns a sorted array of all matching entry names in the jimage file.\n+     *\n+     * <p>Entry names are of one of the following forms:\n+     * <ul>\n+     *     <li>{@code \"\/modules\/<mod-name>\/path\/to\/class-or-resource\"}\n+     *     <li>{@code \"\/<mod-name>\/path\/to\/directory\"}\n+     *     <li>{@code \"\/packages\/<package-name>\"}\n+     * <\/ul>\n+     *\n+     * <p>Note that the module names {@code \"modules\"} or {@code \"packages\"} are\n+     * not representable in a jimage file, so can never exist.\n+     *\n+     * <p>The resulting array is sorted lexicographically, and the resulting\n+     * order need not match that of a breadth or depth first search.\n+     *\n+     * @param matcher a predicate for entry names to be returned.\n+     *\/\n+    public String[] getEntryNames(Predicate<String> matcher) {\n+        int[] attributeOffsets = new int[offsets.capacity()];\n+        offsets.get(attributeOffsets);\n+        return IntStream.of(attributeOffsets)\n+                .filter(o -> o != 0)\n+                .mapToObj(o -> ImageLocation.readFrom(this, o).getFullName())\n+                .filter(matcher)\n+                .sorted()\n+                .toArray(String[]::new);\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/BasicImageReader.java","additions":85,"deletions":0,"binary":false,"changes":85,"status":"modified"},{"patch":"@@ -72,1 +72,1 @@\n-            int locationsSize, int stringsSize) {\n+                       int locationsSize, int stringsSize) {\n@@ -78,3 +78,2 @@\n-                int flags, int resourceCount,\n-                int tableLength, int locationsSize, int stringsSize)\n-    {\n+                       int flags, int resourceCount,\n+                       int tableLength, int locationsSize, int stringsSize) {\n@@ -92,1 +91,1 @@\n-       return HEADER_SLOTS * 4;\n+        return HEADER_SLOTS * 4;\n@@ -100,1 +99,1 @@\n-                \"jimage header not the correct size: \" + buffer.capacity());\n+                    \"jimage header not the correct size: \" + buffer.capacity());\n@@ -114,1 +113,1 @@\n-            resourceCount, tableLength, locationsSize, stringsSize);\n+                resourceCount, tableLength, locationsSize, stringsSize);\n@@ -176,4 +175,4 @@\n-               getRedirectSize() +\n-               getOffsetsSize() +\n-               getLocationsSize() +\n-               getStringsSize();\n+                getRedirectSize() +\n+                getOffsetsSize() +\n+                getLocationsSize() +\n+                getStringsSize();\n@@ -188,1 +187,1 @@\n-               getRedirectSize();\n+                getRedirectSize();\n@@ -193,1 +192,1 @@\n-               getOffsetsSize();\n+                getOffsetsSize();\n@@ -198,1 +197,1 @@\n-               getLocationsSize();\n+                getLocationsSize();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/ImageHeader.java","additions":13,"deletions":14,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.util.List;\n@@ -162,0 +163,23 @@\n+    \/**\n+     * Helper function to calculate package flags for {@code \"\/packages\/xxx\"}\n+     * directory entries.\n+     *\n+     * <p>Based on the module references, the flags are:\n+     * <ul>\n+     *     <li>{@code FLAGS_HAS_PREVIEW_VERSION} if <em>any<\/em> referenced\n+     *     package has a preview version.\n+     *     <li>{@code FLAGS_IS_PREVIEW_ONLY} if <em>all<\/em> referenced packages\n+     *     are preview only.\n+     * <\/ul>\n+     *\n+     * @return package flags for {@code \"\/packages\/xxx\"} directory entries.\n+     *\/\n+    public static int getPackageFlags(List<ModuleReference> moduleReferences) {\n+        boolean hasPreviewVersion =\n+                moduleReferences.stream().anyMatch(ModuleReference::hasPreviewVersion);\n+        boolean isPreviewOnly =\n+                moduleReferences.stream().allMatch(ModuleReference::isPreviewOnly);\n+        return (hasPreviewVersion ? ImageLocation.FLAGS_HAS_PREVIEW_VERSION : 0)\n+                | (isPreviewOnly ? ImageLocation.FLAGS_IS_PREVIEW_ONLY : 0);\n+    }\n+\n@@ -207,1 +231,1 @@\n-                    \"Invalid jimage attribute kind: \" + kind);\n+                        \"Invalid jimage attribute kind: \" + kind);\n@@ -229,1 +253,1 @@\n-                    stream.put((int)(value >> (i << 3)));\n+                    stream.put((int) (value >> (i << 3)));\n@@ -237,1 +261,1 @@\n-     }\n+    }\n@@ -252,1 +276,1 @@\n-        int moduleOffset = (int)attributes[ATTRIBUTE_MODULE];\n+        int moduleOffset = (int) attributes[ATTRIBUTE_MODULE];\n@@ -323,1 +347,1 @@\n-            ImageStrings strings) {\n+                          ImageStrings strings) {\n@@ -335,1 +359,1 @@\n-            int moduleOffset, int parentOffset, int baseOffset, int extOffset, ImageStrings strings) {\n+                                      int moduleOffset, int parentOffset, int baseOffset, int extOffset, ImageStrings strings) {\n@@ -375,1 +399,1 @@\n-                \"Invalid jimage attribute kind: \" + kind);\n+                    \"Invalid jimage attribute kind: \" + kind);\n@@ -383,1 +407,1 @@\n-                \"Invalid jimage attribute kind: \" + kind);\n+                    \"Invalid jimage attribute kind: \" + kind);\n@@ -385,1 +409,1 @@\n-        return getStrings().get((int)attributes[kind]);\n+        return getStrings().get((int) attributes[kind]);\n@@ -393,1 +417,1 @@\n-        return (int)getAttribute(ATTRIBUTE_MODULE);\n+        return (int) getAttribute(ATTRIBUTE_MODULE);\n@@ -401,1 +425,1 @@\n-        return (int)getAttribute(ATTRIBUTE_BASE);\n+        return (int) getAttribute(ATTRIBUTE_BASE);\n@@ -409,1 +433,1 @@\n-        return (int)getAttribute(ATTRIBUTE_PARENT);\n+        return (int) getAttribute(ATTRIBUTE_PARENT);\n@@ -417,1 +441,1 @@\n-        return (int)getAttribute(ATTRIBUTE_EXTENSION);\n+        return (int) getAttribute(ATTRIBUTE_EXTENSION);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/ImageLocation.java","additions":37,"deletions":13,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -233,0 +233,13 @@\n+    \/**\n+     * Returns the \"raw\" API for accessing underlying jimage resource entries.\n+     *\n+     * <p>This is only meaningful for use by code dealing directly with jimage\n+     * files, and cannot be used to reliably lookup resources used at runtime.\n+     *\n+     * <p>This API remains valid until the image reader from which it was\n+     * obtained is closed.\n+     *\/\n+    public ResourceEntries getResourceEntries() {\n+        return reader.getResourceEntries();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/ImageReader.java","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -56,2 +56,1 @@\n-    \/\/ TODO: Make this private again when image writer code is updated.\n-    public static final int FLAGS_PKG_HAS_RESOURCES = 0x4;\n+    private static final int FLAGS_PKG_HAS_RESOURCES = 0x4;\n@@ -121,1 +120,1 @@\n-        return ((flags & FLAGS_PKG_HAS_RESOURCES) != 0);\n+        return (flags & FLAGS_PKG_HAS_RESOURCES) != 0;\n@@ -179,1 +178,1 @@\n-        int testFlags = (includeNormal ? FLAGS_PKG_HAS_NORMAL_VERSION : 0)\n+        int includeMask = (includeNormal ? FLAGS_PKG_HAS_NORMAL_VERSION : 0)\n@@ -181,1 +180,1 @@\n-        if (testFlags == 0) {\n+        if (includeMask == 0) {\n@@ -191,8 +190,1 @@\n-\n-                    \/\/ Temporarily allow for *neither* flag to be set. This is what would\n-                    \/\/ be written by a 1.0 version of the jimage flag, and indicates a\n-                    \/\/ normal resource without a preview version.\n-                    \/\/ TODO: Remove the zero-check below once image writer code is updated.\n-                    int previewFlags =\n-                            buffer.get(idx) & (FLAGS_PKG_HAS_NORMAL_VERSION | FLAGS_PKG_HAS_PREVIEW_VERSION);\n-                    if (previewFlags == 0 || (previewFlags & testFlags) != 0) {\n+                    if ((buffer.get(idx) & includeMask) != 0) {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/ModuleReference.java","additions":5,"deletions":13,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -59,0 +59,3 @@\n+        if (!ENABLE_PREVIEW_MODE) {\n+            return false;\n+        }\n@@ -86,0 +89,10 @@\n+    ;\n+\n+    \/\/ Temporary system property to disable preview patching and enable the new preview mode\n+    \/\/ feature for testing\/development. Once the preview mode feature is finished, the value\n+    \/\/ will be always 'true' and this code, and all related dead-code can be removed.\n+    private static final boolean DISABLE_PREVIEW_PATCHING_DEFAULT = false;\n+    private static final boolean ENABLE_PREVIEW_MODE = Boolean.parseBoolean(\n+            System.getProperty(\n+                    \"DISABLE_PREVIEW_PATCHING\",\n+                    Boolean.toString(DISABLE_PREVIEW_PATCHING_DEFAULT)));\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/PreviewMode.java","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -0,0 +1,41 @@\n+package jdk.internal.jimage;\n+\n+import java.io.InputStream;\n+import java.util.stream.Stream;\n+\n+\/**\n+ * Accesses the underlying resource entries in a jimage file.\n+ *\n+ * <p>This API is designed only for use by the jlink classes, which manipulate\n+ * jimage files directly. For inspection of runtime resources, it is vital that\n+ * {@code previewMode} is correctly observed, making this API unsuitable.\n+ *\n+ * <p>This API ignores the {@code previewMode} of the {@link ImageReader} from\n+ * which it is obtained, and returns an unmapped view of entries (e.g. allowing\n+ * for direct access of resources in the {@code META-INF\/preview\/...} namespace).\n+ *\n+ * <p>It disallows access to resource directories (i.e. {@code \"\/modules\/...\"}\n+ * or packages (i.e. {@code \"\/packages\/...\"}.\n+ *\/\n+public interface ResourceEntries {\n+    \/**\n+     * Returns the full entry names for all resources in the given module, in\n+     * random order. Entry names will always be prefixed by the given module\n+     * name (e.g. \"\/<module-name\/...\").\n+     *\/\n+    Stream<String> entryNamesIn(String module);\n+\n+    \/**\n+     * Returns the (uncompressed) size of a resource given its full entry name.\n+     *\n+     * @throws java.util.NoSuchElementException if the resource does not exist.\n+     *\/\n+    long sizeOf(String name);\n+\n+    \/**\n+     * Returns an {@link InputStream} for a resource given its full entry name.\n+     *\n+     * @throws java.util.NoSuchElementException if the resource does not exist.\n+     *\/\n+    InputStream open(String name);\n+}\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/ResourceEntries.java","additions":41,"deletions":0,"binary":false,"changes":41,"status":"added"},{"patch":"@@ -64,0 +64,1 @@\n+\n@@ -177,1 +178,1 @@\n-                    new HashSet<String>(Arrays.asList(\"basic\", \"jrt\")));\n+            new HashSet<String>(Arrays.asList(\"basic\", \"jrt\")));\n@@ -208,2 +209,2 @@\n-                throw new UnsupportedOperationException(\"Syntax '\" + syntax\n-                        + \"' not recognized\");\n+            throw new UnsupportedOperationException(\"Syntax '\" + syntax\n+                    + \"' not recognized\");\n@@ -301,1 +302,1 @@\n-                    \"option class: \" + option.getClass());\n+                        \"option class: \" + option.getClass());\n@@ -305,1 +306,1 @@\n-            options.contains(StandardOpenOption.APPEND)) {\n+                options.contains(StandardOpenOption.APPEND)) {\n@@ -346,2 +347,2 @@\n-            Set<? extends OpenOption> options,\n-            FileAttribute<?>... attrs)\n+                                     Set<? extends OpenOption> options,\n+                                     FileAttribute<?>... attrs)\n@@ -357,2 +358,2 @@\n-            Set<? extends OpenOption> options,\n-            FileAttribute<?>... attrs)\n+                                             Set<? extends OpenOption> options,\n+                                             FileAttribute<?>... attrs)\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jrtfs\/JrtFileSystem.java","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -74,1 +74,1 @@\n-        @SuppressWarnings({ \"removal\", \"suppression\" })\n+        @SuppressWarnings({\"removal\", \"suppression\"})\n@@ -110,1 +110,1 @@\n-            return newFileSystem((String)env.get(\"java.home\"), uri, env);\n+            return newFileSystem((String) env.get(\"java.home\"), uri, env);\n@@ -136,1 +136,1 @@\n-        Map<String,?> newEnv = new HashMap<>(env);\n+        Map<String, ?> newEnv = new HashMap<>(env);\n@@ -141,1 +141,1 @@\n-            @SuppressWarnings({ \"deprecation\", \"suppression\" })\n+            @SuppressWarnings({\"deprecation\", \"suppression\"})\n@@ -143,1 +143,1 @@\n-            return ((FileSystemProvider)tmp).newFileSystem(uri, newEnv);\n+            return ((FileSystemProvider) tmp).newFileSystem(uri, newEnv);\n@@ -157,2 +157,1 @@\n-                throws ClassNotFoundException\n-        {\n+                throws ClassNotFoundException {\n@@ -174,1 +173,1 @@\n-    @SuppressWarnings({ \"removal\", \"suppression\" })\n+    @SuppressWarnings({\"removal\", \"suppression\"})\n@@ -183,1 +182,1 @@\n-        final URL[] urls = new URL[] { url };\n+        final URL[] urls = new URL[]{url};\n@@ -281,1 +280,1 @@\n-            getFileAttributeView(Path path, Class<V> type, LinkOption... options) {\n+    getFileAttributeView(Path path, Class<V> type, LinkOption... options) {\n@@ -308,3 +307,3 @@\n-            Set<? extends OpenOption> options,\n-            ExecutorService exec,\n-            FileAttribute<?>... attrs)\n+                                                              Set<? extends OpenOption> options,\n+                                                              ExecutorService exec,\n+                                                              FileAttribute<?>... attrs)\n@@ -317,2 +316,2 @@\n-            Set<? extends OpenOption> options,\n-            FileAttribute<?>... attrs)\n+                                              Set<? extends OpenOption> options,\n+                                              FileAttribute<?>... attrs)\n@@ -331,2 +330,2 @@\n-            Set<? extends OpenOption> options,\n-            FileAttribute<?>... attrs)\n+                                      Set<? extends OpenOption> options,\n+                                      FileAttribute<?>... attrs)\n@@ -352,1 +351,1 @@\n-            readAttributes(Path path, Class<A> type, LinkOption... options)\n+    readAttributes(Path path, Class<A> type, LinkOption... options)\n@@ -362,1 +361,1 @@\n-            readAttributes(Path path, String attribute, LinkOption... options)\n+    readAttributes(Path path, String attribute, LinkOption... options)\n@@ -369,1 +368,1 @@\n-            Object value, LinkOption... options)\n+                             Object value, LinkOption... options)\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jrtfs\/JrtFileSystemProvider.java","additions":19,"deletions":20,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -51,1 +51,1 @@\n-@SuppressWarnings({ \"removal\", \"suppression\"} )\n+@SuppressWarnings({\"removal\", \"suppression\"})\n@@ -104,6 +104,6 @@\n-            new PrivilegedAction<Boolean>() {\n-                @Override\n-                public Boolean run() {\n-                    return Files.isRegularFile(moduleImageFile);\n-                }\n-            });\n+                new PrivilegedAction<Boolean>() {\n+                    @Override\n+                    public Boolean run() {\n+                        return Files.isRegularFile(moduleImageFile);\n+                    }\n+                });\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jrtfs\/SystemImage.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -89,1 +89,1 @@\n-    private SystemModuleFinders() { }\n+    private SystemModuleFinders() {}\n@@ -151,1 +151,1 @@\n-            = (Map.Entry<String, ModuleReference>[])new Map.Entry[moduleCount];\n+                = (Map.Entry<String, ModuleReference>[]) new Map.Entry[moduleCount];\n@@ -159,4 +159,4 @@\n-                                                     targets[i],\n-                                                     recordedHashes[i],\n-                                                     hashSupplier,\n-                                                     moduleResolutions[i]);\n+                    targets[i],\n+                    recordedHashes[i],\n+                    hashSupplier,\n+                    moduleResolutions[i]);\n@@ -239,4 +239,4 @@\n-                                                     attrs.target(),\n-                                                     attrs.recordedHashes(),\n-                                                     hashSupplier,\n-                                                     attrs.moduleResolution());\n+                    attrs.target(),\n+                    attrs.recordedHashes(),\n+                    hashSupplier,\n+                    attrs.moduleResolution());\n@@ -334,7 +334,7 @@\n-                                                       uri,\n-                                                       readerSupplier,\n-                                                       null,\n-                                                       target,\n-                                                       recordedHashes,\n-                                                       hasher,\n-                                                       mres);\n+                uri,\n+                readerSupplier,\n+                null,\n+                target,\n+                recordedHashes,\n+                hasher,\n+                mres);\n@@ -518,1 +518,1 @@\n-            for (;;) {\n+            for (; ; ) {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/module\/SystemModuleFinders.java","additions":18,"deletions":18,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -124,1 +124,1 @@\n-        return len > Integer.MAX_VALUE ? -1 : (int)len;\n+        return len > Integer.MAX_VALUE ? -1 : (int) len;\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/protocol\/jrt\/JavaRuntimeURLConnection.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -322,6 +322,1 @@\n-        \/\/ Temporarily, we allow either version (1.1 or 1.0) of the file to\n-        \/\/ be read so this code can be committed before image writing changes\n-        \/\/ for preview mode. Preview mode changes do not modify any structure,\n-        \/\/ so a 1.0 file will look like a jimage without any preview resources.\n-        \/\/ TODO: Restore equality check for MINOR_VERSION.\n-        _header.minor_version(_endian) > MINOR_VERSION) {\n+        _header.minor_version(_endian) != MINOR_VERSION) {\n","filename":"src\/java.base\/share\/native\/libjimage\/imageFile.cpp","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import java.io.Closeable;\n@@ -37,1 +38,1 @@\n-public interface Archive {\n+public interface Archive extends Closeable {\n@@ -62,5 +63,6 @@\n-         * Constructs an entry of the given archive\n-         * @param archive archive\n-         * @param path\n-         * @param name an entry name that does not contain the module name\n-         * @param type\n+         * Constructs an entry of the given archive.\n+         *\n+         * @param archive the archive in which this entry exists.\n+         * @param path the complete path of the entry, including the module.\n+         * @param name an entry name relative to its containing module.\n+         * @param type the entry type.\n@@ -75,4 +77,0 @@\n-        public final Archive archive() {\n-            return archive;\n-        }\n-\n@@ -90,0 +88,5 @@\n+        \/**\n+         * Returns the path of this entry.\n+         *\/\n+        public final String path() {return path;}\n+\n@@ -137,0 +140,1 @@\n+    @Override\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/Archive.java","additions":14,"deletions":10,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,1 @@\n+\n@@ -39,2 +40,2 @@\n-    private ByteOrder byteOrder;\n-    private ImageStringsWriter strings;\n+    private final ByteOrder byteOrder;\n+    private final ImageStringsWriter strings;\n@@ -44,10 +45,6 @@\n-    private List<ImageLocationWriter> input;\n-    private ImageStream headerStream;\n-    private ImageStream redirectStream;\n-    private ImageStream locationOffsetStream;\n-    private ImageStream locationStream;\n-    private ImageStream allIndexStream;\n-\n-    public BasicImageWriter() {\n-        this(ByteOrder.nativeOrder());\n-    }\n+    private final List<ImageLocationWriter> input;\n+    private final ImageStream headerStream;\n+    private final ImageStream redirectStream;\n+    private final ImageStream locationOffsetStream;\n+    private final ImageStream locationStream;\n+    private final ImageStream allIndexStream;\n@@ -78,2 +75,6 @@\n-    public void addLocation(String fullname, long contentOffset,\n-            long compressedSize, long uncompressedSize) {\n+    public void addLocation(\n+            String fullname,\n+            long contentOffset,\n+            long compressedSize,\n+            long uncompressedSize,\n+            int previewFlags) {\n@@ -82,1 +83,1 @@\n-                        contentOffset, compressedSize, uncompressedSize);\n+                        contentOffset, compressedSize, uncompressedSize, previewFlags);\n@@ -91,4 +92,0 @@\n-    int getLocationsCount() {\n-        return input.size();\n-    }\n-\n@@ -97,1 +94,1 @@\n-            new PerfectHashBuilder<>(\n+                new PerfectHashBuilder<>(\n@@ -177,12 +174,0 @@\n-\n-    ImageLocationWriter find(String key) {\n-        int index = redirect[ImageStringsReader.hashCode(key) % length];\n-\n-        if (index < 0) {\n-            index = -index - 1;\n-        } else {\n-            index = ImageStringsReader.hashCode(key, index) % length;\n-        }\n-\n-        return locations[index];\n-    }\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/BasicImageWriter.java","additions":18,"deletions":33,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,0 +52,1 @@\n+import jdk.internal.jimage.ImageLocation;\n@@ -86,1 +87,1 @@\n-    private static final byte[] EMPTY_RESOURCE_BYTES = new byte[] {};\n+    private static final byte[] EMPTY_RESOURCE_BYTES = new byte[]{};\n@@ -116,5 +117,4 @@\n-            ByteOrder byteOrder,\n-            ImagePluginStack plugins,\n-            boolean generateRuntimeImage)\n-            throws IOException\n-    {\n+                                         ByteOrder byteOrder,\n+                                         ImagePluginStack plugins,\n+                                         boolean generateRuntimeImage)\n+            throws IOException {\n@@ -122,1 +122,1 @@\n-                                                      generateRuntimeImage);\n+                generateRuntimeImage);\n@@ -158,3 +158,3 @@\n-            Set<Archive> archives,\n-            ImagePluginStack pluginSupport,\n-            boolean generateRuntimeImage)\n+                                      Set<Archive> archives,\n+                                      ImagePluginStack pluginSupport,\n+                                      boolean generateRuntimeImage)\n@@ -165,6 +165,6 @@\n-                                    Archive::moduleName,\n-                                    a -> {\n-                                        try (Stream<Entry> entries = a.entries()) {\n-                                            return entries.toList();\n-                                        }\n-                                    }));\n+                    Archive::moduleName,\n+                    a -> {\n+                        try (Stream<Entry> entries = a.entries()) {\n+                            return entries.toList();\n+                        }\n+                    }));\n@@ -175,2 +175,2 @@\n-                    BufferedOutputStream bos = new BufferedOutputStream(fos);\n-                    DataOutputStream out = new DataOutputStream(bos)) {\n+                 BufferedOutputStream bos = new BufferedOutputStream(fos);\n+                 DataOutputStream out = new DataOutputStream(bos)) {\n@@ -188,1 +188,1 @@\n-            ByteOrder byteOrder)\n+                            ByteOrder byteOrder)\n@@ -225,4 +225,4 @@\n-            BasicImageWriter writer,\n-            ImagePluginStack pluginSupport,\n-            DataOutputStream out,\n-            boolean generateRuntimeImage\n+                                               BasicImageWriter writer,\n+                                               ImagePluginStack pluginSupport,\n+                                               DataOutputStream out,\n+                                               boolean generateRuntimeImage\n@@ -230,25 +230,2 @@\n-        ResourcePool resultResources;\n-        try {\n-            resultResources = pluginSupport.visitResources(allContent);\n-            if (generateRuntimeImage) {\n-                \/\/ Keep track of non-modules resources for linking from a run-time image\n-                resultResources = addNonClassResourcesTrackFiles(resultResources,\n-                                                                 writer);\n-                \/\/ Generate the diff between the input resources from packaged\n-                \/\/ modules in 'allContent' to the plugin- or otherwise\n-                \/\/ generated-content in 'resultResources'\n-                resultResources = addResourceDiffFiles(allContent.resourcePool(),\n-                                                       resultResources,\n-                                                       writer);\n-            }\n-        } catch (PluginException pe) {\n-            if (JlinkTask.DEBUG) {\n-                pe.printStackTrace();\n-            }\n-            throw pe;\n-        } catch (Exception ex) {\n-            if (JlinkTask.DEBUG) {\n-                ex.printStackTrace();\n-            }\n-            throw new IOException(ex);\n-        }\n+        ResourcePool resultResources =\n+                getResourcePool(allContent, writer, pluginSupport, generateRuntimeImage);\n@@ -285,0 +262,2 @@\n+                int locFlags = ImageLocation.getFlags(\n+                        res.path(), p -> resultResources.findEntry(p).isPresent());\n@@ -286,1 +265,1 @@\n-                writer.addLocation(path, offset[0], compressedSize, uncompressedSize);\n+                writer.addLocation(path, offset[0], compressedSize, uncompressedSize, locFlags);\n@@ -310,0 +289,34 @@\n+    private static ResourcePool getResourcePool(\n+            ResourcePoolManager allContent,\n+            BasicImageWriter writer,\n+            ImagePluginStack pluginSupport,\n+            boolean generateRuntimeImage)\n+            throws IOException {\n+        ResourcePool resultResources;\n+        try {\n+            resultResources = pluginSupport.visitResources(allContent);\n+            if (generateRuntimeImage) {\n+                \/\/ Keep track of non-modules resources for linking from a run-time image\n+                resultResources = addNonClassResourcesTrackFiles(resultResources,\n+                        writer);\n+                \/\/ Generate the diff between the input resources from packaged\n+                \/\/ modules in 'allContent' to the plugin- or otherwise\n+                \/\/ generated-content in 'resultResources'\n+                resultResources = addResourceDiffFiles(allContent.resourcePool(),\n+                        resultResources,\n+                        writer);\n+            }\n+        } catch (PluginException pe) {\n+            if (JlinkTask.DEBUG) {\n+                pe.printStackTrace();\n+            }\n+            throw pe;\n+        } catch (Exception ex) {\n+            if (JlinkTask.DEBUG) {\n+                ex.printStackTrace();\n+            }\n+            throw new IOException(ex);\n+        }\n+        return resultResources;\n+    }\n+\n@@ -338,2 +351,2 @@\n-                                                        .map(a -> a.name())\n-                                                        .collect(Collectors.toSet());\n+                .map(a -> a.name())\n+                .collect(Collectors.toSet());\n@@ -345,2 +358,2 @@\n-                                    .setName(resourceName)\n-                                    .build();\n+                    .setName(resourceName)\n+                    .build();\n@@ -350,1 +363,1 @@\n-                                                                            modules);\n+                modules);\n@@ -364,1 +377,1 @@\n-                                                                      a -> new ArrayList<>());\n+                    a -> new ArrayList<>());\n@@ -396,1 +409,1 @@\n-                                         \" for module \" + module, e);\n+                        \" for module \" + module, e);\n@@ -421,1 +434,1 @@\n-                                                               .findModule(JLINK_MOD_NAME);\n+                .findModule(JLINK_MOD_NAME);\n@@ -449,2 +462,2 @@\n-                                                  .map(rm -> rm.name())\n-                                                  .collect(Collectors.toSet());\n+                .map(rm -> rm.name())\n+                .collect(Collectors.toSet());\n@@ -463,1 +476,1 @@\n-                                               .collect(Collectors.joining(\"\\n\"));\n+                        .collect(Collectors.joining(\"\\n\"));\n@@ -465,1 +478,1 @@\n-                                                 mResContent.getBytes(StandardCharsets.UTF_8)));\n+                        mResContent.getBytes(StandardCharsets.UTF_8)));\n@@ -494,1 +507,1 @@\n-                                                                       a -> new ArrayList<>());\n+                        a -> new ArrayList<>());\n@@ -496,1 +509,1 @@\n-                                                                                  platform);\n+                        platform);\n@@ -511,3 +524,3 @@\n-            Map<String, List<Entry>> entriesForModule,\n-            ByteOrder byteOrder,\n-            BasicImageWriter writer) throws IOException {\n+                                                         Map<String, List<Entry>> entriesForModule,\n+                                                         ByteOrder byteOrder,\n+                                                         BasicImageWriter writer) throws IOException {\n@@ -519,3 +532,3 @@\n-                    entriesForModule.get(mn).stream()\n-                            .map(e -> new ArchiveEntryResourcePoolEntry(mn,\n-                                    e.getResourcePoolEntryName(), e)))\n+                        entriesForModule.get(mn).stream()\n+                                .map(e -> new ArchiveEntryResourcePoolEntry(mn,\n+                                        e.getResourcePoolEntryName(), e)))\n@@ -553,1 +566,1 @@\n-                                                                       writer);\n+                writer);\n@@ -561,58 +574,0 @@\n-\n-    \/**\n-     * Helper method that splits a Resource path onto 3 items: module, parent\n-     * and resource name.\n-     *\n-     * @param path\n-     * @return An array containing module, parent and name.\n-     *\/\n-    public static String[] splitPath(String path) {\n-        Objects.requireNonNull(path);\n-        String noRoot = path.substring(1);\n-        int pkgStart = noRoot.indexOf(\"\/\");\n-        String module = noRoot.substring(0, pkgStart);\n-        List<String> result = new ArrayList<>();\n-        result.add(module);\n-        String pkg = noRoot.substring(pkgStart + 1);\n-        String resName;\n-        int pkgEnd = pkg.lastIndexOf(\"\/\");\n-        if (pkgEnd == -1) { \/\/ No package.\n-            resName = pkg;\n-        } else {\n-            resName = pkg.substring(pkgEnd + 1);\n-        }\n-\n-        pkg = toPackage(pkg, false);\n-        result.add(pkg);\n-        result.add(resName);\n-\n-        String[] array = new String[result.size()];\n-        return result.toArray(array);\n-    }\n-\n-    \/**\n-     * Returns the path of the resource.\n-     *\/\n-    public static String resourceName(String path) {\n-        Objects.requireNonNull(path);\n-        String s = path.substring(1);\n-        int index = s.indexOf(\"\/\");\n-        return s.substring(index + 1);\n-    }\n-\n-    public static String toPackage(String name) {\n-        return toPackage(name, false);\n-    }\n-\n-    private static String toPackage(String name, boolean log) {\n-        int index = name.lastIndexOf('\/');\n-        if (index > 0) {\n-            return name.substring(0, index).replace('\/', '.');\n-        } else {\n-            \/\/ ## unnamed package\n-            if (log) {\n-                System.err.format(\"Warning: %s in unnamed package%n\", name);\n-            }\n-            return \"\";\n-        }\n-    }\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ImageFileCreator.java","additions":84,"deletions":129,"binary":false,"changes":213,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -47,1 +47,1 @@\n-               kind < ATTRIBUTE_COUNT : \"Invalid attribute kind\";\n+                kind < ATTRIBUTE_COUNT : \"Invalid attribute kind\";\n@@ -56,1 +56,2 @@\n-    static ImageLocationWriter newLocation(String fullName,\n+    static ImageLocationWriter newLocation(\n+            String fullName,\n@@ -58,1 +59,4 @@\n-            long contentOffset, long compressedSize, long uncompressedSize) {\n+            long contentOffset,\n+            long compressedSize,\n+            long uncompressedSize,\n+            int previewFlags) {\n@@ -67,1 +71,1 @@\n-        } else if ( fullName.startsWith(\"\/packages\/\")) {\n+        } else if (fullName.startsWith(\"\/packages\/\")) {\n@@ -93,7 +97,8 @@\n-               .addAttribute(ATTRIBUTE_MODULE, moduleName)\n-               .addAttribute(ATTRIBUTE_PARENT, parentName)\n-               .addAttribute(ATTRIBUTE_BASE, baseName)\n-               .addAttribute(ATTRIBUTE_EXTENSION, extensionName)\n-               .addAttribute(ATTRIBUTE_OFFSET, contentOffset)\n-               .addAttribute(ATTRIBUTE_COMPRESSED, compressedSize)\n-               .addAttribute(ATTRIBUTE_UNCOMPRESSED, uncompressedSize);\n+                .addAttribute(ATTRIBUTE_MODULE, moduleName)\n+                .addAttribute(ATTRIBUTE_PARENT, parentName)\n+                .addAttribute(ATTRIBUTE_BASE, baseName)\n+                .addAttribute(ATTRIBUTE_EXTENSION, extensionName)\n+                .addAttribute(ATTRIBUTE_OFFSET, contentOffset)\n+                .addAttribute(ATTRIBUTE_COMPRESSED, compressedSize)\n+                .addAttribute(ATTRIBUTE_UNCOMPRESSED, uncompressedSize)\n+                .addAttribute(ATTRIBUTE_PREVIEW_FLAGS, previewFlags);\n@@ -144,3 +149,3 @@\n-               getParentOffset() == other.getParentOffset() &&\n-               getBaseOffset() == other.getBaseOffset() &&\n-               getExtensionOffset() == other.getExtensionOffset();\n+                getParentOffset() == other.getParentOffset() &&\n+                getBaseOffset() == other.getBaseOffset() &&\n+                getExtensionOffset() == other.getExtensionOffset();\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ImageLocationWriter.java","additions":20,"deletions":15,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import jdk.internal.jimage.ImageLocation;\n@@ -34,0 +35,1 @@\n+import java.util.Comparator;\n@@ -35,0 +37,1 @@\n+import java.util.HashSet;\n@@ -40,1 +43,1 @@\n-import java.util.TreeSet;\n+import java.util.stream.Collectors;\n@@ -44,1 +47,0 @@\n- *\n@@ -49,1 +51,1 @@\n-        return path.startsWith(\"\/packages\") || path.startsWith(\"\/modules\");\n+        return path.startsWith(\"\/packages\/\") || path.startsWith(\"\/modules\/\");\n@@ -55,1 +57,2 @@\n-    private static class Node {\n+    \/\/ Visible for testing only.\n+    static class Node {\n@@ -71,0 +74,8 @@\n+        private void setLocation(ImageLocationWriter loc) {\n+            \/\/ This *can* be called more than once, but only with the same instance.\n+            if (this.loc != null && loc != this.loc) {\n+                throw new IllegalStateException(\"Cannot add different locations: \" + name);\n+            }\n+            this.loc = Objects.requireNonNull(loc);\n+        }\n+\n@@ -100,1 +111,2 @@\n-    private static final class ResourceNode extends Node {\n+    \/\/ Visible for testing only.\n+    static final class ResourceNode extends Node {\n@@ -107,9 +119,22 @@\n-    private static class PackageNode extends Node {\n-        \/**\n-         * A reference to a package. Empty packages can be located inside one or\n-         * more modules. A package with classes exist in only one module.\n-         *\/\n-        static final class PackageReference {\n-\n-            private final String name;\n-            private final boolean isEmpty;\n+    \/**\n+     * A 2nd level package directory, {@code \"\/packages\/<package-name>\"}.\n+     *\n+     * <p>While package paths can exist within many modules, for each package\n+     * there is at most one module in which that package has resources.\n+     *\n+     * <p>For example, the package path {@code java\/util} exists in both the\n+     * {@code java.base} and {@code java.logging} modules. This means both\n+     * {@code \"\/packages\/java.util\/java.base\"} and\n+     * {@code \"\/packages\/java.util\/java.logging\"} will exist, but only\n+     * {@code \"java.base\"} entry will be marked as having content.\n+     *\n+     * <p>When processing module references in non-preview mode, entries marked\n+     * as {@link ModuleReference#isPreviewOnly() preview-only} must be ignored.\n+     *\n+     * <p>If all entries in a package are preview-only, then the package's flags\n+     * have {@link ImageLocation#FLAGS_IS_PREVIEW_ONLY FLAGS_IS_PREVIEW_ONLY}\n+     * set, and the entire package must be ignored.\n+     *\/\n+    \/\/ Visible for testing only.\n+    static final class PackageNode extends Node {\n+        private final List<ModuleReference> moduleReferences;\n@@ -117,3 +142,4 @@\n-            PackageReference(String name, boolean isEmpty) {\n-                this.name = Objects.requireNonNull(name);\n-                this.isEmpty = isEmpty;\n+        PackageNode(String name, List<ModuleReference> moduleReferences, Node parent) {\n+            super(name, parent);\n+            if (moduleReferences.isEmpty()) {\n+                throw new IllegalStateException(\"Package must be associated with modules: \" + name);\n@@ -121,4 +147,2 @@\n-\n-            @Override\n-            public String toString() {\n-                return name + \"[empty:\" + isEmpty + \"]\";\n+            if (moduleReferences.stream().filter(ModuleReference::hasResources).count() > 1) {\n+                throw new IllegalStateException(\"Multiple modules contain non-empty package: \" + name);\n@@ -126,0 +150,1 @@\n+            this.moduleReferences = Collections.unmodifiableList(moduleReferences);\n@@ -128,11 +153,2 @@\n-        private final Map<String, PackageReference> references = new TreeMap<>();\n-\n-        PackageNode(String name, Node parent) {\n-            super(name, parent);\n-        }\n-\n-        private void addReference(String name, boolean isEmpty) {\n-            PackageReference ref = references.get(name);\n-            if (ref == null || ref.isEmpty) {\n-                references.put(name, new PackageReference(name, isEmpty));\n-            }\n+        List<ModuleReference> getModuleReferences() {\n+            return moduleReferences;\n@@ -140,0 +156,1 @@\n+    }\n@@ -141,12 +158,5 @@\n-        private void validate() {\n-            boolean exists = false;\n-            for (PackageReference ref : references.values()) {\n-                if (!ref.isEmpty) {\n-                    if (exists) {\n-                        throw new RuntimeException(\"Multiple modules to contain package \"\n-                                + getName());\n-                    } else {\n-                        exists = true;\n-                    }\n-                }\n-            }\n+    \/\/ Not serialized, and never stored in any field of any class that is.\n+    @SuppressWarnings(\"serial\")\n+    private static final class InvalidTreeException extends Exception {\n+        public InvalidTreeException(Node badNode) {\n+            super(\"Resources tree, invalid data structure, skipping: \" + badNode.getPath());\n@@ -154,0 +164,3 @@\n+        \/\/ Exception only used for program flow, not debugging.\n+        @Override\n+        public Throwable fillInStackTrace() {return this;}\n@@ -159,1 +172,3 @@\n-    private static final class Tree {\n+    \/\/ Visible for testing only.\n+    static final class Tree {\n+        private static final String PREVIEW_PREFIX = \"META-INF\/preview\/\";\n@@ -164,2 +179,1 @@\n-        private Node modules;\n-        private Node packages;\n+        private Node packagesRoot;\n@@ -167,2 +181,4 @@\n-        private Tree(List<String> paths) {\n-            this.paths = paths;\n+        \/\/ Visible for testing only.\n+        Tree(List<String> paths) {\n+            this.paths = paths.stream().sorted(Comparator.reverseOrder()).toList();\n+            \/\/ Root node is not added to the directAccess map.\n@@ -174,21 +190,15 @@\n-            modules = new Node(\"modules\", root);\n-            directAccess.put(modules.getPath(), modules);\n-\n-            Map<String, Set<String>> moduleToPackage = new TreeMap<>();\n-            Map<String, Set<String>> packageToModule = new TreeMap<>();\n-\n-            for (String p : paths) {\n-                if (!p.startsWith(\"\/\")) {\n-                    continue;\n-                }\n-                String[] split = p.split(\"\/\");\n-                \/\/ minimum length is 3 items: \/<mod>\/<pkg>\n-                if (split.length < 3) {\n-                    System.err.println(\"Resources tree, invalid data structure, \"\n-                            + \"skipping \" + p);\n-                    continue;\n-                }\n-                Node current = modules;\n-                String module = null;\n-                for (int i = 0; i < split.length; i++) {\n-                    \/\/ When a non terminal node is marked as being a resource, something is wrong.\n+            Node modulesRoot = new Node(\"modules\", root);\n+            directAccess.put(modulesRoot.getPath(), modulesRoot);\n+            packagesRoot = new Node(\"packages\", root);\n+            directAccess.put(packagesRoot.getPath(), packagesRoot);\n+\n+            \/\/ Map of dot-separated package names to module references (those\n+            \/\/ in which the package appear). References are merged after to\n+            \/\/ ensure each module name appears only once, but temporarily a\n+            \/\/ module may have several entries per package (e.g. with-content,\n+            \/\/ without-content, normal, preview-only etc..).\n+            Map<String, Set<ModuleReference>> packageToModules = new TreeMap<>();\n+            for (String fullPath : paths) {\n+                try {\n+                    processPath(fullPath, modulesRoot, packageToModules);\n+                } catch (InvalidTreeException err) {\n@@ -196,54 +206,2 @@\n-                    \/\/ invalid directory entry marled as not directory (see 8131762)\n-                    if (current instanceof ResourceNode) {\n-                        System.err.println(\"Resources tree, invalid data structure, \"\n-                                + \"skipping \" + p);\n-                        continue;\n-                    }\n-                    String s = split[i];\n-                    if (!s.isEmpty()) {\n-                        \/\/ First item, this is the module, simply add a new node to the\n-                        \/\/ tree.\n-                        if (module == null) {\n-                            module = s;\n-                        }\n-                        Node n = current.children.get(s);\n-                        if (n == null) {\n-                            if (i == split.length - 1) { \/\/ Leaf\n-                                n = new ResourceNode(s, current);\n-                                String pkg = toPackageName(n.parent);\n-                                \/\/System.err.println(\"Adding a resource node. pkg \" + pkg + \", name \" + s);\n-                                if (pkg != null && !pkg.startsWith(\"META-INF\")) {\n-                                    Set<String> pkgs = moduleToPackage.get(module);\n-                                    if (pkgs == null) {\n-                                        pkgs = new TreeSet<>();\n-                                        moduleToPackage.put(module, pkgs);\n-                                    }\n-                                    pkgs.add(pkg);\n-                                }\n-                            } else { \/\/ put only sub trees, no leaf\n-                                n = new Node(s, current);\n-                                directAccess.put(n.getPath(), n);\n-                                String pkg = toPackageName(n);\n-                                if (pkg != null && !pkg.startsWith(\"META-INF\")) {\n-                                    Set<String> mods = packageToModule.get(pkg);\n-                                    if (mods == null) {\n-                                        mods = new TreeSet<>();\n-                                        packageToModule.put(pkg, mods);\n-                                    }\n-                                    mods.add(module);\n-                                }\n-                            }\n-                        }\n-                        current = n;\n-                    }\n-                }\n-            }\n-            packages = new Node(\"packages\", root);\n-            directAccess.put(packages.getPath(), packages);\n-            \/\/ The subset of package nodes that have some content.\n-            \/\/ These packages exist only in a single module.\n-            for (Map.Entry<String, Set<String>> entry : moduleToPackage.entrySet()) {\n-                for (String pkg : entry.getValue()) {\n-                    PackageNode pkgNode = new PackageNode(pkg, packages);\n-                    pkgNode.addReference(entry.getKey(), false);\n-                    directAccess.put(pkgNode.getPath(), pkgNode);\n+                    \/\/ invalid directory entry marked as not directory (see 8131762).\n+                    System.err.println(err.getMessage());\n@@ -253,10 +211,13 @@\n-            \/\/ All packages\n-            for (Map.Entry<String, Set<String>> entry : packageToModule.entrySet()) {\n-                \/\/ Do we already have a package node?\n-                PackageNode pkgNode = (PackageNode) packages.getChildren(entry.getKey());\n-                if (pkgNode == null) {\n-                    pkgNode = new PackageNode(entry.getKey(), packages);\n-                }\n-                for (String module : entry.getValue()) {\n-                    pkgNode.addReference(module, true);\n-                }\n+            \/\/ We've collected information for all \"packages\", including the root\n+            \/\/ (empty) package and anything under \"META-INF\". However, these should\n+            \/\/ not have entries in the \"\/packages\" directory.\n+            packageToModules.keySet().removeIf(p -> p.isEmpty() || p.equals(\"META-INF\") || p.startsWith(\"META-INF.\"));\n+            packageToModules.forEach((pkgName, modRefs) -> {\n+                \/\/ Merge multiple refs for the same module.\n+                List<ModuleReference> pkgModules = modRefs.stream()\n+                        .collect(Collectors.groupingBy(ModuleReference::name))\n+                        .values().stream()\n+                        .map(refs -> refs.stream().reduce(ModuleReference::merge).orElseThrow())\n+                        .sorted()\n+                        .toList();\n+                PackageNode pkgNode = new PackageNode(pkgName, pkgModules, packagesRoot);\n@@ -264,0 +225,16 @@\n+            });\n+        }\n+\n+        private void processPath(\n+                String fullPath,\n+                Node modulesRoot,\n+                Map<String, Set<ModuleReference>> packageToModules)\n+                throws InvalidTreeException {\n+            \/\/ Paths are untrusted, so be careful about checking expected format.\n+            if (!fullPath.startsWith(\"\/\") || fullPath.endsWith(\"\/\") || fullPath.contains(\"\/\/\")) {\n+                return;\n+            }\n+            int modEnd = fullPath.indexOf('\/', 1);\n+            \/\/ Ensure non-empty module name with non-empty suffix.\n+            if (modEnd <= 1) {\n+                return;\n@@ -265,3 +242,11 @@\n-            \/\/ Validate that the packages are well formed.\n-            for (Node n : packages.children.values()) {\n-                ((PackageNode)n).validate();\n+            String modName = fullPath.substring(1, modEnd);\n+            String pkgPath = fullPath.substring(modEnd + 1);\n+\n+            Node parentNode = getDirectoryNode(modName, modulesRoot);\n+            boolean isPreviewPath = false;\n+            if (pkgPath.startsWith(PREVIEW_PREFIX)) {\n+                \/\/ For preview paths, process nodes relative to the preview directory.\n+                pkgPath = pkgPath.substring(PREVIEW_PREFIX.length());\n+                Node metaInf = getDirectoryNode(\"META-INF\", parentNode);\n+                parentNode = getDirectoryNode(\"preview\", metaInf);\n+                isPreviewPath = true;\n@@ -270,0 +255,26 @@\n+            int pathEnd = pkgPath.lastIndexOf('\/');\n+            \/\/ From invariants tested above, this must now be well-formed.\n+            String fullPkgName = (pathEnd == -1) ? \"\" : pkgPath.substring(0, pathEnd).replace('\/', '.');\n+            String resourceName = pkgPath.substring(pathEnd + 1);\n+            \/\/ Intermediate packages are marked \"empty\" (no resources). This might\n+            \/\/ later be merged with a non-empty reference for the same package.\n+            ModuleReference emptyRef = ModuleReference.forEmptyPackageIn(modName, isPreviewPath);\n+\n+            \/\/ Work down through empty packages to final resource.\n+            for (int i = pkgEndIndex(fullPkgName, 0); i != -1; i = pkgEndIndex(fullPkgName, i)) {\n+                \/\/ Due to invariants already checked, pkgName is non-empty.\n+                String pkgName = fullPkgName.substring(0, i);\n+                packageToModules.computeIfAbsent(pkgName, p -> new HashSet<>()).add(emptyRef);\n+                String childNodeName = pkgName.substring(pkgName.lastIndexOf('.') + 1);\n+                parentNode = getDirectoryNode(childNodeName, parentNode);\n+            }\n+            \/\/ Reached non-empty (leaf) package (could still be a duplicate).\n+            Node resourceNode = parentNode.getChildren(resourceName);\n+            if (resourceNode == null) {\n+                ModuleReference resourceRef = ModuleReference.forPackageIn(modName, isPreviewPath);\n+                packageToModules.computeIfAbsent(fullPkgName, p -> new HashSet<>()).add(resourceRef);\n+                \/\/ Init adds new node to parent (don't add resources to directAccess).\n+                new ResourceNode(resourceName, parentNode);\n+            } else if (!(resourceNode instanceof ResourceNode)) {\n+                throw new InvalidTreeException(resourceNode);\n+            }\n@@ -272,3 +283,8 @@\n-        public String toResourceName(Node node) {\n-            if (!node.children.isEmpty()) {\n-                throw new RuntimeException(\"Node is not a resource\");\n+        private Node getDirectoryNode(String name, Node parent) throws InvalidTreeException {\n+            Node child = parent.getChildren(name);\n+            if (child == null) {\n+                \/\/ Adds child to parent during init.\n+                child = new Node(name, parent);\n+                directAccess.put(child.getPath(), child);\n+            } else if (child instanceof ResourceNode) {\n+                throw new InvalidTreeException(child);\n@@ -276,1 +292,1 @@\n-            return removeRadical(node);\n+            return child;\n@@ -279,13 +295,5 @@\n-        public String getModule(Node node) {\n-            if (node.parent == null || node.getName().equals(\"modules\")\n-                    || node.getName().startsWith(\"packages\")) {\n-                return null;\n-            }\n-            String path = removeRadical(node);\n-            \/\/ \"\/xxx\/...\";\n-            path = path.substring(1);\n-            int i = path.indexOf(\"\/\");\n-            if (i == -1) {\n-                return path;\n-            } else {\n-                return path.substring(0, i);\n+        \/\/ Helper to iterate package names up to, and including, the complete name.\n+        private int pkgEndIndex(String s, int i) {\n+            if (i >= 0 && i < s.length()) {\n+                i = s.indexOf('.', i + 1);\n+                return i != -1 ? i : s.length();\n@@ -293,0 +301,1 @@\n+            return -1;\n@@ -295,8 +304,3 @@\n-        public String toPackageName(Node node) {\n-            if (node.parent == null) {\n-                return null;\n-            }\n-            String path = removeRadical(node.getPath(), \"\/modules\/\");\n-            String module = getModule(node);\n-            if (path.equals(module)) {\n-                return null;\n+        private String toResourceName(Node node) {\n+            if (!node.children.isEmpty()) {\n+                throw new RuntimeException(\"Node is not a resource\");\n@@ -304,2 +308,1 @@\n-            String pkg = removeRadical(path, module + \"\/\");\n-            return pkg.replace('\/', '.');\n+            return removeRadical(node);\n@@ -308,1 +311,1 @@\n-        public String removeRadical(Node node) {\n+        private String removeRadical(Node node) {\n@@ -344,3 +347,4 @@\n-                PackageNode pkgNode = (PackageNode) current;\n-                int size = pkgNode.references.size() * 8;\n-                writer.addLocation(current.getPath(), offset, 0, size);\n+                List<ModuleReference> refs = ((PackageNode) current).getModuleReferences();\n+                \/\/ \"\/packages\/<pkg name>\" entries have 8-byte entries (flags+offset).\n+                int size = refs.size() * 8;\n+                writer.addLocation(current.getPath(), offset, 0, size, ImageLocation.getPackageFlags(refs));\n@@ -356,0 +360,2 @@\n+                    int locFlags = ImageLocation.getFlags(current.getPath(), tree.directAccess::containsKey);\n+                    \/\/ Normal directory entries have 4-byte entries (offset only).\n@@ -357,1 +363,1 @@\n-                    writer.addLocation(current.getPath(), offset, 0, size);\n+                    writer.addLocation(current.getPath(), offset, 0, size, locFlags);\n@@ -374,1 +380,1 @@\n-                    item.loc = entry.getValue();\n+                    item.setLocation(entry.getValue());\n@@ -383,12 +389,7 @@\n-                \/\/ \/packages\/<pkg name>\n-                PackageNode pkgNode = (PackageNode) current;\n-                int size = pkgNode.references.size() * 8;\n-                ByteBuffer buff = ByteBuffer.allocate(size);\n-                buff.order(writer.getByteOrder());\n-                for (PackageNode.PackageReference mod : pkgNode.references.values()) {\n-                    buff.putInt(mod.isEmpty ? 0 : ModuleReference.FLAGS_PKG_HAS_RESOURCES);\n-                    buff.putInt(writer.addString(mod.name));\n-                }\n-                byte[] arr = buff.array();\n-                content.add(arr);\n-                current.loc = outLocations.get(current.getPath());\n+                \/\/ \"\/packages\/<pkg name>\" entries have 8-byte entries (flags+offset).\n+                List<ModuleReference> refs = ((PackageNode) current).getModuleReferences();\n+                ByteBuffer byteBuffer = ByteBuffer.allocate(8 * refs.size());\n+                byteBuffer.order(writer.getByteOrder());\n+                ModuleReference.write(refs, byteBuffer.asIntBuffer(), writer::addString);\n+                content.add(byteBuffer.array());\n+                current.setLocation(outLocations.get(current.getPath()));\n@@ -415,1 +416,1 @@\n-                        current.loc = outLocations.get(s);\n+                        current.setLocation(outLocations.get(s));\n@@ -418,1 +419,1 @@\n-                        current.loc = outLocations.get(current.getPath());\n+                        current.setLocation(outLocations.get(current.getPath()));\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ImageResourcesTree.java","additions":185,"deletions":184,"binary":false,"changes":369,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ImageStringsWriter.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -54,0 +54,2 @@\n+import jdk.internal.jimage.ResourceEntries;\n+import jdk.internal.jimage.SystemImageReader;\n@@ -66,1 +68,0 @@\n-\n@@ -69,1 +70,1 @@\n-    private final ModuleReference ref;\n+    private final ResourceEntries imageResources;\n@@ -102,6 +103,5 @@\n-        this.ref = ModuleFinder.ofSystem()\n-                               .find(module)\n-                               .orElseThrow(() ->\n-                                    new IllegalArgumentException(\n-                                            \"Module \" + module +\n-                                            \" not part of the JDK install\"));\n+        ModuleFinder.ofSystem()\n+                .find(module)\n+                .orElseThrow(() -> new IllegalArgumentException(\n+                        \"Module \" + module + \" not part of the JDK install\"));\n+        this.imageResources = SystemImageReader.get().getResourceEntries();\n@@ -162,0 +162,11 @@\n+    private boolean isNormalOrModifiedDiff(String name) {\n+        ResourceDiff rd = resDiff.get(name);\n+        \/\/ Filter all resources with a resource diff of kind MODIFIED.\n+        \/\/ Note that REMOVED won't happen since in that case the module listing\n+        \/\/ won't have the resource anyway.\n+        \/\/ Note as well that filter removes files of kind ADDED. Those files are\n+        \/\/ not in the packaged modules, so ought not to get returned from the\n+        \/\/ pipeline.\n+        return (rd == null || rd.getKind() == ResourceDiff.Kind.MODIFIED);\n+    }\n+\n@@ -165,0 +176,1 @@\n+\n@@ -167,25 +179,6 @@\n-            files.addAll(ref.open().list()\n-                                   .filter(i -> {\n-                                           String lookupKey = String.format(\"\/%s\/%s\", module, i);\n-                                           ResourceDiff rd = resDiff.get(lookupKey);\n-                                           \/\/ Filter all resources with a resource diff\n-                                           \/\/ that are of kind MODIFIED.\n-                                           \/\/ Note that REMOVED won't happen since in\n-                                           \/\/ that case the module listing won't have\n-                                           \/\/ the resource anyway.\n-                                           \/\/ Note as well that filter removes files\n-                                           \/\/ of kind ADDED. Those files are not in\n-                                           \/\/ the packaged modules, so ought not to\n-                                           \/\/ get returned from the pipeline.\n-                                           return (rd == null ||\n-                                                   rd.getKind() == ResourceDiff.Kind.MODIFIED);\n-                                   })\n-                                   .map(s -> {\n-                                           String lookupKey = String.format(\"\/%s\/%s\", module, s);\n-                                           return new JRTArchiveFile(JRTArchive.this, s,\n-                                                           EntryType.CLASS_OR_RESOURCE,\n-                                                           null \/* hashOrTarget *\/,\n-                                                           false \/* symlink *\/,\n-                                                           resDiff.get(lookupKey));\n-                                   })\n-                                   .toList());\n+            imageResources.entryNamesIn(module)\n+                    .filter(this::isNormalOrModifiedDiff)\n+                    .sorted()\n+                    .map(name -> new JrtModuleFile(this, name, resDiff.get(name)))\n+                    .forEach(files::add);\n+\n@@ -195,13 +188,3 @@\n-                                         .filter(rd -> rd.getKind() == ResourceDiff.Kind.REMOVED)\n-                                         .map(s -> {\n-                                                 int secondSlash = s.getName().indexOf(\"\/\", 1);\n-                                                 assert secondSlash != -1;\n-                                                 String pathWithoutModule = s.getName().substring(secondSlash + 1);\n-                                                 return new JRTArchiveFile(JRTArchive.this,\n-                                                         pathWithoutModule,\n-                                                         EntryType.CLASS_OR_RESOURCE,\n-                                                         null  \/* hashOrTarget *\/,\n-                                                         false \/* symlink *\/,\n-                                                         s);\n-                                         })\n-                                         .toList());\n+                    .filter(rd -> rd.getKind() == ResourceDiff.Kind.REMOVED)\n+                    .map(rd -> new JrtModuleFile(this, rd.getName(), rd))\n+                    .toList());\n@@ -237,9 +220,4 @@\n-                        return new JRTArchiveFile(JRTArchive.this,\n-                                                  m.resPath,\n-                                                  toEntryType(m.resType),\n-                                                  m.hashOrTarget,\n-                                                  m.symlink,\n-                                                  \/* diff only for resources *\/\n-                                                  null);\n-                 })\n-                 .toList());\n+                        return new JrtOtherFile(\n+                                this, m.resPath, toEntryType(m.resType), m.hashOrTarget, m.symlink);\n+                    })\n+                    .toList());\n@@ -327,1 +305,1 @@\n-         *  line: <int>|<int>|<hashOrTarget>|<path>\n+         *  line: {@code <int>|<int>|<hashOrTarget>|<path>}\n@@ -329,1 +307,1 @@\n-         *  Take the integer before '|' convert it to a Type. The second\n+         *  <p>Take the integer before {@code '|'} convert it to a Type. The second\n@@ -440,6 +418,55 @@\n-    record JRTArchiveFile(Archive archive,\n-                          String resPath,\n-                          EntryType resType,\n-                          String sha,\n-                          boolean symlink,\n-                          ResourceDiff diff) implements JRTFile {\n+    record JrtModuleFile(\n+            JRTArchive archive,\n+            String resPath,\n+            ResourceDiff diff) implements JRTFile {\n+        @Override\n+        public Entry toEntry() {\n+            assert resPath.startsWith(\"\/\" + archive.moduleName() + \"\/\");\n+            String resName = resPath.substring(archive.moduleName().length() + 2);\n+\n+            \/\/ If the resource has a diff to the packaged modules, use the diff.\n+            \/\/ Diffs of kind ADDED have been filtered out in collectFiles();\n+            if (diff != null) {\n+                assert diff.getKind() != ResourceDiff.Kind.ADDED;\n+                assert diff.getName().equals(resPath);\n+\n+                return new Entry(archive, resPath, resName, EntryType.CLASS_OR_RESOURCE) {\n+                    @Override\n+                    public long size() {\n+                        return diff.getResourceBytes().length;\n+                    }\n+                    @Override\n+                    public InputStream stream() {\n+                        return new ByteArrayInputStream(diff.getResourceBytes());\n+                    }\n+                };\n+            } else {\n+                return new Entry(archive, resPath, resName, EntryType.CLASS_OR_RESOURCE) {\n+                    @Override\n+                    public long size() {\n+                        return archive.imageResources.sizeOf(path());\n+                    }\n+\n+                    @Override\n+                    public InputStream stream() {\n+                        return archive.imageResources.open(path());\n+                    }\n+                };\n+            }\n+        }\n+    }\n+\n+    record JrtOtherFile(\n+            JRTArchive archive,\n+            String resPath,\n+            EntryType resType,\n+            String sha,\n+            boolean symlink) implements JRTFile {\n+\n+        \/\/ Read from the base JDK image, special casing\n+        \/\/ symlinks, which have the link target in the\n+        \/\/ hashOrTarget field.\n+        Path targetPath() {\n+            return BASE.resolve(symlink ? sha : resPath);\n+        }\n+\n@@ -447,6 +474,8 @@\n-            return new Entry(archive,\n-                             String.format(\"\/%s\/%s\",\n-                                           archive.moduleName(),\n-                                           resPath),\n-                             resPath,\n-                             resType) {\n+            assert resType != EntryType.CLASS_OR_RESOURCE;\n+\n+            return new Entry(\n+                    archive,\n+                    String.format(\"\/%s\/%s\", archive.moduleName(), resPath),\n+                    resPath,\n+                    resType) {\n+\n@@ -456,25 +485,1 @@\n-                        if (resType != EntryType.CLASS_OR_RESOURCE) {\n-                            \/\/ Read from the base JDK image, special casing\n-                            \/\/ symlinks, which have the link target in the\n-                            \/\/ hashOrTarget field\n-                            if (symlink) {\n-                                return Files.size(BASE.resolve(sha));\n-                            }\n-                            return Files.size(BASE.resolve(resPath));\n-                        } else {\n-                            if (diff != null) {\n-                                \/\/ If the resource has a diff to the\n-                                \/\/ packaged modules, use the diff. Diffs of kind\n-                                \/\/ ADDED have been filtered out in collectFiles();\n-                                assert diff.getKind() != ResourceDiff.Kind.ADDED;\n-                                assert diff.getName().equals(String.format(\"\/%s\/%s\",\n-                                                                           archive.moduleName(),\n-                                                                           resPath));\n-                                return diff.getResourceBytes().length;\n-                            }\n-                            \/\/ Read from the module image. This works, because\n-                            \/\/ the underlying base path is a JrtPath with the\n-                            \/\/ JrtFileSystem underneath which is able to handle\n-                            \/\/ this size query.\n-                            return Files.size(archive.getPath().resolve(resPath));\n-                        }\n+                        return Files.size(targetPath());\n@@ -488,20 +493,1 @@\n-                    if (resType != EntryType.CLASS_OR_RESOURCE) {\n-                        \/\/ Read from the base JDK image.\n-                        Path path = symlink ? BASE.resolve(sha) : BASE.resolve(resPath);\n-                        return Files.newInputStream(path);\n-                    } else {\n-                        \/\/ Read from the module image. Use the diff to the\n-                        \/\/ packaged modules if we have one. Diffs of kind\n-                        \/\/ ADDED have been filtered out in collectFiles();\n-                        if (diff != null) {\n-                            assert diff.getKind() != ResourceDiff.Kind.ADDED;\n-                            assert diff.getName().equals(String.format(\"\/%s\/%s\",\n-                                                                       archive.moduleName(),\n-                                                                       resPath));\n-                            return new ByteArrayInputStream(diff.getResourceBytes());\n-                        }\n-                        String module = archive.moduleName();\n-                        ModuleReference mRef = ModuleFinder.ofSystem()\n-                                                    .find(module).orElseThrow();\n-                        return mRef.open().open(resPath).orElseThrow();\n-                    }\n+                    return Files.newInputStream(targetPath());\n@@ -509,1 +495,0 @@\n-\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/JRTArchive.java","additions":100,"deletions":115,"binary":false,"changes":215,"status":"modified"},{"patch":"@@ -352,15 +352,16 @@\n-        ImageProvider imageProvider =\n-                createImageProvider(config,\n-                                    null,\n-                                    IGNORE_SIGNING_DEFAULT,\n-                                    false,\n-                                    null,\n-                                    false,\n-                                    new OptionsValues(),\n-                                    null);\n-\n-        \/\/ Then create the Plugin Stack\n-        ImagePluginStack stack = ImagePluginConfiguration.parseConfiguration(plugins);\n-\n-        \/\/Ask the stack to proceed;\n-        stack.operate(imageProvider);\n+        try (ImageHelper imageProvider =\n+                     createImageProvider(config,\n+                             null,\n+                             IGNORE_SIGNING_DEFAULT,\n+                             false,\n+                             null,\n+                             false,\n+                             new OptionsValues(),\n+                             null)) {\n+\n+            \/\/ Then create the Plugin Stack\n+            ImagePluginStack stack = ImagePluginConfiguration.parseConfiguration(plugins);\n+\n+            \/\/Ask the stack to proceed;\n+            stack.operate(imageProvider);\n+        }\n@@ -489,16 +490,19 @@\n-        ImageHelper imageProvider = createImageProvider(config,\n-                                                        options.packagedModulesPath,\n-                                                        options.ignoreSigning,\n-                                                        options.bindServices,\n-                                                        options.endian,\n-                                                        options.verbose,\n-                                                        options,\n-                                                        log);\n-\n-        \/\/ Then create the Plugin Stack\n-        ImagePluginStack stack = ImagePluginConfiguration.parseConfiguration(\n-            taskHelper.getPluginsConfig(options.output, options.launchers,\n-                    imageProvider.targetPlatform));\n-\n-        \/\/Ask the stack to proceed\n-        stack.operate(imageProvider);\n+        try (ImageHelper imageProvider = createImageProvider(config,\n+                options.packagedModulesPath,\n+                options.ignoreSigning,\n+                options.bindServices,\n+                options.endian,\n+                options.verbose,\n+                options,\n+                log)) {\n+            \/\/ Then create the Plugin Stack\n+            ImagePluginStack stack = ImagePluginConfiguration.parseConfiguration(\n+                    taskHelper.getPluginsConfig(\n+                            options.output,\n+                            options.launchers,\n+                            imageProvider.targetPlatform));\n+\n+            \/\/Ask the stack to proceed\n+            stack.operate(imageProvider);\n+        }\n+\n@@ -1030,4 +1034,5 @@\n-    private static record ImageHelper(Set<Archive> archives,\n-                                      Platform targetPlatform,\n-                                      Path packagedModulesPath,\n-                                      boolean generateRuntimeImage) implements ImageProvider {\n+    private record ImageHelper(Set<Archive> archives,\n+                               Platform targetPlatform,\n+                               Path packagedModulesPath,\n+                               boolean generateRuntimeImage)\n+            implements ImageProvider, AutoCloseable {\n@@ -1049,0 +1054,7 @@\n+\n+        @Override\n+        public void close() throws IOException {\n+            for (Archive archive : archives) {\n+                archive.close();\n+            }\n+        }\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/JlinkTask.java","additions":47,"deletions":35,"binary":false,"changes":82,"status":"modified"},{"patch":"@@ -69,13 +69,0 @@\n-    \/**\n-     * Returns true if a resource is located in a named package.\n-     *\/\n-    public static boolean isNamedPackageResource(String name) {\n-        int index = name.lastIndexOf(\"\/\");\n-        if (index == -1) {\n-            return false;\n-        } else {\n-            String pn = name.substring(0, index).replace('\/', '.');\n-            return Checks.isPackageName(pn);\n-        }\n-    }\n-\n@@ -83,0 +70,1 @@\n+        private static final String PREVIEW_PREFIX = \"META-INF\/preview\/\";\n@@ -135,10 +123,2 @@\n-                .filter(m -> m.type() == ResourcePoolEntry.Type.CLASS_OR_RESOURCE)\n-                .forEach(res -> {\n-                    String name = ImageFileCreator.resourceName(res.path());\n-                    if (isNamedPackageResource(name)) {\n-                        String pkg = ImageFileCreator.toPackage(name);\n-                        if (!pkg.isEmpty()) {\n-                            pkgs.add(pkg);\n-                        }\n-                    }\n-                });\n+                    .filter(m -> m.type() == ResourcePoolEntry.Type.CLASS_OR_RESOURCE)\n+                    .forEach(res -> inferPackageName(res).ifPresent(pkgs::add));\n@@ -162,0 +142,33 @@\n+\n+        \/**\n+         * Returns a valid non-empty package name, inferred from a resource pool\n+         * entry's path.\n+         *\n+         * <p>If the resource pool entry is for a preview resource (i.e. with\n+         * path {@code \"\/mod-name\/META-INF\/preview\/pkg-path\/resource-name\"})\n+         * the package name is the non-preview name based on {@code \"pkg-path\"}.\n+         *\n+         * @return the inferred package name, or {@link Optional#empty() empty}\n+         *     if no name could be inferred.\n+         *\/\n+        private static Optional<String> inferPackageName(ResourcePoolEntry res) {\n+            \/\/ Expect entry paths to be \"\/mod-name\/pkg-path\/resource-name\", but\n+            \/\/ may also get \"\/mod-name\/META-INF\/preview\/pkg-path\/resource-name\"\n+            String name = res.path();\n+            if (name.charAt(0) == '\/') {\n+                int pkgStart = name.indexOf('\/', 1) + 1;\n+                int pkgEnd = name.lastIndexOf('\/');\n+                if (pkgStart > 0 && pkgEnd > pkgStart) {\n+                    String pkgPath = name.substring(pkgStart, pkgEnd);\n+                    \/\/ Handle preview paths by removing the prefix.\n+                    if (pkgPath.startsWith(PREVIEW_PREFIX)) {\n+                        pkgPath = pkgPath.substring(PREVIEW_PREFIX.length());\n+                    }\n+                    String pkgName = pkgPath.replace('\/', '.');\n+                    if (Checks.isPackageName(pkgName)) {\n+                        return Optional.of(pkgName);\n+                    }\n+                }\n+            }\n+            return Optional.empty();\n+        }\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/ResourcePoolManager.java","additions":36,"deletions":23,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -82,1 +82,2 @@\n-    static value class MyInt {\n+    static value\n+    class MyInt {\n@@ -343,1 +344,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n@@ -362,1 +363,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n@@ -383,1 +384,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n@@ -403,1 +404,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n@@ -424,1 +425,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n@@ -444,1 +445,1 @@\n-        MyInt[] src = (MyInt[])ValueClass.newNullableAtomicArray(MyInt.class, len);\n+        MyInt[] src = (MyInt[]) ValueClass.newNullableAtomicArray(MyInt.class, len);\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestArrayCopy.java","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -155,3 +155,3 @@\n-                   .addScenarios(scenarios[Integer.parseInt(args[0])])\n-                   .addHelperClasses(MyValue1.class, MyValue2.class, MyValue2Inline.class)\n-                   .start();\n+                .addScenarios(scenarios[Integer.parseInt(args[0])])\n+                .addHelperClasses(MyValue1.class, MyValue2.class, MyValue2Inline.class)\n+                .start();\n@@ -192,1 +192,2 @@\n-    static value class NotFlattenable {\n+    static value\n+    class NotFlattenable {\n@@ -206,1 +207,1 @@\n-        counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"})\n+            counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"})\n@@ -208,2 +209,2 @@\n-        counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"},\n-        failOn = {LOAD_OF_ANY_KLASS})\n+            counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"},\n+            failOn = {LOAD_OF_ANY_KLASS})\n@@ -211,1 +212,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -231,1 +232,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -257,1 +258,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n@@ -281,1 +282,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n@@ -296,1 +297,1 @@\n-            va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 5, MyValue1.DEFAULT);\n+            va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 5, MyValue1.DEFAULT);\n@@ -301,1 +302,1 @@\n-            va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n+            va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n@@ -335,1 +336,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -341,1 +342,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -350,1 +351,1 @@\n-        return (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        return (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -356,1 +357,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -367,1 +368,1 @@\n-        return (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n+        return (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n@@ -387,1 +388,1 @@\n-        test9_va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        test9_va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -400,1 +401,1 @@\n-                    arr[i][j][k] = MyValue1.createWithFieldsDontInline(rI + i , rL + j + k);\n+                    arr[i][j][k] = MyValue1.createWithFieldsDontInline(rI + i, rL + j + k);\n@@ -413,1 +414,1 @@\n-                    Asserts.assertEQ(arr[i][j][k].hash(), MyValue1.createWithFieldsDontInline(rI + i , rL + j + k).hash());\n+                    Asserts.assertEQ(arr[i][j][k].hash(), MyValue1.createWithFieldsDontInline(rI + i, rL + j + k).hash());\n@@ -435,2 +436,2 @@\n-        long[] res = new long[2*3*4];\n-        long[] verif = new long[2*3*4];\n+        long[] res = new long[2 * 3 * 4];\n+        long[] verif = new long[2 * 3 * 4];\n@@ -457,1 +458,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -479,1 +480,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -499,1 +500,1 @@\n-    public int test14(MyValue1[] va, int index)  {\n+    public int test14(MyValue1[] va, int index) {\n@@ -506,1 +507,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -527,1 +528,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -548,1 +549,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -567,1 +568,1 @@\n-    public int test17(MyValue1[] va, int index, MyValue1 vt)  {\n+    public int test17(MyValue1[] va, int index, MyValue1 vt) {\n@@ -575,1 +576,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, arraySize, MyValue1.DEFAULT);\n@@ -606,1 +607,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -621,1 +622,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -647,2 +648,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -667,2 +668,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -670,1 +671,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -682,1 +683,1 @@\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, src.length, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, src.length, MyValue1.DEFAULT);\n@@ -690,1 +691,1 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -704,1 +705,1 @@\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, src.length + 10, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, src.length + 10, MyValue1.DEFAULT);\n@@ -712,1 +713,1 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -731,2 +732,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] dst1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -743,1 +744,1 @@\n-            Asserts.assertEQ(src[i].hash(), ((MyValue1)dst2[i]).hash());\n+            Asserts.assertEQ(src[i].hash(), ((MyValue1) dst2[i]).hash());\n@@ -755,2 +756,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -758,1 +759,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -774,2 +775,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -793,2 +794,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -800,1 +801,1 @@\n-            Asserts.assertEQ(src[i-1].hash(), dst[i].hash());\n+            Asserts.assertEQ(src[i - 1].hash(), dst[i].hash());\n@@ -808,1 +809,1 @@\n-        failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n+            failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n@@ -810,1 +811,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -812,1 +813,1 @@\n-        MyValue2[] dst = (MyValue2[])src.clone();\n+        MyValue2[] dst = (MyValue2[]) src.clone();\n@@ -828,1 +829,1 @@\n-        failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n+            failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n@@ -830,1 +831,1 @@\n-        failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n+            failOn = {ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n@@ -832,1 +833,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -839,1 +840,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -841,1 +842,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -851,1 +852,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -853,1 +854,1 @@\n-        if (flag) { }\n+        if (flag) {}\n@@ -860,1 +861,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -862,1 +863,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -873,1 +874,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 1, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 1, MyValue2.DEFAULT);\n@@ -877,1 +878,1 @@\n-            src[0] = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+            src[0] = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -906,1 +907,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -910,1 +911,1 @@\n-        MyValue1[] result = (MyValue1[])test32(va);\n+        MyValue1[] result = (MyValue1[]) test32(va);\n@@ -912,1 +913,1 @@\n-            Asserts.assertEQ(((MyValue1)result[i]).hash(), ((MyValue1)va[i]).hash());\n+            Asserts.assertEQ(((MyValue1) result[i]).hash(), ((MyValue1) va[i]).hash());\n@@ -930,1 +931,1 @@\n-            Asserts.assertEQ(((MyValue1)result[i]).hash(), ((MyValue1)va[i]).hash());\n+            Asserts.assertEQ(((MyValue1) result[i]).hash(), ((MyValue1) va[i]).hash());\n@@ -943,1 +944,1 @@\n-            va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+            va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -996,2 +997,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] dst1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1020,2 +1021,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1023,1 +1024,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1041,2 +1042,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1044,1 +1045,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1064,1 +1065,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1066,1 +1067,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1088,1 +1089,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1091,1 +1092,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1111,1 +1112,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1113,1 +1114,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1135,1 +1136,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1138,1 +1139,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1159,1 +1160,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1176,2 +1177,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -1196,2 +1197,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1199,1 +1200,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1216,2 +1217,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1219,1 +1220,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1238,1 +1239,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1240,1 +1241,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1261,1 +1262,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1264,1 +1265,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1283,1 +1284,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1285,1 +1286,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1306,1 +1307,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -1309,1 +1310,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1329,1 +1330,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1348,1 +1349,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1356,1 +1357,1 @@\n-    static final MyValue1[] test52_va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+    static final MyValue1[] test52_va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -1382,1 +1383,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1398,1 +1399,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1414,1 +1415,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1447,1 +1448,1 @@\n-        Object[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        Object[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1463,1 +1464,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1479,1 +1480,1 @@\n-        return Arrays.copyOf(va, va.length+1, va.getClass());\n+        return Arrays.copyOf(va, va.length + 1, va.getClass());\n@@ -1485,2 +1486,2 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len);\n-        MyValue1[] verif = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len);\n+        MyValue1[] verif = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n@@ -1497,1 +1498,1 @@\n-        return Arrays.copyOf(va, va.length+1, klass);\n+        return Arrays.copyOf(va, va.length + 1, klass);\n@@ -1503,2 +1504,2 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len);\n-        MyValue1[] verif = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len);\n+        MyValue1[] verif = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n@@ -1507,1 +1508,1 @@\n-            verif[i] = (MyValue1)va[i];\n+            verif[i] = (MyValue1) va[i];\n@@ -1515,1 +1516,1 @@\n-        return Arrays.copyOf(va, va.length+1, klass);\n+        return Arrays.copyOf(va, va.length + 1, klass);\n@@ -1545,1 +1546,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1549,1 +1550,1 @@\n-        return Arrays.copyOf(arr, arr.length+1, arr.getClass());\n+        return Arrays.copyOf(arr, arr.length + 1, arr.getClass());\n@@ -1555,1 +1556,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1581,1 +1582,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1585,1 +1586,1 @@\n-        return Arrays.copyOf(arr, arr.length+1, arr.getClass());\n+        return Arrays.copyOf(arr, arr.length + 1, arr.getClass());\n@@ -1591,2 +1592,2 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len);\n-        MyValue1[] verif = (MyValue1[])ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len);\n+        MyValue1[] verif = (MyValue1[]) ValueClass.newNullableAtomicArray(MyValue1.class, len + 1);\n@@ -1606,1 +1607,1 @@\n-        return (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        return (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -1611,1 +1612,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -1621,1 +1622,1 @@\n-        return (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 32, MyValue1.DEFAULT);\n+        return (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 32, MyValue1.DEFAULT);\n@@ -1626,1 +1627,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 32, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 32, MyValue1.DEFAULT);\n@@ -1637,1 +1638,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -1652,1 +1653,1 @@\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 16, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 16, MyValue1.DEFAULT);\n@@ -1659,1 +1660,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 16, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 16, MyValue1.DEFAULT);\n@@ -1669,1 +1670,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -1676,1 +1677,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -1686,1 +1687,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 4, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 4, MyValue1.DEFAULT);\n@@ -1695,1 +1696,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 4, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 4, MyValue1.DEFAULT);\n@@ -1708,1 +1709,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -1716,1 +1717,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -1727,2 +1728,2 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -1730,1 +1731,1 @@\n-            src[i] = MyValue2.createWithFieldsDontInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsDontInline(rI + i, rD + i);\n@@ -1777,2 +1778,2 @@\n-        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI+1, rL+1);\n-        MyValue1[] arr = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 3, MyValue1.DEFAULT);\n+        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI + 1, rL + 1);\n+        MyValue1[] arr = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 3, MyValue1.DEFAULT);\n@@ -1790,1 +1791,1 @@\n-    public static void test74Callee(MyValue1[] va) { }\n+    public static void test74Callee(MyValue1[] va) {}\n@@ -1802,1 +1803,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n@@ -1821,1 +1822,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1830,1 +1831,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1859,1 +1860,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1868,2 +1869,2 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] verif = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] verif = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1892,2 +1893,2 @@\n-        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI+1, rL+1);\n-        MyValue1[] arr = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI + 1, rL + 1);\n+        MyValue1[] arr = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -1916,1 +1917,1 @@\n-        MyValue1[] a = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, n, MyValue1.DEFAULT);\n+        MyValue1[] a = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, n, MyValue1.DEFAULT);\n@@ -1918,1 +1919,1 @@\n-        for (int i = 0; i<n; i++) {\n+        for (int i = 0; i < n; i++) {\n@@ -1934,1 +1935,1 @@\n-        counts = {LOAD_UNKNOWN_INLINE, \"= 1\"})\n+            counts = {LOAD_UNKNOWN_INLINE, \"= 1\"})\n@@ -1936,1 +1937,1 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE})\n+            failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE})\n@@ -1938,1 +1939,1 @@\n-        NonValueClass i1 = (NonValueClass)array[0];\n+        NonValueClass i1 = (NonValueClass) array[0];\n@@ -1955,1 +1956,1 @@\n-        counts = {LOAD_UNKNOWN_INLINE, \"= 1\"})\n+            counts = {LOAD_UNKNOWN_INLINE, \"= 1\"})\n@@ -1957,1 +1958,1 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE})\n+            failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE})\n@@ -1959,1 +1960,1 @@\n-        NotFlattenable vt = (NotFlattenable)array[0];\n+        NotFlattenable vt = (NotFlattenable) array[0];\n@@ -1967,1 +1968,1 @@\n-        NotFlattenable[] array = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n+        NotFlattenable[] array = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n@@ -1978,1 +1979,1 @@\n-          return null;\n+            return null;\n@@ -2006,1 +2007,1 @@\n-        failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE})\n+            failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE})\n@@ -2008,1 +2009,1 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE})\n+            failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE})\n@@ -2019,1 +2020,1 @@\n-        NotFlattenable[] array1 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 3, NotFlattenable.DEFAULT);\n+        NotFlattenable[] array1 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 3, NotFlattenable.DEFAULT);\n@@ -2036,2 +2037,2 @@\n-        counts = {LOAD_UNKNOWN_INLINE, \"= 1\"},\n-        failOn = {ALLOC_ARRAY, STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n+            counts = {LOAD_UNKNOWN_INLINE, \"= 1\"},\n+            failOn = {ALLOC_ARRAY, STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n@@ -2041,1 +2042,1 @@\n-        NonValueClass i = (NonValueClass)array[0];\n+        NonValueClass i = (NonValueClass) array[0];\n@@ -2059,4 +2060,4 @@\n-        failOn = {ALLOC, ALLOC_ARRAY},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 1\", \/\/ Null check on first store, no check on second store\n-                  STORE_UNKNOWN_INLINE, \"= 2\",\n-                  LOAD_UNKNOWN_INLINE, \"= 1\"})\n+            failOn = {ALLOC, ALLOC_ARRAY},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 1\", \/\/ Null check on first store, no check on second store\n+                    STORE_UNKNOWN_INLINE, \"= 2\",\n+                    LOAD_UNKNOWN_INLINE, \"= 1\"})\n@@ -2064,2 +2065,3 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, STORE_UNKNOWN_INLINE, LOAD_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 1\"}) \/\/ Null check on first store, no check on second store\n+            failOn = {ALLOC, ALLOC_ARRAY, STORE_UNKNOWN_INLINE, LOAD_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 1\"})\n+    \/\/ Null check on first store, no check on second store\n@@ -2083,1 +2085,1 @@\n-            NotFlattenable[] array3 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n+            NotFlattenable[] array3 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n@@ -2096,3 +2098,3 @@\n-        failOn = {ALLOC, ALLOC_ARRAY},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\",\n-                  STORE_UNKNOWN_INLINE, \"<= 3\"})\n+            failOn = {ALLOC, ALLOC_ARRAY},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\",\n+                    STORE_UNKNOWN_INLINE, \"<= 3\"})\n@@ -2100,2 +2102,2 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, STORE_UNKNOWN_INLINE, LOAD_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n+            failOn = {ALLOC, ALLOC_ARRAY, STORE_UNKNOWN_INLINE, LOAD_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n@@ -2125,1 +2127,1 @@\n-            NotFlattenable[] array3 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n+            NotFlattenable[] array3 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n@@ -2138,2 +2140,2 @@\n-        failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\", ALLOC, \"= 1\"})\n+            failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\", ALLOC, \"= 1\"})\n@@ -2141,2 +2143,2 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n+            failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n@@ -2161,1 +2163,1 @@\n-            NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n+            NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 2, NotFlattenable.DEFAULT);\n@@ -2174,2 +2176,2 @@\n-        failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\", ALLOC, \"= 1\"})\n+            failOn = {ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\", ALLOC, \"= 1\"})\n@@ -2177,2 +2179,2 @@\n-        failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n-        counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n+            failOn = {ALLOC, ALLOC_ARRAY, LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE},\n+            counts = {INLINE_ARRAY_NULL_GUARD, \"= 2\"})\n@@ -2197,1 +2199,1 @@\n-            MyValue1[] array2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+            MyValue1[] array2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2222,1 +2224,1 @@\n-            MyValue1[] array3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] array3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2235,1 +2237,1 @@\n-        array[0] = (MyValue1)o;\n+        array[0] = (MyValue1) o;\n@@ -2244,1 +2246,1 @@\n-            MyValue1[] array2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] array2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2258,1 +2260,1 @@\n-        MyValue1[] qArray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n+        MyValue1[] qArray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT);\n@@ -2264,1 +2266,1 @@\n-        MyValue1[][] qArray2 = { (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT) };\n+        MyValue1[][] qArray2 = {(MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 0, MyValue1.DEFAULT)};\n@@ -2279,1 +2281,2 @@\n-    static value class Test91Value {\n+    static value\n+    class Test91Value {\n@@ -2318,1 +2321,1 @@\n-        Test91Value[] array = (Test91Value[])ValueClass.newNullRestrictedNonAtomicArray(Test91Value.class, 5, new Test91Value(0));\n+        Test91Value[] array = (Test91Value[]) ValueClass.newNullRestrictedNonAtomicArray(Test91Value.class, 5, new Test91Value(0));\n@@ -2336,2 +2339,2 @@\n-        MyValue1[] a = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n-        MyValue1[] b = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] a = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] b = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2356,1 +2359,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -2358,1 +2361,1 @@\n-        if (flag) {  }\n+        if (flag) {}\n@@ -2360,1 +2363,1 @@\n-               dst[5].hash() + dst[6].hash() + dst[7].hash() + dst[8].hash() + dst[9].hash();\n+                dst[5].hash() + dst[6].hash() + dst[7].hash() + dst[8].hash() + dst[9].hash();\n@@ -2366,1 +2369,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -2368,1 +2371,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -2381,1 +2384,1 @@\n-        MyValue2[] dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -2383,1 +2386,1 @@\n-        if (flag) {  }\n+        if (flag) {}\n@@ -2385,1 +2388,1 @@\n-               dst[5].hash() + dst[6].hash() + dst[7].hash() + dst[8].hash() + dst[9].hash();\n+                dst[5].hash() + dst[6].hash() + dst[7].hash() + dst[8].hash() + dst[9].hash();\n@@ -2391,1 +2394,1 @@\n-        MyValue2[] src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -2393,1 +2396,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -2397,1 +2400,1 @@\n-            long expected = src[i].hash() + 9*MyValue2.createDefaultInline().hash();\n+            long expected = src[i].hash() + 9 * MyValue2.createDefaultInline().hash();\n@@ -2402,1 +2405,1 @@\n-    static final MyValue1[] nullFreeArray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+    static final MyValue1[] nullFreeArray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2413,1 +2416,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2439,1 +2442,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2468,1 +2471,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2501,1 +2504,1 @@\n-        failOn = IRNode.SUBTYPE_CHECK)\n+            failOn = IRNode.SUBTYPE_CHECK)\n@@ -2507,1 +2510,1 @@\n-        return (MyValue1[])array;\n+        return (MyValue1[]) array;\n@@ -2512,2 +2515,2 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n-        NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n@@ -2533,1 +2536,1 @@\n-        failOn = IRNode.SUBTYPE_CHECK)\n+            failOn = IRNode.SUBTYPE_CHECK)\n@@ -2539,1 +2542,1 @@\n-        MyValue1[] casted = (MyValue1[])array;\n+        MyValue1[] casted = (MyValue1[]) array;\n@@ -2545,2 +2548,2 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n-        NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n@@ -2566,1 +2569,1 @@\n-        failOn = IRNode.SUBTYPE_CHECK)\n+            failOn = IRNode.SUBTYPE_CHECK)\n@@ -2577,2 +2580,2 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n-        NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n@@ -2593,1 +2596,1 @@\n-    @IR(counts = { IRNode.SUBTYPE_CHECK, \"1\" })\n+    @IR(counts = {IRNode.SUBTYPE_CHECK, \"1\"})\n@@ -2601,2 +2604,2 @@\n-        NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n-        MyValue1[] array3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n+        MyValue1[] array3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2610,1 +2613,1 @@\n-    @IR(counts = { IRNode.SUBTYPE_CHECK, \"1\" })\n+    @IR(counts = {IRNode.SUBTYPE_CHECK, \"1\"})\n@@ -2618,2 +2621,2 @@\n-        NotFlattenable[] array2 = (NotFlattenable[])ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n-        MyValue1[] array3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        NotFlattenable[] array2 = (NotFlattenable[]) ValueClass.newNullRestrictedNonAtomicArray(NotFlattenable.class, 1, NotFlattenable.DEFAULT);\n+        MyValue1[] array3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2633,5 +2636,5 @@\n-    static final MyValue2[] val_src = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-    static final MyValue2[] val_dst = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-    static final Object[]   obj_src = new Object[8];\n-    static final Object[]   obj_null_src = new Object[8];\n-    static final Object[]   obj_dst = new Object[8];\n+    static final MyValue2[] val_src = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+    static final MyValue2[] val_dst = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+    static final Object[] obj_src = new Object[8];\n+    static final Object[] obj_null_src = new Object[8];\n+    static final Object[] obj_dst = new Object[8];\n@@ -2640,1 +2643,1 @@\n-    static Object get_val_src() { return val_src; }\n+    static Object get_val_src() {return val_src;}\n@@ -2642,1 +2645,1 @@\n-    static Object get_val_dst() { return val_dst; }\n+    static Object get_val_dst() {return val_dst;}\n@@ -2644,1 +2647,1 @@\n-    static Class get_val_class() { return val_src.getClass(); }\n+    static Class get_val_class() {return val_src.getClass();}\n@@ -2646,1 +2649,1 @@\n-    static Class get_non_val_class() { return NonValueClass[].class; }\n+    static Class get_non_val_class() {return NonValueClass[].class;}\n@@ -2648,1 +2651,1 @@\n-    static Object get_obj_src() { return obj_src; }\n+    static Object get_obj_src() {return obj_src;}\n@@ -2650,1 +2653,1 @@\n-    static Object get_obj_null_src() { return obj_null_src; }\n+    static Object get_obj_null_src() {return obj_null_src;}\n@@ -2652,1 +2655,1 @@\n-    static Object get_obj_dst() { return obj_dst; }\n+    static Object get_obj_dst() {return obj_dst;}\n@@ -2654,1 +2657,1 @@\n-    static Class get_obj_class() { return Object[].class; }\n+    static Class get_obj_class() {return Object[].class;}\n@@ -2658,3 +2661,3 @@\n-            val_src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            obj_src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            obj_null_src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            val_src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            obj_src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            obj_null_src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -2668,1 +2671,1 @@\n-        counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n+            counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n@@ -2670,1 +2673,1 @@\n-        failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n+            failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n@@ -2742,1 +2745,1 @@\n-        counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n+            counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n@@ -2744,1 +2747,1 @@\n-        failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n+            failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n@@ -2759,1 +2762,1 @@\n-        failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n+            failOn = INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP)\n@@ -2813,1 +2816,1 @@\n-        counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n+            counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n@@ -2815,1 +2818,1 @@\n-        failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n+            failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n@@ -2883,1 +2886,1 @@\n-        counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n+            counts = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, \"= 1\"})\n@@ -2885,1 +2888,1 @@\n-        failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n+            failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n@@ -2887,1 +2890,1 @@\n-        return Arrays.copyOf((Object[])get_val_src(), 8, get_obj_class());\n+        return Arrays.copyOf((Object[]) get_val_src(), 8, get_obj_class());\n@@ -2900,1 +2903,1 @@\n-        failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n+            failOn = {INTRINSIC_OR_TYPE_CHECKED_INLINING_TRAP, CLASS_CHECK_TRAP})\n@@ -2902,1 +2905,1 @@\n-        return Arrays.copyOf((Object[])get_val_src(), 8, get_val_class());\n+        return Arrays.copyOf((Object[]) get_val_src(), 8, get_val_class());\n@@ -2914,1 +2917,1 @@\n-        return Arrays.copyOf((Object[])get_obj_src(), 8, get_obj_class());\n+        return Arrays.copyOf((Object[]) get_obj_src(), 8, get_obj_class());\n@@ -2927,1 +2930,1 @@\n-        return Arrays.copyOf((Object[])get_obj_src(), 8, val_src2.getClass());\n+        return Arrays.copyOf((Object[]) get_obj_src(), 8, val_src2.getClass());\n@@ -2940,1 +2943,1 @@\n-        return Arrays.copyOf((Object[])get_obj_null_src(), 8, val_src2.getClass());\n+        return Arrays.copyOf((Object[]) get_obj_null_src(), 8, val_src2.getClass());\n@@ -2946,1 +2949,1 @@\n-        verify((Object[])get_obj_null_src(), res);\n+        verify((Object[]) get_obj_null_src(), res);\n@@ -3094,1 +3097,1 @@\n-        verify((Object[])arr, res);\n+        verify((Object[]) arr, res);\n@@ -3118,2 +3121,2 @@\n-        counts = {JLONG_ARRAYCOPY, \"= 1\"},\n-        failOn = {CHECKCAST_ARRAYCOPY, CLONE_INTRINSIC_SLOW_PATH})\n+            counts = {JLONG_ARRAYCOPY, \"= 1\"},\n+            failOn = {CHECKCAST_ARRAYCOPY, CLONE_INTRINSIC_SLOW_PATH})\n@@ -3121,1 +3124,1 @@\n-        failOn = CLONE_INTRINSIC_SLOW_PATH)\n+            failOn = CLONE_INTRINSIC_SLOW_PATH)\n@@ -3154,1 +3157,2 @@\n-    static value class Test127aValue {\n+    static value\n+    class Test127aValue {\n@@ -3167,2 +3171,2 @@\n-    static final Test127aValue[] srcTest127a = (Test127aValue[])ValueClass.newNullRestrictedNonAtomicArray(Test127aValue.class, 8, valueTest127a);\n-    static final Test127aValue[] destTest127a = (Test127aValue[])ValueClass.newNullRestrictedNonAtomicArray(Test127aValue.class, 8, valueTest127a);\n+    static final Test127aValue[] srcTest127a = (Test127aValue[]) ValueClass.newNullRestrictedNonAtomicArray(Test127aValue.class, 8, valueTest127a);\n+    static final Test127aValue[] destTest127a = (Test127aValue[]) ValueClass.newNullRestrictedNonAtomicArray(Test127aValue.class, 8, valueTest127a);\n@@ -3180,1 +3184,1 @@\n-        test127a(0,1, 7);\n+        test127a(0, 1, 7);\n@@ -3199,2 +3203,2 @@\n-        counts = {JLONG_ARRAYCOPY, \"= 1\"},\n-        failOn = CHECKCAST_ARRAYCOPY)\n+            counts = {JLONG_ARRAYCOPY, \"= 1\"},\n+            failOn = CHECKCAST_ARRAYCOPY)\n@@ -3248,1 +3252,1 @@\n-        failOn = {LOAD_OF_ANY_KLASS})\n+            failOn = {LOAD_OF_ANY_KLASS})\n@@ -3256,1 +3260,1 @@\n-        MyValueEmpty[] array = (MyValueEmpty[])ValueClass.newNullRestrictedNonAtomicArray(MyValueEmpty.class, 2, empty);\n+        MyValueEmpty[] array = (MyValueEmpty[]) ValueClass.newNullRestrictedNonAtomicArray(MyValueEmpty.class, 2, empty);\n@@ -3263,1 +3267,2 @@\n-    static value class EmptyContainer {\n+    static value\n+    class EmptyContainer {\n@@ -3279,1 +3284,1 @@\n-        EmptyContainer[] array = (EmptyContainer[])ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 2, new EmptyContainer());\n+        EmptyContainer[] array = (EmptyContainer[]) ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 2, new EmptyContainer());\n@@ -3294,1 +3299,1 @@\n-        Object[] array = (MyValueEmpty[])ValueClass.newNullRestrictedNonAtomicArray(MyValueEmpty.class, 2, empty);\n+        Object[] array = (MyValueEmpty[]) ValueClass.newNullRestrictedNonAtomicArray(MyValueEmpty.class, 2, empty);\n@@ -3314,1 +3319,1 @@\n-        Object[] array = (EmptyContainer[])ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 2, new EmptyContainer());\n+        Object[] array = (EmptyContainer[]) ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 2, new EmptyContainer());\n@@ -3327,1 +3332,1 @@\n-        failOn = {ALLOC_OF_MYVALUE_KLASS, ALLOC_ARRAY_OF_MYVALUE_KLASS, LOAD_OF_ANY_KLASS, STORE_OF_ANY_KLASS})\n+            failOn = {ALLOC_OF_MYVALUE_KLASS, ALLOC_ARRAY_OF_MYVALUE_KLASS, LOAD_OF_ANY_KLASS, STORE_OF_ANY_KLASS})\n@@ -3349,1 +3354,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -3353,1 +3358,1 @@\n-            Asserts.assertEquals(((MyValue1)res).hash(), array1[1].hash());\n+            Asserts.assertEquals(((MyValue1) res).hash(), array1[1].hash());\n@@ -3378,1 +3383,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -3381,1 +3386,1 @@\n-        Asserts.assertEquals(((MyValue1)res).hash(), array1[1].hash());\n+        Asserts.assertEquals(((MyValue1) res).hash(), array1[1].hash());\n@@ -3403,1 +3408,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 100, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 100, MyValue1.DEFAULT);\n@@ -3446,1 +3451,1 @@\n-        MyValue1[] array1 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 100, MyValue1.DEFAULT);\n+        MyValue1[] array1 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 100, MyValue1.DEFAULT);\n@@ -3468,1 +3473,1 @@\n-                  STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n+            STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n@@ -3470,1 +3475,1 @@\n-        Object[]  array = null;\n+        Object[] array = null;\n@@ -3472,1 +3477,1 @@\n-        Object[] varray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        Object[] varray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3489,1 +3494,1 @@\n-                  LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n+            LOAD_UNKNOWN_INLINE, STORE_UNKNOWN_INLINE, INLINE_ARRAY_NULL_GUARD})\n@@ -3491,1 +3496,1 @@\n-        Object[]  array = null;\n+        Object[] array = null;\n@@ -3493,1 +3498,1 @@\n-        Object[] varray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        Object[] varray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3516,1 +3521,1 @@\n-        Object[]  array = null;\n+        Object[] array = null;\n@@ -3518,1 +3523,1 @@\n-        Object[] varray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        Object[] varray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3537,1 +3542,1 @@\n-        Object[]  array = null;\n+        Object[] array = null;\n@@ -3539,1 +3544,1 @@\n-        Object[] varray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        Object[] varray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3567,1 +3572,1 @@\n-        public int hash() { return 42; }\n+        public int hash() {return 42;}\n@@ -3621,2 +3626,2 @@\n-        Object[] array = (EmptyContainer[])ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 1, new EmptyContainer());\n-        EmptyContainer empty = (EmptyContainer)test145(array);\n+        Object[] array = (EmptyContainer[]) ValueClass.newNullRestrictedNonAtomicArray(EmptyContainer.class, 1, new EmptyContainer());\n+        EmptyContainer empty = (EmptyContainer) test145(array);\n@@ -3631,1 +3636,1 @@\n-        MyValue2[] array = { vt };\n+        MyValue2[] array = {vt};\n@@ -3653,1 +3658,1 @@\n-        MyValue2[] array = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 1, MyValue2.DEFAULT);\n+        MyValue2[] array = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 1, MyValue2.DEFAULT);\n@@ -3684,2 +3689,2 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3689,1 +3694,1 @@\n-          throw new RuntimeException(\"Unexpected hash\");\n+            throw new RuntimeException(\"Unexpected hash\");\n@@ -3706,1 +3711,2 @@\n-        public int get() { return x; };\n+        public int get() {return x;}\n+        ;\n@@ -3734,1 +3740,2 @@\n-    static value class Test150Value {\n+    static value\n+    class Test150Value {\n@@ -3745,1 +3752,1 @@\n-        Test150Value[] array = (Test150Value[])ValueClass.newNullRestrictedNonAtomicArray(Test150Value.class, 1, new Test150Value(\"test\"));\n+        Test150Value[] array = (Test150Value[]) ValueClass.newNullRestrictedNonAtomicArray(Test150Value.class, 1, new Test150Value(\"test\"));\n@@ -3747,1 +3754,1 @@\n-        return (String)array[0].s;\n+        return (String) array[0].s;\n@@ -3755,1 +3762,2 @@\n-    static value class Test151Value {\n+    static value\n+    class Test151Value {\n@@ -3771,1 +3779,1 @@\n-        failOn = {ALLOC_OF_MYVALUE_KLASS,})\n+            failOn = {ALLOC_OF_MYVALUE_KLASS,})\n@@ -3782,1 +3790,2 @@\n-    static value class MyValue152Inline {\n+    static value\n+    class MyValue152Inline {\n@@ -3788,1 +3797,2 @@\n-    static value class MyValue152 {\n+    static value\n+    class MyValue152 {\n@@ -3802,1 +3812,1 @@\n-        MyValue152[] array = (MyValue152[])ValueClass.newNullRestrictedNonAtomicArray(MyValue152.class, 1, new MyValue152());\n+        MyValue152[] array = (MyValue152[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue152.class, 1, new MyValue152());\n@@ -3812,1 +3822,2 @@\n-    static value class MyValue153 {\n+    static value\n+    class MyValue153 {\n@@ -3824,1 +3835,1 @@\n-        MyValue153[] array = (MyValue153[])ValueClass.newNullRestrictedNonAtomicArray(MyValue153.class, 1, new MyValue153());\n+        MyValue153[] array = (MyValue153[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue153.class, 1, new MyValue153());\n@@ -3838,1 +3849,1 @@\n-        MyValue152[] array = (MyValue152[])ValueClass.newNullRestrictedNonAtomicArray(MyValue152.class, 1, new MyValue152());\n+        MyValue152[] array = (MyValue152[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue152.class, 1, new MyValue152());\n@@ -3852,1 +3863,2 @@\n-        failOn = {IRNode.MEMBAR}, counts = {IRNode.IF, \"3\"}) \/\/ null check, class check, range check\n+            failOn = {IRNode.MEMBAR}, counts = {IRNode.IF, \"3\"})\n+    \/\/ null check, class check, range check\n@@ -3859,1 +3871,1 @@\n-        test155((Test151Value[])ValueClass.newNullRestrictedNonAtomicArray(Test151Value.class, 1, Test151Value.DEFAULT));\n+        test155((Test151Value[]) ValueClass.newNullRestrictedNonAtomicArray(Test151Value.class, 1, Test151Value.DEFAULT));\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestArrays.java","additions":334,"deletions":322,"binary":false,"changes":656,"status":"modified"},{"patch":"@@ -84,13 +84,13 @@\n-        Class<?>[] classes = new Class<?>[] {\n-            Object.class, MyInterface.class, MyClass0.class, MyClass1.class, MyClass2.class, MyClass3.class, MyClass4.class,\n-            MyClass5.class, MyClass6.class, MyClass7.class, MyClass8.class, MyClass9.class, MyClass10.class, Integer.class };\n-\n-        Class<?>[] arrayClasses = new Class<?>[] {\n-            java.lang.Cloneable.class, java.io.Serializable.class, Object.class, Object[].class,\n-            MyInterface[].class, MyClass0[].class, MyClass1[].class, MyClass2[].class, MyClass3[].class, MyClass4[].class,\n-            MyClass5[].class, MyClass6[].class, MyClass7[].class, MyClass8[].class, MyClass9[].class, MyClass10[].class, Integer[].class };\n-\n-        Class<?>[] multiDimArrayClasses = new Class<?>[] {\n-            java.lang.Cloneable.class, java.lang.Cloneable[].class, java.io.Serializable.class, java.io.Serializable[].class, Object.class, Object[].class, Object[].class,\n-            MyInterface[][].class, MyClass0[][].class, MyClass1[][].class, MyClass2[][].class, MyClass3[][].class, MyClass4[][].class,\n-            MyClass5[][].class, MyClass6[][].class, MyClass7[][].class, MyClass8[][].class, MyClass9[][].class, MyClass10[][].class, Integer[][].class };\n+        Class<?>[] classes = new Class<?>[]{\n+                Object.class, MyInterface.class, MyClass0.class, MyClass1.class, MyClass2.class, MyClass3.class, MyClass4.class,\n+                MyClass5.class, MyClass6.class, MyClass7.class, MyClass8.class, MyClass9.class, MyClass10.class, Integer.class};\n+\n+        Class<?>[] arrayClasses = new Class<?>[]{\n+                java.lang.Cloneable.class, java.io.Serializable.class, Object.class, Object[].class,\n+                MyInterface[].class, MyClass0[].class, MyClass1[].class, MyClass2[].class, MyClass3[].class, MyClass4[].class,\n+                MyClass5[].class, MyClass6[].class, MyClass7[].class, MyClass8[].class, MyClass9[].class, MyClass10[].class, Integer[].class};\n+\n+        Class<?>[] multiDimArrayClasses = new Class<?>[]{\n+                java.lang.Cloneable.class, java.lang.Cloneable[].class, java.io.Serializable.class, java.io.Serializable[].class, Object.class, Object[].class, Object[].class,\n+                MyInterface[][].class, MyClass0[][].class, MyClass1[][].class, MyClass2[][].class, MyClass3[][].class, MyClass4[][].class,\n+                MyClass5[][].class, MyClass6[][].class, MyClass7[][].class, MyClass8[][].class, MyClass9[][].class, MyClass10[][].class, Integer[][].class};\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestIsInstance.java","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -145,5 +145,5 @@\n-                   .addScenarios(scenarios[Integer.parseInt(args[0])])\n-                   .addHelperClasses(MyValue1.class,\n-                                     MyValue2.class,\n-                                     MyValue2Inline.class)\n-                   .start();\n+                .addScenarios(scenarios[Integer.parseInt(args[0])])\n+                .addHelperClasses(MyValue1.class,\n+                        MyValue2.class,\n+                        MyValue2Inline.class)\n+                .start();\n@@ -172,1 +172,1 @@\n-        counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"})\n+            counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"})\n@@ -174,2 +174,2 @@\n-        counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"},\n-        failOn = {LOAD_OF_ANY_KLASS})\n+            counts = {ALLOC_ARRAY_OF_MYVALUE_KLASS, \"= 1\"},\n+            failOn = {LOAD_OF_ANY_KLASS})\n@@ -380,1 +380,1 @@\n-                    arr[i][j][k] = MyValue1.createWithFieldsDontInline(rI + i , rL + j + k);\n+                    arr[i][j][k] = MyValue1.createWithFieldsDontInline(rI + i, rL + j + k);\n@@ -399,1 +399,1 @@\n-                        Asserts.assertEQ(arr[i][j][k].hash(), MyValue1.createWithFieldsDontInline(rI + i , rL + j + k).hash());\n+                        Asserts.assertEQ(arr[i][j][k].hash(), MyValue1.createWithFieldsDontInline(rI + i, rL + j + k).hash());\n@@ -426,2 +426,2 @@\n-        long[] res = new long[2*3*4];\n-        long[] verif = new long[2*3*4];\n+        long[] res = new long[2 * 3 * 4];\n+        long[] verif = new long[2 * 3 * 4];\n@@ -492,1 +492,1 @@\n-    public int test14(MyValue1[] va, int index)  {\n+    public int test14(MyValue1[] va, int index) {\n@@ -560,1 +560,1 @@\n-    public int test17(MyValue1[] va, int index, MyValue1 vt)  {\n+    public int test17(MyValue1[] va, int index, MyValue1 vt) {\n@@ -600,1 +600,1 @@\n-        MyValue1[] va2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -663,2 +663,2 @@\n-        MyValue1[] src3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] src4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -666,1 +666,1 @@\n-        MyValue1[] dst2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -668,1 +668,1 @@\n-        MyValue1[] dst4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -707,2 +707,2 @@\n-        MyValue2[] src3 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n-        MyValue2[] src4 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src3 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] src4 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -710,1 +710,1 @@\n-        MyValue2[] dst2 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst2 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -712,1 +712,1 @@\n-        MyValue2[] dst4 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n+        MyValue2[] dst4 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, len, MyValue2.DEFAULT);\n@@ -717,4 +717,4 @@\n-            src1[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src2[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src3[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src4[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src1[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src2[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src3[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src4[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -753,1 +753,1 @@\n-        MyValue1[] src2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -783,1 +783,1 @@\n-        MyValue1[] src2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -811,2 +811,2 @@\n-        MyValue1[] src3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n-        MyValue1[] src4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] src4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -814,1 +814,1 @@\n-        MyValue1[] dst2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -816,1 +816,1 @@\n-        MyValue1[] dst4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] dst4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -854,2 +854,2 @@\n-        MyValue2[] src3 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n-        MyValue2[] src4 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src3 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] src4 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -857,1 +857,1 @@\n-        MyValue2[] dst2 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst2 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -859,1 +859,1 @@\n-        MyValue2[] dst4 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n+        MyValue2[] dst4 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 8, MyValue2.DEFAULT);\n@@ -862,4 +862,4 @@\n-            src1[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src2[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src3[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src4[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src1[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src2[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src3[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src4[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -893,2 +893,2 @@\n-        MyValue1[] src3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n-        MyValue1[] src4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -896,1 +896,1 @@\n-        MyValue1[] dst2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -898,1 +898,1 @@\n-        MyValue1[] dst4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -932,2 +932,2 @@\n-        MyValue1[] src3 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n-        MyValue1[] src4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src3 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] src4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -935,1 +935,1 @@\n-        MyValue1[] dst2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -937,1 +937,1 @@\n-        MyValue1[] dst4 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst4 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -966,1 +966,1 @@\n-        failOn = {ALLOC_OF_MYVALUE_KLASS, ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, STORE_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n+            failOn = {ALLOC_OF_MYVALUE_KLASS, ALLOC_ARRAY_OF_MYVALUE_KLASS, LOOP, LOAD_OF_ANY_KLASS, STORE_OF_ANY_KLASS, UNSTABLE_IF_TRAP, PREDICATE_TRAP})\n@@ -970,1 +970,1 @@\n-        MyValue2[] dst = (MyValue2[])src.clone();\n+        MyValue2[] dst = (MyValue2[]) src.clone();\n@@ -994,1 +994,1 @@\n-        MyValue2[] src2 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src2 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -996,2 +996,2 @@\n-            src1[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src2[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src1[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src2[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1013,1 +1013,1 @@\n-        if (flag) { }\n+        if (flag) {}\n@@ -1021,1 +1021,1 @@\n-        MyValue2[] src2 = (MyValue2[])ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n+        MyValue2[] src2 = (MyValue2[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue2.class, 10, MyValue2.DEFAULT);\n@@ -1023,2 +1023,2 @@\n-            src1[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n-            src2[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src1[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n+            src2[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1043,1 +1043,1 @@\n-            src[0] = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+            src[0] = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -1057,1 +1057,1 @@\n-        MyValue2 v2 = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+        MyValue2 v2 = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -1073,1 +1073,1 @@\n-        MyValue1[] va2 = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n+        MyValue1[] va2 = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, len, MyValue1.DEFAULT);\n@@ -1078,2 +1078,2 @@\n-        MyValue1[] result1 = (MyValue1[])test32(va1);\n-        MyValue1[] result2 = (MyValue1[])test32(va2);\n+        MyValue1[] result1 = (MyValue1[]) test32(va1);\n+        MyValue1[] result2 = (MyValue1[]) test32(va2);\n@@ -1085,2 +1085,2 @@\n-            Asserts.assertEQ(((MyValue1)result1[i]).hash(), ((MyValue1)va1[i]).hash());\n-            Asserts.assertEQ(((MyValue1)result2[i]).hash(), ((MyValue1)va2[i]).hash());\n+            Asserts.assertEQ(((MyValue1) result1[i]).hash(), ((MyValue1) va1[i]).hash());\n+            Asserts.assertEQ(((MyValue1) result2[i]).hash(), ((MyValue1) va2[i]).hash());\n@@ -1104,1 +1104,1 @@\n-            Asserts.assertEQ(((MyValue1)result[i]).hash(), ((MyValue1)va[i]).hash());\n+            Asserts.assertEQ(((MyValue1) result[i]).hash(), ((MyValue1) va[i]).hash());\n@@ -1148,1 +1148,1 @@\n-                Asserts.assertEQ(((MyInterface)src[i]).hash(), ((MyInterface)dst[i]).hash());\n+                Asserts.assertEQ(((MyInterface) src[i]).hash(), ((MyInterface) dst[i]).hash());\n@@ -1168,1 +1168,1 @@\n-                Asserts.assertEQ(src[i].hash(), ((MyInterface)dst[i]).hash());\n+                Asserts.assertEQ(src[i].hash(), ((MyInterface) dst[i]).hash());\n@@ -1188,1 +1188,1 @@\n-                Asserts.assertEQ(src[i].hash(), ((MyInterface)dst[i]).hash());\n+                Asserts.assertEQ(src[i].hash(), ((MyInterface) dst[i]).hash());\n@@ -1238,1 +1238,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1259,1 +1259,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1281,1 +1281,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1306,1 +1306,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1328,1 +1328,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1353,1 +1353,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1374,1 +1374,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1415,1 +1415,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1435,1 +1435,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1456,1 +1456,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1480,1 +1480,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1501,1 +1501,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1525,1 +1525,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1545,1 +1545,1 @@\n-            src[i] = MyValue2.createWithFieldsInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsInline(rI + i, rD + i);\n@@ -1651,1 +1651,1 @@\n-   @Test\n+    @Test\n@@ -1691,1 +1691,1 @@\n-        return Arrays.copyOf(va, va.length+1, MyValue1[].class);\n+        return Arrays.copyOf(va, va.length + 1, MyValue1[].class);\n@@ -1698,1 +1698,1 @@\n-        MyValue1[] verif = new MyValue1[len+1];\n+        MyValue1[] verif = new MyValue1[len + 1];\n@@ -1709,1 +1709,1 @@\n-        return Arrays.copyOf(va, va.length+1, klass);\n+        return Arrays.copyOf(va, va.length + 1, klass);\n@@ -1716,1 +1716,1 @@\n-        MyValue1[] verif = new MyValue1[len+1];\n+        MyValue1[] verif = new MyValue1[len + 1];\n@@ -1719,1 +1719,1 @@\n-            verif[i] = (MyValue1)va[i];\n+            verif[i] = (MyValue1) va[i];\n@@ -1727,1 +1727,1 @@\n-        return Arrays.copyOf(va, va.length+1, klass);\n+        return Arrays.copyOf(va, va.length + 1, klass);\n@@ -1757,1 +1757,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1761,1 +1761,1 @@\n-        return Arrays.copyOf(arr, arr.length+1, arr.getClass());\n+        return Arrays.copyOf(arr, arr.length + 1, arr.getClass());\n@@ -1793,1 +1793,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -1797,1 +1797,1 @@\n-        return Arrays.copyOf(arr, arr.length+1, arr.getClass());\n+        return Arrays.copyOf(arr, arr.length + 1, arr.getClass());\n@@ -1804,1 +1804,1 @@\n-        MyValue1[] verif = new MyValue1[len+1];\n+        MyValue1[] verif = new MyValue1[len + 1];\n@@ -1939,1 +1939,1 @@\n-            src[i] = MyValue2.createWithFieldsDontInline(rI+i, rD+i);\n+            src[i] = MyValue2.createWithFieldsDontInline(rI + i, rD + i);\n@@ -1990,1 +1990,1 @@\n-        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI+1, rL+1);\n+        MyValue1 v1 = MyValue1.createWithFieldsDontInline(rI + 1, rL + 1);\n@@ -2018,1 +2018,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -2056,1 +2056,1 @@\n-        for (; i < 10; i++);\n+        for (; i < 10; i++) ;\n@@ -2090,1 +2090,1 @@\n-            result = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+            result = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n@@ -2103,2 +2103,2 @@\n-        MyValue1[] vva = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n-        MyValue1[] vva_r = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+        MyValue1[] vva = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+        MyValue1[] vva_r = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n@@ -2132,1 +2132,1 @@\n-            va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n+            va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 10, MyValue1.DEFAULT);\n@@ -2137,1 +2137,1 @@\n-        long sum = ((MyValue1)va[0]).hashInterpreted();\n+        long sum = ((MyValue1) va[0]).hashInterpreted();\n@@ -2150,1 +2150,1 @@\n-        Asserts.assertEQ(((MyValue1)va[0]).hash(), hash(rI, hash()));\n+        Asserts.assertEQ(((MyValue1) va[0]).hash(), hash(rI, hash()));\n@@ -2152,1 +2152,1 @@\n-            Asserts.assertEQ(((MyValue1)va[i]).hash(), hash());\n+            Asserts.assertEQ(((MyValue1) va[i]).hash(), hash());\n@@ -2156,1 +2156,1 @@\n-        Asserts.assertEQ(((MyValue1)va[0]).hash(), hash(rI + 1, hash(rI, rL) + 1));\n+        Asserts.assertEQ(((MyValue1) va[0]).hash(), hash(rI + 1, hash(rI, rL) + 1));\n@@ -2158,1 +2158,1 @@\n-            Asserts.assertEQ(((MyValue1)va[i]).hash(), hash(rI + i, rL + i));\n+            Asserts.assertEQ(((MyValue1) va[i]).hash(), hash(rI + i, rL + i));\n@@ -2171,1 +2171,1 @@\n-            result = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+            result = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n@@ -2187,2 +2187,2 @@\n-        MyValue1[] vva = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n-        MyValue1[] vva_r = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+        MyValue1[] vva = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+        MyValue1[] vva_r = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n@@ -2219,1 +2219,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2237,1 +2237,1 @@\n-        return (MyValue1[])va;\n+        return (MyValue1[]) va;\n@@ -2242,1 +2242,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2245,1 +2245,1 @@\n-        Asserts.assertEquals(((MyValue1)res[0]).hash(), testValue1.hash());\n+        Asserts.assertEquals(((MyValue1) res[0]).hash(), testValue1.hash());\n@@ -2270,1 +2270,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2297,1 +2297,1 @@\n-            result = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+            result = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2314,1 +2314,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2344,1 +2344,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 42, MyValue1.DEFAULT);\n@@ -2352,2 +2352,2 @@\n-        failOn = {ALLOC_OF_MYVALUE_KLASS, LOOP, UNSTABLE_IF_TRAP, PREDICATE_TRAP},\n-        counts = {STORE_OF_ANY_KLASS, \"= 38\"})\n+            failOn = {ALLOC_OF_MYVALUE_KLASS, LOOP, UNSTABLE_IF_TRAP, PREDICATE_TRAP},\n+            counts = {STORE_OF_ANY_KLASS, \"= 38\"})\n@@ -2355,1 +2355,1 @@\n-        MyValue1[] result = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] result = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2382,1 +2382,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2403,1 +2403,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2443,1 +2443,1 @@\n-        return (MyValue1[])c.cast(va);\n+        return (MyValue1[]) c.cast(va);\n@@ -2448,1 +2448,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2465,1 +2465,1 @@\n-        return (MyValue1[])c.cast(va);\n+        return (MyValue1[]) c.cast(va);\n@@ -2470,1 +2470,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2474,1 +2474,1 @@\n-        Asserts.assertEquals(((MyValue1)res[0]).hash(), testValue1.hash());\n+        Asserts.assertEquals(((MyValue1) res[0]).hash(), testValue1.hash());\n@@ -2485,1 +2485,1 @@\n-        return (MyValue1[])va;\n+        return (MyValue1[]) va;\n@@ -2490,1 +2490,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2493,2 +2493,2 @@\n-          \/\/ Trigger some ClassCastExceptions so C2 does not add an uncommon trap\n-          test90(new NonValueClass[0]);\n+            \/\/ Trigger some ClassCastExceptions so C2 does not add an uncommon trap\n+            test90(new NonValueClass[0]);\n@@ -2496,1 +2496,1 @@\n-          \/\/ Expected\n+            \/\/ Expected\n@@ -2505,1 +2505,1 @@\n-        return (MyValue1[])va;\n+        return (MyValue1[]) va;\n@@ -2510,1 +2510,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2513,2 +2513,2 @@\n-          \/\/ Trigger some ClassCastExceptions so C2 does not add an uncommon trap\n-          test91(new NonValueClass[0]);\n+            \/\/ Trigger some ClassCastExceptions so C2 does not add an uncommon trap\n+            test91(new NonValueClass[0]);\n@@ -2516,1 +2516,1 @@\n-          \/\/ Expected\n+            \/\/ Expected\n@@ -2531,1 +2531,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2547,1 +2547,1 @@\n-        MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n+        MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 2, MyValue1.DEFAULT);\n@@ -2561,1 +2561,1 @@\n-        MyValue1[] dst = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n+        MyValue1[] dst = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 8, MyValue1.DEFAULT);\n@@ -2596,1 +2596,2 @@\n-    static value class Complex {\n+    static value\n+    class Complex {\n@@ -2611,1 +2612,1 @@\n-                               this.re * that.im + this.im * that.re);\n+                    this.re * that.im + this.im * that.re);\n@@ -2623,1 +2624,1 @@\n-                    R[i][j] = B[i][j].add(aik.mul((Complex)B[k][j]));\n+                    R[i][j] = B[i][j].add(aik.mul((Complex) B[k][j]));\n@@ -2671,1 +2672,1 @@\n-        result = test97((Object[])myInt);\n+        result = test97((Object[]) myInt);\n@@ -2688,1 +2689,1 @@\n-        result = test98((Object[])myInt);\n+        result = test98((Object[]) myInt);\n@@ -2691,1 +2692,1 @@\n-            MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2693,3 +2694,3 @@\n-            result = test98((Object[])va);\n-            Asserts.assertEquals(((MyValue1)result).hash(), MyValue1.createDefaultInline().hash());\n-            result = test98((Object[])vab);\n+            result = test98((Object[]) va);\n+            Asserts.assertEquals(((MyValue1) result).hash(), MyValue1.createDefaultInline().hash());\n+            result = test98((Object[]) vab);\n@@ -2713,1 +2714,1 @@\n-        result = test99((Object[])myInt);\n+        result = test99((Object[]) myInt);\n@@ -2717,1 +2718,1 @@\n-                test99((Object[])null);\n+                test99((Object[]) null);\n@@ -2738,1 +2739,1 @@\n-        result = test100((Object[])myInt);\n+        result = test100((Object[]) myInt);\n@@ -2763,1 +2764,1 @@\n-        test101(otherObj, (Object[])myInt);\n+        test101(otherObj, (Object[]) myInt);\n@@ -2765,1 +2766,1 @@\n-        test101(null, (Object[])myInt);\n+        test101(null, (Object[]) myInt);\n@@ -2780,1 +2781,1 @@\n-        test102(otherObj, (Object[])myInt);\n+        test102(otherObj, (Object[]) myInt);\n@@ -2782,1 +2783,1 @@\n-        test102(null, (Object[])myInt);\n+        test102(null, (Object[]) myInt);\n@@ -2785,1 +2786,1 @@\n-            MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2787,1 +2788,1 @@\n-            test102(testValue1, (Object[])va);\n+            test102(testValue1, (Object[]) va);\n@@ -2789,1 +2790,1 @@\n-            test102(testValue1, (Object[])vab);\n+            test102(testValue1, (Object[]) vab);\n@@ -2791,1 +2792,1 @@\n-            test102(null, (Object[])vab);\n+            test102(null, (Object[]) vab);\n@@ -2807,1 +2808,1 @@\n-        test103(otherObj, (Object[])myInt);\n+        test103(otherObj, (Object[]) myInt);\n@@ -2809,1 +2810,1 @@\n-        test103(null, (Object[])myInt);\n+        test103(null, (Object[]) myInt);\n@@ -2812,1 +2813,1 @@\n-            MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2814,1 +2815,1 @@\n-                test103(null, (Object[])va);\n+                test103(null, (Object[]) va);\n@@ -2833,1 +2834,1 @@\n-        test104(otherObj, (Object[])myInt);\n+        test104(otherObj, (Object[]) myInt);\n@@ -2835,1 +2836,1 @@\n-        test104(null, (Object[])myInt);\n+        test104(null, (Object[]) myInt);\n@@ -2858,1 +2859,1 @@\n-        test105(otherObj, (Object[])myInt);\n+        test105(otherObj, (Object[]) myInt);\n@@ -2860,1 +2861,1 @@\n-        test105(null, (Object[])myInt);\n+        test105(null, (Object[]) myInt);\n@@ -2864,1 +2865,1 @@\n-                test105(testValue1, (Object[])null);\n+                test105(testValue1, (Object[]) null);\n@@ -2896,1 +2897,1 @@\n-        result = test106(myInt, (Object[])myInt);\n+        result = test106(myInt, (Object[]) myInt);\n@@ -2899,1 +2900,1 @@\n-            MyValue1[] va = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+            MyValue1[] va = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2901,4 +2902,4 @@\n-            result = test106(va, (Object[])va);\n-            Asserts.assertEquals(((MyValue1)result[0]).hash(), MyValue1.createDefaultInline().hash());\n-            result = test106(vab, (Object[])vab);\n-            Asserts.assertEquals(((MyValue1)result[0]).hash(), testValue1.hash());\n+            result = test106(va, (Object[]) va);\n+            Asserts.assertEquals(((MyValue1) result[0]).hash(), MyValue1.createDefaultInline().hash());\n+            result = test106(vab, (Object[]) vab);\n+            Asserts.assertEquals(((MyValue1) result[0]).hash(), testValue1.hash());\n@@ -2954,1 +2955,1 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2969,1 +2970,1 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2984,1 +2985,1 @@\n-        MyValue1[] src = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+        MyValue1[] src = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -2996,1 +2997,1 @@\n-    static final MyValue1[] flatArray = (MyValue1[])ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n+    static final MyValue1[] flatArray = (MyValue1[]) ValueClass.newNullRestrictedNonAtomicArray(MyValue1.class, 1, MyValue1.DEFAULT);\n@@ -3011,1 +3012,1 @@\n-        refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3039,1 +3040,1 @@\n-        refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3065,1 +3066,1 @@\n-        refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3091,1 +3092,1 @@\n-        refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3103,1 +3104,1 @@\n-            refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+            refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3124,1 +3125,1 @@\n-        refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3130,1 +3131,1 @@\n-            refArray[0] = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+            refArray[0] = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3219,2 +3220,2 @@\n-        failOn = {ALLOC},\n-        counts = {STORE_OF_ANY_KLASS, \"= 19\"})\n+            failOn = {ALLOC},\n+            counts = {STORE_OF_ANY_KLASS, \"= 19\"})\n@@ -3231,1 +3232,1 @@\n-        flatArray[0] = (MyValue1)o;\n+        flatArray[0] = (MyValue1) o;\n@@ -3237,1 +3238,1 @@\n-        MyValue1 vt = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        MyValue1 vt = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3252,2 +3253,2 @@\n-        failOn = {ALLOC},\n-        counts = {STORE_OF_ANY_KLASS, \"= 19\"})\n+            failOn = {ALLOC},\n+            counts = {STORE_OF_ANY_KLASS, \"= 19\"})\n@@ -3264,1 +3265,1 @@\n-        flatArray[0] = (MyValue1)o;\n+        flatArray[0] = (MyValue1) o;\n@@ -3272,1 +3273,1 @@\n-        MyValue1 vt = MyValue1.createWithFieldsInline(rI+1, rL+1);\n+        MyValue1 vt = MyValue1.createWithFieldsInline(rI + 1, rL + 1);\n@@ -3298,1 +3299,1 @@\n-        return ((MyValue1)res).hash();\n+        return ((MyValue1) res).hash();\n@@ -3323,1 +3324,1 @@\n-            res = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+            res = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -3331,1 +3332,1 @@\n-        return ((MyValue2)res).hash();\n+        return ((MyValue2) res).hash();\n@@ -3338,1 +3339,1 @@\n-        MyValue2 val2 = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+        MyValue2 val2 = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -3356,1 +3357,1 @@\n-            res[0] = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+            res[0] = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -3360,1 +3361,1 @@\n-        val = ((MyValue2)res[0]);\n+        val = ((MyValue2) res[0]);\n@@ -3372,1 +3373,1 @@\n-        MyValue2 val2 = MyValue2.createWithFieldsInline(rI+1, rD+1);\n+        MyValue2 val2 = MyValue2.createWithFieldsInline(rI + 1, rD + 1);\n@@ -3382,1 +3383,2 @@\n-    static value class MyValue126  {\n+    static value\n+    class MyValue126 {\n@@ -3410,1 +3412,1 @@\n-        oFld = (MyValue126)array[i];\n+        oFld = (MyValue126) array[i];\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestNullableArrays.java","additions":207,"deletions":205,"binary":false,"changes":412,"status":"modified"},{"patch":"@@ -209,1 +209,2 @@\n-value class MyValueTearing {\n+value\n+class MyValueTearing {\n@@ -228,1 +229,1 @@\n-    static final MyValueTearing DEFAULT = new MyValueTearing((short)0, (short)0);\n+    static final MyValueTearing DEFAULT = new MyValueTearing((short) 0, (short) 0);\n@@ -237,1 +238,1 @@\n-        return new MyValueTearing((short)(x + 1), (short)(y + 1));\n+        return new MyValueTearing((short) (x + 1), (short) (y + 1));\n@@ -243,2 +244,2 @@\n-        U.putShort(vt, X_OFFSET, (short)(x + 1));\n-        U.putShort(vt, Y_OFFSET, (short)(y + 1));\n+        U.putShort(vt, X_OFFSET, (short) (x + 1));\n+        U.putShort(vt, Y_OFFSET, (short) (y + 1));\n@@ -252,5 +253,5 @@\n-        (WHITE_BOX.getIntxVMFlag(\"TieredStopAtLevel\").intValue() < 4) ||\n-         WHITE_BOX.getBooleanVMFlag(\"SafepointALot\") ||\n-         WHITE_BOX.getBooleanVMFlag(\"DeoptimizeALot\") ||\n-         WHITE_BOX.getBooleanVMFlag(\"DeoptimizeNMethodBarriersALot\") ||\n-        !WHITE_BOX.getBooleanVMFlag(\"UseTLAB\");\n+            (WHITE_BOX.getIntxVMFlag(\"TieredStopAtLevel\").intValue() < 4) ||\n+                    WHITE_BOX.getBooleanVMFlag(\"SafepointALot\") ||\n+                    WHITE_BOX.getBooleanVMFlag(\"DeoptimizeALot\") ||\n+                    WHITE_BOX.getBooleanVMFlag(\"DeoptimizeNMethodBarriersALot\") ||\n+                    !WHITE_BOX.getBooleanVMFlag(\"UseTLAB\");\n@@ -267,2 +268,2 @@\n-    static MyValueTearing field3 = new MyValueTearing((short)0, (short)0);\n-    MyValueTearing field4 = new MyValueTearing((short)0, (short)0);\n+    static MyValueTearing field3 = new MyValueTearing((short) 0, (short) 0);\n+    MyValueTearing field4 = new MyValueTearing((short) 0, (short) 0);\n@@ -271,2 +272,2 @@\n-    static final MyValueTearing[] array1 = (MyValueTearing[])ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n-    static final MyValueTearing[] array2 = (MyValueTearing[])ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n+    static final MyValueTearing[] array1 = (MyValueTearing[]) ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n+    static final MyValueTearing[] array2 = (MyValueTearing[]) ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n@@ -274,1 +275,1 @@\n-        array2[0] = new MyValueTearing((short)0, (short)0);\n+        array2[0] = new MyValueTearing((short) 0, (short) 0);\n@@ -276,1 +277,1 @@\n-    static final MyValueTearing[] array3 = new MyValueTearing[] { new MyValueTearing((short)0, (short)0) };\n+    static final MyValueTearing[] array3 = new MyValueTearing[]{new MyValueTearing((short) 0, (short) 0)};\n@@ -279,2 +280,2 @@\n-    static MyValueTearing[] array4 = (MyValueTearing[])ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n-    static MyValueTearing[] array5 = (MyValueTearing[])ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n+    static MyValueTearing[] array4 = (MyValueTearing[]) ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n+    static MyValueTearing[] array5 = (MyValueTearing[]) ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n@@ -282,1 +283,1 @@\n-        array5[0] = new MyValueTearing((short)0, (short)0);\n+        array5[0] = new MyValueTearing((short) 0, (short) 0);\n@@ -284,1 +285,1 @@\n-    static MyValueTearing[] array6 = new MyValueTearing[] { new MyValueTearing((short)0, (short)0) };\n+    static MyValueTearing[] array6 = new MyValueTearing[]{new MyValueTearing((short) 0, (short) 0)};\n@@ -287,2 +288,2 @@\n-    static Object[] array7 = (MyValueTearing[])ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n-    static Object[] array8 = (MyValueTearing[])ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n+    static Object[] array7 = (MyValueTearing[]) ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n+    static Object[] array8 = (MyValueTearing[]) ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n@@ -290,1 +291,1 @@\n-        array8[0] = new MyValueTearing((short)0, (short)0);\n+        array8[0] = new MyValueTearing((short) 0, (short) 0);\n@@ -292,1 +293,1 @@\n-    static Object[] array9 = new MyValueTearing[] { new MyValueTearing((short)0, (short)0) };\n+    static Object[] array9 = new MyValueTearing[]{new MyValueTearing((short) 0, (short) 0)};\n@@ -295,2 +296,2 @@\n-    static volatile Object[] array10 = (MyValueTearing[])ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n-    static volatile Object[] array11 = (MyValueTearing[])ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n+    static volatile Object[] array10 = (MyValueTearing[]) ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n+    static volatile Object[] array11 = (MyValueTearing[]) ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n@@ -298,1 +299,1 @@\n-        array11[0] = new MyValueTearing((short)0, (short)0);\n+        array11[0] = new MyValueTearing((short) 0, (short) 0);\n@@ -300,1 +301,1 @@\n-    static volatile Object[] array12 = new MyValueTearing[] { new MyValueTearing((short)0, (short)0) };\n+    static volatile Object[] array12 = new MyValueTearing[]{new MyValueTearing((short) 0, (short) 0)};\n@@ -329,4 +330,4 @@\n-                MyValueTearing[] localArray1 = (MyValueTearing[])ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n-                MyValueTearing[] localArray2 = (MyValueTearing[])ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n-                localArray2[0] = new MyValueTearing((short)0, (short)0);\n-                MyValueTearing[] localArray3 = new MyValueTearing[] { new MyValueTearing((short)0, (short)0) };\n+                MyValueTearing[] localArray1 = (MyValueTearing[]) ValueClass.newNullRestrictedAtomicArray(MyValueTearing.class, 1, MyValueTearing.DEFAULT);\n+                MyValueTearing[] localArray2 = (MyValueTearing[]) ValueClass.newNullableAtomicArray(MyValueTearing.class, 1);\n+                localArray2[0] = new MyValueTearing((short) 0, (short) 0);\n+                MyValueTearing[] localArray3 = new MyValueTearing[]{new MyValueTearing((short) 0, (short) 0)};\n@@ -360,6 +361,6 @@\n-                array7[0] = ((MyValueTearing)array7[0]).incrementAndCheck();\n-                array8[0] = ((MyValueTearing)array8[0]).incrementAndCheck();\n-                array9[0] = ((MyValueTearing)array9[0]).incrementAndCheck();\n-                array10[0] = ((MyValueTearing)array10[0]).incrementAndCheck();\n-                array11[0] = ((MyValueTearing)array11[0]).incrementAndCheck();\n-                array12[0] = ((MyValueTearing)array12[0]).incrementAndCheck();\n+                array7[0] = ((MyValueTearing) array7[0]).incrementAndCheck();\n+                array8[0] = ((MyValueTearing) array8[0]).incrementAndCheck();\n+                array9[0] = ((MyValueTearing) array9[0]).incrementAndCheck();\n+                array10[0] = ((MyValueTearing) array10[0]).incrementAndCheck();\n+                array11[0] = ((MyValueTearing) array11[0]).incrementAndCheck();\n+                array12[0] = ((MyValueTearing) array12[0]).incrementAndCheck();\n@@ -377,6 +378,6 @@\n-                array7[0] = ((MyValueTearing)array7[0]).incrementAndCheckUnsafe();\n-                array8[0] = ((MyValueTearing)array8[0]).incrementAndCheckUnsafe();\n-                array9[0] = ((MyValueTearing)array9[0]).incrementAndCheckUnsafe();\n-                array10[0] = ((MyValueTearing)array10[0]).incrementAndCheckUnsafe();\n-                array11[0] = ((MyValueTearing)array11[0]).incrementAndCheckUnsafe();\n-                array12[0] = ((MyValueTearing)array12[0]).incrementAndCheckUnsafe();\n+                array7[0] = ((MyValueTearing) array7[0]).incrementAndCheckUnsafe();\n+                array8[0] = ((MyValueTearing) array8[0]).incrementAndCheckUnsafe();\n+                array9[0] = ((MyValueTearing) array9[0]).incrementAndCheckUnsafe();\n+                array10[0] = ((MyValueTearing) array10[0]).incrementAndCheckUnsafe();\n+                array11[0] = ((MyValueTearing) array11[0]).incrementAndCheckUnsafe();\n+                array12[0] = ((MyValueTearing) array12[0]).incrementAndCheckUnsafe();\n@@ -385,16 +386,16 @@\n-                    test.field1 = (MyValueTearing)incrementAndCheck_mh.invokeExact(test.field1);\n-                    test.field2 = (MyValueTearing)incrementAndCheck_mh.invokeExact(test.field2);\n-                    test.field3 = (MyValueTearing)incrementAndCheck_mh.invokeExact(test.field1);\n-                    test.field4 = (MyValueTearing)incrementAndCheck_mh.invokeExact(test.field2);\n-                    array1[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array1[0]);\n-                    array2[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array2[0]);\n-                    array3[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array3[0]);\n-                    array4[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array4[0]);\n-                    array5[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array5[0]);\n-                    array6[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact(array6[0]);\n-                    array7[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array7[0]);\n-                    array8[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array8[0]);\n-                    array9[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array9[0]);\n-                    array10[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array10[0]);\n-                    array11[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array11[0]);\n-                    array12[0] = (MyValueTearing)incrementAndCheck_mh.invokeExact((MyValueTearing)array12[0]);\n+                    test.field1 = (MyValueTearing) incrementAndCheck_mh.invokeExact(test.field1);\n+                    test.field2 = (MyValueTearing) incrementAndCheck_mh.invokeExact(test.field2);\n+                    test.field3 = (MyValueTearing) incrementAndCheck_mh.invokeExact(test.field1);\n+                    test.field4 = (MyValueTearing) incrementAndCheck_mh.invokeExact(test.field2);\n+                    array1[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array1[0]);\n+                    array2[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array2[0]);\n+                    array3[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array3[0]);\n+                    array4[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array4[0]);\n+                    array5[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array5[0]);\n+                    array6[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact(array6[0]);\n+                    array7[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array7[0]);\n+                    array8[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array8[0]);\n+                    array9[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array9[0]);\n+                    array10[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array10[0]);\n+                    array11[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array11[0]);\n+                    array12[0] = (MyValueTearing) incrementAndCheck_mh.invokeExact((MyValueTearing) array12[0]);\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestTearing.java","additions":61,"deletions":60,"binary":false,"changes":121,"status":"modified"},{"patch":"@@ -228,1 +228,2 @@\n-    static value class SmallValue {\n+    static value\n+    class SmallValue {\n@@ -259,1 +260,2 @@\n-    static value class LargeValue {\n+    static value\n+    class LargeValue {\n@@ -280,1 +282,1 @@\n-                   \", x6 = \" + x6 + \", x7 = \" + x7;\n+                    \", x6 = \" + x6 + \", x7 = \" + x7;\n@@ -285,1 +287,1 @@\n-                x6 != i || x7 != i) {\n+                    x6 != i || x7 != i) {\n@@ -302,1 +304,2 @@\n-    static value class LargeValue2 {\n+    static value\n+    class LargeValue2 {\n@@ -311,2 +314,2 @@\n-            this.x1 = (byte)i;\n-            this.x2 = (short)i;\n+            this.x1 = (byte) i;\n+            this.x2 = (short) i;\n@@ -321,1 +324,1 @@\n-                   \", x6 = \" + x6;\n+                    \", x6 = \" + x6;\n@@ -325,2 +328,2 @@\n-            if (x1 != (byte)i || x2 != (short)i || x3 != i || x4 != i || x5 != i ||\n-                x6 != ((i % 2) == 0)) {\n+            if (x1 != (byte) i || x2 != (short) i || x3 != i || x4 != i || x5 != i ||\n+                    x6 != ((i % 2) == 0)) {\n@@ -343,1 +346,2 @@\n-    static value class LargeValueWithOops {\n+    static value\n+    class LargeValueWithOops {\n@@ -379,1 +383,2 @@\n-    public static value class DoubleValue {\n+    public static value\n+    class DoubleValue {\n@@ -399,1 +404,1 @@\n-                    throw new RuntimeException(\"Incorrect result at \" + loc + \" for d = \" + d+ \": \" + val);\n+                    throw new RuntimeException(\"Incorrect result at \" + loc + \" for d = \" + d + \": \" + val);\n@@ -407,1 +412,2 @@\n-    public static value class DoubleValue2 {\n+    public static value\n+    class DoubleValue2 {\n@@ -427,1 +433,1 @@\n-            if (this.d1 != d || this.d2 != (d+1) || this.d3 != (d+2) || this.d4 != (d+3) || this.d5 != (d+4)) {\n+            if (this.d1 != d || this.d2 != (d + 1) || this.d3 != (d + 2) || this.d4 != (d + 3) || this.d5 != (d + 4)) {\n@@ -443,1 +449,2 @@\n-    static abstract value class BaseValue {\n+    static abstract value\n+    class BaseValue {\n@@ -447,1 +454,2 @@\n-    static value class ValueExtendsAbstract extends BaseValue {\n+    static value\n+    class ValueExtendsAbstract extends BaseValue {\n@@ -468,1 +476,1 @@\n-                   \", x6 = \" + x6 + \", x7 = \" + x7;\n+                    \", x6 = \" + x6 + \", x7 = \" + x7;\n@@ -473,1 +481,1 @@\n-                x6 != i || x7 != i) {\n+                    x6 != i || x7 != i) {\n@@ -479,1 +487,1 @@\n-    public static void dontInline() { }\n+    public static void dontInline() {}\n@@ -733,1 +741,1 @@\n-            for (;;) {\n+            for (; ; ) {\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestVirtualThreads.java","additions":29,"deletions":21,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -0,0 +1,136 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\n+import jdk.internal.jimage.ImageLocation;\n+import jdk.internal.jimage.ModuleReference;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.ValueSource;\n+\n+import java.util.List;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+\/*\n+ * @test\n+ * @summary Tests for ImageLocation.\n+ * @modules java.base\/jdk.internal.jimage\n+ * @run junit\/othervm -esa -DDISABLE_PREVIEW_PATCHING=false ImageLocationTest\n+ *\/\n+public class ImageLocationTest {\n+\n+    @ParameterizedTest\n+    @ValueSource(strings = {\n+            \"\/modules\/modfoo\/com\",\n+            \"\/modules\/modfoo\/com\/foo\/Foo.class\"})\n+    public void getFlags_resourceNames(String name) {\n+        String previewName = previewName(name);\n+\n+        int noPreviewFlags =\n+                ImageLocation.getFlags(name, Set.of(name)::contains);\n+        assertEquals(0, noPreviewFlags);\n+        assertFalse(ImageLocation.hasPreviewVersion(noPreviewFlags));\n+        assertFalse(ImageLocation.isPreviewOnly(noPreviewFlags));\n+\n+        int withPreviewFlags =\n+                ImageLocation.getFlags(name, Set.of(name, previewName)::contains);\n+        assertTrue(ImageLocation.hasPreviewVersion(withPreviewFlags));\n+        assertFalse(ImageLocation.isPreviewOnly(withPreviewFlags));\n+\n+        int previewOnlyFlags = ImageLocation.getFlags(previewName, Set.of(previewName)::contains);\n+        assertFalse(ImageLocation.hasPreviewVersion(previewOnlyFlags));\n+        assertTrue(ImageLocation.isPreviewOnly(previewOnlyFlags));\n+    }\n+\n+    @ParameterizedTest\n+    @ValueSource(strings = {\n+            \"\/modules\",\n+            \"\/packages\",\n+            \"\/modules\/modfoo\",\n+            \"\/modules\/modfoo\/META-INF\",\n+            \"\/modules\/modfoo\/META-INF\/module-info.class\"})\n+    public void getFlags_zero(String name) {\n+        assertEquals(0, ImageLocation.getFlags(name, Set.of(name)::contains));\n+    }\n+\n+    @Test\n+    public void getFlags_packageFlags() {\n+        assertThrows(\n+                IllegalArgumentException.class,\n+                () -> ImageLocation.getFlags(\"\/packages\/pkgname\", p -> true));\n+    }\n+\n+    @Test\n+    public void getPackageFlags_noPreview() {\n+        List<ModuleReference> refs = List.of(\n+                ModuleReference.forPackage(\"modfoo\", false),\n+                ModuleReference.forEmptyPackage(\"modbar\", false),\n+                ModuleReference.forEmptyPackage(\"modbaz\", false));\n+        int noPreviewFlags = ImageLocation.getPackageFlags(refs);\n+        assertEquals(0, noPreviewFlags);\n+        assertFalse(ImageLocation.hasPreviewVersion(noPreviewFlags));\n+        assertFalse(ImageLocation.isPreviewOnly(noPreviewFlags));\n+    }\n+\n+    @Test\n+    public void getPackageFlags_withPreview() {\n+        List<ModuleReference> refs = List.of(\n+                ModuleReference.forPackage(\"modfoo\", true),\n+                ModuleReference.forEmptyPackage(\"modbar\", false),\n+                ModuleReference.forEmptyPackage(\"modbaz\", true));\n+        int withPreviewFlags = ImageLocation.getPackageFlags(refs);\n+        assertTrue(ImageLocation.hasPreviewVersion(withPreviewFlags));\n+        assertFalse(ImageLocation.isPreviewOnly(withPreviewFlags));\n+    }\n+\n+    @Test\n+    public void getPackageFlags_previewOnly() {\n+        List<ModuleReference> refs = List.of(\n+                ModuleReference.forPackage(\"modfoo\", true),\n+                ModuleReference.forEmptyPackage(\"modbar\", true),\n+                ModuleReference.forEmptyPackage(\"modbaz\", true));\n+        int previewOnlyFlags = ImageLocation.getPackageFlags(refs);\n+        \/\/ Note the asymmetry between this and the getFlags() case. Unlike\n+        \/\/ module resources, there is no concept of a separate package directory\n+        \/\/ existing in the preview namespace, so a single entry serves both\n+        \/\/ purposes, and hasPreviewVersion() and isPreviewOnly() can both be set.\n+        assertTrue(ImageLocation.hasPreviewVersion(previewOnlyFlags));\n+        assertTrue(ImageLocation.isPreviewOnly(previewOnlyFlags));\n+    }\n+\n+    private static final Pattern MODULES_PATH = Pattern.compile(\"\/modules\/([^\/]+)\/(.+)\");\n+\n+    private static String previewName(String name) {\n+        var m = MODULES_PATH.matcher(name);\n+        if (m.matches() && !m.group(2).startsWith(\"\/META-INF\/preview\/\")) {\n+            return \"\/modules\/\" + m.group(1) + \"\/META-INF\/preview\/\" + m.group(2);\n+        }\n+        throw new IllegalStateException(\"Invalid modules name: \" + name);\n+    }\n+}\n","filename":"test\/jdk\/jdk\/internal\/jimage\/ImageLocationTest.java","additions":136,"deletions":0,"binary":false,"changes":136,"status":"added"},{"patch":"@@ -47,0 +47,1 @@\n+import static java.util.stream.Collectors.toSet;\n@@ -67,1 +68,1 @@\n- * @run junit\/othervm ImageReaderTest\n+ * @run junit\/othervm -esa -DDISABLE_PREVIEW_PATCHING=false ImageReaderTest\n@@ -74,1 +75,2 @@\n-\n+    \/\/ The '@' prefix marks the entry as a preview entry which will be placed in\n+    \/\/ the '\/modules\/<module>\/META-INF\/preview\/...' namespace.\n@@ -77,3 +79,7 @@\n-                    \"com.foo.Alpha\",\n-                    \"com.foo.Beta\",\n-                    \"com.foo.bar.Gamma\"),\n+                    \"com.foo.HasPreviewVersion\",\n+                    \"com.foo.NormalFoo\",\n+                    \"com.foo.bar.NormalBar\",\n+                    \/\/ Replaces original class in preview mode.\n+                    \"@com.foo.HasPreviewVersion\",\n+                    \/\/ New class in existing package in preview mode.\n+                    \"@com.foo.bar.IsPreviewOnly\"),\n@@ -82,1 +88,7 @@\n-                    \"com.bar.Two\"));\n+                    \"com.bar.Two\",\n+                    \/\/ Two new packages in preview mode (new symbolic links).\n+                    \"@com.bar.preview.stuff.Foo\",\n+                    \"@com.bar.preview.stuff.Bar\"),\n+            \"modgus\", Arrays.asList(\n+                    \/\/ A second module with a preview-only empty package (preview).\n+                    \"@com.bar.preview.other.Gus\"));\n@@ -118,1 +130,1 @@\n-            assertNode(reader, \"\/modules\/modfoo\/com\/foo\/Alpha.class\");\n+            assertNode(reader, \"\/modules\/modfoo\/com\/foo\/HasPreviewVersion.class\");\n@@ -122,3 +134,3 @@\n-            assertEquals(\"Class: com.foo.Alpha\", loader.loadAndGetToString(\"modfoo\", \"com.foo.Alpha\"));\n-            assertEquals(\"Class: com.foo.Beta\", loader.loadAndGetToString(\"modfoo\", \"com.foo.Beta\"));\n-            assertEquals(\"Class: com.foo.bar.Gamma\", loader.loadAndGetToString(\"modfoo\", \"com.foo.bar.Gamma\"));\n+            assertEquals(\"Class: com.foo.HasPreviewVersion\", loader.loadAndGetToString(\"modfoo\", \"com.foo.HasPreviewVersion\"));\n+            assertEquals(\"Class: com.foo.NormalFoo\", loader.loadAndGetToString(\"modfoo\", \"com.foo.NormalFoo\"));\n+            assertEquals(\"Class: com.foo.bar.NormalBar\", loader.loadAndGetToString(\"modfoo\", \"com.foo.bar.NormalBar\"));\n@@ -131,1 +143,1 @@\n-            \"modfoo:com\/foo\/Alpha.class\",\n+            \"modfoo:com\/foo\/HasPreviewVersion.class\",\n@@ -151,1 +163,1 @@\n-            \"modbar:com\/foo\/Alpha.class\",\n+            \"modbar:com\/foo\/HasPreviewVersion.class\",\n@@ -156,1 +168,1 @@\n-            \"modules:modfoo\/com\/foo\/Alpha.class\",\n+            \"modules:modfoo\/com\/foo\/HasPreviewVersion.class\",\n@@ -159,1 +171,1 @@\n-            \"'':modfoo\/com\/foo\/Alpha.class\",\n+            \"'':modfoo\/com\/foo\/HasPreviewVersion.class\",\n@@ -179,1 +191,1 @@\n-            \"modules\/modfoo\/com:foo\/Alpha.class\",\n+            \"modules\/modfoo\/com:foo\/HasPreviewVersion.class\",\n@@ -192,1 +204,1 @@\n-            Set<String> pkgNames = root.getChildNames().collect(Collectors.toSet());\n+            Set<String> pkgNames = root.getChildNames().collect(toSet());\n@@ -215,0 +227,117 @@\n+    @Test\n+    public void testPreviewResources_disabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.DISABLED)) {\n+            ImageClassLoader loader = new ImageClassLoader(reader, IMAGE_ENTRIES.keySet());\n+\n+            \/\/ No preview classes visible.\n+            assertEquals(\"Class: com.foo.HasPreviewVersion\", loader.loadAndGetToString(\"modfoo\", \"com.foo.HasPreviewVersion\"));\n+            assertEquals(\"Class: com.foo.NormalFoo\", loader.loadAndGetToString(\"modfoo\", \"com.foo.NormalFoo\"));\n+            assertEquals(\"Class: com.foo.bar.NormalBar\", loader.loadAndGetToString(\"modfoo\", \"com.foo.bar.NormalBar\"));\n+\n+            \/\/ NormalBar exists but IsPreviewOnly doesn't.\n+            assertResource(reader, \"modfoo\", \"com\/foo\/bar\/NormalBar.class\");\n+            assertAbsent(reader, \"\/modules\/modfoo\/com\/foo\/bar\/IsPreviewOnly.class\");\n+            assertDirContents(reader, \"\/modules\/modfoo\/com\/foo\", \"HasPreviewVersion.class\", \"NormalFoo.class\", \"bar\");\n+            assertDirContents(reader, \"\/modules\/modfoo\/com\/foo\/bar\", \"NormalBar.class\");\n+        }\n+    }\n+\n+    @Test\n+    public void testPreviewResources_enabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.ENABLED)) {\n+            ImageClassLoader loader = new ImageClassLoader(reader, IMAGE_ENTRIES.keySet());\n+\n+            \/\/ Preview version of classes either overwrite existing entries or are added to directories.\n+            assertEquals(\"Preview: com.foo.HasPreviewVersion\", loader.loadAndGetToString(\"modfoo\", \"com.foo.HasPreviewVersion\"));\n+            assertEquals(\"Class: com.foo.NormalFoo\", loader.loadAndGetToString(\"modfoo\", \"com.foo.NormalFoo\"));\n+            assertEquals(\"Class: com.foo.bar.NormalBar\", loader.loadAndGetToString(\"modfoo\", \"com.foo.bar.NormalBar\"));\n+            assertEquals(\"Preview: com.foo.bar.IsPreviewOnly\", loader.loadAndGetToString(\"modfoo\", \"com.foo.bar.IsPreviewOnly\"));\n+\n+            \/\/ Both NormalBar and IsPreviewOnly exist (direct lookup and as child nodes).\n+            assertResource(reader, \"modfoo\", \"com\/foo\/bar\/NormalBar.class\");\n+            assertResource(reader, \"modfoo\", \"com\/foo\/bar\/IsPreviewOnly.class\");\n+            assertDirContents(reader, \"\/modules\/modfoo\/com\/foo\", \"HasPreviewVersion.class\", \"NormalFoo.class\", \"bar\");\n+            assertDirContents(reader, \"\/modules\/modfoo\/com\/foo\/bar\", \"NormalBar.class\", \"IsPreviewOnly.class\");\n+        }\n+    }\n+\n+    @Test\n+    public void testPreviewOnlyPackages_disabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.DISABLED)) {\n+            ImageClassLoader loader = new ImageClassLoader(reader, IMAGE_ENTRIES.keySet());\n+\n+            \/\/ No 'preview' package or anything inside it.\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\", \"One.class\", \"Two.class\");\n+            assertAbsent(reader, \"\/modules\/modbar\/com\/bar\/preview\");\n+            assertAbsent(reader, \"\/modules\/modbar\/com\/bar\/preview\/stuff\/Foo.class\");\n+\n+            \/\/ And no package link.\n+            assertAbsent(reader, \"\/packages\/com.bar.preview\");\n+        }\n+    }\n+\n+    @Test\n+    public void testPreviewOnlyPackages_enabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.ENABLED)) {\n+            ImageClassLoader loader = new ImageClassLoader(reader, IMAGE_ENTRIES.keySet());\n+\n+            \/\/ In preview mode 'preview' package exists with preview only content.\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\", \"One.class\", \"Two.class\", \"preview\");\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\/preview\/stuff\", \"Foo.class\", \"Bar.class\");\n+            assertResource(reader, \"modbar\", \"com\/bar\/preview\/stuff\/Foo.class\");\n+\n+            \/\/ And package links exists.\n+            assertDirContents(reader, \"\/packages\/com.bar.preview\", \"modbar\", \"modgus\");\n+        }\n+    }\n+\n+    @Test\n+    public void testPreviewModeLinks_disabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.DISABLED)) {\n+            assertDirContents(reader, \"\/packages\/com.bar\", \"modbar\");\n+            \/\/ Missing symbolic link and directory when not in preview mode.\n+            assertAbsent(reader, \"\/packages\/com.bar.preview\");\n+            assertAbsent(reader, \"\/packages\/com.bar.preview.stuff\");\n+            assertAbsent(reader, \"\/modules\/modbar\/com\/bar\/preview\");\n+            assertAbsent(reader, \"\/modules\/modbar\/com\/bar\/preview\/stuff\");\n+        }\n+    }\n+\n+    @Test\n+    public void testPreviewModeLinks_enabled() throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, PreviewMode.ENABLED)) {\n+            \/\/ In preview mode there is a new preview-only module visible.\n+            assertDirContents(reader, \"\/packages\/com.bar\", \"modbar\", \"modgus\");\n+            \/\/ And additional packages are present.\n+            assertDirContents(reader, \"\/packages\/com.bar.preview\", \"modbar\", \"modgus\");\n+            assertDirContents(reader, \"\/packages\/com.bar.preview.stuff\", \"modbar\");\n+            assertDirContents(reader, \"\/packages\/com.bar.preview.other\", \"modgus\");\n+            \/\/ And the preview-only content appears as we expect.\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\", \"One.class\", \"Two.class\", \"preview\");\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\/preview\", \"stuff\");\n+            assertDirContents(reader, \"\/modules\/modbar\/com\/bar\/preview\/stuff\", \"Foo.class\", \"Bar.class\");\n+            \/\/ In both modules in which it was added.\n+            assertDirContents(reader, \"\/modules\/modgus\/com\/bar\", \"preview\");\n+            assertDirContents(reader, \"\/modules\/modgus\/com\/bar\/preview\", \"other\");\n+            assertDirContents(reader, \"\/modules\/modgus\/com\/bar\/preview\/other\", \"Gus.class\");\n+        }\n+    }\n+\n+    @ParameterizedTest\n+    @ValueSource(booleans = {false, true})\n+    public void testPreviewEntriesAlwaysHidden(boolean previewMode) throws IOException {\n+        try (ImageReader reader = ImageReader.open(image, previewMode ? PreviewMode.ENABLED : PreviewMode.DISABLED)) {\n+            \/\/ The META-INF directory exists, but does not contain the preview directory.\n+            Node dir = assertDir(reader, \"\/modules\/modfoo\/META-INF\");\n+            assertEquals(0, dir.getChildNames().filter(n -> n.endsWith(\"\/preview\")).count());\n+            \/\/ Neither the preview directory, nor anything in it, can be looked-up directly.\n+            assertAbsent(reader, \"\/modules\/modfoo\/META-INF\/preview\");\n+            assertAbsent(reader, \"\/modules\/modfoo\/META-INF\/preview\/com\/foo\");\n+            \/\/ HasPreviewVersion.class is a preview class in the test data, and thus appears in\n+            \/\/ two places in the jimage). Ensure the preview version is always hidden.\n+            String alphaPath = \"com\/foo\/HasPreviewVersion.class\";\n+            assertNode(reader, \"\/modules\/modfoo\/\" + alphaPath);\n+            assertAbsent(reader, \"\/modules\/modfoo\/META-INF\/preview\/\" + alphaPath);\n+        }\n+    }\n+\n@@ -227,0 +356,21 @@\n+    private static void assertDirContents(ImageReader reader, String name, String... expectedChildNames) throws IOException {\n+        Node dir = assertDir(reader, name);\n+        Set<String> localChildNames = dir.getChildNames()\n+                .peek(s -> assertTrue(s.startsWith(name + \"\/\")))\n+                .map(s -> s.substring(name.length() + 1))\n+                .collect(toSet());\n+        assertEquals(\n+                Set.of(expectedChildNames),\n+                localChildNames,\n+                String.format(\"Unexpected child names in directory '%s'\", name));\n+    }\n+\n+    private static void assertResource(ImageReader reader, String modName, String resPath) throws IOException {\n+        assertTrue(reader.containsResource(modName, resPath), \"Resource should exist: \" + modName + \"\/\" + resPath);\n+        Node resNode = reader.findResourceNode(modName, resPath);\n+        assertTrue(resNode.isResource(), \"Node should be a resource: \" + resNode.getName());\n+        String nodeName = \"\/modules\/\" + modName + \"\/\" + resPath;\n+        assertEquals(nodeName, resNode.getName());\n+        assertSame(resNode, reader.findNode(nodeName));\n+    }\n+\n@@ -229,1 +379,1 @@\n-        assertTrue(link.isLink(), \"Node was not a symbolic link: \" + name);\n+        assertTrue(link.isLink(), \"Node should be a symbolic link: \" + link.getName());\n@@ -254,0 +404,4 @@\n+                boolean isPreviewEntry = fqn.startsWith(\"@\");\n+                if (isPreviewEntry) {\n+                    fqn = fqn.substring(1);\n+                }\n@@ -257,2 +411,0 @@\n-\n-                String path = fqn.replace('.', '\/') + \".class\";\n@@ -264,1 +416,1 @@\n-                                return \"Class: %s\";\n+                                return \"%s: %s\";\n@@ -267,1 +419,2 @@\n-                        \"\"\", pkg, cls, fqn);\n+                        \"\"\", pkg, cls, isPreviewEntry ? \"Preview\" : \"Class\", fqn);\n+                String path = (isPreviewEntry ? \"META-INF\/preview\/\" : \"\") + fqn.replace('.', '\/') + \".class\";\n","filename":"test\/jdk\/jdk\/internal\/jimage\/ImageReaderTest.java","additions":174,"deletions":21,"binary":false,"changes":195,"status":"modified"},{"patch":"@@ -62,1 +62,1 @@\n-    @DataProvider(name=\"classes\")\n+    @DataProvider(name = \"classes\")\n@@ -64,1 +64,1 @@\n-        return new Object[][] {\n+        return new Object[][]{\n@@ -82,1 +82,1 @@\n-    @Test(dataProvider=\"classes\")\n+    @Test(dataProvider = \"classes\")\n@@ -107,2 +107,2 @@\n-                    + moduleName\n-                    + \", or class: \" + className);\n+                            + moduleName\n+                            + \", or class: \" + className);\n@@ -234,1 +234,1 @@\n-            System.arraycopy(nativeNames,0, combined, names.length, nativeNames.length);\n+            System.arraycopy(nativeNames, 0, combined, names.length, nativeNames.length);\n@@ -358,1 +358,1 @@\n-        Class<?>[] testclass = { JImageReadTest.class};\n+        Class<?>[] testclass = {JImageReadTest.class};\n","filename":"test\/jdk\/jdk\/internal\/jimage\/JImageReadTest.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -132,1 +132,1 @@\n-    public void writeBuffer_multipleContent() {\n+    public void writeBuffer_multiplePackagesWithResources() {\n","filename":"test\/jdk\/jdk\/internal\/jimage\/ModuleReferenceTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -24,10 +24,0 @@\n-\/*\n- * @test\n- * @summary Test a pool containing jimage resources and classes.\n- * @author Jean-Francois Denise\n- * @modules jdk.jlink\/jdk.tools.jlink.internal\n- *          jdk.jlink\/jdk.tools.jlink.plugin\n- * @run build ResourcePoolTest\n- * @run main ResourcePoolTest\n- *\/\n-\n@@ -37,1 +27,0 @@\n-import java.util.HashSet;\n@@ -39,0 +28,1 @@\n+import java.util.Map;\n@@ -46,0 +36,1 @@\n+import org.junit.jupiter.api.Test;\n@@ -47,11 +38,5 @@\n-public class ResourcePoolTest {\n-\n-    public static void main(String[] args) throws Exception {\n-        new ResourcePoolTest().test();\n-    }\n-\n-    public void test() throws Exception {\n-        checkResourceAdding();\n-        checkResourceVisitor();\n-        checkResourcesAfterCompression();\n-    }\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertNotEquals;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n@@ -59,0 +44,9 @@\n+\/*\n+ * @test\n+ * @summary Test a pool containing jimage resources and classes.\n+ * @author Jean-Francois Denise\n+ * @modules jdk.jlink\/jdk.tools.jlink.internal\n+ *          jdk.jlink\/jdk.tools.jlink.plugin\n+ * @run junit ResourcePoolTest\n+ *\/\n+public class ResourcePoolTest {\n@@ -61,1 +55,2 @@\n-    private void checkResourceVisitor() throws Exception {\n+    @Test\n+    public void resourceVisitor() throws Exception {\n@@ -72,11 +67,3 @@\n-        if (visitor.getAmountBefore() == 0) {\n-            throw new AssertionError(\"Resources not found\");\n-        }\n-        if (visitor.getAmountBefore() != input.entryCount()) {\n-            throw new AssertionError(\"Number of visited resources. Expected: \" +\n-                    visitor.getAmountBefore() + \", got: \" + input.entryCount());\n-        }\n-        if (visitor.getAmountAfter() != output.entryCount()) {\n-            throw new AssertionError(\"Number of added resources. Expected: \" +\n-                    visitor.getAmountAfter() + \", got: \" + output.entryCount());\n-        }\n+        assertNotEquals(0, visitor.getAmountBefore(), \"Resources not found\");\n+        assertEquals(visitor.getAmountBefore(), input.entryCount(), \"Number of visited resources\");\n+        assertEquals(visitor.getAmountAfter(), output.entryCount(), \"Number of added resources\");\n@@ -85,3 +72,1 @@\n-            if (!input.findEntry(path).isPresent()) {\n-                throw new AssertionError(\"Unknown resource: \" + path);\n-            }\n+            assertTrue(input.findEntry(path).isPresent(), \"Unknown resource: \" + path);\n@@ -120,8 +105,5 @@\n-    private void checkResourceAdding() {\n-        List<String> samples = new ArrayList<>();\n-        samples.add(\"java.base\");\n-        samples.add(\"java\/lang\/Object\");\n-        samples.add(\"java.base\");\n-        samples.add(\"java\/lang\/String\");\n-        samples.add(\"java.management\");\n-        samples.add(\"javax\/management\/ObjectName\");\n+    @Test\n+    public void resourceAdding() {\n+        Map<String, List<String>> samples = Map.of(\n+                \"java.base\", List.of(\"java\/lang\/Object\", \"java\/lang\/String\"),\n+                \"java.management\", List.of(\"javax\/management\/ObjectName\"));\n@@ -147,22 +129,9 @@\n-    private void test(List<String> samples, ResourceAdder adder) {\n-        if (samples.isEmpty()) {\n-            throw new AssertionError(\"No sample to test\");\n-        }\n-        ResourcePoolManager resources = new ResourcePoolManager();\n-        Set<String> modules = new HashSet<>();\n-        for (int i = 0; i < samples.size(); i++) {\n-            String module = samples.get(i);\n-            modules.add(module);\n-            i++;\n-            String clazz = samples.get(i);\n-            String path = \"\/\" + module + \"\/\" + clazz + \".class\";\n-            adder.add(resources, module, path);\n-        }\n-        for (int i = 0; i < samples.size(); i++) {\n-            String module = samples.get(i);\n-            i++;\n-            String clazz = samples.get(i);\n-            String path = \"\/\" + module + \"\/\" + clazz + \".class\";\n-            Optional<ResourcePoolEntry> res = resources.findEntry(path);\n-            if (!res.isPresent()) {\n-                throw new AssertionError(\"Resource not found \" + path);\n+    @Test\n+    public void packageInference() {\n+        Map<String, List<String>> samples = Map.of(\n+                \"java.base\", List.of(\"NoPackage\", \"java\/lang\/String\", \"java\/util\/List\"));\n+        ResourcePoolManager manager = test(samples, (resources, module, path) -> {\n+            try {\n+                resources.add(ResourcePoolEntry.create(path, new byte[0]));\n+            } catch (Exception ex) {\n+                throw new RuntimeException(ex);\n@@ -170,3 +139,22 @@\n-            checkModule(resources.resourcePool(), res.get());\n-            if (resources.findEntry(clazz).isPresent()) {\n-                throw new AssertionError(\"Resource found \" + clazz);\n+        });\n+\n+        Optional<ResourcePoolModule> modBase = manager.moduleView().findModule(\"java.base\");\n+        assertTrue(modBase.isPresent());\n+        \/\/ Empty packages are not included (and should normally not exist).\n+        assertEquals(Set.of(\"java.lang\", \"java.util\"), modBase.get().packages());\n+    }\n+\n+    @Test\n+    public void packageInference_previewOnly() {\n+        Map<String, List<String>> samples = Map.of(\n+                \"java.base\", List.of(\n+                        \"java\/lang\/Object\",\n+                        \"java\/lang\/String\",\n+                        \"java\/util\/List\",\n+                        \"META-INF\/preview\/java\/lang\/String\",\n+                        \"META-INF\/preview\/java\/extra\/PreviewOnly\"));\n+        ResourcePoolManager manager = test(samples, (resources, module, path) -> {\n+            try {\n+                resources.add(ResourcePoolEntry.create(path, new byte[0]));\n+            } catch (Exception ex) {\n+                throw new RuntimeException(ex);\n@@ -174,4 +162,32 @@\n-        }\n-        if (resources.entryCount() != samples.size() \/ 2) {\n-            throw new AssertionError(\"Invalid number of resources\");\n-        }\n+        });\n+\n+        Optional<ResourcePoolModule> modBase = manager.moduleView().findModule(\"java.base\");\n+        assertTrue(modBase.isPresent());\n+        \/\/ Preview only package is included, and no packages start with 'META-INF'.\n+        assertEquals(Set.of(\"java.lang\", \"java.util\", \"java.extra\"), modBase.get().packages());\n+        \/\/ But the preview resources exist in the META-INF\/preview namespace.\n+        assertTrue(modBase.get().findEntry(\"\/java.base\/META-INF\/preview\/java\/extra\/PreviewOnly.class\").isPresent());\n+    }\n+\n+    private ResourcePoolManager test(Map<String, List<String>> samples, ResourceAdder adder) {\n+        assertFalse(samples.isEmpty(), \"No sample to test\");\n+        ResourcePoolManager resources = new ResourcePoolManager();\n+        samples.forEach((module, clazzes) -> {\n+            clazzes.forEach(clazz -> {\n+                String path = \"\/\" + module + \"\/\" + clazz + \".class\";\n+                adder.add(resources, module, path);\n+            });\n+        });\n+        samples.forEach((module, clazzes) -> {\n+            clazzes.forEach(clazz -> {\n+                String path = \"\/\" + module + \"\/\" + clazz + \".class\";\n+                Optional<ResourcePoolEntry> res = resources.findEntry(path);\n+                assertTrue(res.isPresent(), \"Resource not found \" + path);\n+                checkModule(resources.resourcePool(), res.get());\n+                assertTrue(resources.findEntry(clazz).isEmpty(), \"Resource found \" + clazz);\n+            });\n+        });\n+        long resourcesCount = samples.values().stream().mapToInt(List::size).sum();\n+        assertEquals(resourcesCount, resources.entryCount(), \"Invalid number of resources\");\n+        assertEquals(samples.size(), resources.moduleCount(), \"Invalid number of modules\");\n+        return resources;\n@@ -182,3 +198,1 @@\n-        if (!optMod.isPresent()) {\n-            throw new AssertionError(\"No module \" + res.moduleName());\n-        }\n+        assertTrue(optMod.isPresent(), \"No module \" + res.moduleName());\n@@ -186,7 +200,3 @@\n-        if (!m.name().equals(res.moduleName())) {\n-            throw new AssertionError(\"Not right module name \" + res.moduleName());\n-        }\n-        if (!m.findEntry(res.path()).isPresent()) {\n-            throw new AssertionError(\"resource \" + res.path()\n-                    + \" not in module \" + m.name());\n-        }\n+        assertEquals(res.moduleName(), m.name(), \"Not right module name \" + res.moduleName());\n+        assertTrue(m.findEntry(res.path()).isPresent(),\n+                \"resource \" + res.path() + \" not in module \" + m.name());\n@@ -195,1 +205,2 @@\n-    private void checkResourcesAfterCompression() throws Exception {\n+    @Test\n+    public void resourcesAfterCompression() throws Exception {\n@@ -218,22 +229,6 @@\n-            if (!resources.contains(res)) {\n-                throw new AssertionError(\"Resource not found: \" + res);\n-            }\n-\n-            if (!resources.findEntry(res.path()).isPresent()) {\n-                throw new AssertionError(\"Resource not found: \" + res);\n-            }\n-\n-            if (!modules.contains(res.moduleName())) {\n-                throw new AssertionError(\"Module not found: \" + res.moduleName());\n-            }\n-\n-            if (!resources.contains(res)) {\n-                throw new AssertionError(\"Resources not found: \" + res);\n-            }\n-\n-            try {\n-                resources.add(res);\n-                throw new AssertionError(res + \" already present, but an exception is not thrown\");\n-            } catch (Exception ex) {\n-                \/\/ Expected\n-            }\n+            assertTrue(resources.contains(res), \"Resource not found: \" + res);\n+            assertTrue(resources.findEntry(res.path()).isPresent(), \"Resource not found: \" + res);\n+            assertTrue(modules.contains(res.moduleName()), \"Module not found: \" + res.moduleName());\n+            assertTrue(modules.contains(res.moduleName()), \"Module not found: \" + res.moduleName());\n+            assertThrows(RuntimeException.class, () -> resources.add(res),\n+                    res + \" already present, but an exception is not thrown\");\n@@ -242,6 +237,3 @@\n-        try {\n-            resources.add(ResourcePoolEntry.create(\"\/module2\/toto1\", new byte[0]));\n-            throw new AssertionError(\"ResourcePool is read-only, but an exception is not thrown\");\n-        } catch (Exception ex) {\n-            \/\/ Expected\n-        }\n+        ResourcePoolEntry toAdd = ResourcePoolEntry.create(\"\/module2\/toto1\", new byte[0]);\n+        assertThrows(RuntimeException.class, () -> resources.add(toAdd),\n+                \"ResourcePool is read-only, but an exception is not thrown\");\n","filename":"test\/jdk\/tools\/jlink\/ResourcePoolTest.java","additions":105,"deletions":113,"binary":false,"changes":218,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+import java.util.stream.Collectors;\n@@ -50,0 +51,1 @@\n+ *          jdk.jlink\n@@ -52,1 +54,1 @@\n- * @run main\/othervm\/timeout=1200 -Xmx1g PackagedModulesVsRuntimeImageLinkTest\n+ * @run main\/othervm\/timeout=1200 -ea -esa -DDISABLE_PREVIEW_PATCHING=false -Xmx1g PackagedModulesVsRuntimeImageLinkTest\n@@ -73,1 +75,0 @@\n-\n@@ -123,3 +124,2 @@\n-        if (jimageContentJmodLess.size() != jimageContentJmodFull.size()) {\n-            throw new AssertionError(String.format(\"Size of jimage content differs for jmod-less (%d) v. jmod-full (%d)\", jimageContentJmodLess.size(), jimageContentJmodFull.size()));\n-        }\n+        assertSameContent(\"jmod-less\", jimageContentJmodLess, \"jmod-full\", jimageContentJmodFull);\n+        \/\/ Both lists are same size, with same names, so enumerate either.\n@@ -148,0 +148,41 @@\n+    \/\/ Helper to assert the content of two jimage files are the same and provide\n+    \/\/ useful debug information otherwise.\n+    private static void assertSameContent(\n+            String lhsLabel, List<String> lhsNames, String rhsLabel, List<String> rhsNames) {\n+        int lhsSize = lhsNames.size();\n+        int rhsSize = rhsNames.size();\n+        \/\/ Both input lists are sorted, enumerate the differences for debugging.\n+        List<String> lhsOnly = new ArrayList<>();\n+        List<String> rhsOnly = new ArrayList<>();\n+        int i = 0;\n+        int j = 0;\n+        while (i < lhsSize && j < rhsSize) {\n+            String lhsName = lhsNames.get(i);\n+            String rhsName = rhsNames.get(j);\n+            int signum = lhsName.compareTo(rhsName);\n+            if (signum == 0) {\n+                i += 1;\n+                j += 1;\n+            } else if (signum < 0) {\n+                lhsOnly.add(lhsName);\n+                i += 1;\n+            } else {\n+                rhsOnly.add(rhsName);\n+                j += 1;\n+            }\n+        }\n+        lhsOnly.addAll(lhsNames.subList(i, lhsSize));\n+        rhsOnly.addAll(rhsNames.subList(j, rhsSize));\n+        if (!lhsOnly.isEmpty() || !rhsOnly.isEmpty()) {\n+            String message = String.format(\n+                    \"jimage content differs for %s (%d) v. %s (%d)\", lhsLabel, lhsSize, rhsLabel, rhsSize);\n+            if (!lhsOnly.isEmpty()) {\n+                message += \"\\nOnly in \" + lhsLabel + \":\\n\\t\" + String.join(\"\\n\\t\", lhsOnly);\n+            }\n+            if (!rhsOnly.isEmpty()) {\n+                message += \"\\nOnly in \" + rhsLabel + \":\\n\\t\" + String.join(\"\\n\\t\", rhsOnly);\n+            }\n+            throw new AssertionError(message);\n+        }\n+    }\n+\n@@ -149,1 +190,7 @@\n-        return path.startsWith(\"\/packages\") || path.startsWith(\"\/modules\");\n+        return pathStartsWith(path, \"\/packages\") || pathStartsWith(path, \"\/modules\");\n+    }\n+\n+    \/\/ Handle both \"<prefix>\" and \"<prefix>\/...\".\n+    private static boolean pathStartsWith(String path, String prefix) {\n+        int plen = prefix.length();\n+        return path.startsWith(prefix) && (path.length() == plen || path.charAt(plen) == '\/');\n","filename":"test\/jdk\/tools\/jlink\/runtimeImage\/PackagedModulesVsRuntimeImageLinkTest.java","additions":53,"deletions":6,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -0,0 +1,31 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Whitebox tests for ImageResourcesTree.\n+ * @modules jdk.jlink\/jdk.tools.jlink.internal\n+ * @build jdk.jlink\/jdk.tools.jlink.internal.ImageResourcesTreeTest\n+ * @run junit\/othervm -ea -esa jdk.jlink\/jdk.tools.jlink.internal.ImageResourcesTreeTest\n+ *\/\n+public class ImageResourcesTreeTestDriver {}\n","filename":"test\/jdk\/tools\/jlink\/whitebox\/ImageResourcesTreeTestDriver.java","additions":31,"deletions":0,"binary":false,"changes":31,"status":"added"},{"patch":"@@ -0,0 +1,3 @@\n+modules = \\\n+    jdk.jlink\/jdk.tools.jlink.internal\n+bootclasspath.dirs=.\n","filename":"test\/jdk\/tools\/jlink\/whitebox\/TEST.properties","additions":3,"deletions":0,"binary":false,"changes":3,"status":"added"},{"patch":"@@ -0,0 +1,261 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package jdk.tools.jlink.internal;\n+\n+import jdk.internal.jimage.ModuleReference;\n+import jdk.tools.jlink.internal.ImageResourcesTree.Node;\n+import jdk.tools.jlink.internal.ImageResourcesTree.PackageNode;\n+import jdk.tools.jlink.internal.ImageResourcesTree.ResourceNode;\n+import jdk.tools.jlink.internal.ImageResourcesTree.Tree;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertInstanceOf;\n+import static org.junit.jupiter.api.Assertions.assertSame;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+public class ImageResourcesTreeTest {\n+\n+    private static final String MODULES_PREFIX = \"\/modules\/\";\n+    private static final String PACKAGES_PREFIX = \"\/packages\/\";\n+\n+    @Test\n+    public void directoryNodes() {\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.base\/java\/util\/SomeOtherClass.class\",\n+                \"\/java.base\/java\/util\/resource.txt\",\n+                \"\/java.logging\/java\/util\/logging\/LoggingClass.class\",\n+                \"\/java.logging\/java\/util\/logging\/OtherLoggingClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+\n+        \/\/ All paths from the root (but not the root itself).\n+        assertTrue(nodes.containsKey(\"\/modules\"));\n+        assertTrue(nodes.containsKey(\"\/modules\/java.base\"));\n+        assertTrue(nodes.containsKey(\"\/modules\/java.base\/java\"));\n+        assertTrue(nodes.containsKey(\"\/modules\/java.base\/java\/util\"));\n+        assertFalse(nodes.containsKey(\"\/\"));\n+\n+        \/\/ Check for mismatched modules.\n+        assertTrue(nodes.containsKey(\"\/modules\/java.logging\/java\/util\/logging\"));\n+        assertFalse(nodes.containsKey(\"\/modules\/java.base\/java\/util\/logging\"));\n+\n+        Set<String> dirPaths = nodes.keySet().stream()\n+                .filter(p -> p.startsWith(MODULES_PREFIX))\n+                .collect(Collectors.toSet());\n+        for (String path : dirPaths) {\n+            Node dir = nodes.get(path);\n+            assertFalse(dir instanceof ResourceNode, \"Unexpected resource: \" + dir);\n+            assertEquals(path, dir.getPath());\n+            assertTrue(path.endsWith(\"\/\" + dir.getName()), \"Unexpected directory name: \" + dir);\n+        }\n+    }\n+\n+    @Test\n+    public void resourceNodes() {\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.base\/java\/util\/SomeOtherClass.class\",\n+                \"\/java.base\/java\/util\/resource.txt\",\n+                \"\/java.logging\/java\/util\/logging\/LoggingClass.class\",\n+                \"\/java.logging\/java\/util\/logging\/OtherLoggingClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        \/\/ This map *does not* contain the resources, only the \"directory\" nodes.\n+        Map<String, Node> nodes = tree.getMap();\n+\n+        assertContainsResources(\n+                nodes.get(\"\/modules\/java.base\/java\/util\"),\n+                \"SomeClass.class\", \"SomeOtherClass.class\", \"resource.txt\");\n+\n+        assertContainsResources(\n+                nodes.get(\"\/modules\/java.logging\/java\/util\/logging\"),\n+                \"LoggingClass.class\", \"OtherLoggingClass.class\");\n+    }\n+\n+    @Test\n+    public void expectedPackages() {\n+        \/\/ Paths are only to resources. Packages are inferred.\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.logging\/java\/util\/logging\/SomeClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+        Node packages = nodes.get(\"\/packages\");\n+        List<String> pkgNames = nodes.keySet().stream()\n+                .filter(p -> p.startsWith(PACKAGES_PREFIX))\n+                .map(p -> p.substring(PACKAGES_PREFIX.length()))\n+                .sorted()\n+                .toList();\n+\n+        assertEquals(List.of(\"java\", \"java.util\", \"java.util.logging\"), pkgNames);\n+        for (String pkgName : pkgNames) {\n+            PackageNode pkgNode = assertInstanceOf(PackageNode.class, packages.getChildren(pkgName));\n+            assertSame(nodes.get(PACKAGES_PREFIX + pkgNode.getName()), pkgNode);\n+        }\n+    }\n+\n+    @Test\n+    public void expectedPackageEntries() {\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.logging\/java\/util\/logging\/SomeClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+        PackageNode pkgUtil = getPackageNode(nodes, \"java.util\");\n+        List<ModuleReference> modRefs = pkgUtil.getModuleReferences();\n+        assertEquals(2, modRefs.size());\n+\n+        List<String> modNames = modRefs.stream().map(ModuleReference::name).toList();\n+        assertEquals(List.of(\"java.base\", \"java.logging\"), modNames);\n+\n+        \/\/ Ordered by name.\n+        assertNonEmptyRef(modRefs.get(0), \"java.base\");\n+        assertEmptyRef(modRefs.get(1), \"java.logging\");\n+    }\n+\n+    @Test\n+    public void expectedPackageEntries_withPreviewResources() {\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.base\/java\/util\/OtherClass.class\",\n+                \"\/java.base\/META-INF\/preview\/java\/util\/OtherClass.class\",\n+                \"\/java.logging\/java\/util\/logging\/SomeClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+        PackageNode pkgUtil = getPackageNode(nodes, \"java.util\");\n+        List<ModuleReference> modRefs = pkgUtil.getModuleReferences();\n+\n+        ModuleReference baseRef = modRefs.get(0);\n+        assertNonEmptyRef(baseRef, \"java.base\");\n+        assertTrue(baseRef.hasPreviewVersion());\n+    }\n+\n+    @Test\n+    public void expectedPackageEntries_withPreviewOnlyPackages() {\n+        List<String> paths = List.of(\n+                \"\/java.base\/java\/util\/SomeClass.class\",\n+                \"\/java.base\/META-INF\/preview\/java\/util\/preview\/only\/PreviewClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+\n+        \/\/ Preview only package (with content).\n+        PackageNode nonEmptyPkg = getPackageNode(nodes, \"java.util.preview.only\");\n+        ModuleReference nonEmptyRef = nonEmptyPkg.getModuleReferences().getFirst();\n+        assertNonEmptyPreviewOnlyRef(nonEmptyRef, \"java.base\");\n+\n+        \/\/ Preview only packages can be empty.\n+        PackageNode emptyPkg = getPackageNode(nodes, \"java.util.preview\");\n+        ModuleReference emptyRef = emptyPkg.getModuleReferences().getFirst();\n+        assertEmptyPreviewOnlyRef(emptyRef, \"java.base\");\n+    }\n+\n+    @Test\n+    public void expectedPackageOrder_sharedPackage() {\n+        \/\/ Resource in many modules define the same package (java.shared), but\n+        \/\/ this only has content in one module (java.content).\n+        \/\/ Order of test data is shuffled to show reordering in entry list.\n+        \/\/ \"java.moduleN\" would sort before after \"java.previewN\" if it were\n+        \/\/ only sorted by name, but preview entries come first.\n+        \/\/ Expect: preview{1..3) -> content -> module{1..3}\n+        List<String> paths = List.of(\n+                \/\/ Module with content in \"java.shared\".\n+                \"\/java.content\/java\/shared\/MainPackageClass.class\",\n+                \/\/ Other resources (in other modules) which implicitly define \"java.shared\".\n+                \"\/java.module3\/java\/shared\/three\/SomeClass.class\",\n+                \"\/java.module2\/java\/shared\/two\/SomeClass.class\",\n+                \"\/java.module1\/java\/shared\/one\/SomeClass.class\",\n+                \/\/ Preview resources in other modules which implicitly define \"java.shared\".\n+                \"\/java.preview3\/META-INF\/preview\/java\/shared\/baz\/SomeClass.class\",\n+                \"\/java.preview2\/META-INF\/preview\/java\/shared\/bar\/SomeClass.class\",\n+                \"\/java.preview1\/META-INF\/preview\/java\/shared\/foo\/SomeClass.class\");\n+\n+        Tree tree = new Tree(paths);\n+        Map<String, Node> nodes = tree.getMap();\n+\n+        PackageNode sharedPkg = getPackageNode(nodes, \"java.shared\");\n+        List<ModuleReference> refs = sharedPkg.getModuleReferences();\n+\n+        \/\/ Preview packages first, by name.\n+        int n = 1;\n+        for (ModuleReference ref : refs.subList(0, 3)) {\n+            assertEmptyPreviewOnlyRef(ref, \"java.preview\" + (n++));\n+        }\n+        \/\/ The content package (simply due to its name).\n+        assertNonEmptyRef(refs.get(3), \"java.content\");\n+        \/\/ And the non-preview empty packages after.\n+        n = 1;\n+        for (ModuleReference ref : refs.subList(4, 7)) {\n+            assertEmptyRef(ref, \"java.module\" + (n++));\n+        }\n+    }\n+\n+    static PackageNode getPackageNode(Map<String, Node> nodes, String pkgName) {\n+        return assertInstanceOf(PackageNode.class, nodes.get(PACKAGES_PREFIX + pkgName));\n+    }\n+\n+    static void assertContainsResources(Node dirNode, String... resourceNames) {\n+        for (String name : resourceNames) {\n+            Node node = assertInstanceOf(ResourceNode.class, dirNode.getChildren(name));\n+            assertEquals(name, node.getName());\n+            assertEquals(dirNode.getPath() + \"\/\" + name, node.getPath());\n+        }\n+    }\n+\n+    static void assertNonEmptyRef(ModuleReference ref, String modName) {\n+        assertEquals(modName, ref.name(), \"Unexpected module name: \" + ref);\n+        assertTrue(ref.hasResources(), \"Expected non-empty reference: \" + ref);\n+        assertFalse(ref.isPreviewOnly(), \"Expected not preview-only: \" + ref);\n+    }\n+\n+    static void assertEmptyRef(ModuleReference ref, String modName) {\n+        assertEquals(modName, ref.name(), \"Unexpected module name: \" + ref);\n+        assertFalse(ref.hasResources(), \"Expected empty reference: \" + ref);\n+        assertFalse(ref.isPreviewOnly(), \"Expected not preview-only: \" + ref);\n+    }\n+\n+    static void assertNonEmptyPreviewOnlyRef(ModuleReference ref, String modName) {\n+        assertEquals(modName, ref.name(), \"Unexpected module name: \" + ref);\n+        assertTrue(ref.hasResources(), \"Expected empty reference: \" + ref);\n+        assertTrue(ref.isPreviewOnly(), \"Expected preview-only: \" + ref);\n+    }\n+\n+    static void assertEmptyPreviewOnlyRef(ModuleReference ref, String modName) {\n+        assertEquals(modName, ref.name(), \"Unexpected module name: \" + ref);\n+        assertFalse(ref.hasResources(), \"Expected empty reference: \" + ref);\n+        assertTrue(ref.isPreviewOnly(), \"Expected preview-only: \" + ref);\n+    }\n+}\n","filename":"test\/jdk\/tools\/jlink\/whitebox\/jdk.jlink\/jdk\/tools\/jlink\/internal\/ImageResourcesTreeTest.java","additions":261,"deletions":0,"binary":false,"changes":261,"status":"added"},{"patch":"@@ -35,0 +35,1 @@\n+import org.openjdk.jmh.annotations.Param;\n@@ -47,0 +48,1 @@\n+import java.util.Map;\n@@ -49,0 +51,2 @@\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n@@ -51,0 +55,3 @@\n+import static java.util.stream.Collectors.groupingBy;\n+import static java.util.stream.Collectors.mapping;\n+import static java.util.stream.Collectors.toList;\n@@ -70,1 +77,1 @@\n-    \/\/\/ per-benchmark or a per-iteration state object. The subclasses provide\n+    \/\/\/ per-trial or a per-iteration state object. The subclasses provide\n@@ -87,0 +94,2 @@\n+    \/\/\/ A {@link Level#Trial per-trial} state which provides an image reader,\n+    \/\/\/ suitable for {@link Mode#AverageTime average time} benchmarks.\n@@ -88,1 +97,3 @@\n-    public static class WarmStartWithImageReader extends BaseState {\n+    public static class WarmStart extends BaseState {\n+        @Param({\"DISABLED\", \"ENABLED\"})\n+        PreviewMode previewMode;\n@@ -94,1 +105,1 @@\n-            reader = ImageReader.open(copiedImageFile, PreviewMode.DISABLED);\n+            reader = ImageReader.open(copiedImageFile, previewMode);\n@@ -103,0 +114,12 @@\n+    @State(Scope.Benchmark)\n+    public static class WarmStartWithCachedNodes extends WarmStart {\n+        @Setup(Level.Trial)\n+        public void setUp() throws IOException {\n+            super.setUp();\n+            countAllNodes(reader, reader.findNode(\"\/\"));\n+        }\n+    }\n+\n+    \/\/\/ A {@link Level#Iteration per-iteration} state suitable for\n+    \/\/\/ {@link Mode#SingleShotTime single shot} benchmarks. Unlike\n+    \/\/\/ {@link WarmStart}, this state does not provide a reader instance.\n@@ -105,0 +128,3 @@\n+        @Param({\"DISABLED\", \"ENABLED\"})\n+        PreviewMode previewMode;\n+\n@@ -117,1 +143,1 @@\n-    public static class ColdStartWithImageReader extends BaseState {\n+    public static class ColdStartWithImageReader extends ColdStart {\n@@ -123,1 +149,1 @@\n-            reader = ImageReader.open(copiedImageFile, PreviewMode.DISABLED);\n+            reader = ImageReader.open(copiedImageFile, previewMode);\n@@ -138,1 +164,1 @@\n-    public void warmCache_CountAllNodes(WarmStartWithImageReader state) throws IOException {\n+    public void warmStart_CountAllNodes(WarmStartWithCachedNodes state) throws IOException {\n@@ -142,0 +168,39 @@\n+    \/\/\/ Benchmarks {@link ImageReader#containsResource(String, String)} when no\n+    \/\/\/ nodes have been cached in the {@link ImageReader}. In non-preview mode,\n+    \/\/\/ this should be identical to the case where nodes are cached (because the\n+    \/\/\/ cache isn't used) but in preview mode, the cache will be tested for\n+    \/\/\/ preview resources, and thus differ depending on whether nodes are present.\n+    \/\/\/\n+    \/\/\/ This doesn't need to be a cold start because it never modifies the nodes\n+    \/\/\/ cache.\n+    @Benchmark\n+    @BenchmarkMode(Mode.AverageTime)\n+    public void warmStart_ContainsResource_emptyNodeCache(WarmStart state) throws IOException {\n+        state.count = countContainsResource(state.reader, ClassList.pathMap());\n+    }\n+\n+    \/\/\/ As above, but the nodes cache has been filled, giving preview mode a\n+    \/\/\/ different code path.\n+    @Benchmark\n+    @BenchmarkMode(Mode.AverageTime)\n+    public void warmStart_ContainsResource_fullNodeCache(WarmStartWithCachedNodes state) throws IOException {\n+        state.count = countContainsResource(state.reader, ClassList.pathMap());\n+    }\n+\n+    \/\/\/ As {@link #warmStart_ContainsResource_emptyNodeCache}, but tests\n+    \/\/\/ {@link ImageReader#findResourceNode(String, String)}.\n+    @Benchmark\n+    @BenchmarkMode(Mode.AverageTime)\n+    public void warmStart_FindResourceNode_emptyNodeCache(WarmStart state) throws IOException {\n+        state.count = countFindResourceNode(state.reader, ClassList.pathMap());\n+    }\n+\n+    \/\/\/ As {@link #warmStart_ContainsResource_fullNodeCache}, but tests\n+    \/\/\/ {@link ImageReader#findResourceNode(String, String)}.\n+    @Benchmark\n+    @BenchmarkMode(Mode.AverageTime)\n+    public void warmStart_FindResourceNode_fullNodeCache(WarmStartWithCachedNodes state) throws IOException {\n+        state.count = countFindResourceNode(state.reader, ClassList.pathMap());\n+    }\n+\n+\n@@ -150,1 +215,1 @@\n-        try (var reader = ImageReader.open(state.copiedImageFile, PreviewMode.DISABLED)) {\n+        try (var reader = ImageReader.open(state.copiedImageFile, state.previewMode)) {\n@@ -155,1 +220,1 @@\n-    \/\/\/ As above, but includes the time to initialize the `ImageReader`.\n+    \/\/\/ As above, but excludes the time to initialize the `ImageReader`.\n@@ -174,2 +239,2 @@\n-        try (var reader = ImageReader.open(state.copiedImageFile, PreviewMode.DISABLED)) {\n-            for (String path : INIT_CLASSES) {\n+        try (var reader = ImageReader.open(state.copiedImageFile, state.previewMode)) {\n+            for (String path : ClassList.names()) {\n@@ -186,1 +251,1 @@\n-        state.count = INIT_CLASSES.size();\n+        state.count = ClassList.count();\n@@ -188,1 +253,1 @@\n-        if ((100 * errors) \/ INIT_CLASSES.size() >= 2) {\n+        if ((100 * errors) \/ ClassList.count() >= 2) {\n@@ -207,0 +272,27 @@\n+    static long countContainsResource(ImageReader reader, Map<String, List<String>> modToPaths)\n+            throws IOException {\n+        long count = 0;\n+        for (Map.Entry<String, List<String>> e : modToPaths.entrySet()) {\n+            String mod = e.getKey();\n+            for (String path : e.getValue()) {\n+                if (reader.containsResource(mod, path)) {\n+                    count++;\n+                }\n+            }\n+        }\n+        return count;\n+    }\n+\n+    static long countFindResourceNode(ImageReader reader, Map<String, List<String>> modToPaths) throws IOException {\n+        long count = 0;\n+        for (Map.Entry<String, List<String>> e : modToPaths.entrySet()) {\n+            String mod = e.getKey();\n+            for (String path : e.getValue()) {\n+                if (reader.findResourceNode(mod, path) != null) {\n+                    count++;\n+                }\n+            }\n+        }\n+        return count;\n+    }\n+\n@@ -211,2 +303,2 @@\n-        try (var reader = ImageReader.open(state.copiedImageFile, PreviewMode.DISABLED)) {\n-            for (String path : INIT_CLASSES) {\n+        try (var reader = ImageReader.open(state.copiedImageFile, state.previewMode)) {\n+            for (String path : ClassList.names()) {\n@@ -223,1 +315,1 @@\n-                        errors, INIT_CLASSES.size(), String.join(\"\\n\\t\", missing)));\n+                        errors, ClassList.count(), String.join(\"\\n\\t\", missing)));\n@@ -226,851 +318,884 @@\n-    \/\/ Note: This list is inherently a little fragile and may end up being more\n-    \/\/ trouble than it's worth to maintain. If it turns out that it needs to be\n-    \/\/ regenerated often when this benchmark is run, then a new approach should\n-    \/\/ be considered, such as:\n-    \/\/ * Limit the list of classes to non-internal ones.\n-    \/\/ * Calculate the list dynamically based on the running JVM.\n-    \/\/\n-    \/\/ Created by running \"java -verbose:class\", throwing away anonymous inner\n-    \/\/ classes and anything without a reliable name, and grouping by the stated\n-    \/\/ source. It's not perfect, but it's representative.\n-    \/\/\n-    \/\/ <jdk_root>\/bin\/java -verbose:class HelloWorld 2>&1 \\\n-    \/\/   | fgrep '[class,load]' | cut -d' ' -f2 \\\n-    \/\/   | tr '.' '\/' \\\n-    \/\/   | egrep -v '\\$[0-9$]' \\\n-    \/\/   | fgrep -v 'HelloWorld' \\\n-    \/\/   | fgrep -v '\/META-INF\/preview\/' \\\n-    \/\/   | while read f ; do echo \"${f}.class\" ; done \\\n-    \/\/   > initclasses.txt\n-    \/\/\n-    \/\/ Output:\n-    \/\/    java\/lang\/Object.class\n-    \/\/    java\/io\/Serializable.class\n-    \/\/    ...\n-    \/\/\n-    \/\/ jimage list <jdk_root>\/images\/jdk\/lib\/modules \\\n-    \/\/     | awk '\/^Module: *\/ { MOD=$2 }; \/^    *\/ { print \"\/modules\/\"MOD\"\/\"$1 }' \\\n-    \/\/     > fullpaths.txt\n-    \/\/\n-    \/\/ Output:\n-    \/\/     ...\n-    \/\/     \/modules\/java.base\/java\/lang\/Object.class\n-    \/\/     \/modules\/java.base\/java\/lang\/OutOfMemoryError.class\n-    \/\/     ...\n-    \/\/\n-    \/\/ while read c ; do grep \"\/$c\" fullpaths.txt ; done < initclasses.txt \\\n-    \/\/     | while read c ; do printf '    \"%s\",\\n' \"$c\" ; done \\\n-    \/\/     > initpaths.txt\n-    \/\/\n-    \/\/ Output:\n-    private static final Set<String> INIT_CLASSES = Set.of(\n-            \"\/modules\/java.base\/java\/lang\/Object.class\",\n-            \"\/modules\/java.base\/java\/io\/Serializable.class\",\n-            \"\/modules\/java.base\/java\/lang\/Comparable.class\",\n-            \"\/modules\/java.base\/java\/lang\/CharSequence.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/Constable.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/ConstantDesc.class\",\n-            \"\/modules\/java.base\/java\/lang\/String.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/AnnotatedElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/GenericDeclaration.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Type.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor$OfField.class\",\n-            \"\/modules\/java.base\/java\/lang\/Class.class\",\n-            \"\/modules\/java.base\/java\/lang\/Cloneable.class\",\n-            \"\/modules\/java.base\/java\/lang\/ClassLoader.class\",\n-            \"\/modules\/java.base\/java\/lang\/System.class\",\n-            \"\/modules\/java.base\/java\/lang\/Throwable.class\",\n-            \"\/modules\/java.base\/java\/lang\/Error.class\",\n-            \"\/modules\/java.base\/java\/lang\/Exception.class\",\n-            \"\/modules\/java.base\/java\/lang\/RuntimeException.class\",\n-            \"\/modules\/java.base\/java\/security\/ProtectionDomain.class\",\n-            \"\/modules\/java.base\/java\/security\/SecureClassLoader.class\",\n-            \"\/modules\/java.base\/java\/lang\/ReflectiveOperationException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ClassNotFoundException.class\",\n-            \"\/modules\/java.base\/java\/lang\/Record.class\",\n-            \"\/modules\/java.base\/java\/lang\/LinkageError.class\",\n-            \"\/modules\/java.base\/java\/lang\/NoClassDefFoundError.class\",\n-            \"\/modules\/java.base\/java\/lang\/ClassCastException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ArrayStoreException.class\",\n-            \"\/modules\/java.base\/java\/lang\/VirtualMachineError.class\",\n-            \"\/modules\/java.base\/java\/lang\/InternalError.class\",\n-            \"\/modules\/java.base\/java\/lang\/OutOfMemoryError.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackOverflowError.class\",\n-            \"\/modules\/java.base\/java\/lang\/IllegalMonitorStateException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Reference.class\",\n-            \"\/modules\/java.base\/java\/lang\/IllegalCallerException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/SoftReference.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/WeakReference.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/FinalReference.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/PhantomReference.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Finalizer.class\",\n-            \"\/modules\/java.base\/java\/lang\/Runnable.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread$FieldHolder.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread$Constants.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread$UncaughtExceptionHandler.class\",\n-            \"\/modules\/java.base\/java\/lang\/ThreadGroup.class\",\n-            \"\/modules\/java.base\/java\/lang\/BaseVirtualThread.class\",\n-            \"\/modules\/java.base\/java\/lang\/VirtualThread.class\",\n-            \"\/modules\/java.base\/java\/lang\/ThreadBuilders$BoundVirtualThread.class\",\n-            \"\/modules\/java.base\/java\/util\/Map.class\",\n-            \"\/modules\/java.base\/java\/util\/Dictionary.class\",\n-            \"\/modules\/java.base\/java\/util\/Hashtable.class\",\n-            \"\/modules\/java.base\/java\/util\/Properties.class\",\n-            \"\/modules\/java.base\/java\/lang\/Module.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/AccessibleObject.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Member.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Field.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Parameter.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Executable.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Method.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Constructor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/ContinuationScope.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/Continuation.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/StackChunk.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodAccessor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodAccessorImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstantPool.class\",\n-            \"\/modules\/java.base\/java\/lang\/annotation\/Annotation.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/CallerSensitive.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstructorAccessor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstructorAccessorImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/DirectConstructorHandleAccessor$NativeAccessor.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MemberName.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/ResolvedMethodName.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleNatives.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor$OfMethod.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodType.class\",\n-            \"\/modules\/java.base\/java\/lang\/BootstrapMethodError.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/CallSite.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/NativeEntryPoint.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/ABIDescriptor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/VMStorage.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/UpcallLinker$CallRegs.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/ConstantCallSite.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MutableCallSite.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VolatileCallSite.class\",\n-            \"\/modules\/java.base\/java\/lang\/AssertionStatusDirectives.class\",\n-            \"\/modules\/java.base\/java\/lang\/Appendable.class\",\n-            \"\/modules\/java.base\/java\/lang\/AbstractStringBuilder.class\",\n-            \"\/modules\/java.base\/java\/lang\/StringBuffer.class\",\n-            \"\/modules\/java.base\/java\/lang\/StringBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/UnsafeConstants.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/Unsafe.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/Modules.class\",\n-            \"\/modules\/java.base\/java\/lang\/AutoCloseable.class\",\n-            \"\/modules\/java.base\/java\/io\/Closeable.class\",\n-            \"\/modules\/java.base\/java\/io\/InputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/ByteArrayInputStream.class\",\n-            \"\/modules\/java.base\/java\/net\/URL.class\",\n-            \"\/modules\/java.base\/java\/lang\/Enum.class\",\n-            \"\/modules\/java.base\/java\/util\/jar\/Manifest.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/BuiltinClassLoader.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$AppClassLoader.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$PlatformClassLoader.class\",\n-            \"\/modules\/java.base\/java\/security\/CodeSource.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentMap.class\",\n-            \"\/modules\/java.base\/java\/util\/AbstractMap.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/Iterable.class\",\n-            \"\/modules\/java.base\/java\/util\/Collection.class\",\n-            \"\/modules\/java.base\/java\/util\/SequencedCollection.class\",\n-            \"\/modules\/java.base\/java\/util\/List.class\",\n-            \"\/modules\/java.base\/java\/util\/RandomAccess.class\",\n-            \"\/modules\/java.base\/java\/util\/AbstractCollection.class\",\n-            \"\/modules\/java.base\/java\/util\/AbstractList.class\",\n-            \"\/modules\/java.base\/java\/util\/ArrayList.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackTraceElement.class\",\n-            \"\/modules\/java.base\/java\/nio\/Buffer.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackWalker.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackStreamFactory$AbstractStackWalker.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackWalker$StackFrame.class\",\n-            \"\/modules\/java.base\/java\/lang\/ClassFrameInfo.class\",\n-            \"\/modules\/java.base\/java\/lang\/StackFrameInfo.class\",\n-            \"\/modules\/java.base\/java\/lang\/LiveStackFrame.class\",\n-            \"\/modules\/java.base\/java\/lang\/LiveStackFrameInfo.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractOwnableSynchronizer.class\",\n-            \"\/modules\/java.base\/java\/lang\/Boolean.class\",\n-            \"\/modules\/java.base\/java\/lang\/Character.class\",\n-            \"\/modules\/java.base\/java\/lang\/Number.class\",\n-            \"\/modules\/java.base\/java\/lang\/Float.class\",\n-            \"\/modules\/java.base\/java\/lang\/Double.class\",\n-            \"\/modules\/java.base\/java\/lang\/Byte.class\",\n-            \"\/modules\/java.base\/java\/lang\/Short.class\",\n-            \"\/modules\/java.base\/java\/lang\/Integer.class\",\n-            \"\/modules\/java.base\/java\/lang\/Long.class\",\n-            \"\/modules\/java.base\/java\/lang\/Void.class\",\n-            \"\/modules\/java.base\/java\/util\/Iterator.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/RecordComponent.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorPayload.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$Vector.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorMask.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorShuffle.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/FillerObject.class\",\n-            \"\/modules\/java.base\/java\/lang\/NullPointerException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ArithmeticException.class\",\n-            \"\/modules\/java.base\/java\/lang\/IndexOutOfBoundsException.class\",\n-            \"\/modules\/java.base\/java\/lang\/ArrayIndexOutOfBoundsException.class\",\n-            \"\/modules\/java.base\/java\/io\/ObjectStreamField.class\",\n-            \"\/modules\/java.base\/java\/util\/Comparator.class\",\n-            \"\/modules\/java.base\/java\/lang\/String$CaseInsensitiveComparator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/VM.class\",\n-            \"\/modules\/java.base\/java\/lang\/Module$ArchivedData.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/CDS.class\",\n-            \"\/modules\/java.base\/java\/util\/Set.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableCollection.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableSet.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$Set12.class\",\n-            \"\/modules\/java.base\/java\/util\/Objects.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableList.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$ListN.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$SetN.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableMap.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$MapN.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangReflectAccess.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/ReflectAccess.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/SharedSecrets.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/ReflectionFactory.class\",\n-            \"\/modules\/java.base\/java\/io\/ObjectStreamClass.class\",\n-            \"\/modules\/java.base\/java\/lang\/Math.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/ReflectionFactory$Config.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangRefAccess.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue$Null.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue$Lock.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangAccess.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/SystemProps.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/SystemProps$Raw.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/Charset.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/spi\/CharsetProvider.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/StandardCharsets.class\",\n-            \"\/modules\/java.base\/java\/lang\/StringLatin1.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/HistoricallyNamedCharset.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/Unicode.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_8.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/StrictMath.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ArraysSupport.class\",\n-            \"\/modules\/java.base\/java\/util\/Map$Entry.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$Node.class\",\n-            \"\/modules\/java.base\/java\/util\/LinkedHashMap$Entry.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$TreeNode.class\",\n-            \"\/modules\/java.base\/java\/lang\/StringConcatHelper.class\",\n-            \"\/modules\/java.base\/java\/lang\/VersionProps.class\",\n-            \"\/modules\/java.base\/java\/lang\/Runtime.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/Lock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Segment.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$CounterCell.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Node.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/LockSupport.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ReservationNode.class\",\n-            \"\/modules\/java.base\/java\/util\/AbstractSet.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$EntrySet.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$HashIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$EntryIterator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/StaticProperty.class\",\n-            \"\/modules\/java.base\/java\/io\/FileInputStream.class\",\n-            \"\/modules\/java.base\/java\/lang\/System$In.class\",\n-            \"\/modules\/java.base\/java\/io\/FileDescriptor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaIOFileDescriptorAccess.class\",\n-            \"\/modules\/java.base\/java\/io\/Flushable.class\",\n-            \"\/modules\/java.base\/java\/io\/OutputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/FileOutputStream.class\",\n-            \"\/modules\/java.base\/java\/lang\/System$Out.class\",\n-            \"\/modules\/java.base\/java\/io\/FilterInputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/BufferedInputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/FilterOutputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/PrintStream.class\",\n-            \"\/modules\/java.base\/java\/io\/BufferedOutputStream.class\",\n-            \"\/modules\/java.base\/java\/io\/Writer.class\",\n-            \"\/modules\/java.base\/java\/io\/OutputStreamWriter.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/StreamEncoder.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/CharsetEncoder.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_8$Encoder.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/CodingErrorAction.class\",\n-            \"\/modules\/java.base\/java\/util\/Arrays.class\",\n-            \"\/modules\/java.base\/java\/nio\/ByteBuffer.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/ScopedMemoryAccess.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/Function.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/Preconditions.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/BiFunction.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaNioAccess.class\",\n-            \"\/modules\/java.base\/java\/nio\/HeapByteBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/PreviewMode.DISABLED.class\",\n-            \"\/modules\/java.base\/java\/io\/BufferedWriter.class\",\n-            \"\/modules\/java.base\/java\/lang\/Terminator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/Signal$Handler.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/Signal.class\",\n-            \"\/modules\/java.base\/java\/util\/Hashtable$Entry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/Signal$NativeHandler.class\",\n-            \"\/modules\/java.base\/java\/lang\/Integer$IntegerCache.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/OSEnvironment.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread$State.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Reference$ReferenceHandler.class\",\n-            \"\/modules\/java.base\/java\/lang\/Thread$ThreadIdentifiers.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Finalizer$FinalizerThread.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/Cleaner.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$EmptySet.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$EmptyList.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$EmptyMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/IllegalArgumentException.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleStatics.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/ClassFileFormatVersion.class\",\n-            \"\/modules\/java.base\/java\/lang\/CharacterData.class\",\n-            \"\/modules\/java.base\/java\/lang\/CharacterDataLatin1.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ClassFileDumper.class\",\n-            \"\/modules\/java.base\/java\/util\/HexFormat.class\",\n-            \"\/modules\/java.base\/java\/lang\/Character$CharacterCache.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/atomic\/AtomicInteger.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MemberName$Factory.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/Reflection.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles$Lookup.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$MapN$MapNIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/KeyValueHolder.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/util\/VerifyAccess.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Modifier.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangModuleAccess.class\",\n-            \"\/modules\/java.base\/java\/io\/File.class\",\n-            \"\/modules\/java.base\/java\/io\/DefaultFileSystem.class\",\n-            \"\/modules\/java.base\/java\/io\/FileSystem.class\",\n-            \"\/modules\/java.base\/java\/io\/UnixFileSystem.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/DecimalDigits.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModulePatcher.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$IllegalNativeAccess.class\",\n-            \"\/modules\/java.base\/java\/util\/HashSet.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap$Modules.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$Counters.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ArchivedBootLayer.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ArchivedModuleGraph.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/SystemModuleFinders.class\",\n-            \"\/modules\/java.base\/java\/net\/URI.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaNetUriAccess.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/SystemModulesMap.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/SystemModules.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ExplodedSystemModules.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/Watchable.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/Path.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/FileSystems.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/DefaultFileSystemProvider.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/spi\/FileSystemProvider.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/AbstractFileSystemProvider.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileSystemProvider.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/LinuxFileSystemProvider.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/OpenOption.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/StandardOpenOption.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/FileSystem.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileSystem.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/LinuxFileSystem.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixPath.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/Util.class\",\n-            \"\/modules\/java.base\/java\/lang\/StringCoding.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixNativeDispatcher.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/BootLoader.class\",\n-            \"\/modules\/java.base\/java\/lang\/Module$EnableNativeAccess.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaderHelper.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$CollectionView.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$KeySetView.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$LibraryPaths.class\",\n-            \"\/modules\/java.base\/java\/io\/File$PathStatus.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$CountedLock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractQueuedSynchronizer.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock$Sync.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock$NonfairSync.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$NativeLibraryContext.class\",\n-            \"\/modules\/java.base\/java\/util\/Queue.class\",\n-            \"\/modules\/java.base\/java\/util\/Deque.class\",\n-            \"\/modules\/java.base\/java\/util\/ArrayDeque.class\",\n-            \"\/modules\/java.base\/java\/util\/ArrayDeque$DeqIterator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibrary.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$NativeLibraryImpl.class\",\n-            \"\/modules\/java.base\/java\/security\/cert\/Certificate.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ValuesView.class\",\n-            \"\/modules\/java.base\/java\/util\/Enumeration.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Traverser.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$BaseIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ValueIterator.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/BasicFileAttributes.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/PosixFileAttributes.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributes.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileStoreAttributes.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixMountEntry.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/CopyOption.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/LinkOption.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/Files.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffers.class\",\n-            \"\/modules\/java.base\/java\/lang\/ThreadLocal.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/CarrierThreadLocal.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/TerminatingThreadLocal.class\",\n-            \"\/modules\/java.base\/java\/lang\/ThreadLocal$ThreadLocalMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/ThreadLocal$ThreadLocalMap$Entry.class\",\n-            \"\/modules\/java.base\/java\/util\/IdentityHashMap.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$SetFromMap.class\",\n-            \"\/modules\/java.base\/java\/util\/IdentityHashMap$KeySet.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffer.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerFactory.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/ThreadFactory.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Cleaner.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanableList.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanableList$Node.class\",\n-            \"\/modules\/java.base\/java\/lang\/ref\/Cleaner$Cleanable.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/PhantomCleanable.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanerCleanable.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/InnocuousThread.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffer$Deallocator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$PhantomCleanableRef.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleFinder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModulePath.class\",\n-            \"\/modules\/java.base\/java\/util\/jar\/Attributes$Name.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/Array.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/perf\/PerfCounter.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/perf\/Perf.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/DirectBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/MappedByteBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/DirectByteBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/Bits.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/atomic\/AtomicLong.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/VM$BufferPool.class\",\n-            \"\/modules\/java.base\/java\/nio\/LongBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/DirectLongBufferU.class\",\n-            \"\/modules\/java.base\/java\/util\/zip\/ZipConstants.class\",\n-            \"\/modules\/java.base\/java\/util\/zip\/ZipFile.class\",\n-            \"\/modules\/java.base\/java\/util\/jar\/JarFile.class\",\n-            \"\/modules\/java.base\/java\/util\/BitSet.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilZipFileAccess.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilJarAccess.class\",\n-            \"\/modules\/java.base\/java\/util\/jar\/JavaUtilJarAccessImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/Runtime$Version.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$List12.class\",\n-            \"\/modules\/java.base\/java\/util\/Optional.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/DosFileAttributes.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/AttributeView.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/FileAttributeView.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/BasicFileAttributeView.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/DosFileAttributeView.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/UserDefinedFileAttributeView.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributeViews.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/DynamicFileAttributeView.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/AbstractBasicFileAttributeView.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributeViews$Basic.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributes$UnixAsBasicFileAttributes.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/DirectoryStream$Filter.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/Files$AcceptAllFilter.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/DirectoryStream.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/SecureDirectoryStream.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixSecureDirectoryStream.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixDirectoryStream.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReadWriteLock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractQueuedLongSynchronizer.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$Sync.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$FairSync.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$Sync$ThreadLocalHoldCounter.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$ReadLock.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$WriteLock.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixDirectoryStream$UnixDirectoryIterator.class\",\n-            \"\/modules\/java.base\/java\/nio\/file\/attribute\/FileAttribute.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileModeAttribute.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixChannelFactory.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixChannelFactory$Flags.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$EmptyIterator.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/Channel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/ReadableByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/WritableByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/ByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/SeekableByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/GatheringByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/ScatteringByteChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/InterruptibleChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/spi\/AbstractInterruptibleChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/FileChannel.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/FileChannelImpl.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/NativeDispatcher.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/FileDispatcher.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/UnixFileDispatcherImpl.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/FileDispatcherImpl.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/IOUtil.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/Interruptible.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/NativeThreadSet.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/FileChannelImpl$Closer.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/Channels.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/Streams.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/SelChImpl.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/NetworkChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/SelectableChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/spi\/AbstractSelectableChannel.class\",\n-            \"\/modules\/java.base\/java\/nio\/channels\/SocketChannel.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/SocketChannelImpl.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/ChannelInputStream.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaMetafactory.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/Supplier.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ReferencedKeySet.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ReferencedKeyMap.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ReferenceKey.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/StrongReferenceKey.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodTypeForm.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/WeakReferenceKey.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/util\/Wrapper.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/util\/Wrapper$Format.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/ConstantDescs.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/ClassDesc.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/ClassOrInterfaceDescImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/ArrayClassDescImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/ConstantUtils.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/DirectMethodHandleDesc$Kind.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/MethodTypeDesc.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/MethodTypeDescImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/MethodHandleDesc.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/DirectMethodHandleDesc.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/DirectMethodHandleDescImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/DynamicConstantDesc.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/constant\/PrimitiveClassDescImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/constant\/DynamicConstantDesc$AnonymousDynamicConstantDesc.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$NamedFunction.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Holder.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/util\/ValueConversions.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/Invokers.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Kind.class\",\n-            \"\/modules\/java.base\/java\/lang\/NoSuchMethodException.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$BasicType.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/TypeKind.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Name.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Holder.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/InvokerBytecodeGenerator.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/AnnotationElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Annotation.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ConstantPool.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ConstantPoolBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TemporaryConstantPool.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/PoolEntry.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/AnnotationConstantValueEntry.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/Utf8Entry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$Utf8EntryImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$Utf8EntryImpl$State.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AnnotationImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassFileElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Attribute.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/MethodElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/FieldElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/attribute\/RuntimeVisibleAnnotationsAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/Util$Writable.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractElement.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$UnboundRuntimeVisibleAnnotationsAttribute.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Attributes.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/AttributeMapper.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$RuntimeVisibleAnnotationsMapper.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/AttributeMapper$AttributeStability.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleImpl$Intrinsic.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/SplitConstantPool.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/BootstrapMethodEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BootstrapMethodEntryImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/EntryMap.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/Util.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/LoadableConstantEntry.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ClassEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractRefEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractNamedEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$ClassEntryImpl.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/Consumer.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassFile.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassFileImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassFileBuilder.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractDirectBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectClassBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AttributeHolder.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Superclass.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/SuperclassImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/attribute\/SourceFileAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$UnboundSourceFileAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$SourceFileMapper.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BoundAttribute.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/MethodBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/MethodInfo.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalMethodBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectMethodBuilder.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/NameAndTypeEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractRefsEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$NameAndTypeEntryImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/MemberRefEntry.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/FieldRefEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractMemberRefEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$FieldRefEntryImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/InvokerBytecodeGenerator$ClassData.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/CodeBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/LabelContext.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalCodeBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectCodeBuilder.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/CodeElement.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/PseudoInstruction.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/CharacterRange.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LocalVariable.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LocalVariableType.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectCodeBuilder$DeferredLabel.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/BufWriter.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BufWriterImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Label.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LabelTarget.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/LabelImpl.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/util\/VerifyType.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Opcode.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Opcode$Kind.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/MethodRefEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$MethodRefEntryImpl.class\",\n-            \"\/modules\/java.base\/sun\/invoke\/empty\/Empty.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BytecodeHelpers.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$AdHocAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$CodeMapper.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/FieldBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalFieldBuilder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectFieldBuilder.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/CustomAttribute.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AnnotationReader.class\",\n-            \"\/modules\/java.base\/java\/util\/ListIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$ListItr.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator$Frame.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator$Type.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/RawBytecodeHelper.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/RawBytecodeHelper$CodeRange.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassHierarchyResolver.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$ClassLoadingClassHierarchyResolver.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$CachedClassHierarchyResolver.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassHierarchyResolver$ClassHierarchyInfo.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$ClassHierarchyInfoImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/ClassReader.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassReaderImpl.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ModifiedUtf.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles$Lookup$ClassDefiner.class\",\n-            \"\/modules\/java.base\/java\/lang\/IncompatibleClassChangeError.class\",\n-            \"\/modules\/java.base\/java\/lang\/NoSuchMethodError.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BootstrapMethodInvoker.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/AbstractValidatingLambdaMetafactory.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/InnerClassLambdaMetafactory.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleInfo.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/InfoFromMemberName.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$Access.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilCollectionAccess.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/Interfaces.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/InterfacesImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/TypeConvertingMethodAdapter.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Constructor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangInvokeAccess.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessMode.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessType.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/Invokers$Holder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo.class\",\n-            \"\/modules\/java.base\/java\/io\/DataInput.class\",\n-            \"\/modules\/java.base\/java\/io\/DataInputStream.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$CountingDataInput.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/NativeThread.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/Blocker.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/Util.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/Util$BufferCache.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ch\/IOStatus.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/util\/ByteArray.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandles.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsShorts$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsShorts$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleGuards.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarForm.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsChars$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsChars$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsInts$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsInts$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsFloats$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsFloats$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsLongs$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsLongs$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsDoubles$ByteArrayViewVarHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsDoubles$ArrayHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessDescriptor.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$Entry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$IndexEntry.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/StandardCharsets.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/US_ASCII.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/ISO_8859_1.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16BE.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16LE.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32BE.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32LE.class\",\n-            \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$ValueEntry.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Builder.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Modifier.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/AccessFlag.class\",\n-            \"\/modules\/java.base\/java\/lang\/reflect\/AccessFlag$Location.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Requires$Modifier.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Requires.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$KeySet.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$KeyIterator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/Checks.class\",\n-            \"\/modules\/java.base\/java\/util\/ArrayList$Itr.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Provides.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$UnmodifiableCollection.class\",\n-            \"\/modules\/java.base\/java\/util\/Collections$UnmodifiableSet.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$Values.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$ValueIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/ImmutableCollections$SetN$SetNIterator.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$Attributes.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleReferences.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleReader.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixUriUtils.class\",\n-            \"\/modules\/java.base\/java\/net\/URI$Parser.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleReference.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleReferenceImpl.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Exports.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Opens.class\",\n-            \"\/modules\/java.base\/sun\/nio\/fs\/UnixException.class\",\n-            \"\/modules\/java.base\/java\/io\/IOException.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ArchivedClassLoaders.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$BootClassLoader.class\",\n-            \"\/modules\/java.base\/java\/lang\/ClassLoader$ParallelLoaders.class\",\n-            \"\/modules\/java.base\/java\/util\/WeakHashMap.class\",\n-            \"\/modules\/java.base\/java\/util\/WeakHashMap$Entry.class\",\n-            \"\/modules\/java.base\/java\/util\/WeakHashMap$KeySet.class\",\n-            \"\/modules\/java.base\/java\/security\/Principal.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath.class\",\n-            \"\/modules\/java.base\/java\/net\/URLStreamHandlerFactory.class\",\n-            \"\/modules\/java.base\/java\/net\/URL$DefaultFactory.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/access\/JavaNetURLAccess.class\",\n-            \"\/modules\/java.base\/sun\/net\/www\/ParseUtil.class\",\n-            \"\/modules\/java.base\/java\/net\/URLStreamHandler.class\",\n-            \"\/modules\/java.base\/sun\/net\/www\/protocol\/file\/Handler.class\",\n-            \"\/modules\/java.base\/sun\/net\/util\/IPAddressUtil.class\",\n-            \"\/modules\/java.base\/sun\/net\/util\/IPAddressUtil$MASKS.class\",\n-            \"\/modules\/java.base\/sun\/net\/www\/protocol\/jar\/Handler.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ServicesCatalog.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/AbstractClassLoaderValue.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaderValue.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/BuiltinClassLoader$LoadedModule.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/DefaultRoots.class\",\n-            \"\/modules\/java.base\/java\/util\/Spliterator.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$HashMapSpliterator.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$ValueSpliterator.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/StreamSupport.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/BaseStream.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Stream.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/PipelineHelper.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/AbstractPipeline.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline$Head.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag$Type.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag$MaskBuilder.class\",\n-            \"\/modules\/java.base\/java\/util\/EnumMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/Class$ReflectionData.class\",\n-            \"\/modules\/java.base\/java\/lang\/Class$Atomic.class\",\n-            \"\/modules\/java.base\/java\/lang\/PublicMethods$MethodList.class\",\n-            \"\/modules\/java.base\/java\/lang\/PublicMethods$Key.class\",\n-            \"\/modules\/java.base\/sun\/reflect\/annotation\/AnnotationParser.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodHandleAccessorFactory.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodHandleAccessorFactory$LazyStaticHolder.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Specializer.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/annotation\/Stable.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer$SpeciesData.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$SpeciesData.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer$Factory.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Specializer$Factory.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/SimpleMethodHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/NoSuchFieldException.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Species_L.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Accessor.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DelegatingMethodHandle.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DelegatingMethodHandle$Holder.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor$TransformKey.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormBuffer.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor$Transform.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/reflect\/DirectMethodHandleAccessor.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Collectors.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Collector$Characteristics.class\",\n-            \"\/modules\/java.base\/java\/util\/EnumSet.class\",\n-            \"\/modules\/java.base\/java\/util\/RegularEnumSet.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Collector.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Collectors$CollectorImpl.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/BiConsumer.class\",\n-            \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Interface.class\",\n-            \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/InterfaceMethodRefEntry.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$InterfaceMethodRefEntryImpl.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/BinaryOperator.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReduceOps.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/TerminalOp.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$ReduceOp.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/StreamShape.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Sink.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/TerminalSink.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$AccumulatingSink.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$Box.class\",\n-            \"\/modules\/java.base\/java\/util\/HashMap$KeySpliterator.class\",\n-            \"\/modules\/java.base\/java\/util\/function\/Predicate.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline$StatelessOp.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/Sink$ChainedReference.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleResolution.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/FindOps.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindSink.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindSink$OfRef.class\",\n-            \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindOp.class\",\n-            \"\/modules\/java.base\/java\/util\/Spliterators.class\",\n-            \"\/modules\/java.base\/java\/util\/Spliterators$IteratorSpliterator.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/Configuration.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/Resolver.class\",\n-            \"\/modules\/java.base\/java\/lang\/ModuleLayer.class\",\n-            \"\/modules\/java.base\/java\/util\/SequencedSet.class\",\n-            \"\/modules\/java.base\/java\/util\/LinkedHashSet.class\",\n-            \"\/modules\/java.base\/java\/util\/SequencedMap.class\",\n-            \"\/modules\/java.base\/java\/util\/LinkedHashMap.class\",\n-            \"\/modules\/java.base\/java\/lang\/module\/ResolvedModule.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap$Mapper.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/AbstractClassLoaderValue$Memoizer.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ServicesCatalog$ServiceProvider.class\",\n-            \"\/modules\/java.base\/java\/util\/concurrent\/CopyOnWriteArrayList.class\",\n-            \"\/modules\/java.base\/java\/lang\/ModuleLayer$Controller.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$SafeModuleFinder.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/ContinuationSupport.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/vm\/Continuation$Pinned.class\",\n-            \"\/modules\/java.base\/sun\/launcher\/LauncherHelper.class\",\n-            \"\/modules\/java.base\/sun\/net\/util\/URLUtil.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath$Loader.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath$FileLoader.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/loader\/Resource.class\",\n-            \"\/modules\/java.base\/java\/io\/FileCleanable.class\",\n-            \"\/modules\/java.base\/sun\/nio\/ByteBuffered.class\",\n-            \"\/modules\/java.base\/java\/security\/SecureClassLoader$CodeSourceKey.class\",\n-            \"\/modules\/java.base\/java\/security\/PermissionCollection.class\",\n-            \"\/modules\/java.base\/java\/security\/Permissions.class\",\n-            \"\/modules\/java.base\/java\/lang\/NamedPackage.class\",\n-            \"\/modules\/java.base\/jdk\/internal\/misc\/MethodFinder.class\",\n-            \"\/modules\/java.base\/java\/lang\/Readable.class\",\n-            \"\/modules\/java.base\/java\/nio\/CharBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/HeapCharBuffer.class\",\n-            \"\/modules\/java.base\/java\/nio\/charset\/CoderResult.class\",\n-            \"\/modules\/java.base\/java\/util\/IdentityHashMap$IdentityHashMapIterator.class\",\n-            \"\/modules\/java.base\/java\/util\/IdentityHashMap$KeyIterator.class\",\n-            \"\/modules\/java.base\/java\/lang\/Shutdown.class\",\n-            \"\/modules\/java.base\/java\/lang\/Shutdown$Lock.class\");\n+    \/\/\/ Note: This list is inherently a little fragile and may end up being more\n+    \/\/\/ trouble than it's worth to maintain. If it turns out that it needs to be\n+    \/\/\/ regenerated often when this benchmark is run, then a new approach should\n+    \/\/\/ be considered, such as:\n+    \/\/\/ * Limit the list of classes to non-internal ones.\n+    \/\/\/ * Calculate the list dynamically based on the running JVM.\n+    \/\/\/ * Build a custom jimage file similar to ImageReaderTest\n+    private static final class ClassList {\n+        \/\/\/ Returns the names of resource nodes expected to be present in the\n+        \/\/\/ reader, excluding preview mode paths (i.e. \"\/META-INF\/preview\/\").\n+        private static Set<String> names() {\n+            return INIT_CLASSES;\n+        }\n+\n+        \/\/\/ Returns the number of resources present.\n+        private static int count() {\n+            return INIT_CLASSES.size();\n+        }\n+\n+        \/\/\/ Returns the resource nodes represented as a map from module name to\n+        \/\/\/ resource path. This is suitable for testing functions like\n+        \/\/\/ {@link ImageReader#containsResource(String, String)} without the\n+        \/\/\/ overhead of splitting resource names during the trial.\n+        private static Map<String, List<String>> pathMap() {\n+            return MODULE_TO_PATHS;\n+        }\n+\n+        \/\/ Created by running \"java -verbose:class\", throwing away anonymous inner\n+        \/\/ classes and anything without a reliable name, and grouping by the stated\n+        \/\/ source. It's not perfect, but it's representative.\n+        \/\/\n+        \/\/ <jdk_root>\/bin\/java -verbose:class HelloWorld 2>&1 \\\n+        \/\/   | fgrep '[class,load]' | cut -d' ' -f2 \\\n+        \/\/   | tr '.' '\/' \\\n+        \/\/   | egrep -v '\\$[0-9$]' \\\n+        \/\/   | fgrep -v 'HelloWorld' \\\n+        \/\/   | fgrep -v '\/META-INF\/preview\/' \\\n+        \/\/   | while read f ; do echo \"${f}.class\" ; done \\\n+        \/\/   > initclasses.txt\n+        \/\/\n+        \/\/ Output:\n+        \/\/    java\/lang\/Object.class\n+        \/\/    java\/io\/Serializable.class\n+        \/\/    ...\n+        \/\/\n+        \/\/ jimage list <jdk_root>\/images\/jdk\/lib\/modules \\\n+        \/\/     | awk '\/^Module: *\/ { MOD=$2 }; \/^    *\/ { print \"\/modules\/\"MOD\"\/\"$1 }' \\\n+        \/\/     > fullpaths.txt\n+        \/\/\n+        \/\/ Output:\n+        \/\/     ...\n+        \/\/     \/modules\/java.base\/java\/lang\/Object.class\n+        \/\/     \/modules\/java.base\/java\/lang\/OutOfMemoryError.class\n+        \/\/     ...\n+        \/\/\n+        \/\/ while read c ; do grep \"\/$c\" fullpaths.txt ; done < initclasses.txt \\\n+        \/\/     | while read c ; do printf '    \"%s\",\\n' \"$c\" ; done \\\n+        \/\/     > initpaths.txt\n+        \/\/\n+        \/\/ Output:\n+        private static final Set<String> INIT_CLASSES = Set.of(\n+                \"\/modules\/java.base\/java\/lang\/Object.class\",\n+                \"\/modules\/java.base\/java\/io\/Serializable.class\",\n+                \"\/modules\/java.base\/java\/lang\/Comparable.class\",\n+                \"\/modules\/java.base\/java\/lang\/CharSequence.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/Constable.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/ConstantDesc.class\",\n+                \"\/modules\/java.base\/java\/lang\/String.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/AnnotatedElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/GenericDeclaration.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Type.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor$OfField.class\",\n+                \"\/modules\/java.base\/java\/lang\/Class.class\",\n+                \"\/modules\/java.base\/java\/lang\/Cloneable.class\",\n+                \"\/modules\/java.base\/java\/lang\/ClassLoader.class\",\n+                \"\/modules\/java.base\/java\/lang\/System.class\",\n+                \"\/modules\/java.base\/java\/lang\/Throwable.class\",\n+                \"\/modules\/java.base\/java\/lang\/Error.class\",\n+                \"\/modules\/java.base\/java\/lang\/Exception.class\",\n+                \"\/modules\/java.base\/java\/lang\/RuntimeException.class\",\n+                \"\/modules\/java.base\/java\/security\/ProtectionDomain.class\",\n+                \"\/modules\/java.base\/java\/security\/SecureClassLoader.class\",\n+                \"\/modules\/java.base\/java\/lang\/ReflectiveOperationException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ClassNotFoundException.class\",\n+                \"\/modules\/java.base\/java\/lang\/Record.class\",\n+                \"\/modules\/java.base\/java\/lang\/LinkageError.class\",\n+                \"\/modules\/java.base\/java\/lang\/NoClassDefFoundError.class\",\n+                \"\/modules\/java.base\/java\/lang\/ClassCastException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ArrayStoreException.class\",\n+                \"\/modules\/java.base\/java\/lang\/VirtualMachineError.class\",\n+                \"\/modules\/java.base\/java\/lang\/InternalError.class\",\n+                \"\/modules\/java.base\/java\/lang\/OutOfMemoryError.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackOverflowError.class\",\n+                \"\/modules\/java.base\/java\/lang\/IllegalMonitorStateException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Reference.class\",\n+                \"\/modules\/java.base\/java\/lang\/IllegalCallerException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/SoftReference.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/WeakReference.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/FinalReference.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/PhantomReference.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Finalizer.class\",\n+                \"\/modules\/java.base\/java\/lang\/Runnable.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread$FieldHolder.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread$Constants.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread$UncaughtExceptionHandler.class\",\n+                \"\/modules\/java.base\/java\/lang\/ThreadGroup.class\",\n+                \"\/modules\/java.base\/java\/lang\/BaseVirtualThread.class\",\n+                \"\/modules\/java.base\/java\/lang\/VirtualThread.class\",\n+                \"\/modules\/java.base\/java\/lang\/ThreadBuilders$BoundVirtualThread.class\",\n+                \"\/modules\/java.base\/java\/util\/Map.class\",\n+                \"\/modules\/java.base\/java\/util\/Dictionary.class\",\n+                \"\/modules\/java.base\/java\/util\/Hashtable.class\",\n+                \"\/modules\/java.base\/java\/util\/Properties.class\",\n+                \"\/modules\/java.base\/java\/lang\/Module.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/AccessibleObject.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Member.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Field.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Parameter.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Executable.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Method.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Constructor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/ContinuationScope.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/Continuation.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/StackChunk.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodAccessor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodAccessorImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstantPool.class\",\n+                \"\/modules\/java.base\/java\/lang\/annotation\/Annotation.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/CallerSensitive.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstructorAccessor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/ConstructorAccessorImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/DirectConstructorHandleAccessor$NativeAccessor.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MemberName.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/ResolvedMethodName.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleNatives.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/TypeDescriptor$OfMethod.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodType.class\",\n+                \"\/modules\/java.base\/java\/lang\/BootstrapMethodError.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/CallSite.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/NativeEntryPoint.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/ABIDescriptor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/VMStorage.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/foreign\/abi\/UpcallLinker$CallRegs.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/ConstantCallSite.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MutableCallSite.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VolatileCallSite.class\",\n+                \"\/modules\/java.base\/java\/lang\/AssertionStatusDirectives.class\",\n+                \"\/modules\/java.base\/java\/lang\/Appendable.class\",\n+                \"\/modules\/java.base\/java\/lang\/AbstractStringBuilder.class\",\n+                \"\/modules\/java.base\/java\/lang\/StringBuffer.class\",\n+                \"\/modules\/java.base\/java\/lang\/StringBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/UnsafeConstants.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/Unsafe.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/Modules.class\",\n+                \"\/modules\/java.base\/java\/lang\/AutoCloseable.class\",\n+                \"\/modules\/java.base\/java\/io\/Closeable.class\",\n+                \"\/modules\/java.base\/java\/io\/InputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/ByteArrayInputStream.class\",\n+                \"\/modules\/java.base\/java\/net\/URL.class\",\n+                \"\/modules\/java.base\/java\/lang\/Enum.class\",\n+                \"\/modules\/java.base\/java\/util\/jar\/Manifest.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/BuiltinClassLoader.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$AppClassLoader.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$PlatformClassLoader.class\",\n+                \"\/modules\/java.base\/java\/security\/CodeSource.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentMap.class\",\n+                \"\/modules\/java.base\/java\/util\/AbstractMap.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/Iterable.class\",\n+                \"\/modules\/java.base\/java\/util\/Collection.class\",\n+                \"\/modules\/java.base\/java\/util\/SequencedCollection.class\",\n+                \"\/modules\/java.base\/java\/util\/List.class\",\n+                \"\/modules\/java.base\/java\/util\/RandomAccess.class\",\n+                \"\/modules\/java.base\/java\/util\/AbstractCollection.class\",\n+                \"\/modules\/java.base\/java\/util\/AbstractList.class\",\n+                \"\/modules\/java.base\/java\/util\/ArrayList.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackTraceElement.class\",\n+                \"\/modules\/java.base\/java\/nio\/Buffer.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackWalker.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackStreamFactory$AbstractStackWalker.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackWalker$StackFrame.class\",\n+                \"\/modules\/java.base\/java\/lang\/ClassFrameInfo.class\",\n+                \"\/modules\/java.base\/java\/lang\/StackFrameInfo.class\",\n+                \"\/modules\/java.base\/java\/lang\/LiveStackFrame.class\",\n+                \"\/modules\/java.base\/java\/lang\/LiveStackFrameInfo.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractOwnableSynchronizer.class\",\n+                \"\/modules\/java.base\/java\/lang\/Boolean.class\",\n+                \"\/modules\/java.base\/java\/lang\/Character.class\",\n+                \"\/modules\/java.base\/java\/lang\/Number.class\",\n+                \"\/modules\/java.base\/java\/lang\/Float.class\",\n+                \"\/modules\/java.base\/java\/lang\/Double.class\",\n+                \"\/modules\/java.base\/java\/lang\/Byte.class\",\n+                \"\/modules\/java.base\/java\/lang\/Short.class\",\n+                \"\/modules\/java.base\/java\/lang\/Integer.class\",\n+                \"\/modules\/java.base\/java\/lang\/Long.class\",\n+                \"\/modules\/java.base\/java\/lang\/Void.class\",\n+                \"\/modules\/java.base\/java\/util\/Iterator.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/RecordComponent.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorPayload.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$Vector.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorMask.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/vector\/VectorSupport$VectorShuffle.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/FillerObject.class\",\n+                \"\/modules\/java.base\/java\/lang\/NullPointerException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ArithmeticException.class\",\n+                \"\/modules\/java.base\/java\/lang\/IndexOutOfBoundsException.class\",\n+                \"\/modules\/java.base\/java\/lang\/ArrayIndexOutOfBoundsException.class\",\n+                \"\/modules\/java.base\/java\/io\/ObjectStreamField.class\",\n+                \"\/modules\/java.base\/java\/util\/Comparator.class\",\n+                \"\/modules\/java.base\/java\/lang\/String$CaseInsensitiveComparator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/VM.class\",\n+                \"\/modules\/java.base\/java\/lang\/Module$ArchivedData.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/CDS.class\",\n+                \"\/modules\/java.base\/java\/util\/Set.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableCollection.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableSet.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$Set12.class\",\n+                \"\/modules\/java.base\/java\/util\/Objects.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableList.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$ListN.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$SetN.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$AbstractImmutableMap.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$MapN.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangReflectAccess.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/ReflectAccess.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/SharedSecrets.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/ReflectionFactory.class\",\n+                \"\/modules\/java.base\/java\/io\/ObjectStreamClass.class\",\n+                \"\/modules\/java.base\/java\/lang\/Math.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/ReflectionFactory$Config.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangRefAccess.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue$Null.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/ReferenceQueue$Lock.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangAccess.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/SystemProps.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/SystemProps$Raw.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/Charset.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/spi\/CharsetProvider.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/StandardCharsets.class\",\n+                \"\/modules\/java.base\/java\/lang\/StringLatin1.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/HistoricallyNamedCharset.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/Unicode.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_8.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/StrictMath.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ArraysSupport.class\",\n+                \"\/modules\/java.base\/java\/util\/Map$Entry.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$Node.class\",\n+                \"\/modules\/java.base\/java\/util\/LinkedHashMap$Entry.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$TreeNode.class\",\n+                \"\/modules\/java.base\/java\/lang\/StringConcatHelper.class\",\n+                \"\/modules\/java.base\/java\/lang\/VersionProps.class\",\n+                \"\/modules\/java.base\/java\/lang\/Runtime.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/Lock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Segment.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$CounterCell.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Node.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/LockSupport.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ReservationNode.class\",\n+                \"\/modules\/java.base\/java\/util\/AbstractSet.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$EntrySet.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$HashIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$EntryIterator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/StaticProperty.class\",\n+                \"\/modules\/java.base\/java\/io\/FileInputStream.class\",\n+                \"\/modules\/java.base\/java\/lang\/System$In.class\",\n+                \"\/modules\/java.base\/java\/io\/FileDescriptor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaIOFileDescriptorAccess.class\",\n+                \"\/modules\/java.base\/java\/io\/Flushable.class\",\n+                \"\/modules\/java.base\/java\/io\/OutputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/FileOutputStream.class\",\n+                \"\/modules\/java.base\/java\/lang\/System$Out.class\",\n+                \"\/modules\/java.base\/java\/io\/FilterInputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/BufferedInputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/FilterOutputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/PrintStream.class\",\n+                \"\/modules\/java.base\/java\/io\/BufferedOutputStream.class\",\n+                \"\/modules\/java.base\/java\/io\/Writer.class\",\n+                \"\/modules\/java.base\/java\/io\/OutputStreamWriter.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/StreamEncoder.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/CharsetEncoder.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_8$Encoder.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/CodingErrorAction.class\",\n+                \"\/modules\/java.base\/java\/util\/Arrays.class\",\n+                \"\/modules\/java.base\/java\/nio\/ByteBuffer.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/ScopedMemoryAccess.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/Function.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/Preconditions.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/BiFunction.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaNioAccess.class\",\n+                \"\/modules\/java.base\/java\/nio\/HeapByteBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/ByteOrder.class\",\n+                \"\/modules\/java.base\/java\/io\/BufferedWriter.class\",\n+                \"\/modules\/java.base\/java\/lang\/Terminator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/Signal$Handler.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/Signal.class\",\n+                \"\/modules\/java.base\/java\/util\/Hashtable$Entry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/Signal$NativeHandler.class\",\n+                \"\/modules\/java.base\/java\/lang\/Integer$IntegerCache.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/OSEnvironment.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread$State.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Reference$ReferenceHandler.class\",\n+                \"\/modules\/java.base\/java\/lang\/Thread$ThreadIdentifiers.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Finalizer$FinalizerThread.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/Cleaner.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$EmptySet.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$EmptyList.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$EmptyMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/IllegalArgumentException.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleStatics.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/ClassFileFormatVersion.class\",\n+                \"\/modules\/java.base\/java\/lang\/CharacterData.class\",\n+                \"\/modules\/java.base\/java\/lang\/CharacterDataLatin1.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ClassFileDumper.class\",\n+                \"\/modules\/java.base\/java\/util\/HexFormat.class\",\n+                \"\/modules\/java.base\/java\/lang\/Character$CharacterCache.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/atomic\/AtomicInteger.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MemberName$Factory.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/Reflection.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles$Lookup.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$MapN$MapNIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/KeyValueHolder.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/util\/VerifyAccess.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Modifier.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangModuleAccess.class\",\n+                \"\/modules\/java.base\/java\/io\/File.class\",\n+                \"\/modules\/java.base\/java\/io\/DefaultFileSystem.class\",\n+                \"\/modules\/java.base\/java\/io\/FileSystem.class\",\n+                \"\/modules\/java.base\/java\/io\/UnixFileSystem.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/DecimalDigits.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModulePatcher.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$IllegalNativeAccess.class\",\n+                \"\/modules\/java.base\/java\/util\/HashSet.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap$Modules.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$Counters.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ArchivedBootLayer.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ArchivedModuleGraph.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/SystemModuleFinders.class\",\n+                \"\/modules\/java.base\/java\/net\/URI.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaNetUriAccess.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/SystemModulesMap.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/SystemModules.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ExplodedSystemModules.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/Watchable.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/Path.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/FileSystems.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/DefaultFileSystemProvider.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/spi\/FileSystemProvider.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/AbstractFileSystemProvider.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileSystemProvider.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/LinuxFileSystemProvider.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/OpenOption.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/StandardOpenOption.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/FileSystem.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileSystem.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/LinuxFileSystem.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixPath.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/Util.class\",\n+                \"\/modules\/java.base\/java\/lang\/StringCoding.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixNativeDispatcher.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/BootLoader.class\",\n+                \"\/modules\/java.base\/java\/lang\/Module$EnableNativeAccess.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaderHelper.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$CollectionView.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$KeySetView.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$LibraryPaths.class\",\n+                \"\/modules\/java.base\/java\/io\/File$PathStatus.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$CountedLock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractQueuedSynchronizer.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock$Sync.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantLock$NonfairSync.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$NativeLibraryContext.class\",\n+                \"\/modules\/java.base\/java\/util\/Queue.class\",\n+                \"\/modules\/java.base\/java\/util\/Deque.class\",\n+                \"\/modules\/java.base\/java\/util\/ArrayDeque.class\",\n+                \"\/modules\/java.base\/java\/util\/ArrayDeque$DeqIterator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibrary.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/NativeLibraries$NativeLibraryImpl.class\",\n+                \"\/modules\/java.base\/java\/security\/cert\/Certificate.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ValuesView.class\",\n+                \"\/modules\/java.base\/java\/util\/Enumeration.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$Traverser.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$BaseIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ConcurrentHashMap$ValueIterator.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/BasicFileAttributes.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/PosixFileAttributes.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributes.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileStoreAttributes.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixMountEntry.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/CopyOption.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/LinkOption.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/Files.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffers.class\",\n+                \"\/modules\/java.base\/java\/lang\/ThreadLocal.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/CarrierThreadLocal.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/TerminatingThreadLocal.class\",\n+                \"\/modules\/java.base\/java\/lang\/ThreadLocal$ThreadLocalMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/ThreadLocal$ThreadLocalMap$Entry.class\",\n+                \"\/modules\/java.base\/java\/util\/IdentityHashMap.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$SetFromMap.class\",\n+                \"\/modules\/java.base\/java\/util\/IdentityHashMap$KeySet.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffer.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerFactory.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/ThreadFactory.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Cleaner.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanableList.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanableList$Node.class\",\n+                \"\/modules\/java.base\/java\/lang\/ref\/Cleaner$Cleanable.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/PhantomCleanable.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$CleanerCleanable.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/InnocuousThread.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/NativeBuffer$Deallocator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/ref\/CleanerImpl$PhantomCleanableRef.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleFinder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModulePath.class\",\n+                \"\/modules\/java.base\/java\/util\/jar\/Attributes$Name.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/Array.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/perf\/PerfCounter.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/perf\/Perf.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/DirectBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/MappedByteBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/DirectByteBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/Bits.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/atomic\/AtomicLong.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/VM$BufferPool.class\",\n+                \"\/modules\/java.base\/java\/nio\/LongBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/DirectLongBufferU.class\",\n+                \"\/modules\/java.base\/java\/util\/zip\/ZipConstants.class\",\n+                \"\/modules\/java.base\/java\/util\/zip\/ZipFile.class\",\n+                \"\/modules\/java.base\/java\/util\/jar\/JarFile.class\",\n+                \"\/modules\/java.base\/java\/util\/BitSet.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilZipFileAccess.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilJarAccess.class\",\n+                \"\/modules\/java.base\/java\/util\/jar\/JavaUtilJarAccessImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/Runtime$Version.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$List12.class\",\n+                \"\/modules\/java.base\/java\/util\/Optional.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/DosFileAttributes.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/AttributeView.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/FileAttributeView.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/BasicFileAttributeView.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/DosFileAttributeView.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/UserDefinedFileAttributeView.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributeViews.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/DynamicFileAttributeView.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/AbstractBasicFileAttributeView.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributeViews$Basic.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileAttributes$UnixAsBasicFileAttributes.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/DirectoryStream$Filter.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/Files$AcceptAllFilter.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/DirectoryStream.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/SecureDirectoryStream.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixSecureDirectoryStream.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixDirectoryStream.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReadWriteLock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/AbstractQueuedLongSynchronizer.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$Sync.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$FairSync.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$Sync$ThreadLocalHoldCounter.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$ReadLock.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/locks\/ReentrantReadWriteLock$WriteLock.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixDirectoryStream$UnixDirectoryIterator.class\",\n+                \"\/modules\/java.base\/java\/nio\/file\/attribute\/FileAttribute.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixFileModeAttribute.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixChannelFactory.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixChannelFactory$Flags.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$EmptyIterator.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/Channel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/ReadableByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/WritableByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/ByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/SeekableByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/GatheringByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/ScatteringByteChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/InterruptibleChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/spi\/AbstractInterruptibleChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/FileChannel.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/FileChannelImpl.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/NativeDispatcher.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/FileDispatcher.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/UnixFileDispatcherImpl.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/FileDispatcherImpl.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/IOUtil.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/Interruptible.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/NativeThreadSet.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/FileChannelImpl$Closer.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/Channels.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/Streams.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/SelChImpl.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/NetworkChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/SelectableChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/spi\/AbstractSelectableChannel.class\",\n+                \"\/modules\/java.base\/java\/nio\/channels\/SocketChannel.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/SocketChannelImpl.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/ChannelInputStream.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaMetafactory.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/Supplier.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ReferencedKeySet.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ReferencedKeyMap.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ReferenceKey.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/StrongReferenceKey.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodTypeForm.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/WeakReferenceKey.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/util\/Wrapper.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/util\/Wrapper$Format.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/ConstantDescs.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/ClassDesc.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/ClassOrInterfaceDescImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/ArrayClassDescImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/ConstantUtils.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/DirectMethodHandleDesc$Kind.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/MethodTypeDesc.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/MethodTypeDescImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/MethodHandleDesc.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/DirectMethodHandleDesc.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/DirectMethodHandleDescImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/DynamicConstantDesc.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/constant\/PrimitiveClassDescImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/constant\/DynamicConstantDesc$AnonymousDynamicConstantDesc.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$NamedFunction.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Holder.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/util\/ValueConversions.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/Invokers.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Kind.class\",\n+                \"\/modules\/java.base\/java\/lang\/NoSuchMethodException.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$BasicType.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/TypeKind.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Name.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaForm$Holder.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/InvokerBytecodeGenerator.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/AnnotationElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Annotation.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ConstantPool.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ConstantPoolBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TemporaryConstantPool.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/PoolEntry.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/AnnotationConstantValueEntry.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/Utf8Entry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$Utf8EntryImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$Utf8EntryImpl$State.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AnnotationImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassFileElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Attribute.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/MethodElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/FieldElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/attribute\/RuntimeVisibleAnnotationsAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/Util$Writable.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractElement.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$UnboundRuntimeVisibleAnnotationsAttribute.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Attributes.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/AttributeMapper.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$RuntimeVisibleAnnotationsMapper.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/AttributeMapper$AttributeStability.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleImpl$Intrinsic.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/SplitConstantPool.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/BootstrapMethodEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BootstrapMethodEntryImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/EntryMap.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/Util.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/LoadableConstantEntry.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/ClassEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractRefEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractNamedEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$ClassEntryImpl.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/Consumer.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassFile.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassFileImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassFileBuilder.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractDirectBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectClassBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AttributeHolder.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Superclass.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/SuperclassImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/attribute\/SourceFileAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$UnboundSourceFileAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$SourceFileMapper.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BoundAttribute.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/MethodBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/MethodInfo.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalMethodBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectMethodBuilder.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/NameAndTypeEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractRefsEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$NameAndTypeEntryImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/MemberRefEntry.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/FieldRefEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$AbstractMemberRefEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$FieldRefEntryImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/InvokerBytecodeGenerator$ClassData.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/CodeBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/LabelContext.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalCodeBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectCodeBuilder.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/CodeElement.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/PseudoInstruction.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/CharacterRange.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LocalVariable.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LocalVariableType.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectCodeBuilder$DeferredLabel.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/BufWriter.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BufWriterImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Label.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/instruction\/LabelTarget.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/LabelImpl.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/util\/VerifyType.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Opcode.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Opcode$Kind.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/MethodRefEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$MethodRefEntryImpl.class\",\n+                \"\/modules\/java.base\/sun\/invoke\/empty\/Empty.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/BytecodeHelpers.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/UnboundAttribute$AdHocAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractAttributeMapper$CodeMapper.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/FieldBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/TerminalFieldBuilder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/DirectFieldBuilder.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/CustomAttribute.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AnnotationReader.class\",\n+                \"\/modules\/java.base\/java\/util\/ListIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$ListItr.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator$Frame.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/StackMapGenerator$Type.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/RawBytecodeHelper.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/RawBytecodeHelper$CodeRange.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassHierarchyResolver.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$ClassLoadingClassHierarchyResolver.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$CachedClassHierarchyResolver.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassHierarchyResolver$ClassHierarchyInfo.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassHierarchyImpl$ClassHierarchyInfoImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/ClassReader.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/ClassReaderImpl.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ModifiedUtf.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandles$Lookup$ClassDefiner.class\",\n+                \"\/modules\/java.base\/java\/lang\/IncompatibleClassChangeError.class\",\n+                \"\/modules\/java.base\/java\/lang\/NoSuchMethodError.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BootstrapMethodInvoker.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/AbstractValidatingLambdaMetafactory.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/InnerClassLambdaMetafactory.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/MethodHandleInfo.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/InfoFromMemberName.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$Access.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaUtilCollectionAccess.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/Interfaces.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/InterfacesImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/TypeConvertingMethodAdapter.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Constructor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaLangInvokeAccess.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessMode.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessType.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/Invokers$Holder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo.class\",\n+                \"\/modules\/java.base\/java\/io\/DataInput.class\",\n+                \"\/modules\/java.base\/java\/io\/DataInputStream.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$CountingDataInput.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/NativeThread.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/Blocker.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/Util.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/Util$BufferCache.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ch\/IOStatus.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/util\/ByteArray.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandles.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsShorts$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsShorts$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleGuards.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarForm.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsChars$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsChars$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsInts$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsInts$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsFloats$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsFloats$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsLongs$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsLongs$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsDoubles$ByteArrayViewVarHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandleByteArrayAsDoubles$ArrayHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/VarHandle$AccessDescriptor.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$Entry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$IndexEntry.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/StandardCharsets.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/US_ASCII.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/ISO_8859_1.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16BE.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16LE.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_16.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32BE.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32LE.class\",\n+                \"\/modules\/java.base\/sun\/nio\/cs\/UTF_32.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$ConstantPool$ValueEntry.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Builder.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Modifier.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/AccessFlag.class\",\n+                \"\/modules\/java.base\/java\/lang\/reflect\/AccessFlag$Location.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Requires$Modifier.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Requires.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$KeySet.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$KeyIterator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/Checks.class\",\n+                \"\/modules\/java.base\/java\/util\/ArrayList$Itr.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Provides.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$UnmodifiableCollection.class\",\n+                \"\/modules\/java.base\/java\/util\/Collections$UnmodifiableSet.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$Values.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$ValueIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/ImmutableCollections$SetN$SetNIterator.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleInfo$Attributes.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleReferences.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleReader.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixUriUtils.class\",\n+                \"\/modules\/java.base\/java\/net\/URI$Parser.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleReference.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleReferenceImpl.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Exports.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ModuleDescriptor$Opens.class\",\n+                \"\/modules\/java.base\/sun\/nio\/fs\/UnixException.class\",\n+                \"\/modules\/java.base\/java\/io\/IOException.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ArchivedClassLoaders.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaders$BootClassLoader.class\",\n+                \"\/modules\/java.base\/java\/lang\/ClassLoader$ParallelLoaders.class\",\n+                \"\/modules\/java.base\/java\/util\/WeakHashMap.class\",\n+                \"\/modules\/java.base\/java\/util\/WeakHashMap$Entry.class\",\n+                \"\/modules\/java.base\/java\/util\/WeakHashMap$KeySet.class\",\n+                \"\/modules\/java.base\/java\/security\/Principal.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath.class\",\n+                \"\/modules\/java.base\/java\/net\/URLStreamHandlerFactory.class\",\n+                \"\/modules\/java.base\/java\/net\/URL$DefaultFactory.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/access\/JavaNetURLAccess.class\",\n+                \"\/modules\/java.base\/sun\/net\/www\/ParseUtil.class\",\n+                \"\/modules\/java.base\/java\/net\/URLStreamHandler.class\",\n+                \"\/modules\/java.base\/sun\/net\/www\/protocol\/file\/Handler.class\",\n+                \"\/modules\/java.base\/sun\/net\/util\/IPAddressUtil.class\",\n+                \"\/modules\/java.base\/sun\/net\/util\/IPAddressUtil$MASKS.class\",\n+                \"\/modules\/java.base\/sun\/net\/www\/protocol\/jar\/Handler.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ServicesCatalog.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/AbstractClassLoaderValue.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/ClassLoaderValue.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/BuiltinClassLoader$LoadedModule.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/DefaultRoots.class\",\n+                \"\/modules\/java.base\/java\/util\/Spliterator.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$HashMapSpliterator.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$ValueSpliterator.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/StreamSupport.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/BaseStream.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Stream.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/PipelineHelper.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/AbstractPipeline.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline$Head.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag$Type.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/StreamOpFlag$MaskBuilder.class\",\n+                \"\/modules\/java.base\/java\/util\/EnumMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/Class$ReflectionData.class\",\n+                \"\/modules\/java.base\/java\/lang\/Class$Atomic.class\",\n+                \"\/modules\/java.base\/java\/lang\/PublicMethods$MethodList.class\",\n+                \"\/modules\/java.base\/java\/lang\/PublicMethods$Key.class\",\n+                \"\/modules\/java.base\/sun\/reflect\/annotation\/AnnotationParser.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodHandleAccessorFactory.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/MethodHandleAccessorFactory$LazyStaticHolder.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Specializer.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/annotation\/Stable.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer$SpeciesData.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$SpeciesData.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/ClassSpecializer$Factory.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Specializer$Factory.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/SimpleMethodHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/NoSuchFieldException.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/BoundMethodHandle$Species_L.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Accessor.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DelegatingMethodHandle.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DelegatingMethodHandle$Holder.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor$TransformKey.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormBuffer.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/LambdaFormEditor$Transform.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/reflect\/DirectMethodHandleAccessor.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Collectors.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Collector$Characteristics.class\",\n+                \"\/modules\/java.base\/java\/util\/EnumSet.class\",\n+                \"\/modules\/java.base\/java\/util\/RegularEnumSet.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Collector.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Collectors$CollectorImpl.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/BiConsumer.class\",\n+                \"\/modules\/java.base\/java\/lang\/invoke\/DirectMethodHandle$Interface.class\",\n+                \"\/modules\/java.base\/java\/lang\/classfile\/constantpool\/InterfaceMethodRefEntry.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/classfile\/impl\/AbstractPoolEntry$InterfaceMethodRefEntryImpl.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/BinaryOperator.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReduceOps.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/TerminalOp.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$ReduceOp.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/StreamShape.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Sink.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/TerminalSink.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$AccumulatingSink.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReduceOps$Box.class\",\n+                \"\/modules\/java.base\/java\/util\/HashMap$KeySpliterator.class\",\n+                \"\/modules\/java.base\/java\/util\/function\/Predicate.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/ReferencePipeline$StatelessOp.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/Sink$ChainedReference.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleResolution.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/FindOps.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindSink.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindSink$OfRef.class\",\n+                \"\/modules\/java.base\/java\/util\/stream\/FindOps$FindOp.class\",\n+                \"\/modules\/java.base\/java\/util\/Spliterators.class\",\n+                \"\/modules\/java.base\/java\/util\/Spliterators$IteratorSpliterator.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/Configuration.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/Resolver.class\",\n+                \"\/modules\/java.base\/java\/lang\/ModuleLayer.class\",\n+                \"\/modules\/java.base\/java\/util\/SequencedSet.class\",\n+                \"\/modules\/java.base\/java\/util\/LinkedHashSet.class\",\n+                \"\/modules\/java.base\/java\/util\/SequencedMap.class\",\n+                \"\/modules\/java.base\/java\/util\/LinkedHashMap.class\",\n+                \"\/modules\/java.base\/java\/lang\/module\/ResolvedModule.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleLoaderMap$Mapper.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/AbstractClassLoaderValue$Memoizer.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ServicesCatalog$ServiceProvider.class\",\n+                \"\/modules\/java.base\/java\/util\/concurrent\/CopyOnWriteArrayList.class\",\n+                \"\/modules\/java.base\/java\/lang\/ModuleLayer$Controller.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/module\/ModuleBootstrap$SafeModuleFinder.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/ContinuationSupport.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/vm\/Continuation$Pinned.class\",\n+                \"\/modules\/java.base\/sun\/launcher\/LauncherHelper.class\",\n+                \"\/modules\/java.base\/sun\/net\/util\/URLUtil.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath$Loader.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/URLClassPath$FileLoader.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/loader\/Resource.class\",\n+                \"\/modules\/java.base\/java\/io\/FileCleanable.class\",\n+                \"\/modules\/java.base\/sun\/nio\/ByteBuffered.class\",\n+                \"\/modules\/java.base\/java\/security\/SecureClassLoader$CodeSourceKey.class\",\n+                \"\/modules\/java.base\/java\/security\/PermissionCollection.class\",\n+                \"\/modules\/java.base\/java\/security\/Permissions.class\",\n+                \"\/modules\/java.base\/java\/lang\/NamedPackage.class\",\n+                \"\/modules\/java.base\/jdk\/internal\/misc\/MethodFinder.class\",\n+                \"\/modules\/java.base\/java\/lang\/Readable.class\",\n+                \"\/modules\/java.base\/java\/nio\/CharBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/HeapCharBuffer.class\",\n+                \"\/modules\/java.base\/java\/nio\/charset\/CoderResult.class\",\n+                \"\/modules\/java.base\/java\/util\/IdentityHashMap$IdentityHashMapIterator.class\",\n+                \"\/modules\/java.base\/java\/util\/IdentityHashMap$KeyIterator.class\",\n+                \"\/modules\/java.base\/java\/lang\/Shutdown.class\",\n+                \"\/modules\/java.base\/java\/lang\/Shutdown$Lock.class\");\n+\n+        private static final Pattern SPLIT_MODULE_AND_PATH = Pattern.compile(\"\/modules\/([^\/]+)\/(.*)\");\n+\n+        private static final Map<String, List<String>> MODULE_TO_PATHS = INIT_CLASSES.stream()\n+                .map(name -> {\n+                    Matcher m = SPLIT_MODULE_AND_PATH.matcher(name);\n+                    if (!m.matches()) {\n+                        throw new IllegalArgumentException(\"Bad resource name: \" + name);\n+                    }\n+                    return m.toMatchResult();\n+                })\n+                .collect(groupingBy(m -> m.group(1), mapping(m -> m.group(2), toList())));\n+    }\n","filename":"test\/micro\/org\/openjdk\/bench\/jdk\/internal\/jrtfs\/ImageReaderBenchmark.java","additions":991,"deletions":866,"binary":false,"changes":1857,"status":"modified"}]}