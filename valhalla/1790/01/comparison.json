{"files":[{"patch":"@@ -102,0 +102,3 @@\n+                if (U.hasNullMarker(f)) {\n+                    sink.accept(U.nullMarkerOffset(f) + memberOffsetDelta, byte.class);\n+                }\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/value\/LayoutIteration.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -37,1 +37,0 @@\n-import jdk.internal.value.ValueClass;\n@@ -191,0 +190,79 @@\n+\n+    static value class IntValue {\n+        int value;\n+\n+        static final int[] EDGE_CASES = {\n+                0, -1, 1,\n+                Integer.MIN_VALUE, Integer.MAX_VALUE\n+        };\n+\n+        public IntValue(int index) {\n+            value = EDGE_CASES[index];\n+        }\n+\n+        public String toString() {\n+            return \"IntValue(\" + value +\n+                    \", bits=0x\" + Integer.toHexString(value) + \")\";\n+        }\n+\n+        static boolean cmp(int i, int j) {\n+            return EDGE_CASES[i] == EDGE_CASES[j];\n+        }\n+    }\n+\n+    static value class NestedValue {\n+        IntValue value;\n+\n+        static final IntValue[] EDGE_CASES = {\n+                null, new IntValue(0), new IntValue(1), new IntValue(2),\n+                new IntValue(3), new IntValue(0)\n+        };\n+\n+        public NestedValue(int index) {\n+            value = EDGE_CASES[index];\n+        }\n+\n+        public String toString() {\n+            return \"NestedValue(\" + value + \")\";\n+        }\n+\n+        static boolean cmp(int i, int j) {\n+            return EDGE_CASES[i] == EDGE_CASES[j];\n+        }\n+    }\n+\n+    static value class OuterValue {\n+        NestedValue nested;\n+\n+        static final NestedValue[] EDGE_CASES = {\n+                null, new NestedValue(0), new NestedValue(1), new NestedValue(2),\n+                new NestedValue(3), new NestedValue(0)\n+        };\n+\n+        public OuterValue(int index) {\n+            nested = EDGE_CASES[index];\n+        }\n+\n+        public String toString() {\n+            return \"Outer(\" + nested + \")\";\n+        }\n+\n+        static boolean cmp(int i, int j) {\n+            return EDGE_CASES[i] == EDGE_CASES[j];\n+        }\n+    }\n+\n+    public static boolean testNestedValue(NestedValue v1, NestedValue v2) {\n+        return v1 == v2;\n+    }\n+\n+    @Test\n+    void testNestedValue() {\n+        for (int i = 0; i < OuterValue.EDGE_CASES.length; ++i) {\n+            for (int j = 0; j < OuterValue.EDGE_CASES.length; ++j) {\n+                OuterValue val1 = new OuterValue(i);\n+                OuterValue val2 = new OuterValue(j);\n+                assertEquals(NestedValue.cmp(i, j), val1 == val2, () -> val1 + \" == \" + val2);\n+            }\n+        }\n+    }\n","filename":"test\/jdk\/valhalla\/valuetypes\/SubstitutabilityTest.java","additions":79,"deletions":1,"binary":false,"changes":80,"status":"modified"}]}