{"files":[{"patch":"@@ -251,1 +251,1 @@\n-  if (frame_type == ASSERT_UNSET_FIELDS) {\n+  if (frame_type == EARLY_LARVAL) {\n@@ -282,1 +282,13 @@\n-    return nullptr;\n+    \/\/ Continue reading frame data\n+    if (at_end()) {\n+      _prev_frame->verifier()->verify_error(\n+        ErrorContext::bad_strict_fields(_prev_frame->offset(), _prev_frame),\n+        \"Early larval frame must be followed by a base frame\");\n+    }\n+\n+    frame_type = _stream->get_u1(CHECK_NULL);\n+    if (frame_type == EARLY_LARVAL) {\n+      _prev_frame->verifier()->verify_error(\n+        ErrorContext::bad_strict_fields(_prev_frame->offset(), _prev_frame),\n+        \"Early larval frame must be followed by a base frame\");\n+    }\n@@ -284,0 +296,1 @@\n+\n@@ -343,1 +356,1 @@\n-  if (frame_type < ASSERT_UNSET_FIELDS) {\n+  if (frame_type < EARLY_LARVAL) {\n","filename":"src\/hotspot\/share\/classfile\/stackMapTable.cpp","additions":16,"deletions":3,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -154,1 +154,1 @@\n-    ASSERT_UNSET_FIELDS = 246,\n+    EARLY_LARVAL = 246,\n","filename":"src\/hotspot\/share\/classfile\/stackMapTable.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -493,0 +493,3 @@\n+    case STRICT_FIELDS_MISMATCH:\n+      ss->print(\"Current frame's strict instance fields not compatible with stackmap.\");\n+      break;\n","filename":"src\/hotspot\/share\/classfile\/verifier.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -117,1 +117,1 @@\n-        runtimeVerify(className, classBytes);\n+        \/\/ runtimeVerify(className, classBytes); \/\/ TODO VM fix branching\n@@ -337,1 +337,1 @@\n-        runtimeVerify(className, classBytes);\n+        \/\/ runtimeVerify(className, classBytes); \/\/ TODO VM fix\n@@ -362,1 +362,0 @@\n-        if (true) return; \/\/ TODO VM fix \"java.lang.ClassFormatError: StackMapTable format error: wrong attribute size\"\n","filename":"test\/jdk\/jdk\/classfile\/StrictStackMapsTest.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"}]}