{"files":[{"patch":"@@ -42,0 +42,1 @@\n+import java.util.Random;\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jimage\/BasicImageReader.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -34,0 +34,3 @@\n+import java.util.Random;\n+import java.util.Set;\n+import java.util.function.Predicate;\n@@ -152,24 +155,5 @@\n-        int lhsSize = lhsNames.size();\n-        int rhsSize = rhsNames.size();\n-        \/\/ Both input lists are sorted, enumerate the differences for debugging.\n-        List<String> lhsOnly = new ArrayList<>();\n-        List<String> rhsOnly = new ArrayList<>();\n-        int i = 0;\n-        int j = 0;\n-        while (i < lhsSize && j < rhsSize) {\n-            String lhsName = lhsNames.get(i);\n-            String rhsName = rhsNames.get(j);\n-            int signum = lhsName.compareTo(rhsName);\n-            if (signum == 0) {\n-                i += 1;\n-                j += 1;\n-            } else if (signum < 0) {\n-                lhsOnly.add(lhsName);\n-                i += 1;\n-            } else {\n-                rhsOnly.add(rhsName);\n-                j += 1;\n-            }\n-        }\n-        lhsOnly.addAll(lhsNames.subList(i, lhsSize));\n-        rhsOnly.addAll(rhsNames.subList(j, rhsSize));\n+\n+        List<String> lhsOnly =\n+                lhsNames.stream().filter(Predicate.not(Set.copyOf(rhsNames)::contains)).toList();\n+        List<String> rhsOnly =\n+                rhsNames.stream().filter(Predicate.not(Set.copyOf(lhsNames)::contains)).toList();\n@@ -178,1 +162,2 @@\n-                    \"jimage content differs for %s (%d) v. %s (%d)\", lhsLabel, lhsSize, rhsLabel, rhsSize);\n+                    \"jimage content differs for %s (%d) v. %s (%d)\",\n+                    lhsLabel, lhsNames.size(), rhsLabel, rhsNames.size());\n","filename":"test\/jdk\/tools\/jlink\/runtimeImage\/PackagedModulesVsRuntimeImageLinkTest.java","additions":10,"deletions":25,"binary":false,"changes":35,"status":"modified"}]}