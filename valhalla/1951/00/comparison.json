{"files":[{"patch":"@@ -1474,5 +1474,4 @@\n-            Exceptions::fthrow(\n-              THREAD_AND_LOCATION,\n-              vmSymbols::java_lang_ClassFormatError(),\n-              \"Illegal use of @jdk.internal.vm.annotation.NullRestricted annotation on field %s.%s which doesn't have the @jdk.internal.vm.annotation.Strict annotation\",\n-              class_name()->as_C_string(), name->as_C_string());\n+            \/\/ Inject STRICT_INIT and validate in context\n+            const jint patched_flags = flags | JVM_ACC_STRICT;\n+            verify_legal_field_modifiers(patched_flags, class_access_flags, CHECK);\n+            access_flags.set_flags(patched_flags);\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -91,44 +91,0 @@\n-    \/\/ Test detection of non-static field annotated with @NullRestricted but not @Strict\n-    static value class ValueClass1 {\n-        int i = 0;\n-        int j = 0;\n-    }\n-\n-    static class BadClass1 {\n-        @NullRestricted\n-        ValueClass1 vc;\n-    }\n-\n-    void test_1() {\n-        Throwable exception = null;\n-        try {\n-            BadClass1 tc = new BadClass1();\n-        } catch (ClassFormatError e) {\n-            exception = e;\n-            System.out.println(\"Received \" + e);\n-        }\n-        Asserts.assertNotNull(exception, \"Failed to detect illegal use of @NullRestricted without @Strict on a non-static field\");\n-    }\n-\n-    \/\/ Invalid usage of @NullRestricted on a non-strict non-static field\n-    static value class ValueClass2 {\n-        int i = 0;\n-        int j = 0;\n-    }\n-\n-    static class BadClass2 {\n-        @NullRestricted\n-        static ValueClass2 val;\n-    }\n-\n-    void test_2() {\n-        Throwable exception = null;\n-        try {\n-            BadClass2 tc = new BadClass2();\n-        } catch (ClassFormatError e) {\n-            exception = e;\n-            System.out.println(\"Received \" + e);\n-        }\n-        Asserts.assertNotNull(exception, \"FFailed to detect illegal use of @NullRestricted without @Strict on a static field\");\n-    }\n-\n@@ -303,23 +259,0 @@\n-    \/\/ Test static null restricted field that is not declared strict\n-    static value class ValueClass11 {\n-        int i = 0;\n-        int j = 0;\n-    }\n-\n-    static class BadClass11 {\n-        @NullRestricted\n-        static ValueClass11 val = new ValueClass11();\n-    }\n-\n-    void test_11() {\n-        Throwable exception = null;\n-        try {\n-            ValueClass11 val = BadClass11.val;\n-            System.out.println(val);\n-        } catch(ClassFormatError e) {\n-            exception = e;\n-            System.out.println(\"Received \" + e);\n-        }\n-        Asserts.assertNotNull(exception, \"Expected ClassFormatError not received\");\n-    }\n-\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/AnnotationsTests.java","additions":1,"deletions":68,"binary":false,"changes":69,"status":"modified"}]}