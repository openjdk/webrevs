{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2023, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -860,1 +860,1 @@\n-        private static final Bfloat16[] FLOAT16_10_POW = {\n+        private static final Bfloat16[] BFLOAT16_10_POW = {\n@@ -883,2 +883,2 @@\n-                    if (0 < scale && scale < FLOAT16_10_POW.length) {\n-                        return Bfloat16.divide(v, FLOAT16_10_POW[scale]);\n+                    if (0 < scale && scale < BFLOAT16_10_POW.length) {\n+                        return Bfloat16.divide(v, BFLOAT16_10_POW[scale]);\n@@ -886,2 +886,2 @@\n-                    if (0 > scale && scale > -FLOAT16_10_POW.length) {\n-                        return Bfloat16.multiply(v, FLOAT16_10_POW[-scale]);\n+                    if (0 > scale && scale > -BFLOAT16_10_POW.length) {\n+                        return Bfloat16.multiply(v, BFLOAT16_10_POW[-scale]);\n@@ -931,5 +931,3 @@\n-             *      2^12 = 2^{P+1} <= i < 2^{P+5} = 2^16\n-             * Contrary to the double and float cases, where we use long and int, resp.,\n-             * here we cannot simply declare i as short, because P + 5 < Short.SIZE\n-             * fails to hold.\n-             * Using int is safe, though.\n+             *      2^9 = 2^{P+1} <= i < 2^{P+5} = 2^13\n+             * Because P + 5 < Short.SIZE we could use short arithmetic, but\n+             * it is doubtful that this would lead to more performance.\n@@ -937,1 +935,1 @@\n-             * Further, as Math.scalb(Bfloat16) does not exists, we fall back to\n+             * Further, as Math.scalb(Bfloat16) does not exist, we fall back to\n@@ -1895,1 +1893,1 @@\n-        static final int E_MIN = -7;\n+        static final int E_MIN = -40;\n@@ -1898,1 +1896,1 @@\n-        static final int E_MAX = 5;\n+        static final int E_MAX = 38;\n@@ -1904,2 +1902,2 @@\n-        static final int K_MIN = -8;\n-        static final int K_MAX = 1;\n+        static final int K_MIN = -41;\n+        static final int K_MAX = 36;\n@@ -1908,1 +1906,1 @@\n-        static final int H = 5;\n+        static final int H = 4;\n@@ -1923,1 +1921,1 @@\n-        private static final int MASK_15 = (1 << 15) - 1;\n+        private static final int MASK_11 = (1 << 11) - 1;\n@@ -1934,4 +1932,4 @@\n-         *     -ddd.dd      H + 2 characters\n-         *     -ddddd.0     H + 3 characters\n-         *     -0.00ddddd   H + 5 characters\n-         *     -d.ddddE-e   H + 5 characters\n+         *     -dd.dd       H + 2 characters\n+         *     -dddd.0      H + 3 characters\n+         *     -0.00dddd    H + 5 characters\n+         *     -d.dddE-ee   H + 6 characters\n@@ -1940,1 +1938,1 @@\n-        public static final int MAX_CHARS = H + 5;\n+        public static final int MAX_CHARS = H + 6;\n@@ -2194,1 +2192,1 @@\n-             * Therefore, split the H = 9 digits of f into:\n+             * Therefore, split the H = 4 digits of f into:\n@@ -2196,1 +2194,1 @@\n-             *     l = the last 4, least significant digits of f\n+             *     l = the last 3, least significant digits of f\n@@ -2198,2 +2196,2 @@\n-             * For n = 5, m = 4 the discussion in section 10 of [1] shows\n-             *     floor(f \/ 10^4) = floor(107_375L f \/ 2^30)\n+             * For n = 4, m = 3 the discussion in section 10 of [1] shows\n+             *     floor(f \/ 10^3) = floor(16_778L f \/ 2^24 = floor(8_389L f \/ 2^23))\n@@ -2201,2 +2199,2 @@\n-            int h = (int) (f * 107_375L >>> 30);\n-            int l = f - 10_000 * h;\n+            int h = (int) (f * 8_389L >>> 23);\n+            int l = f - 1_000 * h;\n@@ -2204,1 +2202,1 @@\n-            if (0 < e && e <= 7) {\n+            if (0 < e && e <= 2) {\n@@ -2215,1 +2213,1 @@\n-             * 0 < e <= 7: plain format without leading zeroes.\n+             * 0 < e <= 2: plain format without leading zeroes.\n@@ -2217,1 +2215,1 @@\n-             * algorithm 1 in [3], with b = 10, k = 4, n = 15.\n+             * algorithm 1 in [3], with b = 10, k = 3, n = 11.\n@@ -2225,2 +2223,2 @@\n-                appendDigit(t >>> 15);\n-                y = t & MASK_15;\n+                appendDigit(t >>> 11);\n+                y = t & MASK_11;\n@@ -2229,1 +2227,1 @@\n-            for (; i <= 4; ++i) {\n+            for (; i <= 3; ++i) {\n@@ -2231,2 +2229,2 @@\n-                appendDigit(t >>> 15);\n-                y = t & MASK_15;\n+                appendDigit(t >>> 11);\n+                y = t & MASK_11;\n@@ -2234,7 +2232,0 @@\n-            \/*\n-             * As H = 5 < 7, where 7 is the threshold for plain format without\n-             * leading zeros, it can happen that the 2nd loop above is not executed.\n-             * The following line ensures the presence of a digit to the right\n-             * of the decimal point.\n-             *\/\n-            appendDigit(0);\n@@ -2253,1 +2244,1 @@\n-            append4Digits(l);\n+            append3Digits(l);\n@@ -2259,1 +2250,1 @@\n-            \/* -3 >= e | e > 7: computerized scientific notation *\/\n+            \/* -3 >= e | e > 2: computerized scientific notation *\/\n@@ -2262,1 +2253,1 @@\n-            append4Digits(l);\n+            append3Digits(l);\n@@ -2268,1 +2259,1 @@\n-        private void append4Digits(int m) {\n+        private void append3Digits(int m) {\n@@ -2271,1 +2262,1 @@\n-             * algorithm 1 in [3], with b = 10, k = 4, n = 15.\n+             * algorithm 1 in [3], with b = 10, k = 3, n = 11.\n@@ -2274,1 +2265,1 @@\n-            for (int i = 0; i < 4; ++i) {\n+            for (int i = 0; i < 3; ++i) {\n@@ -2276,2 +2267,2 @@\n-                appendDigit(t >>> 15);\n-                y = t & MASK_15;\n+                appendDigit(t >>> 11);\n+                y = t & MASK_11;\n@@ -2295,1 +2286,1 @@\n-             * with a < 10^4, b = 10, k = 4, n = 15.\n+             * with a < 10^3, b = 10, k = 3, n = 11.\n@@ -2297,2 +2288,2 @@\n-             *     (a + 1) 2^n <= 10^4 2^15 < 10^9\n-             * For n = 9, m = 4 the discussion in section 10 of [1] leads to:\n+             *     (a + 1) 2^n <= 10^3 2^11 < 10^7\n+             * For n = 7, m = 3 the discussion in section 10 of [1] leads to:\n@@ -2300,1 +2291,1 @@\n-            return (int) (((a + 1) << 15) * 1_759_218_605L >>> 44) - 1;\n+            return (int) (((a + 1) << 11) * 8_589_935L >>> 33) - 1;\n@@ -2309,1 +2300,7 @@\n-            appendDigit(e);\n+            if (e < 10) {\n+                appendDigit(e);\n+                return;\n+            }\n+            int d = e * 103 >>> 10;\n+            appendDigit(d);\n+            appendDigit(e - 10 * d);\n@@ -2348,2 +2345,2 @@\n-        static final int K_MIN = -8;\n-        static final int K_MAX = 1;\n+        static final int K_MIN = -41;\n+        static final int K_MAX = 36;\n@@ -2352,1 +2349,1 @@\n-        static final int H = 17;\n+        static final int H = 4;\n@@ -2373,14 +2370,0 @@\n-                10_000L,\n-                100_000L,\n-                1_000_000L,\n-                10_000_000L,\n-                100_000_000L,\n-                1_000_000_000L,\n-                10_000_000_000L,\n-                100_000_000_000L,\n-                1_000_000_000_000L,\n-                10_000_000_000_000L,\n-                100_000_000_000_000L,\n-                1_000_000_000_000_000L,\n-                10_000_000_000_000_000L,\n-                100_000_000_000_000_000L,\n@@ -2496,10 +2479,78 @@\n-                0x5F5E_1000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -8\n-                0x4C4B_4000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -7\n-                0x7A12_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -6\n-                0x61A8_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -5\n-                0x4E20_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -4\n-                0x7D00_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -3\n-                0x6400_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -2\n-                0x5000_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   -1\n-                0x4000_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/    0\n-                0x6666_6666_6666_6666L, 0x3333_3333_3333_3334L, \/\/    1\n+                0x4977_E8DC_6867_9BDFL, 0x16A8_72B9_4000_0001L, \/\/ -41\n+                0x758C_A7C7_0D72_92FEL, 0x5773_EAC2_0000_0001L, \/\/ -40\n+                0x5E0A_1FD2_7128_7598L, 0x45F6_5568_0000_0001L, \/\/ -39\n+                0x4B3B_4CA8_5A86_C47AL, 0x04C5_1120_0000_0001L, \/\/ -38\n+                0x785E_E10D_5DA4_6D90L, 0x07A1_B500_0000_0001L, \/\/ -37\n+                0x604B_E73D_E483_8AD9L, 0x52E7_C400_0000_0001L, \/\/ -36\n+                0x4D09_85CB_1D36_08AEL, 0x0F1F_D000_0000_0001L, \/\/ -35\n+                0x7B42_6FAB_61F0_0DE3L, 0x31CC_8000_0000_0001L, \/\/ -34\n+                0x629B_8C89_1B26_7182L, 0x5B0A_0000_0000_0001L, \/\/ -33\n+                0x4EE2_D6D4_15B8_5ACEL, 0x7C08_0000_0000_0001L, \/\/ -32\n+                0x7E37_BE20_22C0_914BL, 0x1340_0000_0000_0001L, \/\/ -31\n+                0x64F9_64E6_8233_A76FL, 0x2900_0000_0000_0001L, \/\/ -30\n+                0x50C7_83EB_9B5C_85F2L, 0x5400_0000_0000_0001L, \/\/ -29\n+                0x409F_9CBC_7C4A_04C2L, 0x1000_0000_0000_0001L, \/\/ -28\n+                0x6765_C793_FA10_079DL, 0x0000_0000_0000_0001L, \/\/ -27\n+                0x52B7_D2DC_C80C_D2E4L, 0x0000_0000_0000_0001L, \/\/ -26\n+                0x422C_A8B0_A00A_4250L, 0x0000_0000_0000_0001L, \/\/ -25\n+                0x69E1_0DE7_6676_D080L, 0x0000_0000_0000_0001L, \/\/ -24\n+                0x54B4_0B1F_852B_DA00L, 0x0000_0000_0000_0001L, \/\/ -23\n+                0x43C3_3C19_3756_4800L, 0x0000_0000_0000_0001L, \/\/ -22\n+                0x6C6B_935B_8BBD_4000L, 0x0000_0000_0000_0001L, \/\/ -21\n+                0x56BC_75E2_D631_0000L, 0x0000_0000_0000_0001L, \/\/ -20\n+                0x4563_9182_44F4_0000L, 0x0000_0000_0000_0001L, \/\/ -19\n+                0x6F05_B59D_3B20_0000L, 0x0000_0000_0000_0001L, \/\/ -18\n+                0x58D1_5E17_6280_0000L, 0x0000_0000_0000_0001L, \/\/ -17\n+                0x470D_E4DF_8200_0000L, 0x0000_0000_0000_0001L, \/\/ -16\n+                0x71AF_D498_D000_0000L, 0x0000_0000_0000_0001L, \/\/ -15\n+                0x5AF3_107A_4000_0000L, 0x0000_0000_0000_0001L, \/\/ -14\n+                0x48C2_7395_0000_0000L, 0x0000_0000_0000_0001L, \/\/ -13\n+                0x746A_5288_0000_0000L, 0x0000_0000_0000_0001L, \/\/ -12\n+                0x5D21_DBA0_0000_0000L, 0x0000_0000_0000_0001L, \/\/ -11\n+                0x4A81_7C80_0000_0000L, 0x0000_0000_0000_0001L, \/\/ -10\n+                0x7735_9400_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -9\n+                0x5F5E_1000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -8\n+                0x4C4B_4000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -7\n+                0x7A12_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -6\n+                0x61A8_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -5\n+                0x4E20_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -4\n+                0x7D00_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -3\n+                0x6400_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -2\n+                0x5000_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/  -1\n+                0x4000_0000_0000_0000L, 0x0000_0000_0000_0001L, \/\/   0\n+                0x6666_6666_6666_6666L, 0x3333_3333_3333_3334L, \/\/   1\n+                0x51EB_851E_B851_EB85L, 0x0F5C_28F5_C28F_5C29L, \/\/   2\n+                0x4189_374B_C6A7_EF9DL, 0x5916_872B_020C_49BBL, \/\/   3\n+                0x68DB_8BAC_710C_B295L, 0x74F0_D844_D013_A92BL, \/\/   4\n+                0x53E2_D623_8DA3_C211L, 0x43F3_E037_0CDC_8755L, \/\/   5\n+                0x431B_DE82_D7B6_34DAL, 0x698F_E692_70B0_6C44L, \/\/   6\n+                0x6B5F_CA6A_F2BD_215EL, 0x0F4C_A41D_811A_46D4L, \/\/   7\n+                0x55E6_3B88_C230_E77EL, 0x3F70_834A_CDAE_9F10L, \/\/   8\n+                0x44B8_2FA0_9B5A_52CBL, 0x4C5A_02A2_3E25_4C0DL, \/\/   9\n+                0x6DF3_7F67_5EF6_EADFL, 0x2D5C_D103_96A2_1347L, \/\/  10\n+                0x57F5_FF85_E592_557FL, 0x3DE3_DA69_454E_75D3L, \/\/  11\n+                0x465E_6604_B7A8_4465L, 0x7E4F_E1ED_D10B_9175L, \/\/  12\n+                0x7097_09A1_25DA_0709L, 0x4A19_697C_81AC_1BEFL, \/\/  13\n+                0x5A12_6E1A_84AE_6C07L, 0x54E1_2130_67BC_E326L, \/\/  14\n+                0x480E_BE7B_9D58_566CL, 0x43E7_4DC0_52FD_8285L, \/\/  15\n+                0x734A_CA5F_6226_F0ADL, 0x530B_AF9A_1E62_6A6DL, \/\/  16\n+                0x5C3B_D519_1B52_5A24L, 0x426F_BFAE_7EB5_21F1L, \/\/  17\n+                0x49C9_7747_490E_AE83L, 0x4EBF_CC8B_9890_E7F4L, \/\/  18\n+                0x760F_253E_DB4A_B0D2L, 0x4ACC_7A78_F41B_0CBAL, \/\/  19\n+                0x5E72_8432_4908_8D75L, 0x223D_2EC7_29AF_3D62L, \/\/  20\n+                0x4B8E_D028_3A6D_3DF7L, 0x34FD_BF05_BAF2_9781L, \/\/  21\n+                0x78E4_8040_5D7B_9658L, 0x54C9_31A2_C4B7_58CFL, \/\/  22\n+                0x60B6_CD00_4AC9_4513L, 0x5D6D_C14F_03C5_E0A5L, \/\/  23\n+                0x4D5F_0A66_A23A_9DA9L, 0x3124_9AA5_9C9E_4D51L, \/\/  24\n+                0x7BCB_43D7_69F7_62A8L, 0x4EA0_F76F_60FD_4882L, \/\/  25\n+                0x6309_0312_BB2C_4EEDL, 0x254D_92BF_80CA_A068L, \/\/  26\n+                0x4F3A_68DB_C8F0_3F24L, 0x1DD7_A899_33D5_4D20L, \/\/  27\n+                0x7EC3_DAF9_4180_6506L, 0x62F2_A75B_8622_1500L, \/\/  28\n+                0x6569_7BFA_9ACD_1D9FL, 0x025B_B916_04E8_10CDL, \/\/  29\n+                0x5121_2FFB_AF0A_7E18L, 0x6849_60DE_6A53_40A4L, \/\/  30\n+                0x40E7_5996_25A1_FE7AL, 0x203A_B3E5_21DC_33B6L, \/\/  31\n+                0x67D8_8F56_A29C_CA5DL, 0x19F7_863B_6960_52BDL, \/\/  32\n+                0x5313_A5DE_E87D_6EB0L, 0x7B2C_6B62_BAB3_7564L, \/\/  33\n+                0x4276_1E4B_ED31_255AL, 0x2F56_BC4E_FBC2_C450L, \/\/  34\n+                0x6A56_96DF_E1E8_3BC3L, 0x6557_93B1_92D1_3A1AL, \/\/  35\n+                0x5512_124C_B4B9_C969L, 0x3779_42F4_7574_2E7BL, \/\/  36\n@@ -2509,0 +2560,1 @@\n+\n","filename":"test\/jdk\/jdk\/incubator\/vector\/Bfloat16\/Bfloat16.java","additions":136,"deletions":84,"binary":false,"changes":220,"status":"modified"}]}