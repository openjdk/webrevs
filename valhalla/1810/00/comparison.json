{"files":[{"patch":"@@ -55,1 +55,10 @@\n-     * Creates a new instance of {@code ForwardingJavaFileManager}.\n+     * Whether the delegate is owned by this instance and should be closed when\n+     * this instance is closed.\n+     *\/\n+    private final boolean shouldClose;\n+\n+    \/**\n+     * Creates a new instance of {@code ForwardingJavaFileManager} which takes\n+     * ownership of the given delegate, and will close it when this instance is\n+     * closed.\n+     *\n@@ -59,0 +68,11 @@\n+        this(fileManager, true);\n+    }\n+\n+    \/**\n+     * Creates a new instance of {@code ForwardingJavaFileManager}.\n+     *\n+     * @param fileManager delegate to this file manager\n+     * @param shouldClose whether the delegate should be closed when this\n+     *     instance is closed.\n+     *\/\n+    protected ForwardingJavaFileManager(M fileManager, boolean shouldClose) {\n@@ -60,0 +80,1 @@\n+        this.shouldClose = shouldClose;\n@@ -250,1 +271,3 @@\n-        fileManager.close();\n+        if (shouldClose) {\n+            fileManager.close();\n+        }\n","filename":"src\/java.compiler\/share\/classes\/javax\/tools\/ForwardingJavaFileManager.java","additions":25,"deletions":2,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -177,1 +177,1 @@\n-                try (MemoryFileManager mfm = new MemoryFileManager(sjfm)) {\n+                try (MemoryFileManager mfm = new MemoryFileManager(sjfm, \/* shouldClose *\/ false)) {\n","filename":"test\/langtools\/tools\/javac\/processing\/filer\/TestOriginatingElements.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -854,8 +854,0 @@\n-        \/**\n-         * Constructs a memory file manager which stores output files in memory,\n-         * and delegates to a default file manager for input files.\n-         *\/\n-        public MemoryFileManager() {\n-            this(ToolProvider.getSystemJavaCompiler().getStandardFileManager(null, null, null));\n-        }\n-\n@@ -867,0 +859,2 @@\n+         * @param shouldClose whether the delegate file manager should be closed\n+         *     when this instance is closed\n@@ -868,2 +862,2 @@\n-        public MemoryFileManager(JavaFileManager fileManager) {\n-            super(fileManager);\n+        public MemoryFileManager(JavaFileManager fileManager, boolean shouldClose) {\n+            super(fileManager, shouldClose);\n@@ -882,13 +876,0 @@\n-        \/**\n-         * Returns the set of names of files that have been written to a given\n-         * location.\n-         *\n-         * @param location the location\n-         * @return the set of file names\n-         *\/\n-        public Set<String> getFileNames(Location location) {\n-            Map<String, Content> filesForLocation = files.get(location);\n-            return (filesForLocation == null)\n-                ? Collections.emptySet() : filesForLocation.keySet();\n-        }\n-\n@@ -914,1 +895,1 @@\n-         * @return the content as a string\n+         * @return the content\n@@ -916,5 +897,0 @@\n-        public String getFileString(Location location, String name) {\n-            Content content = getFile(location, name);\n-            return (content == null) ? null : content.getString();\n-        }\n-\n","filename":"test\/langtools\/tools\/lib\/toolbox\/ToolBox.java","additions":5,"deletions":29,"binary":false,"changes":34,"status":"modified"}]}