{"files":[{"patch":"@@ -1851,1 +1851,3 @@\n-            checkInit(pos, sym, Errors.VarMightNotHaveBeenInitialized(sym));\n+            checkInit(pos, sym, types.isNonNullable(sym.type) ?\n+                    Errors.NonNullableShouldBeInitialized :\n+                    Errors.VarMightNotHaveBeenInitialized(sym));\n@@ -1859,7 +1861,1 @@\n-                if (isUninitializedNonNullableField(sym)) {\n-                    if (types.isNonNullable(sym.type)) {\n-                        log.error(pos, Errors.NonNullableShouldBeInitialized);\n-                    }\n-                } else {\n-                    log.error(pos, errkey);\n-                }\n+                log.error(pos, errkey);\n@@ -2614,1 +2610,2 @@\n-\n+                boolean isSynthesized = (currentMethod.sym.flags() &\n+                        GENERATEDCONSTR) != 0;\n@@ -2626,1 +2623,6 @@\n-                            checkInit(TreeInfo.diagEndPos(tree), var, Errors.StrictFieldNotHaveBeenInitializedBeforeSuper(var));\n+                            if (isSynthesized) {\n+                                checkInit(TreeInfo.diagnosticPositionFor(var, vardecl),\n+                                        var, Errors.NonNullableShouldBeInitialized);\n+                            } else {\n+                                checkInit(TreeInfo.diagEndPos(tree), var, Errors.StrictFieldNotHaveBeenInitializedBeforeSuper(var));\n+                            }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":12,"deletions":10,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -0,0 +1,20 @@\n+\/*\n+ * @test \/nodynamiccopyright\/\n+ * @summary Smoke test for diagnostics for uninitialized non-nullable fields\n+ * @enablePreview\n+ * @compile\/fail\/ref=NonNullFieldInitTest.out -XDrawDiagnostics NonNullFieldInitTest.java\n+ *\/\n+\n+class NonNullFieldInitTest {\n+    static String! s;\n+\n+    static class WithInit {\n+        String! s;\n+\n+        WithInit() { }\n+    }\n+\n+    static class WithoutInit {\n+        String! s;\n+    }\n+}\n","filename":"test\/langtools\/tools\/javac\/nullability\/NonNullFieldInitTest.java","additions":20,"deletions":0,"binary":false,"changes":20,"status":"added"},{"patch":"@@ -0,0 +1,6 @@\n+NonNullFieldInitTest.java:9:20: compiler.err.non.nullable.should.be.initialized\n+NonNullFieldInitTest.java:14:20: compiler.err.strict.field.not.have.been.initialized.before.super: s\n+NonNullFieldInitTest.java:18:17: compiler.err.non.nullable.should.be.initialized\n+- compiler.note.preview.filename: NonNullFieldInitTest.java, DEFAULT\n+- compiler.note.preview.recompile\n+3 errors\n","filename":"test\/langtools\/tools\/javac\/nullability\/NonNullFieldInitTest.out","additions":6,"deletions":0,"binary":false,"changes":6,"status":"added"},{"patch":"@@ -465,1 +465,1 @@\n-                                \"compiler.err.non.nullable.should.be.initialized\"),\n+                                \"compiler.err.strict.field.not.have.been.initialized.before.super\"),\n","filename":"test\/langtools\/tools\/javac\/nullability\/NullabilityCompilationTests.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -908,1 +908,1 @@\n-        assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n+        assertFail(\"compiler.err.non.nullable.should.be.initialized\",\n@@ -1064,1 +1064,1 @@\n-            assertFail(\"compiler.err.strict.field.not.have.been.initialized.before.super\",\n+            assertFail(\"compiler.err.non.nullable.should.be.initialized\",\n","filename":"test\/langtools\/tools\/javac\/valhalla\/value-objects\/ValueObjectCompilationTests.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}