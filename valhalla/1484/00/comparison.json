{"files":[{"patch":"@@ -257,0 +257,8 @@\n+\n+      if (!_cp->is_within_bounds(index) || !_cp->tag_at(index).is_name_and_type()) {\n+        _prev_frame->verifier()->verify_error(\n+          ErrorContext::bad_strict_fields(_prev_frame->offset(), _prev_frame),\n+          \"Invalid constant pool index in early larval frame: %d\", index);\n+        return nullptr;\n+      }\n+\n","filename":"src\/hotspot\/share\/classfile\/stackMapTable.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n-class StrictFieldsNotSubset extends Parent {\n+class InvalidIndexInEarlyLarval extends Parent {\n@@ -31,1 +31,1 @@\n-    StrictFieldsNotSubset(boolean a, boolean b) {\n+    InvalidIndexInEarlyLarval(boolean a, boolean b) {\n@@ -47,1 +47,1 @@\n-class StrictFieldsNotSubset {\n+class InvalidIndexInEarlyLarval {\n@@ -56,1 +56,1 @@\n-    Utf8 \"StrictFieldsNotSubset\";          \/\/ #4\n+    Utf8 \"InvalidIndexInEarlyLarval\";      \/\/ #4\n@@ -184,1 +184,1 @@\n-                246b, []{#8; #12}, {       \/\/ FAIL: early_larval_frame contains NameAndType not present in original list of strict fields\n+                246b, []{#8; #5}, {       \/\/ FAIL: early_larval_frame contains cp index that isn't NameAndType\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/InvalidIndexInEarlyLarval.jcod","additions":5,"deletions":5,"binary":false,"changes":10,"previous_filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/StrictFieldsNotSubset.jcod","status":"copied"},{"patch":"@@ -34,0 +34,1 @@\n+ *          InvalidIndexInEarlyLarval.jcod\n@@ -164,0 +165,12 @@\n+        \/\/ Early_larval frame includes a constant pool index that doesn't point to a NameAndType\n+        try {\n+            InvalidIndexInEarlyLarval child = new InvalidIndexInEarlyLarval(true, false);\n+            System.out.println(child);\n+            throw new RuntimeException(\"Should fail verification\");\n+        } catch (java.lang.VerifyError e) {\n+            if (!e.getMessage().contains(\"Invalid constant pool index in early larval frame\")) {\n+                throw new RuntimeException(\"wrong exception: \" + e.getMessage());\n+            }\n+            e.printStackTrace();\n+        }\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/StrictInstanceFieldsTest.java","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"}]}