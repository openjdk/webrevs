{"files":[{"patch":"@@ -818,5 +818,0 @@\n-#ifdef ASSERT\n-  \/\/ LR #2\n-  address sender_pc_copy = pauth_strip_verifiable((address) *(l_sender_sp - frame::return_addr_offset));\n-#endif\n-\n@@ -835,11 +830,0 @@\n-#ifdef ASSERT\n-  \/\/ when the stack was extended (so LR #1 and LR #2 are distinct) and LR #1 was patched\n-  if (*cfp.sender_pc_addr != sender_pc_copy) {\n-    \/\/ When extending the stack in the callee method entry to make room for unpacking of value\n-    \/\/ type args, we keep a copy of the sender pc at the expected location in the callee frame.\n-    \/\/ If the sender pc is patched due to deoptimization, the copy is not consistent anymore.\n-    nmethod* nm = CodeCache::find_blob(*cfp.sender_pc_addr)->as_nmethod();\n-    assert(*cfp.sender_pc_addr == nm->deopt_handler_entry(), \"unexpected sender pc\");\n-  }\n-#endif\n-\n","filename":"src\/hotspot\/cpu\/aarch64\/frame_aarch64.cpp","additions":0,"deletions":16,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -5900,0 +5900,1 @@\n+#ifdef ASSERT\n@@ -5901,0 +5902,5 @@\n+  build_frame(framesize, false);\n+}\n+#endif\n+\n+void MacroAssembler::build_frame(int framesize DEBUG_ONLY(COMMA bool zap_rfp_lr_spills)) {\n@@ -5906,1 +5912,6 @@\n-    stp(rfp, lr, Address(sp, framesize - 2 * wordSize));\n+    if (DEBUG_ONLY(zap_rfp_lr_spills) NOT_DEBUG(false)) {\n+      mov_immediate64(rscratch1, ((uint64_t)badRegWordVal) << 32 | (uint64_t)badRegWordVal);\n+      stp(rscratch1, rscratch1, Address(sp, framesize - 2 * wordSize));\n+    } else {\n+      stp(rfp, lr, Address(sp, framesize - 2 * wordSize));\n+    }\n@@ -5909,1 +5920,6 @@\n-    stp(rfp, lr, Address(pre(sp, -2 * wordSize)));\n+    if (DEBUG_ONLY(zap_rfp_lr_spills) NOT_DEBUG(false)) {\n+      mov_immediate64(rscratch1, ((uint64_t)badRegWordVal) << 32 | (uint64_t)badRegWordVal);\n+      stp(rscratch1, rscratch1, Address(pre(sp, -2 * wordSize)));\n+    } else {\n+      stp(rfp, lr, Address(pre(sp, -2 * wordSize)));\n+    }\n@@ -6947,1 +6963,1 @@\n-  build_frame(framesize);\n+  build_frame(framesize DEBUG_ONLY(COMMA sp_inc != 0));\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":19,"deletions":3,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -192,1 +192,2 @@\n-  void build_frame(int framesize);\n+  DEBUG_ONLY(void build_frame(int framesize);)\n+  void build_frame(int framesize DEBUG_ONLY(COMMA bool zap_rfp_lr_spills));\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1047,0 +1047,1 @@\n+const juint    badRegWordVal      = 0xDEADDA7A;             \/\/ value used to zap registers\n","filename":"src\/hotspot\/share\/utilities\/globalDefinitions.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}