{"files":[{"patch":"@@ -1111,1 +1111,2 @@\n-                            if (!allowValueClasses && TreeInfo.hasAnyConstructorCall(tree)) {\n+                            if ((!allowValueClasses || TreeInfo.isCompactConstructor(tree)) &&\n+                                    TreeInfo.hasAnyConstructorCall(tree)) {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1153,0 +1153,34 @@\n+\n+        assertFail(\"compiler.err.invalid.canonical.constructor.in.record\",\n+                \"\"\"\n+                record R(int x) {\n+                    public R {\n+                        super();\n+                    }\n+                }\n+                \"\"\"\n+        );\n+\n+        assertFail(\"compiler.err.invalid.canonical.constructor.in.record\",\n+                \"\"\"\n+                record R(int x) {\n+                    public R {\n+                        this();\n+                    }\n+                    public R() {\n+                        this(1);\n+                    }\n+                }\n+                \"\"\"\n+        );\n+\n+        assertOK(\n+                \"\"\"\n+                record R(int x) {\n+                    public R(int x) {\n+                        this.x = x;\n+                        super();\n+                    }\n+                }\n+                \"\"\"\n+        );\n","filename":"test\/langtools\/tools\/javac\/valhalla\/value-objects\/ValueObjectCompilationTests.java","additions":34,"deletions":0,"binary":false,"changes":34,"status":"modified"}]}