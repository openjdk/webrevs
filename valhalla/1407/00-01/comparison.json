{"files":[{"patch":"@@ -98,2 +98,2 @@\n-bool ciInlineKlass::has_non_atomic_layout() const {\n-  GUARDED_VM_ENTRY(return get_InlineKlass()->has_non_atomic_layout();)\n+bool ciInlineKlass::has_null_free_non_atomic_layout() const {\n+  GUARDED_VM_ENTRY(return get_InlineKlass()->has_null_free_non_atomic_layout();)\n@@ -102,2 +102,2 @@\n-bool ciInlineKlass::has_atomic_layout() const {\n-  GUARDED_VM_ENTRY(return get_InlineKlass()->has_atomic_layout();)\n+bool ciInlineKlass::has_null_free_atomic_layout() const {\n+  GUARDED_VM_ENTRY(return get_InlineKlass()->has_null_free_atomic_layout();)\n@@ -118,1 +118,1 @@\n-  assert(!null_free || vk->has_atomic_layout(), \"No null-free atomic layout available\");\n+  assert(!null_free || vk->has_null_free_atomic_layout(), \"No null-free atomic layout available\");\n@@ -120,1 +120,1 @@\n-  int size = null_free ? vk->atomic_size_in_bytes() : vk->nullable_atomic_size_in_bytes();\n+  int size = null_free ? vk->null_free_atomic_size_in_bytes() : vk->nullable_atomic_size_in_bytes();\n","filename":"src\/hotspot\/share\/ci\/ciInlineKlass.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -75,2 +75,2 @@\n-  bool has_non_atomic_layout() const;\n-  bool has_atomic_layout() const;\n+  bool has_null_free_non_atomic_layout() const;\n+  bool has_null_free_atomic_layout() const;\n","filename":"src\/hotspot\/share\/ci\/ciInlineKlass.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -5517,3 +5517,3 @@\n-    vk->set_non_atomic_size_in_bytes(_layout_info->_non_atomic_size_in_bytes);\n-    vk->set_non_atomic_alignment(_layout_info->_non_atomic_alignment);\n-    vk->set_atomic_size_in_bytes(_layout_info->_atomic_layout_size_in_bytes);\n+    vk->set_null_free_non_atomic_size_in_bytes(_layout_info->_null_free_non_atomic_size_in_bytes);\n+    vk->set_null_free_non_atomic_alignment(_layout_info->_null_free_non_atomic_alignment);\n+    vk->set_null_free_atomic_size_in_bytes(_layout_info->_null_free_atomic_layout_size_in_bytes);\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -83,3 +83,3 @@\n-  int _non_atomic_size_in_bytes;\n-  int _non_atomic_alignment;\n-  int _atomic_layout_size_in_bytes;\n+  int _null_free_non_atomic_size_in_bytes;\n+  int _null_free_non_atomic_alignment;\n+  int _null_free_atomic_layout_size_in_bytes;\n@@ -99,2 +99,2 @@\n-                      _non_atomic_size_in_bytes(-1), _non_atomic_alignment(-1),\n-                      _atomic_layout_size_in_bytes(-1), _nullable_atomic_layout_size_in_bytes(-1),\n+                      _null_free_non_atomic_size_in_bytes(-1), _null_free_non_atomic_alignment(-1),\n+                      _null_free_atomic_layout_size_in_bytes(-1), _nullable_atomic_layout_size_in_bytes(-1),\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.hpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -73,2 +73,2 @@\n-      if (vk->is_naturally_atomic() && vk->has_non_atomic_layout()) return LayoutKind::NULL_FREE_NON_ATOMIC_FLAT;\n-      return (vk->has_atomic_layout() && can_use_atomic_flat) ? LayoutKind::NULL_FREE_ATOMIC_FLAT : LayoutKind::REFERENCE;\n+      if (vk->is_naturally_atomic() && vk->has_null_free_non_atomic_layout()) return LayoutKind::NULL_FREE_NON_ATOMIC_FLAT;\n+      return (vk->has_null_free_atomic_layout() && can_use_atomic_flat) ? LayoutKind::NULL_FREE_ATOMIC_FLAT : LayoutKind::REFERENCE;\n@@ -76,1 +76,1 @@\n-      return vk->has_non_atomic_layout() ? LayoutKind::NULL_FREE_NON_ATOMIC_FLAT : LayoutKind::REFERENCE;\n+      return vk->has_null_free_non_atomic_layout() ? LayoutKind::NULL_FREE_NON_ATOMIC_FLAT : LayoutKind::REFERENCE;\n@@ -100,2 +100,2 @@\n-      *size = vk->non_atomic_size_in_bytes();\n-      *alignment = vk->non_atomic_alignment();\n+      *size = vk->null_free_non_atomic_size_in_bytes();\n+      *alignment = vk->null_free_non_atomic_alignment();\n@@ -104,1 +104,1 @@\n-      *size = vk->atomic_size_in_bytes();\n+      *size = vk->null_free_atomic_size_in_bytes();\n@@ -113,1 +113,1 @@\n-      *alignment = vk->non_atomic_alignment();\n+      *alignment = vk->null_free_non_atomic_alignment();\n@@ -755,3 +755,3 @@\n-  _non_atomic_layout_size_in_bytes(-1),\n-  _non_atomic_layout_alignment(-1),\n-  _atomic_layout_size_in_bytes(-1),\n+  _null_free_non_atomic_layout_size_in_bytes(-1),\n+  _null_free_non_atomic_layout_alignment(-1),\n+  _null_free_atomic_layout_size_in_bytes(-1),\n@@ -1161,2 +1161,2 @@\n-      _non_atomic_layout_size_in_bytes = _payload_size_in_bytes;\n-      _non_atomic_layout_alignment = _payload_alignment;\n+      _null_free_non_atomic_layout_size_in_bytes = _payload_size_in_bytes;\n+      _null_free_non_atomic_layout_alignment = _payload_alignment;\n@@ -1169,1 +1169,1 @@\n-        _atomic_layout_size_in_bytes = atomic_size;\n+        _null_free_atomic_layout_size_in_bytes = atomic_size;\n@@ -1210,1 +1210,1 @@\n-        _non_atomic_layout_alignment = _payload_alignment;\n+        _null_free_non_atomic_layout_alignment = _payload_alignment;\n@@ -1236,2 +1236,2 @@\n-    if (has_atomic_layout() && _payload_alignment < atomic_layout_size_in_bytes()) {\n-      required_alignment = atomic_layout_size_in_bytes();\n+    if (has_null_free_atomic_layout() && _payload_alignment < null_free_atomic_layout_size_in_bytes()) {\n+      required_alignment = null_free_atomic_layout_size_in_bytes();\n@@ -1254,1 +1254,1 @@\n-        _atomic_layout_size_in_bytes = -1;\n+        _null_free_atomic_layout_size_in_bytes = -1;\n@@ -1510,3 +1510,3 @@\n-    _info->_non_atomic_size_in_bytes = _non_atomic_layout_size_in_bytes;\n-    _info->_non_atomic_alignment = _non_atomic_layout_alignment;\n-    _info->_atomic_layout_size_in_bytes = _atomic_layout_size_in_bytes;\n+    _info->_null_free_non_atomic_size_in_bytes = _null_free_non_atomic_layout_size_in_bytes;\n+    _info->_null_free_non_atomic_alignment = _null_free_non_atomic_layout_alignment;\n+    _info->_null_free_atomic_layout_size_in_bytes = _null_free_atomic_layout_size_in_bytes;\n@@ -1583,1 +1583,1 @@\n-      if (has_non_atomic_flat_layout()) {\n+      if (has_null_free_non_atomic_flat_layout()) {\n@@ -1586,1 +1586,1 @@\n-                    _non_atomic_layout_size_in_bytes, _non_atomic_layout_alignment);\n+                    _null_free_non_atomic_layout_size_in_bytes, _null_free_non_atomic_layout_alignment);\n@@ -1591,1 +1591,1 @@\n-      if (has_atomic_layout()) {\n+      if (has_null_free_atomic_layout()) {\n@@ -1594,1 +1594,1 @@\n-                    _atomic_layout_size_in_bytes, _atomic_layout_size_in_bytes);\n+                    _null_free_atomic_layout_size_in_bytes, _null_free_atomic_layout_size_in_bytes);\n@@ -1610,1 +1610,1 @@\n-                    _nullable_non_atomic_layout_size_in_bytes, _non_atomic_layout_alignment);\n+                    _nullable_non_atomic_layout_size_in_bytes, _null_free_non_atomic_layout_alignment);\n","filename":"src\/hotspot\/share\/classfile\/fieldLayoutBuilder.cpp","additions":25,"deletions":25,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -296,3 +296,3 @@\n-  int _non_atomic_layout_size_in_bytes;\n-  int _non_atomic_layout_alignment;\n-  int _atomic_layout_size_in_bytes;\n+  int _null_free_non_atomic_layout_size_in_bytes;\n+  int _null_free_non_atomic_layout_alignment;\n+  int _null_free_atomic_layout_size_in_bytes;\n@@ -325,5 +325,5 @@\n-  bool has_non_atomic_flat_layout() const      { return _non_atomic_layout_size_in_bytes != -1; }\n-  int  non_atomic_layout_size_in_bytes() const { return _non_atomic_layout_size_in_bytes; }\n-  int  non_atomic_layout_alignment() const     { return _non_atomic_layout_alignment; }\n-  bool has_atomic_layout() const               { return _atomic_layout_size_in_bytes != -1; }\n-  int  atomic_layout_size_in_bytes() const     { return _atomic_layout_size_in_bytes; }\n+  bool has_null_free_non_atomic_flat_layout() const      { return _null_free_non_atomic_layout_size_in_bytes != -1; }\n+  int  null_free_non_atomic_layout_size_in_bytes() const { return _null_free_non_atomic_layout_size_in_bytes; }\n+  int  null_free_non_atomic_layout_alignment() const     { return _null_free_non_atomic_layout_alignment; }\n+  bool has_null_free_atomic_layout() const               { return _null_free_atomic_layout_size_in_bytes != -1; }\n+  int  null_free_atomic_layout_size_in_bytes() const     { return _null_free_atomic_layout_size_in_bytes; }\n","filename":"src\/hotspot\/share\/classfile\/fieldLayoutBuilder.hpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -67,3 +67,3 @@\n-    _non_atomic_size_in_bytes(-1),\n-    _non_atomic_alignment(-1),\n-    _atomic_size_in_bytes(-1),\n+    _null_free_non_atomic_size_in_bytes(-1),\n+    _null_free_non_atomic_alignment(-1),\n+    _null_free_atomic_size_in_bytes(-1),\n@@ -136,2 +136,2 @@\n-      assert(has_non_atomic_layout(), \"Layout not available\");\n-      return non_atomic_size_in_bytes();\n+      assert(has_null_free_non_atomic_layout(), \"Layout not available\");\n+      return null_free_non_atomic_size_in_bytes();\n@@ -140,2 +140,2 @@\n-      assert(has_atomic_layout(), \"Layout not available\");\n-      return atomic_size_in_bytes();\n+      assert(has_null_free_atomic_layout(), \"Layout not available\");\n+      return null_free_atomic_size_in_bytes();\n@@ -162,2 +162,2 @@\n-      assert(has_non_atomic_layout(), \"Layout not available\");\n-      return non_atomic_alignment();\n+      assert(has_null_free_non_atomic_layout(), \"Layout not available\");\n+      return null_free_non_atomic_alignment();\n@@ -166,2 +166,2 @@\n-      assert(has_atomic_layout(), \"Layout not available\");\n-      return atomic_size_in_bytes();\n+      assert(has_null_free_atomic_layout(), \"Layout not available\");\n+      return null_free_atomic_size_in_bytes();\n@@ -175,1 +175,1 @@\n-      return non_atomic_alignment();\n+      return null_free_non_atomic_alignment();\n@@ -188,1 +188,1 @@\n-      return has_non_atomic_layout();\n+      return has_null_free_non_atomic_layout();\n@@ -191,1 +191,1 @@\n-      return has_atomic_layout();\n+      return has_null_free_atomic_layout();\n@@ -317,1 +317,1 @@\n-  if (!has_nullable_atomic_layout() && !has_atomic_layout() && !has_non_atomic_layout()) {\n+  if (!has_nullable_atomic_layout() && !has_null_free_atomic_layout() && !has_null_free_non_atomic_layout()) {\n@@ -334,1 +334,1 @@\n-  return has_nullable_atomic_layout() && has_atomic_layout() && has_non_atomic_layout();\n+  return has_nullable_atomic_layout() && has_null_free_atomic_layout() && has_null_free_non_atomic_layout();\n","filename":"src\/hotspot\/share\/oops\/inlineKlass.cpp","additions":16,"deletions":16,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -91,3 +91,3 @@\n-    int _non_atomic_size_in_bytes; \/\/ size of null-free non-atomic flat layout\n-    int _non_atomic_alignment;     \/\/ alignment requirement for null-free non-atomic layout\n-    int _atomic_size_in_bytes;     \/\/ size and alignment requirement for a null-free atomic layout, -1 if no atomic flat layout is possible\n+    int _null_free_non_atomic_size_in_bytes; \/\/ size of null-free non-atomic flat layout\n+    int _null_free_non_atomic_alignment;     \/\/ alignment requirement for null-free non-atomic layout\n+    int _null_free_atomic_size_in_bytes;     \/\/ size and alignment requirement for a null-free atomic layout, -1 if no atomic flat layout is possible\n@@ -166,3 +166,3 @@\n-  int non_atomic_size_in_bytes() const                        { return members()._non_atomic_size_in_bytes; }\n-  void set_non_atomic_size_in_bytes(int size)                 { members()._non_atomic_size_in_bytes = size; }\n-  bool has_non_atomic_layout() const                          { return non_atomic_size_in_bytes() != -1; }\n+  int null_free_non_atomic_size_in_bytes() const              { return members()._null_free_non_atomic_size_in_bytes; }\n+  void set_null_free_non_atomic_size_in_bytes(int size)       { members()._null_free_non_atomic_size_in_bytes = size; }\n+  bool has_null_free_non_atomic_layout() const                { return null_free_non_atomic_size_in_bytes() != -1; }\n@@ -170,2 +170,2 @@\n-  int non_atomic_alignment() const                            { return members()._non_atomic_alignment; }\n-  void set_non_atomic_alignment(int alignment)                { members()._non_atomic_alignment = alignment; }\n+  int null_free_non_atomic_alignment() const                  { return members()._null_free_non_atomic_alignment; }\n+  void set_null_free_non_atomic_alignment(int alignment)      { members()._null_free_non_atomic_alignment = alignment; }\n@@ -173,3 +173,3 @@\n-  int atomic_size_in_bytes() const                            { return members()._atomic_size_in_bytes; }\n-  void set_atomic_size_in_bytes(int size)                     { members()._atomic_size_in_bytes = size; }\n-  bool has_atomic_layout() const                              { return atomic_size_in_bytes() != -1; }\n+  int null_free_atomic_size_in_bytes() const                  { return members()._null_free_atomic_size_in_bytes; }\n+  void set_null_free_atomic_size_in_bytes(int size)           { members()._null_free_atomic_size_in_bytes = size; }\n+  bool has_null_free_atomic_layout() const                    { return null_free_atomic_size_in_bytes() != -1; }\n","filename":"src\/hotspot\/share\/oops\/inlineKlass.hpp","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -193,1 +193,1 @@\n-      if (vk->has_non_atomic_layout()) {\n+      if (vk->has_null_free_non_atomic_layout()) {\n@@ -195,1 +195,1 @@\n-      } else if (vk->has_atomic_layout()) {\n+      } else if (vk->has_null_free_atomic_layout()) {\n@@ -202,1 +202,1 @@\n-      if (vk->is_naturally_atomic() && vk->has_non_atomic_layout()) {\n+      if (vk->is_naturally_atomic() && vk->has_null_free_non_atomic_layout()) {\n@@ -204,1 +204,1 @@\n-      } else if (vk->has_atomic_layout()) {\n+      } else if (vk->has_null_free_atomic_layout()) {\n","filename":"src\/hotspot\/share\/oops\/objArrayKlass.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1884,1 +1884,1 @@\n-  if (!elem_vk->has_atomic_layout() && !elem_vk->has_nullable_atomic_layout()) {\n+  if (!elem_vk->has_null_free_atomic_layout() && !elem_vk->has_nullable_atomic_layout()) {\n@@ -1886,1 +1886,1 @@\n-  } else if (!elem_vk->has_nullable_atomic_layout() && !elem_vk->has_non_atomic_layout()) {\n+  } else if (!elem_vk->has_nullable_atomic_layout() && !elem_vk->has_null_free_non_atomic_layout()) {\n@@ -1888,1 +1888,1 @@\n-  } else if (!elem_vk->has_atomic_layout() && !elem_vk->has_non_atomic_layout()) {\n+  } else if (!elem_vk->has_null_free_atomic_layout() && !elem_vk->has_null_free_non_atomic_layout()) {\n@@ -3886,1 +3886,1 @@\n-  assert(vk->has_atomic_layout() || vk->has_non_atomic_layout(), \"Can't be null-free and flat\");\n+  assert(vk->has_null_free_atomic_layout() || vk->has_null_free_non_atomic_layout(), \"Can't be null-free and flat\");\n@@ -3889,1 +3889,1 @@\n-  if (!vk->has_non_atomic_layout()) {\n+  if (!vk->has_null_free_non_atomic_layout()) {\n@@ -3891,1 +3891,1 @@\n-  } else if (!vk->has_atomic_layout()) {\n+  } else if (!vk->has_null_free_atomic_layout()) {\n","filename":"src\/hotspot\/share\/opto\/graphKit.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -577,1 +577,1 @@\n-      assert(vk->has_atomic_layout(), \"element type %s does not have a null-free atomic flat layout\", vk->name()->as_utf8());\n+      assert(vk->has_null_free_atomic_layout(), \"element type %s does not have a null-free atomic flat layout\", vk->name()->as_utf8());\n@@ -591,1 +591,1 @@\n-      assert(vk->has_non_atomic_layout(), \"element type %s does not have a null-free non-atomic flat layout\", vk->name()->as_utf8());\n+      assert(vk->has_null_free_non_atomic_layout(), \"element type %s does not have a null-free non-atomic flat layout\", vk->name()->as_utf8());\n@@ -1256,1 +1256,1 @@\n-      assert(vk->has_atomic_layout(), \"element type %s does not have a null-free atomic flat layout\", vk->name()->as_utf8());\n+      assert(vk->has_null_free_atomic_layout(), \"element type %s does not have a null-free atomic flat layout\", vk->name()->as_utf8());\n@@ -1270,1 +1270,1 @@\n-      assert(vk->has_non_atomic_layout(), \"element type %s does not have a null-free non-atomic flat layout\", vk->name()->as_utf8());\n+      assert(vk->has_null_free_non_atomic_layout(), \"element type %s does not have a null-free non-atomic flat layout\", vk->name()->as_utf8());\n","filename":"src\/hotspot\/share\/opto\/inlinetypenode.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}