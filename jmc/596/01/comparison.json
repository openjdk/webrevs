{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -38,0 +38,1 @@\n+import java.util.Collections;\n@@ -46,0 +47,1 @@\n+import org.openjdk.jmc.common.IDisplayable;\n@@ -140,0 +142,4 @@\n+\t\t\tString vmOperationsList = getVMOperationsList(items.apply(JdkFilters.VM_OPERATIONS_BLOCKING_OR_SAFEPOINT));\n+\t\t\tif (vmOperationsList != null) {\n+\t\t\t\tlongMessage = vmOperationsList.concat(longMessage);\n+\t\t\t}\n@@ -192,0 +198,18 @@\n+\tprivate String getVMOperationsList(IItemCollection items) {\n+\t\tList<IItem> sortedEventsByDuration = sortEventsByDurationTime(items);\n+\t\tCollections.reverse(sortedEventsByDuration);\n+\t\tchar bulletSymbol = '\\u2023';\n+\t\tchar newLineSymbol = '\\n';\n+\n+\t\tStringBuilder sb = new StringBuilder(\n+\t\t\t\tnewLineSymbol + Messages.getString(Messages.VMOperations_Duration_Operation) + newLineSymbol);\n+\t\tif (sortedEventsByDuration.size() >= 5) {\n+\t\t\tfor (IItem iItem : sortedEventsByDuration.subList(0, 5)) {\n+\t\t\t\tsb.append(bulletSymbol + \" \" + getDuration(iItem).displayUsing(IDisplayable.AUTO) + \" \"\n+\t\t\t\t\t\t+ getOperation(iItem) + newLineSymbol);\n+\t\t\t}\n+\t\t}\n+\t\tsb.append(newLineSymbol);\n+\t\treturn sb.toString();\n+\t}\n+\n@@ -208,0 +232,16 @@\n+\tprivate List<IItem> sortEventsByDurationTime(IItemCollection items) {\n+\t\tList<IItem> sortedEvents = new ArrayList<>();\n+\t\tfor (IItemIterable iter : items) {\n+\t\t\tfor (IItem event : iter) {\n+\t\t\t\tsortedEvents.add(event);\n+\t\t\t}\n+\t\t}\n+\t\tsortedEvents.sort(new Comparator<IItem>() {\n+\t\t\t@Override\n+\t\t\tpublic int compare(IItem e1, IItem e2) {\n+\t\t\t\treturn getDuration(e1).compareTo(getDuration(e2));\n+\t\t\t}\n+\t\t});\n+\t\treturn sortedEvents;\n+\t}\n+\n","filename":"core\/org.openjdk.jmc.flightrecorder.rules.jdk\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/rules\/jdk\/latency\/VMOperationRule.java","additions":41,"deletions":1,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -650,0 +650,1 @@\n+\tpublic static final String VMOperations_Duration_Operation = \"VMOperations_Duration_Operation\"; \/\/$NON-NLS-1$\n","filename":"core\/org.openjdk.jmc.flightrecorder.rules.jdk\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/rules\/jdk\/messages\/internal\/Messages.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -732,0 +732,1 @@\n+VMOperations_Duration_Operation=  Duration  |   VM Operation\n","filename":"core\/org.openjdk.jmc.flightrecorder.rules.jdk\/src\/main\/resources\/org\/openjdk\/jmc\/flightrecorder\/rules\/jdk\/messages\/internal\/messages.properties","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}