{"files":[{"patch":"@@ -644,7 +644,6 @@\n-\t\t\/\/ FIXME: JMC-4520 - Handle multiple item iterables\n-\t\tIterator<IItemIterable> ii = items.iterator();\n-\t\tif (ii.hasNext()) {\n-\t\t\tIItemIterable itemStream = ii.next();\n-\t\t\tIType<IItem> type = itemStream.getType();\n-\t\t\t\/\/ FIXME: A better way to ensure sorting by endTime\n-\t\t\treturn yAttributes.peek(a -> addEndTimeLine(renderer, itemStream.iterator(), type, a, fill))\n+\t\tif (items.hasItems()) {\n+\t\t\tIterator<IItemIterable> ii = items.iterator();\n+\t\t\tIType<IItem> type = ii.hasNext() ? ii.next().getType() : null;\n+\t\t\tList<IItem> allItems = new ArrayList<>();\n+\t\t\titems.forEach(itemStream -> itemStream.forEach(allItems::add));\n+\t\t\treturn yAttributes.peek(a -> addEndTimeLine(renderer, allItems.iterator(), type, a, fill))\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/common\/DataPageToolkit.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-import java.util.Iterator;\n@@ -76,1 +75,1 @@\n-\t\tpopulateAttributeMaps(isSuitableForLineCharts(items, allTypes));\n+\t\tpopulateAttributeMaps(isSuitableForLineCharts(allTypes));\n@@ -120,10 +119,2 @@\n-\tprivate static boolean isSuitableForLineCharts(IItemCollection items, Map<String, IType<?>> types) {\n-\t\t\/\/ NOTE: JMC-4520 - Only allowing line charts for one event type, which only has one event array. \n-\t\tif (types.values().size() == 1) {\n-\t\t\tIterator<IItemIterable> iterator = items.iterator();\n-\t\t\tif (iterator.hasNext()) {\n-\t\t\t\titerator.next();\n-\t\t\t\treturn !iterator.hasNext();\n-\t\t\t}\n-\t\t}\n-\t\treturn false;\n+\tprivate static boolean isSuitableForLineCharts(Map<String, IType<?>> types) {\n+\t\treturn types.values().size() == 1;\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/pages\/itemhandler\/AttributeComponentConfiguration.java","additions":3,"deletions":12,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -65,0 +65,1 @@\n+import org.openjdk.jmc.common.item.IItem;\n@@ -543,9 +544,11 @@\n-\t\t\t\t\t\tIterator<IItemIterable> chartItemsWithAttributeSomeType = itemsToChart\n-\t\t\t\t\t\t\t\t.apply(ItemFilters.hasAttribute(attribute)).iterator();\n-\t\t\t\t\t\tif (chartItemsWithAttributeSomeType.hasNext()\n-\t\t\t\t\t\t\t\t&& attribute.getContentType() instanceof LinearKindOfQuantity) {\n-\t\t\t\t\t\t\tIItemIterable is = chartItemsWithAttributeSomeType.next();\n-\t\t\t\t\t\t\tif (chartItemsWithAttributeSomeType.hasNext()) {\n-\t\t\t\t\t\t\t\t\/\/ FIXME: JMC-4520 - Add support for multiple item iterables\n-\t\t\t\t\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO,\n-\t\t\t\t\t\t\t\t\t\t\"Only charting a subset of the events!\"); \/\/$NON-NLS-1$\n+\t\t\t\t\t\tif (attribute.getContentType() instanceof LinearKindOfQuantity) {\n+\t\t\t\t\t\t\tIItemCollection itemsWithAttributeSomeType = itemsToChart\n+\t\t\t\t\t\t\t\t\t.apply(ItemFilters.hasAttribute(attribute));\n+\t\t\t\t\t\t\tif (itemsWithAttributeSomeType.hasItems()) {\n+\t\t\t\t\t\t\t\tIterator<IItemIterable> iterator = itemsWithAttributeSomeType.iterator();\n+\t\t\t\t\t\t\t\tIType<IItem> type = iterator.hasNext() ? iterator.next().getType() : null;\n+\t\t\t\t\t\t\t\tList<IItem> allItems = new ArrayList<>();\n+\t\t\t\t\t\t\t\titemsWithAttributeSomeType.forEach(itemStream -> itemStream.forEach(allItems::add));\n+\t\t\t\t\t\t\t\t@SuppressWarnings(\"unchecked\")\n+\t\t\t\t\t\t\t\tIAttribute<IQuantity> qAttribute = (IAttribute<IQuantity>) attribute;\n+\t\t\t\t\t\t\t\tDataPageToolkit.addEndTimeLine(xyRenderer, allItems.iterator(), type, qAttribute, fill);\n@@ -553,3 +556,0 @@\n-\t\t\t\t\t\t\t@SuppressWarnings(\"unchecked\")\n-\t\t\t\t\t\t\tIAttribute<IQuantity> qAttribute = (IAttribute<IQuantity>) attribute;\n-\t\t\t\t\t\t\tDataPageToolkit.addEndTimeLine(xyRenderer, is.iterator(), is.getType(), qAttribute, fill);\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/pages\/itemhandler\/ItemChart.java","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"}]}