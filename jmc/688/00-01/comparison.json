{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -101,0 +101,1 @@\n+import org.openjdk.jmc.common.collection.IteratorToolkit;\n@@ -646,5 +647,9 @@\n-\t\t\tIterator<IItemIterable> ii = items.iterator();\n-\t\t\tIType<IItem> type = ii.hasNext() ? ii.next().getType() : null;\n-\t\t\tList<IItem> allItems = new ArrayList<>();\n-\t\t\titems.forEach(itemStream -> itemStream.forEach(allItems::add));\n-\t\t\treturn yAttributes.peek(a -> addEndTimeLine(renderer, allItems.iterator(), type, a, fill))\n+\t\t\tList<Iterator<IItem>> iterators = new ArrayList<>();\n+\t\t\tfor (IItemIterable ii : items) {\n+\t\t\t\titerators.add(ii.iterator());\n+\t\t\t}\n+\t\t\tIType<IItem> type = items.iterator().next().getType();\n+\t\t\tIMemberAccessor<IQuantity, IItem> accessor = JfrAttributes.END_TIME.getAccessor(type);\n+\t\t\tComparator<IItem> comparator = Comparator.comparing(item -> accessor.getMember(item));\n+\t\t\treturn yAttributes.peek(\n+\t\t\t\t\ta -> addEndTimeLine(renderer, IteratorToolkit.mergedSorting(iterators, comparator), type, a, fill))\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/common\/DataPageToolkit.java","additions":11,"deletions":6,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/pages\/itemhandler\/AttributeComponentConfiguration.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,0 +39,1 @@\n+import java.util.Comparator;\n@@ -62,0 +63,1 @@\n+import org.openjdk.jmc.common.collection.IteratorToolkit;\n@@ -68,0 +70,1 @@\n+import org.openjdk.jmc.common.item.IMemberAccessor;\n@@ -548,4 +551,7 @@\n-\t\t\t\t\t\t\t\tIterator<IItemIterable> iterator = itemsWithAttributeSomeType.iterator();\n-\t\t\t\t\t\t\t\tIType<IItem> type = iterator.hasNext() ? iterator.next().getType() : null;\n-\t\t\t\t\t\t\t\tList<IItem> allItems = new ArrayList<>();\n-\t\t\t\t\t\t\t\titemsWithAttributeSomeType.forEach(itemStream -> itemStream.forEach(allItems::add));\n+\t\t\t\t\t\t\t\tList<Iterator<IItem>> iterators = new ArrayList<>();\n+\t\t\t\t\t\t\t\tfor (IItemIterable ii : itemsWithAttributeSomeType) {\n+\t\t\t\t\t\t\t\t\titerators.add(ii.iterator());\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\tIType<IItem> type = itemsWithAttributeSomeType.iterator().next().getType();\n+\t\t\t\t\t\t\t\tIMemberAccessor<IQuantity, IItem> accessor = JfrAttributes.END_TIME.getAccessor(type);\n+\t\t\t\t\t\t\t\tComparator<IItem> comparator = Comparator.comparing(item -> accessor.getMember(item));\n@@ -554,1 +560,2 @@\n-\t\t\t\t\t\t\t\tDataPageToolkit.addEndTimeLine(xyRenderer, allItems.iterator(), type, qAttribute, fill);\n+\t\t\t\t\t\t\t\tDataPageToolkit.addEndTimeLine(xyRenderer,\n+\t\t\t\t\t\t\t\t\t\tIteratorToolkit.mergedSorting(iterators, comparator), type, qAttribute, fill);\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/pages\/itemhandler\/ItemChart.java","additions":13,"deletions":6,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,2 @@\n+import java.util.Collection;\n+import java.util.Comparator;\n@@ -39,0 +41,2 @@\n+import java.util.PriorityQueue;\n+import java.util.Queue;\n@@ -109,0 +113,35 @@\n+\t\/**\n+\t * Wrap an iterator in a new iterator that merges values from sorted iterators.\n+\t *\n+\t * @param <T>\n+\t *            input iterator type\n+\t * @param iterators\n+\t *            input iterators\n+\t * @param comparator\n+\t *            ordering rule function\n+\t * @return a new iterator that contains sorted elements\n+\t *\/\n+\tpublic static <T> Iterator<T> mergedSorting(\n+\t\tfinal Collection<? extends Iterator<T>> iterators, final Comparator<T> comparator) {\n+\t\tfinal Queue<PeekingIterator<T>> priorityQueue = new PriorityQueue<>(\n+\t\t\t\tComparator.comparing(PeekingIterator::peek, comparator));\n+\t\tfor (Iterator<T> iterator : iterators) {\n+\t\t\tif (iterator.hasNext()) {\n+\t\t\t\tpriorityQueue.add(new PeekingIterator<>(iterator));\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn new AbstractIterator<T>() {\n+\t\t\t@Override\n+\t\t\tprotected T findNext() {\n+\t\t\t\tif (priorityQueue.isEmpty())\n+\t\t\t\t\treturn NO_MORE_ELEMENTS;\n+\t\t\t\tPeekingIterator<T> minPeekingIterator = priorityQueue.poll();\n+\t\t\t\tT result = minPeekingIterator.next();\n+\t\t\t\tif (minPeekingIterator.hasNext())\n+\t\t\t\t\tpriorityQueue.add(minPeekingIterator);\n+\t\t\t\treturn result;\n+\t\t\t}\n+\t\t};\n+\t}\n+\n","filename":"core\/org.openjdk.jmc.common\/src\/main\/java\/org\/openjdk\/jmc\/common\/collection\/IteratorToolkit.java","additions":40,"deletions":1,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -0,0 +1,75 @@\n+\/*\n+ * Copyright (c) 2018, 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * \n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ * \n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ * \n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ * \n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ * \n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.common.collection;\n+\n+import java.util.Iterator;\n+\n+\/**\n+ * Iterator wrapper that allows peeking at the next element.\n+ *\n+ * @param <T>\n+ *            the type of elements returned by the iterator\n+ *\/\n+public class PeekingIterator<T> implements Iterator<T> {\n+\tprivate final Iterator<T> sourceIterator;\n+\tprivate T peekedElement;\n+\tprivate boolean hasPeeked;\n+\n+\tpublic PeekingIterator(Iterator<T> sourceIterator) {\n+\t\tthis.sourceIterator = sourceIterator;\n+\t}\n+\n+\tpublic T peek() {\n+\t\tif (!this.hasPeeked) {\n+\t\t\tthis.hasPeeked = true;\n+\t\t\tthis.peekedElement = this.sourceIterator.next();\n+\t\t}\n+\t\treturn this.peekedElement;\n+\t}\n+\n+\t@Override\n+\tpublic T next() {\n+\t\tif (!this.hasPeeked) {\n+\t\t\treturn this.sourceIterator.next();\n+\t\t}\n+\t\tthis.hasPeeked = false;\n+\t\tT result = this.peekedElement;\n+\t\tthis.peekedElement = null;\n+\t\treturn result;\n+\t}\n+\n+\t@Override\n+\tpublic boolean hasNext() {\n+\t\treturn this.hasPeeked || this.sourceIterator.hasNext();\n+\t}\n+}\n","filename":"core\/org.openjdk.jmc.common\/src\/main\/java\/org\/openjdk\/jmc\/common\/collection\/PeekingIterator.java","additions":75,"deletions":0,"binary":false,"changes":75,"status":"added"}]}