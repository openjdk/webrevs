{"files":[{"patch":"@@ -2,2 +2,2 @@\n-# Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n-# Copyright (c) 2019, 2023, Datadog, Inc. All rights reserved.\n+# Copyright (c) 2019, 2024, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2019, 2024, Datadog, Inc. All rights reserved.\n@@ -51,1 +51,1 @@\n-      uses: actions\/checkout@v3\n+      uses: actions\/checkout@v4\n@@ -71,3 +71,3 @@\n-      uses: actions\/checkout@v3\n-    - name: Set up Java\n-      uses: actions\/setup-java@v3\n+      uses: actions\/checkout@v4\n+    - name: Set up Java 17\n+      uses: actions\/setup-java@v4\n@@ -79,0 +79,11 @@\n+    - name: Set up Java 21\n+      uses: actions\/setup-java@v4\n+      with:\n+        distribution: temurin\n+        java-version: '21'\n+        java-package: jdk\n+        mvn-toolchain-id: 'JavaSE-21'\n+    - name: Set up Maven\n+      uses: stCarolas\/setup-maven@v4.5\n+      with:\n+        maven-version: 3.9.6\n@@ -80,1 +91,1 @@\n-      uses: actions\/cache@v3\n+      uses: actions\/cache@v4\n","filename":".github\/workflows\/validate.yml","additions":18,"deletions":7,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -94,2 +94,2 @@\n-\t\t<maven.compiler.source>17<\/maven.compiler.source>\n-\t\t<maven.compiler.target>17<\/maven.compiler.target>\n+\t\t<maven.compiler.source>21<\/maven.compiler.source>\n+\t\t<maven.compiler.target>21<\/maven.compiler.target>\n@@ -97,3 +97,3 @@\n-\t\t<tycho.version>3.0.5<\/tycho.version>\n-\t\t<maven.toolchains.version>3.1.0<\/maven.toolchains.version>\n-\t\t<maven.checkstyle.version>3.3.0<\/maven.checkstyle.version>\n+\t\t<tycho.version>4.0.8<\/tycho.version>\n+\t\t<maven.toolchains.version>3.2.0<\/maven.toolchains.version>\n+\t\t<maven.checkstyle.version>3.4.0<\/maven.checkstyle.version>\n@@ -128,1 +128,1 @@\n-\t\t\t<id>2024-03<\/id>\n+\t\t\t<id>2024-06<\/id>\n@@ -132,0 +132,21 @@\n+\t\t\t<build>\n+\t\t\t\t<plugins>\n+\t\t\t\t\t<plugin>\n+\t\t\t\t\t\t<groupId>org.eclipse.tycho<\/groupId>\n+\t\t\t\t\t\t<artifactId>target-platform-configuration<\/artifactId>\n+\t\t\t\t\t\t<version>${tycho.version}<\/version>\n+\t\t\t\t\t\t<configuration>\n+\t\t\t\t\t\t\t<target>\n+\t\t\t\t\t\t\t\t<artifact>\n+\t\t\t\t\t\t\t\t\t<groupId>org.openjdk.jmc<\/groupId>\n+\t\t\t\t\t\t\t\t\t<artifactId>platform-definition-2024-06<\/artifactId>\n+\t\t\t\t\t\t\t\t\t<version>${revision}${changelist}<\/version>\n+\t\t\t\t\t\t\t\t<\/artifact>\n+\t\t\t\t\t\t\t<\/target>\n+\t\t\t\t\t\t<\/configuration>\n+\t\t\t\t\t<\/plugin>\n+\t\t\t\t<\/plugins>\n+\t\t\t<\/build>\n+\t\t<\/profile>\n+\t\t<profile>\n+\t\t\t<id>2024-03<\/id>\n@@ -217,1 +238,1 @@\n-\t\t\t\t\t\t<archiveFileName>${groupId}-${project.version}<\/archiveFileName>\n+\t\t\t\t\t\t<archiveFileName>${project.groupId}-${project.version}<\/archiveFileName>\n@@ -238,1 +259,1 @@\n-\t\t\t\t\t\t<goals>\n+\t\t\t\t\t\t<!--<goals>\n@@ -240,1 +261,1 @@\n-\t\t\t\t\t\t<\/goals>\n+\t\t\t\t\t\t<\/goals>-->\n","filename":"pom.xml","additions":30,"deletions":9,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -63,1 +63,1 @@\n-            <unit id=\"org.apache.aries.spifly.dynamic.bundle\" version=\"1.3.6\"\/>\n+            <unit id=\"org.apache.aries.spifly.dynamic.bundle\" version=\"1.3.7\"\/>\n","filename":"releng\/platform-definitions\/platform-definition-2024-03\/platform-definition-2024-03.target","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -0,0 +1,98 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n+<!--\n+   Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2024, Datadog, Inc. All rights reserved.\n+\n+   DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+   The contents of this file are subject to the terms of either the Universal Permissive License\n+   v 1.0 as shown at http:\/\/oss.oracle.com\/licenses\/upl\n+\n+   or the following license:\n+\n+   Redistribution and use in source and binary forms, with or without modification, are permitted\n+   provided that the following conditions are met:\n+\n+   1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+   and the following disclaimer.\n+\n+   2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+   conditions and the following disclaimer in the documentation and\/or other materials provided with\n+   the distribution.\n+\n+   3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+   endorse or promote products derived from this software without specific prior written permission.\n+\n+   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+   IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+   FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+   WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+   WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+-->\n+<?pde version=\"3.8\"?>\n+<target name=\"jmc-target-2024-06\" sequenceNumber=\"47\">\n+    <locations>\n+        <location includeAllPlatforms=\"false\" includeConfigurePhase=\"true\" includeMode=\"planner\" includeSource=\"true\" type=\"InstallableUnit\">\n+            <unit id=\"org.eclipse.angus.jakarta.mail\" version=\"2.0.1\"\/>\n+            <unit id=\"angus-activation\" version=\"2.0.0\"\/>\n+            <unit id=\"org.owasp.encoder\" version=\"1.2.3\"\/>\n+            <unit id=\"lz4-java\" version=\"1.8.0\"\/>\n+            <unit id=\"org.hdrhistogram.HdrHistogram\" version=\"2.2.2\"\/>\n+            <unit id=\"org.adoptopenjdk.jemmy-awt-input\" version=\"2.0.0\"\/>\n+            <unit id=\"org.adoptopenjdk.jemmy-browser\" version=\"2.0.0\"\/>\n+            <unit id=\"org.adoptopenjdk.jemmy-core\" version=\"2.0.0\"\/>\n+            <unit id=\"org.adoptopenjdk.jemmy-swt\" version=\"2.0.0\"\/>\n+            <unit id=\"org.jolokia.client-jmx-adapter.standalone\" version=\"2.0.2\"\/>\n+            <unit id=\"org.jolokia.service.discovery\" version=\"2.0.2\"\/>\n+            <unit id=\"org.jolokia.server.core\" version=\"2.0.2\"\/>\n+            <unit id=\"com.github.tomakehurst.wiremock-standalone\" version=\"2.27.2\"\/>\n+            <unit id=\"org.eclipse.jetty.websocket.api\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.ee9.websocket.api\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.ee9.websocket.server\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.websocket.server\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.ee9.servlet\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.ee9.server\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.ee9.websocket.servlet\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.alpn.client\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.websocket.core.client\" version=\"12.0.6\"\/>\n+            <unit id=\"org.eclipse.jetty.servlet-api\" version=\"5.0.2\"\/>\n+            <unit id=\"jakarta.annotation-api\" version=\"1.3.5\"\/>\n+            <unit id=\"org.apache.aries.spifly.dynamic.bundle\" version=\"1.3.7\"\/>\n+            <unit id=\"fireplace-swing\" version=\"0.0.1.rc3\"\/>\n+            <unit id=\"fireplace-swt-awt-bridge\" version=\"0.0.1.rc3\"\/>\n+            <unit id=\"fireplace-swing-animation\" version=\"0.0.1.rc3\"\/>\n+            <unit id=\"radiance-animation\" version=\"6.0.0\"\/>\n+            <repository location=\"http:\/\/localhost:8080\/site\"\/>\n+        <\/location>\n+        <location includeAllPlatforms=\"false\" includeConfigurePhase=\"true\" includeMode=\"planner\" includeSource=\"true\" type=\"InstallableUnit\">\n+            <unit id=\"org.eclipse.equinox.executable.feature.group\" version=\"3.8.2500.v20240513-1750\"\/>\n+            <unit id=\"org.eclipse.pde.feature.group\" version=\"3.15.400.v20240601-0610\"\/>\n+            <unit id=\"jakarta.servlet-api\" version=\"6.0.0\"\/>\n+            <unit id=\"org.eclipse.equinox.p2.ui.sdk.scheduler\" version=\"1.6.300.v20240515-1919\"\/>\n+            <unit id=\"org.eclipse.equinox.p2.updatechecker\" version=\"1.4.300.v20240514-1422\"\/>\n+            <unit id=\"org.eclipse.update.configurator\" version=\"3.5.400.v20240416-0654\"\/>\n+            <unit id=\"org.eclipse.equinox.p2.reconciler.dropins\" version=\"1.5.400.v20240321-1450\"\/>\n+            <unit id=\"org.eclipse.help.webapp\" version=\"3.11.400.v20240508-1954\"\/>\n+            <unit id=\"org.apache.commons.codec\" version=\"1.14.0.v20221112-0806\"\/>\n+            <unit id=\"org.eclipse.rcp.feature.group\" version=\"4.32.0.v20240601-0610\"\/>\n+            <unit id=\"org.eclipse.help.feature.group\" version=\"2.3.1800.v20240601-0610\"\/>\n+            <unit id=\"org.eclipse.equinox.p2.rcp.feature.feature.group\" version=\"1.4.2400.v20240515-1919\"\/>\n+            <unit id=\"org.eclipse.ui.net\" version=\"1.5.400.v20240413-1529\"\/>\n+            <unit id=\"org.eclipse.equinox.p2.director.app\" version=\"1.3.400.v20240425-1316\"\/>\n+            <unit id=\"org.eclipse.ui.themes\" version=\"1.2.2400.v20240213-1133\"\/>\n+            <unit id=\"org.eclipse.sdk\" version=\"4.32.0.v20240601-0610\"\/>\n+\t    <unit id=\"org.eclipse.osgi.services\" version=\"3.12.100.v20240327-0645\"\/>\n+            <repository location=\"https:\/\/download.eclipse.org\/releases\/2024-06\/\" \/>\n+        <\/location>\n+        <location includeAllPlatforms=\"false\" includeConfigurePhase=\"true\" includeMode=\"planner\" includeSource=\"true\" type=\"InstallableUnit\">\n+            <unit id=\"org.eclipse.babel.nls_eclipse_ja.feature.group\" version=\"4.26.0.v20230220105658\"\/>\n+            <unit id=\"org.eclipse.babel.nls_eclipse_zh.feature.group\" version=\"4.26.0.v20230220105658\"\/>\n+            <!-- No new release yet - using 2022-12 -->\n+            <repository location=\"https:\/\/archive.eclipse.org\/technology\/babel\/update-site\/R0.20.0\/2022-12\/\"\/>\n+        <\/location>\n+    <\/locations>\n+    <targetJRE path=\"org.eclipse.jdt.launching.JRE_CONTAINER\/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType\/JavaSE-21\"\/>\n+<\/target>\n","filename":"releng\/platform-definitions\/platform-definition-2024-06\/platform-definition-2024-06.target","additions":98,"deletions":0,"binary":false,"changes":98,"status":"added"},{"patch":"@@ -42,1 +42,1 @@\n-\t<artifactId>platform-definition-2024-03<\/artifactId>\n+\t<artifactId>platform-definition-2024-06<\/artifactId>\n","filename":"releng\/platform-definitions\/platform-definition-2024-06\/pom.xml","additions":1,"deletions":1,"binary":false,"changes":2,"previous_filename":"releng\/platform-definitions\/platform-definition-2024-03\/pom.xml","status":"copied"},{"patch":"@@ -47,0 +47,1 @@\n+\t\t<module>platform-definition-2024-06<\/module>\n","filename":"releng\/platform-definitions\/pom.xml","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -46,2 +46,2 @@\n-\t\t<maven.compiler.source>17<\/maven.compiler.source>\n-\t\t<maven.compiler.target>17<\/maven.compiler.target>\n+\t\t<maven.compiler.source>21<\/maven.compiler.source>\n+\t\t<maven.compiler.target>21<\/maven.compiler.target>\n@@ -63,1 +63,1 @@\n-\t\t<spifly.version>1.3.6<\/spifly.version>\n+\t\t<spifly.version>1.3.7<\/spifly.version>\n@@ -239,2 +239,2 @@\n-\t\t\t\t\t\t\t\t\t<version>[17,)<\/version>\n-\t\t\t\t\t\t\t\t\t<message>Building JMC requires Java 17 or later<\/message>\n+\t\t\t\t\t\t\t\t\t<version>[21,)<\/version>\n+\t\t\t\t\t\t\t\t\t<message>Building JMC requires Java 21 or later<\/message>\n","filename":"releng\/third-party\/pom.xml","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -39,0 +39,3 @@\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Map.Entry;\n@@ -59,0 +62,30 @@\n+\t\tMap<String, String> versions = getNewVersions(eclipseVersion);\n+\t\tfor (Entry<String, String> entry : versions.entrySet()) {\n+\t\t\tswitch (entry.getKey()) {\n+\t\t\tcase \"org.eclipse.equinox.executable.feature.group\":\n+\t\t\tcase \"org.eclipse.pde.feature.group\":\n+\t\t\tcase \"org.eclipse.platform.sdk\":\n+\t\t\tcase \"org.eclipse.equinox.p2.ui.sdk.scheduler\":\n+\t\t\tcase \"org.eclipse.equinox.p2.updatechecker\":\n+\t\t\tcase \"org.eclipse.update.configurator\":\n+\t\t\tcase \"org.eclipse.equinox.p2.reconciler.dropins\":\n+\t\t\tcase \"org.eclipse.help.webapp\":\n+\t\t\tcase \"org.apache.commons.codec\":\n+\t\t\tcase \"org.eclipse.rcp.feature.group\":\n+\t\t\tcase \"org.eclipse.help.feature.group\":\n+\t\t\tcase \"org.eclipse.equinox.p2.rcp.feature.feature.group\":\n+\t\t\tcase \"org.eclipse.ui.net\":\n+\t\t\tcase \"org.eclipse.equinox.p2.director.app\":\n+\t\t\tcase \"org.eclipse.ui.themes\":\n+\t\t\tcase \"org.eclipse.sdk\":\n+\t\t\t\tSystem.out.println(\"Found unit: \" + entry.getKey() + \", Version: \" + entry.getValue());\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\t\/\/ Ignoring other units\n+\t\t\t}\n+\t\t}\n+\n+\t}\n+\n+\tpublic static Map<String, String> getNewVersions(String eclipseVersion) {\n+\t\tMap<String, String> versions = new HashMap<>();\n@@ -88,1 +121,1 @@\n-\t\t\t\treturn;\n+\t\t\t\treturn versions;\n@@ -106,22 +139,1 @@\n-\t\t\t\t\t\tswitch (id) {\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.executable.feature.group\":\n-\t\t\t\t\t\tcase \"org.eclipse.pde.feature.group\":\n-\t\t\t\t\t\tcase \"org.eclipse.platform.sdk\":\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.p2.ui.sdk.scheduler\":\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.p2.updatechecker\":\n-\t\t\t\t\t\tcase \"org.eclipse.update.configurator\":\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.p2.reconciler.dropins\":\n-\t\t\t\t\t\tcase \"org.eclipse.help.webapp\":\n-\t\t\t\t\t\tcase \"org.apache.commons.codec\":\n-\t\t\t\t\t\tcase \"org.eclipse.rcp.feature.group\":\n-\t\t\t\t\t\tcase \"org.eclipse.help.feature.group\":\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.p2.rcp.feature.feature.group\":\n-\t\t\t\t\t\tcase \"org.eclipse.ui.net\":\n-\t\t\t\t\t\tcase \"org.eclipse.equinox.p2.director.app\":\n-\t\t\t\t\t\tcase \"org.eclipse.ui.themes\":\n-\t\t\t\t\t\tcase \"org.eclipse.sdk\":\n-\t\t\t\t\t\t\tSystem.out.println(\"Found unit: \" + id + \", Version: \" + version);\n-\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\/\/ Ignoring other units\n-\t\t\t\t\t\t}\n+\t\t\t\t\t\tversions.put(id, version);\n@@ -134,0 +146,1 @@\n+\t\treturn versions;\n","filename":"releng\/tools\/org.openjdk.jmc.util.listversions\/src\/org\/openjdk\/jmc\/util\/listversions\/ListVersions.java","additions":36,"deletions":23,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -0,0 +1,134 @@\n+\/*\n+ * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2024, Datadog, Inc. All rights reserved.\n+ *\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at http:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.util.listversions;\n+\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Map;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+public class UpdateVersions {\n+\n+\tpublic static void main(String[] args) throws IOException {\n+\t\tif (args.length != 2) {\n+\t\t\tSystem.out\n+\t\t\t\t\t.println(\"Usage: java UpdatePlatformDefinition <Eclipse version> <Platform definition file path>\");\n+\t\t\tSystem.exit(2);\n+\t\t}\n+\t\tString eclipseVersion = args[0];\n+\t\tString platformDefinitionPath = args[1];\n+\n+\t\tMap<String, String> newVersions = ListVersions.getNewVersions(eclipseVersion);\n+\t\tString updatedContent = updatePlatformDefinition(platformDefinitionPath, newVersions, eclipseVersion);\n+\t\twritePlatformDefinition(platformDefinitionPath, updatedContent);\n+\t}\n+\n+\tprivate static void writePlatformDefinition(String platformDefinitionPath, String updatedContent)\n+\t\t\tthrows IOException {\n+\t\tSystem.out.println(\"Updated content...\");\n+\t\tSystem.out.println(updatedContent);\n+\t\tPath originalFile = Paths.get(platformDefinitionPath);\n+\t\tPath directory = originalFile.getParent();\n+\t\tString fileName = originalFile.getFileName().toString();\n+\t\tString newFileName = \"updated_\" + fileName;\n+\t\tPath newFile = directory.resolve(newFileName);\n+\n+\t\tFiles.write(newFile, updatedContent.getBytes());\n+\t\tSystem.out.println(\"Updated platform definition written to: \" + newFile);\n+\t}\n+\n+\tprivate static String updatePlatformDefinition(String filePath, Map<String, String> newVersions, String newEclipseVersion)\n+\t\t\tthrows IOException {\n+\t\tString content = new String(Files.readAllBytes(Paths.get(filePath)));\n+\t\tcontent = updateTargetName(content, newEclipseVersion);\n+\t\tcontent = updateRepositoryLocation(content, newEclipseVersion);\n+\n+\t\t\/\/ Pattern to match <unit> elements with their id and version\n+\t\tPattern pattern = Pattern.compile(\"<unit\\\\s+id=\\\"([^\\\"]+)\\\"\\\\s+version=\\\"([^\\\"]+)\\\"\\\\s*\/>\");\n+\n+\t\tStringBuffer sb = new StringBuffer();\n+\t\tMatcher matcher = pattern.matcher(content);\n+\n+\t\twhile (matcher.find()) {\n+\t\t\tString id = matcher.group(1);\n+\t\t\tString currentVersion = matcher.group(2);\n+\n+\t\t\tif (newVersions.containsKey(id)) {\n+\t\t\t\tString newVersion = newVersions.get(id);\n+\t\t\t\t\/\/ Replace only the version, keeping everything else the same\n+\t\t\t\tString replacement = matcher.group().replace(\"version=\\\"\" + currentVersion + \"\\\"\",\n+\t\t\t\t\t\t\"version=\\\"\" + newVersion + \"\\\"\");\n+\t\t\t\tmatcher.appendReplacement(sb, Matcher.quoteReplacement(replacement));\n+\t\t\t\tSystem.out.println(\"Updated \" + id + \" from version \" + currentVersion + \" to \" + newVersion);\n+\t\t\t} else {\n+\t\t\t\t\/\/ If no new version, keep the original\n+\t\t\t\tmatcher.appendReplacement(sb, Matcher.quoteReplacement(matcher.group()));\n+\t\t\t}\n+\t\t}\n+\t\tmatcher.appendTail(sb);\n+\n+\t\treturn sb.toString();\n+\t}\n+\n+\tprivate static String updateTargetName(String content, String newEclipseVersion) {\n+\t\tPattern pattern = Pattern.compile(\"<target\\\\s+name=\\\"jmc-target-\\\\d{4}-\\\\d{2}\\\"\");\n+\t\tMatcher matcher = pattern.matcher(content);\n+\n+\t\tif (matcher.find()) {\n+\t\t\tString oldTargetName = matcher.group();\n+\t\t\tString newTargetName = \"<target name=\\\"jmc-target-\" + newEclipseVersion + \"\\\"\";\n+\t\t\tcontent = content.replace(oldTargetName, newTargetName);\n+\t\t}\n+\n+\t\treturn content;\n+\t}\n+\n+\tprivate static String updateRepositoryLocation(String content, String newEclipseVersion) {\n+\t\tPattern pattern = Pattern\n+\t\t\t\t.compile(\"<repository\\\\s+location=\\\"https:\/\/download.eclipse.org\/releases\/\\\\d{4}-\\\\d{2}\/\\\"\\\\s*\/>\");\n+\t\tMatcher matcher = pattern.matcher(content);\n+\n+\t\tif (matcher.find()) {\n+\t\t\tString oldRepository = matcher.group();\n+\t\t\tString newRepository = \"<repository location=\\\"https:\/\/download.eclipse.org\/releases\/\" + newEclipseVersion\n+\t\t\t\t\t+ \"\/\\\" \/>\";\n+\t\t\tcontent = content.replace(oldRepository, newRepository);\n+\t\t}\n+\n+\t\treturn content;\n+\t}\n+}\n","filename":"releng\/tools\/org.openjdk.jmc.util.listversions\/src\/org\/openjdk\/jmc\/util\/listversions\/UpdateVersions.java","additions":134,"deletions":0,"binary":false,"changes":134,"status":"added"}]}