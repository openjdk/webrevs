{"files":[{"patch":"@@ -3,2 +3,2 @@\n-   Copyright (c) 2019, 2025, Oracle and\/or its affiliates. All rights reserved.\n-   Copyright (c) 2019, 2025, Red Hat Inc. All rights reserved.\n+   Copyright (c) 2019, 2026, Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2019, 2026, Red Hat Inc. All rights reserved.\n@@ -270,0 +270,5 @@\n+\t\t<dependency>\n+\t\t\t<groupId>org.openjdk.jmc<\/groupId>\n+\t\t\t<artifactId>org.openjdk.jmc.ui.websocket<\/artifactId>\n+\t\t\t<version>${project.version}<\/version>\n+\t\t<\/dependency>\n","filename":"application\/coverage\/pom.xml","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n-   Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -169,0 +169,7 @@\n+   <plugin\n+         id=\"org.openjdk.jmc.ui.websocket\"\n+         download-size=\"0\"\n+         install-size=\"0\"\n+         version=\"0.0.0\"\n+         unpack=\"false\"\/>\n+\n","filename":"application\/org.openjdk.jmc.feature.core\/feature.xml","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -21,0 +21,1 @@\n+ org.openjdk.jmc.ui.websocket,\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/META-INF\/MANIFEST.MF","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -146,17 +146,0 @@\n-\tpublic static int parseWebsocketPort(String port) {\n-\t\ttry {\n-\t\t\treturn Integer.parseInt(port);\n-\t\t} catch (NumberFormatException e) {\n-\t\t\treturn PreferenceKeys.DEFAULT_WEBSOCKET_PORT;\n-\t\t}\n-\t}\n-\n-\tpublic int getWebsocketPort() {\n-\t\treturn parseWebsocketPort(getPreferenceStore().getString(PreferenceKeys.PROPERTY_WEBSOCKET_SERVER_PORT));\n-\t}\n-\n-\tpublic boolean isWebsocketServerEnabled() {\n-\t\tint port = getWebsocketPort();\n-\t\treturn port > 0 && port < 65535;\n-\t}\n-\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/FlightRecorderUI.java","additions":1,"deletions":18,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -86,1 +86,0 @@\n-import org.openjdk.jmc.flightrecorder.ui.websocket.WebsocketServer;\n@@ -93,0 +92,1 @@\n+import org.openjdk.jmc.ui.websocket.WebsocketPlugin;\n@@ -116,2 +116,0 @@\n-\tprivate IPropertyChangeListener websocketServerEnabledListener;\n-\tprivate WebsocketServer websocketServer;\n@@ -129,21 +127,0 @@\n-\t\tif (FlightRecorderUI.getDefault().isWebsocketServerEnabled()) {\n-\t\t\tint websocketServerPort = FlightRecorderUI.getDefault().getWebsocketPort();\n-\t\t\twebsocketServer = new WebsocketServer(websocketServerPort);\n-\t\t}\n-\t\twebsocketServerEnabledListener = e -> {\n-\t\t\tif (e.getProperty().equals(PreferenceKeys.PROPERTY_WEBSOCKET_SERVER_PORT)) {\n-\t\t\t\tint newWebsocketServerPort = FlightRecorderUI.parseWebsocketPort((String) e.getNewValue());\n-\t\t\t\tif (newWebsocketServerPort > 0) {\n-\t\t\t\t\tif (websocketServer != null) {\n-\t\t\t\t\t\twebsocketServer.shutdown();\n-\t\t\t\t\t\twebsocketServer = null;\n-\t\t\t\t\t}\n-\t\t\t\t\twebsocketServer = new WebsocketServer(newWebsocketServerPort);\n-\t\t\t\t} else {\n-\t\t\t\t\tif (websocketServer != null) {\n-\t\t\t\t\t\twebsocketServer.shutdown();\n-\t\t\t\t\t\twebsocketServer = null;\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t}\n-\t\t};\n@@ -151,1 +128,0 @@\n-\t\tFlightRecorderUI.getDefault().getPreferenceStore().addPropertyChangeListener(websocketServerEnabledListener);\n@@ -217,2 +193,2 @@\n-\t\tif (websocketServer != null) {\n-\t\t\twebsocketServer.notifyAll(selectionItems);\n+\t\tif (WebsocketPlugin.getDefault().getServerEnabled() == true) {\n+\t\t\tWebsocketPlugin.getDefault().notifyAll(selectionItems);\n@@ -432,1 +408,0 @@\n-\t\tFlightRecorderUI.getDefault().getPreferenceStore().removePropertyChangeListener(websocketServerEnabledListener);\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/JfrEditor.java","additions":4,"deletions":29,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -478,3 +478,0 @@\n-\tpublic static String PREFERENCES_WEBSOCKET_SERVER_PORT_INVALID;\n-\tpublic static String PREFERENCES_WEBSOCKET_SERVER_PORT_TEXT;\n-\tpublic static String PREFERENCES_WEBSOCKET_SERVER_PORT_TOOLTIP;\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/messages\/internal\/Messages.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -96,1 +96,0 @@\n-\tprivate Text websocketPortValue;\n@@ -175,8 +174,0 @@\n-\t\tLabel websocketPortLabel = new Label(defaultTimespanContainer, SWT.NONE);\n-\t\twebsocketPortLabel.setLayoutData(new GridData(SWT.FILL, SWT.CENTER, false, false));\n-\t\twebsocketPortLabel.setText(Messages.PREFERENCES_WEBSOCKET_SERVER_PORT_TEXT);\n-\t\twebsocketPortLabel.setToolTipText(Messages.PREFERENCES_WEBSOCKET_SERVER_PORT_TOOLTIP);\n-\t\twebsocketPortValue = new Text(defaultTimespanContainer, SWT.BORDER);\n-\t\twebsocketPortValue.setLayoutData(new GridData(SWT.FILL, SWT.CENTER, true, false));\n-\t\tQuantityKindProposal.install(websocketPortValue, UnitLookup.NUMBER);\n-\n@@ -189,1 +180,0 @@\n-\t\tloadWebsocketPortFromPrefStore(false);\n@@ -220,6 +210,0 @@\n-\t\twebsocketPortValue.addModifyListener(new ModifyListener() {\n-\t\t\t@Override\n-\t\t\tpublic void modifyText(ModifyEvent e) {\n-\t\t\t\tvalidatePage();\n-\t\t\t}\n-\t\t});\n@@ -246,17 +230,1 @@\n-\t\tString error5 = validateWebsocketPort(websocketPortValue.getText());\n-\t\tif (error == null && error2 == null && error3 == null) {\n-\t\t\tsetErrorMessage(error5);\n-\t\t}\n-\t\tsetValid(error == null && error2 == null && error3 == null && error4 == null && error5 == null);\n-\t}\n-\n-\tpublic static String validateWebsocketPort(String text) {\n-\t\ttry {\n-\t\t\tint port = Integer.parseInt(text);\n-\t\t\tif (port < 0 || port > 65535) {\n-\t\t\t\treturn Messages.PREFERENCES_WEBSOCKET_SERVER_PORT_INVALID;\n-\t\t\t}\n-\t\t} catch (NumberFormatException e) {\n-\t\t\treturn Messages.PREFERENCES_WEBSOCKET_SERVER_PORT_INVALID;\n-\t\t}\n-\t\treturn null;\n+\t\tsetValid(error == null && error2 == null && error3 == null && error4 == null);\n@@ -342,46 +310,0 @@\n-\tprivate void loadWebsocketPortFromPrefStore(boolean loadDefault) {\n-\t\tString port = loadDefault ? getPreferenceStore().getDefaultString(PreferenceKeys.PROPERTY_WEBSOCKET_SERVER_PORT)\n-\t\t\t\t: getPreferenceStore().getString(PreferenceKeys.PROPERTY_WEBSOCKET_SERVER_PORT);\n-\t\twebsocketPortValue.setText(Integer.toString(FlightRecorderUI.parseWebsocketPort(port)));\n-\t}\n-\n-\/\/\tprivate Button createClearButton(Composite parent) {\n-\/\/\t\tButton button = new Button(parent, SWT.NONE);\n-\/\/\t\tbutton.setText(Messages.PREFERENCES_CLEAR_USER_SETTINGS_TEXT);\n-\/\/\t\tbutton.addSelectionListener(new SelectionAdapter() {\n-\/\/\t\t\t@Override\n-\/\/\t\t\tpublic void widgetSelected(SelectionEvent e) {\n-\/\/\t\t\t\tif (ensureAllEditorsClosed()) {\n-\/\/\t\t\t\t\tshowConfirmUserSettingReset();\n-\/\/\t\t\t\t}\n-\/\/\t\t\t}\n-\/\/\t\t});\n-\/\/\t\treturn button;\n-\/\/\t}\n-\/\/\n-\/\/\tprivate boolean ensureAllEditorsClosed() {\n-\/\/\t\tfor (IEditorReference ref : m_workbench.getActiveWorkbenchWindow().getActivePage().getEditorReferences()) {\n-\/\/\t\t\tif (JfrEditor.EDITOR_ID.equals(ref.getId())) {\n-\/\/\t\t\t\tshowMustCloseEditor();\n-\/\/\t\t\t\treturn false;\n-\/\/\t\t\t}\n-\/\/\t\t}\n-\/\/\t\treturn true;\n-\/\/\t}\n-\/\/\n-\/\/\tprivate void showMustCloseEditor() {\n-\/\/\t\tMessageBox messageBox = new MessageBox(getShell(), SWT.ICON_INFORMATION);\n-\/\/\t\tmessageBox.setMessage(Messages.PREFERENCES_OPEN_FLIGHT_RECORDING_DIALOG_TEXT);\n-\/\/\t\tmessageBox.setText(Messages.PREFERENCES_OPEN_FLIGHT_RECORDING_DIALOG_TITLE);\n-\/\/\t\tmessageBox.open();\n-\/\/\t}\n-\/\/\n-\/\/\tprivate void showConfirmUserSettingReset() {\n-\/\/\t\tMessageBox messageBox = new MessageBox(getShell(), SWT.ICON_WARNING | SWT.YES | SWT.NO);\n-\/\/\t\tmessageBox.setMessage(Messages.PREFERENCES_RESET_USER_SETTINGS_DIALOG_TEXT);\n-\/\/\t\tmessageBox.setText(Messages.PREFERENCES_RESET_USER_SETTINGS_DIALOG_TITLE);\n-\/\/\t\tif (messageBox.open() == SWT.YES) {\n-\/\/\t\t\tComponentsPlugin.getDefault().getUserInterfaceRepository().clearUserSettings(JfrEditor.EDITOR_ID);\n-\/\/\t\t}\n-\/\/\t}\n-\n@@ -434,1 +356,0 @@\n-\t\tloadWebsocketPortFromPrefStore(true);\n@@ -486,7 +407,0 @@\n-\t\ttry {\n-\t\t\tint port = Integer.parseInt(websocketPortValue.getText());\n-\t\t\tgetPreferenceStore().setValue(PreferenceKeys.PROPERTY_WEBSOCKET_SERVER_PORT, Integer.toString(port));\n-\t\t} catch (NumberFormatException e) {\n-\t\t\tsetErrorMessage(Messages.PREFERENCES_WEBSOCKET_SERVER_PORT_INVALID);\n-\t\t\treturn false;\n-\t\t}\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/preferences\/GeneralPage.java","additions":2,"deletions":88,"binary":false,"changes":90,"status":"modified"},{"patch":"@@ -1,256 +0,0 @@\n-\/*\n- * Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2021, 2025, Datadog, Inc. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * The contents of this file are subject to the terms of either the Universal Permissive License\n- * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n- *\n- * or the following license:\n- *\n- * Redistribution and use in source and binary forms, with or without modification, are permitted\n- * provided that the following conditions are met:\n- *\n- * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n- * and the following disclaimer.\n- *\n- * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n- * conditions and the following disclaimer in the documentation and\/or other materials provided with\n- * the distribution.\n- *\n- * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n- * endorse or promote products derived from this software without specific prior written permission.\n- *\n- * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n- * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n- * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n- * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n- * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n- * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n- * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n- * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n- *\/\n-package org.openjdk.jmc.flightrecorder.ui.websocket;\n-\n-import java.io.IOException;\n-import java.time.Duration;\n-import java.util.HashMap;\n-import java.util.List;\n-import java.util.concurrent.CopyOnWriteArrayList;\n-import java.util.concurrent.ExecutorService;\n-import java.util.concurrent.Executors;\n-import java.util.concurrent.TimeoutException;\n-import java.util.function.Function;\n-import java.util.logging.Level;\n-import java.util.stream.Collectors;\n-\n-import org.eclipse.jetty.server.Server;\n-import org.eclipse.jetty.server.ServerConnector;\n-import org.eclipse.jetty.ee9.servlet.ServletContextHandler;\n-import org.eclipse.jetty.ee9.websocket.api.Session;\n-import org.eclipse.jetty.ee9.websocket.api.WebSocketAdapter;\n-import org.eclipse.jetty.ee9.websocket.server.config.JettyWebSocketServletContainerInitializer;\n-import org.eclipse.jetty.ee9.websocket.servlet.WebSocketUpgradeFilter;\n-import org.openjdk.jmc.common.item.IItemCollection;\n-import org.openjdk.jmc.flightrecorder.serializers.dot.DotSerializer;\n-import org.openjdk.jmc.flightrecorder.serializers.json.FlameGraphJsonSerializer;\n-import org.openjdk.jmc.flightrecorder.serializers.json.IItemCollectionJsonSerializer;\n-import org.openjdk.jmc.flightrecorder.stacktrace.FrameSeparator;\n-import org.openjdk.jmc.flightrecorder.stacktrace.FrameSeparator.FrameCategorization;\n-import org.openjdk.jmc.flightrecorder.stacktrace.graph.StacktraceGraphModel;\n-import org.openjdk.jmc.flightrecorder.stacktrace.tree.StacktraceTreeModel;\n-import org.openjdk.jmc.flightrecorder.ui.FlightRecorderUI;\n-\n-public class WebsocketServer {\n-\n-\tprivate static int MAX_MESSAGE_SIZE = 1024 * 1024 * 1024;\n-\tprivate static int IDLE_TIMEOUT_MINUTES = 5;\n-\n-\tprivate final int port;\n-\tprivate Server server;\n-\tprivate List<WebsocketConnectionHandler> handlers = new CopyOnWriteArrayList<>();\n-\tprivate List<WebsocketConnectionHandler> treeHandlers = new CopyOnWriteArrayList<>();\n-\tprivate List<WebsocketConnectionHandler> graphHandlers = new CopyOnWriteArrayList<>();\n-\tprivate final ExecutorService executorService = Executors.newSingleThreadExecutor();\n-\tprivate IItemCollection currentSelection = null;\n-\n-\tpublic WebsocketServer(int port) {\n-\t\tthis.port = port;\n-\t\texecutorService.execute(() -> startServer());\n-\t}\n-\n-\tpublic int getPort() {\n-\t\treturn port;\n-\t}\n-\n-\tprivate void startServer() {\n-\t\tserver = new Server();\n-\t\tServerConnector connector = new ServerConnector(server);\n-\t\tconnector.setHost(\"127.0.0.1\");\n-\t\tconnector.setPort(port);\n-\t\tserver.addConnector(connector);\n-\n-\t\tServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);\n-\t\tcontext.setContextPath(\"\/\");\n-\t\tserver.setHandler(context);\n-\n-\t\tJettyWebSocketServletContainerInitializer.configure(context, (servletContext, container) -> {\n-\t\t\tcontainer.setMaxBinaryMessageSize(MAX_MESSAGE_SIZE);\n-\t\t\tcontainer.setIdleTimeout(Duration.ofMinutes(IDLE_TIMEOUT_MINUTES));\n-\t\t\tcontainer.addMapping(\"\/events\/*\", (req, resp) -> {\n-\t\t\t\t\/\/ try to send the current selection when the client connects\n-\t\t\t\t\/\/ for simplicity, we serialise for every new connection\n-\t\t\t\tString eventsJson = WebsocketServer.toEventsJsonString(currentSelection);\n-\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(eventsJson);\n-\t\t\t\thandlers.add(handler);\n-\t\t\t\treturn handler;\n-\t\t\t});\n-\t\t\tcontainer.addMapping(\"\/tree\/*\", (req, resp) -> {\n-\t\t\t\tString treeJson = WebsocketServer.toTreeModelJsonString(currentSelection);\n-\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(treeJson);\n-\t\t\t\ttreeHandlers.add(handler);\n-\t\t\t\treturn handler;\n-\t\t\t});\n-\t\t\tcontainer.addMapping(\"\/graph\/*\", (req, resp) -> {\n-\t\t\t\tString dot = WebsocketServer.toGraphModelDotString(currentSelection);\n-\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(dot);\n-\t\t\t\tgraphHandlers.add(handler);\n-\t\t\t\treturn handler;\n-\t\t\t});\n-\t\t});\n-\n-\t\ttry {\n-\t\t\tWebSocketUpgradeFilter.ensureFilter(context.getServletContext());\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO,\n-\t\t\t\t\t\"Starting websocket server listening on port \" + port);\n-\t\t\tserver.start();\n-\t\t\tserver.join();\n-\t\t} catch (Exception e) {\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.SEVERE, \"Failed to start websocket server\", e);\n-\t\t}\n-\t}\n-\n-\tpublic void notifyAll(IItemCollection events) {\n-\t\tcurrentSelection = events;\n-\t\tnotifyAllEventHandlers(events);\n-\t\tnotifyAllGraphHandlers(events);\n-\t\tnotifyAllTreeHandlers(events);\n-\t}\n-\n-\tprivate void notifyAllEventHandlers(IItemCollection events) {\n-\t\thandlers = notifyAllHandlers(events, handlers, WebsocketServer::toEventsJsonString);\n-\t}\n-\n-\tprivate void notifyAllGraphHandlers(IItemCollection events) {\n-\t\tgraphHandlers = notifyAllHandlers(events, graphHandlers, WebsocketServer::toGraphModelDotString);\n-\t}\n-\n-\tprivate void notifyAllTreeHandlers(IItemCollection events) {\n-\t\ttreeHandlers = notifyAllHandlers(events, treeHandlers, WebsocketServer::toTreeModelJsonString);\n-\t}\n-\n-\tprivate static String toEventsJsonString(IItemCollection items) {\n-\t\tif (items == null) {\n-\t\t\treturn null;\n-\t\t}\n-\t\treturn IItemCollectionJsonSerializer.toJsonString(items);\n-\t}\n-\n-\tprivate static String toGraphModelDotString(IItemCollection items) {\n-\t\tif (items == null) {\n-\t\t\treturn null;\n-\t\t}\n-\t\tFrameSeparator frameSeparator = new FrameSeparator(FrameCategorization.METHOD, false);\n-\t\tStacktraceGraphModel model = new StacktraceGraphModel(frameSeparator, items, null);\n-\t\treturn DotSerializer.toDot(model, 10_000, new HashMap<>());\n-\t}\n-\n-\tprivate static String toTreeModelJsonString(IItemCollection items) {\n-\t\tif (items == null) {\n-\t\t\treturn null;\n-\t\t}\n-\t\tStacktraceTreeModel model = new StacktraceTreeModel(items);\n-\t\treturn FlameGraphJsonSerializer.toJson(model);\n-\t}\n-\n-\tprivate List<WebsocketConnectionHandler> notifyAllHandlers(\n-\t\tIItemCollection events, List<WebsocketConnectionHandler> handlers,\n-\t\tFunction<IItemCollection, String> jsonSerializer) {\n-\t\thandlers = handlers.stream().filter(h -> h.isConnected()).collect(Collectors.toList());\n-\t\tif (handlers.size() == 0 || events == null) {\n-\t\t\t\/\/ do nothing if no handlers are registered\n-\t\t\treturn handlers;\n-\t\t}\n-\t\tString json = jsonSerializer.apply(events);\n-\t\thandlers.forEach(handler -> handler.sendMessage(json));\n-\t\treturn handlers;\n-\t}\n-\n-\tpublic void shutdown() {\n-\t\ttry {\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO,\n-\t\t\t\t\t\"Stopping websocket server listening on port \" + port);\n-\t\t\tserver.stop();\n-\t\t\t\/\/ TODO: see if we need to cleanup executor service and thread\n-\t\t} catch (Exception e) {\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.SEVERE, \"Failed to stop websocket server\", e);\n-\t\t}\n-\t}\n-\n-\tprivate static class WebsocketConnectionHandler extends WebSocketAdapter {\n-\t\tprivate String firstMessage;\n-\n-\t\tWebsocketConnectionHandler(String firstMessage) {\n-\t\t\tthis.firstMessage = firstMessage;\n-\t\t}\n-\n-\t\tpublic void sendMessage(String message) {\n-\t\t\tif (getSession() != null && isConnected()) {\n-\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO,\n-\t\t\t\t\t\t\"Sending message to \" + getSession().getRemoteAddress().toString());\n-\t\t\t\ttry {\n-\t\t\t\t\tgetSession().getRemote().sendString(message);\n-\t\t\t\t} catch (IOException e) {\n-\t\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.SEVERE, \"Failed to send websocket message\", e);\n-\t\t\t\t}\n-\t\t\t}\n-\t\t}\n-\n-\t\t@Override\n-\t\tpublic void onWebSocketConnect(Session sess) {\n-\t\t\tsuper.onWebSocketConnect(sess);\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO,\n-\t\t\t\t\t\"Socket connected to \" + sess.getRemoteAddress().toString());\n-\t\t\ttry {\n-\t\t\t\tif (firstMessage != null) {\n-\t\t\t\t\tgetSession().getRemote().sendString(firstMessage);\n-\t\t\t\t\tfirstMessage = null;\n-\t\t\t\t}\n-\t\t\t} catch (IOException e) {\n-\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.SEVERE, \"Failed to show outline view\", e);\n-\t\t\t}\n-\t\t}\n-\n-\t\t@Override\n-\t\tpublic void onWebSocketText(String message) {\n-\t\t\tsuper.onWebSocketText(message);\n-\t\t}\n-\n-\t\t@Override\n-\t\tpublic void onWebSocketClose(int statusCode, String reason) {\n-\t\t\tsuper.onWebSocketClose(statusCode, reason);\n-\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO, \"Socket closed: [\" + statusCode + \"] \" + reason);\n-\t\t}\n-\n-\t\t@Override\n-\t\tpublic void onWebSocketError(Throwable cause) {\n-\t\t\tsuper.onWebSocketError(cause);\n-\t\t\tif (cause.getCause() instanceof TimeoutException) {\n-\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.INFO, \"Websocket timed out\");\n-\t\t\t} else {\n-\t\t\t\tFlightRecorderUI.getDefault().getLogger().log(Level.SEVERE, \"Websocket error\", cause);\n-\t\t\t}\n-\t\t}\n-\t}\n-}\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/ui\/websocket\/WebsocketServer.java","additions":0,"deletions":256,"binary":false,"changes":256,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n-#  Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -413,2 +413,0 @@\n-PREFERENCES_WEBSOCKET_SERVER_PORT_TEXT=Websocket server port (set to 0 to disable)\n-PREFERENCES_WEBSOCKET_SERVER_PORT_TOOLTIP=Start a websocket server bound to 127.0.0.1 and the selected port. The server pushes updates whenever the selection changes in the UI.\n@@ -425,1 +423,0 @@\n-PREFERENCES_WEBSOCKET_SERVER_PORT_INVALID=Websocket server port must be a number between 0 and 65535\n","filename":"application\/org.openjdk.jmc.flightrecorder.ui\/src\/main\/resources\/org\/openjdk\/jmc\/flightrecorder\/ui\/messages\/internal\/messages.properties","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -0,0 +1,25 @@\n+Manifest-Version: 1.0\n+Bundle-ManifestVersion: 2\n+Bundle-Name: %Bundle-Name\n+Bundle-SymbolicName: org.openjdk.jmc.ui.websocket;singleton:=true\n+Bundle-Version: 10.0.0.qualifier\n+Bundle-Localization: plugin\n+Automatic-Module-Name: org.openjdk.jmc.ui.websocket\n+Bundle-RequiredExecutionEnvironment: JavaSE-21\n+Require-Bundle: org.eclipse.core.runtime,\n+ org.eclipse.osgi,\n+ org.eclipse.ui,\n+ org.eclipse.jetty.ee9.server,\n+ org.eclipse.jetty.ee9.servlet,\n+ org.eclipse.jetty.ee9.websocket.api,\n+ org.eclipse.jetty.ee9.websocket.server,\n+ org.eclipse.jetty.server,\n+ org.eclipse.jetty.servlet-api,\n+ org.eclipse.jetty.util,\n+ org.openjdk.jmc.common,\n+ org.openjdk.jmc.flightrecorder.serializers,\n+ org.openjdk.jmc.flightrecorder\n+Export-Package:  org.openjdk.jmc.ui.websocket\n+Bundle-Activator: org.openjdk.jmc.ui.websocket.WebsocketPlugin\n+Bundle-ActivationPolicy: lazy\n+Import-Package: org.openjdk.jmc.ui\n","filename":"application\/org.openjdk.jmc.ui.websocket\/META-INF\/MANIFEST.MF","additions":25,"deletions":0,"binary":false,"changes":25,"status":"added"},{"patch":"@@ -2,1 +2,2 @@\n-#  Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2026 IBM Corporation. All rights reserved.\n@@ -6,1 +7,1 @@\n-#  The contents of this file are subject to the terms of either the Universal Permissive License \n+#  The contents of this file are subject to the terms of either the Universal Permissive License\n@@ -8,1 +9,1 @@\n-#   \n+# \n@@ -10,1 +11,1 @@\n-#   \n+#\n@@ -13,1 +14,1 @@\n-#   \n+#\n@@ -16,1 +17,1 @@\n-#   \n+#\n@@ -20,1 +21,1 @@\n-#   \n+#\n@@ -32,1 +33,0 @@\n-#\n@@ -40,1 +40,0 @@\n-pde.match.rule.bundle=compatible\n","filename":"application\/org.openjdk.jmc.ui.websocket\/build.properties","additions":8,"deletions":9,"binary":false,"changes":17,"previous_filename":"application\/org.openjdk.jmc.browser.jdp\/build.properties","status":"copied"},{"patch":"@@ -2,2 +2,2 @@\n-#  Copyright (c) 2021, 2025, Oracle and\/or its affiliates. All rights reserved.\n-#  Copyright (c) 2021, 2025, Datadog, Inc. All rights reserved.\n+#  Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2026 IBM Corporation. All rights reserved.\n@@ -34,1 +34,1 @@\n-HEATMAP_VIEW=Heatmap View\n+PAGE_NAME=Websocket Server\n","filename":"application\/org.openjdk.jmc.ui.websocket\/plugin.properties","additions":3,"deletions":3,"binary":false,"changes":6,"previous_filename":"application\/org.openjdk.jmc.flightrecorder.heatmap\/plugin.properties","status":"copied"},{"patch":"@@ -0,0 +1,52 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--   \n+   Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2026 IBM Corporation. All rights reserved.\n+\n+   DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+   The contents of this file are subject to the terms of either the Universal Permissive License\n+   v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+\n+   or the following license:\n+\n+   Redistribution and use in source and binary forms, with or without modification, are permitted\n+   provided that the following conditions are met:\n+\n+   1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+   and the following disclaimer.\n+\n+   2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+   conditions and the following disclaimer in the documentation and\/or other materials provided with\n+   the distribution.\n+\n+   3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+   endorse or promote products derived from this software without specific prior written permission.\n+\n+   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+   IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+   FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+   WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+   WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+-->\n+<?eclipse version=\"3.4\"?>\n+<plugin>\n+   <extension\n+         point=\"org.eclipse.ui.preferencePages\">\n+      <page\n+            category=\"org.openjdk.jmc.ui.preferences.MissionControlPage\"\n+            class=\"org.openjdk.jmc.ui.websocket.preferences.WebsocketPreferencePage\"\n+            id=\"org.openjdk.jmc.ui.websocket.preferences.WebsocketPreferencePage\"\n+            name=\"%PAGE_NAME\">\n+      <\/page>\n+   <\/extension>\n+   <extension\n+        point=\"org.eclipse.core.runtime.preferences\">\n+     <initializer\n+           class=\"org.openjdk.jmc.ui.websocket.preferences.PreferenceInitializer\">\n+     <\/initializer>\n+   <\/extension>\n+<\/plugin>\n","filename":"application\/org.openjdk.jmc.ui.websocket\/plugin.xml","additions":52,"deletions":0,"binary":false,"changes":52,"status":"added"},{"patch":"@@ -0,0 +1,49 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--   \n+   Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2026 IBM Corporation. All rights reserved.\n+\n+   DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+   The contents of this file are subject to the terms of either the Universal Permissive License\n+   v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+\n+   or the following license:\n+\n+   Redistribution and use in source and binary forms, with or without modification, are permitted\n+   provided that the following conditions are met:\n+\n+   1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+   and the following disclaimer.\n+\n+   2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+   conditions and the following disclaimer in the documentation and\/or other materials provided with\n+   the distribution.\n+\n+   3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+   endorse or promote products derived from this software without specific prior written permission.\n+\n+   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+   IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+   FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+   WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+   WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+-->\n+<project xmlns=\"http:\/\/maven.apache.org\/POM\/4.0.0\"\n+\txmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"\n+\txsi:schemaLocation=\"http:\/\/maven.apache.org\/POM\/4.0.0 http:\/\/maven.apache.org\/xsd\/maven-4.0.0.xsd\">\n+\t<modelVersion>4.0.0<\/modelVersion>\n+\t<parent>\n+\t\t<groupId>org.openjdk.jmc<\/groupId>\n+\t\t<artifactId>missioncontrol.application<\/artifactId>\n+\t\t<version>${revision}${changelist}<\/version>\n+\t<\/parent>\n+\t<artifactId>org.openjdk.jmc.ui.websocket<\/artifactId>\n+\t<packaging>eclipse-plugin<\/packaging>\n+\t<properties>\n+\t\t<jmc.config.path>${project.basedir}\/..\/..\/configuration<\/jmc.config.path>\n+\t<\/properties>\n+<\/project>\n","filename":"application\/org.openjdk.jmc.ui.websocket\/pom.xml","additions":49,"deletions":0,"binary":false,"changes":49,"status":"added"},{"patch":"@@ -0,0 +1,233 @@\n+\/*\n+ * Copyright (c) 2021, 2026, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2026, Datadog, Inc. All rights reserved.\n+ *\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket;\n+\n+import java.io.IOException;\n+import java.nio.channels.ClosedChannelException;\n+import java.time.Duration;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.concurrent.CopyOnWriteArrayList;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.TimeoutException;\n+import java.util.function.Function;\n+import java.util.logging.Level;\n+import java.util.stream.Collectors;\n+\n+import org.eclipse.jetty.ee9.servlet.ServletContextHandler;\n+import org.eclipse.jetty.ee9.websocket.api.Session;\n+import org.eclipse.jetty.ee9.websocket.api.WebSocketAdapter;\n+import org.eclipse.jetty.ee9.websocket.server.config.JettyWebSocketServletContainerInitializer;\n+import org.eclipse.jetty.server.Server;\n+import org.eclipse.jetty.server.ServerConnector;\n+import org.openjdk.jmc.common.item.IItemCollection;\n+import org.openjdk.jmc.flightrecorder.serializers.dot.DotSerializer;\n+import org.openjdk.jmc.flightrecorder.serializers.json.FlameGraphJsonSerializer;\n+import org.openjdk.jmc.flightrecorder.serializers.json.IItemCollectionJsonSerializer;\n+import org.openjdk.jmc.flightrecorder.stacktrace.FrameSeparator;\n+import org.openjdk.jmc.flightrecorder.stacktrace.FrameSeparator.FrameCategorization;\n+import org.openjdk.jmc.flightrecorder.stacktrace.graph.StacktraceGraphModel;\n+import org.openjdk.jmc.flightrecorder.stacktrace.tree.StacktraceTreeModel;\n+\n+public class MCWebsocketServer {\n+\tprivate Server server;\n+\tprivate List<WebsocketConnectionHandler> handlers = new CopyOnWriteArrayList<>();\n+\tprivate List<WebsocketConnectionHandler> treeHandlers = new CopyOnWriteArrayList<>();\n+\tprivate List<WebsocketConnectionHandler> graphHandlers = new CopyOnWriteArrayList<>();\n+\tprivate final ExecutorService executorService = Executors.newSingleThreadExecutor();\n+\tprivate IItemCollection currentSelection = null;\n+\n+\tpublic MCWebsocketServer(int port) {\n+\t\texecutorService.execute(() -> startServer(port));\n+\t}\n+\n+\tpublic void startServer(int port) {\n+\t\tserver = new Server();\n+\t\tServerConnector connector = new ServerConnector(server);\n+\t\tconnector.setHost(\"127.0.0.1\");\n+\t\tconnector.setPort(port);\n+\t\tserver.addConnector(connector);\n+\n+\t\tServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);\n+\t\tcontext.setContextPath(\"\/\");\n+\t\tserver.setHandler(context);\n+\n+\t\tJettyWebSocketServletContainerInitializer.configure(context, (servletContext, container) -> {\n+\t\t\tcontainer.setMaxBinaryMessageSize(Long.MAX_VALUE);\n+\t\t\tcontainer.setIdleTimeout(Duration.ofMinutes(Long.MAX_VALUE));\n+\t\t\tcontainer.addMapping(\"\/events\/*\", (req, resp) -> {\n+\t\t\t\tString eventsJson = MCWebsocketServer.toEventsJsonString(currentSelection);\n+\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(eventsJson);\n+\t\t\t\thandlers.add(handler);\n+\t\t\t\treturn handler;\n+\t\t\t});\n+\t\t\tcontainer.addMapping(\"\/tree\/*\", (req, resp) -> {\n+\t\t\t\tString treeJson = MCWebsocketServer.toTreeModelJsonString(currentSelection);\n+\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(treeJson);\n+\t\t\t\ttreeHandlers.add(handler);\n+\t\t\t\treturn handler;\n+\t\t\t});\n+\t\t\tcontainer.addMapping(\"\/graph\/*\", (req, resp) -> {\n+\t\t\t\tString dot = MCWebsocketServer.toGraphModelDotString(currentSelection);\n+\t\t\t\tWebsocketConnectionHandler handler = new WebsocketConnectionHandler(dot);\n+\t\t\t\tgraphHandlers.add(handler);\n+\t\t\t\treturn handler;\n+\t\t\t});\n+\t\t});\n+\n+\t\ttry {\n+\t\t\tserver.start();\n+\t\t} catch (Exception e) {\n+\t\t\tWebsocketPlugin.getLogger().log(Level.SEVERE, \"Failed to start websocket server\", e);\n+\t\t}\n+\t}\n+\n+\tpublic void notifyAll(IItemCollection events) {\n+\t\tcurrentSelection = events;\n+\t\tnotifyAllEventHandlers(events);\n+\t\tnotifyAllGraphHandlers(events);\n+\t\tnotifyAllTreeHandlers(events);\n+\t}\n+\n+\tprivate void notifyAllEventHandlers(IItemCollection events) {\n+\t\thandlers = notifyAllHandlers(events, handlers, MCWebsocketServer::toEventsJsonString);\n+\t}\n+\n+\tprivate void notifyAllGraphHandlers(IItemCollection events) {\n+\t\tgraphHandlers = notifyAllHandlers(events, graphHandlers, MCWebsocketServer::toGraphModelDotString);\n+\t}\n+\n+\tprivate void notifyAllTreeHandlers(IItemCollection events) {\n+\t\ttreeHandlers = notifyAllHandlers(events, treeHandlers, MCWebsocketServer::toTreeModelJsonString);\n+\t}\n+\n+\tprivate static String toEventsJsonString(IItemCollection items) {\n+\t\tif (items == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\treturn IItemCollectionJsonSerializer.toJsonString(items);\n+\t}\n+\n+\tprivate static String toGraphModelDotString(IItemCollection items) {\n+\t\tif (items == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tFrameSeparator frameSeparator = new FrameSeparator(FrameCategorization.METHOD, false);\n+\t\tStacktraceGraphModel model = new StacktraceGraphModel(frameSeparator, items, null);\n+\t\treturn DotSerializer.toDot(model, 10_000, new HashMap<>());\n+\t}\n+\n+\tprivate static String toTreeModelJsonString(IItemCollection items) {\n+\t\tif (items == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tStacktraceTreeModel model = new StacktraceTreeModel(items);\n+\t\treturn FlameGraphJsonSerializer.toJson(model);\n+\t}\n+\n+\tprivate List<WebsocketConnectionHandler> notifyAllHandlers(\n+\t\tIItemCollection events, List<WebsocketConnectionHandler> handlers,\n+\t\tFunction<IItemCollection, String> jsonSerializer) {\n+\t\thandlers = handlers.stream().filter(h -> h.isConnected()).collect(Collectors.toList());\n+\t\tif (handlers.size() == 0 || events == null) {\n+\t\t\t\/\/ do nothing if no handlers are registered\n+\t\t\treturn handlers;\n+\t\t}\n+\t\tString json = jsonSerializer.apply(events);\n+\t\thandlers.forEach(handler -> handler.sendMessage(json));\n+\t\treturn handlers;\n+\t}\n+\n+\tpublic void shutdown() throws Exception {\n+\t\tserver.stop();\n+\t}\n+\n+\tprivate static class WebsocketConnectionHandler extends WebSocketAdapter {\n+\t\tprivate String firstMessage;\n+\n+\t\tWebsocketConnectionHandler(String firstMessage) {\n+\t\t\tthis.firstMessage = firstMessage;\n+\t\t}\n+\n+\t\tpublic void sendMessage(String message) {\n+\t\t\tif (getSession() != null && isConnected()) {\n+\t\t\t\tWebsocketPlugin.getLogger().log(Level.INFO,\n+\t\t\t\t\t\t\"Sending message to \" + getSession().getRemoteAddress().toString());\n+\t\t\t\ttry {\n+\t\t\t\t\tgetSession().getRemote().sendString(message);\n+\t\t\t\t} catch (IOException e) {\n+\t\t\t\t\tWebsocketPlugin.getLogger().log(Level.SEVERE, \"Failed to send websocket message\", e);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onWebSocketConnect(Session sess) {\n+\t\t\tsuper.onWebSocketConnect(sess);\n+\t\t\tWebsocketPlugin.getLogger().log(Level.INFO, \"Socket connected to \" + sess.getRemoteAddress().toString());\n+\t\t\ttry {\n+\t\t\t\tif (firstMessage != null) {\n+\t\t\t\t\tgetSession().getRemote().sendString(firstMessage);\n+\t\t\t\t\tfirstMessage = null;\n+\t\t\t\t}\n+\t\t\t} catch (IOException e) {\n+\t\t\t\tWebsocketPlugin.getLogger().log(Level.SEVERE, \"Failed to show outline view\", e);\n+\t\t\t}\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onWebSocketText(String message) {\n+\t\t\tsuper.onWebSocketText(message);\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onWebSocketClose(int statusCode, String reason) {\n+\t\t\tsuper.onWebSocketClose(statusCode, reason);\n+\t\t\tWebsocketPlugin.getLogger().log(Level.INFO, \"Socket closed: [\" + statusCode + \"] \" + reason);\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onWebSocketError(Throwable cause) {\n+\t\t\tsuper.onWebSocketError(cause);\n+\t\t\tif (cause instanceof TimeoutException) {\n+\t\t\t\tWebsocketPlugin.getLogger().log(Level.INFO, \"Websocket timed out\");\n+\t\t\t} else if (cause instanceof ClosedChannelException) {\n+\t\t\t\tWebsocketPlugin.getLogger().log(Level.INFO, \"Websocket channel has closed\");\n+\t\t\t} else {\n+\t\t\t\tWebsocketPlugin.getLogger().log(Level.SEVERE, \"Websocket error\", cause);\n+\t\t\t}\n+\t\t}\n+\t}\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/MCWebsocketServer.java","additions":233,"deletions":0,"binary":false,"changes":233,"status":"added"},{"patch":"@@ -0,0 +1,134 @@\n+\/*\n+ * Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026 IBM Corporation. All rights reserved.\n+ *\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket;\n+\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import org.eclipse.jface.util.IPropertyChangeListener;\n+import org.eclipse.jface.util.PropertyChangeEvent;\n+import org.eclipse.ui.IStartup;\n+import org.eclipse.ui.plugin.AbstractUIPlugin;\n+import org.openjdk.jmc.common.item.IItemCollection;\n+import org.openjdk.jmc.ui.websocket.preferences.PreferenceConstants;\n+import org.osgi.framework.BundleContext;\n+\n+public class WebsocketPlugin extends AbstractUIPlugin implements IStartup {\n+\n+\tpublic final static String PLUGIN_ID = \"org.openjdk.jmc.ui.websocket\"; \/\/$NON-NLS-1$\n+\tprivate static final Logger LOGGER = Logger.getLogger(PLUGIN_ID);\n+\n+\tprivate static WebsocketPlugin plugin;\n+\tprivate MCWebsocketServer server;\n+\n+\tpublic WebsocketPlugin() {\n+\t}\n+\n+\tpublic static WebsocketPlugin getDefault() {\n+\t\treturn plugin;\n+\t}\n+\n+\tpublic static Logger getLogger() {\n+\t\treturn LOGGER;\n+\t}\n+\n+\tpublic void start(BundleContext bundleContext) throws Exception {\n+\t\tsuper.start(bundleContext);\n+\t\tthis.getPreferenceStore().addPropertyChangeListener(preferenceChangeListener);\n+\t\tplugin = this;\n+\t\tstartServer(getCryostatPort());\n+\t\tLOGGER.log(Level.INFO, \"JMC Websocket Server is live!\");\n+\t}\n+\n+\tpublic void stop(BundleContext bundleContext) throws Exception {\n+\t\tif (server != null) {\n+\t\t\tserver.shutdown();\n+\t\t\tserver = null;\n+\t\t}\n+\t\tplugin = null;\n+\t\tsuper.stop(bundleContext);\n+\t}\n+\n+\tpublic void notifyAll(IItemCollection events) {\n+\t\tif (server != null) {\n+\t\t\tserver.notifyAll(events);\n+\t\t}\n+\t}\n+\n+\tprivate void startServer(int port) {\n+\t\tif (getServerEnabled()) {\n+\t\t\tserver = new MCWebsocketServer(port);\n+\t\t}\n+\t}\n+\n+\tprivate void stopServer() {\n+\t\tif (server != null) {\n+\t\t\ttry {\n+\t\t\t\tserver.shutdown();\n+\t\t\t} catch (Exception e) {\n+\t\t\t\tLOGGER.log(Level.WARNING, \"Error shutting down the Jetty WebSocket server\", e);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate IPropertyChangeListener preferenceChangeListener = new IPropertyChangeListener() {\n+\t\t@Override\n+\t\tpublic void propertyChange(PropertyChangeEvent event) {\n+\t\t\tif (event.getProperty().equals(PreferenceConstants.P_SERVER_ENABLED)) {\n+\t\t\t\tif (getServerEnabled()) {\n+\t\t\t\t\tstartServer(getCryostatPort());\n+\t\t\t\t} else {\n+\t\t\t\t\tstopServer();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\tif (event.getProperty().equals(PreferenceConstants.P_SERVER_PORT) && getServerEnabled()) {\n+\t\t\t\tstopServer();\n+\t\t\t\tstartServer(getCryostatPort());\n+\t\t\t}\n+\t\t}\n+\t};\n+\n+\tprivate int getCryostatPort() {\n+\t\treturn this.getPreferenceStore().getInt(PreferenceConstants.P_SERVER_PORT);\n+\t}\n+\n+\tpublic boolean getServerEnabled() {\n+\t\treturn this.getPreferenceStore().getBoolean(PreferenceConstants.P_SERVER_ENABLED);\n+\t}\n+\n+\t@Override\n+\tpublic void earlyStartup() {\n+\t\t\/\/ do nothing, we're only implementing IStartup to force a load of the plugin\n+\t}\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/WebsocketPlugin.java","additions":134,"deletions":0,"binary":false,"changes":134,"status":"added"},{"patch":"@@ -0,0 +1,51 @@\n+\/*\n+ * Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026 IBM Corporation. All rights reserved.\n+ *\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket.preferences;\n+\n+import org.eclipse.osgi.util.NLS;\n+\n+public class Messages extends NLS {\n+\tprivate static final String BUNDLE_NAME = \"org.openjdk.jmc.ui.websocket.preferences.messages\"; \/\/$NON-NLS-1$\n+\n+\tpublic static String WebsocketPreferencePage_DESCRIPTION;\n+\tpublic static String WebsocketPreferencePage_ENABLE;\n+\tpublic static String WebsocketPreferencePage_PORT;\n+\n+\tstatic {\n+\t\tNLS.initializeMessages(BUNDLE_NAME, Messages.class);\n+\t}\n+\n+\tprivate Messages() {\n+\t}\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/preferences\/Messages.java","additions":51,"deletions":0,"binary":false,"changes":51,"status":"added"},{"patch":"@@ -0,0 +1,41 @@\n+\/*\n+ * Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026 IBM Corporation. All rights reserved.\n+ * \n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket.preferences;\n+\n+public class PreferenceConstants {\n+\tpublic static final String P_SERVER_ENABLED = \"websocket.server.enabled\";\n+\tpublic static final String P_SERVER_PORT = \"websocket.server.port\";\n+\tpublic static final boolean DEFAULT_ENABLED = false;\n+\tpublic static final int DEFAULT_PORT = 8029;\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/preferences\/PreferenceConstants.java","additions":41,"deletions":0,"binary":false,"changes":41,"status":"added"},{"patch":"@@ -0,0 +1,47 @@\n+\/*\n+ * Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026 IBM Corporation. All rights reserved.\n+ * \n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket.preferences;\n+\n+import org.openjdk.jmc.ui.websocket.WebsocketPlugin;\n+import org.eclipse.core.runtime.preferences.AbstractPreferenceInitializer;\n+import org.eclipse.jface.preference.IPreferenceStore;\n+\n+public class PreferenceInitializer extends AbstractPreferenceInitializer {\n+\t@Override\n+\tpublic void initializeDefaultPreferences() {\n+\t\tIPreferenceStore store = WebsocketPlugin.getDefault().getPreferenceStore();\n+\t\tstore.setDefault(PreferenceConstants.P_SERVER_PORT, PreferenceConstants.DEFAULT_PORT);\n+\t\tstore.setDefault(PreferenceConstants.P_SERVER_ENABLED, PreferenceConstants.DEFAULT_ENABLED);\n+\t}\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/preferences\/PreferenceInitializer.java","additions":47,"deletions":0,"binary":false,"changes":47,"status":"added"},{"patch":"@@ -0,0 +1,86 @@\n+\/*\n+ * Copyright (c) 2026 Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2026 IBM Corporation. All rights reserved.\n+ *\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at https:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ *\n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.websocket.preferences;\n+\n+import org.openjdk.jmc.ui.websocket.WebsocketPlugin;\n+import org.eclipse.jface.preference.BooleanFieldEditor;\n+import org.eclipse.jface.preference.FieldEditor;\n+import org.eclipse.jface.preference.FieldEditorPreferencePage;\n+import org.eclipse.jface.preference.IntegerFieldEditor;\n+import org.eclipse.jface.util.PropertyChangeEvent;\n+import org.eclipse.ui.IWorkbench;\n+import org.eclipse.ui.IWorkbenchPreferencePage;\n+\n+public class WebsocketPreferencePage extends FieldEditorPreferencePage implements IWorkbenchPreferencePage {\n+\n+\tprivate IntegerFieldEditor portField;\n+\n+\tpublic WebsocketPreferencePage() {\n+\t\tsuper(GRID);\n+\t\tsetPreferenceStore(WebsocketPlugin.getDefault().getPreferenceStore());\n+\t\tsetDescription(Messages.WebsocketPreferencePage_DESCRIPTION);\n+\t}\n+\n+\t@Override\n+\tpublic void init(IWorkbench workbench) {\n+\t}\n+\n+\t@Override\n+\tprotected void createFieldEditors() {\n+\t\taddField(new BooleanFieldEditor(PreferenceConstants.P_SERVER_ENABLED, Messages.WebsocketPreferencePage_ENABLE,\n+\t\t\t\tgetFieldEditorParent()));\n+\t\tportField = new IntegerFieldEditor(PreferenceConstants.P_SERVER_PORT, Messages.WebsocketPreferencePage_PORT,\n+\t\t\t\tgetFieldEditorParent());\n+\t\taddField(portField);\n+\t\tenableWebsocketFields(isWebsocketPluginEnabled());\n+\t}\n+\n+\t@Override\n+\tpublic void propertyChange(PropertyChangeEvent event) {\n+\t\tif (event.getProperty().equals(FieldEditor.VALUE)) {\n+\t\t\tFieldEditor editor = (FieldEditor) event.getSource();\n+\t\t\tif (PreferenceConstants.P_SERVER_ENABLED.equals(editor.getPreferenceName())) {\n+\t\t\t\tenableWebsocketFields((boolean) event.getNewValue());\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate boolean isWebsocketPluginEnabled() {\n+\t\treturn WebsocketPlugin.getDefault().getPreferenceStore().getBoolean(PreferenceConstants.P_SERVER_ENABLED);\n+\t}\n+\n+\tprivate void enableWebsocketFields(boolean enable) {\n+\t\tportField.setEnabled(enable, getFieldEditorParent());\n+\t}\n+}\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/java\/org\/openjdk\/jmc\/ui\/websocket\/preferences\/WebsocketPreferencePage.java","additions":86,"deletions":0,"binary":false,"changes":86,"status":"added"},{"patch":"@@ -0,0 +1,3 @@\n+WebsocketPreferencePage_DESCRIPTION=Settings for the JMC Websocket Server\n+WebsocketPreferencePage_ENABLE=Enable\n+WebsocketPreferencePage_PORT=WebSocket Port for JFR transfer:\n","filename":"application\/org.openjdk.jmc.ui.websocket\/src\/main\/resources\/org\/openjdk\/jmc\/ui\/websocket\/preferences\/messages.properties","additions":3,"deletions":0,"binary":false,"changes":3,"status":"added"},{"patch":"@@ -3,1 +3,1 @@\n-   Copyright (c) 2018, 2025, Oracle and\/or its affiliates. All rights reserved.\n+   Copyright (c) 2018, 2026, Oracle and\/or its affiliates. All rights reserved.\n@@ -112,0 +112,1 @@\n+\t\t<module>org.openjdk.jmc.ui.websocket<\/module>\n","filename":"application\/pom.xml","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -175,0 +175,2 @@\n+\t\t\t<!-- getLogger() -->\n+\t\t\t <Class name=\"org.openjdk.jmc.ui.websocket.WebsocketPlugin\"\/>\n","filename":"configuration\/spotbugs\/spotbugs-exclude.xml","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}