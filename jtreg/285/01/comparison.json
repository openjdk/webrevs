{"files":[{"patch":"@@ -36,0 +36,1 @@\n+import java.util.HashSet;\n@@ -174,0 +175,4 @@\n+    public final Set<String> getDisallowedActions(File file) {\n+        return getEntry(file).disallowedActions;\n+    }\n+\n@@ -234,0 +239,1 @@\n+            final Set<String> disallowedActions;\n@@ -295,0 +301,3 @@\n+\n+                    \/\/ test actions that aren't allowed in the test definition\n+                    disallowedActions = initDisallowedActions(parent);\n@@ -315,0 +324,1 @@\n+                    this.disallowedActions = parent.disallowedActions;\n@@ -405,0 +415,17 @@\n+            private Set<String> initDisallowedActions(Entry parent) {\n+                String val = properties.getProperty(\"disallowedActions\");\n+                if (val != null) {\n+                    Set<String> disallowed = new HashSet<>();\n+                    \/\/ comma separated values\n+                    String[] actions = val.split(\",\");\n+                    for (String s : actions) {\n+                        if (s.isBlank()) {\n+                            continue;\n+                        }\n+                        disallowed.add(s.trim());\n+                    }\n+                    return Collections.unmodifiableSet(disallowed);\n+                }\n+                return parent == null ? Set.of() : parent.disallowedActions;\n+            }\n+\n","filename":"src\/share\/classes\/com\/sun\/javatest\/regtest\/config\/TestProperties.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -403,0 +403,2 @@\n+        File testDefinitionFile = getTestDescription().getFile();\n+        Set<String> disallowedActions = properties.getDisallowedActions(testDefinitionFile);\n@@ -427,0 +429,6 @@\n+                if (disallowedActions.contains(verb)) {\n+                    if (stopOnError) {\n+                        throw new ParseActionsException(\"Disallowed test action: \" + verb);\n+                    }\n+                    continue;\n+                }\n","filename":"src\/share\/classes\/com\/sun\/javatest\/regtest\/exec\/RegressionScript.java","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -0,0 +1,31 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @comment not expected to be run because \"applet\" action is configured\n+ *          as \"disallowedActions\"\n+ * @run applet NonExistent.html\n+ *\/\n+public class AppletTest {\n+}\n","filename":"test\/disallowedActions\/AppletTest.java","additions":31,"deletions":0,"binary":false,"changes":31,"status":"added"},{"patch":"@@ -0,0 +1,46 @@\n+#\n+# Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+$(BUILDTESTDIR)\/DisallowedActions.ok: \\\n+                $(JTREG_IMAGEDIR)\/lib\/javatest.jar \\\n+\t\t$(JTREG_IMAGEDIR)\/lib\/jtreg.jar \\\n+\t\t$(JTREG_IMAGEDIR)\/bin\/jtreg\n+\n+\t$(RM) $(@:%.ok=%)\n+\t$(MKDIR) $(@:%.ok=%)\n+\n+\t$(JTREG_IMAGEDIR)\/bin\/jtreg $(JTREG_OPTS) \\\n+\t\t-jdk:$(JDKHOME) \\\n+\t\t-w $(@:%.ok=%)\/work\/ \\\n+\t\t-r $(@:%.ok=%)\/report\/ \\\n+\t\t$(TESTDIR)\/disallowedActions\/ > $(@:%.ok=%\/jt.log) 2>&1 || \\\n+\t\t\ttrue \"non-zero exit code from jtreg intentionally ignored\"\n+\n+\t$(GREP) 'Disallowed test action: shell' $(@:%.ok=%)\/work\/ShellTest.jtr > \/dev\/null\n+\t$(GREP) 'Disallowed test action: applet' $(@:%.ok=%)\/work\/AppletTest.jtr > \/dev\/null\n+\t$(GREP) 'MainTest executed' $(@:%.ok=%)\/work\/MainTest.jtr > \/dev\/null\n+\n+\techo \"$@ test passed at `date`\" > $@\n+\n+\n+TESTS.jtreg += $(BUILDTESTDIR)\/DisallowedActions.ok\n","filename":"test\/disallowedActions\/DisallowedActions.gmk","additions":46,"deletions":0,"binary":false,"changes":46,"status":"added"},{"patch":"@@ -0,0 +1,31 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ *\/\n+public class MainTest {\n+    public static void main(final String[] args) throws Exception {\n+        System.out.println(\"MainTest executed\");\n+    }\n+}\n","filename":"test\/disallowedActions\/MainTest.java","additions":31,"deletions":0,"binary":false,"changes":31,"status":"added"},{"patch":"@@ -0,0 +1,31 @@\n+\/*\n+ * Copyright (c) 2025, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @comment not expected to be run because \"shell\" action is configured\n+ *          as \"disallowedActions\"\n+ * @run shell non-existent-script.sh\n+ *\/\n+public class ShellTest {\n+}\n","filename":"test\/disallowedActions\/ShellTest.java","additions":31,"deletions":0,"binary":false,"changes":31,"status":"added"},{"patch":"@@ -23,0 +23,2 @@\n+\n+disallowedActions=shell,applet\n","filename":"test\/disallowedActions\/TEST.ROOT","additions":2,"deletions":0,"binary":false,"changes":2,"previous_filename":"test\/libs-build-implicit\/TEST.ROOT","status":"copied"}]}