{"files":[{"patch":"@@ -81,1 +81,1 @@\n-        System.out.println(\"headless:  \" + isHeadless);\n+        System.out.println(\"headless:  \" + isHeadless);  \/\/ note: used by ReportOnlyTest.gmk\n","filename":"test\/basic\/Basic.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,8 +28,0 @@\n-ifdef HEADLESS\n-REPORT_EXPECT_PASS = 91\n-REPORT_EXPECT_FAIL = 40\n-else\n-REPORT_EXPECT_PASS = 93\n-REPORT_EXPECT_FAIL = 44\n-endif\n-\n@@ -37,0 +29,9 @@\n+#\n+# This test is a followup to Basic.othervm, and depends on the output from\n+# test for its data. Basic.othervm adapts its behavior depending on whether\n+# it is running in a headless environment, as determined by\n+# java.awt.GraphicsEnvironment.isHeadless(). (See Basic.java, line 59)\n+# This value is reported in the log that is written by Basic.java.\n+# Because this test is a report of the tests executed in Basic.othervm,\n+# we check that setting and adapt the behavior here accordingly.\n+#\n@@ -49,1 +50,8 @@\n-\t$(GREP) -s 'Test results: passed: $(REPORT_EXPECT_PASS); failed: $(REPORT_EXPECT_FAIL); error: 88' $(@:%.ok=%.jt.log)  > \/dev\/null\n+\tif grep \"headless: true\" $(BUILDTESTDIR)\/Basic.othervm\/log > \/dev\/null ; then \\\n+\t    REPORT_EXPECT_PASS=91 ; \\\n+\t    REPORT_EXPECT_FAIL=40 ; \\\n+\telse \\\n+\t    REPORT_EXPECT_PASS=93 ; \\\n+\t    REPORT_EXPECT_FAIL=44 ; \\\n+\tfi ; \\\n+\t$(GREP) -s \"Test results: passed: $${REPORT_EXPECT_PASS}; failed: $${REPORT_EXPECT_FAIL}; error: 88\" $(@:%.ok=%.jt.log)  > \/dev\/null\n","filename":"test\/basic\/ReportOnlyTest.gmk","additions":17,"deletions":9,"binary":false,"changes":26,"status":"modified"}]}