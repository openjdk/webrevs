{"files":[{"patch":"@@ -90,0 +90,6 @@\n+    \/\/ represents a timeout that occurred while executing\n+    \/\/ a test action within an agentvm\n+    static final class ActionTimeout extends Exception {\n+        private static final long serialVersionUID = 7956108605006221253L;\n+    }\n+\n@@ -312,1 +318,1 @@\n-                throws Fault {\n+                throws ActionTimeout, Fault {\n@@ -345,1 +351,1 @@\n-                throws Fault {\n+                throws ActionTimeout, Fault {\n@@ -385,1 +391,1 @@\n-                throws Fault {\n+                throws ActionTimeout, Fault {\n@@ -420,2 +426,1 @@\n-                throw new Fault(new Exception(\"Agent \" + id + \" timed out with a timeout of \"\n-                        + timeout + \" seconds\"));\n+                throw new ActionTimeout();\n","filename":"src\/share\/classes\/com\/sun\/javatest\/regtest\/exec\/Agent.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -724,0 +724,4 @@\n+        } catch (Agent.ActionTimeout te) {\n+            final String msg = \"\\\"\" + getName() + \"\\\" action timed out with a timeout of \"\n+                    + timeout + \" seconds on agent \" + agent.id;\n+            status = error(msg);\n","filename":"src\/share\/classes\/com\/sun\/javatest\/regtest\/exec\/CompileAction.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2024, Oracle and\/or its affiliates. All rights reserved.\n@@ -718,0 +718,4 @@\n+        } catch (Agent.ActionTimeout e) {\n+            final String msg = \"\\\"\" + getName() + \"\\\" action timed out with a timeout of \"\n+                    + timeout + \" seconds on agent \" + agent.id;\n+            status = error(msg);\n","filename":"src\/share\/classes\/com\/sun\/javatest\/regtest\/exec\/MainAction.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -0,0 +1,59 @@\n+#\n+# Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.  Oracle designates this\n+# particular file as subject to the \"Classpath\" exception as provided\n+# by Oracle in the LICENSE file that accompanied this code.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+# verify that a test that times out in agentvm mode will have the expected\n+# timeout message in its jtr file\n+\n+# verify timeout message for main action\n+$(BUILDTESTDIR)\/AgentVMMainActionTimeout.ok: \\\n+\t$(JTREG_IMAGEDIR)\/lib\/javatest.jar \\\n+\t$(JTREG_IMAGEDIR)\/lib\/jtreg.jar\n+\t$(RM) $(@:%.ok=%) ; $(MKDIR) $(@:%.ok=%)\n+\t$(JDKHOME)\/bin\/java -jar $(JTREG_IMAGEDIR)\/lib\/jtreg.jar \\\n+\t\t-w $(@:%.ok=%)\/work\/ -r $(@:%.ok=%)\/report\/ \\\n+\t\t-agentvm \\\n+\t\t$(TESTDIR)\/agentvmtimeout\/OneSecondTimeoutTest.java#main > $(@:%.ok=%\/jt.log) 2>&1 ; ls $(@:%.ok=%)\/work ; \\\n+\t\t$(GREP) '\"main\" action timed out with a timeout of' $(@:%.ok=%)\/work\/OneSecondTimeoutTest_main.jtr > \/dev\/null ; found=$$?; \\\n+        if [ \"$$found\" != 0 ]; then echo \"OneSecondTimeoutTest_main.jtr is missing \\\"main\\\" action timeout message\" ; exit 1 ; fi\n+\techo $@ passed at `date` > $@\n+\n+# verify timeout message for driver action\n+$(BUILDTESTDIR)\/AgentVMDriverActionTimeout.ok: \\\n+\t$(JTREG_IMAGEDIR)\/lib\/javatest.jar \\\n+\t$(JTREG_IMAGEDIR)\/lib\/jtreg.jar\n+\t$(RM) $(@:%.ok=%) ; $(MKDIR) $(@:%.ok=%)\n+\t$(JDKHOME)\/bin\/java -jar $(JTREG_IMAGEDIR)\/lib\/jtreg.jar \\\n+\t\t-w $(@:%.ok=%)\/work\/ -r $(@:%.ok=%)\/report\/ \\\n+\t\t-agentvm \\\n+\t\t$(TESTDIR)\/agentvmtimeout\/OneSecondTimeoutTest.java#driver > $(@:%.ok=%\/jt.log) 2>&1 ; ls $(@:%.ok=%)\/work ; \\\n+\t\t$(GREP) '\"driver\" action timed out with a timeout of' $(@:%.ok=%)\/work\/OneSecondTimeoutTest_driver.jtr > \/dev\/null ; found=$$?; \\\n+        if [ \"$$found\" != 0 ]; then echo \"OneSecondTimeoutTest_driver.jtr is missing \\\"driver\\\" action timeout message\" ; exit 1 ; fi;\n+\techo $@ passed at `date` > $@\n+\n+$(BUILDTESTDIR)\/AgentVMActionTimeout.ok: \\\n+\t\t\t\t$(BUILDTESTDIR)\/AgentVMMainActionTimeout.ok \\\n+\t\t\t\t$(BUILDTESTDIR)\/AgentVMDriverActionTimeout.ok\n+\n+TESTS.jtreg += $(BUILDTESTDIR)\/AgentVMActionTimeout.ok\n","filename":"test\/agentvmtimeout\/AgentVMTimeout.gmk","additions":59,"deletions":0,"binary":false,"changes":59,"status":"added"},{"patch":"@@ -0,0 +1,41 @@\n+\/*\n+ * Copyright (c) 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test id=main\n+ * @run main\/timeout=1 OneSecondTimeoutTest\n+ *\/\n+\n+\/*\n+ * @test id=driver\n+ * @run driver\/timeout=1 OneSecondTimeoutTest\n+ *\/\n+public class OneSecondTimeoutTest {\n+\n+    public static void main(final String[] args) throws Exception {\n+        final Object obj = new Object();\n+        synchronized (obj) {\n+            obj.wait(); \/\/ wait forever so that the test times out\n+        }\n+    }\n+}\n","filename":"test\/agentvmtimeout\/OneSecondTimeoutTest.java","additions":41,"deletions":0,"binary":false,"changes":41,"status":"added"},{"patch":"","filename":"test\/agentvmtimeout\/TEST.ROOT","additions":0,"deletions":0,"binary":false,"changes":0,"previous_filename":"test\/4499340\/test\/TEST.ROOT","status":"copied"}]}