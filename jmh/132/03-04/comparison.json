{"files":[{"patch":"@@ -56,7 +56,6 @@\n-        for (String ev : requestedEventNames) {\n-            String reportCmd = String.format(\"perf report -i perf-record-validate.data --stdio | grep %s | wc -l\", ev);\n-            String[] tunnelCmd = { \"\/bin\/sh\", \"-c\", reportCmd };\n-            Collection<String> output = Utils.runWith(tunnelCmd);\n-            if (output.isEmpty()) {\n-                throw new ProfilerException(\"No events recorded for \" + ev);\n-            }\n+        String reportCmd = String.format(\"perf report -i perf-record-validate.data --stdio | grep -E '%s' | wc -l\", Utils.join(requestedEventNames, \"|\"));\n+        String[] tunnelCmd = { \"\/bin\/sh\", \"-c\", reportCmd };\n+        Collection<String> output = Utils.runWith(tunnelCmd);\n+        if (output.isEmpty()) {\n+            throw new ProfilerException(\"No events recorded for \" + requestedEventNames);\n+        }\n@@ -64,7 +63,4 @@\n-            try {\n-                final int count = Integer.parseInt(output.iterator().next().trim());\n-                if (count == 0) {\n-                    throw new ProfilerException(\"Unsupported event: \" + ev);\n-                }\n-            } catch (NumberFormatException e) {\n-                throw new ProfilerException(\"Perf event count not a number for event \" + ev + \": \" + output);\n+        try {\n+            final int count = Integer.parseInt(output.iterator().next().trim());\n+            if (count != requestedEventNames.size()) {\n+                throw new ProfilerException(\"One or several events unsupported: \" + requestedEventNames);\n@@ -72,0 +68,2 @@\n+        } catch (NumberFormatException e) {\n+            throw new ProfilerException(\"Perf event count not a number for one of events \" + requestedEventNames + \": \" + output);\n","filename":"jmh-core\/src\/main\/java\/org\/openjdk\/jmh\/profile\/LinuxPerfAsmProfiler.java","additions":12,"deletions":14,"binary":false,"changes":26,"status":"modified"}]}