{"files":[{"patch":"@@ -56,4 +56,15 @@\n-        Collection<String> passMsg = Utils.runWith(senseCmd);\n-        for (String m : passMsg) {\n-            if (m.contains(\"[ perf record: Captured and wrote 0.000 MB (null) ]\")) {\n-                throw new ProfilerException(\"Unsupported events: \" + requestedEventNames);\n+        for (String ev : requestedEventNames) {\n+            String reportCmd = String.format(\"perf report -i perf-record-validate.data --stdio | grep %s | wc -l\", ev);\n+            String[] tunnelCmd = { \"\/bin\/sh\", \"-c\", reportCmd };\n+            Collection<String> output = Utils.runWith(tunnelCmd);\n+            if (output.isEmpty()) {\n+                throw new ProfilerException(\"No events recorded for \" + ev);\n+            }\n+\n+            try {\n+                final int count = Integer.parseInt(output.iterator().next().trim());\n+                if (count == 0) {\n+                    throw new ProfilerException(\"Unsupported event: \" + ev);\n+                }\n+            } catch (NumberFormatException e) {\n+                throw new ProfilerException(\"Perf event count not a number for event \" + ev + \": \" + output);\n","filename":"jmh-core\/src\/main\/java\/org\/openjdk\/jmh\/profile\/LinuxPerfAsmProfiler.java","additions":15,"deletions":4,"binary":false,"changes":19,"status":"modified"}]}