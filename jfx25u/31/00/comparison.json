{"files":[{"patch":"@@ -53,0 +53,1 @@\n+    public static final String defaultPipeline;\n@@ -203,1 +204,0 @@\n-        String order = systemProperties.getProperty(\"prism.order\");\n@@ -205,0 +205,17 @@\n+        if (PlatformUtil.isWindows()) {\n+            tryOrderArr = new String[] { \"d3d\", \"sw\" };\n+        } else if (PlatformUtil.isMac()) {\n+            tryOrderArr = new String[] { \"es2\", \"mtl\", \"sw\" };\n+        } else if (PlatformUtil.isIOS()) {\n+            tryOrderArr = new String[] { \"es2\" };\n+        } else if (PlatformUtil.isAndroid()) {\n+                tryOrderArr = new String[] { \"es2\" };\n+        } else if (PlatformUtil.isLinux()) {\n+            tryOrderArr = new String[] { \"es2\", \"sw\" };\n+        } else {\n+            tryOrderArr = new String[] { \"sw\" };\n+        }\n+\n+        defaultPipeline = tryOrderArr[0];\n+\n+        String order = systemProperties.getProperty(\"prism.order\");\n@@ -207,14 +224,0 @@\n-        } else {\n-            if (PlatformUtil.isWindows()) {\n-                tryOrderArr = new String[] { \"d3d\", \"sw\" };\n-            } else if (PlatformUtil.isMac()) {\n-                tryOrderArr = new String[] { \"es2\", \"mtl\", \"sw\" };\n-            } else if (PlatformUtil.isIOS()) {\n-                tryOrderArr = new String[] { \"es2\" };\n-            } else if (PlatformUtil.isAndroid()) {\n-                    tryOrderArr = new String[] { \"es2\" };\n-            } else if (PlatformUtil.isLinux()) {\n-                tryOrderArr = new String[] { \"es2\", \"sw\" };\n-            } else {\n-                tryOrderArr = new String[] { \"sw\" };\n-            }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/impl\/PrismSettings.java","additions":18,"deletions":15,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2024, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2025, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,2 @@\n+import com.sun.prism.impl.PrismSettings;\n+import com.sun.javafx.PlatformUtil;\n@@ -33,1 +35,0 @@\n-import java.util.List;\n@@ -35,0 +36,2 @@\n+import java.util.List;\n+import java.util.Map;\n@@ -43,0 +46,2 @@\n+        Map<String, Boolean> devDetails = new HashMap<>();\n+        setDeviceDetails(devDetails);\n@@ -72,0 +77,8 @@\n+            if (PlatformUtil.isMac()) {\n+                Map<String, Boolean> devDetails = getDeviceDetails();\n+                if (PrismSettings.defaultPipeline.equals(\"es2\")) {\n+                    devDetails.put(\"useMTLInGlassForSW\", false);\n+                } else {\n+                    devDetails.put(\"useMTLInGlassForSW\", true);\n+                }\n+            }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/prism\/sw\/SWPipeline.java","additions":15,"deletions":2,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -39,1 +39,2 @@\n-        withIsSwPipe:(BOOL)isSwPipe;\n+        withIsSwPipe:(BOOL)isSwPipe\n+         useMTLForSW:(BOOL)mtlForSW;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassLayer.h","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -48,0 +48,1 @@\n+         useMTLForSW:(BOOL)mtlForSW\n@@ -53,1 +54,2 @@\n-        if (mtlCommandQueuePtr != 0l) { \/\/ MTL\n+        if (mtlCommandQueuePtr != 0l || mtlForSW) { \/\/ MTL\n+            LOG(\"GlassLayer initGlassLayer using MTLLayer\");\n@@ -60,0 +62,1 @@\n+            LOG(\"GlassLayer initGlassLayer using CGLLayer\");\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassLayer.m","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -113,0 +113,1 @@\n+    BOOL mtlForSW = NO;\n@@ -124,0 +125,8 @@\n+        jobject mtlForSWKey = (*env)->NewStringUTF(env, \"useMTLInGlassForSW\");\n+        jobject mtlForSWValue = (*env)->CallObjectMethod(env, jproperties, jMapGetMethod, mtlForSWKey);\n+        GLASS_CHECK_EXCEPTION(env);\n+        if (mtlForSWValue != NULL)\n+        {\n+            mtlForSW = (*env)->CallBooleanMethod(env, mtlForSWValue, jBooleanValueMethod) ? YES : NO;\n+            GLASS_CHECK_EXCEPTION(env);\n+        }\n@@ -128,1 +137,2 @@\n-        if (mtlCommandQueuePtr != 0l) {\n+        if (mtlCommandQueuePtr != 0l || mtlForSW) {\n+            LOG(\"GlassView3D initWithFrame using MTLView\");\n@@ -130,1 +140,1 @@\n-            subView = mtlSubView = [[GlassViewMTL alloc] initWithFrame:frame withJview:jView withJproperties:jproperties];\n+            subView = mtlSubView = [[GlassViewMTL alloc] initWithFrame:frame withJview:jView withJproperties:jproperties useMTLForSW:mtlForSW];\n@@ -134,0 +144,1 @@\n+            LOG(\"GlassView3D initWithFrame using CGLView\");\n@@ -135,1 +146,1 @@\n-            subView = cglSubView = [[GlassViewCGL alloc] initWithFrame:frame withJview:jView withJproperties:jproperties];\n+            subView = cglSubView = [[GlassViewCGL alloc] initWithFrame:frame withJview:jView withJproperties:jproperties useMTLForSW:mtlForSW];\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassView3D.m","additions":14,"deletions":3,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -49,1 +49,2 @@\n-    withJproperties:(jobject)jproperties;\n+    withJproperties:(jobject)jproperties\n+        useMTLForSW:(BOOL)mtlForSW;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassViewCGL.h","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -91,0 +91,1 @@\n+                         useMTLForSW:(BOOL)mtlForSW\n@@ -176,1 +177,2 @@\n-                                        withIsSwPipe:isSwPipe];\n+                                        withIsSwPipe:isSwPipe\n+                                         useMTLForSW:mtlForSW];\n@@ -186,0 +188,1 @@\n+        useMTLForSW:(BOOL)mtlForSW;\n@@ -203,1 +206,2 @@\n-        [self _initialize3dWithJproperties:jproperties];\n+        [self _initialize3dWithJproperties:jproperties\n+                               useMTLForSW:(BOOL)mtlForSW];\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassViewCGL.m","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -38,1 +38,2 @@\n-    withJproperties:(jobject)jproperties;\n+    withJproperties:(jobject)jproperties\n+        useMTLForSW:(BOOL)mtlForSW;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassViewMTL.h","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+                         useMTLForSW:(BOOL)mtlForSW\n@@ -88,2 +89,5 @@\n-        andClientContext:nil mtlQueuePtr:mtlCommandQueuePtr\n-        withHiDPIAware:YES withIsSwPipe:isSwPipe];\n+                                    andClientContext:nil\n+                                         mtlQueuePtr:mtlCommandQueuePtr\n+                                      withHiDPIAware:YES\n+                                        withIsSwPipe:isSwPipe\n+                                         useMTLForSW:mtlForSW];\n@@ -105,1 +109,1 @@\n-- (id)initWithFrame:(NSRect)frame withJview:(jobject)jView withJproperties:(jobject)jproperties\n+- (id)initWithFrame:(NSRect)frame withJview:(jobject)jView withJproperties:(jobject)jproperties useMTLForSW:(BOOL)mtlForSW\n@@ -112,1 +116,2 @@\n-        [self _initialize3dWithJproperties:jproperties];\n+        [self _initialize3dWithJproperties:jproperties\n+                               useMTLForSW:(BOOL)mtlForSW];\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/mac\/GlassViewMTL.m","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"}]}