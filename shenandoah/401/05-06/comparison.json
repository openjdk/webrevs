{"files":[{"patch":"@@ -1151,1 +1151,1 @@\n-      if (min_size == PLAB::min_size()) {\n+      if (min_size == plab_min_size) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -420,1 +420,2 @@\n-               ShenandoahThreadLocalData::set_plab_size(thread, PLAB::min_size());\n+               size_t plab_min_size = ((ShenandoahGenerationalHeap*) this)->plab_min_size();\n+               ShenandoahThreadLocalData::set_plab_size(thread, plab_min_size);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.inline.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+#include \"gc\/shenandoah\/shenandoahGenerationalHeap.hpp\"\n@@ -36,0 +37,1 @@\n+#include \"gc\/shenandoah\/mode\/shenandoahMode.hpp\"\n@@ -110,1 +112,4 @@\n-    data(thread)->_plab = new PLAB(PLAB::min_size());\n+\n+    \/\/ In theory, plabs are only need if heap->mode()->is_generational().  However, some threads are apparently\n+    \/\/ instantiated before we are able to answer that question.\n+    data(thread)->_plab = new PLAB(align_up(PLAB::min_size(), CardTable::card_size_in_words()));\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahThreadLocalData.hpp","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"}]}