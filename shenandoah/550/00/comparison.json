{"files":[{"patch":"@@ -1028,1 +1028,1 @@\n-    assert(ctx->is_bitmap_clear_range(ctx->top_bitmap(r), r->end()), \"Bitmap above top_bitmap() must be clear\");\n+    assert(ctx->is_bitmap_range_within_region_clear(ctx->top_bitmap(r), r->end()), \"Bitmap above top_bitmap() must be clear\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -758,1 +758,1 @@\n-          !context->is_bitmap_clear_range(r->bottom(), r->end())) {\n+          !context->is_bitmap_range_within_region_clear(r->bottom(), r->end())) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGeneration.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -881,1 +881,1 @@\n-  _heap_changed.set();\n+  _heap_changed.try_set();\n@@ -1970,3 +1970,0 @@\n-  \/\/ Check that if concurrent weak root is set then active_gen isn't null\n-  assert(!is_concurrent_weak_root_in_progress() || active_generation() != nullptr, \"Error\");\n-  shenandoah_assert_generations_reconciled();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -274,1 +274,1 @@\n-    log_info(gc)(\"GC cancellation took %.3fs\", cancel_time);\n+    log_debug(gc)(\"GC cancellation took %.3fs\", cancel_time);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.inline.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -837,1 +837,1 @@\n-    assert(ctx->is_bitmap_clear_range(top_bitmap, _end),\n+    assert(ctx->is_bitmap_range_within_region_clear(top_bitmap, _end),\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,1 +44,2 @@\n-    if (r->is_affiliated() && heap->is_bitmap_slice_committed(r) && !is_bitmap_clear_range(r->bottom(), r->end())) {\n+    if (r->is_affiliated() && heap->is_bitmap_slice_committed(r)\n+        && !is_bitmap_range_within_region_clear(r->bottom(), r->end())) {\n@@ -51,1 +52,2 @@\n-bool ShenandoahMarkingContext::is_bitmap_clear_range(const HeapWord* start, const HeapWord* end) const {\n+bool ShenandoahMarkingContext::is_bitmap_range_within_region_clear(const HeapWord* start, const HeapWord* end) const {\n+  assert(start <= end, \"Invalid start \" PTR_FORMAT \" and end \" PTR_FORMAT, p2i(start), p2i(end));\n@@ -55,0 +57,1 @@\n+#ifdef ASSERT\n@@ -56,6 +59,5 @@\n-    while (start_idx <= end_idx) {\n-      ShenandoahHeapRegion* r = heap->get_region(start_idx);\n-      if (!heap->is_bitmap_slice_committed(r)) {\n-        return true;\n-      }\n-      start_idx++;\n+    assert(start_idx == end_idx, \"Expected range to be within same region (\" SIZE_FORMAT \", \" SIZE_FORMAT \")\", start_idx, end_idx);\n+#endif\n+    ShenandoahHeapRegion* r = heap->get_region(start_idx);\n+    if (!heap->is_bitmap_slice_committed(r)) {\n+      return true;\n@@ -94,1 +96,1 @@\n-  assert(is_bitmap_clear_range(bottom, r->end()),\n+  assert(is_bitmap_range_within_region_clear(bottom, r->end()),\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMarkingContext.cpp","additions":11,"deletions":9,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -88,1 +88,1 @@\n-  bool is_bitmap_clear_range(const HeapWord* start, const HeapWord* end) const;\n+  bool is_bitmap_range_within_region_clear(const HeapWord* start, const HeapWord* end) const;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMarkingContext.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -101,1 +101,1 @@\n-  assert(old_tams == r->bottom() || is_bitmap_clear_range(old_tams, new_tams),\n+  assert(old_tams == r->bottom() || is_bitmap_range_within_region_clear(old_tams, new_tams),\n@@ -121,1 +121,1 @@\n-  assert(is_bitmap_clear_range(r->bottom(), r->end()),\n+  assert(is_bitmap_range_within_region_clear(r->bottom(), r->end()),\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMarkingContext.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}