{"files":[{"patch":"@@ -420,2 +420,3 @@\n-  while (!_queue.empty()) {\n-    CompileTask* task = _queue.pop();\n+\n+  CompileTask* task;\n+  while ((task = _queue.pop()) != nullptr) {\n@@ -498,0 +499,16 @@\n+    \/\/ If we have added stale tasks, there might be waiters that want\n+    \/\/ the notification these tasks have failed. Normally, this would\n+    \/\/ be done by a compiler thread that would perform the purge at\n+    \/\/ the end of some compilation. But, if compile queue is empty,\n+    \/\/ there is no guarantee compilers would run and do the purge.\n+    \/\/ Do the purge here and now to unblock the waiters.\n+    \/\/ Perform this until we run out of stale tasks.\n+    while (_first_stale != nullptr) {\n+      purge_stale_tasks();\n+    }\n+    if (_first != nullptr) {\n+      \/\/ Purge stale tasks may have transferred some new tasks,\n+      \/\/ so check again.\n+      break;\n+    }\n+\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.cpp","additions":19,"deletions":2,"binary":false,"changes":21,"status":"modified"}]}