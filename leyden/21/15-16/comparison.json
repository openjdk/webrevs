{"files":[{"patch":"@@ -764,1 +764,1 @@\n-    \/\/ there's no need to force verification or resolve CP entries. \n+    \/\/ there's no need to force verification or resolve CP entries.\n@@ -894,0 +894,7 @@\n+bool MetaspaceShared::is_recording_preimage_static_archive() {\n+  if (CDSConfig::is_dumping_preimage_static_archive()) {\n+      return _preimage_static_archive_dumped == 0;\n+  }\n+  return false;\n+}\n+\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -117,0 +117,2 @@\n+  static bool is_recording_preimage_static_archive() NOT_CDS_RETURN_(false);\n+\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -90,0 +90,6 @@\n+JNIEXPORT jboolean JNICALL\n+JVM_AOTIsTraining(JNIEnv *env);\n+\n+JNIEXPORT void JNICALL\n+JVM_AOTEndTraining(JNIEnv *env);\n+\n","filename":"src\/hotspot\/share\/include\/jvm.h","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -247,0 +247,16 @@\n+JVM_LEAF_PROF(jboolean, JVM_AOTIsTraining, JVM_AOTIsTraining(JNIEnv *env))\n+#if INCLUDE_CDS\n+  return MetaspaceShared::is_recording_preimage_static_archive();\n+#else\n+  return JNI_FALSE;\n+#endif \/\/ INCLUDE_CDS\n+JVM_END\n+\n+JVM_ENTRY_PROF(void, JVM_AOTEndTraining, JVM_AOTEndTraining(JNIEnv *env))\n+#if INCLUDE_CDS\n+  if (MetaspaceShared::is_recording_preimage_static_archive()) {\n+    MetaspaceShared::preload_and_dump(THREAD);\n+  }\n+#endif \/\/ INCLUDE_CDS\n+JVM_END\n+\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1928,0 +1928,12 @@\n+    \/**\n+     * Returns whether the AOT system is recording training data.\n+     *\n+     * @return  whether the AOT system is recording training data.\n+     *\/\n+    public static native boolean AOTIsTraining();\n+\n+    \/**\n+     * Will stop the recording of AOT training data.\n+     *\/\n+    public static native void AOTEndTraining();\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/System.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -300,0 +300,13 @@\n+JNIEXPORT jboolean JNICALL\n+Java_java_lang_System_AOTIsTraining(JNIEnv *env, jclass ign)\n+{\n+    jboolean isTraining = JVM_AOTIsTraining(env);\n+    return isTraining;\n+}\n+\n+JNIEXPORT void JNICALL\n+Java_java_lang_System_AOTEndTraining(JNIEnv *env, jclass ign)\n+{\n+    JVM_AOTEndTraining(env);\n+}\n+\n","filename":"src\/java.base\/share\/native\/libjava\/System.c","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"}]}