{"files":[{"patch":"@@ -70,0 +70,6 @@\n+uint AOTCacheAccess::convert_method_to_offset(Method* method) {\n+  assert(MetaspaceShared::is_in_shared_metaspace(method), \"method %p is not in AOTCache\", method);\n+  uint offset = (uint)pointer_delta((address)method, (address)SharedBaseAddress, 1);\n+  return offset;\n+}\n+\n","filename":"src\/hotspot\/share\/cds\/aotCacheAccess.cpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -84,5 +84,1 @@\n-  static uint convert_method_to_offset(Method* method) {\n-    assert(method->is_shared(), \"method %p is not in AOTCache\", method);\n-    uint offset = (uint)pointer_delta((address)method, (address)SharedBaseAddress, 1);\n-    return offset;\n-  }\n+  static uint convert_method_to_offset(Method* method);\n","filename":"src\/hotspot\/share\/cds\/aotCacheAccess.hpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -963,0 +963,5 @@\n+Method* AOTCodeEntry::method() {\n+  assert(_kind == Code, \"invalid kind %d\", _kind);\n+  return AOTCacheAccess::convert_offset_to_method(_id);\n+}\n+\n@@ -1097,9 +1102,0 @@\n-void AOTCodeCache::mark_method_pointer(AOTCodeEntry* entries, int count) {\n-  for (int i = 0; i < count; i++) {\n-    Method* m = entries[i].method();\n-    if (m != nullptr) {\n-      AOTCacheAccess::set_pointer(entries[i].method_addr(), m);\n-    }\n-  }\n-}\n-\n@@ -1266,1 +1262,0 @@\n-    mark_method_pointer((AOTCodeEntry*)current, entries_count);\n@@ -1775,1 +1770,0 @@\n-  entry->set_method(method);\n","filename":"src\/hotspot\/share\/code\/aotCodeCache.cpp","additions":5,"deletions":11,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -96,1 +96,0 @@\n-  Method*       _method;\n@@ -98,1 +97,1 @@\n-  uint   _id;          \/\/ Adapter's id, vmIntrinsic::ID for stub or name's hash for nmethod\n+  uint   _id;          \/\/ Adapter's id, vmIntrinsic::ID for stub or Method's offset in AOTCache for nmethod\n@@ -104,1 +103,0 @@\n-\n@@ -124,1 +122,0 @@\n-    _method       = nullptr;\n@@ -155,1 +152,0 @@\n-    _method       = nullptr;\n@@ -186,3 +182,1 @@\n-  Method* method()  const { return _method; }\n-  Method** method_addr() { return &_method; }\n-  void set_method(Method* method) { _method = method; }\n+  Method* method();\n@@ -528,1 +522,0 @@\n-  void mark_method_pointer(AOTCodeEntry* entries, int count);\n","filename":"src\/hotspot\/share\/code\/aotCodeCache.hpp","additions":2,"deletions":9,"binary":false,"changes":11,"status":"modified"}]}