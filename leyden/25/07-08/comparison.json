{"files":[{"patch":"@@ -2540,0 +2540,1 @@\n+  AdapterHandlerEntry* entry = nullptr;\n@@ -2542,1 +2543,1 @@\n-  AdapterHandlerEntry* entry = _archived_adapter_handler_table.lookup(fp, fp->compute_hash(), 0 \/* unused *\/);\n+  entry = _archived_adapter_handler_table.lookup(fp, fp->compute_hash(), 0 \/* unused *\/);\n@@ -3426,2 +3427,2 @@\n-  auto findblob = [&] (AdapterFingerPrint* key, AdapterHandlerEntry* a) {\n-    return (found = (b == CodeCache::find_blob(a->get_i2c_entry())));\n+  auto findblob_archived_table = [&] (AdapterHandlerEntry* handler) {\n+    return (found = (b == CodeCache::find_blob(handler->get_i2c_entry())));\n@@ -3429,2 +3430,8 @@\n-  assert_locked_or_safepoint(AdapterHandlerLibrary_lock);\n-  _adapter_handler_table->iterate(findblob);\n+  _archived_adapter_handler_table.iterate(findblob_archived_table);\n+  if (!found) {\n+    auto findblob_runtime_table = [&] (AdapterFingerPrint* key, AdapterHandlerEntry* a) {\n+      return (found = (b == CodeCache::find_blob(a->get_i2c_entry())));\n+    };\n+    assert_locked_or_safepoint(AdapterHandlerLibrary_lock);\n+    _adapter_handler_table->iterate(findblob_runtime_table);\n+  }\n@@ -3445,2 +3452,2 @@\n-  auto findblob = [&] (AdapterFingerPrint* key, AdapterHandlerEntry* a) {\n-    if (b == CodeCache::find_blob(a->get_i2c_entry())) {\n+  auto findblob_archived_table = [&] (AdapterHandlerEntry* handler) {\n+    if (b == CodeCache::find_blob(handler->get_i2c_entry())) {\n@@ -3449,1 +3456,1 @@\n-      a->print_adapter_on(st);\n+      handler->print_adapter_on(st);\n@@ -3453,0 +3460,1 @@\n+\n@@ -3455,2 +3463,15 @@\n-  assert_locked_or_safepoint(AdapterHandlerLibrary_lock);\n-  _adapter_handler_table->iterate(findblob);\n+  _archived_adapter_handler_table.iterate(findblob_archived_table);\n+  if (!found) {\n+    auto findblob_runtime_table = [&] (AdapterFingerPrint* key, AdapterHandlerEntry* a) {\n+      if (b == CodeCache::find_blob(a->get_i2c_entry())) {\n+\tfound = true;\n+\tst->print(\"Adapter for signature: \");\n+\ta->print_adapter_on(st);\n+\treturn true;\n+      } else {\n+\treturn false; \/\/ keep looking\n+      }\n+    };\n+    assert_locked_or_safepoint(AdapterHandlerLibrary_lock);\n+    _adapter_handler_table->iterate(findblob_runtime_table);\n+  }\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":31,"deletions":10,"binary":false,"changes":41,"status":"modified"}]}