{"files":[{"patch":"@@ -2542,3 +2542,6 @@\n-  \/\/ Search archived table first. It is read-only table so can be searched without lock\n-  entry = _archived_adapter_handler_table.lookup(fp, fp->compute_hash(), 0 \/* unused *\/);\n-  if (entry != nullptr) {\n+  \/\/ if we are building the archive then the archived adapter table is\n+  \/\/ not valid and we need to use the ones added to the runtime table\n+  if (!CDSConfig::is_dumping_adapters()) {\n+    \/\/ Search archived table first. It is read-only table so can be searched without lock\n+    entry = _archived_adapter_handler_table.lookup(fp, fp->compute_hash(), 0 \/* unused *\/);\n+    if (entry != nullptr) {\n@@ -2546,4 +2549,4 @@\n-    if (fp->is_compact()) {\n-      _compact++;\n-    }\n-    _archived_hits++;\n+      if (fp->is_compact()) {\n+        _compact++;\n+      }\n+      _archived_hits++;\n@@ -2551,1 +2554,2 @@\n-    return entry;\n+      return entry;\n+    }\n@@ -3427,0 +3431,1 @@\n+#if INCLUDE_CDS\n@@ -3431,0 +3436,1 @@\n+#endif \/\/ INCLUDE_CDS\n@@ -3452,0 +3458,1 @@\n+#if INCLUDE_CDS\n@@ -3464,0 +3471,1 @@\n+#endif \/\/ INCLUDE_CDS\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":16,"deletions":8,"binary":false,"changes":24,"status":"modified"}]}