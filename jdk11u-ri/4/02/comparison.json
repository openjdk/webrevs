{"files":[{"patch":"@@ -0,0 +1,15 @@\n+\/build\/\n+\/dist\/\n+\/.idea\/\n+nbproject\/private\/\n+\/webrev\n+\/.src-rev\n+\/.jib\/\n+.DS_Store\n+.metadata\/\n+.recommenders\/\n+test\/nashorn\/script\/external\n+test\/nashorn\/lib\n+NashornProfile.txt\n+**\/JTreport\/**\n+**\/JTwork\/**\n","filename":".gitignore","additions":15,"deletions":0,"binary":false,"changes":15,"status":"added"},{"patch":"@@ -34,1 +34,1 @@\n-# image, and can be used to recreate the source revision used.\n+# source image, and can be used to recreate the source revision used.\n@@ -36,5 +36,5 @@\n-# We're either building directly from a mercurial forest, and if so, use the\n-# current revision from mercurial. Otherwise, we are building from a source\n-# bundle. As a part of creating this source bundle, the current mercurial\n-# revisions of all repos will be stored in a file in the top dir, which is then\n-# used when creating the tracker file.\n+# We're either building directly from an SCM repository, and if so, use the\n+# current revision from that SCM. Otherwise, we are building from a source\n+# bundle. As a part of creating this source bundle, the current SCM revisions of\n+# all repos will be stored in a file in the top dir, which is then used when\n+# creating the tracker file.\n@@ -44,1 +44,1 @@\n-# Are we using mercurial?\n+USE_SCM := false\n@@ -46,0 +46,12 @@\n+  USE_SCM := true\n+  SCM_DIR := .hg\n+  ID_COMMAND := $(PRINTF) \"hg:%s\" \"$$($(HG) id -i)\"\n+else ifneq ($(and $(GIT), $(wildcard $(TOPDIR)\/.git)), )\n+  USE_SCM := true\n+  SCM_DIR := .git\n+  ID_COMMAND := $(PRINTF) \"git:%s%s\\n\" \\\n+      \"$$(git log -n1 --format=%H | cut -c1-12)\" \\\n+      \"$$(if test -n \"$$(git status --porcelain)\"; then printf '+'; fi)\"\n+endif\n+\n+ifeq ($(USE_SCM), true)\n@@ -49,2 +61,2 @@\n-    $(if $(wildcard $(TOPDIR)\/$(repo)\/.hg),, \\\n-        $(error Inconsistent revision control: $(repo) is missing .hg directory)) \\\n+    $(if $(wildcard $(TOPDIR)\/$(repo)\/$(SCM_DIR)),, \\\n+        $(error Inconsistent revision control: $(repo) is missing $(SCM_DIR) directory)) \\\n@@ -59,1 +71,3 @@\n-  # the name of the repository and the output of \"hg id\" for that repository.\n+  # the name of the repository and the output of the scm command for that\n+  # repository.\n+  #\n@@ -69,1 +83,1 @@\n-\t$$(ECHO) $$(strip $1):`$$(HG) id -i --repository $$($1_REPO_PATH)` > $$@\n+\t$$(ECHO) $$(strip $1):`$$(CD) $$($1_REPO_PATH) && $$(ID_COMMAND)` > $$@\n@@ -95,1 +109,1 @@\n-  hg-store-source-revision: $(STORED_SOURCE_REVISION)\n+  scm-store-source-revision: $(STORED_SOURCE_REVISION)\n@@ -99,1 +113,1 @@\n-  hg-create-source-revision-tracker: $(SOURCE_REVISION_TRACKER)\n+  scm-create-source-revision-tracker: $(SOURCE_REVISION_TRACKER)\n@@ -101,2 +115,4 @@\n-  STORE_SOURCE_REVISION_TARGET := hg-store-source-revision\n-  CREATE_SOURCE_REVISION_TRACKER_TARGET := hg-create-source-revision-tracker\n+  STORE_SOURCE_REVISION_TARGET := scm-store-source-revision\n+  CREATE_SOURCE_REVISION_TRACKER_TARGET := scm-create-source-revision-tracker\n+\n+  .PHONY: scm-store-source-revision scm-create-source-revision-tracker\n@@ -105,1 +121,1 @@\n-  # Not using HG\n+  # Not using any SCM\n@@ -111,1 +127,1 @@\n-\t$(call LogInfo, No mercurial configuration present$(COMMA) not updating .src-rev)\n+\t$(call LogInfo, No SCM configuration present$(COMMA) not updating .src-rev)\n@@ -121,1 +137,1 @@\n-\t$(call LogWarn, Error: No mercurial configuration present$(COMMA) cannot create .src-rev)\n+\t$(call LogWarn, Error: No SCM configuration present$(COMMA) cannot create .src-rev)\n@@ -125,1 +141,1 @@\n-\t$(call LogWarn, Warning: No mercurial configuration present and no .src-rev)\n+\t$(call LogWarn, Warning: No SCM configuration present and no .src-rev)\n@@ -131,0 +147,2 @@\n+  .PHONY: src-store-source-revision src-create-source-revision-tracker\n+\n","filename":"make\/SourceRevision.gmk","additions":37,"deletions":19,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -1193,0 +1193,1 @@\n+  BASIC_PATH_PROGS(GIT, git)\n","filename":"make\/autoconf\/basics.m4","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -719,0 +719,1 @@\n+GIT:=@GIT@\n","filename":"make\/autoconf\/spec.gmk.in","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -350,0 +350,1 @@\n+        $(addprefix $(TOPDIR)\/, .git *\/.git *\/*\/.git *\/*\/*\/.git *\/*\/*\/*\/.git) \\\n","filename":"make\/common\/MakeBase.gmk","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}